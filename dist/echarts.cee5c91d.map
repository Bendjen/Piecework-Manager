{"version":3,"sources":["lib\\echarts.js"],"names":["global","factory","exports","module","define","amd","echarts","idStart","guid","env","wx","getSystemInfoSync","browser","os","node","wxa","canvasSupported","svgSupported","touchEventsSupported","document","self","worker","navigator","detect","userAgent","env$1","ua","firefox","match","ie","edge","weChat","test","version","createElement","getContext","SVGRect","window","pointerEventsSupported","BUILTIN_OBJECT","TYPED_ARRAY","objToString","Object","prototype","toString","arrayProto","Array","nativeForEach","forEach","nativeFilter","filter","nativeSlice","slice","nativeMap","map","nativeReduce","reduce","methods","$override","name","fn","_ctx","clone","source","result","typeStr","call","isPrimitive","i","len","length","Ctor","constructor","from","isDom","key","hasOwnProperty","merge","target","overwrite","isObject$1","targetProp","sourceProp","isArray","isBuiltInObject","mergeAll","targetAndSources","extend","defaults","overlay","createCanvas","indexOf","array","value","inherits","clazz","baseClazz","clazzPrototype","F","prop","superClass","mixin","isArrayLike","data","each$1","obj","cb","context","push","memo","find","bind","func","args","arguments","apply","concat","curry","isFunction$1","isString","type","isTypedArray","nodeType","ownerDocument","eqNaN","retrieve","values","retrieve2","value0","value1","retrieve3","value2","Function","normalizeCssArray","val","assert$1","condition","message","Error","trim","str","replace","primitiveKey","setAsPrimitive","HashMap","isArr","thisMap","each","visit","set","get","removeKey","createHashMap","concatArray","a","b","newArray","offset","noop","zrUtil","freeze","isFunction","isObject","assert","ArrayCtor","Float32Array","create","x","y","out","copy","v","clone$1","add","v1","v2","scaleAndAdd","sub","Math","sqrt","lenSquare","lengthSquare","mul","div","dot","scale","s","normalize","d","distance","dist","distanceSquare","distSquare","negate","lerp","t","applyTransform","m","min","max","vector","Draggable","on","_dragStart","_drag","_dragEnd","e","draggingTarget","draggable","_draggingTarget","dragging","_x","offsetX","_y","offsetY","dispatchToElement","param","event","dx","dy","drift","dropTarget","findHover","lastDropTarget","_dropTarget","topTarget","arrySlice","Eventful","_$handlers","one","handler","_h","h","ctx","isSilent","off","newList","l","trigger","argLen","splice","triggerWithContext","SILENT","makeEventPacket","eveType","targetInfo","cancelBubble","zrX","zrY","gestureEvent","pinchX","pinchY","pinchScale","wheelDelta","zrDelta","zrByTouch","which","EmptyProxy","dispose","handlerNames","Handler","storage","painter","proxy","painterRoot","_hovered","_lastTouchMoment","_lastX","_lastY","setHandlerProxy","mousemove","lastHovered","lastHoveredTarget","__zr","hovered","hoveredTarget","setCursor","cursor","mouseout","element","toElement","relatedTarget","innerDom","parentNode","resize","dispatch","eventName","eventArgs","setCursorStyle","cursorStyle","el","silent","eventHandler","eventPacket","parent","eachOtherLayer","layer","exclude","list","getDisplayList","hoverCheckResult","ignore","isHover","_downEl","_downPoint","_upEl","displayable","rectHover","clipPath","contain","ArrayCtor$1","create$1","identity","copy$1","mul$1","m1","m2","out0","out1","out2","out3","out4","out5","translate","rotate","rad","aa","ac","atx","ab","ad","aty","st","sin","ct","cos","scale$1","vx","vy","invert","det","clone$2","matrix","mIdentity","EPSILON","isNotAroundZero","Transformable","opts","position","rotation","origin","transformableProto","transform","needLocalTransform","updateTransform","parentHasTransform","getLocalTransform","invTransform","setTransform","dpr","restoreTransform","tmpTransform","decomposeTransform","sx","sy","scale$$1","atan2","getGlobalScale","transformCoordToLocal","transformCoordToGlobal","easing","linear","k","quadraticIn","quadraticOut","quadraticInOut","cubicIn","cubicOut","cubicInOut","quarticIn","quarticOut","quarticInOut","quinticIn","quinticOut","quinticInOut","sinusoidalIn","PI","sinusoidalOut","sinusoidalInOut","exponentialIn","pow","exponentialOut","exponentialInOut","circularIn","circularOut","circularInOut","elasticIn","p","asin","elasticOut","elasticInOut","backIn","backOut","backInOut","bounceIn","bounceOut","bounceInOut","Clip","options","_target","_life","life","_delay","delay","_initialized","loop","gap","onframe","ondestroy","onrestart","_pausedTime","_paused","step","globalTime","deltaTime","_startTime","percent","easing$$1","easingFunc","schedule","fire","restart","_needsRemove","remainder","eventType","arg","pause","resume","LinkedList","head","tail","_len","linkedListProto","insert","entry","Entry","insertEntry","next","prev","remove","clear","LRU","maxSize","_list","_map","_maxSize","_lastRemovedEntry","LRUProto","put","removed","leastUsedEntry","kCSSColorTable","clampCssByte","round","clampCssAngle","clampCssFloat","f","parseCssInt","charAt","parseFloat","parseInt","parseCssFloat","cssHueToRgb","lerpNumber","setRgba","r","g","copyRgba","colorCache","lastRemovedArr","putToCache","colorStr","rgbaArr","parse","cached","toLowerCase","iv","substr","op","ep","fname","params","split","alpha","pop","hsla2rgba","hsla","rgba","rgba2hsla","R","G","B","vMin","vMax","delta","L","H","S","deltaR","deltaG","deltaB","lift","color","level","colorArr","stringify","toHex","fastLerp","normalizedValue","colors","leftIndex","floor","rightIndex","ceil","leftColor","rightColor","dv","fastMapToColor","lerp$1","fullOutput","mapToColor","modifyHSL","modifyAlpha","arrColor","arraySlice","defaultGetter","defaultSetter","interpolateNumber","p0","p1","interpolateString","interpolateArray","arrDim","len2","j","fillArr","arr0","arr1","arr0Len","arr1Len","isPreviousLarger","isNaN","isArraySame","catmullRomInterpolateArray","p2","p3","t2","t3","catmullRomInterpolate","v0","cloneValue","ret","rgba2String","join","getArrayDim","keyframes","lastValue","createTrackClip","animator","oneTrackDone","propName","forceAnimate","getter","_getter","setter","_setter","useSpline","trackLen","firstVal","isValueArray","isValueColor","isValueString","trackMaxTime","sort","time","kfPercents","kfValues","prevValue","isAllValueEqual","colorArray","lastFrame","lastFramePercent","start","w","frame","range","clip","_loop","Animator","_tracks","_clipCount","_doneList","_onframeList","_clipList","when","props","tracks","during","callback","isPaused","_doneCallback","doneList","clipCount","lastClip","animation","addClip","oldOnFrame","stop","forwardToLast","clipList","removeClip","done","getClips","devicePixelRatio","debugMode","log","console","log$1","Animatable","animators","animate","path","animatingShape","zr","pathSplitted","id","dirty","addAnimator","stopAnimation","animateTo","_animateToShallow","count","objShallow","propertyCount","attr","Element","isGroup","beforeUpdate","afterUpdate","update","traverse","attrKV","hide","refresh","show","setClipPath","addSelfToZr","removeClipPath","__clipTarget","removeSelfFromZr","removeAnimator","v2ApplyTransform","mathMin","mathMax","BoundingRect","width","height","union","other","lt","rb","lb","rt","maxX","maxY","calculateTransform","intersect","ax0","ax1","ay0","ay1","bx0","bx1","by0","by1","rect","plain","Group","_children","__storage","__dirty","children","childAt","idx","childOfName","childCount","child","_doAdd","addBefore","nextSibling","addToStorage","addChildrenToStorage","delFromStorage","delChildrenFromStorage","removeAll","eachChild","getBoundingRect","includeChildren","tmpRect","tmpMat","invisible","childRect","DEFAULT_MIN_MERGE","DEFAULT_MIN_GALLOPING","minRunLength","n","makeAscendingRun","lo","hi","compare","runHi","reverseRun","binaryInsertionSort","pivot","left","right","mid","gallopLeft","hint","lastOffset","maxOffset","tmp","gallopRight","TimSort","minGallop","runStart","runLength","stackSize","pushRun","_runStart","_runLength","mergeRuns","mergeAt","forceMergeRuns","start1","length1","start2","length2","mergeLow","mergeHigh","cursor1","cursor2","dest","_minGallop","count1","count2","exit","customCursor","customDest","remaining","ts","minRun","force","shapeCompareFunc","zlevel","z","z2","Storage","_roots","_displayList","_displayListLen","includeIgnore","updateDisplayList","roots","displayList","_updateAndAddDisplayable","clipPaths","userSetClipPath","currentClipPath","parentClipPath","__clipPaths","addRoot","delRoot","root","_renderList","displayableSortFunc","SHADOW_PROPS","fixShadow","STYLE_COMMON_PROPS","Style","host","extendFrom","createLinearGradient","x2","y2","canvasGradient","createRadialGradient","fill","stroke","opacity","lineDash","lineDashOffset","shadowBlur","shadowOffsetX","shadowOffsetY","lineWidth","strokeNoScale","text","font","textFont","fontStyle","fontWeight","fontSize","fontFamily","textTag","textFill","textStroke","textWidth","textHeight","textStrokeWidth","textLineHeight","textPosition","textRect","textOffset","textAlign","textVerticalAlign","textDistance","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY","textBoxShadowColor","textBoxShadowBlur","textBoxShadowOffsetX","textBoxShadowOffsetY","transformText","textRotation","textOrigin","textBackgroundColor","textBorderColor","textBorderWidth","textBorderRadius","textPadding","rich","truncate","blend","prevEl","style","prevStyle","firstDraw","styleName","fillStyle","strokeStyle","globalAlpha","globalCompositeOperation","hasStroke","getLineScale","hasFill","otherStyle","newStyle","getGradient","method","colorStops","addColorStop","styleProto","Pattern","image","repeat","getCanvasPattern","createPattern","returnFalse","createDom","newDom","getWidth","getHeight","newDomStyle","top","setAttribute","Layer","dom","domStyle","onselectstart","domBack","ctxBack","config","clearColor","motionBlur","lastFrameAlpha","__used","__drawIndex","__startIndex","__endIndex","incremental","getElementCount","initContext","createBackBuffer","clearAll","haveMotionBLur","drawImage","clearRect","clearColorGradientOrPattern","__canvasGradient","save","fillRect","restore","requestAnimationFrame","msRequestAnimationFrame","mozRequestAnimationFrame","webkitRequestAnimationFrame","setTimeout","globalImageCache","findExistImage","newImageOrSrc","cachedImgObj","createOrUpdateImage","hostEl","cbPayload","__zrImageSrc","pendingWrap","isImageReady","pending","Image","onload","imageOnLoad","__cachedImgObj","src","textWidthCache","textWidthCacheCounter","TEXT_CACHE_MAX","STYLE_REG","DEFAULT_FONT","methods$1","textLines","measureText","getRichTextRect","getPlainTextRect","contentBlock","parsePlainText","outerWidth","outerHeight","adjustTextX","adjustTextY","lineHeight","parseRichText","adjustTextPositionOnRect","halfHeight","truncateText","containerWidth","ellipsis","prepareTruncateOptions","truncateSingleLine","maxIterations","minChar","cnCharWidth","ascCharWidth","placeholder","contentWidth","ellipsisWidth","textLine","subLength","estimateLength","charCode","charCodeAt","getLineHeight","padding","lines","truncOuterHeight","truncOuterWidth","lastIndex","exec","matchedIndex","index","pushTokens","substring","contentHeight","pendingList","stlPadding","truncateWidth","truncateHeight","line","tokens","token","tokenStyle","tokenHeight","tokenWidth","tokenWidthNotSpecified","percentWidth","bgImg","paddingW","remianTruncWidth","block","isEmptyStr","strs","isLineHolder","tokensLen","makeFont","buildPath","shape","r1","r2","r3","r4","total","moveTo","lineTo","arc","VALID_TEXT_ALIGN","center","VALID_TEXT_VERTICAL_ALIGN","bottom","middle","normalizeTextStyle","normalizeStyle","textBaseline","renderText","renderRichText","renderPlainText","setCtx","__textCotentBlock","boxPos","getBoxPosition","baseX","baseY","applyTextRotation","boxY","textX","textY","needDrawBg","needDrawBackground","boxX","drawBackground","getTextXForPadding","getStroke","getFill","strokeText","fillText","drawRichText","xLeft","lineTop","xRight","tokenCount","usedWidth","lineXLeft","lineXRight","placeToken","isPlainBg","beginPath","closePath","onBgImageLoaded","blockHeiht","parsePercent","res","maxValue","lastIndexOf","needDrawText","tmpRect$1","RectText","drawRectText","Displayable","_rect","culling","progressive","inplace","beforeBrush","afterBrush","brush","rectContain","coord","animateStyle","setStyle","useStyle","ZImage","_image","aspect","sWidth","sHeight","HOVER_LAYER_ZLEVEL","CANVAS_ZLEVEL","EL_AFTER_INCREMENTAL_INC","INCREMENTAL_INC","parseInt10","isLayerValid","__builtin__","viewRect","isDisplayableCulled","isClipPathChanged","prevClipPaths","doClip","createRoot","domRoot","cssText","Painter","singleCanvas","nodeName","toUpperCase","_opts","_singleCanvas","rootStyle","innerHTML","zlevelList","_zlevelList","layers","_layers","_layerConfig","_needsManuallyCompositing","_width","_getSize","_height","_domRoot","appendChild","mainLayer","_hoverlayer","_hoverElements","getType","isSingleCanvas","getViewportRoot","getViewportRootOffset","viewportRoot","offsetLeft","offsetTop","paintAll","_redrawId","random","_paintList","_backgroundColor","refreshHover","addHover","hoverStyle","__hoverMir","elMirror","__from","removeHover","hoverElements","clearHover","hoverLayer","getLayer","scope","originalEl","_doPaintEl","getHoverLayer","redrawId","_updateLayerStatus","finished","_doPaintList","_compositeManually","eachBuiltinLayer","virtual","layerList","zi","useTimer","Date","now","startTime","firstEl","notClear","error","dTime","prevElClipPaths","draw","currentLayer","forcePaint","insertLayer","layersMap","prevLayer","prevDom","insertBefore","firstChild","eachLayer","getLayers","updatePrevLayer","incrementalLayerCount","_clearLayer","setBackgroundColor","backgroundColor","configLayer","layerConfig","_zlevel","delLayer","removeChild","display","_progressiveLayers","clearLayer","getRenderedCanvas","imageLayer","pixelRatio","renderToCanvas","whIdx","wh","cwh","plt","prb","stl","defaultView","getComputedStyle","pathToImage","canvas","shadowBlurSize","leftMargin","rightMargin","topMargin","bottomMargin","pathTransform","ImageShape","imgShape","isDomLevel2","addEventListener","MOUSE_EVENT_REG","getBoundingClientRect","clientToLocal","calculate","defaultGetZrXY","layerX","layerY","box","clientX","clientY","normalizeEvent","isTouch","detail","touch","targetTouches","changedTouches","button","undefined","attachEvent","removeEventListener","detachEvent","preventDefault","stopPropagation","returnValue","Animation","stage","_clips","_running","_time","_pauseStart","clips","_update","getTime","deferredEvents","deferredClips","_startLoop","isFinished","GestureMgr","_track","recognize","_doTrack","_recognize","touches","trackItem","points","pos","recognizers","gestureInfo","dist$1","pointPair","pinch","track","pinchEnd","pinchPre","isFinite","pinchCenter","TOUCH_CLICK_DELAY","mouseHandlerNames","touchHandlerNames","pointerEventNames","pointerdown","pointerup","pointermove","pointerout","pointerHandlerNames","nm","eventNameFix","processGesture","gestureMgr","_gestureMgr","setTouchTimer","instance","_touching","clearTimeout","_touchTimer","domHandlers","touchstart","mousedown","touchmove","touchend","mouseup","click","isPointerFromTouch","pointerType","initDomHandler","_handlers","makeMouseHandler","HandlerDomProxy","mountHandlers","handlerDomProxyProto","useVML","painterCtors","instances$1","version$1","init$1","ZRender","dispose$1","getInstance","registerPainter","delInstance","rendererType","renderer","vml","handerProxy","flush","_needsRefresh","oldDelFromStorage","oldAddToStorage","getId","zLevel","refreshImmediately","triggerRendered","_needsRefreshHover","refreshHoverImmediately","clearAnimation","zrender","init","each$2","isObject$2","isArray$1","DUMMY_COMPONENT_NAME_PREFIX","normalizeToArray","defaultEmphasis","opt","subOpts","emphasis","subOptName","TEXT_STYLE_OPTIONS","getDataItemValue","dataItem","isDataItemOption","mappingToExists","exists","newCptOptions","exist","cptOption","option","isIdInner","makeIdAndName","mapResult","idMap","item","existCpt","keyInfo","idNum","isNameSpecified","componentModel","queryDataIndex","payload","dataIndexInside","dataIndex","indexOfRawIndex","indexOfName","makeInner","innerUniqueIndex","toFixed","hostObj","parseFinder","ecModel","finder","defaultMainType","has","parsedKey","mainType","queryType","includeMainTypes","queryParam","models","queryComponents","getAttribute","TYPE_DELIMITER","IS_CONTAINER","parseClassType$1","componentType","main","checkClassType","enableClassExtend","RootClass","mandatoryMethods","$constructor","proto","ExtendedClass","superCall","superApply","classBase","enableClassCheck","Clz","classAttr","isInstance","methodName","enableClassManagement","entity","registerClass","Clazz","container","makeContainer","getClass","componentMainType","subType","throwWhenNotFound","getClassesByMainType","o","hasClass","getAllClassMainTypes","types","hasSubTypes","parseClassType","registerWhenExtend","originalExtend","makeStyleMapper","properties","model","excludes","includes","getShallow","getLineStyle","lineStyleMixin","getLineDash","lineType","dotSize","dashSize","getAreaStyle","areaStyleMixin","mathPow","mathSqrt$2","EPSILON$1","EPSILON_NUMERIC","THREE_SQRT","ONE_THIRD","_v0","_v1","_v2","isAroundZero","isNotAroundZero$1","cubicAt","onet","cubicDerivativeAt","cubicRootAt","c","A","C","t1","disc","K","discSqrt","Y1","Y2","T","theta","acos","ASqrt","cubicExtrema","extrema","cubicSubdivide","p01","p12","p23","p012","p123","p0123","cubicProjectPoint","x0","y0","x1","y1","x3","y3","interval","Infinity","d1","d2","_t","quadraticAt","quadraticDerivativeAt","quadraticRootAt","quadraticExtremum","divider","quadraticSubdivide","quadraticProjectPoint","mathMin$3","mathMax$3","mathSin$2","mathCos$2","PI2","end","extremity","fromPoints","min$$1","max$$1","fromLine","xDim","yDim","fromCubic","cubicExtrema$$1","cubicAt$$1","fromQuadratic","quadraticExtremum$$1","quadraticAt$$1","tx","ty","fromArc","rx","ry","startAngle","endAngle","anticlockwise","vec2Min","vec2Max","diff","abs","angle","CMD","M","Q","Z","min$1","max$1","min2","max2","mathMin$2","mathMax$2","mathCos$1","mathSin$1","mathSqrt$1","mathAbs","hasTypedArray","PathProxy","notSaveData","_saveData","_xi","_yi","_x0","_y0","_ux","_uy","_lineDash","_dashOffset","_dashIdx","_dashSum","setScale","addData","exceedUnit","_needsDash","_dashedLineTo","bezierCurveTo","_dashedBezierTo","quadraticCurveTo","_dashedQuadraticTo","cx","cy","arcTo","radius","toStatic","setLineDash","lineDashSum","setLineDashOffset","setData","len$$1","appendPath","appendSize","appendPathData","cmd","_expandData","_prevCmd","newData","dashSum","dist$$1","dash","nDash","bezierLen","tmpLen","Number","MAX_VALUE","xi","yi","psi","rebuildPath","ux","uy","dTheta","fs","scaleX","scaleY","isEllipse","containStroke$1","_l","_a","_b","_s","containStroke$2","containStroke$3","PI2$3","normalizeRadian","PI2$2","containStroke$4","windingLine","dir","x_","CMD$1","PI2$1","EPSILON$2","isAroundEqual","swapExtrema","windingCubic","nRoots","nExtrema","y0_","y1_","unit","windingQuadratic","y_","windingArc","containPath","isStroke","pathData","containStroke","pathProxyForDraw","Path","__dirtyPath","strokeContainThreshold","hasFillGradient","hasStrokeGradient","hasFillPattern","hasStrokePattern","_fillGradient","_strokeGradient","ctxLineDash","shapeCfg","inBundle","createPathProxy","needsUpdateRect","rectWithStroke","_rectWithStroke","lineScale","localPos","dirtyPath","animateShape","setShape","defaults$$1","Sub","defaultShape","thisShape","CMD$2","mathSqrt$3","mathAtan2","transformPath","nPoint","cc","mathSqrt","mathSin","mathCos","vMag","vRatio","u","vAngle","processArc","fa","psiDeg","xp","yp","lambda","cxp","cyp","createPathProxyFromString","cs","RegExp","arr","cpx","cpy","prevCmd","shift","ctlPtx","ctlPty","createPathOptions","pathProxy","createFromString","extendFromString","mergePath$1","pathEls","pathList","pathEl","pathBundle","Text","shadowColor","Circle","shadowTemp","fixClipWithShadow","orignalBrush","modified","Sector","r0","clockwise","unitX","unitY","Ring","interpolate","smoothSpline","isLoop","distance$$1","segs","w2","w3","smoothBezier","smooth","constraint","cps","prevPoint","nextPoint","point","d0","sum","cp0","cp1","buildPath$1","controlPoints","smoothConstraint","cp2","Polygon","Polyline","Rect","Line","pointAt","someVectorAt","isTangent","cpx2","cpy2","cpx1","cpy1","BezierCurve","tangentAt","Arc","CompoundPath","paths","_updatePathDirty","Gradient","LinearGradient","globalCoord","RadialGradient","IncrementalDisplayble","_displayables","_temporaryDisplayables","_cursor","clearDisplaybles","addDisplayable","notPersistent","addDisplayables","displayables","eachPendingDisplayable","mathMax$1","mathMin$1","EMPTY_OBJ","extendShape","extendPath","makePath","layout","boundingRect","centerGraphic","resizePath","makeImage","imageUrl","img","mergePath","pathRect","subPixelOptimizeLine","subPixelOptimize","subPixelOptimizeRect","originX","originY","originWidth","originHeight","positiveOrNegative","doubledPosition","hasFillOrStroke","fillOrStroke","liftColor","cacheElementStl","__hoverStlDirty","__hoverStl","normalStyle","__normalStl","doSingleEnterHover","__isHover","useHoverLayer","insideRollbackOpt","rollbackInsideStyle","applyInsideStyle","insideOriginalTextPosition","autoColor","doSingleLeaveHover","normalStl","doEnterHover","doLeaveHover","setElementHoverStl","hoverStl","onElementMouseOver","__hoverSilentOnTouch","__isEmphasis","onElementMouseOut","enterEmphasis","leaveEmphasis","setHoverStyle","hoverSilentOnTouch","setLabelStyle","emphasisStyle","normalModel","emphasisModel","normalSpecified","emphasisSpecified","labelFetcher","labelDataIndex","labelDimIndex","showNormal","showEmphasis","baseText","getFormattedLabel","defaultText","normalStyleText","emphasisStyleText","setTextStyle","textStyle","textStyleModel","specifiedTextStyle","isEmphasis","setTextStyleCommon","setText","labelModel","defaultColor","isRectText","labelRotate","globalTextStyle","richItemNames","getRichItemNames","richResult","richTextStyle","getModel","setTokenTextStyle","forceRich","richItemNameMap","parentModel","isBlock","getAutoColor","originalTextPosition","insideRollback","disableBox","useInsideStyle","getFont","gTextStyleModel","animateOrSetProps","isUpdate","animatableModel","animationEnabled","isAnimationEnabled","postfix","duration","animationEasing","animationDelay","getAnimationDelayParams","updateProps","initProps","getTransform","ancestor","mat","applyTransform$1","invert$$1","transformDirection","direction","hBase","vBase","vertex","groupTransition","g1","g2","getElMap","elMap","anid","getAnimatableProps","elMap1","oldEl","newProp","clipPointsByRect","clipRectByRect","targetRect","createIcon","iconStr","graphic","IncrementalDisplayable","PATH_COLOR","textStyleMixin","getTextColor","getTextRect","getItemStyle","itemStyleMixin","getBorderLineDash","mixin$1","inner","Model","mergeOption","ignoreParent","doGet","parsePath","getParent","thisParentModel","isEmpty","restoreData","setReadOnly","customizeGetParent","getParentMethod","pathArr","base","getUID","enableSubTypeDefaulter","subTypeDefaulters","registerSubTypeDefaulter","defaulter","determineSubType","componentTypeMain","enableTopologicalTravel","dependencyGetter","topologicalTravel","targetNameList","fullNameList","makeDepndencyGraph","graph","stack","noEntryList","targetNameSet","currComponentType","currVertex","isInTargetNameSet","originalDeps","successor","removeEdgeAndAdd","removeEdge","succComponentType","entryCount","thisItem","createDependencyGraphItem","availableDeps","getAvailableDependencies","dependentName","predecessor","thatItem","dep","RADIAN_EPSILON","_trim","linearMap","domain","clamp","subDomain","subRange","parsePercent$1","all","NaN","round$1","precision","returnStr","asc","getPrecision","getPrecisionSafe","eIndex","dotIndex","getPixelPrecision","dataExtent","pixelExtent","LN10","dataQuantity","sizeQuantity","getPercentWithPrecision","valueList","acc","digits","votesPerQuota","targetSeats","seats","votes","currentSum","NEGATIVE_INFINITY","maxId","MAX_SAFE_INTEGER","remRadian","radian","pi2","isRadianAroundZero","TIME_REG","parseDate","hour","UTC","quantity","quantityExponent","nice","exponent","exp10","nf","reformIntervals","littleThan","curr","currClose","close","lg","isNumeric","number","addCommas","toCamelCase","upperCaseFirst","group1","normalizeCssArray$1","replaceReg","replaceMap","encodeHTML","TPL_VAR_ALIAS","wrapVar","varName","seriesIdx","formatTpl","tpl","paramsList","encode","seriesLen","$vars","alias","formatTplSimple","getTooltipMarker","extraCssText","pad","formatTime","isUTC","date","utc","capitalFirst","truncateText$1","format","each$3","LOCATION_PARAMS","HV_NAMES","boxLayout","orient","group","maxWidth","maxHeight","currentLineMaxSize","nextChild","nextChildRect","nextX","nextY","moveX","newline","moveY","vbox","hbox","getLayoutRect","positionInfo","containerRect","margin","containerHeight","verticalMargin","horizontalMargin","mergeLayoutParam","targetOption","newOption","ignoreSize","hResult","merge$$1","vResult","names","hvIdx","newParams","newValueCount","merged","mergedValueCount","enoughParamNumber","hasProp","hasValue","getLayoutParams","copyLayoutParams","boxLayoutMixin","getBoxLayoutParams","inner$1","ComponentModel","componentIndex","defaultOption","dependentModels","uid","layoutMode","extraOpt","mergeDefaultAndTheme","inputPositionParams","themeModel","getTheme","getDefaultOption","optionUpdated","newCptOption","isInit","fields","optList","Class","getReferringComponents","getDependencies","deps","dependencies","unshift","platform","globalDefault","gradientColor","blendMode","animationDuration","animationDurationUpdate","animationEasingUpdate","animationThreshold","progressiveThreshold","hoverLayerThreshold","useUTC","inner$2","getNearestColorPalette","requestColorNum","paletteNum","colorPaletteMixin","clearColorPalette","colorIdx","colorNameMap","getColorFromPalette","scopeFields","defaultColorPalette","layeredColorPalette","colorPalette","getCoordSysDefineBySeries","seriesModel","coordSysName","coordSysDims","axisMap","categoryAxisMap","fetch","fetchers","cartesian2d","xAxisModel","yAxisModel","isCategory","firstCategoryDimIndex","singleAxis","singleAxisModel","polar","polarModel","radiusAxisModel","findAxisModel","angleAxisModel","geo","parallel","parallelModel","getComponent","dimensions","parallelAxisIndex","axisIndex","axisModel","axisDim","SOURCE_FORMAT_ORIGINAL","SOURCE_FORMAT_ARRAY_ROWS","SOURCE_FORMAT_OBJECT_ROWS","SOURCE_FORMAT_KEYED_COLUMNS","SOURCE_FORMAT_UNKNOWN","SOURCE_FORMAT_TYPED_ARRAY","SERIES_LAYOUT_BY_COLUMN","SERIES_LAYOUT_BY_ROW","Source","fromDataset","sourceFormat","seriesLayoutBy","dimensionsDefine","encodeDefine","startIndex","dimensionsDetectCount","seriesDataToSource","inner$3","detectSourceFormat","datasetModel","getSource","resetSourceDefaulter","datasetMap","prepareSource","seriesOption","sourceHeader","getDatasetModel","datasetOption","completeResult","completeBySourceData","makeDefaultEncode","normalizeDimensionsDefine","findPotentialName","arrayRowsTravelFirst","objectRowsCollectDimensions","colArr","potentialNameDimIndex","dim","nameMap","displayName","maxLoop","firstIndex","coordSysDefine","encodeItemName","encodeSeriesName","seriesType","nSeriesMap","cSeriesMap","datasetRecord","categoryWayDim","valueWayDim","coordDim","dataDim","firstNotOrdinal","doGuessOrdinal","nameDimIndex","itemName","seriesName","thisData","datasetIndex","guessOrdinal","dimIndex","dimName","sample","detectValue","row","OPTION_INNER_KEY","GlobalModel","theme","optionManager","_theme","_optionManager","setOption","optionPreprocessorFuncs","resetOption","optionChanged","baseOption","mountOption","initBase","timelineOption","getTimelineOption","mediaOptions","getMediaOption","_api","mediaOption","componentsMap","_componentsMap","newCptTypes","componentOption","visitComponent","newCptOptionList","getComponentsByTypes","resultItem","ComponentModelClass","createSeriesIndices","_seriesIndicesMap","_seriesIndices","getOption","cpts","isIdArray","cpt","isNameArray","filterBySubType","findComponents","query","queryCond","getQueryCond","doFilter","q","indexAttr","idAttr","nameAttr","eachComponent","components","component","queryResult","getSeriesByName","series","oneSeries","getSeriesByIndex","seriesIndex","getSeriesByType","getSeries","getSeriesCount","eachSeries","rawSeriesIndex","eachRawSeries","eachSeriesByType","eachRawSeriesByType","isSeriesFiltered","getCurrentSeriesIndices","filterSeries","filteredSeries","componentTypes","isNotTargetSeries","seiresIndex","seriesId","mergeTheme","notMergeColorLayer","colorLayer","themeItem","existComponent","seriesModels","echartsAPIList","ExtensionAPI","chartInstance","coordinateSystemCreators","CoordinateSystemManager","_coordinateSystems","api","coordinateSystems","creater","coordSys","getCoordinateSystems","register","coordinateSystemCreator","each$4","clone$3","map$1","merge$1","QUERY_REG","OptionManager","_timelineOptions","_mediaList","_mediaDefault","_currentMediaIndices","_optionBackup","_newBaseOption","rawOption","oldOptionBackup","newParsedOption","parseRawOption","timelineOptions","mediaList","mediaDefault","isRecreate","optionBackup","timelineModel","getCurrentIndex","ecWidth","ecHeight","indices","applyMediaQuery","indicesEquals","isNew","timelineOpt","timeline","media","singleMedia","preProcess","realMap","aspectratio","applicatable","matched","operator","realAttr","real","expect","indices1","indices2","oldOption","newCptOpt","oldCptOpt","each$5","isObject$3","POSSIBLE_STYLES","compatEC2ItemStyle","itemStyleOpt","itemStyle","normalItemStyleOpt","normal","emphasisItemStyleOpt","convertNormalEmphasis","optType","useExtend","normalOpt","emphasisOpt","removeEC3NormalStatus","compatTextStyle","labelOptSingle","compatEC3CommonStyles","processSeries","seriesOpt","markPoint","markLine","markArea","nodes","edgeData","links","edges","categories","mpData","mlData","breadcrumb","levels","leaves","toArr","toObj","compatStyle","isTheme","axes","axisName","axisOpt","axisPointer","parallelOpt","parallelAxisDefault","calendar","calendarOpt","radar","radarOpt","geoOpt","regions","regionObj","toolbox","toolboxOpt","feature","featureOpt","tooltip","set$1","compatLayoutProperties","LAYOUT_PROPERTIES","COMPATITABLE_COMPONENTS","backwardCompat","clockWise","pointerColor","dataRange","visualMap","componentName","dataStack","stackInfoMap","stackInfoList","getData","stackInfo","stackResultDimension","getCalculationInfo","stackedOverDimension","stackedDimension","stackedByDimension","isStackedByIndex","setCalculationInfo","calculateStack","targetStackInfo","idxInStack","resultVal","resultNaN","dims","targetData","byValue","stackedDataRawIndex","getRawIndex","stackedOver","rawIndexOf","getByRawIndex","hostModel","DefaultDataProvider","dimSize","_source","_data","_offset","_dimSize","providerMethods","providerProto","pure","persistent","getItem","appendData","appendDataSimply","countSimply","getItemSimply","col","newCol","oldCol","clean","rawValueGetters","arrayRows","getRawValueSimply","objectRows","keyedColumns","original","typedArray","defaultDimValueGetters","getDimValueSimply","converDataValue","_dimensionInfos","_rawData","hasItemOption","dimInfo","dimType","ordinalMeta","parseAndCollect","retrieveRawValue","getRawDataItem","getProvider","getDimensionInfo","DIMENSION_LABEL_REG","dataFormatMixin","getDataParams","dataType","rawValue","getRawValue","rawDataIndex","getName","itemOpt","getItemVisual","componentSubType","marker","status","labelProp","itemModel","getItemModel","formatter","formatTooltip","createTask","Task","_reset","reset","_plan","plan","_count","_onDirty","onDirty","_dirty","taskProto","perform","performArgs","upTask","_upstream","skip","outputData","__pipeline","currentTask","planResult","lastModBy","normalizeModBy","_modBy","lastModDataCount","_modDataCount","modBy","modDataCount","forceFirstProgress","_dueEnd","_outputDueEnd","_progress","_dueIndex","progress","doProgress","outputDueEnd","_settedOutputEnd","unfinished","iterator","current","winCount","it","sStep","sCount","modNext","sequentialNext","taskIns","_callingProgress","downstream","_downstream","pipe","downTask","_disposed","getUpstream","getDownstream","setOutputEnd","inner$4","SeriesModel","coordinateSystem","legendDataProvider","visualColorAccessPath","dataTask","dataTaskCount","dataTaskReset","getInitialData","wrapData","dataBeforeProcessed","autoSeriesName","themeSubType","fillDataTextStyle","newSeriesOption","label","getRawData","task","getCurrentTask","getLinkedData","modifyOutputEnd","getBaseAxis","multipleSeries","formatArrayValue","vertially","dimItem","tooltipDims","setEachItem","otherDims","dimHead","valStr","formatSingleValue","mapDimension","tooltipDimLen","isValueArr","formattedValue","colorEl","coordDimToDataDim","getProgressive","getProgressiveThreshold","getAxisTooltipData","getTooltipPosition","pipeTask","preventIncremental","pipelineContext","getSeriesAutoName","dataDims","nameArr","cloneShallow","dataTaskProgress","CHANGABLE_METHODS","wrapMethod","onDataSelfChange","scheduler","pipeline","getPipeline","agentStubMap","Component$1","render","componentProto","updateView","updateLayout","updateVisual","createRenderPlanner","originalLarge","large","originalProgressive","progressiveRender","inner$5","renderPlanner","Chart","renderTask","renderTaskPlan","renderTaskReset","view","highlight","toggleHighlight","downplay","incrementalPrepareRender","incrementalRender","chartProto","elSetState","state","dataIdx","getItemGraphicEl","eachItemGraphicEl","markUpdateMethod","updateMethod","progressMethodMap","ORIGIN_METHOD","RATE","THROTTLE_TYPE","throttle","debounce","currCall","lastCall","lastExec","timer","debounceNextCall","thisDelay","thisDebounce","debounceDelay","createOrUpdate","fnAttr","rate","throttleType","originFn","lastThrottleType","lastRate","seriesColor","createOnAllSeries","performRawSeries","colorAccessPath","setVisual","setItemVisual","dataEach","lang","title","polygon","lineX","lineY","keep","dataView","dataZoom","zoom","back","magicType","bar","tiled","saveAsImage","typeNames","pie","scatter","effectScatter","tree","treemap","boxplot","candlestick","heatmap","sankey","funnel","gauge","pictorialBar","themeRiver","sunburst","aria","general","withTitle","withoutTitle","single","prefix","withName","withoutName","multiple","separator","allData","partialData","ariaModel","seriesCnt","maxDataCnt","maxSeriesCnt","displaySeriesCnt","ariaLabel","getTitle","getConfig","seriesLabels","seriesCount","seriesLabel","seriesTpl","getSeriesTypeName","displayCnt","dataLabels","keyValues","userConfig","PI$1","loadingDefault","textColor","maskColor","mask","lineCap","labelRect","Scheduler","ecInstance","dataProcessorHandlers","visualHandlers","_dataProcessorHandlers","_visualHandlers","_allHandlers","_stageTaskMap","taskRecord","overallTask","getPerformArgs","_pipelineMap","pCtx","progressiveEnabled","__idxInPipeline","blockIndex","pipelineId","updateStreamModes","dataLen","threshold","restorePipelines","pipelineMap","prepareStageTasks","stageTaskMap","record","createSeriesStageTask","overallReset","createOverallStageTask","prepareView","__block","performDataProcessorTasks","performStageTasks","performVisualTasks","stageHandlers","stageHandler","visualType","stageHandlerRecord","seriesTaskMap","overallNeedDirty","stub","needSetDirty","updatePayload","setDirty","dirtyMap","performSeriesTasks","getTargetSeries","seriesTaskPlan","seriesTaskReset","seriesTaskCount","useClearVisual","isVisual","isLayout","overallTaskReset","overallProgress","createStub","stubReset","stubOnDirty","agent","upstreamContext","stubProgress","clearAllVisual","resetDefines","makeSeriesTaskProgress","singleSeriesTaskProgress","resetDefineIdx","resetDefine","wrapStageHandler","detectSeriseType","legacyFunc","ecModelMock","apiMock","mockMethods","cond","colorAll","lightTheme","contrastColor","axisCommon","axisLine","lineStyle","axisTick","axisLabel","splitLine","splitArea","areaStyle","crossStyle","legend","iconStyle","borderColor","controlStyle","timeAxis","logAxis","valueAxis","categoryAxis","symbol","color0","borderColor0","TEST_FRAME_REMAIN_TIME","PRIORITY_PROCESSOR_FILTER","PRIORITY_PROCESSOR_STATISTIC","PRIORITY_VISUAL_LAYOUT","PRIORITY_VISUAL_GLOBAL","PRIORITY_VISUAL_CHART","PRIORITY_VISUAL_COMPONENT","PRIORITY_VISUAL_BRUSH","PRIORITY","PROCESSOR","FILTER","STATISTIC","VISUAL","LAYOUT","GLOBAL","CHART","COMPONENT","BRUSH","IN_MAIN_PROCESS","OPTION_UPDATED","ACTION_REG","createRegisterEventWithLowercaseName","MessageCenter","ECharts","theme$$1","themeStorage","_dom","defaultRenderer","_zr","_throttledZrFlush","_chartsViews","_chartsMap","_componentsViews","_coordSysMgr","createExtensionAPI","prioritySortFunc","__prio","visualFuncs","dataProcessorFuncs","_scheduler","_messageCenter","_initEvents","_pendingActions","_onframe","bindRenderedEvent","echartsProto","prepare","updateMethods","flushPendingActions","triggerUpdatedEvent","remainTime","_model","renderSeries","getDom","getZr","notMerge","lazyUpdate","setTheme","getDevicePixelRatio","getSvgDataUrl","pathToDataUrl","getDataURL","excludeComponents","excludesComponentViews","__viewId","url","toDataURL","getConnectedDataURL","groupId","MAX_NUMBER","connectedGroups","canvasList","instances","chart","targetCanvas","convertToPixel","doConvertPixel","convertFromPixel","coordSysList","containPixel","containPoint","getVisual","getViewOfComponentModel","getViewOfSeriesModel","prepareAndUpdate","coordSysMgr","performPostUpdateFuncs","ecIns","componentDirtyList","componentView","__alive","seriesDirtyMap","chartView","updateDirectly","callView","excludeSeriesId","__model","_loadingFX","chartsMap","showLoading","cfg","hideLoading","loadingEffects","makeActionFromEvent","eventObj","eventActionMap","dispatchAction","actions","doDispatchAction","payloadType","escapeConnect","actionWrap","actionInfo","cptType","payloads","batched","batch","eventObjBatch","isHighDown","batchItem","action","pendingActions","isComponent","viewList","viewMap","doPrepare","viewId","classType","__id","__ecComponentInfo","renderComponents","dirtyList","updateZ","updateBlend","updateHoverLayerStatus","postUpdateFuncs","MOUSE_EVENT_NAMES","eveName","dataModel","eventData","actionType","isDisposed","DOM_ATTRIBUTE_KEY","elCount","getComponentByElement","modelInfo","idBase","groupIdBase","mapDataStores","enableConnect","STATUS_PENDING","STATUS_UPDATING","STATUS_UPDATED","STATUS_KEY","updateConnectedChartsStatus","charts","otherChart","otherCharts","existInstance","getInstanceByDom","connect","disConnect","disconnect","getInstanceById","registerTheme","registerPreprocessor","preprocessorFunc","registerProcessor","priority","processor","normalizeRegister","registerPostUpdate","postUpdateFunc","registerAction","registerCoordinateSystem","CoordinateSystem$$1","getCoordinateSystemDimensions","coordSysCreator","getDimensionsInfo","registerLayout","layoutTask","registerVisual","visualTask","targetList","defaultPriority","__raw","registerLoading","loadingFx","extendComponentModel","extendComponentView","extendSeriesModel","extendChartView","setCanvasCreator","creator","registerMap","mapName","geoJson","specialAreas","features","JSON","getMap","dataTool","defaultKeyGetter","DataDiffer","oldArr","newArr","oldKeyGetter","newKeyGetter","_old","_new","_oldKeyGetter","_newKeyGetter","_add","_remove","execute","oldDataIndexMap","newDataIndexMap","oldDataKeyArr","newDataKeyArr","initIndexMap","keyArr","keyGetterName","dataDiffer","existence","OTHER_DIMENSIONS","summarizeDimensions","summary","notExtraCoordDimMap","defaultedLabel","defaultedTooltip","coordDimArr","coordDimIndex","isExtraCoord","mayLabelDimType","defaultTooltip","otherDim","otherDimArr","dataDimsOnCoord","encodeFirstDimNotExtra","dimArr","encodeLabel","encodeTooltip","getDimensionTypeByAxis","axisType","isObject$4","UNDEFINED","ID_PREFIX","dataCtors","Float64Array","Int32Array","CtorUint32Array","Uint32Array","CtorUint16Array","Uint16Array","getIndicesCtor","_rawCount","cloneChunk","originalChunk","TRANSFERABLE_PROPERTIES","CLONE_PROPERTIES","transferProperties","__wrappedMethods","_calculationInfo","List","dimensionInfos","dimensionNames","invertedIndicesMap","dimensionInfo","dimensionName","createInvertedIndices","_indices","_storage","_nameList","_idList","_optionModels","_visual","_layout","_itemVisuals","hasItemVisual","_itemLayouts","_graphicEls","_chunkSize","_chunkCount","_rawExtent","_extent","_approximateExtent","_dimensionsSummary","_invertedIndicesMap","listProto","getDimension","getDimensionsOnCoord","dimensionsSummary","initData","nameList","dimValueGetter","notProvider","_nameRepeatCount","defaultDimValueGetter","_dimValueGetter","_initDataFromProvider","rawData","chunkSize","dimLen","dimensionInfoMap","idList","rawExtent","nameRepeatCount","nameDimIdx","chunkCount","lastChunkIndex","getInitialExtent","_nameDimIdx","itemId","_idDimIdx","DataCtor","resizeChunkArray","newStore","chunkIndex","chunkOffset","dimStorage","dimRawExtent","nameDim","nameDimChunk","prepareInvertedIndex","invertedIndices","getRawValueFromStore","rawIndex","chunk","getIndices","newIndices","thisCount","buffer","chunkStore","rawIdx","dimStore","_getFast","getValues","getDataExtent","dimData","initialExtent","currEnd","useRaw","dimExtent","getApproximateExtent","setApproximateExtent","extent","getSum","getMedian","dimDataArray","sortedDimDataArray","indicesOfNearest","maxDistance","nearestIndices","minDist","minDiff","getRawIndexWithoutIndices","getRawIndexWithIndices","normalizeDimensions","contextCompat","filterSelf","dim0","selectRange","originalCount","quickFinished","chunkStorage","dimStorage2","chunkStorage2","val2","dimk","mapArray","cloneListForMapAndSample","excludeDimensions","allDimensions","originalStorage","cloneDimStore","originalDimStore","newDimStore","tmpRetValue","dataCount","retValue","rawExtentOnDim","downSample","dimension","sampleValue","sampleIndex","targetStorage","frameValues","frameSize","originalChunkIndex","originalChunkOffset","sampleFrameIdx","sampleChunkIndex","sampleChunkOffset","otherList","thisList","visual","setLayout","getLayout","getItemLayout","setItemLayout","clearItemLayouts","itemVisual","setItemDataAndSeriesIndex","setItemGraphicEl","dimensionInfoList","injectFunction","originalMethod","TRANSFERABLE_METHODS","completeDimensions","sysDims","dimsDef","encodeDef","dataDimNameMap","coordDimNameMap","dimCount","getDimCount","dimDefItem","userDimName","validDataDims","resultDimIdx","applyDim","availDimIdx","sysDimItem","sysDimIndex","sysDimItemDimsDef","sysDimItemOtherDims","sysDimItemDimsDefItem","generateCoord","generateCoordCount","fromZero","extra","genName","optDimCount","map$$1","createDimensions","coordDimensions","dimensionsCount","enableDataStack","byIndex","stackedCoordDimension","mayStack","stackedByDimInfo","stackedDimInfo","stackedDimCoordDim","stackedDimType","stackedDimCoordIndex","isCalculationCoord","isDimensionStacked","stackedDim","getStackedDimension","targetDim","createListFromArray","registeredCoordSys","coordSysDimDefs","dimInfoList","hasNameEncode","categoryAxisModel","getOrdinalMeta","stackCalculationInfo","isNeedCompleteOrdinalData","sampleItem","firstDataNotNull","Scale","setting","_setting","_interval","getSetting","unionExtent","unionExtentFromData","getExtent","setExtent","thisExtent","isBlank","_isBlank","setBlank","getLabel","OrdinalMeta","_needCollect","needCollect","_deduplication","deduplication","createByAxisModel","dedplication","proto$1","getOrdinal","category","getOrCreateMap","scaleProto","OrdinalScale","_ordinalMeta","rank","getTicks","ticks","niceTicks","niceExtent","roundNumber$1","intervalScaleNiceTicks","splitNumber","minInterval","maxInterval","span","intervalPrecision","getIntervalPrecision","niceTickExtent","fixExtent","intervalScaleGetTicks","safeLimit","tick","roundNumber","IntervalScale","_intervalPrecision","getInterval","setInterval","_niceExtent","reverse","expandSize","fixMax","fixMin","STACK_PREFIX","LARGE_BAR_MIN_WIDTH","LargeArr","getSeriesStackId","getAxisKey","axis","prepareLayoutBarSeries","isOnCartesian","isInLargeMode","makeColumnLayout","barSeries","seriesInfoList","cartesian","baseAxis","axisExtent","bandWidth","getBandWidth","barWidth","barMaxWidth","barGap","barCategoryGap","axisKey","stackId","doCalBarWidthAndOffset","columnsMap","seriesInfo","columnsOnAxis","remainedWidth","autoWidthCount","categoryGap","stacks","barGapPercent","autoWidth","column","widthSum","lastColumn","retrieveColumnLayout","barWidthAndOffset","lastStackCoords","columnLayoutInfo","columnOffset","columnWidth","getOtherAxis","barMinHeight","size","valueDim","baseDim","stacked","isValueAxisH","isHorizontal","valueAxisStart","getValueAxisStart","baseValue","sign","baseCoord","dataToPoint","largeLayout","valueAxisHorizontal","valueDimIdx","largePoints","valuePair","getAxesOnZeroOf","toGlobalCoord","dataToCoord","getGlobalExtent","intervalScaleProto","mathCeil","mathFloor","ONE_SECOND","ONE_MINUTE","ONE_HOUR","ONE_DAY","bisect","TimeScale","stepLvl","_stepLvl","getFullYear","getMonth","getDate","approxTickNum","approxInterval","scaleLevelsLen","scaleLevels","yearSpan","yearStep","timezoneOffset","getTimezoneOffset","scaleProto$1","intervalScaleProto$1","getPrecisionSafe$1","roundingErrorFix","mathFloor$1","mathCeil$1","mathPow$1","mathLog","LogScale","_originalScale","originalScale","originalExtent","powVal","__fixMin","fixRoundingError","__fixMax","err","originalVal","getScaleExtent","scaleType","getMin","getMax","axisDataLen","boundaryGap","getCategories","getNeedCrossZero","barSeriesModels","isBaseAxisAndHasBarSeries","adjustedScale","adjustScaleForOverflow","axisLength","barsOnCurrentAxis","minOverflow","maxOverflow","totalOverFlow","oldRange","oldRangePercentOfNew","overflowBuffer","niceScaleExtent","createScaleByModel","ifAxisCrossZero","makeLabelFormatter","labelFormatter","getLabelModel","categoryTickStart","tickValue","getAxisRawValue","estimateLabelUnionRect","realNumberScaleTicks","tickCount","categoryScaleExtent","axisLabelModel","unrotatedSingleRect","singleRect","rotateTextRect","rotateRadians","boundingBox","beforeWidth","beforeHeight","afterWidth","afterHeight","rotatedRect","axisModelCommonMixin","rangeStart","rangeEnd","getCoordSysModel","setRange","resetRange","Triangle","Diamond","Pin","tanX","tanY","cpLen","cpLen2","Arrow","symbolCtors","roundRect","square","circle","diamond","pin","arrow","triangle","symbolShapeMakers","symbolBuildProxies","SymbolClz","symbolType","proxySymbol","symbolPathSetColor","innerColor","symbolStyle","symbolShape","__isEmptyBrush","createSymbol","keepAspect","symbolPath","setColor","createList","dataStack$1","createScale","mixinAxisModelCommonMethods","Model$$1","helper","EPSILON$3","isAroundEqual$1","contain$1","Region","geometries","cp","exterior","loopGeo","interiors","transformTo","decode","json","UTF8Encoding","encodeScale","UTF8Scale","geometry","coordinates","encodeOffsets","coordinate","decodePolygon","c2","prevX","prevY","parseGeoJSON","featureObj","region","inner$6","createAxisLabels","makeCategoryLabels","makeRealNumberLabels","createAxisTicks","tickModel","makeCategoryTicks","makeCategoryLabelsActually","labels","labelCategoryInterval","labelsCache","getListCache","optionLabelInterval","getOptionCategoryInterval","listCacheGet","numericLabelInterval","makeLabelsByCustomizedCategoryInterval","makeAutoCategoryInterval","makeLabelsByNumericCategoryInterval","listCacheSet","ticksCache","optionTickInterval","tickCategoryInterval","labelsResult","labelItem","formattedLabel","rawLabel","cache","autoInterval","calculateCategoryInterval","fetchAutoCategoryIntervalCalculationParams","axisRotate","ordinalScale","ordinalExtent","unitSpan","unitW","unitH","maxW","maxH","dw","dh","lastAutoInterval","lastTickCount","getRotate","categoryInterval","onlyTick","startTick","showMinMax","addItem","tVal","NORMALIZED_EXTENT","Axis","inverse","onBand","containData","fixExtentWithBands","coordToData","pointToData","getTicksCoords","getTickModel","ticksCoords","alignWithLabel","fixOnBandTicksCoords","getViewLabels","nTick","ticksLen","last","ticksItem","parseGeoJson","ecUtil","dimAxisMapper","_axes","Cartesian","_dimList","getAxis","getAxes","getAxesByScale","addAxis","_dataCoordConvert","input","dimList","output","Cartesian2D","axisX","axisY","toLocalCoord","reserved","xAxis","yAxis","clampData","xScale","yScale","xAxisExtent","yAxisExtent","Axis2D","coordExtent","grid","nameLocation","nameRotate","nameTruncate","nameTextStyle","nameGap","triggerEvent","onZero","onZeroAxisIndex","symbolSize","inside","showMinLabel","showMaxLabel","axisDefault","logBase","AXIS_TYPES","axisModelCreator","BaseAxisModelClass","axisTypeDefaulter","extraDefaultOption","thisOption","__ordinalMeta","AxisModel","gridIndex","gridId","getAxisType","extraOption","containLabel","borderWidth","isAxisUsedInTheGrid","gridModel","Grid","_coordsMap","_coordsList","_axesMap","_axesList","_initCartesian","gridProto","axisPointerEnabled","getRect","axesMap","_updateScale","fixAxisOnZero","otherAxisDim","otherAxis","otherAxes","canOnZeroToAxis","ignoreContainLabel","gridRect","axesList","adjustAxes","labelUnionRect","updateAxisTransform","axesMapOnDim","getCartesian","xAxisIndex","yAxisIndex","coordList","getCartesians","_findConvertTarget","coordsList","axisPositionUsed","axesCount","createAxisCreator","axisPosition","isCartesian2D","axesModels","findAxesModels","getTooltipAxes","baseAxes","coordBase","axisExtentSum","axesTypes","grids","BaseBarSeries","getMarkerPosition","pt","offsetIndex","legendHoverLink","barMinAngle","largeThreshold","progressiveChunkMode","brushSelector","getDefaultLabel","labelDims","vals","setLabel","labelPositionOutside","hoverLabelModel","fixPosition","getBarItemStyle","barItemStyle","BAR_BORDER_WIDTH_QUERY","_updateDrawMode","coordinateSystemType","_isLargeDraw","_renderLarge","_renderNormal","_clear","_incrementalRenderLarge","isLargeDraw","oldData","isHorizontalOrRadial","animationModel","elementCreator","updateStyle","newIndex","oldIndex","removeRect","removeSector","createLarge","rectShape","animateProperty","animateTarget","isRadial","sector","sectorShape","fixedLineWidth","getLineWidth","signX","signY","isPolar","itemStyleModel","rawLayout","LargePath","startPoint","__startPoint","valueIdx","__valueIdx","setLargeStyle","PI$2","makeAxisEventDataBase","AxisBuilder","labelOffset","nameDirection","tickDirection","labelDirection","dumbGroup","_transform","_dumbGroup","hasBuilder","builders","getGroup","pt1","pt2","arrows","arrowSize","arrowOffset","symbolWidth","symbolHeight","axisTickLabel","tickEls","buildAxisTick","labelEls","buildAxisLabel","fixMinMaxLabelShow","gapSignal","isNameLocationCenter","labelLayout","nameRotation","axisNameAvailableWidth","innerTextLayout","endTextLayout","truncateOpt","nameTruncateMaxWidth","truncatedText","tooltipOpt","formatterParams","textEl","__fullText","__truncatedText","content","targetType","axisRotation","rotationDiff","textRotate","onLeft","firstLabel","nextLabel","lastLabel","prevLabel","firstTick","nextTick","lastTick","prevTick","ignoreEl","isTwoLabelOverlapped","firstRect","nextRect","mRotationBack","axisBuilder","lineStyleModel","tickLen","tickCoord","tickEl","axisLabelShow","labelMargin","labelRotation","rawCategoryData","itemLabelModel","each$6","curry$1","collect","axesInfo","seriesInvolved","coordSysAxesInfo","coordSysMap","collectAxesInfo","collectSeriesInfo","globalTooltipModel","globalAxisPointerModel","linksOption","linkGroups","coordSysKey","makeKey","axesInfoInCoordSys","coordSysModel","baseTooltipModel","saveTooltipAxisInfo","triggerAxis","cross","tooltipAxes","fromTooltip","triggerTooltip","axisPointerModel","axisPointerShow","isHandleTrigger","makeAxisPointerModel","snap","involveSeries","axisInfo","useHandle","groupIndex","getLinkGroupIndex","linkGroup","mapper","tooltipAxisPointerModel","volatileOption","field","labelOption","tooltipAxisPointerLabelShow","seriesTooltipTrigger","seriesTooltipShow","seriesDataCount","linkOption","checkPropInLink","linkPropValue","axisPropValue","fixValue","getAxisInfo","getAxisPointerModel","AxisView","_axisPointer","axisPointerClass","updateAxisPointer","disposeAxisPointer","axisView","forceRender","getAxisPointerClass","axisPointerClazz","registerAxisPointerClass","layout$1","otherAxisOnZeroOf","rawAxisPosition","rectBound","axisOffset","posBound","onZeroCoord","dirMap","labelInside","axisBuilderAttrs","selfBuilderAttrs","CartesianAxisView","oldAxisGroup","_axisGroup","_splitAreaColors","_splitLine","splitLineModel","lineColors","lineCount","colorIndex","_splitArea","splitAreaModel","areaStyleModel","areaColors","areaColorsLen","lastSplitAreaColors","newSplitAreaColors","cIndex","subtext","subtarget","itemGap","subtextStyle","titleModel","subtextStyleModel","subText","subTextEl","link","sublink","open","groupRect","layoutOption","layoutRect","alignStyle","LegendModel","selected","_updateData","legendData","hasSelected","isSelected","select","potentialData","availableNames","isPotential","_availableNames","selectedMode","unSelect","toggleSelected","align","borderRadius","itemWidth","itemHeight","inactiveColor","legendSelectActionHandler","selectedMap","isToggleSelect","legendModel","isItemSelected","makeBackground","curry$2","each$7","Group$2","LegendView","newlineDisabled","_contentGroup","_backgroundEl","getContentGroup","resetInner","itemAlign","renderInner","viewportSize","mainRect","layoutInner","contentGroup","legendDrawnMap","selectMode","legendSymbolType","itemGroup","_createItem","dispatchSelectAction","dispatchHighlightAction","dispatchDownplayAction","symbolKeepAspect","itemIcon","tooltipModel","legendGlobalTooltipModel","hitRect","legendIndex","__legendDataIndex","contentRect","dataName","legendFilter","legendModels","ScrollableLegendModel","setScrollDataIndex","scrollDataIndex","pageButtonItemGap","pageButtonGap","pageButtonPosition","pageFormatter","pageIcons","horizontal","vertical","pageIconColor","pageIconInactiveColor","pageIconSize","pageTextStyle","mergeAndNormalizeLayoutParams","getOrient","raw","Group$3","WH","XY","ScrollableLegendView","_currentIndex","_containerGroup","_controllerGroup","_showController","__rectSize","me","controllerGroup","createPageButton","pageTextStyleModel","iconIdx","pageDataIndexName","icon","onclick","_pageGo","containerGroup","orientIdx","hw","yx","controllerRect","showController","contentPos","containerPos","controllerPos","clipShape","pageInfo","_getPageInfo","pageIndex","contentPosition","_updatePageInfoView","to","legendId","canJump","pageText","pageCount","currDataIndex","containerRectSize","xy","pagePrevDataIndex","pageNextDataIndex","targetItemGroup","itemRect","itemLoc","winRect","startIdx","getItemRect","startItem","startRect","findPointFromSeries","each$8","curry$3","inner$7","axisTrigger","currTrigger","illegalPoint","isIllegalPoint","inputAxesInfo","shouldHide","outputFinder","showValueMap","dataByCoordSys","updaters","showPointer","showTooltip","coordSysContainsPoint","inputAxisInfo","findInputAxisInfo","processOnAxis","linkTriggers","tarAxisInfo","tarKey","srcAxisInfo","srcKey","srcValItem","makeMapperParam","updateModelActually","dispatchTooltipActually","dispatchHighDownActually","newValue","dontSnap","payloadInfo","buildPayloadsBySeries","payloadBatch","snapToValue","seriesNestestValue","dataIndices","nestestValue","coordSysItem","coordSysId","coordSysIndex","coordSysType","coordSysMainType","dataByAxis","axisId","valueLabelOpt","seriesDataIndices","outputAxesInfo","valItem","tooltipOption","highDownKey","lastHighlights","newHighlights","toHighlight","toDownplay","AxisPointerModel","triggerOn","shadowStyle","handle","inner$8","each$9","records","initGlobalListeners","initialized","useHandler","doEnter","onLeave","dis","makeDispatchAction","dispatchTooltipFinally","pendings","showLen","showTip","hideLen","hideTip","actuallyPayload","unregister","AxisPointerView","inner$9","clone$4","bind$1","BaseAxisPointer","_group","_lastGraphicKey","_handle","_dragging","_lastValue","_lastStatus","_payloadInfo","_axisModel","_axisPointerModel","elOption","makeElOption","graphicKey","moveAnimation","_moveAnimation","determineAnimation","createPointerEl","createLabelEl","doUpdateProps","updateProps$1","updatePointerEl","updateLabelEl","updateMandatoryProps","_renderHandle","isCategoryAxis","useSnap","pointerOption","pointer","pointerEl","labelEl","updateLabelShowHide","updateProps$$1","updateHandleTransform","handleModel","onmousemove","onmousedown","_onHandleDragMove","ondragend","_onHandleDragEnd","includeStyles","handleSize","_moveHandleToValue","getHandleTransProps","getHandleTransform","trans","lastProp","_doDispatchAxisPointer","cursorPoint","doClear","buildLabel","xDimIndex","propsEqual","lastProps","newProps","equals","buildElStyle","axisPointerType","styleModel","buildLabelElOption","labelPos","getValueLabel","paddings","verticalAlign","confineInContainer","bgColor","viewWidth","viewHeight","seriesData","idxItem","dataParams","getTransformedPosition","layoutInfo","buildCartesianSingleLabelElOption","textLayout","makeLineShape","makeRectShape","CartesianAxisPointer","otherExtent","pixelValue","elStyle","pointerShapeBuilder","currPosition","cursorOtherValue","tooltipOptions","targetShape","getAxisDimIndex","shadow","showContent","alwaysShowContent","displayMode","confine","showDelay","hideDelay","transitionDuration","enterable","each$11","toCamelCase$1","vendors","gCssText","assembleTransition","transitionCurve","transitionText","vendorPrefix","assembleFont","assembleCssText","borderName","camelCase","TooltipContent","_container","_show","_hideTimeout","onmouseenter","_enterable","_inContent","onmouseleave","hideLater","_hideDelay","currentStyle","setContent","setEnterable","getSize","clientWidth","clientHeight","viewportRootOffset","isShow","bind$2","each$10","parsePercent$2","proxyRect","tooltipContent","_tooltipContent","_tooltipModel","_ecModel","_lastDataByCoordSys","_alwaysShowContent","_initGlobalListener","_keepShow","_tryShow","_hide","_refreshUpdateTimeout","manuallyShowTip","makeDispatchAction$1","_ticket","_manuallyAxisShowTip","pointInfo","manuallyHideTip","buildTooltipModel","_showAxisTooltip","_showSeriesItemTooltip","_showComponentItemTooltip","_showOrMove","_showTimout","singleDefaultHTML","singleParamsList","singleTooltipModel","itemCoordSys","axisValue","seriesDefaultHTML","valueLabel","axisValueLabel","firstLine","positionExpr","_updateContentNotChangedOnAxis","_updatePosition","_showTooltipContent","tooltipTrigger","defaultHtml","asyncTicket","subTooltipModel","html","cbTicket","contentSize","vAlign","viewSize","calcTooltipPosition","refixTooltipPosition","isCenterAlign","confineTooltipPosition","lastCoordSys","contentNotChanged","lastItemCoordSys","indexCoordSys","lastDataByAxis","thisItemCoordSys","thisDataByAxis","lastItem","indexAxis","lastIndices","lastIdxItem","newIdxItem","modelCascade","resultModel","gapH","gapV","getOuterSize","paddingLeft","paddingRight","borderLeftWidth","borderRightWidth","paddingTop","paddingBottom","borderTopWidth","borderBottomWidth","domWidth","domHeight","rectWidth","rectHeight","util"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAC,WAAUA,MAAV,EAAkBC,OAAlB,EAA2B;AAC3B,UAAOC,OAAP,yCAAOA,OAAP,OAAmB,QAAnB,IAA+B,OAAOC,MAAP,KAAkB,WAAjD,GAA+DF,QAAQC,OAAR,CAA/D,GACA,OAAOE,MAAP,KAAkB,UAAlB,IAAgCA,OAAOC,GAAvC,GAA6CD,OAAO,CAAC,SAAD,CAAP,EAAoBH,OAApB,CAA7C,GACCA,QAASD,OAAOM,OAAP,GAAiB,EAA1B,CAFD;AAGA,CAJA,EAIC,IAJD,EAIQ,UAAUJ,OAAV,EAAmB;AAAE;;AAE9B;;;;;;;;;;;;;;;;;;AAkBA;AACA;AACA;AACA;AACA;;AAEA;;;;;;AAKA,MAAIK,UAAU,MAAd;AACA,MAAIC,OAAO,SAAPA,IAAO,GAAY;AACrB,WAAOD,SAAP;AACD,GAFD;;AAIA;;;;;;;AAOA,MAAIE,MAAM,EAAV;;AAEA,MAAI,QAAOC,EAAP,yCAAOA,EAAP,OAAc,QAAd,IAA0B,OAAOA,GAAGC,iBAAV,KAAgC,UAA9D,EAA0E;AACxE;AACAF,UAAM;AACJG,eAAS,EADL;AAEJC,UAAI,EAFA;AAGJC,YAAM,KAHF;AAIJC,WAAK,IAJD;AAKJ;AACAC,uBAAiB,IANb;AAOJC,oBAAc,KAPV;AAQJC,4BAAsB;AARlB,KAAN;AAUD,GAZD,MAYO,IAAI,OAAOC,QAAP,KAAoB,WAApB,IAAmC,OAAOC,IAAP,KAAgB,WAAvD,EAAoE;AACzE;AACAX,UAAM;AACJG,eAAS,EADL;AAEJC,UAAI,EAFA;AAGJC,YAAM,KAHF;AAIJO,cAAQ,IAJJ;AAKJL,uBAAiB;AALb,KAAN;AAOD,GATM,MASA,IAAI,OAAOM,SAAP,KAAqB,WAAzB,EAAsC;AAC3C;AACAb,UAAM;AACJG,eAAS,EADL;AAEJC,UAAI,EAFA;AAGJC,YAAM,IAHF;AAIJO,cAAQ,KAJJ;AAKJ;AACAL,uBAAiB,IANb;AAOJC,oBAAc;AAPV,KAAN;AASD,GAXM,MAWA;AACLR,UAAMc,OAAOD,UAAUE,SAAjB,CAAN;AACD;;AAED,MAAIC,QAAQhB,GAAZ,CAjF4B,CAiFX;AACjB;AACA;;AAEA,WAASc,MAAT,CAAgBG,EAAhB,EAAoB;AAClB,QAAIb,KAAK,EAAT;AACA,QAAID,UAAU,EAAd,CAFkB,CAEA;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,QAAIe,UAAUD,GAAGE,KAAH,CAAS,mBAAT,CAAd,CAjBkB,CAiB2B;AAC7C;;AAEA,QAAIC,KAAKH,GAAGE,KAAH,CAAS,gBAAT,EAA2B;AAA3B,OACNF,GAAGE,KAAH,CAAS,2BAAT,CADH;AAEA,QAAIE,OAAOJ,GAAGE,KAAH,CAAS,gBAAT,CAAX,CAtBkB,CAsBqB;;AAEvC,QAAIG,SAAS,kBAAkBC,IAAlB,CAAuBN,EAAvB,CAAb,CAxBkB,CAwBuB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,QAAIC,OAAJ,EAAa;AACXf,cAAQe,OAAR,GAAkB,IAAlB;AACAf,cAAQqB,OAAR,GAAkBN,QAAQ,CAAR,CAAlB;AACD,KAhDiB,CAgDhB;AACF;;;AAGA,QAAIE,EAAJ,EAAQ;AACNjB,cAAQiB,EAAR,GAAa,IAAb;AACAjB,cAAQqB,OAAR,GAAkBJ,GAAG,CAAH,CAAlB;AACD;;AAED,QAAIC,IAAJ,EAAU;AACRlB,cAAQkB,IAAR,GAAe,IAAf;AACAlB,cAAQqB,OAAR,GAAkBH,KAAK,CAAL,CAAlB;AACD,KA5DiB,CA4DhB;AACF;;;AAGA,QAAIC,MAAJ,EAAY;AACVnB,cAAQmB,MAAR,GAAiB,IAAjB;AACD,KAlEiB,CAkEhB;AACF;AACA;AACA;AACA;;;AAGA,WAAO;AACLnB,eAASA,OADJ;AAELC,UAAIA,EAFC;AAGLC,YAAM,KAHD;AAIL;AACA;AACAE,uBAAiB,CAAC,CAACG,SAASe,aAAT,CAAuB,QAAvB,EAAiCC,UAN/C;AAOLlB,oBAAc,OAAOmB,OAAP,KAAmB,WAP5B;AAQL;AACA;AACA;AACAlB,4BAAsB,kBAAkBmB,MAAlB,IAA4B,CAACzB,QAAQiB,EAArC,IAA2C,CAACjB,QAAQkB,IAXrE;AAYL;AACAQ,8BAAwB,mBAAmBD,MAAnB,CAA0B;AAClD;AACA;AACA;AAHwB,UAIpBzB,QAAQkB,IAAR,IAAgBlB,QAAQiB,EAAR,IAAcjB,QAAQqB,OAAR,IAAmB,EAJ7B,CAbnB,CAiBoD;;AAjBpD,KAAP;AAoBD,GAlL2B,CAkL1B;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA;AACA,MAAIM,iBAAiB;AACnB,yBAAqB,CADF;AAEnB,uBAAmB,CAFA;AAGnB,qBAAiB,CAHE;AAInB,sBAAkB,CAJC;AAKnB,+BAA2B,CALR;AAMnB,8BAA0B,CANP;AAOnB;AACA,sBAAkB,CARC;AASnB,uBAAmB;AATA,GAArB;AAWA,MAAIC,cAAc;AAChB,0BAAsB,CADN;AAEhB,2BAAuB,CAFP;AAGhB,kCAA8B,CAHd;AAIhB,2BAAuB,CAJP;AAKhB,4BAAwB,CALR;AAMhB,2BAAuB,CANP;AAOhB,4BAAwB,CAPR;AAQhB,6BAAyB,CART;AAShB,6BAAyB;AATT,GAAlB;AAWA,MAAIC,cAAcC,OAAOC,SAAP,CAAiBC,QAAnC;AACA,MAAIC,aAAaC,MAAMH,SAAvB;AACA,MAAII,gBAAgBF,WAAWG,OAA/B;AACA,MAAIC,eAAeJ,WAAWK,MAA9B;AACA,MAAIC,cAAcN,WAAWO,KAA7B;AACA,MAAIC,YAAYR,WAAWS,GAA3B;AACA,MAAIC,eAAeV,WAAWW,MAA9B,CAlO4B,CAkOU;;AAEtC,MAAIC,UAAU,EAAd;AACA,WAASC,SAAT,CAAmBC,IAAnB,EAAyBC,EAAzB,EAA6B;AAC3B;AACA,QAAID,SAAS,cAAb,EAA6B;AAC3BE,aAAO,IAAP;AACD;;AAEDJ,YAAQE,IAAR,IAAgBC,EAAhB;AACD;AACD;;;;;;;;;;;;;;;;;AAiBA,WAASE,MAAT,CAAeC,MAAf,EAAuB;AACrB,QAAIA,UAAU,IAAV,IAAkB,QAAOA,MAAP,yCAAOA,MAAP,MAAiB,QAAvC,EAAiD;AAC/C,aAAOA,MAAP;AACD;;AAED,QAAIC,SAASD,MAAb;AACA,QAAIE,UAAUxB,YAAYyB,IAAZ,CAAiBH,MAAjB,CAAd;;AAEA,QAAIE,YAAY,gBAAhB,EAAkC;AAChC,UAAI,CAACE,YAAYJ,MAAZ,CAAL,EAA0B;AACxBC,iBAAS,EAAT;;AAEA,aAAK,IAAII,IAAI,CAAR,EAAWC,MAAMN,OAAOO,MAA7B,EAAqCF,IAAIC,GAAzC,EAA8CD,GAA9C,EAAmD;AACjDJ,iBAAOI,CAAP,IAAYN,OAAMC,OAAOK,CAAP,CAAN,CAAZ;AACD;AACF;AACF,KARD,MAQO,IAAI5B,YAAYyB,OAAZ,CAAJ,EAA0B;AAC/B,UAAI,CAACE,YAAYJ,MAAZ,CAAL,EAA0B;AACxB,YAAIQ,OAAOR,OAAOS,WAAlB;;AAEA,YAAIT,OAAOS,WAAP,CAAmBC,IAAvB,EAA6B;AAC3BT,mBAASO,KAAKE,IAAL,CAAUV,MAAV,CAAT;AACD,SAFD,MAEO;AACLC,mBAAS,IAAIO,IAAJ,CAASR,OAAOO,MAAhB,CAAT;;AAEA,eAAK,IAAIF,IAAI,CAAR,EAAWC,MAAMN,OAAOO,MAA7B,EAAqCF,IAAIC,GAAzC,EAA8CD,GAA9C,EAAmD;AACjDJ,mBAAOI,CAAP,IAAYN,OAAMC,OAAOK,CAAP,CAAN,CAAZ;AACD;AACF;AACF;AACF,KAdM,MAcA,IAAI,CAAC7B,eAAe0B,OAAf,CAAD,IAA4B,CAACE,YAAYJ,MAAZ,CAA7B,IAAoD,CAACW,MAAMX,MAAN,CAAzD,EAAwE;AAC7EC,eAAS,EAAT;;AAEA,WAAK,IAAIW,GAAT,IAAgBZ,MAAhB,EAAwB;AACtB,YAAIA,OAAOa,cAAP,CAAsBD,GAAtB,CAAJ,EAAgC;AAC9BX,iBAAOW,GAAP,IAAcb,OAAMC,OAAOY,GAAP,CAAN,CAAd;AACD;AACF;AACF;;AAED,WAAOX,MAAP;AACD;AACD;;;;;;;AAOA,WAASa,KAAT,CAAeC,MAAf,EAAuBf,MAAvB,EAA+BgB,SAA/B,EAA0C;AACxC;AACA;AACA,QAAI,CAACC,WAAWjB,MAAX,CAAD,IAAuB,CAACiB,WAAWF,MAAX,CAA5B,EAAgD;AAC9C,aAAOC,YAAYjB,OAAMC,MAAN,CAAZ,GAA4Be,MAAnC;AACD;;AAED,SAAK,IAAIH,GAAT,IAAgBZ,MAAhB,EAAwB;AACtB,UAAIA,OAAOa,cAAP,CAAsBD,GAAtB,CAAJ,EAAgC;AAC9B,YAAIM,aAAaH,OAAOH,GAAP,CAAjB;AACA,YAAIO,aAAanB,OAAOY,GAAP,CAAjB;;AAEA,YAAIK,WAAWE,UAAX,KAA0BF,WAAWC,UAAX,CAA1B,IAAoD,CAACE,QAAQD,UAAR,CAArD,IAA4E,CAACC,QAAQF,UAAR,CAA7E,IAAoG,CAACP,MAAMQ,UAAN,CAArG,IAA0H,CAACR,MAAMO,UAAN,CAA3H,IAAgJ,CAACG,gBAAgBF,UAAhB,CAAjJ,IAAgL,CAACE,gBAAgBH,UAAhB,CAAjL,IAAgN,CAACd,YAAYe,UAAZ,CAAjN,IAA4O,CAACf,YAAYc,UAAZ,CAAjP,EAA0Q;AACxQ;AACAJ,gBAAMI,UAAN,EAAkBC,UAAlB,EAA8BH,SAA9B;AACD,SAHD,MAGO,IAAIA,aAAa,EAAEJ,OAAOG,MAAT,CAAjB,EAAmC;AACxC;AACA;AACAA,iBAAOH,GAAP,IAAcb,OAAMC,OAAOY,GAAP,CAAN,EAAmB,IAAnB,CAAd;AACD;AACF;AACF;;AAED,WAAOG,MAAP;AACD;AACD;;;;;;AAMA,WAASO,QAAT,CAAkBC,gBAAlB,EAAoCP,SAApC,EAA+C;AAC7C,QAAIf,SAASsB,iBAAiB,CAAjB,CAAb;;AAEA,SAAK,IAAIlB,IAAI,CAAR,EAAWC,MAAMiB,iBAAiBhB,MAAvC,EAA+CF,IAAIC,GAAnD,EAAwDD,GAAxD,EAA6D;AAC3DJ,eAASa,MAAMb,MAAN,EAAcsB,iBAAiBlB,CAAjB,CAAd,EAAmCW,SAAnC,CAAT;AACD;;AAED,WAAOf,MAAP;AACD;AACD;;;;;;AAMA,WAASuB,MAAT,CAAgBT,MAAhB,EAAwBf,MAAxB,EAAgC;AAC9B,SAAK,IAAIY,GAAT,IAAgBZ,MAAhB,EAAwB;AACtB,UAAIA,OAAOa,cAAP,CAAsBD,GAAtB,CAAJ,EAAgC;AAC9BG,eAAOH,GAAP,IAAcZ,OAAOY,GAAP,CAAd;AACD;AACF;;AAED,WAAOG,MAAP;AACD;AACD;;;;;;;AAOA,WAASU,QAAT,CAAkBV,MAAlB,EAA0Bf,MAA1B,EAAkC0B,OAAlC,EAA2C;AACzC,SAAK,IAAId,GAAT,IAAgBZ,MAAhB,EAAwB;AACtB,UAAIA,OAAOa,cAAP,CAAsBD,GAAtB,MAA+Bc,UAAU1B,OAAOY,GAAP,KAAe,IAAzB,GAAgCG,OAAOH,GAAP,KAAe,IAA9E,CAAJ,EAAyF;AACvFG,eAAOH,GAAP,IAAcZ,OAAOY,GAAP,CAAd;AACD;AACF;;AAED,WAAOG,MAAP;AACD;AACD,MAAIY,eAAe,SAAfA,YAAe,GAAY;AAC7B,WAAOjC,QAAQiC,YAAR,EAAP;AACD,GAFD;;AAIAjC,UAAQiC,YAAR,GAAuB,YAAY;AACjC,WAAOvE,SAASe,aAAT,CAAuB,QAAvB,CAAP;AACD,GAFD,CA1X4B,CA4XzB;;;AAGH,MAAI2B,IAAJ;;AAEA,WAAS1B,UAAT,GAAsB;AACpB,QAAI,CAAC0B,IAAL,EAAW;AACT;AACA;AACAA,aAAO6B,eAAevD,UAAf,CAA0B,IAA1B,CAAP;AACD;;AAED,WAAO0B,IAAP;AACD;AACD;;;;;AAKA,WAAS8B,OAAT,CAAiBC,KAAjB,EAAwBC,KAAxB,EAA+B;AAC7B,QAAID,KAAJ,EAAW;AACT,UAAIA,MAAMD,OAAV,EAAmB;AACjB,eAAOC,MAAMD,OAAN,CAAcE,KAAd,CAAP;AACD;;AAED,WAAK,IAAIzB,IAAI,CAAR,EAAWC,MAAMuB,MAAMtB,MAA5B,EAAoCF,IAAIC,GAAxC,EAA6CD,GAA7C,EAAkD;AAChD,YAAIwB,MAAMxB,CAAN,MAAayB,KAAjB,EAAwB;AACtB,iBAAOzB,CAAP;AACD;AACF;AACF;;AAED,WAAO,CAAC,CAAR;AACD;AACD;;;;;;;;AAQA,WAAS0B,QAAT,CAAkBC,KAAlB,EAAyBC,SAAzB,EAAoC;AAClC,QAAIC,iBAAiBF,MAAMpD,SAA3B;;AAEA,aAASuD,CAAT,GAAa,CAAE;;AAEfA,MAAEvD,SAAF,GAAcqD,UAAUrD,SAAxB;AACAoD,UAAMpD,SAAN,GAAkB,IAAIuD,CAAJ,EAAlB;;AAEA,SAAK,IAAIC,IAAT,IAAiBF,cAAjB,EAAiC;AAC/BF,YAAMpD,SAAN,CAAgBwD,IAAhB,IAAwBF,eAAeE,IAAf,CAAxB;AACD;;AAEDJ,UAAMpD,SAAN,CAAgB6B,WAAhB,GAA8BuB,KAA9B;AACAA,UAAMK,UAAN,GAAmBJ,SAAnB;AACD;AACD;;;;;;;AAOA,WAASK,KAAT,CAAevB,MAAf,EAAuBf,MAAvB,EAA+B0B,OAA/B,EAAwC;AACtCX,aAAS,eAAeA,MAAf,GAAwBA,OAAOnC,SAA/B,GAA2CmC,MAApD;AACAf,aAAS,eAAeA,MAAf,GAAwBA,OAAOpB,SAA/B,GAA2CoB,MAApD;AACAyB,aAASV,MAAT,EAAiBf,MAAjB,EAAyB0B,OAAzB;AACD;AACD;;;;;AAKA,WAASa,WAAT,CAAqBC,IAArB,EAA2B;AACzB,QAAI,CAACA,IAAL,EAAW;AACT;AACD;;AAED,QAAI,OAAOA,IAAP,IAAe,QAAnB,EAA6B;AAC3B,aAAO,KAAP;AACD;;AAED,WAAO,OAAOA,KAAKjC,MAAZ,IAAsB,QAA7B;AACD;AACD;;;;;;;;AAQA,WAASkC,MAAT,CAAgBC,GAAhB,EAAqBC,EAArB,EAAyBC,OAAzB,EAAkC;AAChC,QAAI,EAAEF,OAAOC,EAAT,CAAJ,EAAkB;AAChB;AACD;;AAED,QAAID,IAAIzD,OAAJ,IAAeyD,IAAIzD,OAAJ,KAAgBD,aAAnC,EAAkD;AAChD0D,UAAIzD,OAAJ,CAAY0D,EAAZ,EAAgBC,OAAhB;AACD,KAFD,MAEO,IAAIF,IAAInC,MAAJ,KAAe,CAACmC,IAAInC,MAAxB,EAAgC;AACrC,WAAK,IAAIF,IAAI,CAAR,EAAWC,MAAMoC,IAAInC,MAA1B,EAAkCF,IAAIC,GAAtC,EAA2CD,GAA3C,EAAgD;AAC9CsC,WAAGxC,IAAH,CAAQyC,OAAR,EAAiBF,IAAIrC,CAAJ,CAAjB,EAAyBA,CAAzB,EAA4BqC,GAA5B;AACD;AACF,KAJM,MAIA;AACL,WAAK,IAAI9B,GAAT,IAAgB8B,GAAhB,EAAqB;AACnB,YAAIA,IAAI7B,cAAJ,CAAmBD,GAAnB,CAAJ,EAA6B;AAC3B+B,aAAGxC,IAAH,CAAQyC,OAAR,EAAiBF,IAAI9B,GAAJ,CAAjB,EAA2BA,GAA3B,EAAgC8B,GAAhC;AACD;AACF;AACF;AACF;AACD;;;;;;;;;AASA,WAASnD,GAAT,CAAamD,GAAb,EAAkBC,EAAlB,EAAsBC,OAAtB,EAA+B;AAC7B,QAAI,EAAEF,OAAOC,EAAT,CAAJ,EAAkB;AAChB;AACD;;AAED,QAAID,IAAInD,GAAJ,IAAWmD,IAAInD,GAAJ,KAAYD,SAA3B,EAAsC;AACpC,aAAOoD,IAAInD,GAAJ,CAAQoD,EAAR,EAAYC,OAAZ,CAAP;AACD,KAFD,MAEO;AACL,UAAI3C,SAAS,EAAb;;AAEA,WAAK,IAAII,IAAI,CAAR,EAAWC,MAAMoC,IAAInC,MAA1B,EAAkCF,IAAIC,GAAtC,EAA2CD,GAA3C,EAAgD;AAC9CJ,eAAO4C,IAAP,CAAYF,GAAGxC,IAAH,CAAQyC,OAAR,EAAiBF,IAAIrC,CAAJ,CAAjB,EAAyBA,CAAzB,EAA4BqC,GAA5B,CAAZ;AACD;;AAED,aAAOzC,MAAP;AACD;AACF;AACD;;;;;;;;;AASA,WAASR,MAAT,CAAgBiD,GAAhB,EAAqBC,EAArB,EAAyBG,IAAzB,EAA+BF,OAA/B,EAAwC;AACtC,QAAI,EAAEF,OAAOC,EAAT,CAAJ,EAAkB;AAChB;AACD;;AAED,QAAID,IAAIjD,MAAJ,IAAciD,IAAIjD,MAAJ,KAAeD,YAAjC,EAA+C;AAC7C,aAAOkD,IAAIjD,MAAJ,CAAWkD,EAAX,EAAeG,IAAf,EAAqBF,OAArB,CAAP;AACD,KAFD,MAEO;AACL,WAAK,IAAIvC,IAAI,CAAR,EAAWC,MAAMoC,IAAInC,MAA1B,EAAkCF,IAAIC,GAAtC,EAA2CD,GAA3C,EAAgD;AAC9CyC,eAAOH,GAAGxC,IAAH,CAAQyC,OAAR,EAAiBE,IAAjB,EAAuBJ,IAAIrC,CAAJ,CAAvB,EAA+BA,CAA/B,EAAkCqC,GAAlC,CAAP;AACD;;AAED,aAAOI,IAAP;AACD;AACF;AACD;;;;;;;;;AASA,WAAS3D,MAAT,CAAgBuD,GAAhB,EAAqBC,EAArB,EAAyBC,OAAzB,EAAkC;AAChC,QAAI,EAAEF,OAAOC,EAAT,CAAJ,EAAkB;AAChB;AACD;;AAED,QAAID,IAAIvD,MAAJ,IAAcuD,IAAIvD,MAAJ,KAAeD,YAAjC,EAA+C;AAC7C,aAAOwD,IAAIvD,MAAJ,CAAWwD,EAAX,EAAeC,OAAf,CAAP;AACD,KAFD,MAEO;AACL,UAAI3C,SAAS,EAAb;;AAEA,WAAK,IAAII,IAAI,CAAR,EAAWC,MAAMoC,IAAInC,MAA1B,EAAkCF,IAAIC,GAAtC,EAA2CD,GAA3C,EAAgD;AAC9C,YAAIsC,GAAGxC,IAAH,CAAQyC,OAAR,EAAiBF,IAAIrC,CAAJ,CAAjB,EAAyBA,CAAzB,EAA4BqC,GAA5B,CAAJ,EAAsC;AACpCzC,iBAAO4C,IAAP,CAAYH,IAAIrC,CAAJ,CAAZ;AACD;AACF;;AAED,aAAOJ,MAAP;AACD;AACF;AACD;;;;;;;;;AASA,WAAS8C,IAAT,CAAcL,GAAd,EAAmBC,EAAnB,EAAuBC,OAAvB,EAAgC;AAC9B,QAAI,EAAEF,OAAOC,EAAT,CAAJ,EAAkB;AAChB;AACD;;AAED,SAAK,IAAItC,IAAI,CAAR,EAAWC,MAAMoC,IAAInC,MAA1B,EAAkCF,IAAIC,GAAtC,EAA2CD,GAA3C,EAAgD;AAC9C,UAAIsC,GAAGxC,IAAH,CAAQyC,OAAR,EAAiBF,IAAIrC,CAAJ,CAAjB,EAAyBA,CAAzB,EAA4BqC,GAA5B,CAAJ,EAAsC;AACpC,eAAOA,IAAIrC,CAAJ,CAAP;AACD;AACF;AACF;AACD;;;;;;;AAOA,WAAS2C,IAAT,CAAcC,IAAd,EAAoBL,OAApB,EAA6B;AAC3B,QAAIM,OAAO9D,YAAYe,IAAZ,CAAiBgD,SAAjB,EAA4B,CAA5B,CAAX;AACA,WAAO,YAAY;AACjB,aAAOF,KAAKG,KAAL,CAAWR,OAAX,EAAoBM,KAAKG,MAAL,CAAYjE,YAAYe,IAAZ,CAAiBgD,SAAjB,CAAZ,CAApB,CAAP;AACD,KAFD;AAGD;AACD;;;;;;AAMA,WAASG,KAAT,CAAeL,IAAf,EAAqB;AACnB,QAAIC,OAAO9D,YAAYe,IAAZ,CAAiBgD,SAAjB,EAA4B,CAA5B,CAAX;AACA,WAAO,YAAY;AACjB,aAAOF,KAAKG,KAAL,CAAW,IAAX,EAAiBF,KAAKG,MAAL,CAAYjE,YAAYe,IAAZ,CAAiBgD,SAAjB,CAAZ,CAAjB,CAAP;AACD,KAFD;AAGD;AACD;;;;;;AAMA,WAAS/B,OAAT,CAAiBU,KAAjB,EAAwB;AACtB,WAAOpD,YAAYyB,IAAZ,CAAiB2B,KAAjB,MAA4B,gBAAnC;AACD;AACD;;;;;;AAMA,WAASyB,YAAT,CAAsBzB,KAAtB,EAA6B;AAC3B,WAAO,OAAOA,KAAP,KAAiB,UAAxB;AACD;AACD;;;;;;AAMA,WAAS0B,QAAT,CAAkB1B,KAAlB,EAAyB;AACvB,WAAOpD,YAAYyB,IAAZ,CAAiB2B,KAAjB,MAA4B,iBAAnC;AACD;AACD;;;;;;AAMA,WAASb,UAAT,CAAoBa,KAApB,EAA2B;AACzB;AACA;AACA,QAAI2B,cAAc3B,KAAd,yCAAcA,KAAd,CAAJ;AACA,WAAO2B,SAAS,UAAT,IAAuB,CAAC,CAAC3B,KAAF,IAAW2B,QAAQ,QAAjD;AACD;AACD;;;;;;AAMA,WAASpC,eAAT,CAAyBS,KAAzB,EAAgC;AAC9B,WAAO,CAAC,CAACtD,eAAeE,YAAYyB,IAAZ,CAAiB2B,KAAjB,CAAf,CAAT;AACD;AACD;;;;;;AAMA,WAAS4B,YAAT,CAAsB5B,KAAtB,EAA6B;AAC3B,WAAO,CAAC,CAACrD,YAAYC,YAAYyB,IAAZ,CAAiB2B,KAAjB,CAAZ,CAAT;AACD;AACD;;;;;;AAMA,WAASnB,KAAT,CAAemB,KAAf,EAAsB;AACpB,WAAO,QAAOA,KAAP,yCAAOA,KAAP,OAAiB,QAAjB,IAA6B,OAAOA,MAAM6B,QAAb,KAA0B,QAAvD,IAAmE,QAAO7B,MAAM8B,aAAb,MAA+B,QAAzG;AACD;AACD;;;;;;AAMA,WAASC,KAAT,CAAe/B,KAAf,EAAsB;AACpB,WAAOA,UAAUA,KAAjB;AACD;AACD;;;;;;;AAOA,WAASgC,QAAT,CAAkBC,MAAlB,EAA0B;AACxB,SAAK,IAAI1D,IAAI,CAAR,EAAWC,MAAM6C,UAAU5C,MAAhC,EAAwCF,IAAIC,GAA5C,EAAiDD,GAAjD,EAAsD;AACpD,UAAI8C,UAAU9C,CAAV,KAAgB,IAApB,EAA0B;AACxB,eAAO8C,UAAU9C,CAAV,CAAP;AACD;AACF;AACF;AACD,WAAS2D,SAAT,CAAmBC,MAAnB,EAA2BC,MAA3B,EAAmC;AACjC,WAAOD,UAAU,IAAV,GAAiBA,MAAjB,GAA0BC,MAAjC;AACD;AACD,WAASC,SAAT,CAAmBF,MAAnB,EAA2BC,MAA3B,EAAmCE,MAAnC,EAA2C;AACzC,WAAOH,UAAU,IAAV,GAAiBA,MAAjB,GAA0BC,UAAU,IAAV,GAAiBA,MAAjB,GAA0BE,MAA3D;AACD;AACD;;;;;;;;AAQA,WAAS/E,KAAT,GAAiB;AACf,WAAOgF,SAASlE,IAAT,CAAciD,KAAd,CAAoBhE,WAApB,EAAiC+D,SAAjC,CAAP;AACD;AACD;;;;;;;;;;AAUA,WAASmB,iBAAT,CAA2BC,GAA3B,EAAgC;AAC9B,QAAI,OAAOA,GAAP,KAAe,QAAnB,EAA6B;AAC3B,aAAO,CAACA,GAAD,EAAMA,GAAN,EAAWA,GAAX,EAAgBA,GAAhB,CAAP;AACD;;AAED,QAAIjE,MAAMiE,IAAIhE,MAAd;;AAEA,QAAID,QAAQ,CAAZ,EAAe;AACb;AACA,aAAO,CAACiE,IAAI,CAAJ,CAAD,EAASA,IAAI,CAAJ,CAAT,EAAiBA,IAAI,CAAJ,CAAjB,EAAyBA,IAAI,CAAJ,CAAzB,CAAP;AACD,KAHD,MAGO,IAAIjE,QAAQ,CAAZ,EAAe;AACpB;AACA,aAAO,CAACiE,IAAI,CAAJ,CAAD,EAASA,IAAI,CAAJ,CAAT,EAAiBA,IAAI,CAAJ,CAAjB,EAAyBA,IAAI,CAAJ,CAAzB,CAAP;AACD;;AAED,WAAOA,GAAP;AACD;AACD;;;;;;AAMA,WAASC,QAAT,CAAkBC,SAAlB,EAA6BC,OAA7B,EAAsC;AACpC,QAAI,CAACD,SAAL,EAAgB;AACd,YAAM,IAAIE,KAAJ,CAAUD,OAAV,CAAN;AACD;AACF;AACD;;;;;;AAMA,WAASE,IAAT,CAAcC,GAAd,EAAmB;AACjB,QAAIA,OAAO,IAAX,EAAiB;AACf,aAAO,IAAP;AACD,KAFD,MAEO,IAAI,OAAOA,IAAID,IAAX,KAAoB,UAAxB,EAAoC;AACzC,aAAOC,IAAID,IAAJ,EAAP;AACD,KAFM,MAEA;AACL,aAAOC,IAAIC,OAAJ,CAAY,oCAAZ,EAAkD,EAAlD,CAAP;AACD;AACF;AACD,MAAIC,eAAe,kBAAnB;AACA;;;;AAIA,WAASC,cAAT,CAAwBtC,GAAxB,EAA6B;AAC3BA,QAAIqC,YAAJ,IAAoB,IAApB;AACD;AACD,WAAS3E,WAAT,CAAqBsC,GAArB,EAA0B;AACxB,WAAOA,IAAIqC,YAAJ,CAAP;AACD;AACD;;;;;AAKA,WAASE,OAAT,CAAiBvC,GAAjB,EAAsB;AACpB,QAAIwC,QAAQ9D,QAAQsB,GAAR,CAAZ;AACA,QAAIyC,UAAU,IAAd;AACAzC,mBAAeuC,OAAf,GAAyBvC,IAAI0C,IAAJ,CAASC,KAAT,CAAzB,GAA2C3C,OAAOD,OAAOC,GAAP,EAAY2C,KAAZ,CAAlD;;AAEA,aAASA,KAAT,CAAevD,KAAf,EAAsBlB,GAAtB,EAA2B;AACzBsE,cAAQC,QAAQG,GAAR,CAAYxD,KAAZ,EAAmBlB,GAAnB,CAAR,GAAkCuE,QAAQG,GAAR,CAAY1E,GAAZ,EAAiBkB,KAAjB,CAAlC;AACD;AACF,GA9xB2B,CA8xB1B;;;AAGFmD,UAAQrG,SAAR,GAAoB;AAClB6B,iBAAawE,OADK;AAElB;AACA;AACA;AACAM,SAAK,aAAU3E,GAAV,EAAe;AAClB,aAAO,KAAKC,cAAL,CAAoBD,GAApB,IAA2B,KAAKA,GAAL,CAA3B,GAAuC,IAA9C;AACD,KAPiB;AAQlB0E,SAAK,aAAU1E,GAAV,EAAekB,KAAf,EAAsB;AACzB;AACA;AACA,aAAO,KAAKlB,GAAL,IAAYkB,KAAnB;AACD,KAZiB;AAalB;AACA;AACAsD,UAAM,cAAUzC,EAAV,EAAcC,OAAd,EAAuB;AAC3BA,kBAAY,KAAK,CAAjB,KAAuBD,KAAKK,KAAKL,EAAL,EAASC,OAAT,CAA5B;;AAEA,WAAK,IAAIhC,GAAT,IAAgB,IAAhB,EAAsB;AACpB,aAAKC,cAAL,CAAoBD,GAApB,KAA4B+B,GAAG,KAAK/B,GAAL,CAAH,EAAcA,GAAd,CAA5B;AACD;AACF,KArBiB;AAsBlB;AACA4E,eAAW,mBAAU5E,GAAV,EAAe;AACxB,aAAO,KAAKA,GAAL,CAAP;AACD;AAzBiB,GAApB;AA2BA,WAAS6E,aAAT,CAAuB/C,GAAvB,EAA4B;AAC1B,WAAO,IAAIuC,OAAJ,CAAYvC,GAAZ,CAAP;AACD;AACD,WAASgD,WAAT,CAAqBC,CAArB,EAAwBC,CAAxB,EAA2B;AACzB,QAAIC,WAAW,IAAIF,EAAElF,WAAN,CAAkBkF,EAAEpF,MAAF,GAAWqF,EAAErF,MAA/B,CAAf;;AAEA,SAAK,IAAIF,IAAI,CAAb,EAAgBA,IAAIsF,EAAEpF,MAAtB,EAA8BF,GAA9B,EAAmC;AACjCwF,eAASxF,CAAT,IAAcsF,EAAEtF,CAAF,CAAd;AACD;;AAED,QAAIyF,SAASH,EAAEpF,MAAf;;AAEA,SAAKF,IAAI,CAAT,EAAYA,IAAIuF,EAAErF,MAAlB,EAA0BF,GAA1B,EAA+B;AAC7BwF,eAASxF,IAAIyF,MAAb,IAAuBF,EAAEvF,CAAF,CAAvB;AACD;;AAED,WAAOwF,QAAP;AACD;AACD,WAASE,IAAT,GAAgB,CAAE;;AAElB,MAAIC,SAAS,CAACrH,OAAOsH,MAAP,IAAiBtH,MAAlB,EAA0B;AACtCgB,eAAWA,SAD2B;AAEtCI,WAAOA,MAF+B;AAGtCe,WAAOA,KAH+B;AAItCQ,cAAUA,QAJ4B;AAKtCE,YAAQA,MAL8B;AAMtCC,cAAUA,QAN4B;AAOtCE,kBAAcA,YAPwB;AAQtCvD,gBAAYA,UAR0B;AAStCwD,aAASA,OAT6B;AAUtCG,cAAUA,QAV4B;AAWtCO,WAAOA,KAX+B;AAYtCC,iBAAaA,WAZyB;AAatC6C,UAAM3C,MAbgC;AActClD,SAAKA,GAdiC;AAetCE,YAAQA,MAf8B;AAgBtCN,YAAQA,MAhB8B;AAiBtC4D,UAAMA,IAjBgC;AAkBtCC,UAAMA,IAlBgC;AAmBtCM,WAAOA,KAnB+B;AAoBtClC,aAASA,OApB6B;AAqBtC8E,gBAAY3C,YArB0B;AAsBtCC,cAAUA,QAtB4B;AAuBtC2C,cAAUlF,UAvB4B;AAwBtCI,qBAAiBA,eAxBqB;AAyBtCqC,kBAAcA,YAzBwB;AA0BtC/C,WAAOA,KA1B+B;AA2BtCkD,WAAOA,KA3B+B;AA4BtCC,cAAUA,QA5B4B;AA6BtCE,eAAWA,SA7B2B;AA8BtCG,eAAWA,SA9B2B;AA+BtC9E,WAAOA,KA/B+B;AAgCtCiF,uBAAmBA,iBAhCmB;AAiCtC8B,YAAQ5B,QAjC8B;AAkCtCI,UAAMA,IAlCgC;AAmCtCI,oBAAgBA,cAnCsB;AAoCtC5E,iBAAaA,WApCyB;AAqCtCqF,mBAAeA,aArCuB;AAsCtCC,iBAAaA,WAtCyB;AAuCtCK,UAAMA;AAvCgC,GAA1B,CAAb;;AA0CA,MAAIM,YAAY,OAAOC,YAAP,KAAwB,WAAxB,GAAsCvH,KAAtC,GAA8CuH,YAA9D;AACA;;;;;;;AAOA,WAASC,MAAT,CAAgBC,CAAhB,EAAmBC,CAAnB,EAAsB;AACpB,QAAIC,MAAM,IAAIL,SAAJ,CAAc,CAAd,CAAV;;AAEA,QAAIG,KAAK,IAAT,EAAe;AACbA,UAAI,CAAJ;AACD;;AAED,QAAIC,KAAK,IAAT,EAAe;AACbA,UAAI,CAAJ;AACD;;AAEDC,QAAI,CAAJ,IAASF,CAAT;AACAE,QAAI,CAAJ,IAASD,CAAT;AACA,WAAOC,GAAP;AACD;AACD;;;;;;;AAOA,WAASC,IAAT,CAAcD,GAAd,EAAmBE,CAAnB,EAAsB;AACpBF,QAAI,CAAJ,IAASE,EAAE,CAAF,CAAT;AACAF,QAAI,CAAJ,IAASE,EAAE,CAAF,CAAT;AACA,WAAOF,GAAP;AACD;AACD;;;;;;AAMA,WAASG,OAAT,CAAiBD,CAAjB,EAAoB;AAClB,QAAIF,MAAM,IAAIL,SAAJ,CAAc,CAAd,CAAV;AACAK,QAAI,CAAJ,IAASE,EAAE,CAAF,CAAT;AACAF,QAAI,CAAJ,IAASE,EAAE,CAAF,CAAT;AACA,WAAOF,GAAP;AACD;AACD;;;;;;;;AAQA,WAASpB,GAAT,CAAaoB,GAAb,EAAkBf,CAAlB,EAAqBC,CAArB,EAAwB;AACtBc,QAAI,CAAJ,IAASf,CAAT;AACAe,QAAI,CAAJ,IAASd,CAAT;AACA,WAAOc,GAAP;AACD;AACD;;;;;;;AAOA,WAASI,GAAT,CAAaJ,GAAb,EAAkBK,EAAlB,EAAsBC,EAAtB,EAA0B;AACxBN,QAAI,CAAJ,IAASK,GAAG,CAAH,IAAQC,GAAG,CAAH,CAAjB;AACAN,QAAI,CAAJ,IAASK,GAAG,CAAH,IAAQC,GAAG,CAAH,CAAjB;AACA,WAAON,GAAP;AACD;AACD;;;;;;;;AAQA,WAASO,WAAT,CAAqBP,GAArB,EAA0BK,EAA1B,EAA8BC,EAA9B,EAAkCrB,CAAlC,EAAqC;AACnCe,QAAI,CAAJ,IAASK,GAAG,CAAH,IAAQC,GAAG,CAAH,IAAQrB,CAAzB;AACAe,QAAI,CAAJ,IAASK,GAAG,CAAH,IAAQC,GAAG,CAAH,IAAQrB,CAAzB;AACA,WAAOe,GAAP;AACD;AACD;;;;;;;AAOA,WAASQ,GAAT,CAAaR,GAAb,EAAkBK,EAAlB,EAAsBC,EAAtB,EAA0B;AACxBN,QAAI,CAAJ,IAASK,GAAG,CAAH,IAAQC,GAAG,CAAH,CAAjB;AACAN,QAAI,CAAJ,IAASK,GAAG,CAAH,IAAQC,GAAG,CAAH,CAAjB;AACA,WAAON,GAAP;AACD;AACD;;;;;;AAMA,WAASpG,GAAT,CAAasG,CAAb,EAAgB;AACd,WAAOO,KAAKC,IAAL,CAAUC,UAAUT,CAAV,CAAV,CAAP;AACD;AACD,MAAIrG,SAASD,GAAb,CAp+B4B,CAo+BV;;AAElB;;;;;;AAMA,WAAS+G,SAAT,CAAmBT,CAAnB,EAAsB;AACpB,WAAOA,EAAE,CAAF,IAAOA,EAAE,CAAF,CAAP,GAAcA,EAAE,CAAF,IAAOA,EAAE,CAAF,CAA5B;AACD;AACD,MAAIU,eAAeD,SAAnB;AACA;;;;;;;AAOA,WAASE,GAAT,CAAab,GAAb,EAAkBK,EAAlB,EAAsBC,EAAtB,EAA0B;AACxBN,QAAI,CAAJ,IAASK,GAAG,CAAH,IAAQC,GAAG,CAAH,CAAjB;AACAN,QAAI,CAAJ,IAASK,GAAG,CAAH,IAAQC,GAAG,CAAH,CAAjB;AACA,WAAON,GAAP;AACD;AACD;;;;;;;AAOA,WAASc,GAAT,CAAad,GAAb,EAAkBK,EAAlB,EAAsBC,EAAtB,EAA0B;AACxBN,QAAI,CAAJ,IAASK,GAAG,CAAH,IAAQC,GAAG,CAAH,CAAjB;AACAN,QAAI,CAAJ,IAASK,GAAG,CAAH,IAAQC,GAAG,CAAH,CAAjB;AACA,WAAON,GAAP;AACD;AACD;;;;;;;AAOA,WAASe,GAAT,CAAaV,EAAb,EAAiBC,EAAjB,EAAqB;AACnB,WAAOD,GAAG,CAAH,IAAQC,GAAG,CAAH,CAAR,GAAgBD,GAAG,CAAH,IAAQC,GAAG,CAAH,CAA/B;AACD;AACD;;;;;;;AAOA,WAASU,KAAT,CAAehB,GAAf,EAAoBE,CAApB,EAAuBe,CAAvB,EAA0B;AACxBjB,QAAI,CAAJ,IAASE,EAAE,CAAF,IAAOe,CAAhB;AACAjB,QAAI,CAAJ,IAASE,EAAE,CAAF,IAAOe,CAAhB;AACA,WAAOjB,GAAP;AACD;AACD;;;;;;AAMA,WAASkB,SAAT,CAAmBlB,GAAnB,EAAwBE,CAAxB,EAA2B;AACzB,QAAIiB,IAAIvH,IAAIsG,CAAJ,CAAR;;AAEA,QAAIiB,MAAM,CAAV,EAAa;AACXnB,UAAI,CAAJ,IAAS,CAAT;AACAA,UAAI,CAAJ,IAAS,CAAT;AACD,KAHD,MAGO;AACLA,UAAI,CAAJ,IAASE,EAAE,CAAF,IAAOiB,CAAhB;AACAnB,UAAI,CAAJ,IAASE,EAAE,CAAF,IAAOiB,CAAhB;AACD;;AAED,WAAOnB,GAAP;AACD;AACD;;;;;;;AAOA,WAASoB,QAAT,CAAkBf,EAAlB,EAAsBC,EAAtB,EAA0B;AACxB,WAAOG,KAAKC,IAAL,CAAU,CAACL,GAAG,CAAH,IAAQC,GAAG,CAAH,CAAT,KAAmBD,GAAG,CAAH,IAAQC,GAAG,CAAH,CAA3B,IAAoC,CAACD,GAAG,CAAH,IAAQC,GAAG,CAAH,CAAT,KAAmBD,GAAG,CAAH,IAAQC,GAAG,CAAH,CAA3B,CAA9C,CAAP;AACD;AACD,MAAIe,OAAOD,QAAX;AACA;;;;;;;AAOA,WAASE,cAAT,CAAwBjB,EAAxB,EAA4BC,EAA5B,EAAgC;AAC9B,WAAO,CAACD,GAAG,CAAH,IAAQC,GAAG,CAAH,CAAT,KAAmBD,GAAG,CAAH,IAAQC,GAAG,CAAH,CAA3B,IAAoC,CAACD,GAAG,CAAH,IAAQC,GAAG,CAAH,CAAT,KAAmBD,GAAG,CAAH,IAAQC,GAAG,CAAH,CAA3B,CAA3C;AACD;AACD,MAAIiB,aAAaD,cAAjB;AACA;;;;;;AAMA,WAASE,MAAT,CAAgBxB,GAAhB,EAAqBE,CAArB,EAAwB;AACtBF,QAAI,CAAJ,IAAS,CAACE,EAAE,CAAF,CAAV;AACAF,QAAI,CAAJ,IAAS,CAACE,EAAE,CAAF,CAAV;AACA,WAAOF,GAAP;AACD;AACD;;;;;;;;AAQA,WAASyB,IAAT,CAAczB,GAAd,EAAmBK,EAAnB,EAAuBC,EAAvB,EAA2BoB,CAA3B,EAA8B;AAC5B1B,QAAI,CAAJ,IAASK,GAAG,CAAH,IAAQqB,KAAKpB,GAAG,CAAH,IAAQD,GAAG,CAAH,CAAb,CAAjB;AACAL,QAAI,CAAJ,IAASK,GAAG,CAAH,IAAQqB,KAAKpB,GAAG,CAAH,IAAQD,GAAG,CAAH,CAAb,CAAjB;AACA,WAAOL,GAAP;AACD;AACD;;;;;;;AAOA,WAAS2B,cAAT,CAAwB3B,GAAxB,EAA6BE,CAA7B,EAAgC0B,CAAhC,EAAmC;AACjC,QAAI9B,IAAII,EAAE,CAAF,CAAR;AACA,QAAIH,IAAIG,EAAE,CAAF,CAAR;AACAF,QAAI,CAAJ,IAAS4B,EAAE,CAAF,IAAO9B,CAAP,GAAW8B,EAAE,CAAF,IAAO7B,CAAlB,GAAsB6B,EAAE,CAAF,CAA/B;AACA5B,QAAI,CAAJ,IAAS4B,EAAE,CAAF,IAAO9B,CAAP,GAAW8B,EAAE,CAAF,IAAO7B,CAAlB,GAAsB6B,EAAE,CAAF,CAA/B;AACA,WAAO5B,GAAP;AACD;AACD;;;;;;;AAOA,WAAS6B,GAAT,CAAa7B,GAAb,EAAkBK,EAAlB,EAAsBC,EAAtB,EAA0B;AACxBN,QAAI,CAAJ,IAASS,KAAKoB,GAAL,CAASxB,GAAG,CAAH,CAAT,EAAgBC,GAAG,CAAH,CAAhB,CAAT;AACAN,QAAI,CAAJ,IAASS,KAAKoB,GAAL,CAASxB,GAAG,CAAH,CAAT,EAAgBC,GAAG,CAAH,CAAhB,CAAT;AACA,WAAON,GAAP;AACD;AACD;;;;;;;AAOA,WAAS8B,GAAT,CAAa9B,GAAb,EAAkBK,EAAlB,EAAsBC,EAAtB,EAA0B;AACxBN,QAAI,CAAJ,IAASS,KAAKqB,GAAL,CAASzB,GAAG,CAAH,CAAT,EAAgBC,GAAG,CAAH,CAAhB,CAAT;AACAN,QAAI,CAAJ,IAASS,KAAKqB,GAAL,CAASzB,GAAG,CAAH,CAAT,EAAgBC,GAAG,CAAH,CAAhB,CAAT;AACA,WAAON,GAAP;AACD;;AAED,MAAI+B,SAAS,CAAC9J,OAAOsH,MAAP,IAAiBtH,MAAlB,EAA0B;AACtC4H,YAAQA,MAD8B;AAEtCI,UAAMA,IAFgC;AAGtC5G,WAAO8G,OAH+B;AAItCvB,SAAKA,GAJiC;AAKtCwB,SAAKA,GALiC;AAMtCG,iBAAaA,WANyB;AAOtCC,SAAKA,GAPiC;AAQtC5G,SAAKA,GARiC;AAStCC,YAAQA,MAT8B;AAUtC8G,eAAWA,SAV2B;AAWtCC,kBAAcA,YAXwB;AAYtCC,SAAKA,GAZiC;AAatCC,SAAKA,GAbiC;AActCC,SAAKA,GAdiC;AAetCC,WAAOA,KAf+B;AAgBtCE,eAAWA,SAhB2B;AAiBtCE,cAAUA,QAjB4B;AAkBtCC,UAAMA,IAlBgC;AAmBtCC,oBAAgBA,cAnBsB;AAoBtCC,gBAAYA,UApB0B;AAqBtCC,YAAQA,MArB8B;AAsBtCC,UAAMA,IAtBgC;AAuBtCE,oBAAgBA,cAvBsB;AAwBtCE,SAAKA,GAxBiC;AAyBtCC,SAAKA;AAzBiC,GAA1B,CAAb;;AA4BA;AACA;AACA,WAASE,SAAT,GAAqB;AACnB,SAAKC,EAAL,CAAQ,WAAR,EAAqB,KAAKC,UAA1B,EAAsC,IAAtC;AACA,SAAKD,EAAL,CAAQ,WAAR,EAAqB,KAAKE,KAA1B,EAAiC,IAAjC;AACA,SAAKF,EAAL,CAAQ,SAAR,EAAmB,KAAKG,QAAxB,EAAkC,IAAlC;AACA,SAAKH,EAAL,CAAQ,WAAR,EAAqB,KAAKG,QAA1B,EAAoC,IAApC,EAJmB,CAIwB;AAC3C;AACA;AACA;AACD;;AAEDJ,YAAU9J,SAAV,GAAsB;AACpB6B,iBAAaiI,SADO;AAEpBE,gBAAY,oBAAUG,CAAV,EAAa;AACvB,UAAIC,iBAAiBD,EAAEhI,MAAvB;;AAEA,UAAIiI,kBAAkBA,eAAeC,SAArC,EAAgD;AAC9C,aAAKC,eAAL,GAAuBF,cAAvB;AACAA,uBAAeG,QAAf,GAA0B,IAA1B;AACA,aAAKC,EAAL,GAAUL,EAAEM,OAAZ;AACA,aAAKC,EAAL,GAAUP,EAAEQ,OAAZ;AACA,aAAKC,iBAAL,CAAuBC,MAAMT,cAAN,EAAsBD,CAAtB,CAAvB,EAAiD,WAAjD,EAA8DA,EAAEW,KAAhE;AACD;AACF,KAZmB;AAapBb,WAAO,eAAUE,CAAV,EAAa;AAClB,UAAIC,iBAAiB,KAAKE,eAA1B;;AAEA,UAAIF,cAAJ,EAAoB;AAClB,YAAIxC,IAAIuC,EAAEM,OAAV;AACA,YAAI5C,IAAIsC,EAAEQ,OAAV;AACA,YAAII,KAAKnD,IAAI,KAAK4C,EAAlB;AACA,YAAIQ,KAAKnD,IAAI,KAAK6C,EAAlB;AACA,aAAKF,EAAL,GAAU5C,CAAV;AACA,aAAK8C,EAAL,GAAU7C,CAAV;AACAuC,uBAAea,KAAf,CAAqBF,EAArB,EAAyBC,EAAzB,EAA6Bb,CAA7B;AACA,aAAKS,iBAAL,CAAuBC,MAAMT,cAAN,EAAsBD,CAAtB,CAAvB,EAAiD,MAAjD,EAAyDA,EAAEW,KAA3D;AACA,YAAII,aAAa,KAAKC,SAAL,CAAevD,CAAf,EAAkBC,CAAlB,EAAqBuC,cAArB,EAAqCjI,MAAtD;AACA,YAAIiJ,iBAAiB,KAAKC,WAA1B;AACA,aAAKA,WAAL,GAAmBH,UAAnB;;AAEA,YAAId,mBAAmBc,UAAvB,EAAmC;AACjC,cAAIE,kBAAkBF,eAAeE,cAArC,EAAqD;AACnD,iBAAKR,iBAAL,CAAuBC,MAAMO,cAAN,EAAsBjB,CAAtB,CAAvB,EAAiD,WAAjD,EAA8DA,EAAEW,KAAhE;AACD;;AAED,cAAII,cAAcA,eAAeE,cAAjC,EAAiD;AAC/C,iBAAKR,iBAAL,CAAuBC,MAAMK,UAAN,EAAkBf,CAAlB,CAAvB,EAA6C,WAA7C,EAA0DA,EAAEW,KAA5D;AACD;AACF;AACF;AACF,KAvCmB;AAwCpBZ,cAAU,kBAAUC,CAAV,EAAa;AACrB,UAAIC,iBAAiB,KAAKE,eAA1B;;AAEA,UAAIF,cAAJ,EAAoB;AAClBA,uBAAeG,QAAf,GAA0B,KAA1B;AACD;;AAED,WAAKK,iBAAL,CAAuBC,MAAMT,cAAN,EAAsBD,CAAtB,CAAvB,EAAiD,SAAjD,EAA4DA,EAAEW,KAA9D;;AAEA,UAAI,KAAKO,WAAT,EAAsB;AACpB,aAAKT,iBAAL,CAAuBC,MAAM,KAAKQ,WAAX,EAAwBlB,CAAxB,CAAvB,EAAmD,MAAnD,EAA2DA,EAAEW,KAA7D;AACD;;AAED,WAAKR,eAAL,GAAuB,IAAvB;AACA,WAAKe,WAAL,GAAmB,IAAnB;AACD;AAvDmB,GAAtB;;AA0DA,WAASR,KAAT,CAAe1I,MAAf,EAAuBgI,CAAvB,EAA0B;AACxB,WAAO;AACLhI,cAAQA,MADH;AAELmJ,iBAAWnB,KAAKA,EAAEmB;AAFb,KAAP;AAID;;AAED;;;;;;AAMA,MAAIC,YAAYpL,MAAMH,SAAN,CAAgBS,KAAhC;AACA;;;;;;AAMA,MAAI+K,WAAW,SAAXA,QAAW,GAAY;AACzB,SAAKC,UAAL,GAAkB,EAAlB;AACD,GAFD;;AAIAD,WAASxL,SAAT,GAAqB;AACnB6B,iBAAa2J,QADM;;AAGnB;;;;;;;AAOAE,SAAK,aAAUZ,KAAV,EAAiBa,OAAjB,EAA0B3H,OAA1B,EAAmC;AACtC,UAAI4H,KAAK,KAAKH,UAAd;;AAEA,UAAI,CAACE,OAAD,IAAY,CAACb,KAAjB,EAAwB;AACtB,eAAO,IAAP;AACD;;AAED,UAAI,CAACc,GAAGd,KAAH,CAAL,EAAgB;AACdc,WAAGd,KAAH,IAAY,EAAZ;AACD;;AAED,WAAK,IAAIrJ,IAAI,CAAb,EAAgBA,IAAImK,GAAGd,KAAH,EAAUnJ,MAA9B,EAAsCF,GAAtC,EAA2C;AACzC,YAAImK,GAAGd,KAAH,EAAUrJ,CAAV,EAAaoK,CAAb,KAAmBF,OAAvB,EAAgC;AAC9B,iBAAO,IAAP;AACD;AACF;;AAEDC,SAAGd,KAAH,EAAU7G,IAAV,CAAe;AACb4H,WAAGF,OADU;AAEbD,aAAK,IAFQ;AAGbI,aAAK9H,WAAW;AAHH,OAAf;;AAMA,aAAO,IAAP;AACD,KAlCkB;;AAoCnB;;;;;;AAMA+F,QAAI,YAAUe,KAAV,EAAiBa,OAAjB,EAA0B3H,OAA1B,EAAmC;AACrC,UAAI4H,KAAK,KAAKH,UAAd;;AAEA,UAAI,CAACE,OAAD,IAAY,CAACb,KAAjB,EAAwB;AACtB,eAAO,IAAP;AACD;;AAED,UAAI,CAACc,GAAGd,KAAH,CAAL,EAAgB;AACdc,WAAGd,KAAH,IAAY,EAAZ;AACD;;AAED,WAAK,IAAIrJ,IAAI,CAAb,EAAgBA,IAAImK,GAAGd,KAAH,EAAUnJ,MAA9B,EAAsCF,GAAtC,EAA2C;AACzC,YAAImK,GAAGd,KAAH,EAAUrJ,CAAV,EAAaoK,CAAb,KAAmBF,OAAvB,EAAgC;AAC9B,iBAAO,IAAP;AACD;AACF;;AAEDC,SAAGd,KAAH,EAAU7G,IAAV,CAAe;AACb4H,WAAGF,OADU;AAEbD,aAAK,KAFQ;AAGbI,aAAK9H,WAAW;AAHH,OAAf;;AAMA,aAAO,IAAP;AACD,KAlEkB;;AAoEnB;;;;;AAKA+H,cAAU,kBAAUjB,KAAV,EAAiB;AACzB,UAAIc,KAAK,KAAKH,UAAd;AACA,aAAOG,GAAGd,KAAH,KAAac,GAAGd,KAAH,EAAUnJ,MAA9B;AACD,KA5EkB;;AA8EnB;;;;;AAKAqK,SAAK,aAAUlB,KAAV,EAAiBa,OAAjB,EAA0B;AAC7B,UAAIC,KAAK,KAAKH,UAAd;;AAEA,UAAI,CAACX,KAAL,EAAY;AACV,aAAKW,UAAL,GAAkB,EAAlB;AACA,eAAO,IAAP;AACD;;AAED,UAAIE,OAAJ,EAAa;AACX,YAAIC,GAAGd,KAAH,CAAJ,EAAe;AACb,cAAImB,UAAU,EAAd;;AAEA,eAAK,IAAIxK,IAAI,CAAR,EAAWyK,IAAIN,GAAGd,KAAH,EAAUnJ,MAA9B,EAAsCF,IAAIyK,CAA1C,EAA6CzK,GAA7C,EAAkD;AAChD,gBAAImK,GAAGd,KAAH,EAAUrJ,CAAV,EAAa,GAAb,KAAqBkK,OAAzB,EAAkC;AAChCM,sBAAQhI,IAAR,CAAa2H,GAAGd,KAAH,EAAUrJ,CAAV,CAAb;AACD;AACF;;AAEDmK,aAAGd,KAAH,IAAYmB,OAAZ;AACD;;AAED,YAAIL,GAAGd,KAAH,KAAac,GAAGd,KAAH,EAAUnJ,MAAV,KAAqB,CAAtC,EAAyC;AACvC,iBAAOiK,GAAGd,KAAH,CAAP;AACD;AACF,OAhBD,MAgBO;AACL,eAAOc,GAAGd,KAAH,CAAP;AACD;;AAED,aAAO,IAAP;AACD,KAhHkB;;AAkHnB;;;;;AAKAqB,aAAS,iBAAUtH,IAAV,EAAgB;AACvB,UAAI,KAAK4G,UAAL,CAAgB5G,IAAhB,CAAJ,EAA2B;AACzB,YAAIP,OAAOC,SAAX;AACA,YAAI6H,SAAS9H,KAAK3C,MAAlB;;AAEA,YAAIyK,SAAS,CAAb,EAAgB;AACd9H,iBAAOiH,UAAUhK,IAAV,CAAe+C,IAAf,EAAqB,CAArB,CAAP;AACD;;AAED,YAAIsH,KAAK,KAAKH,UAAL,CAAgB5G,IAAhB,CAAT;AACA,YAAInD,MAAMkK,GAAGjK,MAAb;;AAEA,aAAK,IAAIF,IAAI,CAAb,EAAgBA,IAAIC,GAApB,GAA0B;AACxB;AACA,kBAAQ0K,MAAR;AACE,iBAAK,CAAL;AACER,iBAAGnK,CAAH,EAAM,GAAN,EAAWF,IAAX,CAAgBqK,GAAGnK,CAAH,EAAM,KAAN,CAAhB;;AAEA;;AAEF,iBAAK,CAAL;AACEmK,iBAAGnK,CAAH,EAAM,GAAN,EAAWF,IAAX,CAAgBqK,GAAGnK,CAAH,EAAM,KAAN,CAAhB,EAA8B6C,KAAK,CAAL,CAA9B;;AAEA;;AAEF,iBAAK,CAAL;AACEsH,iBAAGnK,CAAH,EAAM,GAAN,EAAWF,IAAX,CAAgBqK,GAAGnK,CAAH,EAAM,KAAN,CAAhB,EAA8B6C,KAAK,CAAL,CAA9B,EAAuCA,KAAK,CAAL,CAAvC;;AAEA;;AAEF;AACE;AACAsH,iBAAGnK,CAAH,EAAM,GAAN,EAAW+C,KAAX,CAAiBoH,GAAGnK,CAAH,EAAM,KAAN,CAAjB,EAA+B6C,IAA/B;;AAEA;AApBJ;;AAuBA,cAAIsH,GAAGnK,CAAH,EAAM,KAAN,CAAJ,EAAkB;AAChBmK,eAAGS,MAAH,CAAU5K,CAAV,EAAa,CAAb;;AAEAC;AACD,WAJD,MAIO;AACLD;AACD;AACF;AACF;;AAED,aAAO,IAAP;AACD,KAvKkB;;AAyKnB;;;;AAIA6K,wBAAoB,4BAAUzH,IAAV,EAAgB;AAClC,UAAI,KAAK4G,UAAL,CAAgB5G,IAAhB,CAAJ,EAA2B;AACzB,YAAIP,OAAOC,SAAX;AACA,YAAI6H,SAAS9H,KAAK3C,MAAlB;;AAEA,YAAIyK,SAAS,CAAb,EAAgB;AACd9H,iBAAOiH,UAAUhK,IAAV,CAAe+C,IAAf,EAAqB,CAArB,EAAwBA,KAAK3C,MAAL,GAAc,CAAtC,CAAP;AACD;;AAED,YAAImK,MAAMxH,KAAKA,KAAK3C,MAAL,GAAc,CAAnB,CAAV;AACA,YAAIiK,KAAK,KAAKH,UAAL,CAAgB5G,IAAhB,CAAT;AACA,YAAInD,MAAMkK,GAAGjK,MAAb;;AAEA,aAAK,IAAIF,IAAI,CAAb,EAAgBA,IAAIC,GAApB,GAA0B;AACxB;AACA,kBAAQ0K,MAAR;AACE,iBAAK,CAAL;AACER,iBAAGnK,CAAH,EAAM,GAAN,EAAWF,IAAX,CAAgBuK,GAAhB;;AAEA;;AAEF,iBAAK,CAAL;AACEF,iBAAGnK,CAAH,EAAM,GAAN,EAAWF,IAAX,CAAgBuK,GAAhB,EAAqBxH,KAAK,CAAL,CAArB;;AAEA;;AAEF,iBAAK,CAAL;AACEsH,iBAAGnK,CAAH,EAAM,GAAN,EAAWF,IAAX,CAAgBuK,GAAhB,EAAqBxH,KAAK,CAAL,CAArB,EAA8BA,KAAK,CAAL,CAA9B;;AAEA;;AAEF;AACE;AACAsH,iBAAGnK,CAAH,EAAM,GAAN,EAAW+C,KAAX,CAAiBsH,GAAjB,EAAsBxH,IAAtB;;AAEA;AApBJ;;AAuBA,cAAIsH,GAAGnK,CAAH,EAAM,KAAN,CAAJ,EAAkB;AAChBmK,eAAGS,MAAH,CAAU5K,CAAV,EAAa,CAAb;;AAEAC;AACD,WAJD,MAIO;AACLD;AACD;AACF;AACF;;AAED,aAAO,IAAP;AACD;AA9NkB,GAArB,CAhwC4B,CA+9CzB;;AAEH,MAAI8K,SAAS,QAAb;;AAEA,WAASC,eAAT,CAAyBC,OAAzB,EAAkCC,UAAlC,EAA8C5B,KAA9C,EAAqD;AACnD,WAAO;AACLjG,YAAM4H,OADD;AAEL3B,aAAOA,KAFF;AAGL;AACA3I,cAAQuK,WAAWvK,MAJd;AAKL;AACAmJ,iBAAWoB,WAAWpB,SANjB;AAOLqB,oBAAc,KAPT;AAQLlC,eAASK,MAAM8B,GARV;AASLjC,eAASG,MAAM+B,GATV;AAULC,oBAAchC,MAAMgC,YAVf;AAWLC,cAAQjC,MAAMiC,MAXT;AAYLC,cAAQlC,MAAMkC,MAZT;AAaLC,kBAAYnC,MAAMmC,UAbb;AAcLC,kBAAYpC,MAAMqC,OAdb;AAeLC,iBAAWtC,MAAMsC,SAfZ;AAgBLC,aAAOvC,MAAMuC;AAhBR,KAAP;AAkBD;;AAED,WAASC,UAAT,GAAsB,CAAE;;AAExBA,aAAWtN,SAAX,CAAqBuN,OAArB,GAA+B,YAAY,CAAE,CAA7C;;AAEA,MAAIC,eAAe,CAAC,OAAD,EAAU,UAAV,EAAsB,YAAtB,EAAoC,UAApC,EAAgD,SAAhD,EAA2D,WAA3D,EAAwE,WAAxE,EAAqF,aAArF,CAAnB;AACA;;;;;;;;;;AAUA,MAAIC,UAAU,SAAVA,OAAU,CAAUC,OAAV,EAAmBC,OAAnB,EAA4BC,KAA5B,EAAmCC,WAAnC,EAAgD;AAC5DrC,aAASjK,IAAT,CAAc,IAAd;AACA,SAAKmM,OAAL,GAAeA,OAAf;AACA,SAAKC,OAAL,GAAeA,OAAf;AACA,SAAKE,WAAL,GAAmBA,WAAnB;AACAD,YAAQA,SAAS,IAAIN,UAAJ,EAAjB;AACA;;;;AAIA,SAAKM,KAAL,GAAa,IAAb;AACA;;;;;;AAMA,SAAKE,QAAL,GAAgB,EAAhB;AACA;;;;;AAKA,SAAKC,gBAAL;AACA;;;;;AAKA,SAAKC,MAAL;AACA;;;;;AAKA,SAAKC,MAAL;AACAnE,cAAUvI,IAAV,CAAe,IAAf;AACA,SAAK2M,eAAL,CAAqBN,KAArB;AACD,GAtCD;;AAwCAH,UAAQzN,SAAR,GAAoB;AAClB6B,iBAAa4L,OADK;AAElBS,qBAAiB,yBAAUN,KAAV,EAAiB;AAChC,UAAI,KAAKA,KAAT,EAAgB;AACd,aAAKA,KAAL,CAAWL,OAAX;AACD;;AAED,UAAIK,KAAJ,EAAW;AACT/J,eAAO2J,YAAP,EAAqB,UAAUxM,IAAV,EAAgB;AACnC4M,gBAAM7D,EAAN,IAAY6D,MAAM7D,EAAN,CAAS/I,IAAT,EAAe,KAAKA,IAAL,CAAf,EAA2B,IAA3B,CAAZ;AACD,SAFD,EAEG,IAFH,EADS,CAGC;;AAEV4M,cAAMjC,OAAN,GAAgB,IAAhB;AACD;;AAED,WAAKiC,KAAL,GAAaA,KAAb;AACD,KAhBiB;AAiBlBO,eAAW,mBAAUrD,KAAV,EAAiB;AAC1B,UAAIlD,IAAIkD,MAAM8B,GAAd;AACA,UAAI/E,IAAIiD,MAAM+B,GAAd;AACA,UAAIuB,cAAc,KAAKN,QAAvB;AACA,UAAIO,oBAAoBD,YAAYjM,MAApC,CAJ0B,CAIkB;AAC5C;AACA;AACA;;AAEA,UAAIkM,qBAAqB,CAACA,kBAAkBC,IAA5C,EAAkD;AAChDF,sBAAc,KAAKjD,SAAL,CAAeiD,YAAYxG,CAA3B,EAA8BwG,YAAYvG,CAA1C,CAAd;AACAwG,4BAAoBD,YAAYjM,MAAhC;AACD;;AAED,UAAIoM,UAAU,KAAKT,QAAL,GAAgB,KAAK3C,SAAL,CAAevD,CAAf,EAAkBC,CAAlB,CAA9B;AACA,UAAI2G,gBAAgBD,QAAQpM,MAA5B;AACA,UAAIyL,QAAQ,KAAKA,KAAjB;AACAA,YAAMa,SAAN,IAAmBb,MAAMa,SAAN,CAAgBD,gBAAgBA,cAAcE,MAA9B,GAAuC,SAAvD,CAAnB,CAjB0B,CAiB4D;;AAEtF,UAAIL,qBAAqBG,kBAAkBH,iBAA3C,EAA8D;AAC5D,aAAKzD,iBAAL,CAAuBwD,WAAvB,EAAoC,UAApC,EAAgDtD,KAAhD;AACD,OArByB,CAqBxB;;;AAGF,WAAKF,iBAAL,CAAuB2D,OAAvB,EAAgC,WAAhC,EAA6CzD,KAA7C,EAxB0B,CAwB2B;;AAErD,UAAI0D,iBAAiBA,kBAAkBH,iBAAvC,EAA0D;AACxD,aAAKzD,iBAAL,CAAuB2D,OAAvB,EAAgC,WAAhC,EAA6CzD,KAA7C;AACD;AACF,KA9CiB;AA+ClB6D,cAAU,kBAAU7D,KAAV,EAAiB;AACzB,WAAKF,iBAAL,CAAuB,KAAKkD,QAA5B,EAAsC,UAAtC,EAAkDhD,KAAlD,EADyB,CACiC;AAC1D;AACA;AACA;AACA;;AAEA,UAAI8D,UAAU9D,MAAM+D,SAAN,IAAmB/D,MAAMgE,aAAvC;AACA,UAAIC,QAAJ;;AAEA,SAAG;AACDH,kBAAUA,WAAWA,QAAQI,UAA7B;AACD,OAFD,QAESJ,WAAWA,QAAQ7J,QAAR,IAAoB,CAA/B,IAAoC,EAAEgK,WAAWH,YAAY,KAAKf,WAA9B,CAF7C;;AAIA,OAACkB,QAAD,IAAa,KAAK5C,OAAL,CAAa,WAAb,EAA0B;AACrCrB,eAAOA;AAD8B,OAA1B,CAAb;AAGD,KAhEiB;;AAkElB;;;AAGAmE,YAAQ,gBAAUnE,KAAV,EAAiB;AACvB,WAAKgD,QAAL,GAAgB,EAAhB;AACD,KAvEiB;;AAyElB;;;;;AAKAoB,cAAU,kBAAUC,SAAV,EAAqBC,SAArB,EAAgC;AACxC,UAAIzD,UAAU,KAAKwD,SAAL,CAAd;AACAxD,iBAAWA,QAAQpK,IAAR,CAAa,IAAb,EAAmB6N,SAAnB,CAAX;AACD,KAjFiB;;AAmFlB;;;AAGA7B,aAAS,mBAAY;AACnB,WAAKK,KAAL,CAAWL,OAAX;AACA,WAAKG,OAAL,GAAe,KAAKE,KAAL,GAAa,KAAKD,OAAL,GAAe,IAA3C;AACD,KAzFiB;;AA2FlB;;;;AAIA0B,oBAAgB,wBAAUC,WAAV,EAAuB;AACrC,UAAI1B,QAAQ,KAAKA,KAAjB;AACAA,YAAMa,SAAN,IAAmBb,MAAMa,SAAN,CAAgBa,WAAhB,CAAnB;AACD,KAlGiB;;AAoGlB;;;;;;;;AAQA1E,uBAAmB,2BAAU8B,UAAV,EAAsByC,SAAtB,EAAiCrE,KAAjC,EAAwC;AACzD4B,mBAAaA,cAAc,EAA3B;AACA,UAAI6C,KAAK7C,WAAWvK,MAApB;;AAEA,UAAIoN,MAAMA,GAAGC,MAAb,EAAqB;AACnB;AACD;;AAED,UAAIC,eAAe,OAAON,SAA1B;AACA,UAAIO,cAAclD,gBAAgB2C,SAAhB,EAA2BzC,UAA3B,EAAuC5B,KAAvC,CAAlB;;AAEA,aAAOyE,EAAP,EAAW;AACTA,WAAGE,YAAH,MAAqBC,YAAY/C,YAAZ,GAA2B4C,GAAGE,YAAH,EAAiBlO,IAAjB,CAAsBgO,EAAtB,EAA0BG,WAA1B,CAAhD;AACAH,WAAGpD,OAAH,CAAWgD,SAAX,EAAsBO,WAAtB;AACAH,aAAKA,GAAGI,MAAR;;AAEA,YAAID,YAAY/C,YAAhB,EAA8B;AAC5B;AACD;AACF;;AAED,UAAI,CAAC+C,YAAY/C,YAAjB,EAA+B;AAC7B;AACA,aAAKR,OAAL,CAAagD,SAAb,EAAwBO,WAAxB,EAF6B,CAES;AACtC;;AAEA,aAAK/B,OAAL,IAAgB,KAAKA,OAAL,CAAaiC,cAAb,CAA4B,UAAUC,KAAV,EAAiB;AAC3D,cAAI,OAAOA,MAAMJ,YAAN,CAAP,IAA8B,UAAlC,EAA8C;AAC5CI,kBAAMJ,YAAN,EAAoBlO,IAApB,CAAyBsO,KAAzB,EAAgCH,WAAhC;AACD;;AAED,cAAIG,MAAM1D,OAAV,EAAmB;AACjB0D,kBAAM1D,OAAN,CAAcgD,SAAd,EAAyBO,WAAzB;AACD;AACF,SARe,CAAhB;AASD;AACF,KAhJiB;;AAkJlB;;;;;;;;AAQAvE,eAAW,mBAAUvD,CAAV,EAAaC,CAAb,EAAgBiI,OAAhB,EAAyB;AAClC,UAAIC,OAAO,KAAKrC,OAAL,CAAasC,cAAb,EAAX;AACA,UAAIlI,MAAM;AACRF,WAAGA,CADK;AAERC,WAAGA;AAFK,OAAV;;AAKA,WAAK,IAAIpG,IAAIsO,KAAKpO,MAAL,GAAc,CAA3B,EAA8BF,KAAK,CAAnC,EAAsCA,GAAtC,EAA2C;AACzC,YAAIwO,gBAAJ;;AAEA,YAAIF,KAAKtO,CAAL,MAAYqO,OAAZ,CAAoB;AAApB,WACD,CAACC,KAAKtO,CAAL,EAAQyO,MADR,KACmBD,mBAAmBE,QAAQJ,KAAKtO,CAAL,CAAR,EAAiBmG,CAAjB,EAAoBC,CAApB,CADtC,CAAJ,EACmE;AACjE,WAACC,IAAIwD,SAAL,KAAmBxD,IAAIwD,SAAJ,GAAgByE,KAAKtO,CAAL,CAAnC;;AAEA,cAAIwO,qBAAqB1D,MAAzB,EAAiC;AAC/BzE,gBAAI3F,MAAJ,GAAa4N,KAAKtO,CAAL,CAAb;AACA;AACD;AACF;AACF;;AAED,aAAOqG,GAAP;AACD;AAhLiB,GAApB,CA/iD4B,CAguDzB;;AAEHjE,SAAO,CAAC,OAAD,EAAU,WAAV,EAAuB,SAAvB,EAAkC,YAAlC,EAAgD,UAAhD,EAA4D,aAA5D,CAAP,EAAmF,UAAU7C,IAAV,EAAgB;AACjGyM,YAAQzN,SAAR,CAAkBgB,IAAlB,IAA0B,UAAU8J,KAAV,EAAiB;AACzC;AACA,UAAIyD,UAAU,KAAKpD,SAAL,CAAeL,MAAM8B,GAArB,EAA0B9B,MAAM+B,GAAhC,CAAd;AACA,UAAI2B,gBAAgBD,QAAQpM,MAA5B;;AAEA,UAAInB,SAAS,WAAb,EAA0B;AACxB,aAAKoP,OAAL,GAAe5B,aAAf;AACA,aAAK6B,UAAL,GAAkB,CAACvF,MAAM8B,GAAP,EAAY9B,MAAM+B,GAAlB,CAAlB,CAFwB,CAEkB;;AAE1C,aAAKyD,KAAL,GAAa9B,aAAb;AACD,OALD,MAKO,IAAIxN,SAAS,SAAb,EAAwB;AAC7B,aAAKsP,KAAL,GAAa9B,aAAb;AACD,OAFM,MAEA,IAAIxN,SAAS,OAAb,EAAsB;AAC3B,YAAI,KAAKoP,OAAL,KAAiB,KAAKE,KAAtB,CAA4B;AAChC;AACA;AACA;AAHI,WAID,CAAC,KAAKD,UAJL,CAIgB;AAJhB,WAKDlH,KAAK,KAAKkH,UAAV,EAAsB,CAACvF,MAAM8B,GAAP,EAAY9B,MAAM+B,GAAlB,CAAtB,IAAgD,CALnD,EAKsD;AACpD;AACD;;AAED,aAAKwD,UAAL,GAAkB,IAAlB;AACD;;AAED,WAAKzF,iBAAL,CAAuB2D,OAAvB,EAAgCvN,IAAhC,EAAsC8J,KAAtC;AACD,KA1BD;AA2BD,GA5BD;;AA8BA,WAASqF,OAAT,CAAiBI,WAAjB,EAA8B3I,CAA9B,EAAiCC,CAAjC,EAAoC;AAClC,QAAI0I,YAAYA,YAAYC,SAAZ,GAAwB,aAAxB,GAAwC,SAApD,EAA+D5I,CAA/D,EAAkEC,CAAlE,CAAJ,EAA0E;AACxE,UAAI0H,KAAKgB,WAAT;AACA,UAAIxE,QAAJ;;AAEA,aAAOwD,EAAP,EAAW;AACT;AACA;AACA;AACA,YAAIA,GAAGkB,QAAH,IAAe,CAAClB,GAAGkB,QAAH,CAAYC,OAAZ,CAAoB9I,CAApB,EAAuBC,CAAvB,CAApB,EAA+C;AAC7C,iBAAO,KAAP;AACD;;AAED,YAAI0H,GAAGC,MAAP,EAAe;AACbzD,qBAAW,IAAX;AACD;;AAEDwD,aAAKA,GAAGI,MAAR;AACD;;AAED,aAAO5D,WAAWQ,MAAX,GAAoB,IAA3B;AACD;;AAED,WAAO,KAAP;AACD;;AAED7I,QAAM+J,OAAN,EAAejC,QAAf;AACA9H,QAAM+J,OAAN,EAAe3D,SAAf;;AAEA;;;;AAIA,MAAI6G,cAAc,OAAOjJ,YAAP,KAAwB,WAAxB,GAAsCvH,KAAtC,GAA8CuH,YAAhE;AACA;;;;;AAKA,WAASkJ,QAAT,GAAoB;AAClB,QAAI9I,MAAM,IAAI6I,WAAJ,CAAgB,CAAhB,CAAV;AACAE,aAAS/I,GAAT;AACA,WAAOA,GAAP;AACD;AACD;;;;;AAKA,WAAS+I,QAAT,CAAkB/I,GAAlB,EAAuB;AACrBA,QAAI,CAAJ,IAAS,CAAT;AACAA,QAAI,CAAJ,IAAS,CAAT;AACAA,QAAI,CAAJ,IAAS,CAAT;AACAA,QAAI,CAAJ,IAAS,CAAT;AACAA,QAAI,CAAJ,IAAS,CAAT;AACAA,QAAI,CAAJ,IAAS,CAAT;AACA,WAAOA,GAAP;AACD;AACD;;;;;;AAMA,WAASgJ,MAAT,CAAgBhJ,GAAhB,EAAqB4B,CAArB,EAAwB;AACtB5B,QAAI,CAAJ,IAAS4B,EAAE,CAAF,CAAT;AACA5B,QAAI,CAAJ,IAAS4B,EAAE,CAAF,CAAT;AACA5B,QAAI,CAAJ,IAAS4B,EAAE,CAAF,CAAT;AACA5B,QAAI,CAAJ,IAAS4B,EAAE,CAAF,CAAT;AACA5B,QAAI,CAAJ,IAAS4B,EAAE,CAAF,CAAT;AACA5B,QAAI,CAAJ,IAAS4B,EAAE,CAAF,CAAT;AACA,WAAO5B,GAAP;AACD;AACD;;;;;;;AAOA,WAASiJ,KAAT,CAAejJ,GAAf,EAAoBkJ,EAApB,EAAwBC,EAAxB,EAA4B;AAC1B;AACA;AACA;AACA,QAAIC,OAAOF,GAAG,CAAH,IAAQC,GAAG,CAAH,CAAR,GAAgBD,GAAG,CAAH,IAAQC,GAAG,CAAH,CAAnC;AACA,QAAIE,OAAOH,GAAG,CAAH,IAAQC,GAAG,CAAH,CAAR,GAAgBD,GAAG,CAAH,IAAQC,GAAG,CAAH,CAAnC;AACA,QAAIG,OAAOJ,GAAG,CAAH,IAAQC,GAAG,CAAH,CAAR,GAAgBD,GAAG,CAAH,IAAQC,GAAG,CAAH,CAAnC;AACA,QAAII,OAAOL,GAAG,CAAH,IAAQC,GAAG,CAAH,CAAR,GAAgBD,GAAG,CAAH,IAAQC,GAAG,CAAH,CAAnC;AACA,QAAIK,OAAON,GAAG,CAAH,IAAQC,GAAG,CAAH,CAAR,GAAgBD,GAAG,CAAH,IAAQC,GAAG,CAAH,CAAxB,GAAgCD,GAAG,CAAH,CAA3C;AACA,QAAIO,OAAOP,GAAG,CAAH,IAAQC,GAAG,CAAH,CAAR,GAAgBD,GAAG,CAAH,IAAQC,GAAG,CAAH,CAAxB,GAAgCD,GAAG,CAAH,CAA3C;AACAlJ,QAAI,CAAJ,IAASoJ,IAAT;AACApJ,QAAI,CAAJ,IAASqJ,IAAT;AACArJ,QAAI,CAAJ,IAASsJ,IAAT;AACAtJ,QAAI,CAAJ,IAASuJ,IAAT;AACAvJ,QAAI,CAAJ,IAASwJ,IAAT;AACAxJ,QAAI,CAAJ,IAASyJ,IAAT;AACA,WAAOzJ,GAAP;AACD;AACD;;;;;;;AAOA,WAAS0J,SAAT,CAAmB1J,GAAnB,EAAwBf,CAAxB,EAA2BiB,CAA3B,EAA8B;AAC5BF,QAAI,CAAJ,IAASf,EAAE,CAAF,CAAT;AACAe,QAAI,CAAJ,IAASf,EAAE,CAAF,CAAT;AACAe,QAAI,CAAJ,IAASf,EAAE,CAAF,CAAT;AACAe,QAAI,CAAJ,IAASf,EAAE,CAAF,CAAT;AACAe,QAAI,CAAJ,IAASf,EAAE,CAAF,IAAOiB,EAAE,CAAF,CAAhB;AACAF,QAAI,CAAJ,IAASf,EAAE,CAAF,IAAOiB,EAAE,CAAF,CAAhB;AACA,WAAOF,GAAP;AACD;AACD;;;;;;;AAOA,WAAS2J,MAAT,CAAgB3J,GAAhB,EAAqBf,CAArB,EAAwB2K,GAAxB,EAA6B;AAC3B,QAAIC,KAAK5K,EAAE,CAAF,CAAT;AACA,QAAI6K,KAAK7K,EAAE,CAAF,CAAT;AACA,QAAI8K,MAAM9K,EAAE,CAAF,CAAV;AACA,QAAI+K,KAAK/K,EAAE,CAAF,CAAT;AACA,QAAIgL,KAAKhL,EAAE,CAAF,CAAT;AACA,QAAIiL,MAAMjL,EAAE,CAAF,CAAV;AACA,QAAIkL,KAAK1J,KAAK2J,GAAL,CAASR,GAAT,CAAT;AACA,QAAIS,KAAK5J,KAAK6J,GAAL,CAASV,GAAT,CAAT;AACA5J,QAAI,CAAJ,IAAS6J,KAAKQ,EAAL,GAAUL,KAAKG,EAAxB;AACAnK,QAAI,CAAJ,IAAS,CAAC6J,EAAD,GAAMM,EAAN,GAAWH,KAAKK,EAAzB;AACArK,QAAI,CAAJ,IAAS8J,KAAKO,EAAL,GAAUJ,KAAKE,EAAxB;AACAnK,QAAI,CAAJ,IAAS,CAAC8J,EAAD,GAAMK,EAAN,GAAWE,KAAKJ,EAAzB;AACAjK,QAAI,CAAJ,IAASqK,KAAKN,GAAL,GAAWI,KAAKD,GAAzB;AACAlK,QAAI,CAAJ,IAASqK,KAAKH,GAAL,GAAWC,KAAKJ,GAAzB;AACA,WAAO/J,GAAP;AACD;AACD;;;;;;;AAOA,WAASuK,OAAT,CAAiBvK,GAAjB,EAAsBf,CAAtB,EAAyBiB,CAAzB,EAA4B;AAC1B,QAAIsK,KAAKtK,EAAE,CAAF,CAAT;AACA,QAAIuK,KAAKvK,EAAE,CAAF,CAAT;AACAF,QAAI,CAAJ,IAASf,EAAE,CAAF,IAAOuL,EAAhB;AACAxK,QAAI,CAAJ,IAASf,EAAE,CAAF,IAAOwL,EAAhB;AACAzK,QAAI,CAAJ,IAASf,EAAE,CAAF,IAAOuL,EAAhB;AACAxK,QAAI,CAAJ,IAASf,EAAE,CAAF,IAAOwL,EAAhB;AACAzK,QAAI,CAAJ,IAASf,EAAE,CAAF,IAAOuL,EAAhB;AACAxK,QAAI,CAAJ,IAASf,EAAE,CAAF,IAAOwL,EAAhB;AACA,WAAOzK,GAAP;AACD;AACD;;;;;;AAMA,WAAS0K,MAAT,CAAgB1K,GAAhB,EAAqBf,CAArB,EAAwB;AACtB,QAAI4K,KAAK5K,EAAE,CAAF,CAAT;AACA,QAAI6K,KAAK7K,EAAE,CAAF,CAAT;AACA,QAAI8K,MAAM9K,EAAE,CAAF,CAAV;AACA,QAAI+K,KAAK/K,EAAE,CAAF,CAAT;AACA,QAAIgL,KAAKhL,EAAE,CAAF,CAAT;AACA,QAAIiL,MAAMjL,EAAE,CAAF,CAAV;AACA,QAAI0L,MAAMd,KAAKI,EAAL,GAAUD,KAAKF,EAAzB;;AAEA,QAAI,CAACa,GAAL,EAAU;AACR,aAAO,IAAP;AACD;;AAEDA,UAAM,MAAMA,GAAZ;AACA3K,QAAI,CAAJ,IAASiK,KAAKU,GAAd;AACA3K,QAAI,CAAJ,IAAS,CAACgK,EAAD,GAAMW,GAAf;AACA3K,QAAI,CAAJ,IAAS,CAAC8J,EAAD,GAAMa,GAAf;AACA3K,QAAI,CAAJ,IAAS6J,KAAKc,GAAd;AACA3K,QAAI,CAAJ,IAAS,CAAC8J,KAAKI,GAAL,GAAWD,KAAKF,GAAjB,IAAwBY,GAAjC;AACA3K,QAAI,CAAJ,IAAS,CAACgK,KAAKD,GAAL,GAAWF,KAAKK,GAAjB,IAAwBS,GAAjC;AACA,WAAO3K,GAAP;AACD;AACD;;;;;AAKA,WAAS4K,OAAT,CAAiB3L,CAAjB,EAAoB;AAClB,QAAIC,IAAI4J,UAAR;AACAE,WAAO9J,CAAP,EAAUD,CAAV;AACA,WAAOC,CAAP;AACD;;AAED,MAAI2L,SAAS,CAAC5S,OAAOsH,MAAP,IAAiBtH,MAAlB,EAA0B;AACtC4H,YAAQiJ,QAD8B;AAEtCC,cAAUA,QAF4B;AAGtC9I,UAAM+I,MAHgC;AAItCnI,SAAKoI,KAJiC;AAKtCS,eAAWA,SAL2B;AAMtCC,YAAQA,MAN8B;AAOtC3I,WAAOuJ,OAP+B;AAQtCG,YAAQA,MAR8B;AAStCrR,WAAOuR;AAT+B,GAA1B,CAAb;;AAYA;;;;;AAKA,MAAIE,YAAY/B,QAAhB;AACA,MAAIgC,UAAU,IAAd;;AAEA,WAASC,eAAT,CAAyBnN,GAAzB,EAA8B;AAC5B,WAAOA,MAAMkN,OAAN,IAAiBlN,MAAM,CAACkN,OAA/B;AACD;AACD;;;;;AAMA,MAAIE,gBAAgB,SAAhBA,aAAgB,CAAUC,IAAV,EAAgB;AAClCA,WAAOA,QAAQ,EAAf,CADkC,CACf;;AAEnB,QAAI,CAACA,KAAKC,QAAV,EAAoB;AAClB;;;;;AAKA,WAAKA,QAAL,GAAgB,CAAC,CAAD,EAAI,CAAJ,CAAhB;AACD;;AAED,QAAID,KAAKE,QAAL,IAAiB,IAArB,EAA2B;AACzB;;;;;AAKA,WAAKA,QAAL,GAAgB,CAAhB;AACD;;AAED,QAAI,CAACF,KAAKlK,KAAV,EAAiB;AACf;;;;;AAKA,WAAKA,KAAL,GAAa,CAAC,CAAD,EAAI,CAAJ,CAAb;AACD;AACD;;;;;;AAOA,SAAKqK,MAAL,GAAc,KAAKA,MAAL,IAAe,IAA7B;AACD,GArCD;;AAuCA,MAAIC,qBAAqBL,cAAc/S,SAAvC;AACAoT,qBAAmBC,SAAnB,GAA+B,IAA/B;AACA;;;;;AAKAD,qBAAmBE,kBAAnB,GAAwC,YAAY;AAClD,WAAOR,gBAAgB,KAAKI,QAArB,KAAkCJ,gBAAgB,KAAKG,QAAL,CAAc,CAAd,CAAhB,CAAlC,IAAuEH,gBAAgB,KAAKG,QAAL,CAAc,CAAd,CAAhB,CAAvE,IAA4GH,gBAAgB,KAAKhK,KAAL,CAAW,CAAX,IAAgB,CAAhC,CAA5G,IAAkJgK,gBAAgB,KAAKhK,KAAL,CAAW,CAAX,IAAgB,CAAhC,CAAzJ;AACD,GAFD;;AAIAsK,qBAAmBG,eAAnB,GAAqC,YAAY;AAC/C,QAAI5D,SAAS,KAAKA,MAAlB;AACA,QAAI6D,qBAAqB7D,UAAUA,OAAO0D,SAA1C;AACA,QAAIC,qBAAqB,KAAKA,kBAAL,EAAzB;AACA,QAAI5J,IAAI,KAAK2J,SAAb;;AAEA,QAAI,EAAEC,sBAAsBE,kBAAxB,CAAJ,EAAiD;AAC/C9J,WAAKkJ,UAAUlJ,CAAV,CAAL;AACA;AACD;;AAEDA,QAAIA,KAAKkH,UAAT;;AAEA,QAAI0C,kBAAJ,EAAwB;AACtB,WAAKG,iBAAL,CAAuB/J,CAAvB;AACD,KAFD,MAEO;AACLkJ,gBAAUlJ,CAAV;AACD,KAjB8C,CAiB7C;;;AAGF,QAAI8J,kBAAJ,EAAwB;AACtB,UAAIF,kBAAJ,EAAwB;AACtBvC,cAAMrH,CAAN,EAASiG,OAAO0D,SAAhB,EAA2B3J,CAA3B;AACD,OAFD,MAEO;AACLoH,eAAOpH,CAAP,EAAUiG,OAAO0D,SAAjB;AACD;AACF,KA1B8C,CA0B7C;;;AAGF,SAAKA,SAAL,GAAiB3J,CAAjB;AACA,SAAKgK,YAAL,GAAoB,KAAKA,YAAL,IAAqB9C,UAAzC;AACA4B,WAAO,KAAKkB,YAAZ,EAA0BhK,CAA1B;AACD,GAhCD;;AAkCA0J,qBAAmBK,iBAAnB,GAAuC,UAAU/J,CAAV,EAAa;AAClD,WAAOqJ,cAAcU,iBAAd,CAAgC,IAAhC,EAAsC/J,CAAtC,CAAP;AACD,GAFD;AAGA;;;;;AAMA0J,qBAAmBO,YAAnB,GAAkC,UAAU7H,GAAV,EAAe;AAC/C,QAAIpC,IAAI,KAAK2J,SAAb;AACA,QAAIO,MAAM9H,IAAI8H,GAAJ,IAAW,CAArB;;AAEA,QAAIlK,CAAJ,EAAO;AACLoC,UAAI6H,YAAJ,CAAiBC,MAAMlK,EAAE,CAAF,CAAvB,EAA6BkK,MAAMlK,EAAE,CAAF,CAAnC,EAAyCkK,MAAMlK,EAAE,CAAF,CAA/C,EAAqDkK,MAAMlK,EAAE,CAAF,CAA3D,EAAiEkK,MAAMlK,EAAE,CAAF,CAAvE,EAA6EkK,MAAMlK,EAAE,CAAF,CAAnF;AACD,KAFD,MAEO;AACLoC,UAAI6H,YAAJ,CAAiBC,GAAjB,EAAsB,CAAtB,EAAyB,CAAzB,EAA4BA,GAA5B,EAAiC,CAAjC,EAAoC,CAApC;AACD;AACF,GATD;;AAWAR,qBAAmBS,gBAAnB,GAAsC,UAAU/H,GAAV,EAAe;AACnD,QAAI8H,MAAM9H,IAAI8H,GAAJ,IAAW,CAArB;AACA9H,QAAI6H,YAAJ,CAAiBC,GAAjB,EAAsB,CAAtB,EAAyB,CAAzB,EAA4BA,GAA5B,EAAiC,CAAjC,EAAoC,CAApC;AACD,GAHD;;AAKA,MAAIE,eAAe,EAAnB;AACA;;;;AAIAV,qBAAmBW,kBAAnB,GAAwC,YAAY;AAClD,QAAI,CAAC,KAAKV,SAAV,EAAqB;AACnB;AACD;;AAED,QAAI1D,SAAS,KAAKA,MAAlB;AACA,QAAIjG,IAAI,KAAK2J,SAAb;;AAEA,QAAI1D,UAAUA,OAAO0D,SAArB,EAAgC;AAC9B;AACAtC,YAAM+C,YAAN,EAAoBnE,OAAO+D,YAA3B,EAAyChK,CAAzC;AACAA,UAAIoK,YAAJ;AACD;;AAED,QAAIE,KAAKtK,EAAE,CAAF,IAAOA,EAAE,CAAF,CAAP,GAAcA,EAAE,CAAF,IAAOA,EAAE,CAAF,CAA9B;AACA,QAAIuK,KAAKvK,EAAE,CAAF,IAAOA,EAAE,CAAF,CAAP,GAAcA,EAAE,CAAF,IAAOA,EAAE,CAAF,CAA9B;AACA,QAAIuJ,WAAW,KAAKA,QAApB;AACA,QAAIiB,WAAW,KAAKpL,KAApB;;AAEA,QAAIgK,gBAAgBkB,KAAK,CAArB,CAAJ,EAA6B;AAC3BA,WAAKzL,KAAKC,IAAL,CAAUwL,EAAV,CAAL;AACD;;AAED,QAAIlB,gBAAgBmB,KAAK,CAArB,CAAJ,EAA6B;AAC3BA,WAAK1L,KAAKC,IAAL,CAAUyL,EAAV,CAAL;AACD;;AAED,QAAIvK,EAAE,CAAF,IAAO,CAAX,EAAc;AACZsK,WAAK,CAACA,EAAN;AACD;;AAED,QAAItK,EAAE,CAAF,IAAO,CAAX,EAAc;AACZuK,WAAK,CAACA,EAAN;AACD;;AAEDhB,aAAS,CAAT,IAAcvJ,EAAE,CAAF,CAAd;AACAuJ,aAAS,CAAT,IAAcvJ,EAAE,CAAF,CAAd;AACAwK,aAAS,CAAT,IAAcF,EAAd;AACAE,aAAS,CAAT,IAAcD,EAAd;AACA,SAAKf,QAAL,GAAgB3K,KAAK4L,KAAL,CAAW,CAACzK,EAAE,CAAF,CAAD,GAAQuK,EAAnB,EAAuBvK,EAAE,CAAF,IAAOsK,EAA9B,CAAhB;AACD,GAxCD;AAyCA;;;;;AAMAZ,qBAAmBgB,cAAnB,GAAoC,YAAY;AAC9C,QAAI1K,IAAI,KAAK2J,SAAb;;AAEA,QAAI,CAAC3J,CAAL,EAAQ;AACN,aAAO,CAAC,CAAD,EAAI,CAAJ,CAAP;AACD;;AAED,QAAIsK,KAAKzL,KAAKC,IAAL,CAAUkB,EAAE,CAAF,IAAOA,EAAE,CAAF,CAAP,GAAcA,EAAE,CAAF,IAAOA,EAAE,CAAF,CAA/B,CAAT;AACA,QAAIuK,KAAK1L,KAAKC,IAAL,CAAUkB,EAAE,CAAF,IAAOA,EAAE,CAAF,CAAP,GAAcA,EAAE,CAAF,IAAOA,EAAE,CAAF,CAA/B,CAAT;;AAEA,QAAIA,EAAE,CAAF,IAAO,CAAX,EAAc;AACZsK,WAAK,CAACA,EAAN;AACD;;AAED,QAAItK,EAAE,CAAF,IAAO,CAAX,EAAc;AACZuK,WAAK,CAACA,EAAN;AACD;;AAED,WAAO,CAACD,EAAD,EAAKC,EAAL,CAAP;AACD,GAnBD;AAoBA;;;;;;;;AASAb,qBAAmBiB,qBAAnB,GAA2C,UAAUzM,CAAV,EAAaC,CAAb,EAAgB;AACzD,QAAIO,KAAK,CAACR,CAAD,EAAIC,CAAJ,CAAT;AACA,QAAI6L,eAAe,KAAKA,YAAxB;;AAEA,QAAIA,YAAJ,EAAkB;AAChBjK,qBAAerB,EAAf,EAAmBA,EAAnB,EAAuBsL,YAAvB;AACD;;AAED,WAAOtL,EAAP;AACD,GATD;AAUA;;;;;;;;AASAgL,qBAAmBkB,sBAAnB,GAA4C,UAAU1M,CAAV,EAAaC,CAAb,EAAgB;AAC1D,QAAIO,KAAK,CAACR,CAAD,EAAIC,CAAJ,CAAT;AACA,QAAIwL,YAAY,KAAKA,SAArB;;AAEA,QAAIA,SAAJ,EAAe;AACb5J,qBAAerB,EAAf,EAAmBA,EAAnB,EAAuBiL,SAAvB;AACD;;AAED,WAAOjL,EAAP;AACD,GATD;AAUA;;;;;;;;;AAUA2K,gBAAcU,iBAAd,GAAkC,UAAUtR,MAAV,EAAkBuH,CAAlB,EAAqB;AACrDA,QAAIA,KAAK,EAAT;AACAkJ,cAAUlJ,CAAV;AACA,QAAIyJ,SAAShR,OAAOgR,MAApB;AACA,QAAIe,WAAW/R,OAAO2G,KAAP,IAAgB,CAAC,CAAD,EAAI,CAAJ,CAA/B;AACA,QAAIoK,WAAW/Q,OAAO+Q,QAAP,IAAmB,CAAlC;AACA,QAAID,WAAW9Q,OAAO8Q,QAAP,IAAmB,CAAC,CAAD,EAAI,CAAJ,CAAlC;;AAEA,QAAIE,MAAJ,EAAY;AACV;AACAzJ,QAAE,CAAF,KAAQyJ,OAAO,CAAP,CAAR;AACAzJ,QAAE,CAAF,KAAQyJ,OAAO,CAAP,CAAR;AACD;;AAEDd,YAAQ3I,CAAR,EAAWA,CAAX,EAAcwK,QAAd;;AAEA,QAAIhB,QAAJ,EAAc;AACZzB,aAAO/H,CAAP,EAAUA,CAAV,EAAawJ,QAAb;AACD;;AAED,QAAIC,MAAJ,EAAY;AACV;AACAzJ,QAAE,CAAF,KAAQyJ,OAAO,CAAP,CAAR;AACAzJ,QAAE,CAAF,KAAQyJ,OAAO,CAAP,CAAR;AACD;;AAEDzJ,MAAE,CAAF,KAAQuJ,SAAS,CAAT,CAAR;AACAvJ,MAAE,CAAF,KAAQuJ,SAAS,CAAT,CAAR;AACA,WAAOvJ,CAAP;AACD,GA7BD;;AA+BA;;;;;AAKA,MAAI6K,SAAS;AACX;;;;AAIAC,YAAQ,gBAAUC,CAAV,EAAa;AACnB,aAAOA,CAAP;AACD,KAPU;;AASX;;;;AAIAC,iBAAa,qBAAUD,CAAV,EAAa;AACxB,aAAOA,IAAIA,CAAX;AACD,KAfU;;AAiBX;;;;AAIAE,kBAAc,sBAAUF,CAAV,EAAa;AACzB,aAAOA,KAAK,IAAIA,CAAT,CAAP;AACD,KAvBU;;AAyBX;;;;AAIAG,oBAAgB,wBAAUH,CAAV,EAAa;AAC3B,UAAI,CAACA,KAAK,CAAN,IAAW,CAAf,EAAkB;AAChB,eAAO,MAAMA,CAAN,GAAUA,CAAjB;AACD;;AAED,aAAO,CAAC,GAAD,IAAQ,EAAEA,CAAF,IAAOA,IAAI,CAAX,IAAgB,CAAxB,CAAP;AACD,KAnCU;AAoCX;;AAEA;;;;AAIAI,aAAS,iBAAUJ,CAAV,EAAa;AACpB,aAAOA,IAAIA,CAAJ,GAAQA,CAAf;AACD,KA5CU;;AA8CX;;;;AAIAK,cAAU,kBAAUL,CAAV,EAAa;AACrB,aAAO,EAAEA,CAAF,GAAMA,CAAN,GAAUA,CAAV,GAAc,CAArB;AACD,KApDU;;AAsDX;;;;AAIAM,gBAAY,oBAAUN,CAAV,EAAa;AACvB,UAAI,CAACA,KAAK,CAAN,IAAW,CAAf,EAAkB;AAChB,eAAO,MAAMA,CAAN,GAAUA,CAAV,GAAcA,CAArB;AACD;;AAED,aAAO,OAAO,CAACA,KAAK,CAAN,IAAWA,CAAX,GAAeA,CAAf,GAAmB,CAA1B,CAAP;AACD,KAhEU;AAiEX;;AAEA;;;;AAIAO,eAAW,mBAAUP,CAAV,EAAa;AACtB,aAAOA,IAAIA,CAAJ,GAAQA,CAAR,GAAYA,CAAnB;AACD,KAzEU;;AA2EX;;;;AAIAQ,gBAAY,oBAAUR,CAAV,EAAa;AACvB,aAAO,IAAI,EAAEA,CAAF,GAAMA,CAAN,GAAUA,CAAV,GAAcA,CAAzB;AACD,KAjFU;;AAmFX;;;;AAIAS,kBAAc,sBAAUT,CAAV,EAAa;AACzB,UAAI,CAACA,KAAK,CAAN,IAAW,CAAf,EAAkB;AAChB,eAAO,MAAMA,CAAN,GAAUA,CAAV,GAAcA,CAAd,GAAkBA,CAAzB;AACD;;AAED,aAAO,CAAC,GAAD,IAAQ,CAACA,KAAK,CAAN,IAAWA,CAAX,GAAeA,CAAf,GAAmBA,CAAnB,GAAuB,CAA/B,CAAP;AACD,KA7FU;AA8FX;;AAEA;;;;AAIAU,eAAW,mBAAUV,CAAV,EAAa;AACtB,aAAOA,IAAIA,CAAJ,GAAQA,CAAR,GAAYA,CAAZ,GAAgBA,CAAvB;AACD,KAtGU;;AAwGX;;;;AAIAW,gBAAY,oBAAUX,CAAV,EAAa;AACvB,aAAO,EAAEA,CAAF,GAAMA,CAAN,GAAUA,CAAV,GAAcA,CAAd,GAAkBA,CAAlB,GAAsB,CAA7B;AACD,KA9GU;;AAgHX;;;;AAIAY,kBAAc,sBAAUZ,CAAV,EAAa;AACzB,UAAI,CAACA,KAAK,CAAN,IAAW,CAAf,EAAkB;AAChB,eAAO,MAAMA,CAAN,GAAUA,CAAV,GAAcA,CAAd,GAAkBA,CAAlB,GAAsBA,CAA7B;AACD;;AAED,aAAO,OAAO,CAACA,KAAK,CAAN,IAAWA,CAAX,GAAeA,CAAf,GAAmBA,CAAnB,GAAuBA,CAAvB,GAA2B,CAAlC,CAAP;AACD,KA1HU;AA2HX;;AAEA;;;;AAIAa,kBAAc,sBAAUb,CAAV,EAAa;AACzB,aAAO,IAAIlM,KAAK6J,GAAL,CAASqC,IAAIlM,KAAKgN,EAAT,GAAc,CAAvB,CAAX;AACD,KAnIU;;AAqIX;;;;AAIAC,mBAAe,uBAAUf,CAAV,EAAa;AAC1B,aAAOlM,KAAK2J,GAAL,CAASuC,IAAIlM,KAAKgN,EAAT,GAAc,CAAvB,CAAP;AACD,KA3IU;;AA6IX;;;;AAIAE,qBAAiB,yBAAUhB,CAAV,EAAa;AAC5B,aAAO,OAAO,IAAIlM,KAAK6J,GAAL,CAAS7J,KAAKgN,EAAL,GAAUd,CAAnB,CAAX,CAAP;AACD,KAnJU;AAoJX;;AAEA;;;;AAIAiB,mBAAe,uBAAUjB,CAAV,EAAa;AAC1B,aAAOA,MAAM,CAAN,GAAU,CAAV,GAAclM,KAAKoN,GAAL,CAAS,IAAT,EAAelB,IAAI,CAAnB,CAArB;AACD,KA5JU;;AA8JX;;;;AAIAmB,oBAAgB,wBAAUnB,CAAV,EAAa;AAC3B,aAAOA,MAAM,CAAN,GAAU,CAAV,GAAc,IAAIlM,KAAKoN,GAAL,CAAS,CAAT,EAAY,CAAC,EAAD,GAAMlB,CAAlB,CAAzB;AACD,KApKU;;AAsKX;;;;AAIAoB,sBAAkB,0BAAUpB,CAAV,EAAa;AAC7B,UAAIA,MAAM,CAAV,EAAa;AACX,eAAO,CAAP;AACD;;AAED,UAAIA,MAAM,CAAV,EAAa;AACX,eAAO,CAAP;AACD;;AAED,UAAI,CAACA,KAAK,CAAN,IAAW,CAAf,EAAkB;AAChB,eAAO,MAAMlM,KAAKoN,GAAL,CAAS,IAAT,EAAelB,IAAI,CAAnB,CAAb;AACD;;AAED,aAAO,OAAO,CAAClM,KAAKoN,GAAL,CAAS,CAAT,EAAY,CAAC,EAAD,IAAOlB,IAAI,CAAX,CAAZ,CAAD,GAA8B,CAArC,CAAP;AACD,KAxLU;AAyLX;;AAEA;;;;AAIAqB,gBAAY,oBAAUrB,CAAV,EAAa;AACvB,aAAO,IAAIlM,KAAKC,IAAL,CAAU,IAAIiM,IAAIA,CAAlB,CAAX;AACD,KAjMU;;AAmMX;;;;AAIAsB,iBAAa,qBAAUtB,CAAV,EAAa;AACxB,aAAOlM,KAAKC,IAAL,CAAU,IAAI,EAAEiM,CAAF,GAAMA,CAApB,CAAP;AACD,KAzMU;;AA2MX;;;;AAIAuB,mBAAe,uBAAUvB,CAAV,EAAa;AAC1B,UAAI,CAACA,KAAK,CAAN,IAAW,CAAf,EAAkB;AAChB,eAAO,CAAC,GAAD,IAAQlM,KAAKC,IAAL,CAAU,IAAIiM,IAAIA,CAAlB,IAAuB,CAA/B,CAAP;AACD;;AAED,aAAO,OAAOlM,KAAKC,IAAL,CAAU,IAAI,CAACiM,KAAK,CAAN,IAAWA,CAAzB,IAA8B,CAArC,CAAP;AACD,KArNU;AAsNX;;AAEA;;;;AAIAwB,eAAW,mBAAUxB,CAAV,EAAa;AACtB,UAAI1L,CAAJ;AACA,UAAIhC,IAAI,GAAR;AACA,UAAImP,IAAI,GAAR;;AAEA,UAAIzB,MAAM,CAAV,EAAa;AACX,eAAO,CAAP;AACD;;AAED,UAAIA,MAAM,CAAV,EAAa;AACX,eAAO,CAAP;AACD;;AAED,UAAI,CAAC1N,CAAD,IAAMA,IAAI,CAAd,EAAiB;AACfA,YAAI,CAAJ;AACAgC,YAAImN,IAAI,CAAR;AACD,OAHD,MAGO;AACLnN,YAAImN,IAAI3N,KAAK4N,IAAL,CAAU,IAAIpP,CAAd,CAAJ,IAAwB,IAAIwB,KAAKgN,EAAjC,CAAJ;AACD;;AAED,aAAO,EAAExO,IAAIwB,KAAKoN,GAAL,CAAS,CAAT,EAAY,MAAMlB,KAAK,CAAX,CAAZ,CAAJ,GAAiClM,KAAK2J,GAAL,CAAS,CAACuC,IAAI1L,CAAL,KAAW,IAAIR,KAAKgN,EAApB,IAA0BW,CAAnC,CAAnC,CAAP;AACD,KAjPU;;AAmPX;;;;AAIAE,gBAAY,oBAAU3B,CAAV,EAAa;AACvB,UAAI1L,CAAJ;AACA,UAAIhC,IAAI,GAAR;AACA,UAAImP,IAAI,GAAR;;AAEA,UAAIzB,MAAM,CAAV,EAAa;AACX,eAAO,CAAP;AACD;;AAED,UAAIA,MAAM,CAAV,EAAa;AACX,eAAO,CAAP;AACD;;AAED,UAAI,CAAC1N,CAAD,IAAMA,IAAI,CAAd,EAAiB;AACfA,YAAI,CAAJ;AACAgC,YAAImN,IAAI,CAAR;AACD,OAHD,MAGO;AACLnN,YAAImN,IAAI3N,KAAK4N,IAAL,CAAU,IAAIpP,CAAd,CAAJ,IAAwB,IAAIwB,KAAKgN,EAAjC,CAAJ;AACD;;AAED,aAAOxO,IAAIwB,KAAKoN,GAAL,CAAS,CAAT,EAAY,CAAC,EAAD,GAAMlB,CAAlB,CAAJ,GAA2BlM,KAAK2J,GAAL,CAAS,CAACuC,IAAI1L,CAAL,KAAW,IAAIR,KAAKgN,EAApB,IAA0BW,CAAnC,CAA3B,GAAmE,CAA1E;AACD,KA5QU;;AA8QX;;;;AAIAG,kBAAc,sBAAU5B,CAAV,EAAa;AACzB,UAAI1L,CAAJ;AACA,UAAIhC,IAAI,GAAR;AACA,UAAImP,IAAI,GAAR;;AAEA,UAAIzB,MAAM,CAAV,EAAa;AACX,eAAO,CAAP;AACD;;AAED,UAAIA,MAAM,CAAV,EAAa;AACX,eAAO,CAAP;AACD;;AAED,UAAI,CAAC1N,CAAD,IAAMA,IAAI,CAAd,EAAiB;AACfA,YAAI,CAAJ;AACAgC,YAAImN,IAAI,CAAR;AACD,OAHD,MAGO;AACLnN,YAAImN,IAAI3N,KAAK4N,IAAL,CAAU,IAAIpP,CAAd,CAAJ,IAAwB,IAAIwB,KAAKgN,EAAjC,CAAJ;AACD;;AAED,UAAI,CAACd,KAAK,CAAN,IAAW,CAAf,EAAkB;AAChB,eAAO,CAAC,GAAD,IAAQ1N,IAAIwB,KAAKoN,GAAL,CAAS,CAAT,EAAY,MAAMlB,KAAK,CAAX,CAAZ,CAAJ,GAAiClM,KAAK2J,GAAL,CAAS,CAACuC,IAAI1L,CAAL,KAAW,IAAIR,KAAKgN,EAApB,IAA0BW,CAAnC,CAAzC,CAAP;AACD;;AAED,aAAOnP,IAAIwB,KAAKoN,GAAL,CAAS,CAAT,EAAY,CAAC,EAAD,IAAOlB,KAAK,CAAZ,CAAZ,CAAJ,GAAkClM,KAAK2J,GAAL,CAAS,CAACuC,IAAI1L,CAAL,KAAW,IAAIR,KAAKgN,EAApB,IAA0BW,CAAnC,CAAlC,GAA0E,GAA1E,GAAgF,CAAvF;AACD,KA3SU;AA4SX;;AAEA;;;;AAIAI,YAAQ,gBAAU7B,CAAV,EAAa;AACnB,UAAI1L,IAAI,OAAR;AACA,aAAO0L,IAAIA,CAAJ,IAAS,CAAC1L,IAAI,CAAL,IAAU0L,CAAV,GAAc1L,CAAvB,CAAP;AACD,KArTU;;AAuTX;;;;AAIAwN,aAAS,iBAAU9B,CAAV,EAAa;AACpB,UAAI1L,IAAI,OAAR;AACA,aAAO,EAAE0L,CAAF,GAAMA,CAAN,IAAW,CAAC1L,IAAI,CAAL,IAAU0L,CAAV,GAAc1L,CAAzB,IAA8B,CAArC;AACD,KA9TU;;AAgUX;;;;AAIAyN,eAAW,mBAAU/B,CAAV,EAAa;AACtB,UAAI1L,IAAI,UAAU,KAAlB;;AAEA,UAAI,CAAC0L,KAAK,CAAN,IAAW,CAAf,EAAkB;AAChB,eAAO,OAAOA,IAAIA,CAAJ,IAAS,CAAC1L,IAAI,CAAL,IAAU0L,CAAV,GAAc1L,CAAvB,CAAP,CAAP;AACD;;AAED,aAAO,OAAO,CAAC0L,KAAK,CAAN,IAAWA,CAAX,IAAgB,CAAC1L,IAAI,CAAL,IAAU0L,CAAV,GAAc1L,CAA9B,IAAmC,CAA1C,CAAP;AACD,KA5UU;AA6UX;;AAEA;;;;AAIA0N,cAAU,kBAAUhC,CAAV,EAAa;AACrB,aAAO,IAAIF,OAAOmC,SAAP,CAAiB,IAAIjC,CAArB,CAAX;AACD,KArVU;;AAuVX;;;;AAIAiC,eAAW,mBAAUjC,CAAV,EAAa;AACtB,UAAIA,IAAI,IAAI,IAAZ,EAAkB;AAChB,eAAO,SAASA,CAAT,GAAaA,CAApB;AACD,OAFD,MAEO,IAAIA,IAAI,IAAI,IAAZ,EAAkB;AACvB,eAAO,UAAUA,KAAK,MAAM,IAArB,IAA6BA,CAA7B,GAAiC,IAAxC;AACD,OAFM,MAEA,IAAIA,IAAI,MAAM,IAAd,EAAoB;AACzB,eAAO,UAAUA,KAAK,OAAO,IAAtB,IAA8BA,CAA9B,GAAkC,MAAzC;AACD,OAFM,MAEA;AACL,eAAO,UAAUA,KAAK,QAAQ,IAAvB,IAA+BA,CAA/B,GAAmC,QAA1C;AACD;AACF,KArWU;;AAuWX;;;;AAIAkC,iBAAa,qBAAUlC,CAAV,EAAa;AACxB,UAAIA,IAAI,GAAR,EAAa;AACX,eAAOF,OAAOkC,QAAP,CAAgBhC,IAAI,CAApB,IAAyB,GAAhC;AACD;;AAED,aAAOF,OAAOmC,SAAP,CAAiBjC,IAAI,CAAJ,GAAQ,CAAzB,IAA8B,GAA9B,GAAoC,GAA3C;AACD;AAjXU,GAAb;;AAoXA;;;;;;;;;;;;;;AAcA,WAASmC,IAAT,CAAcC,OAAd,EAAuB;AACrB,SAAKC,OAAL,GAAeD,QAAQ1U,MAAvB,CADqB,CACU;;AAE/B,SAAK4U,KAAL,GAAaF,QAAQG,IAAR,IAAgB,IAA7B,CAHqB,CAGc;;AAEnC,SAAKC,MAAL,GAAcJ,QAAQK,KAAR,IAAiB,CAA/B,CALqB,CAKa;AAClC;;AAEA,SAAKC,YAAL,GAAoB,KAApB,CARqB,CAQM;;AAE3B,SAAKC,IAAL,GAAYP,QAAQO,IAAR,IAAgB,IAAhB,GAAuB,KAAvB,GAA+BP,QAAQO,IAAnD;AACA,SAAKC,GAAL,GAAWR,QAAQQ,GAAR,IAAe,CAA1B;AACA,SAAK9C,MAAL,GAAcsC,QAAQtC,MAAR,IAAkB,QAAhC;AACA,SAAK+C,OAAL,GAAeT,QAAQS,OAAvB;AACA,SAAKC,SAAL,GAAiBV,QAAQU,SAAzB;AACA,SAAKC,SAAL,GAAiBX,QAAQW,SAAzB;AACA,SAAKC,WAAL,GAAmB,CAAnB;AACA,SAAKC,OAAL,GAAe,KAAf;AACD;;AAEDd,OAAK5W,SAAL,GAAiB;AACf6B,iBAAa+U,IADE;AAEfe,UAAM,cAAUC,UAAV,EAAsBC,SAAtB,EAAiC;AACrC;AACA;AACA,UAAI,CAAC,KAAKV,YAAV,EAAwB;AACtB,aAAKW,UAAL,GAAkBF,aAAa,KAAKX,MAApC;AACA,aAAKE,YAAL,GAAoB,IAApB;AACD;;AAED,UAAI,KAAKO,OAAT,EAAkB;AAChB,aAAKD,WAAL,IAAoBI,SAApB;AACA;AACD;;AAED,UAAIE,UAAU,CAACH,aAAa,KAAKE,UAAlB,GAA+B,KAAKL,WAArC,IAAoD,KAAKV,KAAvE,CAbqC,CAayC;;AAE9E,UAAIgB,UAAU,CAAd,EAAiB;AACf;AACD;;AAEDA,gBAAUxP,KAAKoB,GAAL,CAASoO,OAAT,EAAkB,CAAlB,CAAV;AACA,UAAIC,YAAY,KAAKzD,MAArB;AACA,UAAI0D,aAAa,OAAOD,SAAP,IAAoB,QAApB,GAA+BzD,OAAOyD,SAAP,CAA/B,GAAmDA,SAApE;AACA,UAAIE,WAAW,OAAOD,UAAP,KAAsB,UAAtB,GAAmCA,WAAWF,OAAX,CAAnC,GAAyDA,OAAxE;AACA,WAAKI,IAAL,CAAU,OAAV,EAAmBD,QAAnB,EAvBqC,CAuBP;;AAE9B,UAAIH,WAAW,CAAf,EAAkB;AAChB,YAAI,KAAKX,IAAT,EAAe;AACb,eAAKgB,OAAL,CAAaR,UAAb,EADa,CACa;AAC1B;;AAEA,iBAAO,SAAP;AACD,SANe,CAMd;AACF;;;AAGA,aAAKS,YAAL,GAAoB,IAApB;AACA,eAAO,SAAP;AACD;;AAED,aAAO,IAAP;AACD,KA1Cc;AA2CfD,aAAS,iBAAUR,UAAV,EAAsB;AAC7B,UAAIU,YAAY,CAACV,aAAa,KAAKE,UAAlB,GAA+B,KAAKL,WAArC,IAAoD,KAAKV,KAAzE;AACA,WAAKe,UAAL,GAAkBF,aAAaU,SAAb,GAAyB,KAAKjB,GAAhD;AACA,WAAKI,WAAL,GAAmB,CAAnB;AACA,WAAKY,YAAL,GAAoB,KAApB;AACD,KAhDc;AAiDfF,UAAM,cAAUI,SAAV,EAAqBC,GAArB,EAA0B;AAC9BD,kBAAY,OAAOA,SAAnB;;AAEA,UAAI,KAAKA,SAAL,CAAJ,EAAqB;AACnB,aAAKA,SAAL,EAAgB,KAAKzB,OAArB,EAA8B0B,GAA9B;AACD;AACF,KAvDc;AAwDfC,WAAO,iBAAY;AACjB,WAAKf,OAAL,GAAe,IAAf;AACD,KA1Dc;AA2DfgB,YAAQ,kBAAY;AAClB,WAAKhB,OAAL,GAAe,KAAf;AACD;AA7Dc,GAAjB;;AAgEA;AACA;;AAEA;;;;AAIA,MAAIiB,aAAa,SAAbA,UAAa,GAAY;AAC3B;;;AAGA,SAAKC,IAAL,GAAY,IAAZ;AACA;;;;AAIA,SAAKC,IAAL,GAAY,IAAZ;AACA,SAAKC,IAAL,GAAY,CAAZ;AACD,GAXD;;AAaA,MAAIC,kBAAkBJ,WAAW3Y,SAAjC;AACA;;;;;;AAMA+Y,kBAAgBC,MAAhB,GAAyB,UAAUrT,GAAV,EAAe;AACtC,QAAIsT,QAAQ,IAAIC,KAAJ,CAAUvT,GAAV,CAAZ;AACA,SAAKwT,WAAL,CAAiBF,KAAjB;AACA,WAAOA,KAAP;AACD,GAJD;AAKA;;;;;AAMAF,kBAAgBI,WAAhB,GAA8B,UAAUF,KAAV,EAAiB;AAC7C,QAAI,CAAC,KAAKL,IAAV,EAAgB;AACd,WAAKA,IAAL,GAAY,KAAKC,IAAL,GAAYI,KAAxB;AACD,KAFD,MAEO;AACL,WAAKJ,IAAL,CAAUO,IAAV,GAAiBH,KAAjB;AACAA,YAAMI,IAAN,GAAa,KAAKR,IAAlB;AACAI,YAAMG,IAAN,GAAa,IAAb;AACA,WAAKP,IAAL,GAAYI,KAAZ;AACD;;AAED,SAAKH,IAAL;AACD,GAXD;AAYA;;;;;AAMAC,kBAAgBO,MAAhB,GAAyB,UAAUL,KAAV,EAAiB;AACxC,QAAII,OAAOJ,MAAMI,IAAjB;AACA,QAAID,OAAOH,MAAMG,IAAjB;;AAEA,QAAIC,IAAJ,EAAU;AACRA,WAAKD,IAAL,GAAYA,IAAZ;AACD,KAFD,MAEO;AACL;AACA,WAAKR,IAAL,GAAYQ,IAAZ;AACD;;AAED,QAAIA,IAAJ,EAAU;AACRA,WAAKC,IAAL,GAAYA,IAAZ;AACD,KAFD,MAEO;AACL;AACA,WAAKR,IAAL,GAAYQ,IAAZ;AACD;;AAEDJ,UAAMG,IAAN,GAAaH,MAAMI,IAAN,GAAa,IAA1B;AACA,SAAKP,IAAL;AACD,GApBD;AAqBA;;;;AAKAC,kBAAgBrX,GAAhB,GAAsB,YAAY;AAChC,WAAO,KAAKoX,IAAZ;AACD,GAFD;AAGA;;;;AAKAC,kBAAgBQ,KAAhB,GAAwB,YAAY;AAClC,SAAKX,IAAL,GAAY,KAAKC,IAAL,GAAY,IAAxB;AACA,SAAKC,IAAL,GAAY,CAAZ;AACD,GAHD;AAIA;;;;;AAMA,MAAII,QAAQ,SAARA,KAAQ,CAAUvT,GAAV,EAAe;AACzB;;;AAGA,SAAKzC,KAAL,GAAayC,GAAb;AACA;;;;AAIA,SAAKyT,IAAL;AACA;;;;AAIA,SAAKC,IAAL;AACD,GAfD;AAgBA;;;;;;AAOA,MAAIG,MAAM,SAANA,GAAM,CAAUC,OAAV,EAAmB;AAC3B,SAAKC,KAAL,GAAa,IAAIf,UAAJ,EAAb;AACA,SAAKgB,IAAL,GAAY,EAAZ;AACA,SAAKC,QAAL,GAAgBH,WAAW,EAA3B;AACA,SAAKI,iBAAL,GAAyB,IAAzB;AACD,GALD;;AAOA,MAAIC,WAAWN,IAAIxZ,SAAnB;AACA;;;;;;AAMA8Z,WAASC,GAAT,GAAe,UAAU/X,GAAV,EAAekB,KAAf,EAAsB;AACnC,QAAI6M,OAAO,KAAK2J,KAAhB;AACA,QAAI/Y,MAAM,KAAKgZ,IAAf;AACA,QAAIK,UAAU,IAAd;;AAEA,QAAIrZ,IAAIqB,GAAJ,KAAY,IAAhB,EAAsB;AACpB,UAAIN,MAAMqO,KAAKrO,GAAL,EAAV,CADoB,CACE;;AAEtB,UAAIuX,QAAQ,KAAKY,iBAAjB;;AAEA,UAAInY,OAAO,KAAKkY,QAAZ,IAAwBlY,MAAM,CAAlC,EAAqC;AACnC;AACA,YAAIuY,iBAAiBlK,KAAK6I,IAA1B;AACA7I,aAAKuJ,MAAL,CAAYW,cAAZ;AACA,eAAOtZ,IAAIsZ,eAAejY,GAAnB,CAAP;AACAgY,kBAAUC,eAAe/W,KAAzB;AACA,aAAK2W,iBAAL,GAAyBI,cAAzB;AACD;;AAED,UAAIhB,KAAJ,EAAW;AACTA,cAAM/V,KAAN,GAAcA,KAAd;AACD,OAFD,MAEO;AACL+V,gBAAQ,IAAIC,KAAJ,CAAUhW,KAAV,CAAR;AACD;;AAED+V,YAAMjX,GAAN,GAAYA,GAAZ;AACA+N,WAAKoJ,WAAL,CAAiBF,KAAjB;AACAtY,UAAIqB,GAAJ,IAAWiX,KAAX;AACD;;AAED,WAAOe,OAAP;AACD,GA/BD;AAgCA;;;;;AAMAF,WAASnT,GAAT,GAAe,UAAU3E,GAAV,EAAe;AAC5B,QAAIiX,QAAQ,KAAKU,IAAL,CAAU3X,GAAV,CAAZ;AACA,QAAI+N,OAAO,KAAK2J,KAAhB;;AAEA,QAAIT,SAAS,IAAb,EAAmB;AACjB;AACA,UAAIA,UAAUlJ,KAAK8I,IAAnB,EAAyB;AACvB9I,aAAKuJ,MAAL,CAAYL,KAAZ;AACAlJ,aAAKoJ,WAAL,CAAiBF,KAAjB;AACD;;AAED,aAAOA,MAAM/V,KAAb;AACD;AACF,GAbD;AAcA;;;;AAKA4W,WAASP,KAAT,GAAiB,YAAY;AAC3B,SAAKG,KAAL,CAAWH,KAAX;;AAEA,SAAKI,IAAL,GAAY,EAAZ;AACD,GAJD;;AAMA,MAAIO,iBAAiB;AACnB,mBAAe,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,CADI;AAEnB,iBAAa,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAFM;AAGnB,oBAAgB,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAHG;AAInB,YAAQ,CAAC,CAAD,EAAI,GAAJ,EAAS,GAAT,EAAc,CAAd,CAJW;AAKnB,kBAAc,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CALK;AAMnB,aAAS,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CANU;AAOnB,aAAS,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAPU;AAQnB,cAAU,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CARS;AASnB,aAAS,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,CATU;AAUnB,sBAAkB,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAVC;AAWnB,YAAQ,CAAC,CAAD,EAAI,CAAJ,EAAO,GAAP,EAAY,CAAZ,CAXW;AAYnB,kBAAc,CAAC,GAAD,EAAM,EAAN,EAAU,GAAV,EAAe,CAAf,CAZK;AAanB,aAAS,CAAC,GAAD,EAAM,EAAN,EAAU,EAAV,EAAc,CAAd,CAbU;AAcnB,iBAAa,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAdM;AAenB,iBAAa,CAAC,EAAD,EAAK,GAAL,EAAU,GAAV,EAAe,CAAf,CAfM;AAgBnB,kBAAc,CAAC,GAAD,EAAM,GAAN,EAAW,CAAX,EAAc,CAAd,CAhBK;AAiBnB,iBAAa,CAAC,GAAD,EAAM,GAAN,EAAW,EAAX,EAAe,CAAf,CAjBM;AAkBnB,aAAS,CAAC,GAAD,EAAM,GAAN,EAAW,EAAX,EAAe,CAAf,CAlBU;AAmBnB,sBAAkB,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAnBC;AAoBnB,gBAAY,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CApBO;AAqBnB,eAAW,CAAC,GAAD,EAAM,EAAN,EAAU,EAAV,EAAc,CAAd,CArBQ;AAsBnB,YAAQ,CAAC,CAAD,EAAI,GAAJ,EAAS,GAAT,EAAc,CAAd,CAtBW;AAuBnB,gBAAY,CAAC,CAAD,EAAI,CAAJ,EAAO,GAAP,EAAY,CAAZ,CAvBO;AAwBnB,gBAAY,CAAC,CAAD,EAAI,GAAJ,EAAS,GAAT,EAAc,CAAd,CAxBO;AAyBnB,qBAAiB,CAAC,GAAD,EAAM,GAAN,EAAW,EAAX,EAAe,CAAf,CAzBE;AA0BnB,gBAAY,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CA1BO;AA2BnB,iBAAa,CAAC,CAAD,EAAI,GAAJ,EAAS,CAAT,EAAY,CAAZ,CA3BM;AA4BnB,gBAAY,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CA5BO;AA6BnB,iBAAa,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CA7BM;AA8BnB,mBAAe,CAAC,GAAD,EAAM,CAAN,EAAS,GAAT,EAAc,CAAd,CA9BI;AA+BnB,sBAAkB,CAAC,EAAD,EAAK,GAAL,EAAU,EAAV,EAAc,CAAd,CA/BC;AAgCnB,kBAAc,CAAC,GAAD,EAAM,GAAN,EAAW,CAAX,EAAc,CAAd,CAhCK;AAiCnB,kBAAc,CAAC,GAAD,EAAM,EAAN,EAAU,GAAV,EAAe,CAAf,CAjCK;AAkCnB,eAAW,CAAC,GAAD,EAAM,CAAN,EAAS,CAAT,EAAY,CAAZ,CAlCQ;AAmCnB,kBAAc,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAnCK;AAoCnB,oBAAgB,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CApCG;AAqCnB,qBAAiB,CAAC,EAAD,EAAK,EAAL,EAAS,GAAT,EAAc,CAAd,CArCE;AAsCnB,qBAAiB,CAAC,EAAD,EAAK,EAAL,EAAS,EAAT,EAAa,CAAb,CAtCE;AAuCnB,qBAAiB,CAAC,EAAD,EAAK,EAAL,EAAS,EAAT,EAAa,CAAb,CAvCE;AAwCnB,qBAAiB,CAAC,CAAD,EAAI,GAAJ,EAAS,GAAT,EAAc,CAAd,CAxCE;AAyCnB,kBAAc,CAAC,GAAD,EAAM,CAAN,EAAS,GAAT,EAAc,CAAd,CAzCK;AA0CnB,gBAAY,CAAC,GAAD,EAAM,EAAN,EAAU,GAAV,EAAe,CAAf,CA1CO;AA2CnB,mBAAe,CAAC,CAAD,EAAI,GAAJ,EAAS,GAAT,EAAc,CAAd,CA3CI;AA4CnB,eAAW,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CA5CQ;AA6CnB,eAAW,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CA7CQ;AA8CnB,kBAAc,CAAC,EAAD,EAAK,GAAL,EAAU,GAAV,EAAe,CAAf,CA9CK;AA+CnB,iBAAa,CAAC,GAAD,EAAM,EAAN,EAAU,EAAV,EAAc,CAAd,CA/CM;AAgDnB,mBAAe,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAhDI;AAiDnB,mBAAe,CAAC,EAAD,EAAK,GAAL,EAAU,EAAV,EAAc,CAAd,CAjDI;AAkDnB,eAAW,CAAC,GAAD,EAAM,CAAN,EAAS,GAAT,EAAc,CAAd,CAlDQ;AAmDnB,iBAAa,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAnDM;AAoDnB,kBAAc,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CApDK;AAqDnB,YAAQ,CAAC,GAAD,EAAM,GAAN,EAAW,CAAX,EAAc,CAAd,CArDW;AAsDnB,iBAAa,CAAC,GAAD,EAAM,GAAN,EAAW,EAAX,EAAe,CAAf,CAtDM;AAuDnB,YAAQ,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAvDW;AAwDnB,aAAS,CAAC,CAAD,EAAI,GAAJ,EAAS,CAAT,EAAY,CAAZ,CAxDU;AAyDnB,mBAAe,CAAC,GAAD,EAAM,GAAN,EAAW,EAAX,EAAe,CAAf,CAzDI;AA0DnB,YAAQ,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CA1DW;AA2DnB,gBAAY,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CA3DO;AA4DnB,eAAW,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CA5DQ;AA6DnB,iBAAa,CAAC,GAAD,EAAM,EAAN,EAAU,EAAV,EAAc,CAAd,CA7DM;AA8DnB,cAAU,CAAC,EAAD,EAAK,CAAL,EAAQ,GAAR,EAAa,CAAb,CA9DS;AA+DnB,aAAS,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CA/DU;AAgEnB,aAAS,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAhEU;AAiEnB,gBAAY,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAjEO;AAkEnB,qBAAiB,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAlEE;AAmEnB,iBAAa,CAAC,GAAD,EAAM,GAAN,EAAW,CAAX,EAAc,CAAd,CAnEM;AAoEnB,oBAAgB,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CApEG;AAqEnB,iBAAa,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CArEM;AAsEnB,kBAAc,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAtEK;AAuEnB,iBAAa,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAvEM;AAwEnB,4BAAwB,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAxEL;AAyEnB,iBAAa,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAzEM;AA0EnB,kBAAc,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CA1EK;AA2EnB,iBAAa,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CA3EM;AA4EnB,iBAAa,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CA5EM;AA6EnB,mBAAe,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CA7EI;AA8EnB,qBAAiB,CAAC,EAAD,EAAK,GAAL,EAAU,GAAV,EAAe,CAAf,CA9EE;AA+EnB,oBAAgB,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CA/EG;AAgFnB,sBAAkB,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAhFC;AAiFnB,sBAAkB,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAjFC;AAkFnB,sBAAkB,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAlFC;AAmFnB,mBAAe,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAnFI;AAoFnB,YAAQ,CAAC,CAAD,EAAI,GAAJ,EAAS,CAAT,EAAY,CAAZ,CApFW;AAqFnB,iBAAa,CAAC,EAAD,EAAK,GAAL,EAAU,EAAV,EAAc,CAAd,CArFM;AAsFnB,aAAS,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAtFU;AAuFnB,eAAW,CAAC,GAAD,EAAM,CAAN,EAAS,GAAT,EAAc,CAAd,CAvFQ;AAwFnB,cAAU,CAAC,GAAD,EAAM,CAAN,EAAS,CAAT,EAAY,CAAZ,CAxFS;AAyFnB,wBAAoB,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAzFD;AA0FnB,kBAAc,CAAC,CAAD,EAAI,CAAJ,EAAO,GAAP,EAAY,CAAZ,CA1FK;AA2FnB,oBAAgB,CAAC,GAAD,EAAM,EAAN,EAAU,GAAV,EAAe,CAAf,CA3FG;AA4FnB,oBAAgB,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CA5FG;AA6FnB,sBAAkB,CAAC,EAAD,EAAK,GAAL,EAAU,GAAV,EAAe,CAAf,CA7FC;AA8FnB,uBAAmB,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CA9FA;AA+FnB,yBAAqB,CAAC,CAAD,EAAI,GAAJ,EAAS,GAAT,EAAc,CAAd,CA/FF;AAgGnB,uBAAmB,CAAC,EAAD,EAAK,GAAL,EAAU,GAAV,EAAe,CAAf,CAhGA;AAiGnB,uBAAmB,CAAC,GAAD,EAAM,EAAN,EAAU,GAAV,EAAe,CAAf,CAjGA;AAkGnB,oBAAgB,CAAC,EAAD,EAAK,EAAL,EAAS,GAAT,EAAc,CAAd,CAlGG;AAmGnB,iBAAa,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAnGM;AAoGnB,iBAAa,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CApGM;AAqGnB,gBAAY,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CArGO;AAsGnB,mBAAe,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAtGI;AAuGnB,YAAQ,CAAC,CAAD,EAAI,CAAJ,EAAO,GAAP,EAAY,CAAZ,CAvGW;AAwGnB,eAAW,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAxGQ;AAyGnB,aAAS,CAAC,GAAD,EAAM,GAAN,EAAW,CAAX,EAAc,CAAd,CAzGU;AA0GnB,iBAAa,CAAC,GAAD,EAAM,GAAN,EAAW,EAAX,EAAe,CAAf,CA1GM;AA2GnB,cAAU,CAAC,GAAD,EAAM,GAAN,EAAW,CAAX,EAAc,CAAd,CA3GS;AA4GnB,iBAAa,CAAC,GAAD,EAAM,EAAN,EAAU,CAAV,EAAa,CAAb,CA5GM;AA6GnB,cAAU,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CA7GS;AA8GnB,qBAAiB,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CA9GE;AA+GnB,iBAAa,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CA/GM;AAgHnB,qBAAiB,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAhHE;AAiHnB,qBAAiB,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAjHE;AAkHnB,kBAAc,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAlHK;AAmHnB,iBAAa,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAnHM;AAoHnB,YAAQ,CAAC,GAAD,EAAM,GAAN,EAAW,EAAX,EAAe,CAAf,CApHW;AAqHnB,YAAQ,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CArHW;AAsHnB,YAAQ,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAtHW;AAuHnB,kBAAc,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAvHK;AAwHnB,cAAU,CAAC,GAAD,EAAM,CAAN,EAAS,GAAT,EAAc,CAAd,CAxHS;AAyHnB,WAAO,CAAC,GAAD,EAAM,CAAN,EAAS,CAAT,EAAY,CAAZ,CAzHY;AA0HnB,iBAAa,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CA1HM;AA2HnB,iBAAa,CAAC,EAAD,EAAK,GAAL,EAAU,GAAV,EAAe,CAAf,CA3HM;AA4HnB,mBAAe,CAAC,GAAD,EAAM,EAAN,EAAU,EAAV,EAAc,CAAd,CA5HI;AA6HnB,cAAU,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CA7HS;AA8HnB,kBAAc,CAAC,GAAD,EAAM,GAAN,EAAW,EAAX,EAAe,CAAf,CA9HK;AA+HnB,gBAAY,CAAC,EAAD,EAAK,GAAL,EAAU,EAAV,EAAc,CAAd,CA/HO;AAgInB,gBAAY,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAhIO;AAiInB,cAAU,CAAC,GAAD,EAAM,EAAN,EAAU,EAAV,EAAc,CAAd,CAjIS;AAkInB,cAAU,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAlIS;AAmInB,eAAW,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAnIQ;AAoInB,iBAAa,CAAC,GAAD,EAAM,EAAN,EAAU,GAAV,EAAe,CAAf,CApIM;AAqInB,iBAAa,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CArIM;AAsInB,iBAAa,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAtIM;AAuInB,YAAQ,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAvIW;AAwInB,mBAAe,CAAC,CAAD,EAAI,GAAJ,EAAS,GAAT,EAAc,CAAd,CAxII;AAyInB,iBAAa,CAAC,EAAD,EAAK,GAAL,EAAU,GAAV,EAAe,CAAf,CAzIM;AA0InB,WAAO,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CA1IY;AA2InB,YAAQ,CAAC,CAAD,EAAI,GAAJ,EAAS,GAAT,EAAc,CAAd,CA3IW;AA4InB,eAAW,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CA5IQ;AA6InB,cAAU,CAAC,GAAD,EAAM,EAAN,EAAU,EAAV,EAAc,CAAd,CA7IS;AA8InB,iBAAa,CAAC,EAAD,EAAK,GAAL,EAAU,GAAV,EAAe,CAAf,CA9IM;AA+InB,cAAU,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CA/IS;AAgJnB,aAAS,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAhJU;AAiJnB,aAAS,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAjJU;AAkJnB,kBAAc,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAlJK;AAmJnB,cAAU,CAAC,GAAD,EAAM,GAAN,EAAW,CAAX,EAAc,CAAd,CAnJS;AAoJnB,mBAAe,CAAC,GAAD,EAAM,GAAN,EAAW,EAAX,EAAe,CAAf;AApJI,GAArB;;AAuJA,WAASC,YAAT,CAAsB1Y,CAAtB,EAAyB;AACvB;AACAA,QAAI8G,KAAK6R,KAAL,CAAW3Y,CAAX,CAAJ,CAFuB,CAEJ;;AAEnB,WAAOA,IAAI,CAAJ,GAAQ,CAAR,GAAYA,IAAI,GAAJ,GAAU,GAAV,GAAgBA,CAAnC;AACD;;AAED,WAAS4Y,aAAT,CAAuB5Y,CAAvB,EAA0B;AACxB;AACAA,QAAI8G,KAAK6R,KAAL,CAAW3Y,CAAX,CAAJ,CAFwB,CAEL;;AAEnB,WAAOA,IAAI,CAAJ,GAAQ,CAAR,GAAYA,IAAI,GAAJ,GAAU,GAAV,GAAgBA,CAAnC;AACD;;AAED,WAAS6Y,aAAT,CAAuBC,CAAvB,EAA0B;AACxB;AACA,WAAOA,IAAI,CAAJ,GAAQ,CAAR,GAAYA,IAAI,CAAJ,GAAQ,CAAR,GAAYA,CAA/B;AACD;;AAED,WAASC,WAAT,CAAqBvU,GAArB,EAA0B;AACxB;AACA,QAAIA,IAAItE,MAAJ,IAAcsE,IAAIwU,MAAJ,CAAWxU,IAAItE,MAAJ,GAAa,CAAxB,MAA+B,GAAjD,EAAsD;AACpD,aAAOwY,aAAaO,WAAWzU,GAAX,IAAkB,GAAlB,GAAwB,GAArC,CAAP;AACD;;AAED,WAAOkU,aAAaQ,SAAS1U,GAAT,EAAc,EAAd,CAAb,CAAP;AACD;;AAED,WAAS2U,aAAT,CAAuB3U,GAAvB,EAA4B;AAC1B;AACA,QAAIA,IAAItE,MAAJ,IAAcsE,IAAIwU,MAAJ,CAAWxU,IAAItE,MAAJ,GAAa,CAAxB,MAA+B,GAAjD,EAAsD;AACpD,aAAO2Y,cAAcI,WAAWzU,GAAX,IAAkB,GAAhC,CAAP;AACD;;AAED,WAAOqU,cAAcI,WAAWzU,GAAX,CAAd,CAAP;AACD;;AAED,WAAS4U,WAAT,CAAqB7J,EAArB,EAAyBC,EAAzB,EAA6BpF,CAA7B,EAAgC;AAC9B,QAAIA,IAAI,CAAR,EAAW;AACTA,WAAK,CAAL;AACD,KAFD,MAEO,IAAIA,IAAI,CAAR,EAAW;AAChBA,WAAK,CAAL;AACD;;AAED,QAAIA,IAAI,CAAJ,GAAQ,CAAZ,EAAe;AACb,aAAOmF,KAAK,CAACC,KAAKD,EAAN,IAAYnF,CAAZ,GAAgB,CAA5B;AACD;;AAED,QAAIA,IAAI,CAAJ,GAAQ,CAAZ,EAAe;AACb,aAAOoF,EAAP;AACD;;AAED,QAAIpF,IAAI,CAAJ,GAAQ,CAAZ,EAAe;AACb,aAAOmF,KAAK,CAACC,KAAKD,EAAN,KAAa,IAAI,CAAJ,GAAQnF,CAArB,IAA0B,CAAtC;AACD;;AAED,WAAOmF,EAAP;AACD;;AAED,WAAS8J,UAAT,CAAoB/T,CAApB,EAAuBC,CAAvB,EAA0BkP,CAA1B,EAA6B;AAC3B,WAAOnP,IAAI,CAACC,IAAID,CAAL,IAAUmP,CAArB;AACD;;AAED,WAAS6E,OAAT,CAAiBjT,GAAjB,EAAsBkT,CAAtB,EAAyBC,CAAzB,EAA4BjU,CAA5B,EAA+BD,CAA/B,EAAkC;AAChCe,QAAI,CAAJ,IAASkT,CAAT;AACAlT,QAAI,CAAJ,IAASmT,CAAT;AACAnT,QAAI,CAAJ,IAASd,CAAT;AACAc,QAAI,CAAJ,IAASf,CAAT;AACA,WAAOe,GAAP;AACD;;AAED,WAASoT,QAAT,CAAkBpT,GAAlB,EAAuBf,CAAvB,EAA0B;AACxBe,QAAI,CAAJ,IAASf,EAAE,CAAF,CAAT;AACAe,QAAI,CAAJ,IAASf,EAAE,CAAF,CAAT;AACAe,QAAI,CAAJ,IAASf,EAAE,CAAF,CAAT;AACAe,QAAI,CAAJ,IAASf,EAAE,CAAF,CAAT;AACA,WAAOe,GAAP;AACD;;AAED,MAAIqT,aAAa,IAAI3B,GAAJ,CAAQ,EAAR,CAAjB;AACA,MAAI4B,iBAAiB,IAArB;;AAEA,WAASC,UAAT,CAAoBC,QAApB,EAA8BC,OAA9B,EAAuC;AACrC;AACA,QAAIH,cAAJ,EAAoB;AAClBF,eAASE,cAAT,EAAyBG,OAAzB;AACD;;AAEDH,qBAAiBD,WAAWpB,GAAX,CAAeuB,QAAf,EAAyBF,kBAAkBG,QAAQ9a,KAAR,EAA3C,CAAjB;AACD;AACD;;;;;;;AAQA,WAAS+a,KAAT,CAAeF,QAAf,EAAyBC,OAAzB,EAAkC;AAChC,QAAI,CAACD,QAAL,EAAe;AACb;AACD;;AAEDC,cAAUA,WAAW,EAArB;AACA,QAAIE,SAASN,WAAWxU,GAAX,CAAe2U,QAAf,CAAb;;AAEA,QAAIG,MAAJ,EAAY;AACV,aAAOP,SAASK,OAAT,EAAkBE,MAAlB,CAAP;AACD,KAV+B,CAU9B;;;AAGFH,eAAWA,WAAW,EAAtB,CAbgC,CAaN;;AAE1B,QAAIrV,MAAMqV,SAASpV,OAAT,CAAiB,IAAjB,EAAuB,EAAvB,EAA2BwV,WAA3B,EAAV,CAfgC,CAeoB;;AAEpD,QAAIzV,OAAOiU,cAAX,EAA2B;AACzBgB,eAASK,OAAT,EAAkBrB,eAAejU,GAAf,CAAlB;AACAoV,iBAAWC,QAAX,EAAqBC,OAArB;AACA,aAAOA,OAAP;AACD,KArB+B,CAqB9B;;;AAGF,QAAItV,IAAIwU,MAAJ,CAAW,CAAX,MAAkB,GAAtB,EAA2B;AACzB,UAAIxU,IAAItE,MAAJ,KAAe,CAAnB,EAAsB;AACpB,YAAIga,KAAKhB,SAAS1U,IAAI2V,MAAJ,CAAW,CAAX,CAAT,EAAwB,EAAxB,CAAT,CADoB,CACkB;;AAEtC,YAAI,EAAED,MAAM,CAAN,IAAWA,MAAM,KAAnB,CAAJ,EAA+B;AAC7BZ,kBAAQQ,OAAR,EAAiB,CAAjB,EAAoB,CAApB,EAAuB,CAAvB,EAA0B,CAA1B;AACA,iBAF6B,CAErB;AACT;;AAEDR,gBAAQQ,OAAR,EAAiB,CAACI,KAAK,KAAN,KAAgB,CAAhB,GAAoB,CAACA,KAAK,KAAN,KAAgB,CAArD,EAAwDA,KAAK,IAAL,GAAY,CAACA,KAAK,IAAN,KAAe,CAAnF,EAAsFA,KAAK,GAAL,GAAW,CAACA,KAAK,GAAN,KAAc,CAA/G,EAAkH,CAAlH;AACAN,mBAAWC,QAAX,EAAqBC,OAArB;AACA,eAAOA,OAAP;AACD,OAXD,MAWO,IAAItV,IAAItE,MAAJ,KAAe,CAAnB,EAAsB;AAC3B,YAAIga,KAAKhB,SAAS1U,IAAI2V,MAAJ,CAAW,CAAX,CAAT,EAAwB,EAAxB,CAAT,CAD2B,CACW;;AAEtC,YAAI,EAAED,MAAM,CAAN,IAAWA,MAAM,QAAnB,CAAJ,EAAkC;AAChCZ,kBAAQQ,OAAR,EAAiB,CAAjB,EAAoB,CAApB,EAAuB,CAAvB,EAA0B,CAA1B;AACA,iBAFgC,CAExB;AACT;;AAEDR,gBAAQQ,OAAR,EAAiB,CAACI,KAAK,QAAN,KAAmB,EAApC,EAAwC,CAACA,KAAK,MAAN,KAAiB,CAAzD,EAA4DA,KAAK,IAAjE,EAAuE,CAAvE;AACAN,mBAAWC,QAAX,EAAqBC,OAArB;AACA,eAAOA,OAAP;AACD;;AAED;AACD;;AAED,QAAIM,KAAK5V,IAAIjD,OAAJ,CAAY,GAAZ,CAAT;AAAA,QACI8Y,KAAK7V,IAAIjD,OAAJ,CAAY,GAAZ,CADT;;AAGA,QAAI6Y,OAAO,CAAC,CAAR,IAAaC,KAAK,CAAL,KAAW7V,IAAItE,MAAhC,EAAwC;AACtC,UAAIoa,QAAQ9V,IAAI2V,MAAJ,CAAW,CAAX,EAAcC,EAAd,CAAZ;AACA,UAAIG,SAAS/V,IAAI2V,MAAJ,CAAWC,KAAK,CAAhB,EAAmBC,MAAMD,KAAK,CAAX,CAAnB,EAAkCI,KAAlC,CAAwC,GAAxC,CAAb;AACA,UAAIC,QAAQ,CAAZ,CAHsC,CAGvB;;AAEf,cAAQH,KAAR;AACE,aAAK,MAAL;AACE,cAAIC,OAAOra,MAAP,KAAkB,CAAtB,EAAyB;AACvBoZ,oBAAQQ,OAAR,EAAiB,CAAjB,EAAoB,CAApB,EAAuB,CAAvB,EAA0B,CAA1B;AACA;AACD;;AAEDW,kBAAQtB,cAAcoB,OAAOG,GAAP,EAAd,CAAR;AACF;AACA;;AAEA,aAAK,KAAL;AACE,cAAIH,OAAOra,MAAP,KAAkB,CAAtB,EAAyB;AACvBoZ,oBAAQQ,OAAR,EAAiB,CAAjB,EAAoB,CAApB,EAAuB,CAAvB,EAA0B,CAA1B;AACA;AACD;;AAEDR,kBAAQQ,OAAR,EAAiBf,YAAYwB,OAAO,CAAP,CAAZ,CAAjB,EAAyCxB,YAAYwB,OAAO,CAAP,CAAZ,CAAzC,EAAiExB,YAAYwB,OAAO,CAAP,CAAZ,CAAjE,EAAyFE,KAAzF;AACAb,qBAAWC,QAAX,EAAqBC,OAArB;AACA,iBAAOA,OAAP;;AAEF,aAAK,MAAL;AACE,cAAIS,OAAOra,MAAP,KAAkB,CAAtB,EAAyB;AACvBoZ,oBAAQQ,OAAR,EAAiB,CAAjB,EAAoB,CAApB,EAAuB,CAAvB,EAA0B,CAA1B;AACA;AACD;;AAEDS,iBAAO,CAAP,IAAYpB,cAAcoB,OAAO,CAAP,CAAd,CAAZ;AACAI,oBAAUJ,MAAV,EAAkBT,OAAlB;AACAF,qBAAWC,QAAX,EAAqBC,OAArB;AACA,iBAAOA,OAAP;;AAEF,aAAK,KAAL;AACE,cAAIS,OAAOra,MAAP,KAAkB,CAAtB,EAAyB;AACvBoZ,oBAAQQ,OAAR,EAAiB,CAAjB,EAAoB,CAApB,EAAuB,CAAvB,EAA0B,CAA1B;AACA;AACD;;AAEDa,oBAAUJ,MAAV,EAAkBT,OAAlB;AACAF,qBAAWC,QAAX,EAAqBC,OAArB;AACA,iBAAOA,OAAP;;AAEF;AACE;AA3CJ;AA6CD;;AAEDR,YAAQQ,OAAR,EAAiB,CAAjB,EAAoB,CAApB,EAAuB,CAAvB,EAA0B,CAA1B;AACA;AACD;AACD;;;;;;AAMA,WAASa,SAAT,CAAmBC,IAAnB,EAAyBC,IAAzB,EAA+B;AAC7B,QAAIzQ,IAAI,CAAC6O,WAAW2B,KAAK,CAAL,CAAX,IAAsB,GAAtB,GAA4B,GAA7B,IAAoC,GAApC,GAA0C,GAAlD,CAD6B,CAC0B;AACvD;AACA;;AAEA,QAAItT,IAAI6R,cAAcyB,KAAK,CAAL,CAAd,CAAR;AACA,QAAInQ,IAAI0O,cAAcyB,KAAK,CAAL,CAAd,CAAR;AACA,QAAIpL,KAAK/E,KAAK,GAAL,GAAWA,KAAKnD,IAAI,CAAT,CAAX,GAAyBmD,IAAInD,CAAJ,GAAQmD,IAAInD,CAA9C;AACA,QAAIiI,KAAK9E,IAAI,CAAJ,GAAQ+E,EAAjB;AACAqL,WAAOA,QAAQ,EAAf;AACAvB,YAAQuB,IAAR,EAAcnC,aAAaU,YAAY7J,EAAZ,EAAgBC,EAAhB,EAAoBpF,IAAI,IAAI,CAA5B,IAAiC,GAA9C,CAAd,EAAkEsO,aAAaU,YAAY7J,EAAZ,EAAgBC,EAAhB,EAAoBpF,CAApB,IAAyB,GAAtC,CAAlE,EAA8GsO,aAAaU,YAAY7J,EAAZ,EAAgBC,EAAhB,EAAoBpF,IAAI,IAAI,CAA5B,IAAiC,GAA9C,CAA9G,EAAkK,CAAlK;;AAEA,QAAIwQ,KAAK1a,MAAL,KAAgB,CAApB,EAAuB;AACrB2a,WAAK,CAAL,IAAUD,KAAK,CAAL,CAAV;AACD;;AAED,WAAOC,IAAP;AACD;AACD;;;;;AAMA,WAASC,SAAT,CAAmBD,IAAnB,EAAyB;AACvB,QAAI,CAACA,IAAL,EAAW;AACT;AACD,KAHsB,CAGrB;;;AAGF,QAAIE,IAAIF,KAAK,CAAL,IAAU,GAAlB;AACA,QAAIG,IAAIH,KAAK,CAAL,IAAU,GAAlB;AACA,QAAII,IAAIJ,KAAK,CAAL,IAAU,GAAlB;AACA,QAAIK,OAAOpU,KAAKoB,GAAL,CAAS6S,CAAT,EAAYC,CAAZ,EAAeC,CAAf,CAAX,CATuB,CASO;;AAE9B,QAAIE,OAAOrU,KAAKqB,GAAL,CAAS4S,CAAT,EAAYC,CAAZ,EAAeC,CAAf,CAAX,CAXuB,CAWO;;AAE9B,QAAIG,QAAQD,OAAOD,IAAnB,CAbuB,CAaE;;AAEzB,QAAIG,IAAI,CAACF,OAAOD,IAAR,IAAgB,CAAxB;AACA,QAAII,CAAJ;AACA,QAAIC,CAAJ,CAjBuB,CAiBhB;;AAEP,QAAIH,UAAU,CAAd,EAAiB;AACfE,UAAI,CAAJ;AACAC,UAAI,CAAJ;AACD,KAHD,MAGO;AACL,UAAIF,IAAI,GAAR,EAAa;AACXE,YAAIH,SAASD,OAAOD,IAAhB,CAAJ;AACD,OAFD,MAEO;AACLK,YAAIH,SAAS,IAAID,IAAJ,GAAWD,IAApB,CAAJ;AACD;;AAED,UAAIM,SAAS,CAAC,CAACL,OAAOJ,CAAR,IAAa,CAAb,GAAiBK,QAAQ,CAA1B,IAA+BA,KAA5C;AACA,UAAIK,SAAS,CAAC,CAACN,OAAOH,CAAR,IAAa,CAAb,GAAiBI,QAAQ,CAA1B,IAA+BA,KAA5C;AACA,UAAIM,SAAS,CAAC,CAACP,OAAOF,CAAR,IAAa,CAAb,GAAiBG,QAAQ,CAA1B,IAA+BA,KAA5C;;AAEA,UAAIL,MAAMI,IAAV,EAAgB;AACdG,YAAII,SAASD,MAAb;AACD,OAFD,MAEO,IAAIT,MAAMG,IAAV,EAAgB;AACrBG,YAAI,IAAI,CAAJ,GAAQE,MAAR,GAAiBE,MAArB;AACD,OAFM,MAEA,IAAIT,MAAME,IAAV,EAAgB;AACrBG,YAAI,IAAI,CAAJ,GAAQG,MAAR,GAAiBD,MAArB;AACD;;AAED,UAAIF,IAAI,CAAR,EAAW;AACTA,aAAK,CAAL;AACD;;AAED,UAAIA,IAAI,CAAR,EAAW;AACTA,aAAK,CAAL;AACD;AACF;;AAED,QAAIV,OAAO,CAACU,IAAI,GAAL,EAAUC,CAAV,EAAaF,CAAb,CAAX;;AAEA,QAAIR,KAAK,CAAL,KAAW,IAAf,EAAqB;AACnBD,WAAKpY,IAAL,CAAUqY,KAAK,CAAL,CAAV;AACD;;AAED,WAAOD,IAAP;AACD;AACD;;;;;;;AAQA,WAASe,IAAT,CAAcC,KAAd,EAAqBC,KAArB,EAA4B;AAC1B,QAAIC,WAAW/B,MAAM6B,KAAN,CAAf;;AAEA,QAAIE,QAAJ,EAAc;AACZ,WAAK,IAAI9b,IAAI,CAAb,EAAgBA,IAAI,CAApB,EAAuBA,GAAvB,EAA4B;AAC1B,YAAI6b,QAAQ,CAAZ,EAAe;AACbC,mBAAS9b,CAAT,IAAc8b,SAAS9b,CAAT,KAAe,IAAI6b,KAAnB,IAA4B,CAA1C;AACD,SAFD,MAEO;AACLC,mBAAS9b,CAAT,IAAc,CAAC,MAAM8b,SAAS9b,CAAT,CAAP,IAAsB6b,KAAtB,GAA8BC,SAAS9b,CAAT,CAA9B,GAA4C,CAA1D;AACD;;AAED,YAAI8b,SAAS9b,CAAT,IAAc,GAAlB,EAAuB;AACrB8b,mBAAS9b,CAAT,IAAc,GAAd;AACD,SAFD,MAEO,IAAI4b,MAAM5b,CAAN,IAAW,CAAf,EAAkB;AACvB8b,mBAAS9b,CAAT,IAAc,CAAd;AACD;AACF;;AAED,aAAO+b,UAAUD,QAAV,EAAoBA,SAAS5b,MAAT,KAAoB,CAApB,GAAwB,MAAxB,GAAiC,KAArD,CAAP;AACD;AACF;AACD;;;;;;AAMA,WAAS8b,KAAT,CAAeJ,KAAf,EAAsB;AACpB,QAAIE,WAAW/B,MAAM6B,KAAN,CAAf;;AAEA,QAAIE,QAAJ,EAAc;AACZ,aAAO,CAAC,CAAC,KAAK,EAAN,KAAaA,SAAS,CAAT,KAAe,EAA5B,KAAmCA,SAAS,CAAT,KAAe,CAAlD,IAAuD,CAACA,SAAS,CAAT,CAAzD,EAAsEtd,QAAtE,CAA+E,EAA/E,EAAmFQ,KAAnF,CAAyF,CAAzF,CAAP;AACD;AACF;AACD;;;;;;;;AAQA,WAASid,QAAT,CAAkBC,eAAlB,EAAmCC,MAAnC,EAA2C9V,GAA3C,EAAgD;AAC9C,QAAI,EAAE8V,UAAUA,OAAOjc,MAAnB,KAA8B,EAAEgc,mBAAmB,CAAnB,IAAwBA,mBAAmB,CAA7C,CAAlC,EAAmF;AACjF;AACD;;AAED7V,UAAMA,OAAO,EAAb;AACA,QAAI5E,QAAQya,mBAAmBC,OAAOjc,MAAP,GAAgB,CAAnC,CAAZ;AACA,QAAIkc,YAAYtV,KAAKuV,KAAL,CAAW5a,KAAX,CAAhB;AACA,QAAI6a,aAAaxV,KAAKyV,IAAL,CAAU9a,KAAV,CAAjB;AACA,QAAI+a,YAAYL,OAAOC,SAAP,CAAhB;AACA,QAAIK,aAAaN,OAAOG,UAAP,CAAjB;AACA,QAAII,KAAKjb,QAAQ2a,SAAjB;AACA/V,QAAI,CAAJ,IAASqS,aAAaW,WAAWmD,UAAU,CAAV,CAAX,EAAyBC,WAAW,CAAX,CAAzB,EAAwCC,EAAxC,CAAb,CAAT;AACArW,QAAI,CAAJ,IAASqS,aAAaW,WAAWmD,UAAU,CAAV,CAAX,EAAyBC,WAAW,CAAX,CAAzB,EAAwCC,EAAxC,CAAb,CAAT;AACArW,QAAI,CAAJ,IAASqS,aAAaW,WAAWmD,UAAU,CAAV,CAAX,EAAyBC,WAAW,CAAX,CAAzB,EAAwCC,EAAxC,CAAb,CAAT;AACArW,QAAI,CAAJ,IAASwS,cAAcQ,WAAWmD,UAAU,CAAV,CAAX,EAAyBC,WAAW,CAAX,CAAzB,EAAwCC,EAAxC,CAAd,CAAT;AACA,WAAOrW,GAAP;AACD;AACD;;;;AAIA,MAAIsW,iBAAiBV,QAArB;AACA;;;;;;;;;AASA,WAASW,MAAT,CAAgBV,eAAhB,EAAiCC,MAAjC,EAAyCU,UAAzC,EAAqD;AACnD,QAAI,EAAEV,UAAUA,OAAOjc,MAAnB,KAA8B,EAAEgc,mBAAmB,CAAnB,IAAwBA,mBAAmB,CAA7C,CAAlC,EAAmF;AACjF;AACD;;AAED,QAAIza,QAAQya,mBAAmBC,OAAOjc,MAAP,GAAgB,CAAnC,CAAZ;AACA,QAAIkc,YAAYtV,KAAKuV,KAAL,CAAW5a,KAAX,CAAhB;AACA,QAAI6a,aAAaxV,KAAKyV,IAAL,CAAU9a,KAAV,CAAjB;AACA,QAAI+a,YAAYzC,MAAMoC,OAAOC,SAAP,CAAN,CAAhB;AACA,QAAIK,aAAa1C,MAAMoC,OAAOG,UAAP,CAAN,CAAjB;AACA,QAAII,KAAKjb,QAAQ2a,SAAjB;AACA,QAAIR,QAAQG,UAAU,CAACrD,aAAaW,WAAWmD,UAAU,CAAV,CAAX,EAAyBC,WAAW,CAAX,CAAzB,EAAwCC,EAAxC,CAAb,CAAD,EAA4DhE,aAAaW,WAAWmD,UAAU,CAAV,CAAX,EAAyBC,WAAW,CAAX,CAAzB,EAAwCC,EAAxC,CAAb,CAA5D,EAAuHhE,aAAaW,WAAWmD,UAAU,CAAV,CAAX,EAAyBC,WAAW,CAAX,CAAzB,EAAwCC,EAAxC,CAAb,CAAvH,EAAkL7D,cAAcQ,WAAWmD,UAAU,CAAV,CAAX,EAAyBC,WAAW,CAAX,CAAzB,EAAwCC,EAAxC,CAAd,CAAlL,CAAV,EAAyP,MAAzP,CAAZ;AACA,WAAOG,aAAa;AAClBjB,aAAOA,KADW;AAElBQ,iBAAWA,SAFO;AAGlBE,kBAAYA,UAHM;AAIlB7a,aAAOA;AAJW,KAAb,GAKHma,KALJ;AAMD;AACD;;;;AAIA,MAAIkB,aAAaF,MAAjB;AACA;;;;;;;;;AASA,WAASG,SAAT,CAAmBnB,KAAnB,EAA0BxR,CAA1B,EAA6B9C,CAA7B,EAAgCmD,CAAhC,EAAmC;AACjCmR,YAAQ7B,MAAM6B,KAAN,CAAR;;AAEA,QAAIA,KAAJ,EAAW;AACTA,cAAQd,UAAUc,KAAV,CAAR;AACAxR,WAAK,IAAL,KAAcwR,MAAM,CAAN,IAAWhD,cAAcxO,CAAd,CAAzB;AACA9C,WAAK,IAAL,KAAcsU,MAAM,CAAN,IAAWzC,cAAc7R,CAAd,CAAzB;AACAmD,WAAK,IAAL,KAAcmR,MAAM,CAAN,IAAWzC,cAAc1O,CAAd,CAAzB;AACA,aAAOsR,UAAUpB,UAAUiB,KAAV,CAAV,EAA4B,MAA5B,CAAP;AACD;AACF;AACD;;;;;;;AAOA,WAASoB,WAAT,CAAqBpB,KAArB,EAA4BnB,KAA5B,EAAmC;AACjCmB,YAAQ7B,MAAM6B,KAAN,CAAR;;AAEA,QAAIA,SAASnB,SAAS,IAAtB,EAA4B;AAC1BmB,YAAM,CAAN,IAAW/C,cAAc4B,KAAd,CAAX;AACA,aAAOsB,UAAUH,KAAV,EAAiB,MAAjB,CAAP;AACD;AACF;AACD;;;;;;AAMA,WAASG,SAAT,CAAmBkB,QAAnB,EAA6B7Z,IAA7B,EAAmC;AACjC,QAAI,CAAC6Z,QAAD,IAAa,CAACA,SAAS/c,MAA3B,EAAmC;AACjC;AACD;;AAED,QAAI2Z,WAAWoD,SAAS,CAAT,IAAc,GAAd,GAAoBA,SAAS,CAAT,CAApB,GAAkC,GAAlC,GAAwCA,SAAS,CAAT,CAAvD;;AAEA,QAAI7Z,SAAS,MAAT,IAAmBA,SAAS,MAA5B,IAAsCA,SAAS,MAAnD,EAA2D;AACzDyW,kBAAY,MAAMoD,SAAS,CAAT,CAAlB;AACD;;AAED,WAAO7Z,OAAO,GAAP,GAAayW,QAAb,GAAwB,GAA/B;AACD;;AAED,MAAI+B,QAAQ,CAACtd,OAAOsH,MAAP,IAAiBtH,MAAlB,EAA0B;AACrCyb,WAAOA,KAD8B;AAErC4B,UAAMA,IAF+B;AAGrCK,WAAOA,KAH8B;AAIrCC,cAAUA,QAJ2B;AAKrCU,oBAAgBA,cALqB;AAMrC7U,UAAM8U,MAN+B;AAOrCE,gBAAYA,UAPyB;AAQrCC,eAAWA,SAR0B;AASrCC,iBAAaA,WATwB;AAUrCjB,eAAWA;AAV0B,GAA1B,CAAZ;;AAaA;;;AAGA,MAAImB,aAAaxe,MAAMH,SAAN,CAAgBS,KAAjC;;AAEA,WAASme,aAAT,CAAuBzc,MAAvB,EAA+BH,GAA/B,EAAoC;AAClC,WAAOG,OAAOH,GAAP,CAAP;AACD;;AAED,WAAS6c,aAAT,CAAuB1c,MAAvB,EAA+BH,GAA/B,EAAoCkB,KAApC,EAA2C;AACzCf,WAAOH,GAAP,IAAckB,KAAd;AACD;AACD;;;;;;;AAQA,WAAS4b,iBAAT,CAA2BC,EAA3B,EAA+BC,EAA/B,EAAmCjH,OAAnC,EAA4C;AAC1C,WAAO,CAACiH,KAAKD,EAAN,IAAYhH,OAAZ,GAAsBgH,EAA7B;AACD;AACD;;;;;;;AAQA,WAASE,iBAAT,CAA2BF,EAA3B,EAA+BC,EAA/B,EAAmCjH,OAAnC,EAA4C;AAC1C,WAAOA,UAAU,GAAV,GAAgBiH,EAAhB,GAAqBD,EAA5B;AACD;AACD;;;;;;;;AASA,WAASG,gBAAT,CAA0BH,EAA1B,EAA8BC,EAA9B,EAAkCjH,OAAlC,EAA2CjQ,GAA3C,EAAgDqX,MAAhD,EAAwD;AACtD,QAAIzd,MAAMqd,GAAGpd,MAAb;;AAEA,QAAIwd,UAAU,CAAd,EAAiB;AACf,WAAK,IAAI1d,IAAI,CAAb,EAAgBA,IAAIC,GAApB,EAAyBD,GAAzB,EAA8B;AAC5BqG,YAAIrG,CAAJ,IAASqd,kBAAkBC,GAAGtd,CAAH,CAAlB,EAAyBud,GAAGvd,CAAH,CAAzB,EAAgCsW,OAAhC,CAAT;AACD;AACF,KAJD,MAIO;AACL,UAAIqH,OAAO1d,OAAOqd,GAAG,CAAH,EAAMpd,MAAxB;;AAEA,WAAK,IAAIF,IAAI,CAAb,EAAgBA,IAAIC,GAApB,EAAyBD,GAAzB,EAA8B;AAC5B,aAAK,IAAI4d,IAAI,CAAb,EAAgBA,IAAID,IAApB,EAA0BC,GAA1B,EAA+B;AAC7BvX,cAAIrG,CAAJ,EAAO4d,CAAP,IAAYP,kBAAkBC,GAAGtd,CAAH,EAAM4d,CAAN,CAAlB,EAA4BL,GAAGvd,CAAH,EAAM4d,CAAN,CAA5B,EAAsCtH,OAAtC,CAAZ;AACD;AACF;AACF;AACF,GA/iH2B,CA+iH1B;AACF;;;AAGA,WAASuH,OAAT,CAAiBC,IAAjB,EAAuBC,IAAvB,EAA6BL,MAA7B,EAAqC;AACnC,QAAIM,UAAUF,KAAK5d,MAAnB;AACA,QAAI+d,UAAUF,KAAK7d,MAAnB;;AAEA,QAAI8d,YAAYC,OAAhB,EAAyB;AACvB;AACA,UAAIC,mBAAmBF,UAAUC,OAAjC;;AAEA,UAAIC,gBAAJ,EAAsB;AACpB;AACAJ,aAAK5d,MAAL,GAAc+d,OAAd;AACD,OAHD,MAGO;AACL;AACA,aAAK,IAAIje,IAAIge,OAAb,EAAsBhe,IAAIie,OAA1B,EAAmCje,GAAnC,EAAwC;AACtC8d,eAAKtb,IAAL,CAAUkb,WAAW,CAAX,GAAeK,KAAK/d,CAAL,CAAf,GAAyBkd,WAAWpd,IAAX,CAAgBie,KAAK/d,CAAL,CAAhB,CAAnC;AACD;AACF;AACF,KAjBkC,CAiBjC;;;AAGF,QAAI2d,OAAOG,KAAK,CAAL,KAAWA,KAAK,CAAL,EAAQ5d,MAA9B;;AAEA,SAAK,IAAIF,IAAI,CAAb,EAAgBA,IAAI8d,KAAK5d,MAAzB,EAAiCF,GAAjC,EAAsC;AACpC,UAAI0d,WAAW,CAAf,EAAkB;AAChB,YAAIS,MAAML,KAAK9d,CAAL,CAAN,CAAJ,EAAoB;AAClB8d,eAAK9d,CAAL,IAAU+d,KAAK/d,CAAL,CAAV;AACD;AACF,OAJD,MAIO;AACL,aAAK,IAAI4d,IAAI,CAAb,EAAgBA,IAAID,IAApB,EAA0BC,GAA1B,EAA+B;AAC7B,cAAIO,MAAML,KAAK9d,CAAL,EAAQ4d,CAAR,CAAN,CAAJ,EAAuB;AACrBE,iBAAK9d,CAAL,EAAQ4d,CAAR,IAAaG,KAAK/d,CAAL,EAAQ4d,CAAR,CAAb;AACD;AACF;AACF;AACF;AACF;AACD;;;;;;;AAQA,WAASQ,WAAT,CAAqBN,IAArB,EAA2BC,IAA3B,EAAiCL,MAAjC,EAAyC;AACvC,QAAII,SAASC,IAAb,EAAmB;AACjB,aAAO,IAAP;AACD;;AAED,QAAI9d,MAAM6d,KAAK5d,MAAf;;AAEA,QAAID,QAAQ8d,KAAK7d,MAAjB,EAAyB;AACvB,aAAO,KAAP;AACD;;AAED,QAAIwd,WAAW,CAAf,EAAkB;AAChB,WAAK,IAAI1d,IAAI,CAAb,EAAgBA,IAAIC,GAApB,EAAyBD,GAAzB,EAA8B;AAC5B,YAAI8d,KAAK9d,CAAL,MAAY+d,KAAK/d,CAAL,CAAhB,EAAyB;AACvB,iBAAO,KAAP;AACD;AACF;AACF,KAND,MAMO;AACL,UAAI2d,OAAOG,KAAK,CAAL,EAAQ5d,MAAnB;;AAEA,WAAK,IAAIF,IAAI,CAAb,EAAgBA,IAAIC,GAApB,EAAyBD,GAAzB,EAA8B;AAC5B,aAAK,IAAI4d,IAAI,CAAb,EAAgBA,IAAID,IAApB,EAA0BC,GAA1B,EAA+B;AAC7B,cAAIE,KAAK9d,CAAL,EAAQ4d,CAAR,MAAeG,KAAK/d,CAAL,EAAQ4d,CAAR,CAAnB,EAA+B;AAC7B,mBAAO,KAAP;AACD;AACF;AACF;AACF;;AAED,WAAO,IAAP;AACD;AACD;;;;;;;;;;;;;AAcA,WAASS,0BAAT,CAAoCf,EAApC,EAAwCC,EAAxC,EAA4Ce,EAA5C,EAAgDC,EAAhD,EAAoDxW,CAApD,EAAuDyW,EAAvD,EAA2DC,EAA3D,EAA+DpY,GAA/D,EAAoEqX,MAApE,EAA4E;AAC1E,QAAIzd,MAAMqd,GAAGpd,MAAb;;AAEA,QAAIwd,UAAU,CAAd,EAAiB;AACf,WAAK,IAAI1d,IAAI,CAAb,EAAgBA,IAAIC,GAApB,EAAyBD,GAAzB,EAA8B;AAC5BqG,YAAIrG,CAAJ,IAAS0e,sBAAsBpB,GAAGtd,CAAH,CAAtB,EAA6Bud,GAAGvd,CAAH,CAA7B,EAAoCse,GAAGte,CAAH,CAApC,EAA2Cue,GAAGve,CAAH,CAA3C,EAAkD+H,CAAlD,EAAqDyW,EAArD,EAAyDC,EAAzD,CAAT;AACD;AACF,KAJD,MAIO;AACL,UAAId,OAAOL,GAAG,CAAH,EAAMpd,MAAjB;;AAEA,WAAK,IAAIF,IAAI,CAAb,EAAgBA,IAAIC,GAApB,EAAyBD,GAAzB,EAA8B;AAC5B,aAAK,IAAI4d,IAAI,CAAb,EAAgBA,IAAID,IAApB,EAA0BC,GAA1B,EAA+B;AAC7BvX,cAAIrG,CAAJ,EAAO4d,CAAP,IAAYc,sBAAsBpB,GAAGtd,CAAH,EAAM4d,CAAN,CAAtB,EAAgCL,GAAGvd,CAAH,EAAM4d,CAAN,CAAhC,EAA0CU,GAAGte,CAAH,EAAM4d,CAAN,CAA1C,EAAoDW,GAAGve,CAAH,EAAM4d,CAAN,CAApD,EAA8D7V,CAA9D,EAAiEyW,EAAjE,EAAqEC,EAArE,CAAZ;AACD;AACF;AACF;AACF;AACD;;;;;;;;;;;;AAaA,WAASC,qBAAT,CAA+BpB,EAA/B,EAAmCC,EAAnC,EAAuCe,EAAvC,EAA2CC,EAA3C,EAA+CxW,CAA/C,EAAkDyW,EAAlD,EAAsDC,EAAtD,EAA0D;AACxD,QAAIE,KAAK,CAACL,KAAKhB,EAAN,IAAY,GAArB;AACA,QAAI5W,KAAK,CAAC6X,KAAKhB,EAAN,IAAY,GAArB;AACA,WAAO,CAAC,KAAKA,KAAKe,EAAV,IAAgBK,EAAhB,GAAqBjY,EAAtB,IAA4B+X,EAA5B,GAAiC,CAAC,CAAC,CAAD,IAAMlB,KAAKe,EAAX,IAAiB,IAAIK,EAArB,GAA0BjY,EAA3B,IAAiC8X,EAAlE,GAAuEG,KAAK5W,CAA5E,GAAgFwV,EAAvF;AACD;;AAED,WAASqB,UAAT,CAAoBnd,KAApB,EAA2B;AACzB,QAAIS,YAAYT,KAAZ,CAAJ,EAAwB;AACtB,UAAIxB,MAAMwB,MAAMvB,MAAhB;;AAEA,UAAIgC,YAAYT,MAAM,CAAN,CAAZ,CAAJ,EAA2B;AACzB,YAAIod,MAAM,EAAV;;AAEA,aAAK,IAAI7e,IAAI,CAAb,EAAgBA,IAAIC,GAApB,EAAyBD,GAAzB,EAA8B;AAC5B6e,cAAIrc,IAAJ,CAAS0a,WAAWpd,IAAX,CAAgB2B,MAAMzB,CAAN,CAAhB,CAAT;AACD;;AAED,eAAO6e,GAAP;AACD;;AAED,aAAO3B,WAAWpd,IAAX,CAAgB2B,KAAhB,CAAP;AACD;;AAED,WAAOA,KAAP;AACD;;AAED,WAASqd,WAAT,CAAqBjE,IAArB,EAA2B;AACzBA,SAAK,CAAL,IAAU/T,KAAKuV,KAAL,CAAWxB,KAAK,CAAL,CAAX,CAAV;AACAA,SAAK,CAAL,IAAU/T,KAAKuV,KAAL,CAAWxB,KAAK,CAAL,CAAX,CAAV;AACAA,SAAK,CAAL,IAAU/T,KAAKuV,KAAL,CAAWxB,KAAK,CAAL,CAAX,CAAV;AACA,WAAO,UAAUA,KAAKkE,IAAL,CAAU,GAAV,CAAV,GAA2B,GAAlC;AACD;;AAED,WAASC,WAAT,CAAqBC,SAArB,EAAgC;AAC9B,QAAIC,YAAYD,UAAUA,UAAU/e,MAAV,GAAmB,CAA7B,EAAgCuB,KAAhD;AACA,WAAOS,YAAYgd,aAAaA,UAAU,CAAV,CAAzB,IAAyC,CAAzC,GAA6C,CAApD;AACD;;AAED,WAASC,eAAT,CAAyBC,QAAzB,EAAmCtM,MAAnC,EAA2CuM,YAA3C,EAAyDJ,SAAzD,EAAoEK,QAApE,EAA8EC,YAA9E,EAA4F;AAC1F,QAAIC,SAASJ,SAASK,OAAtB;AACA,QAAIC,SAASN,SAASO,OAAtB;AACA,QAAIC,YAAY9M,WAAW,QAA3B;AACA,QAAI+M,WAAWZ,UAAU/e,MAAzB;;AAEA,QAAI,CAAC2f,QAAL,EAAe;AACb;AACD,KARyF,CAQxF;;;AAGF,QAAIC,WAAWb,UAAU,CAAV,EAAaxd,KAA5B;AACA,QAAIse,eAAe7d,YAAY4d,QAAZ,CAAnB;AACA,QAAIE,eAAe,KAAnB;AACA,QAAIC,gBAAgB,KAApB,CAd0F,CAc/D;;AAE3B,QAAIvC,SAASqC,eAAef,YAAYC,SAAZ,CAAf,GAAwC,CAArD;AACA,QAAIiB,YAAJ,CAjB0F,CAiBxE;;AAElBjB,cAAUkB,IAAV,CAAe,UAAU7a,CAAV,EAAaC,CAAb,EAAgB;AAC7B,aAAOD,EAAE8a,IAAF,GAAS7a,EAAE6a,IAAlB;AACD,KAFD;AAGAF,mBAAejB,UAAUY,WAAW,CAArB,EAAwBO,IAAvC,CAtB0F,CAsB7C;;AAE7C,QAAIC,aAAa,EAAjB,CAxB0F,CAwBrE;;AAErB,QAAIC,WAAW,EAAf;AACA,QAAIC,YAAYtB,UAAU,CAAV,EAAaxd,KAA7B;AACA,QAAI+e,kBAAkB,IAAtB;;AAEA,SAAK,IAAIxgB,IAAI,CAAb,EAAgBA,IAAI6f,QAApB,EAA8B7f,GAA9B,EAAmC;AACjCqgB,iBAAW7d,IAAX,CAAgByc,UAAUjf,CAAV,EAAaogB,IAAb,GAAoBF,YAApC,EADiC,CACkB;;AAEnD,UAAIze,QAAQwd,UAAUjf,CAAV,EAAayB,KAAzB,CAHiC,CAGD;;AAEhC,UAAI,EAAEse,gBAAgB3B,YAAY3c,KAAZ,EAAmB8e,SAAnB,EAA8B7C,MAA9B,CAAhB,IAAyD,CAACqC,YAAD,IAAiBte,UAAU8e,SAAtF,CAAJ,EAAsG;AACpGC,0BAAkB,KAAlB;AACD;;AAEDD,kBAAY9e,KAAZ,CATiC,CASd;;AAEnB,UAAI,OAAOA,KAAP,IAAgB,QAApB,EAA8B;AAC5B,YAAIgf,aAAa1G,MAAMtY,KAAN,CAAjB;;AAEA,YAAIgf,UAAJ,EAAgB;AACdhf,kBAAQgf,UAAR;AACAT,yBAAe,IAAf;AACD,SAHD,MAGO;AACLC,0BAAgB,IAAhB;AACD;AACF;;AAEDK,eAAS9d,IAAT,CAAcf,KAAd;AACD;;AAED,QAAI,CAAC8d,YAAD,IAAiBiB,eAArB,EAAsC;AACpC;AACD;;AAED,QAAItB,YAAYoB,SAAST,WAAW,CAApB,CAAhB,CA3D0F,CA2DlD;;AAExC,SAAK,IAAI7f,IAAI,CAAb,EAAgBA,IAAI6f,WAAW,CAA/B,EAAkC7f,GAAlC,EAAuC;AACrC,UAAI+f,YAAJ,EAAkB;AAChBlC,gBAAQyC,SAAStgB,CAAT,CAAR,EAAqBkf,SAArB,EAAgCxB,MAAhC;AACD,OAFD,MAEO;AACL,YAAIS,MAAMmC,SAAStgB,CAAT,CAAN,KAAsB,CAACme,MAAMe,SAAN,CAAvB,IAA2C,CAACe,aAA5C,IAA6D,CAACD,YAAlE,EAAgF;AAC9EM,mBAAStgB,CAAT,IAAckf,SAAd;AACD;AACF;AACF;;AAEDa,oBAAgBlC,QAAQ2B,OAAOJ,SAAS/J,OAAhB,EAAyBiK,QAAzB,CAAR,EAA4CJ,SAA5C,EAAuDxB,MAAvD,CAAhB,CAvE0F,CAuEV;AAChF;;AAEA,QAAIgD,YAAY,CAAhB;AACA,QAAIC,mBAAmB,CAAvB;AACA,QAAIC,KAAJ;AACA,QAAIC,CAAJ;AACA,QAAIvD,EAAJ;AACA,QAAIC,EAAJ;AACA,QAAIe,EAAJ;AACA,QAAIC,EAAJ;;AAEA,QAAIyB,YAAJ,EAAkB;AAChB,UAAInF,OAAO,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,CAAX;AACD;;AAED,QAAIhF,UAAU,SAAVA,OAAU,CAAUnV,MAAV,EAAkB4V,OAAlB,EAA2B;AACvC;AACA;AACA;AACA,UAAIwK,KAAJ,CAJuC,CAI5B;;AAEX,UAAIxK,UAAU,CAAd,EAAiB;AACfwK,gBAAQ,CAAR;AACD,OAFD,MAEO,IAAIxK,UAAUqK,gBAAd,EAAgC;AACrC;AACA;AACAC,gBAAQ9Z,KAAKoB,GAAL,CAASwY,YAAY,CAArB,EAAwBb,WAAW,CAAnC,CAAR;;AAEA,aAAKiB,QAAQF,KAAb,EAAoBE,SAAS,CAA7B,EAAgCA,OAAhC,EAAyC;AACvC,cAAIT,WAAWS,KAAX,KAAqBxK,OAAzB,EAAkC;AAChC;AACD;AACF,SAToC,CASnC;;;AAGFwK,gBAAQha,KAAKoB,GAAL,CAAS4Y,KAAT,EAAgBjB,WAAW,CAA3B,CAAR;AACD,OAbM,MAaA;AACL,aAAKiB,QAAQJ,SAAb,EAAwBI,QAAQjB,QAAhC,EAA0CiB,OAA1C,EAAmD;AACjD,cAAIT,WAAWS,KAAX,IAAoBxK,OAAxB,EAAiC;AAC/B;AACD;AACF;;AAEDwK,gBAAQha,KAAKoB,GAAL,CAAS4Y,QAAQ,CAAjB,EAAoBjB,WAAW,CAA/B,CAAR;AACD;;AAEDa,kBAAYI,KAAZ;AACAH,yBAAmBrK,OAAnB;AACA,UAAIyK,QAAQV,WAAWS,QAAQ,CAAnB,IAAwBT,WAAWS,KAAX,CAApC;;AAEA,UAAIC,UAAU,CAAd,EAAiB;AACf;AACD,OAFD,MAEO;AACLF,YAAI,CAACvK,UAAU+J,WAAWS,KAAX,CAAX,IAAgCC,KAApC;AACD;;AAED,UAAInB,SAAJ,EAAe;AACbrC,aAAK+C,SAASQ,KAAT,CAAL;AACAxD,aAAKgD,SAASQ,UAAU,CAAV,GAAcA,KAAd,GAAsBA,QAAQ,CAAvC,CAAL;AACAxC,aAAKgC,SAASQ,QAAQjB,WAAW,CAAnB,GAAuBA,WAAW,CAAlC,GAAsCiB,QAAQ,CAAvD,CAAL;AACAvC,aAAK+B,SAASQ,QAAQjB,WAAW,CAAnB,GAAuBA,WAAW,CAAlC,GAAsCiB,QAAQ,CAAvD,CAAL;;AAEA,YAAIf,YAAJ,EAAkB;AAChB1B,qCAA2Bf,EAA3B,EAA+BC,EAA/B,EAAmCe,EAAnC,EAAuCC,EAAvC,EAA2CsC,CAA3C,EAA8CA,IAAIA,CAAlD,EAAqDA,IAAIA,CAAJ,GAAQA,CAA7D,EAAgErB,OAAO9e,MAAP,EAAe4e,QAAf,CAAhE,EAA0F5B,MAA1F;AACD,SAFD,MAEO;AACL,cAAIjc,KAAJ;;AAEA,cAAIue,YAAJ,EAAkB;AAChBve,oBAAQ4c,2BAA2Bf,EAA3B,EAA+BC,EAA/B,EAAmCe,EAAnC,EAAuCC,EAAvC,EAA2CsC,CAA3C,EAA8CA,IAAIA,CAAlD,EAAqDA,IAAIA,CAAJ,GAAQA,CAA7D,EAAgEhG,IAAhE,EAAsE,CAAtE,CAAR;AACApZ,oBAAQqd,YAAYjE,IAAZ,CAAR;AACD,WAHD,MAGO,IAAIoF,aAAJ,EAAmB;AACxB;AACA,mBAAOzC,kBAAkBD,EAAlB,EAAsBe,EAAtB,EAA0BuC,CAA1B,CAAP;AACD,WAHM,MAGA;AACLpf,oBAAQid,sBAAsBpB,EAAtB,EAA0BC,EAA1B,EAA8Be,EAA9B,EAAkCC,EAAlC,EAAsCsC,CAAtC,EAAyCA,IAAIA,CAA7C,EAAgDA,IAAIA,CAAJ,GAAQA,CAAxD,CAAR;AACD;;AAEDnB,iBAAOhf,MAAP,EAAe4e,QAAf,EAAyB7d,KAAzB;AACD;AACF,OAvBD,MAuBO;AACL,YAAIse,YAAJ,EAAkB;AAChBtC,2BAAiB6C,SAASQ,KAAT,CAAjB,EAAkCR,SAASQ,QAAQ,CAAjB,CAAlC,EAAuDD,CAAvD,EAA0DrB,OAAO9e,MAAP,EAAe4e,QAAf,CAA1D,EAAoF5B,MAApF;AACD,SAFD,MAEO;AACL,cAAIjc,KAAJ;;AAEA,cAAIue,YAAJ,EAAkB;AAChBvC,6BAAiB6C,SAASQ,KAAT,CAAjB,EAAkCR,SAASQ,QAAQ,CAAjB,CAAlC,EAAuDD,CAAvD,EAA0DhG,IAA1D,EAAgE,CAAhE;AACApZ,oBAAQqd,YAAYjE,IAAZ,CAAR;AACD,WAHD,MAGO,IAAIoF,aAAJ,EAAmB;AACxB;AACA,mBAAOzC,kBAAkB8C,SAASQ,KAAT,CAAlB,EAAmCR,SAASQ,QAAQ,CAAjB,CAAnC,EAAwDD,CAAxD,CAAP;AACD,WAHM,MAGA;AACLpf,oBAAQ4b,kBAAkBiD,SAASQ,KAAT,CAAlB,EAAmCR,SAASQ,QAAQ,CAAjB,CAAnC,EAAwDD,CAAxD,CAAR;AACD;;AAEDnB,iBAAOhf,MAAP,EAAe4e,QAAf,EAAyB7d,KAAzB;AACD;AACF;AACF,KAnFD;;AAqFA,QAAIuf,OAAO,IAAI7L,IAAJ,CAAS;AAClBzU,cAAQ0e,SAAS/J,OADC;AAElBE,YAAM2K,YAFY;AAGlBvK,YAAMyJ,SAAS6B,KAHG;AAIlBxL,aAAO2J,SAAS5J,MAJE;AAKlBK,eAASA,OALS;AAMlBC,iBAAWuJ;AANO,KAAT,CAAX;;AASA,QAAIvM,UAAUA,WAAW,QAAzB,EAAmC;AACjCkO,WAAKlO,MAAL,GAAcA,MAAd;AACD;;AAED,WAAOkO,IAAP;AACD;AACD;;;;;;;;;AAUA,MAAIE,WAAW,SAAXA,QAAW,CAAUxgB,MAAV,EAAkBiV,IAAlB,EAAwB6J,MAAxB,EAAgCE,MAAhC,EAAwC;AACrD,SAAKyB,OAAL,GAAe,EAAf;AACA,SAAK9L,OAAL,GAAe3U,MAAf;AACA,SAAKugB,KAAL,GAAatL,QAAQ,KAArB;AACA,SAAK8J,OAAL,GAAeD,UAAUrC,aAAzB;AACA,SAAKwC,OAAL,GAAeD,UAAUtC,aAAzB;AACA,SAAKgE,UAAL,GAAkB,CAAlB;AACA,SAAK5L,MAAL,GAAc,CAAd;AACA,SAAK6L,SAAL,GAAiB,EAAjB;AACA,SAAKC,YAAL,GAAoB,EAApB;AACA,SAAKC,SAAL,GAAiB,EAAjB;AACD,GAXD;;AAaAL,WAAS3iB,SAAT,GAAqB;AACnB;;;;;;AAMAijB,UAAM,cAAUpB;AAChB;AADM,MAEJqB,KAFI,EAEG;AACP,UAAIC,SAAS,KAAKP,OAAlB;;AAEA,WAAK,IAAI7B,QAAT,IAAqBmC,KAArB,EAA4B;AAC1B,YAAI,CAACA,MAAMjhB,cAAN,CAAqB8e,QAArB,CAAL,EAAqC;AACnC;AACD;;AAED,YAAI,CAACoC,OAAOpC,QAAP,CAAL,EAAuB;AACrBoC,iBAAOpC,QAAP,IAAmB,EAAnB,CADqB,CACE;;AAEvB,cAAI7d,QAAQ,KAAKge,OAAL,CAAa,KAAKpK,OAAlB,EAA2BiK,QAA3B,CAAZ;;AAEA,cAAI7d,SAAS,IAAb,EAAmB;AACjB;AACA;AACD,WARoB,CAQnB;AACF;AACA;AACA;;;AAGA,cAAI2e,SAAS,CAAb,EAAgB;AACdsB,mBAAOpC,QAAP,EAAiB9c,IAAjB,CAAsB;AACpB4d,oBAAM,CADc;AAEpB3e,qBAAOmd,WAAWnd,KAAX;AAFa,aAAtB;AAID;AACF;;AAEDigB,eAAOpC,QAAP,EAAiB9c,IAAjB,CAAsB;AACpB4d,gBAAMA,IADc;AAEpB3e,iBAAOggB,MAAMnC,QAAN;AAFa,SAAtB;AAID;;AAED,aAAO,IAAP;AACD,KA9CkB;;AAgDnB;;;;;AAKAqC,YAAQ,gBAAUC,QAAV,EAAoB;AAC1B,WAAKN,YAAL,CAAkB9e,IAAlB,CAAuBof,QAAvB;;AAEA,aAAO,IAAP;AACD,KAzDkB;AA0DnB5K,WAAO,iBAAY;AACjB,WAAK,IAAIhX,IAAI,CAAb,EAAgBA,IAAI,KAAKuhB,SAAL,CAAerhB,MAAnC,EAA2CF,GAA3C,EAAgD;AAC9C,aAAKuhB,SAAL,CAAevhB,CAAf,EAAkBgX,KAAlB;AACD;;AAED,WAAKf,OAAL,GAAe,IAAf;AACD,KAhEkB;AAiEnBgB,YAAQ,kBAAY;AAClB,WAAK,IAAIjX,IAAI,CAAb,EAAgBA,IAAI,KAAKuhB,SAAL,CAAerhB,MAAnC,EAA2CF,GAA3C,EAAgD;AAC9C,aAAKuhB,SAAL,CAAevhB,CAAf,EAAkBiX,MAAlB;AACD;;AAED,WAAKhB,OAAL,GAAe,KAAf;AACD,KAvEkB;AAwEnB4L,cAAU,oBAAY;AACpB,aAAO,CAAC,CAAC,KAAK5L,OAAd;AACD,KA1EkB;AA2EnB6L,mBAAe,yBAAY;AACzB;AACA,WAAKX,OAAL,GAAe,EAAf,CAFyB,CAEN;;AAEnB,WAAKI,SAAL,CAAerhB,MAAf,GAAwB,CAAxB;AACA,UAAI6hB,WAAW,KAAKV,SAApB;AACA,UAAIphB,MAAM8hB,SAAS7hB,MAAnB;;AAEA,WAAK,IAAIF,IAAI,CAAb,EAAgBA,IAAIC,GAApB,EAAyBD,GAAzB,EAA8B;AAC5B+hB,iBAAS/hB,CAAT,EAAYF,IAAZ,CAAiB,IAAjB;AACD;AACF,KAtFkB;;AAwFnB;;;;;;;AAOA8gB,WAAO,eAAU9N,MAAV,EAAkByM,YAAlB,EAAgC;AACrC,UAAIviB,OAAO,IAAX;AACA,UAAIglB,YAAY,CAAhB;;AAEA,UAAI3C,eAAe,SAAfA,YAAe,GAAY;AAC7B2C;;AAEA,YAAI,CAACA,SAAL,EAAgB;AACdhlB,eAAK8kB,aAAL;AACD;AACF,OAND;;AAQA,UAAIG,QAAJ;;AAEA,WAAK,IAAI3C,QAAT,IAAqB,KAAK6B,OAA1B,EAAmC;AACjC,YAAI,CAAC,KAAKA,OAAL,CAAa3gB,cAAb,CAA4B8e,QAA5B,CAAL,EAA4C;AAC1C;AACD;;AAED,YAAI0B,OAAO7B,gBAAgB,IAAhB,EAAsBrM,MAAtB,EAA8BuM,YAA9B,EAA4C,KAAK8B,OAAL,CAAa7B,QAAb,CAA5C,EAAoEA,QAApE,EAA8EC,YAA9E,CAAX;;AAEA,YAAIyB,IAAJ,EAAU;AACR,eAAKO,SAAL,CAAe/e,IAAf,CAAoBwe,IAApB;;AAEAgB,sBAHQ,CAGK;;AAEb,cAAI,KAAKE,SAAT,EAAoB;AAClB,iBAAKA,SAAL,CAAeC,OAAf,CAAuBnB,IAAvB;AACD;;AAEDiB,qBAAWjB,IAAX;AACD;AACF,OAhCoC,CAgCnC;;;AAGF,UAAIiB,QAAJ,EAAc;AACZ,YAAIG,aAAaH,SAASpM,OAA1B;;AAEAoM,iBAASpM,OAAT,GAAmB,UAAUnV,MAAV,EAAkB4V,OAAlB,EAA2B;AAC5C8L,qBAAW1hB,MAAX,EAAmB4V,OAAnB;;AAEA,eAAK,IAAItW,IAAI,CAAb,EAAgBA,IAAIhD,KAAKskB,YAAL,CAAkBphB,MAAtC,EAA8CF,GAA9C,EAAmD;AACjDhD,iBAAKskB,YAAL,CAAkBthB,CAAlB,EAAqBU,MAArB,EAA6B4V,OAA7B;AACD;AACF,SAND;AAOD,OA7CoC,CA6CnC;AACF;AACA;;;AAGA,UAAI,CAAC0L,SAAL,EAAgB;AACd,aAAKF,aAAL;AACD;;AAED,aAAO,IAAP;AACD,KAtJkB;;AAwJnB;;;;AAIAO,UAAM,cAAUC,aAAV,EAAyB;AAC7B,UAAIC,WAAW,KAAKhB,SAApB;AACA,UAAIW,YAAY,KAAKA,SAArB;;AAEA,WAAK,IAAIliB,IAAI,CAAb,EAAgBA,IAAIuiB,SAASriB,MAA7B,EAAqCF,GAArC,EAA0C;AACxC,YAAIghB,OAAOuB,SAASviB,CAAT,CAAX;;AAEA,YAAIsiB,aAAJ,EAAmB;AACjB;AACAtB,eAAKnL,OAAL,CAAa,KAAKR,OAAlB,EAA2B,CAA3B;AACD;;AAED6M,qBAAaA,UAAUM,UAAV,CAAqBxB,IAArB,CAAb;AACD;;AAEDuB,eAASriB,MAAT,GAAkB,CAAlB;AACD,KA5KkB;;AA8KnB;;;;;AAKAuV,WAAO,eAAU2K,IAAV,EAAgB;AACrB,WAAK5K,MAAL,GAAc4K,IAAd;AACA,aAAO,IAAP;AACD,KAtLkB;;AAwLnB;;;;;AAKAqC,UAAM,cAAUngB,EAAV,EAAc;AAClB,UAAIA,EAAJ,EAAQ;AACN,aAAK+e,SAAL,CAAe7e,IAAf,CAAoBF,EAApB;AACD;;AAED,aAAO,IAAP;AACD,KAnMkB;;AAqMnB;;;AAGAogB,cAAU,oBAAY;AACpB,aAAO,KAAKnB,SAAZ;AACD;AA1MkB,GAArB;;AA6MA,MAAIpP,MAAM,CAAV,CA/mI4B,CA+mIf;;AAEb,MAAI,OAAOlU,MAAP,KAAkB,WAAtB,EAAmC;AACjCkU,UAAMrL,KAAKqB,GAAL,CAASlK,OAAO0kB,gBAAP,IAA2B,CAApC,EAAuC,CAAvC,CAAN;AACD;AACD;;;;;;AAMA;;;;;;;AAQA,MAAIC,YAAY,CAAhB,CAloI4B,CAkoIT;;AAEnB,MAAID,mBAAmBxQ,GAAvB;;AAEA,MAAI0Q,MAAM,eAAY,CAAE,CAAxB;;AAEA,MAAID,cAAc,CAAlB,EAAqB;AACnBC,UAAM,eAAY;AAChB,WAAK,IAAI7P,CAAT,IAAclQ,SAAd,EAAyB;AACvB,cAAM,IAAIwB,KAAJ,CAAUxB,UAAUkQ,CAAV,CAAV,CAAN;AACD;AACF,KAJD;AAKD,GAND,MAMO,IAAI4P,YAAY,CAAhB,EAAmB;AACxBC,UAAM,eAAY;AAChB,WAAK,IAAI7P,CAAT,IAAclQ,SAAd,EAAyB;AACvBggB,gBAAQD,GAAR,CAAY/f,UAAUkQ,CAAV,CAAZ;AACD;AACF,KAJD;AAKD;;AAED,MAAI+P,QAAQF,GAAZ;;AAEA;;;;;AAKA,MAAIG,aAAa,SAAbA,UAAa,GAAY;AAC3B;;;;AAIA,SAAKC,SAAL,GAAiB,EAAjB;AACD,GAND;;AAQAD,aAAWzkB,SAAX,GAAuB;AACrB6B,iBAAa4iB,UADQ;;AAGrB;;;;;;;;;;;;AAYAE,aAAS,iBAAUC,IAAV,EAAgBxN,IAAhB,EAAsB;AAC7B,UAAIjV,MAAJ;AACA,UAAI0iB,iBAAiB,KAArB;AACA,UAAItV,KAAK,IAAT;AACA,UAAIuV,KAAK,KAAKxW,IAAd;;AAEA,UAAIsW,IAAJ,EAAU;AACR,YAAIG,eAAeH,KAAK3I,KAAL,CAAW,GAAX,CAAnB;AACA,YAAIzY,OAAO+L,EAAX,CAFQ,CAEO;;AAEfsV,yBAAiBE,aAAa,CAAb,MAAoB,OAArC;;AAEA,aAAK,IAAItjB,IAAI,CAAR,EAAWyK,IAAI6Y,aAAapjB,MAAjC,EAAyCF,IAAIyK,CAA7C,EAAgDzK,GAAhD,EAAqD;AACnD,cAAI,CAAC+B,IAAL,EAAW;AACT;AACD;;AAEDA,iBAAOA,KAAKuhB,aAAatjB,CAAb,CAAL,CAAP;AACD;;AAED,YAAI+B,IAAJ,EAAU;AACRrB,mBAASqB,IAAT;AACD;AACF,OAjBD,MAiBO;AACLrB,iBAASoN,EAAT;AACD;;AAED,UAAI,CAACpN,MAAL,EAAa;AACXqiB,cAAM,eAAeI,IAAf,GAAsB,8BAAtB,GAAuDrV,GAAGyV,EAAhE;AACA;AACD;;AAED,UAAIN,YAAYnV,GAAGmV,SAAnB;AACA,UAAI7D,WAAW,IAAI8B,QAAJ,CAAaxgB,MAAb,EAAqBiV,IAArB,CAAf;AACAyJ,eAASuC,MAAT,CAAgB,UAAUjhB,MAAV,EAAkB;AAChCoN,WAAG0V,KAAH,CAASJ,cAAT;AACD,OAFD,EAEGX,IAFH,CAEQ,YAAY;AAClB;AACAQ,kBAAUrY,MAAV,CAAiBrJ,QAAQ0hB,SAAR,EAAmB7D,QAAnB,CAAjB,EAA+C,CAA/C;AACD,OALD;AAMA6D,gBAAUzgB,IAAV,CAAe4c,QAAf,EAxC6B,CAwCH;;AAE1B,UAAIiE,EAAJ,EAAQ;AACNA,WAAGnB,SAAH,CAAauB,WAAb,CAAyBrE,QAAzB;AACD;;AAED,aAAOA,QAAP;AACD,KA9DoB;;AAgErB;;;;AAIAsE,mBAAe,uBAAUpB,aAAV,EAAyB;AACtC,UAAIW,YAAY,KAAKA,SAArB;AACA,UAAIhjB,MAAMgjB,UAAU/iB,MAApB;;AAEA,WAAK,IAAIF,IAAI,CAAb,EAAgBA,IAAIC,GAApB,EAAyBD,GAAzB,EAA8B;AAC5BijB,kBAAUjjB,CAAV,EAAaqiB,IAAb,CAAkBC,aAAlB;AACD;;AAEDW,gBAAU/iB,MAAV,GAAmB,CAAnB;AACA,aAAO,IAAP;AACD,KA9EoB;;AAgFrB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6BA;AACAyjB,eAAW,mBAAUjjB,MAAV,EAAkB0f,IAAlB,EAAwB3K,KAAxB,EAA+B3C,MAA/B,EAAuC8O,QAAvC,EAAiDrC,YAAjD,EAA+D;AACxE;AACA,UAAIpc,SAASsS,KAAT,CAAJ,EAAqB;AACnBmM,mBAAW9O,MAAX;AACAA,iBAAS2C,KAAT;AACAA,gBAAQ,CAAR;AACD,OAJD,CAIE;AAJF,WAKK,IAAIvS,aAAa4P,MAAb,CAAJ,EAA0B;AAC3B8O,qBAAW9O,MAAX;AACAA,mBAAS,QAAT;AACA2C,kBAAQ,CAAR;AACD,SAJE,CAID;AAJC,aAKE,IAAIvS,aAAauS,KAAb,CAAJ,EAAyB;AAC1BmM,uBAAWnM,KAAX;AACAA,oBAAQ,CAAR;AACD,WAHE,CAGD;AAHC,eAIE,IAAIvS,aAAakd,IAAb,CAAJ,EAAwB;AACzBwB,yBAAWxB,IAAX;AACAA,qBAAO,GAAP;AACD,aAHE,CAGD;AAHC,iBAIE,IAAI,CAACA,IAAL,EAAW;AACZA,uBAAO,GAAP;AACD,eAtB+D,CAsB9D;;;AAGV,WAAKsD,aAAL;;AAEA,WAAKE,iBAAL,CAAuB,EAAvB,EAA2B,IAA3B,EAAiCljB,MAAjC,EAAyC0f,IAAzC,EAA+C3K,KAA/C,EA3BwE,CA2BjB;AACvD;;;AAGA,UAAIwN,YAAY,KAAKA,SAAL,CAAejkB,KAAf,EAAhB;AACA,UAAI6kB,QAAQZ,UAAU/iB,MAAtB;;AAEA,eAASuiB,IAAT,GAAgB;AACdoB;;AAEA,YAAI,CAACA,KAAL,EAAY;AACVjC,sBAAYA,UAAZ;AACD;AACF,OAxCuE,CAwCtE;AACF;;;AAGA,UAAI,CAACiC,KAAL,EAAY;AACVjC,oBAAYA,UAAZ;AACD,OA9CuE,CA8CtE;AACF;;;AAGA,WAAK,IAAI5hB,IAAI,CAAb,EAAgBA,IAAIijB,UAAU/iB,MAA9B,EAAsCF,GAAtC,EAA2C;AACzCijB,kBAAUjjB,CAAV,EAAayiB,IAAb,CAAkBA,IAAlB,EAAwB7B,KAAxB,CAA8B9N,MAA9B,EAAsCyM,YAAtC;AACD;AACF,KAnKoB;;AAqKrB;;;;;;;;;;;;;;;;;;;;;;;;;AAyBAqE,uBAAmB,2BAAUT,IAAV,EAAgBxjB,MAAhB,EAAwBe,MAAxB,EAAgC0f,IAAhC,EAAsC3K,KAAtC,EAA6C;AAC9D,UAAIqO,aAAa,EAAjB;AACA,UAAIC,gBAAgB,CAApB;;AAEA,WAAK,IAAIxkB,IAAT,IAAiBmB,MAAjB,EAAyB;AACvB,YAAI,CAACA,OAAOF,cAAP,CAAsBjB,IAAtB,CAAL,EAAkC;AAChC;AACD;;AAED,YAAII,OAAOJ,IAAP,KAAgB,IAApB,EAA0B;AACxB,cAAIqB,WAAWF,OAAOnB,IAAP,CAAX,KAA4B,CAAC2C,YAAYxB,OAAOnB,IAAP,CAAZ,CAAjC,EAA4D;AAC1D,iBAAKqkB,iBAAL,CAAuBT,OAAOA,OAAO,GAAP,GAAa5jB,IAApB,GAA2BA,IAAlD,EAAwDI,OAAOJ,IAAP,CAAxD,EAAsEmB,OAAOnB,IAAP,CAAtE,EAAoF6gB,IAApF,EAA0F3K,KAA1F;AACD,WAFD,MAEO;AACLqO,uBAAWvkB,IAAX,IAAmBmB,OAAOnB,IAAP,CAAnB;AACAwkB;AACD;AACF,SAPD,MAOO,IAAIrjB,OAAOnB,IAAP,KAAgB,IAApB,EAA0B;AAC/B;AACA;AACA,cAAI,CAAC4jB,IAAL,EAAW;AACT,iBAAKa,IAAL,CAAUzkB,IAAV,EAAgBmB,OAAOnB,IAAP,CAAhB;AACD,WAFD,MAEO;AACL;AACA,gBAAIkiB,QAAQ,EAAZ;AACAA,kBAAM0B,IAAN,IAAc,EAAd;AACA1B,kBAAM0B,IAAN,EAAY5jB,IAAZ,IAAoBmB,OAAOnB,IAAP,CAApB;AACA,iBAAKykB,IAAL,CAAUvC,KAAV;AACD;AACF;AACF;;AAED,UAAIsC,gBAAgB,CAApB,EAAuB;AACrB,aAAKb,OAAL,CAAaC,IAAb,EAAmB,KAAnB,EAA0B3B,IAA1B,CAA+BpB,QAAQ,IAAR,GAAe,GAAf,GAAqBA,IAApD,EAA0D0D,UAA1D,EAAsErO,KAAtE,CAA4EA,SAAS,CAArF;AACD;;AAED,aAAO,IAAP;AACD;AAlOoB,GAAvB;;AAqOA;;;;;;;;AAQA,MAAIwO,UAAU,SAAVA,OAAU,CAAU1S,IAAV,EAAgB;AAC5B;AACAD,kBAAcxR,IAAd,CAAmB,IAAnB,EAAyByR,IAAzB;AACAxH,aAASjK,IAAT,CAAc,IAAd,EAAoByR,IAApB;AACAyR,eAAWljB,IAAX,CAAgB,IAAhB,EAAsByR,IAAtB;AACA;;;;;AAKA,SAAKgS,EAAL,GAAUhS,KAAKgS,EAAL,IAAWnnB,MAArB;AACD,GAXD;;AAaA6nB,UAAQ1lB,SAAR,GAAoB;AAClB;;;;;AAKA6E,UAAM,SANY;;AAQlB;;;;;AAKA7D,UAAM,EAbY;;AAelB;;;;;;AAMAsN,UAAM,IArBY;;AAuBlB;;;;;;;AAOA4B,YAAQ,KA9BU;;AAgClB;;;;;;;AAOAO,cAAU,IAvCQ;;AAyClB;;;;AAIAkV,aAAS,KA7CS;;AA+ClB;;;;;AAKA1a,WAAO,eAAUF,EAAV,EAAcC,EAAd,EAAkB;AACvB,cAAQ,KAAKX,SAAb;AACE,aAAK,YAAL;AACEW,eAAK,CAAL;AACA;;AAEF,aAAK,UAAL;AACED,eAAK,CAAL;AACA;AAPJ;;AAUA,UAAIrB,IAAI,KAAK2J,SAAb;;AAEA,UAAI,CAAC3J,CAAL,EAAQ;AACNA,YAAI,KAAK2J,SAAL,GAAiB,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,EAAgB,CAAhB,CAArB;AACD;;AAED3J,QAAE,CAAF,KAAQqB,EAAR;AACArB,QAAE,CAAF,KAAQsB,EAAR;AACA,WAAK+I,kBAAL;AACA,WAAKkR,KAAL,CAAW,KAAX;AACD,KAzEiB;;AA2ElB;;;AAGAW,kBAAc,wBAAY,CAAE,CA9EV;;AAgFlB;;;AAGAC,iBAAa,uBAAY,CAAE,CAnFT;;AAqFlB;;;AAGAC,YAAQ,kBAAY;AAClB,WAAKvS,eAAL;AACD,KA1FiB;;AA4FlB;;;;AAIAwS,cAAU,kBAAUhiB,EAAV,EAAcC,OAAd,EAAuB,CAAE,CAhGjB;;AAkGlB;;;AAGAgiB,YAAQ,gBAAUhkB,GAAV,EAAekB,KAAf,EAAsB;AAC5B,UAAIlB,QAAQ,UAAR,IAAsBA,QAAQ,OAA9B,IAAyCA,QAAQ,QAArD,EAA+D;AAC7D;AACA,YAAIkB,KAAJ,EAAW;AACT,cAAIf,SAAS,KAAKH,GAAL,CAAb;;AAEA,cAAI,CAACG,MAAL,EAAa;AACXA,qBAAS,KAAKH,GAAL,IAAY,EAArB;AACD;;AAEDG,iBAAO,CAAP,IAAYe,MAAM,CAAN,CAAZ;AACAf,iBAAO,CAAP,IAAYe,MAAM,CAAN,CAAZ;AACD;AACF,OAZD,MAYO;AACL,aAAKlB,GAAL,IAAYkB,KAAZ;AACD;AACF,KArHiB;;AAuHlB;;;AAGA+iB,UAAM,gBAAY;AAChB,WAAK/V,MAAL,GAAc,IAAd;AACA,WAAK5B,IAAL,IAAa,KAAKA,IAAL,CAAU4X,OAAV,EAAb;AACD,KA7HiB;;AA+HlB;;;AAGAC,UAAM,gBAAY;AAChB,WAAKjW,MAAL,GAAc,KAAd;AACA,WAAK5B,IAAL,IAAa,KAAKA,IAAL,CAAU4X,OAAV,EAAb;AACD,KArIiB;;AAuIlB;;;;AAIAT,UAAM,cAAUzjB,GAAV,EAAekB,KAAf,EAAsB;AAC1B,UAAI,OAAOlB,GAAP,KAAe,QAAnB,EAA6B;AAC3B,aAAKgkB,MAAL,CAAYhkB,GAAZ,EAAiBkB,KAAjB;AACD,OAFD,MAEO,IAAIb,WAAWL,GAAX,CAAJ,EAAqB;AAC1B,aAAK,IAAIhB,IAAT,IAAiBgB,GAAjB,EAAsB;AACpB,cAAIA,IAAIC,cAAJ,CAAmBjB,IAAnB,CAAJ,EAA8B;AAC5B,iBAAKglB,MAAL,CAAYhlB,IAAZ,EAAkBgB,IAAIhB,IAAJ,CAAlB;AACD;AACF;AACF;;AAED,WAAKikB,KAAL,CAAW,KAAX;AACA,aAAO,IAAP;AACD,KAxJiB;;AA0JlB;;;AAGAmB,iBAAa,qBAAU3V,QAAV,EAAoB;AAC/B,UAAIqU,KAAK,KAAKxW,IAAd;;AAEA,UAAIwW,EAAJ,EAAQ;AACNrU,iBAAS4V,WAAT,CAAqBvB,EAArB;AACD,OAL8B,CAK7B;;;AAGF,UAAI,KAAKrU,QAAL,IAAiB,KAAKA,QAAL,KAAkBA,QAAvC,EAAiD;AAC/C,aAAK6V,cAAL;AACD;;AAED,WAAK7V,QAAL,GAAgBA,QAAhB;AACAA,eAASnC,IAAT,GAAgBwW,EAAhB;AACArU,eAAS8V,YAAT,GAAwB,IAAxB;AACA,WAAKtB,KAAL,CAAW,KAAX;AACD,KA7KiB;;AA+KlB;;AAEAqB,oBAAgB,0BAAY;AAC1B,UAAI7V,WAAW,KAAKA,QAApB;;AAEA,UAAIA,QAAJ,EAAc;AACZ,YAAIA,SAASnC,IAAb,EAAmB;AACjBmC,mBAAS+V,gBAAT,CAA0B/V,SAASnC,IAAnC;AACD;;AAEDmC,iBAASnC,IAAT,GAAgB,IAAhB;AACAmC,iBAAS8V,YAAT,GAAwB,IAAxB;AACA,aAAK9V,QAAL,GAAgB,IAAhB;AACA,aAAKwU,KAAL,CAAW,KAAX;AACD;AACF,KA9LiB;;AAgMlB;;;;;AAKAoB,iBAAa,qBAAUvB,EAAV,EAAc;AACzB,WAAKxW,IAAL,GAAYwW,EAAZ,CADyB,CACT;;AAEhB,UAAIJ,YAAY,KAAKA,SAArB;;AAEA,UAAIA,SAAJ,EAAe;AACb,aAAK,IAAIjjB,IAAI,CAAb,EAAgBA,IAAIijB,UAAU/iB,MAA9B,EAAsCF,GAAtC,EAA2C;AACzCqjB,aAAGnB,SAAH,CAAauB,WAAb,CAAyBR,UAAUjjB,CAAV,CAAzB;AACD;AACF;;AAED,UAAI,KAAKgP,QAAT,EAAmB;AACjB,aAAKA,QAAL,CAAc4V,WAAd,CAA0BvB,EAA1B;AACD;AACF,KAnNiB;;AAqNlB;;;;;AAKA0B,sBAAkB,0BAAU1B,EAAV,EAAc;AAC9B,WAAKxW,IAAL,GAAY,IAAZ,CAD8B,CACZ;;AAElB,UAAIoW,YAAY,KAAKA,SAArB;;AAEA,UAAIA,SAAJ,EAAe;AACb,aAAK,IAAIjjB,IAAI,CAAb,EAAgBA,IAAIijB,UAAU/iB,MAA9B,EAAsCF,GAAtC,EAA2C;AACzCqjB,aAAGnB,SAAH,CAAa8C,cAAb,CAA4B/B,UAAUjjB,CAAV,CAA5B;AACD;AACF;;AAED,UAAI,KAAKgP,QAAT,EAAmB;AACjB,aAAKA,QAAL,CAAc+V,gBAAd,CAA+B1B,EAA/B;AACD;AACF;AAxOiB,GAApB;AA0OAphB,QAAMgiB,OAAN,EAAejB,UAAf;AACA/gB,QAAMgiB,OAAN,EAAe3S,aAAf;AACArP,QAAMgiB,OAAN,EAAela,QAAf;;AAEA;;;AAGA,MAAIkb,mBAAmBjd,cAAvB;AACA,MAAIkd,UAAUpe,KAAKoB,GAAnB;AACA,MAAIid,UAAUre,KAAKqB,GAAnB;AACA;;;;AAIA,WAASid,YAAT,CAAsBjf,CAAtB,EAAyBC,CAAzB,EAA4Bif,KAA5B,EAAmCC,MAAnC,EAA2C;AACzC,QAAID,QAAQ,CAAZ,EAAe;AACblf,UAAIA,IAAIkf,KAAR;AACAA,cAAQ,CAACA,KAAT;AACD;;AAED,QAAIC,SAAS,CAAb,EAAgB;AACdlf,UAAIA,IAAIkf,MAAR;AACAA,eAAS,CAACA,MAAV;AACD;AACD;;;;AAKA,SAAKnf,CAAL,GAASA,CAAT;AACA;;;;AAIA,SAAKC,CAAL,GAASA,CAAT;AACA;;;;AAIA,SAAKif,KAAL,GAAaA,KAAb;AACA;;;;AAIA,SAAKC,MAAL,GAAcA,MAAd;AACD;;AAEDF,eAAa7mB,SAAb,GAAyB;AACvB6B,iBAAaglB,YADU;;AAGvB;;;AAGAG,WAAO,eAAUC,KAAV,EAAiB;AACtB,UAAIrf,IAAI+e,QAAQM,MAAMrf,CAAd,EAAiB,KAAKA,CAAtB,CAAR;AACA,UAAIC,IAAI8e,QAAQM,MAAMpf,CAAd,EAAiB,KAAKA,CAAtB,CAAR;AACA,WAAKif,KAAL,GAAaF,QAAQK,MAAMrf,CAAN,GAAUqf,MAAMH,KAAxB,EAA+B,KAAKlf,CAAL,GAAS,KAAKkf,KAA7C,IAAsDlf,CAAnE;AACA,WAAKmf,MAAL,GAAcH,QAAQK,MAAMpf,CAAN,GAAUof,MAAMF,MAAxB,EAAgC,KAAKlf,CAAL,GAAS,KAAKkf,MAA9C,IAAwDlf,CAAtE;AACA,WAAKD,CAAL,GAASA,CAAT;AACA,WAAKC,CAAL,GAASA,CAAT;AACD,KAbsB;;AAevB;;;;AAIA4B,oBAAgB,YAAY;AAC1B,UAAIyd,KAAK,EAAT;AACA,UAAIC,KAAK,EAAT;AACA,UAAIC,KAAK,EAAT;AACA,UAAIC,KAAK,EAAT;AACA,aAAO,UAAU3d,CAAV,EAAa;AAClB;AACA;AACA;AACA,YAAI,CAACA,CAAL,EAAQ;AACN;AACD;;AAEDwd,WAAG,CAAH,IAAQE,GAAG,CAAH,IAAQ,KAAKxf,CAArB;AACAsf,WAAG,CAAH,IAAQG,GAAG,CAAH,IAAQ,KAAKxf,CAArB;AACAsf,WAAG,CAAH,IAAQE,GAAG,CAAH,IAAQ,KAAKzf,CAAL,GAAS,KAAKkf,KAA9B;AACAK,WAAG,CAAH,IAAQC,GAAG,CAAH,IAAQ,KAAKvf,CAAL,GAAS,KAAKkf,MAA9B;AACAL,yBAAiBQ,EAAjB,EAAqBA,EAArB,EAAyBxd,CAAzB;AACAgd,yBAAiBS,EAAjB,EAAqBA,EAArB,EAAyBzd,CAAzB;AACAgd,yBAAiBU,EAAjB,EAAqBA,EAArB,EAAyB1d,CAAzB;AACAgd,yBAAiBW,EAAjB,EAAqBA,EAArB,EAAyB3d,CAAzB;AACA,aAAK9B,CAAL,GAAS+e,QAAQO,GAAG,CAAH,CAAR,EAAeC,GAAG,CAAH,CAAf,EAAsBC,GAAG,CAAH,CAAtB,EAA6BC,GAAG,CAAH,CAA7B,CAAT;AACA,aAAKxf,CAAL,GAAS8e,QAAQO,GAAG,CAAH,CAAR,EAAeC,GAAG,CAAH,CAAf,EAAsBC,GAAG,CAAH,CAAtB,EAA6BC,GAAG,CAAH,CAA7B,CAAT;AACA,YAAIC,OAAOV,QAAQM,GAAG,CAAH,CAAR,EAAeC,GAAG,CAAH,CAAf,EAAsBC,GAAG,CAAH,CAAtB,EAA6BC,GAAG,CAAH,CAA7B,CAAX;AACA,YAAIE,OAAOX,QAAQM,GAAG,CAAH,CAAR,EAAeC,GAAG,CAAH,CAAf,EAAsBC,GAAG,CAAH,CAAtB,EAA6BC,GAAG,CAAH,CAA7B,CAAX;AACA,aAAKP,KAAL,GAAaQ,OAAO,KAAK1f,CAAzB;AACA,aAAKmf,MAAL,GAAcQ,OAAO,KAAK1f,CAA1B;AACD,OAtBD;AAuBD,KA5Be,EAnBO;;AAiDvB;;;;;AAKA2f,wBAAoB,4BAAUxgB,CAAV,EAAa;AAC/B,UAAID,IAAI,IAAR;AACA,UAAIiN,KAAKhN,EAAE8f,KAAF,GAAU/f,EAAE+f,KAArB;AACA,UAAI7S,KAAKjN,EAAE+f,MAAF,GAAWhgB,EAAEggB,MAAtB;AACA,UAAIrd,IAAIkH,UAAR,CAJ+B,CAIX;;AAEpBY,gBAAU9H,CAAV,EAAaA,CAAb,EAAgB,CAAC,CAAC3C,EAAEa,CAAJ,EAAO,CAACb,EAAEc,CAAV,CAAhB;AACAwK,cAAQ3I,CAAR,EAAWA,CAAX,EAAc,CAACsK,EAAD,EAAKC,EAAL,CAAd;AACAzC,gBAAU9H,CAAV,EAAaA,CAAb,EAAgB,CAAC1C,EAAEY,CAAH,EAAMZ,EAAEa,CAAR,CAAhB;AACA,aAAO6B,CAAP;AACD,KAhEsB;;AAkEvB;;;;AAIA+d,eAAW,mBAAUzgB,CAAV,EAAa;AACtB,UAAI,CAACA,CAAL,EAAQ;AACN,eAAO,KAAP;AACD;;AAED,UAAI,EAAEA,aAAa6f,YAAf,CAAJ,EAAkC;AAChC;AACA7f,YAAI6f,aAAalf,MAAb,CAAoBX,CAApB,CAAJ;AACD;;AAED,UAAID,IAAI,IAAR;AACA,UAAI2gB,MAAM3gB,EAAEa,CAAZ;AACA,UAAI+f,MAAM5gB,EAAEa,CAAF,GAAMb,EAAE+f,KAAlB;AACA,UAAIc,MAAM7gB,EAAEc,CAAZ;AACA,UAAIggB,MAAM9gB,EAAEc,CAAF,GAAMd,EAAEggB,MAAlB;AACA,UAAIe,MAAM9gB,EAAEY,CAAZ;AACA,UAAImgB,MAAM/gB,EAAEY,CAAF,GAAMZ,EAAE8f,KAAlB;AACA,UAAIkB,MAAMhhB,EAAEa,CAAZ;AACA,UAAIogB,MAAMjhB,EAAEa,CAAF,GAAMb,EAAE+f,MAAlB;AACA,aAAO,EAAEY,MAAMG,GAAN,IAAaC,MAAML,GAAnB,IAA0BG,MAAMG,GAAhC,IAAuCC,MAAML,GAA/C,CAAP;AACD,KA1FsB;AA2FvBlX,aAAS,iBAAU9I,CAAV,EAAaC,CAAb,EAAgB;AACvB,UAAIqgB,OAAO,IAAX;AACA,aAAOtgB,KAAKsgB,KAAKtgB,CAAV,IAAeA,KAAKsgB,KAAKtgB,CAAL,GAASsgB,KAAKpB,KAAlC,IAA2Cjf,KAAKqgB,KAAKrgB,CAArD,IAA0DA,KAAKqgB,KAAKrgB,CAAL,GAASqgB,KAAKnB,MAApF;AACD,KA9FsB;;AAgGvB;;;AAGA5lB,WAAO,iBAAY;AACjB,aAAO,IAAI0lB,YAAJ,CAAiB,KAAKjf,CAAtB,EAAyB,KAAKC,CAA9B,EAAiC,KAAKif,KAAtC,EAA6C,KAAKC,MAAlD,CAAP;AACD,KArGsB;;AAuGvB;;;AAGAhf,UAAM,cAAUkf,KAAV,EAAiB;AACrB,WAAKrf,CAAL,GAASqf,MAAMrf,CAAf;AACA,WAAKC,CAAL,GAASof,MAAMpf,CAAf;AACA,WAAKif,KAAL,GAAaG,MAAMH,KAAnB;AACA,WAAKC,MAAL,GAAcE,MAAMF,MAApB;AACD,KA/GsB;AAgHvBoB,WAAO,iBAAY;AACjB,aAAO;AACLvgB,WAAG,KAAKA,CADH;AAELC,WAAG,KAAKA,CAFH;AAGLif,eAAO,KAAKA,KAHP;AAILC,gBAAQ,KAAKA;AAJR,OAAP;AAMD;AAvHsB,GAAzB;AAyHA;;;;;;;;;AASAF,eAAalf,MAAb,GAAsB,UAAUugB,IAAV,EAAgB;AACpC,WAAO,IAAIrB,YAAJ,CAAiBqB,KAAKtgB,CAAtB,EAAyBsgB,KAAKrgB,CAA9B,EAAiCqgB,KAAKpB,KAAtC,EAA6CoB,KAAKnB,MAAlD,CAAP;AACD,GAFD;;AAIA;;;;;;;;;;;;;;;;;;AAkBA;;;;;;;AAOA,MAAIqB,QAAQ,SAARA,KAAQ,CAAUpV,IAAV,EAAgB;AAC1BA,WAAOA,QAAQ,EAAf;AACA0S,YAAQnkB,IAAR,CAAa,IAAb,EAAmByR,IAAnB;;AAEA,SAAK,IAAIhR,GAAT,IAAgBgR,IAAhB,EAAsB;AACpB,UAAIA,KAAK/Q,cAAL,CAAoBD,GAApB,CAAJ,EAA8B;AAC5B,aAAKA,GAAL,IAAYgR,KAAKhR,GAAL,CAAZ;AACD;AACF;;AAED,SAAKqmB,SAAL,GAAiB,EAAjB;AACA,SAAKC,SAAL,GAAiB,IAAjB;AACA,SAAKC,OAAL,GAAe,IAAf;AACD,GAbD;;AAeAH,QAAMpoB,SAAN,GAAkB;AAChB6B,iBAAaumB,KADG;AAEhBzC,aAAS,IAFO;;AAIhB;;;AAGA9gB,UAAM,OAPU;;AAShB;;;;;;AAMA2K,YAAQ,KAfQ;;AAiBhB;;;AAGAgZ,cAAU,oBAAY;AACpB,aAAO,KAAKH,SAAL,CAAe5nB,KAAf,EAAP;AACD,KAtBe;;AAwBhB;;;;;AAKAgoB,aAAS,iBAAUC,GAAV,EAAe;AACtB,aAAO,KAAKL,SAAL,CAAeK,GAAf,CAAP;AACD,KA/Be;;AAiChB;;;;;AAKAC,iBAAa,qBAAU3nB,IAAV,EAAgB;AAC3B,UAAIwnB,WAAW,KAAKH,SAApB;;AAEA,WAAK,IAAI5mB,IAAI,CAAb,EAAgBA,IAAI+mB,SAAS7mB,MAA7B,EAAqCF,GAArC,EAA0C;AACxC,YAAI+mB,SAAS/mB,CAAT,EAAYT,IAAZ,KAAqBA,IAAzB,EAA+B;AAC7B,iBAAOwnB,SAAS/mB,CAAT,CAAP;AACD;AACF;AACF,KA9Ce;;AAgDhB;;;AAGAmnB,gBAAY,sBAAY;AACtB,aAAO,KAAKP,SAAL,CAAe1mB,MAAtB;AACD,KArDe;;AAuDhB;;;;AAIAuG,SAAK,aAAU2gB,KAAV,EAAiB;AACpB,UAAIA,SAASA,UAAU,IAAnB,IAA2BA,MAAMlZ,MAAN,KAAiB,IAAhD,EAAsD;AACpD,aAAK0Y,SAAL,CAAepkB,IAAf,CAAoB4kB,KAApB;;AAEA,aAAKC,MAAL,CAAYD,KAAZ;AACD;;AAED,aAAO,IAAP;AACD,KAnEe;;AAqEhB;;;;;AAKAE,eAAW,mBAAUF,KAAV,EAAiBG,WAAjB,EAA8B;AACvC,UAAIH,SAASA,UAAU,IAAnB,IAA2BA,MAAMlZ,MAAN,KAAiB,IAA5C,IAAoDqZ,WAApD,IAAmEA,YAAYrZ,MAAZ,KAAuB,IAA9F,EAAoG;AAClG,YAAI6Y,WAAW,KAAKH,SAApB;AACA,YAAIK,MAAMF,SAASxlB,OAAT,CAAiBgmB,WAAjB,CAAV;;AAEA,YAAIN,OAAO,CAAX,EAAc;AACZF,mBAASnc,MAAT,CAAgBqc,GAAhB,EAAqB,CAArB,EAAwBG,KAAxB;;AAEA,eAAKC,MAAL,CAAYD,KAAZ;AACD;AACF;;AAED,aAAO,IAAP;AACD,KAvFe;AAwFhBC,YAAQ,gBAAUD,KAAV,EAAiB;AACvB,UAAIA,MAAMlZ,MAAV,EAAkB;AAChBkZ,cAAMlZ,MAAN,CAAa2J,MAAb,CAAoBuP,KAApB;AACD;;AAEDA,YAAMlZ,MAAN,GAAe,IAAf;AACA,UAAIjC,UAAU,KAAK4a,SAAnB;AACA,UAAIxD,KAAK,KAAKxW,IAAd;;AAEA,UAAIZ,WAAWA,YAAYmb,MAAMP,SAAjC,EAA4C;AAC1C5a,gBAAQub,YAAR,CAAqBJ,KAArB;;AAEA,YAAIA,iBAAiBT,KAArB,EAA4B;AAC1BS,gBAAMK,oBAAN,CAA2Bxb,OAA3B;AACD;AACF;;AAEDoX,YAAMA,GAAGoB,OAAH,EAAN;AACD,KA1Ge;;AA4GhB;;;;AAIA5M,YAAQ,gBAAUuP,KAAV,EAAiB;AACvB,UAAI/D,KAAK,KAAKxW,IAAd;AACA,UAAIZ,UAAU,KAAK4a,SAAnB;AACA,UAAIE,WAAW,KAAKH,SAApB;AACA,UAAIK,MAAM1lB,QAAQwlB,QAAR,EAAkBK,KAAlB,CAAV;;AAEA,UAAIH,MAAM,CAAV,EAAa;AACX,eAAO,IAAP;AACD;;AAEDF,eAASnc,MAAT,CAAgBqc,GAAhB,EAAqB,CAArB;AACAG,YAAMlZ,MAAN,GAAe,IAAf;;AAEA,UAAIjC,OAAJ,EAAa;AACXA,gBAAQyb,cAAR,CAAuBN,KAAvB;;AAEA,YAAIA,iBAAiBT,KAArB,EAA4B;AAC1BS,gBAAMO,sBAAN,CAA6B1b,OAA7B;AACD;AACF;;AAEDoX,YAAMA,GAAGoB,OAAH,EAAN;AACA,aAAO,IAAP;AACD,KAvIe;;AAyIhB;;;AAGAmD,eAAW,qBAAY;AACrB,UAAIb,WAAW,KAAKH,SAApB;AACA,UAAI3a,UAAU,KAAK4a,SAAnB;AACA,UAAIO,KAAJ;AACA,UAAIpnB,CAAJ;;AAEA,WAAKA,IAAI,CAAT,EAAYA,IAAI+mB,SAAS7mB,MAAzB,EAAiCF,GAAjC,EAAsC;AACpConB,gBAAQL,SAAS/mB,CAAT,CAAR;;AAEA,YAAIiM,OAAJ,EAAa;AACXA,kBAAQyb,cAAR,CAAuBN,KAAvB;;AAEA,cAAIA,iBAAiBT,KAArB,EAA4B;AAC1BS,kBAAMO,sBAAN,CAA6B1b,OAA7B;AACD;AACF;;AAEDmb,cAAMlZ,MAAN,GAAe,IAAf;AACD;;AAED6Y,eAAS7mB,MAAT,GAAkB,CAAlB;AACA,aAAO,IAAP;AACD,KAlKe;;AAoKhB;;;;;AAKA2nB,eAAW,mBAAUvlB,EAAV,EAAcC,OAAd,EAAuB;AAChC,UAAIwkB,WAAW,KAAKH,SAApB;;AAEA,WAAK,IAAI5mB,IAAI,CAAb,EAAgBA,IAAI+mB,SAAS7mB,MAA7B,EAAqCF,GAArC,EAA0C;AACxC,YAAIonB,QAAQL,SAAS/mB,CAAT,CAAZ;AACAsC,WAAGxC,IAAH,CAAQyC,OAAR,EAAiB6kB,KAAjB,EAAwBpnB,CAAxB;AACD;;AAED,aAAO,IAAP;AACD,KAlLe;;AAoLhB;;;;;AAKAskB,cAAU,kBAAUhiB,EAAV,EAAcC,OAAd,EAAuB;AAC/B,WAAK,IAAIvC,IAAI,CAAb,EAAgBA,IAAI,KAAK4mB,SAAL,CAAe1mB,MAAnC,EAA2CF,GAA3C,EAAgD;AAC9C,YAAIonB,QAAQ,KAAKR,SAAL,CAAe5mB,CAAf,CAAZ;AACAsC,WAAGxC,IAAH,CAAQyC,OAAR,EAAiB6kB,KAAjB;;AAEA,YAAIA,MAAMhkB,IAAN,KAAe,OAAnB,EAA4B;AAC1BgkB,gBAAM9C,QAAN,CAAehiB,EAAf,EAAmBC,OAAnB;AACD;AACF;;AAED,aAAO,IAAP;AACD,KApMe;AAqMhBklB,0BAAsB,8BAAUxb,OAAV,EAAmB;AACvC,WAAK,IAAIjM,IAAI,CAAb,EAAgBA,IAAI,KAAK4mB,SAAL,CAAe1mB,MAAnC,EAA2CF,GAA3C,EAAgD;AAC9C,YAAIonB,QAAQ,KAAKR,SAAL,CAAe5mB,CAAf,CAAZ;AACAiM,gBAAQub,YAAR,CAAqBJ,KAArB;;AAEA,YAAIA,iBAAiBT,KAArB,EAA4B;AAC1BS,gBAAMK,oBAAN,CAA2Bxb,OAA3B;AACD;AACF;AACF,KA9Me;AA+MhB0b,4BAAwB,gCAAU1b,OAAV,EAAmB;AACzC,WAAK,IAAIjM,IAAI,CAAb,EAAgBA,IAAI,KAAK4mB,SAAL,CAAe1mB,MAAnC,EAA2CF,GAA3C,EAAgD;AAC9C,YAAIonB,QAAQ,KAAKR,SAAL,CAAe5mB,CAAf,CAAZ;AACAiM,gBAAQyb,cAAR,CAAuBN,KAAvB;;AAEA,YAAIA,iBAAiBT,KAArB,EAA4B;AAC1BS,gBAAMO,sBAAN,CAA6B1b,OAA7B;AACD;AACF;AACF,KAxNe;AAyNhBuX,WAAO,iBAAY;AACjB,WAAKsD,OAAL,GAAe,IAAf;AACA,WAAKja,IAAL,IAAa,KAAKA,IAAL,CAAU4X,OAAV,EAAb;AACA,aAAO,IAAP;AACD,KA7Ne;;AA+NhB;;;AAGAqD,qBAAiB,yBAAUC,eAAV,EAA2B;AAC1C;AACA,UAAItB,OAAO,IAAX;AACA,UAAIuB,UAAU,IAAI5C,YAAJ,CAAiB,CAAjB,EAAoB,CAApB,EAAuB,CAAvB,EAA0B,CAA1B,CAAd;AACA,UAAI2B,WAAWgB,mBAAmB,KAAKnB,SAAvC;AACA,UAAIqB,SAAS,EAAb;;AAEA,WAAK,IAAIjoB,IAAI,CAAb,EAAgBA,IAAI+mB,SAAS7mB,MAA7B,EAAqCF,GAArC,EAA0C;AACxC,YAAIonB,QAAQL,SAAS/mB,CAAT,CAAZ;;AAEA,YAAIonB,MAAM3Y,MAAN,IAAgB2Y,MAAMc,SAA1B,EAAqC;AACnC;AACD;;AAED,YAAIC,YAAYf,MAAMU,eAAN,EAAhB;AACA,YAAIlW,YAAYwV,MAAMpV,iBAAN,CAAwBiW,MAAxB,CAAhB,CARwC,CAQS;AACjD;AACA;AACA;AACA;AACA;AACA;;AAEA,YAAIrW,SAAJ,EAAe;AACboW,kBAAQ1hB,IAAR,CAAa6hB,SAAb;AACAH,kBAAQhgB,cAAR,CAAuB4J,SAAvB;AACA6U,iBAAOA,QAAQuB,QAAQtoB,KAAR,EAAf;AACA+mB,eAAKlB,KAAL,CAAWyC,OAAX;AACD,SALD,MAKO;AACLvB,iBAAOA,QAAQ0B,UAAUzoB,KAAV,EAAf;AACA+mB,eAAKlB,KAAL,CAAW4C,SAAX;AACD;AACF;;AAED,aAAO1B,QAAQuB,OAAf;AACD;AArQe,GAAlB;AAuQAtmB,WAASilB,KAAT,EAAgB1C,OAAhB;;AAEA;AACA,MAAImE,oBAAoB,EAAxB;AACA,MAAIC,wBAAwB,CAA5B;AACA,WAASC,YAAT,CAAsBC,CAAtB,EAAyB;AACvB,QAAIhP,IAAI,CAAR;;AAEA,WAAOgP,KAAKH,iBAAZ,EAA+B;AAC7B7O,WAAKgP,IAAI,CAAT;AACAA,YAAM,CAAN;AACD;;AAED,WAAOA,IAAIhP,CAAX;AACD;;AAED,WAASiP,gBAAT,CAA0BhnB,KAA1B,EAAiCinB,EAAjC,EAAqCC,EAArC,EAAyCC,OAAzC,EAAkD;AAChD,QAAIC,QAAQH,KAAK,CAAjB;;AAEA,QAAIG,UAAUF,EAAd,EAAkB;AAChB,aAAO,CAAP;AACD;;AAED,QAAIC,QAAQnnB,MAAMonB,OAAN,CAAR,EAAwBpnB,MAAMinB,EAAN,CAAxB,IAAqC,CAAzC,EAA4C;AAC1C,aAAOG,QAAQF,EAAR,IAAcC,QAAQnnB,MAAMonB,KAAN,CAAR,EAAsBpnB,MAAMonB,QAAQ,CAAd,CAAtB,IAA0C,CAA/D,EAAkE;AAChEA;AACD;;AAEDC,iBAAWrnB,KAAX,EAAkBinB,EAAlB,EAAsBG,KAAtB;AACD,KAND,MAMO;AACL,aAAOA,QAAQF,EAAR,IAAcC,QAAQnnB,MAAMonB,KAAN,CAAR,EAAsBpnB,MAAMonB,QAAQ,CAAd,CAAtB,KAA2C,CAAhE,EAAmE;AACjEA;AACD;AACF;;AAED,WAAOA,QAAQH,EAAf;AACD;;AAED,WAASI,UAAT,CAAoBrnB,KAApB,EAA2BinB,EAA3B,EAA+BC,EAA/B,EAAmC;AACjCA;;AAEA,WAAOD,KAAKC,EAAZ,EAAgB;AACd,UAAI3gB,IAAIvG,MAAMinB,EAAN,CAAR;AACAjnB,YAAMinB,IAAN,IAAcjnB,MAAMknB,EAAN,CAAd;AACAlnB,YAAMknB,IAAN,IAAc3gB,CAAd;AACD;AACF;;AAED,WAAS+gB,mBAAT,CAA6BtnB,KAA7B,EAAoCinB,EAApC,EAAwCC,EAAxC,EAA4C9H,KAA5C,EAAmD+H,OAAnD,EAA4D;AAC1D,QAAI/H,UAAU6H,EAAd,EAAkB;AAChB7H;AACD;;AAED,WAAOA,QAAQ8H,EAAf,EAAmB9H,OAAnB,EAA4B;AAC1B,UAAImI,QAAQvnB,MAAMof,KAAN,CAAZ;AACA,UAAIoI,OAAOP,EAAX;AACA,UAAIQ,QAAQrI,KAAZ;AACA,UAAIsI,GAAJ;;AAEA,aAAOF,OAAOC,KAAd,EAAqB;AACnBC,cAAMF,OAAOC,KAAP,KAAiB,CAAvB;;AAEA,YAAIN,QAAQI,KAAR,EAAevnB,MAAM0nB,GAAN,CAAf,IAA6B,CAAjC,EAAoC;AAClCD,kBAAQC,GAAR;AACD,SAFD,MAEO;AACLF,iBAAOE,MAAM,CAAb;AACD;AACF;;AAED,UAAIX,IAAI3H,QAAQoI,IAAhB;;AAEA,cAAQT,CAAR;AACE,aAAK,CAAL;AACE/mB,gBAAMwnB,OAAO,CAAb,IAAkBxnB,MAAMwnB,OAAO,CAAb,CAAlB;;AAEF,aAAK,CAAL;AACExnB,gBAAMwnB,OAAO,CAAb,IAAkBxnB,MAAMwnB,OAAO,CAAb,CAAlB;;AAEF,aAAK,CAAL;AACExnB,gBAAMwnB,OAAO,CAAb,IAAkBxnB,MAAMwnB,IAAN,CAAlB;AACA;;AAEF;AACE,iBAAOT,IAAI,CAAX,EAAc;AACZ/mB,kBAAMwnB,OAAOT,CAAb,IAAkB/mB,MAAMwnB,OAAOT,CAAP,GAAW,CAAjB,CAAlB;AACAA;AACD;;AAfL;;AAmBA/mB,YAAMwnB,IAAN,IAAcD,KAAd;AACD;AACF;;AAED,WAASI,UAAT,CAAoB1nB,KAApB,EAA2BD,KAA3B,EAAkCof,KAAlC,EAAyC1gB,MAAzC,EAAiDkpB,IAAjD,EAAuDT,OAAvD,EAAgE;AAC9D,QAAIU,aAAa,CAAjB;AACA,QAAIC,YAAY,CAAhB;AACA,QAAI7jB,SAAS,CAAb;;AAEA,QAAIkjB,QAAQlnB,KAAR,EAAeD,MAAMof,QAAQwI,IAAd,CAAf,IAAsC,CAA1C,EAA6C;AAC3CE,kBAAYppB,SAASkpB,IAArB;;AAEA,aAAO3jB,SAAS6jB,SAAT,IAAsBX,QAAQlnB,KAAR,EAAeD,MAAMof,QAAQwI,IAAR,GAAe3jB,MAArB,CAAf,IAA+C,CAA5E,EAA+E;AAC7E4jB,qBAAa5jB,MAAb;AACAA,iBAAS,CAACA,UAAU,CAAX,IAAgB,CAAzB;;AAEA,YAAIA,UAAU,CAAd,EAAiB;AACfA,mBAAS6jB,SAAT;AACD;AACF;;AAED,UAAI7jB,SAAS6jB,SAAb,EAAwB;AACtB7jB,iBAAS6jB,SAAT;AACD;;AAEDD,oBAAcD,IAAd;AACA3jB,gBAAU2jB,IAAV;AACD,KAlBD,MAkBO;AACLE,kBAAYF,OAAO,CAAnB;;AAEA,aAAO3jB,SAAS6jB,SAAT,IAAsBX,QAAQlnB,KAAR,EAAeD,MAAMof,QAAQwI,IAAR,GAAe3jB,MAArB,CAAf,KAAgD,CAA7E,EAAgF;AAC9E4jB,qBAAa5jB,MAAb;AACAA,iBAAS,CAACA,UAAU,CAAX,IAAgB,CAAzB;;AAEA,YAAIA,UAAU,CAAd,EAAiB;AACfA,mBAAS6jB,SAAT;AACD;AACF;;AAED,UAAI7jB,SAAS6jB,SAAb,EAAwB;AACtB7jB,iBAAS6jB,SAAT;AACD;;AAED,UAAIC,MAAMF,UAAV;AACAA,mBAAaD,OAAO3jB,MAApB;AACAA,eAAS2jB,OAAOG,GAAhB;AACD;;AAEDF;;AAEA,WAAOA,aAAa5jB,MAApB,EAA4B;AAC1B,UAAIwC,IAAIohB,cAAc5jB,SAAS4jB,UAAT,KAAwB,CAAtC,CAAR;;AAEA,UAAIV,QAAQlnB,KAAR,EAAeD,MAAMof,QAAQ3Y,CAAd,CAAf,IAAmC,CAAvC,EAA0C;AACxCohB,qBAAaphB,IAAI,CAAjB;AACD,OAFD,MAEO;AACLxC,iBAASwC,CAAT;AACD;AACF;;AAED,WAAOxC,MAAP;AACD;;AAED,WAAS+jB,WAAT,CAAqB/nB,KAArB,EAA4BD,KAA5B,EAAmCof,KAAnC,EAA0C1gB,MAA1C,EAAkDkpB,IAAlD,EAAwDT,OAAxD,EAAiE;AAC/D,QAAIU,aAAa,CAAjB;AACA,QAAIC,YAAY,CAAhB;AACA,QAAI7jB,SAAS,CAAb;;AAEA,QAAIkjB,QAAQlnB,KAAR,EAAeD,MAAMof,QAAQwI,IAAd,CAAf,IAAsC,CAA1C,EAA6C;AAC3CE,kBAAYF,OAAO,CAAnB;;AAEA,aAAO3jB,SAAS6jB,SAAT,IAAsBX,QAAQlnB,KAAR,EAAeD,MAAMof,QAAQwI,IAAR,GAAe3jB,MAArB,CAAf,IAA+C,CAA5E,EAA+E;AAC7E4jB,qBAAa5jB,MAAb;AACAA,iBAAS,CAACA,UAAU,CAAX,IAAgB,CAAzB;;AAEA,YAAIA,UAAU,CAAd,EAAiB;AACfA,mBAAS6jB,SAAT;AACD;AACF;;AAED,UAAI7jB,SAAS6jB,SAAb,EAAwB;AACtB7jB,iBAAS6jB,SAAT;AACD;;AAED,UAAIC,MAAMF,UAAV;AACAA,mBAAaD,OAAO3jB,MAApB;AACAA,eAAS2jB,OAAOG,GAAhB;AACD,KAnBD,MAmBO;AACLD,kBAAYppB,SAASkpB,IAArB;;AAEA,aAAO3jB,SAAS6jB,SAAT,IAAsBX,QAAQlnB,KAAR,EAAeD,MAAMof,QAAQwI,IAAR,GAAe3jB,MAArB,CAAf,KAAgD,CAA7E,EAAgF;AAC9E4jB,qBAAa5jB,MAAb;AACAA,iBAAS,CAACA,UAAU,CAAX,IAAgB,CAAzB;;AAEA,YAAIA,UAAU,CAAd,EAAiB;AACfA,mBAAS6jB,SAAT;AACD;AACF;;AAED,UAAI7jB,SAAS6jB,SAAb,EAAwB;AACtB7jB,iBAAS6jB,SAAT;AACD;;AAEDD,oBAAcD,IAAd;AACA3jB,gBAAU2jB,IAAV;AACD;;AAEDC;;AAEA,WAAOA,aAAa5jB,MAApB,EAA4B;AAC1B,UAAIwC,IAAIohB,cAAc5jB,SAAS4jB,UAAT,KAAwB,CAAtC,CAAR;;AAEA,UAAIV,QAAQlnB,KAAR,EAAeD,MAAMof,QAAQ3Y,CAAd,CAAf,IAAmC,CAAvC,EAA0C;AACxCxC,iBAASwC,CAAT;AACD,OAFD,MAEO;AACLohB,qBAAaphB,IAAI,CAAjB;AACD;AACF;;AAED,WAAOxC,MAAP;AACD;;AAED,WAASgkB,OAAT,CAAiBjoB,KAAjB,EAAwBmnB,OAAxB,EAAiC;AAC/B,QAAIe,YAAYrB,qBAAhB;AACA,QAAIsB,QAAJ;AACA,QAAIC,SAAJ;AACA,QAAIC,YAAY,CAAhB;AACA,QAAIN,MAAM,EAAV;AACAI,eAAW,EAAX;AACAC,gBAAY,EAAZ;;AAEA,aAASE,OAAT,CAAiBC,SAAjB,EAA4BC,UAA5B,EAAwC;AACtCL,eAASE,SAAT,IAAsBE,SAAtB;AACAH,gBAAUC,SAAV,IAAuBG,UAAvB;AACAH,mBAAa,CAAb;AACD;;AAED,aAASI,SAAT,GAAqB;AACnB,aAAOJ,YAAY,CAAnB,EAAsB;AACpB,YAAItB,IAAIsB,YAAY,CAApB;;AAEA,YAAItB,KAAK,CAAL,IAAUqB,UAAUrB,IAAI,CAAd,KAAoBqB,UAAUrB,CAAV,IAAeqB,UAAUrB,IAAI,CAAd,CAA7C,IAAiEA,KAAK,CAAL,IAAUqB,UAAUrB,IAAI,CAAd,KAAoBqB,UAAUrB,CAAV,IAAeqB,UAAUrB,IAAI,CAAd,CAAlH,EAAoI;AAClI,cAAIqB,UAAUrB,IAAI,CAAd,IAAmBqB,UAAUrB,IAAI,CAAd,CAAvB,EAAyC;AACvCA;AACD;AACF,SAJD,MAIO,IAAIqB,UAAUrB,CAAV,IAAeqB,UAAUrB,IAAI,CAAd,CAAnB,EAAqC;AAC1C;AACD;;AAED2B,gBAAQ3B,CAAR;AACD;AACF;;AAED,aAAS4B,cAAT,GAA0B;AACxB,aAAON,YAAY,CAAnB,EAAsB;AACpB,YAAItB,IAAIsB,YAAY,CAApB;;AAEA,YAAItB,IAAI,CAAJ,IAASqB,UAAUrB,IAAI,CAAd,IAAmBqB,UAAUrB,IAAI,CAAd,CAAhC,EAAkD;AAChDA;AACD;;AAED2B,gBAAQ3B,CAAR;AACD;AACF;;AAED,aAAS2B,OAAT,CAAiBlqB,CAAjB,EAAoB;AAClB,UAAIoqB,SAAST,SAAS3pB,CAAT,CAAb;AACA,UAAIqqB,UAAUT,UAAU5pB,CAAV,CAAd;AACA,UAAIsqB,SAASX,SAAS3pB,IAAI,CAAb,CAAb;AACA,UAAIuqB,UAAUX,UAAU5pB,IAAI,CAAd,CAAd;AACA4pB,gBAAU5pB,CAAV,IAAeqqB,UAAUE,OAAzB;;AAEA,UAAIvqB,MAAM6pB,YAAY,CAAtB,EAAyB;AACvBF,iBAAS3pB,IAAI,CAAb,IAAkB2pB,SAAS3pB,IAAI,CAAb,CAAlB;AACA4pB,kBAAU5pB,IAAI,CAAd,IAAmB4pB,UAAU5pB,IAAI,CAAd,CAAnB;AACD;;AAED6pB;AACA,UAAI7W,IAAIwW,YAAYhoB,MAAM8oB,MAAN,CAAZ,EAA2B9oB,KAA3B,EAAkC4oB,MAAlC,EAA0CC,OAA1C,EAAmD,CAAnD,EAAsD1B,OAAtD,CAAR;AACAyB,gBAAUpX,CAAV;AACAqX,iBAAWrX,CAAX;;AAEA,UAAIqX,YAAY,CAAhB,EAAmB;AACjB;AACD;;AAEDE,gBAAUpB,WAAW3nB,MAAM4oB,SAASC,OAAT,GAAmB,CAAzB,CAAX,EAAwC7oB,KAAxC,EAA+C8oB,MAA/C,EAAuDC,OAAvD,EAAgEA,UAAU,CAA1E,EAA6E5B,OAA7E,CAAV;;AAEA,UAAI4B,YAAY,CAAhB,EAAmB;AACjB;AACD;;AAED,UAAIF,WAAWE,OAAf,EAAwB;AACtBC,iBAASJ,MAAT,EAAiBC,OAAjB,EAA0BC,MAA1B,EAAkCC,OAAlC;AACD,OAFD,MAEO;AACLE,kBAAUL,MAAV,EAAkBC,OAAlB,EAA2BC,MAA3B,EAAmCC,OAAnC;AACD;AACF;;AAED,aAASC,QAAT,CAAkBJ,MAAlB,EAA0BC,OAA1B,EAAmCC,MAAnC,EAA2CC,OAA3C,EAAoD;AAClD,UAAIvqB,IAAI,CAAR;;AAEA,WAAKA,IAAI,CAAT,EAAYA,IAAIqqB,OAAhB,EAAyBrqB,GAAzB,EAA8B;AAC5BupB,YAAIvpB,CAAJ,IAASwB,MAAM4oB,SAASpqB,CAAf,CAAT;AACD;;AAED,UAAI0qB,UAAU,CAAd;AACA,UAAIC,UAAUL,MAAd;AACA,UAAIM,OAAOR,MAAX;AACA5oB,YAAMopB,MAAN,IAAgBppB,MAAMmpB,SAAN,CAAhB;;AAEA,UAAI,EAAEJ,OAAF,KAAc,CAAlB,EAAqB;AACnB,aAAKvqB,IAAI,CAAT,EAAYA,IAAIqqB,OAAhB,EAAyBrqB,GAAzB,EAA8B;AAC5BwB,gBAAMopB,OAAO5qB,CAAb,IAAkBupB,IAAImB,UAAU1qB,CAAd,CAAlB;AACD;;AAED;AACD;;AAED,UAAIqqB,YAAY,CAAhB,EAAmB;AACjB,aAAKrqB,IAAI,CAAT,EAAYA,IAAIuqB,OAAhB,EAAyBvqB,GAAzB,EAA8B;AAC5BwB,gBAAMopB,OAAO5qB,CAAb,IAAkBwB,MAAMmpB,UAAU3qB,CAAhB,CAAlB;AACD;;AAEDwB,cAAMopB,OAAOL,OAAb,IAAwBhB,IAAImB,OAAJ,CAAxB;AACA;AACD;;AAED,UAAIG,aAAanB,SAAjB;AACA,UAAIoB,MAAJ,EAAYC,MAAZ,EAAoBC,IAApB;;AAEA,aAAO,CAAP,EAAU;AACRF,iBAAS,CAAT;AACAC,iBAAS,CAAT;AACAC,eAAO,KAAP;;AAEA,WAAG;AACD,cAAIrC,QAAQnnB,MAAMmpB,OAAN,CAAR,EAAwBpB,IAAImB,OAAJ,CAAxB,IAAwC,CAA5C,EAA+C;AAC7ClpB,kBAAMopB,MAAN,IAAgBppB,MAAMmpB,SAAN,CAAhB;AACAI;AACAD,qBAAS,CAAT;;AAEA,gBAAI,EAAEP,OAAF,KAAc,CAAlB,EAAqB;AACnBS,qBAAO,IAAP;AACA;AACD;AACF,WATD,MASO;AACLxpB,kBAAMopB,MAAN,IAAgBrB,IAAImB,SAAJ,CAAhB;AACAI;AACAC,qBAAS,CAAT;;AAEA,gBAAI,EAAEV,OAAF,KAAc,CAAlB,EAAqB;AACnBW,qBAAO,IAAP;AACA;AACD;AACF;AACF,SApBD,QAoBS,CAACF,SAASC,MAAV,IAAoBF,UApB7B;;AAsBA,YAAIG,IAAJ,EAAU;AACR;AACD;;AAED,WAAG;AACDF,mBAAStB,YAAYhoB,MAAMmpB,OAAN,CAAZ,EAA4BpB,GAA5B,EAAiCmB,OAAjC,EAA0CL,OAA1C,EAAmD,CAAnD,EAAsD1B,OAAtD,CAAT;;AAEA,cAAImC,WAAW,CAAf,EAAkB;AAChB,iBAAK9qB,IAAI,CAAT,EAAYA,IAAI8qB,MAAhB,EAAwB9qB,GAAxB,EAA6B;AAC3BwB,oBAAMopB,OAAO5qB,CAAb,IAAkBupB,IAAImB,UAAU1qB,CAAd,CAAlB;AACD;;AAED4qB,oBAAQE,MAAR;AACAJ,uBAAWI,MAAX;AACAT,uBAAWS,MAAX;;AAEA,gBAAIT,WAAW,CAAf,EAAkB;AAChBW,qBAAO,IAAP;AACA;AACD;AACF;;AAEDxpB,gBAAMopB,MAAN,IAAgBppB,MAAMmpB,SAAN,CAAhB;;AAEA,cAAI,EAAEJ,OAAF,KAAc,CAAlB,EAAqB;AACnBS,mBAAO,IAAP;AACA;AACD;;AAEDD,mBAAS5B,WAAWI,IAAImB,OAAJ,CAAX,EAAyBlpB,KAAzB,EAAgCmpB,OAAhC,EAAyCJ,OAAzC,EAAkD,CAAlD,EAAqD5B,OAArD,CAAT;;AAEA,cAAIoC,WAAW,CAAf,EAAkB;AAChB,iBAAK/qB,IAAI,CAAT,EAAYA,IAAI+qB,MAAhB,EAAwB/qB,GAAxB,EAA6B;AAC3BwB,oBAAMopB,OAAO5qB,CAAb,IAAkBwB,MAAMmpB,UAAU3qB,CAAhB,CAAlB;AACD;;AAED4qB,oBAAQG,MAAR;AACAJ,uBAAWI,MAAX;AACAR,uBAAWQ,MAAX;;AAEA,gBAAIR,YAAY,CAAhB,EAAmB;AACjBS,qBAAO,IAAP;AACA;AACD;AACF;;AAEDxpB,gBAAMopB,MAAN,IAAgBrB,IAAImB,SAAJ,CAAhB;;AAEA,cAAI,EAAEL,OAAF,KAAc,CAAlB,EAAqB;AACnBW,mBAAO,IAAP;AACA;AACD;;AAEDH;AACD,SAlDD,QAkDSC,UAAUzC,qBAAV,IAAmC0C,UAAU1C,qBAlDtD;;AAoDA,YAAI2C,IAAJ,EAAU;AACR;AACD;;AAED,YAAIH,aAAa,CAAjB,EAAoB;AAClBA,uBAAa,CAAb;AACD;;AAEDA,sBAAc,CAAd;AACD;;AAEDnB,kBAAYmB,UAAZ;AACAnB,kBAAY,CAAZ,KAAkBA,YAAY,CAA9B;;AAEA,UAAIW,YAAY,CAAhB,EAAmB;AACjB,aAAKrqB,IAAI,CAAT,EAAYA,IAAIuqB,OAAhB,EAAyBvqB,GAAzB,EAA8B;AAC5BwB,gBAAMopB,OAAO5qB,CAAb,IAAkBwB,MAAMmpB,UAAU3qB,CAAhB,CAAlB;AACD;;AAEDwB,cAAMopB,OAAOL,OAAb,IAAwBhB,IAAImB,OAAJ,CAAxB;AACD,OAND,MAMO,IAAIL,YAAY,CAAhB,EAAmB;AACxB,cAAM,IAAI/lB,KAAJ,EAAN,CADwB,CACL;AACpB,OAFM,MAEA;AACL,aAAKtE,IAAI,CAAT,EAAYA,IAAIqqB,OAAhB,EAAyBrqB,GAAzB,EAA8B;AAC5BwB,gBAAMopB,OAAO5qB,CAAb,IAAkBupB,IAAImB,UAAU1qB,CAAd,CAAlB;AACD;AACF;AACF;;AAED,aAASyqB,SAAT,CAAmBL,MAAnB,EAA2BC,OAA3B,EAAoCC,MAApC,EAA4CC,OAA5C,EAAqD;AACnD,UAAIvqB,IAAI,CAAR;;AAEA,WAAKA,IAAI,CAAT,EAAYA,IAAIuqB,OAAhB,EAAyBvqB,GAAzB,EAA8B;AAC5BupB,YAAIvpB,CAAJ,IAASwB,MAAM8oB,SAAStqB,CAAf,CAAT;AACD;;AAED,UAAI0qB,UAAUN,SAASC,OAAT,GAAmB,CAAjC;AACA,UAAIM,UAAUJ,UAAU,CAAxB;AACA,UAAIK,OAAON,SAASC,OAAT,GAAmB,CAA9B;AACA,UAAIU,eAAe,CAAnB;AACA,UAAIC,aAAa,CAAjB;AACA1pB,YAAMopB,MAAN,IAAgBppB,MAAMkpB,SAAN,CAAhB;;AAEA,UAAI,EAAEL,OAAF,KAAc,CAAlB,EAAqB;AACnBY,uBAAeL,QAAQL,UAAU,CAAlB,CAAf;;AAEA,aAAKvqB,IAAI,CAAT,EAAYA,IAAIuqB,OAAhB,EAAyBvqB,GAAzB,EAA8B;AAC5BwB,gBAAMypB,eAAejrB,CAArB,IAA0BupB,IAAIvpB,CAAJ,CAA1B;AACD;;AAED;AACD;;AAED,UAAIuqB,YAAY,CAAhB,EAAmB;AACjBK,gBAAQP,OAAR;AACAK,mBAAWL,OAAX;AACAa,qBAAaN,OAAO,CAApB;AACAK,uBAAeP,UAAU,CAAzB;;AAEA,aAAK1qB,IAAIqqB,UAAU,CAAnB,EAAsBrqB,KAAK,CAA3B,EAA8BA,GAA9B,EAAmC;AACjCwB,gBAAM0pB,aAAalrB,CAAnB,IAAwBwB,MAAMypB,eAAejrB,CAArB,CAAxB;AACD;;AAEDwB,cAAMopB,IAAN,IAAcrB,IAAIoB,OAAJ,CAAd;AACA;AACD;;AAED,UAAIE,aAAanB,SAAjB;;AAEA,aAAO,IAAP,EAAa;AACX,YAAIoB,SAAS,CAAb;AACA,YAAIC,SAAS,CAAb;AACA,YAAIC,OAAO,KAAX;;AAEA,WAAG;AACD,cAAIrC,QAAQY,IAAIoB,OAAJ,CAAR,EAAsBnpB,MAAMkpB,OAAN,CAAtB,IAAwC,CAA5C,EAA+C;AAC7ClpB,kBAAMopB,MAAN,IAAgBppB,MAAMkpB,SAAN,CAAhB;AACAI;AACAC,qBAAS,CAAT;;AAEA,gBAAI,EAAEV,OAAF,KAAc,CAAlB,EAAqB;AACnBW,qBAAO,IAAP;AACA;AACD;AACF,WATD,MASO;AACLxpB,kBAAMopB,MAAN,IAAgBrB,IAAIoB,SAAJ,CAAhB;AACAI;AACAD,qBAAS,CAAT;;AAEA,gBAAI,EAAEP,OAAF,KAAc,CAAlB,EAAqB;AACnBS,qBAAO,IAAP;AACA;AACD;AACF;AACF,SApBD,QAoBS,CAACF,SAASC,MAAV,IAAoBF,UApB7B;;AAsBA,YAAIG,IAAJ,EAAU;AACR;AACD;;AAED,WAAG;AACDF,mBAAST,UAAUb,YAAYD,IAAIoB,OAAJ,CAAZ,EAA0BnpB,KAA1B,EAAiC4oB,MAAjC,EAAyCC,OAAzC,EAAkDA,UAAU,CAA5D,EAA+D1B,OAA/D,CAAnB;;AAEA,cAAImC,WAAW,CAAf,EAAkB;AAChBF,oBAAQE,MAAR;AACAJ,uBAAWI,MAAX;AACAT,uBAAWS,MAAX;AACAI,yBAAaN,OAAO,CAApB;AACAK,2BAAeP,UAAU,CAAzB;;AAEA,iBAAK1qB,IAAI8qB,SAAS,CAAlB,EAAqB9qB,KAAK,CAA1B,EAA6BA,GAA7B,EAAkC;AAChCwB,oBAAM0pB,aAAalrB,CAAnB,IAAwBwB,MAAMypB,eAAejrB,CAArB,CAAxB;AACD;;AAED,gBAAIqqB,YAAY,CAAhB,EAAmB;AACjBW,qBAAO,IAAP;AACA;AACD;AACF;;AAEDxpB,gBAAMopB,MAAN,IAAgBrB,IAAIoB,SAAJ,CAAhB;;AAEA,cAAI,EAAEJ,OAAF,KAAc,CAAlB,EAAqB;AACnBS,mBAAO,IAAP;AACA;AACD;;AAEDD,mBAASR,UAAUpB,WAAW3nB,MAAMkpB,OAAN,CAAX,EAA2BnB,GAA3B,EAAgC,CAAhC,EAAmCgB,OAAnC,EAA4CA,UAAU,CAAtD,EAAyD5B,OAAzD,CAAnB;;AAEA,cAAIoC,WAAW,CAAf,EAAkB;AAChBH,oBAAQG,MAAR;AACAJ,uBAAWI,MAAX;AACAR,uBAAWQ,MAAX;AACAG,yBAAaN,OAAO,CAApB;AACAK,2BAAeN,UAAU,CAAzB;;AAEA,iBAAK3qB,IAAI,CAAT,EAAYA,IAAI+qB,MAAhB,EAAwB/qB,GAAxB,EAA6B;AAC3BwB,oBAAM0pB,aAAalrB,CAAnB,IAAwBupB,IAAI0B,eAAejrB,CAAnB,CAAxB;AACD;;AAED,gBAAIuqB,WAAW,CAAf,EAAkB;AAChBS,qBAAO,IAAP;AACA;AACD;AACF;;AAEDxpB,gBAAMopB,MAAN,IAAgBppB,MAAMkpB,SAAN,CAAhB;;AAEA,cAAI,EAAEL,OAAF,KAAc,CAAlB,EAAqB;AACnBW,mBAAO,IAAP;AACA;AACD;;AAEDH;AACD,SAtDD,QAsDSC,UAAUzC,qBAAV,IAAmC0C,UAAU1C,qBAtDtD;;AAwDA,YAAI2C,IAAJ,EAAU;AACR;AACD;;AAED,YAAIH,aAAa,CAAjB,EAAoB;AAClBA,uBAAa,CAAb;AACD;;AAEDA,sBAAc,CAAd;AACD;;AAEDnB,kBAAYmB,UAAZ;;AAEA,UAAInB,YAAY,CAAhB,EAAmB;AACjBA,oBAAY,CAAZ;AACD;;AAED,UAAIa,YAAY,CAAhB,EAAmB;AACjBK,gBAAQP,OAAR;AACAK,mBAAWL,OAAX;AACAa,qBAAaN,OAAO,CAApB;AACAK,uBAAeP,UAAU,CAAzB;;AAEA,aAAK1qB,IAAIqqB,UAAU,CAAnB,EAAsBrqB,KAAK,CAA3B,EAA8BA,GAA9B,EAAmC;AACjCwB,gBAAM0pB,aAAalrB,CAAnB,IAAwBwB,MAAMypB,eAAejrB,CAArB,CAAxB;AACD;;AAEDwB,cAAMopB,IAAN,IAAcrB,IAAIoB,OAAJ,CAAd;AACD,OAXD,MAWO,IAAIJ,YAAY,CAAhB,EAAmB;AACxB,cAAM,IAAIjmB,KAAJ,EAAN,CADwB,CACL;AACpB,OAFM,MAEA;AACL2mB,uBAAeL,QAAQL,UAAU,CAAlB,CAAf;;AAEA,aAAKvqB,IAAI,CAAT,EAAYA,IAAIuqB,OAAhB,EAAyBvqB,GAAzB,EAA8B;AAC5BwB,gBAAMypB,eAAejrB,CAArB,IAA0BupB,IAAIvpB,CAAJ,CAA1B;AACD;AACF;AACF;;AAED,SAAKiqB,SAAL,GAAiBA,SAAjB;AACA,SAAKE,cAAL,GAAsBA,cAAtB;AACA,SAAKL,OAAL,GAAeA,OAAf;AACD;;AAED,WAAS3J,IAAT,CAAc3e,KAAd,EAAqBmnB,OAArB,EAA8BF,EAA9B,EAAkCC,EAAlC,EAAsC;AACpC,QAAI,CAACD,EAAL,EAAS;AACPA,WAAK,CAAL;AACD;;AAED,QAAI,CAACC,EAAL,EAAS;AACPA,WAAKlnB,MAAMtB,MAAX;AACD;;AAED,QAAIirB,YAAYzC,KAAKD,EAArB;;AAEA,QAAI0C,YAAY,CAAhB,EAAmB;AACjB;AACD;;AAED,QAAIvB,YAAY,CAAhB;;AAEA,QAAIuB,YAAY/C,iBAAhB,EAAmC;AACjCwB,kBAAYpB,iBAAiBhnB,KAAjB,EAAwBinB,EAAxB,EAA4BC,EAA5B,EAAgCC,OAAhC,CAAZ;AACAG,0BAAoBtnB,KAApB,EAA2BinB,EAA3B,EAA+BC,EAA/B,EAAmCD,KAAKmB,SAAxC,EAAmDjB,OAAnD;AACA;AACD;;AAED,QAAIyC,KAAK,IAAI3B,OAAJ,CAAYjoB,KAAZ,EAAmBmnB,OAAnB,CAAT;AACA,QAAI0C,SAAS/C,aAAa6C,SAAb,CAAb;;AAEA,OAAG;AACDvB,kBAAYpB,iBAAiBhnB,KAAjB,EAAwBinB,EAAxB,EAA4BC,EAA5B,EAAgCC,OAAhC,CAAZ;;AAEA,UAAIiB,YAAYyB,MAAhB,EAAwB;AACtB,YAAIC,QAAQH,SAAZ;;AAEA,YAAIG,QAAQD,MAAZ,EAAoB;AAClBC,kBAAQD,MAAR;AACD;;AAEDvC,4BAAoBtnB,KAApB,EAA2BinB,EAA3B,EAA+BA,KAAK6C,KAApC,EAA2C7C,KAAKmB,SAAhD,EAA2DjB,OAA3D;AACAiB,oBAAY0B,KAAZ;AACD;;AAEDF,SAAGtB,OAAH,CAAWrB,EAAX,EAAemB,SAAf;AACAwB,SAAGnB,SAAH;AACAkB,mBAAavB,SAAb;AACAnB,YAAMmB,SAAN;AACD,KAlBD,QAkBSuB,cAAc,CAlBvB;;AAoBAC,OAAGjB,cAAH;AACD;;AAED;;AAEA,WAASoB,gBAAT,CAA0BjmB,CAA1B,EAA6BC,CAA7B,EAAgC;AAC9B,QAAID,EAAEkmB,MAAF,KAAajmB,EAAEimB,MAAnB,EAA2B;AACzB,UAAIlmB,EAAEmmB,CAAF,KAAQlmB,EAAEkmB,CAAd,EAAiB;AACf;AACA;AACA;AACA;AACA;AACA;AACA,eAAOnmB,EAAEomB,EAAF,GAAOnmB,EAAEmmB,EAAhB;AACD;;AAED,aAAOpmB,EAAEmmB,CAAF,GAAMlmB,EAAEkmB,CAAf;AACD;;AAED,WAAOnmB,EAAEkmB,MAAF,GAAWjmB,EAAEimB,MAApB;AACD;AACD;;;;;;AAOA,MAAIG,UAAU,SAAVA,OAAU,GAAY;AACxB;AACA,SAAKC,MAAL,GAAc,EAAd;AACA,SAAKC,YAAL,GAAoB,EAApB;AACA,SAAKC,eAAL,GAAuB,CAAvB;AACD,GALD;;AAOAH,UAAQptB,SAAR,GAAoB;AAClB6B,iBAAaurB,OADK;;AAGlB;;;;AAIArH,cAAU,kBAAUhiB,EAAV,EAAcC,OAAd,EAAuB;AAC/B,WAAK,IAAIvC,IAAI,CAAb,EAAgBA,IAAI,KAAK4rB,MAAL,CAAY1rB,MAAhC,EAAwCF,GAAxC,EAA6C;AAC3C,aAAK4rB,MAAL,CAAY5rB,CAAZ,EAAeskB,QAAf,CAAwBhiB,EAAxB,EAA4BC,OAA5B;AACD;AACF,KAXiB;;AAalB;;;;;;;;AAQAgM,oBAAgB,wBAAU8V,MAAV,EAAkB0H,aAAlB,EAAiC;AAC/CA,sBAAgBA,iBAAiB,KAAjC;;AAEA,UAAI1H,MAAJ,EAAY;AACV,aAAK2H,iBAAL,CAAuBD,aAAvB;AACD;;AAED,aAAO,KAAKF,YAAZ;AACD,KA7BiB;;AA+BlB;;;;;;AAMAG,uBAAmB,2BAAUD,aAAV,EAAyB;AAC1C,WAAKD,eAAL,GAAuB,CAAvB;AACA,UAAIG,QAAQ,KAAKL,MAAjB;AACA,UAAIM,cAAc,KAAKL,YAAvB;;AAEA,WAAK,IAAI7rB,IAAI,CAAR,EAAWC,MAAMgsB,MAAM/rB,MAA5B,EAAoCF,IAAIC,GAAxC,EAA6CD,GAA7C,EAAkD;AAChD,aAAKmsB,wBAAL,CAA8BF,MAAMjsB,CAAN,CAA9B,EAAwC,IAAxC,EAA8C+rB,aAA9C;AACD;;AAEDG,kBAAYhsB,MAAZ,GAAqB,KAAK4rB,eAA1B;AACAzuB,YAAMT,eAAN,IAAyBujB,KAAK+L,WAAL,EAAkBX,gBAAlB,CAAzB;AACD,KAhDiB;AAiDlBY,8BAA0B,kCAAUre,EAAV,EAAcse,SAAd,EAAyBL,aAAzB,EAAwC;AAChE,UAAIje,GAAGW,MAAH,IAAa,CAACsd,aAAlB,EAAiC;AAC/B;AACD;;AAEDje,SAAGqW,YAAH;;AAEA,UAAIrW,GAAGgZ,OAAP,EAAgB;AACdhZ,WAAGuW,MAAH;AACD;;AAEDvW,SAAGsW,WAAH;AACA,UAAIiI,kBAAkBve,GAAGkB,QAAzB;;AAEA,UAAIqd,eAAJ,EAAqB;AACnB;AACA,YAAID,SAAJ,EAAe;AACbA,sBAAYA,UAAUptB,KAAV,EAAZ;AACD,SAFD,MAEO;AACLotB,sBAAY,EAAZ;AACD;;AAED,YAAIE,kBAAkBD,eAAtB;AACA,YAAIE,iBAAiBze,EAArB,CATmB,CASM;;AAEzB,eAAOwe,eAAP,EAAwB;AACtB;AACAA,0BAAgBpe,MAAhB,GAAyBqe,cAAzB;AACAD,0BAAgBxa,eAAhB;AACAsa,oBAAU5pB,IAAV,CAAe8pB,eAAf;AACAC,2BAAiBD,eAAjB;AACAA,4BAAkBA,gBAAgBtd,QAAlC;AACD;AACF;;AAED,UAAIlB,GAAGoW,OAAP,EAAgB;AACd,YAAI6C,WAAWjZ,GAAG8Y,SAAlB;;AAEA,aAAK,IAAI5mB,IAAI,CAAb,EAAgBA,IAAI+mB,SAAS7mB,MAA7B,EAAqCF,GAArC,EAA0C;AACxC,cAAIonB,QAAQL,SAAS/mB,CAAT,CAAZ,CADwC,CACf;AACzB;;AAEA,cAAI8N,GAAGgZ,OAAP,EAAgB;AACdM,kBAAMN,OAAN,GAAgB,IAAhB;AACD;;AAED,eAAKqF,wBAAL,CAA8B/E,KAA9B,EAAqCgF,SAArC,EAAgDL,aAAhD;AACD,SAZa,CAYZ;;;AAGFje,WAAGgZ,OAAH,GAAa,KAAb;AACD,OAhBD,MAgBO;AACLhZ,WAAG0e,WAAH,GAAiBJ,SAAjB;AACA,aAAKP,YAAL,CAAkB,KAAKC,eAAL,EAAlB,IAA4Che,EAA5C;AACD;AACF,KAxGiB;;AA0GlB;;;;AAIA2e,aAAS,iBAAU3e,EAAV,EAAc;AACrB,UAAIA,GAAG+Y,SAAH,KAAiB,IAArB,EAA2B;AACzB;AACD;;AAED,UAAI/Y,cAAc6Y,KAAlB,EAAyB;AACvB7Y,WAAG2Z,oBAAH,CAAwB,IAAxB;AACD;;AAED,WAAKD,YAAL,CAAkB1Z,EAAlB;;AAEA,WAAK8d,MAAL,CAAYppB,IAAZ,CAAiBsL,EAAjB;AACD,KA1HiB;;AA4HlB;;;;AAIA4e,aAAS,iBAAU5e,EAAV,EAAc;AACrB,UAAIA,MAAM,IAAV,EAAgB;AACd;AACA,aAAK,IAAI9N,IAAI,CAAb,EAAgBA,IAAI,KAAK4rB,MAAL,CAAY1rB,MAAhC,EAAwCF,GAAxC,EAA6C;AAC3C,cAAI2sB,OAAO,KAAKf,MAAL,CAAY5rB,CAAZ,CAAX;;AAEA,cAAI2sB,gBAAgBhG,KAApB,EAA2B;AACzBgG,iBAAKhF,sBAAL,CAA4B,IAA5B;AACD;AACF;;AAED,aAAKiE,MAAL,GAAc,EAAd;AACA,aAAKC,YAAL,GAAoB,EAApB;AACA,aAAKC,eAAL,GAAuB,CAAvB;AACA;AACD;;AAED,UAAIhe,cAAcpP,KAAlB,EAAyB;AACvB,aAAK,IAAIsB,IAAI,CAAR,EAAWyK,IAAIqD,GAAG5N,MAAvB,EAA+BF,IAAIyK,CAAnC,EAAsCzK,GAAtC,EAA2C;AACzC,eAAK0sB,OAAL,CAAa5e,GAAG9N,CAAH,CAAb;AACD;;AAED;AACD;;AAED,UAAIinB,MAAM1lB,QAAQ,KAAKqqB,MAAb,EAAqB9d,EAArB,CAAV;;AAEA,UAAImZ,OAAO,CAAX,EAAc;AACZ,aAAKS,cAAL,CAAoB5Z,EAApB;;AAEA,aAAK8d,MAAL,CAAYhhB,MAAZ,CAAmBqc,GAAnB,EAAwB,CAAxB;;AAEA,YAAInZ,cAAc6Y,KAAlB,EAAyB;AACvB7Y,aAAG6Z,sBAAH,CAA0B,IAA1B;AACD;AACF;AACF,KApKiB;AAqKlBH,kBAAc,sBAAU1Z,EAAV,EAAc;AAC1B,UAAIA,EAAJ,EAAQ;AACNA,WAAG+Y,SAAH,GAAe,IAAf;AACA/Y,WAAG0V,KAAH,CAAS,KAAT;AACD;;AAED,aAAO,IAAP;AACD,KA5KiB;AA6KlBkE,oBAAgB,wBAAU5Z,EAAV,EAAc;AAC5B,UAAIA,EAAJ,EAAQ;AACNA,WAAG+Y,SAAH,GAAe,IAAf;AACD;;AAED,aAAO,IAAP;AACD,KAnLiB;;AAqLlB;;;AAGA/a,aAAS,mBAAY;AACnB,WAAK8gB,WAAL,GAAmB,KAAKhB,MAAL,GAAc,IAAjC;AACD,KA1LiB;AA2LlBiB,yBAAqBtB;AA3LH,GAApB;;AA8LA,MAAIuB,eAAe;AACjB,kBAAc,CADG;AAEjB,qBAAiB,CAFA;AAGjB,qBAAiB,CAHA;AAIjB,sBAAkB,CAJD;AAKjB,yBAAqB,CALJ;AAMjB,yBAAqB,CANJ;AAOjB,yBAAqB,CAPJ;AAQjB,4BAAwB,CARP;AASjB,4BAAwB;AATP,GAAnB;AAWA,MAAIC,YAAY,SAAZA,SAAY,CAAU1iB,GAAV,EAAeiV,QAAf,EAAyB7d,KAAzB,EAAgC;AAC9C,QAAIqrB,aAAatsB,cAAb,CAA4B8e,QAA5B,CAAJ,EAA2C;AACzC,aAAO7d,SAAS4I,IAAI8H,GAApB;AACD;;AAED,WAAO1Q,KAAP;AACD,GAND;;AAQA,MAAIurB,qBAAqB,CAAC,CAAC,YAAD,EAAe,CAAf,CAAD,EAAoB,CAAC,eAAD,EAAkB,CAAlB,CAApB,EAA0C,CAAC,eAAD,EAAkB,CAAlB,CAA1C,EAAgE,CAAC,aAAD,EAAgB,MAAhB,CAAhE,EAAyF,CAAC,SAAD,EAAY,MAAZ,CAAzF,EAA8G,CAAC,UAAD,EAAa,OAAb,CAA9G,EAAqI,CAAC,YAAD,EAAe,EAAf,CAArI,CAAzB,CA5+L4B,CA4+LuJ;AACnL;;AAEA,MAAIC,QAAQ,SAARA,KAAQ,CAAU1b,IAAV,EAAgB2b,IAAhB,EAAsB;AAChC,SAAKC,UAAL,CAAgB5b,IAAhB,EAAsB,KAAtB;AACA,SAAK2b,IAAL,GAAYA,IAAZ;AACD,GAHD;;AAKA,WAASE,oBAAT,CAA8B/iB,GAA9B,EAAmChI,GAAnC,EAAwCokB,IAAxC,EAA8C;AAC5C,QAAItgB,IAAI9D,IAAI8D,CAAJ,IAAS,IAAT,GAAgB,CAAhB,GAAoB9D,IAAI8D,CAAhC;AACA,QAAIknB,KAAKhrB,IAAIgrB,EAAJ,IAAU,IAAV,GAAiB,CAAjB,GAAqBhrB,IAAIgrB,EAAlC;AACA,QAAIjnB,IAAI/D,IAAI+D,CAAJ,IAAS,IAAT,GAAgB,CAAhB,GAAoB/D,IAAI+D,CAAhC;AACA,QAAIknB,KAAKjrB,IAAIirB,EAAJ,IAAU,IAAV,GAAiB,CAAjB,GAAqBjrB,IAAIirB,EAAlC;;AAEA,QAAI,CAACjrB,IAAIzG,MAAT,EAAiB;AACfuK,UAAIA,IAAIsgB,KAAKpB,KAAT,GAAiBoB,KAAKtgB,CAA1B;AACAknB,WAAKA,KAAK5G,KAAKpB,KAAV,GAAkBoB,KAAKtgB,CAA5B;AACAC,UAAIA,IAAIqgB,KAAKnB,MAAT,GAAkBmB,KAAKrgB,CAA3B;AACAknB,WAAKA,KAAK7G,KAAKnB,MAAV,GAAmBmB,KAAKrgB,CAA7B;AACD,KAX2C,CAW1C;;;AAGFD,QAAIgY,MAAMhY,CAAN,IAAW,CAAX,GAAeA,CAAnB;AACAknB,SAAKlP,MAAMkP,EAAN,IAAY,CAAZ,GAAgBA,EAArB;AACAjnB,QAAI+X,MAAM/X,CAAN,IAAW,CAAX,GAAeA,CAAnB;AACAknB,SAAKnP,MAAMmP,EAAN,IAAY,CAAZ,GAAgBA,EAArB;AACA,QAAIC,iBAAiBljB,IAAI+iB,oBAAJ,CAAyBjnB,CAAzB,EAA4BC,CAA5B,EAA+BinB,EAA/B,EAAmCC,EAAnC,CAArB;AACA,WAAOC,cAAP;AACD;;AAED,WAASC,oBAAT,CAA8BnjB,GAA9B,EAAmChI,GAAnC,EAAwCokB,IAAxC,EAA8C;AAC5C,QAAIpB,QAAQoB,KAAKpB,KAAjB;AACA,QAAIC,SAASmB,KAAKnB,MAAlB;AACA,QAAIpd,MAAMpB,KAAKoB,GAAL,CAASmd,KAAT,EAAgBC,MAAhB,CAAV;AACA,QAAInf,IAAI9D,IAAI8D,CAAJ,IAAS,IAAT,GAAgB,GAAhB,GAAsB9D,IAAI8D,CAAlC;AACA,QAAIC,IAAI/D,IAAI+D,CAAJ,IAAS,IAAT,GAAgB,GAAhB,GAAsB/D,IAAI+D,CAAlC;AACA,QAAImT,IAAIlX,IAAIkX,CAAJ,IAAS,IAAT,GAAgB,GAAhB,GAAsBlX,IAAIkX,CAAlC;;AAEA,QAAI,CAAClX,IAAIzG,MAAT,EAAiB;AACfuK,UAAIA,IAAIkf,KAAJ,GAAYoB,KAAKtgB,CAArB;AACAC,UAAIA,IAAIkf,MAAJ,GAAamB,KAAKrgB,CAAtB;AACAmT,UAAIA,IAAIrR,GAAR;AACD;;AAED,QAAIqlB,iBAAiBljB,IAAImjB,oBAAJ,CAAyBrnB,CAAzB,EAA4BC,CAA5B,EAA+B,CAA/B,EAAkCD,CAAlC,EAAqCC,CAArC,EAAwCmT,CAAxC,CAArB;AACA,WAAOgU,cAAP;AACD;;AAEDN,QAAM1uB,SAAN,GAAkB;AAChB6B,iBAAa6sB,KADG;;AAGhB;;;AAGAC,UAAM,IANU;;AAQhB;;;AAGAO,UAAM,MAXU;;AAahB;;;AAGAC,YAAQ,IAhBQ;;AAkBhB;;;AAGAC,aAAS,CArBO;;AAuBhB;;;AAGAC,cAAU,IA1BM;;AA4BhB;;;AAGAC,oBAAgB,CA/BA;;AAiChB;;;AAGAC,gBAAY,CApCI;;AAsChB;;;AAGAC,mBAAe,CAzCC;;AA2ChB;;;AAGAC,mBAAe,CA9CC;;AAgDhB;;;AAGAC,eAAW,CAnDK;;AAqDhB;;;;AAIAC,mBAAe,KAzDC;AA0DhB;AACA;;AAEA;;;AAGAC,UAAM,IAhEU;;AAkEhB;;;;;;;AAOAC,UAAM,IAzEU;;AA2EhB;;;;;AAKAC,cAAU,IAhFM;;AAkFhB;;;;AAIAC,eAAW,IAtFK;;AAwFhB;;;;AAIAC,gBAAY,IA5FI;;AA8FhB;;;;;AAKAC,cAAU,IAnGM;;AAqGhB;;;;AAIAC,gBAAY,IAzGI;;AA2GhB;;;;AAIAC,aAAS,IA/GO;;AAiHhB;;;AAGAC,cAAU,MApHM;;AAsHhB;;;AAGAC,gBAAY,IAzHI;;AA2HhB;;;AAGAC,eAAW,IA9HK;;AAgIhB;;;;AAIAC,gBAAY,IApII;;AAsIhB;;;;;;;AAOAC,qBAAiB,CA7ID;;AA+IhB;;;AAGAC,oBAAgB,IAlJA;;AAoJhB;;;;;;;AAOAC,kBAAc,QA3JE;;AA6JhB;;;;AAIAC,cAAU,IAjKM;;AAmKhB;;;;AAIAC,gBAAY,IAvKI;;AAyKhB;;;AAGAC,eAAW,IA5KK;;AA8KhB;;;AAGAC,uBAAmB,IAjLH;;AAmLhB;;;AAGAC,kBAAc,CAtLE;;AAwLhB;;;AAGAC,qBAAiB,aA3LD;;AA6LhB;;;AAGAC,oBAAgB,CAhMA;;AAkMhB;;;AAGAC,uBAAmB,CArMH;;AAuMhB;;;AAGAC,uBAAmB,CA1MH;;AA4MhB;;;AAGAC,wBAAoB,aA/MJ;;AAiNhB;;;AAGAC,uBAAmB,CApNH;;AAsNhB;;;AAGAC,0BAAsB,CAzNN;;AA2NhB;;;AAGAC,0BAAsB,CA9NN;;AAgOhB;;;;;AAKAC,mBAAe,KArOC;;AAuOhB;;;;AAIAC,kBAAc,CA3OE;;AA6OhB;;;;;;;;AAQAC,gBAAY,IArPI;;AAuPhB;;;AAGAC,yBAAqB,IA1PL;;AA4PhB;;;AAGAC,qBAAiB,IA/PD;;AAiQhB;;;AAGAC,qBAAiB,CApQD;;AAsQhB;;;AAGAC,sBAAkB,CAzQF;;AA2QhB;;;;AAIAC,iBAAa,IA/QG;;AAiRhB;;;;AAIAC,UAAM,IArRU;;AAuRhB;;;;AAIAC,cAAU,IA3RM;;AA6RhB;;;;AAIAC,WAAO,IAjSS;;AAmShB;;;AAGA9tB,UAAM,cAAU0H,GAAV,EAAeyD,EAAf,EAAmB4iB,MAAnB,EAA2B;AAC/B,UAAIC,QAAQ,IAAZ;AACA,UAAIC,YAAYF,UAAUA,OAAOC,KAAjC;AACA,UAAIE,YAAY,CAACD,SAAjB;;AAEA,WAAK,IAAI5wB,IAAI,CAAb,EAAgBA,IAAIgtB,mBAAmB9sB,MAAvC,EAA+CF,GAA/C,EAAoD;AAClD,YAAI+B,OAAOirB,mBAAmBhtB,CAAnB,CAAX;AACA,YAAI8wB,YAAY/uB,KAAK,CAAL,CAAhB;;AAEA,YAAI8uB,aAAaF,MAAMG,SAAN,MAAqBF,UAAUE,SAAV,CAAtC,EAA4D;AAC1D;AACAzmB,cAAIymB,SAAJ,IAAiB/D,UAAU1iB,GAAV,EAAeymB,SAAf,EAA0BH,MAAMG,SAAN,KAAoB/uB,KAAK,CAAL,CAA9C,CAAjB;AACD;AACF;;AAED,UAAI8uB,aAAaF,MAAMlD,IAAN,KAAemD,UAAUnD,IAA1C,EAAgD;AAC9CpjB,YAAI0mB,SAAJ,GAAgBJ,MAAMlD,IAAtB;AACD;;AAED,UAAIoD,aAAaF,MAAMjD,MAAN,KAAiBkD,UAAUlD,MAA5C,EAAoD;AAClDrjB,YAAI2mB,WAAJ,GAAkBL,MAAMjD,MAAxB;AACD;;AAED,UAAImD,aAAaF,MAAMhD,OAAN,KAAkBiD,UAAUjD,OAA7C,EAAsD;AACpDtjB,YAAI4mB,WAAJ,GAAkBN,MAAMhD,OAAN,IAAiB,IAAjB,GAAwB,CAAxB,GAA4BgD,MAAMhD,OAApD;AACD;;AAED,UAAIkD,aAAaF,MAAMF,KAAN,KAAgBG,UAAUH,KAA3C,EAAkD;AAChDpmB,YAAI6mB,wBAAJ,GAA+BP,MAAMF,KAAN,IAAe,aAA9C;AACD;;AAED,UAAI,KAAKU,SAAL,EAAJ,EAAsB;AACpB,YAAIlD,YAAY0C,MAAM1C,SAAtB;AACA5jB,YAAI4jB,SAAJ,GAAgBA,aAAa,KAAKC,aAAL,IAAsBpgB,EAAtB,IAA4BA,GAAGsjB,YAA/B,GAA8CtjB,GAAGsjB,YAAH,EAA9C,GAAkE,CAA/E,CAAhB;AACD;AACF,KAzUe;AA0UhBC,aAAS,mBAAY;AACnB,UAAI5D,OAAO,KAAKA,IAAhB;AACA,aAAOA,QAAQ,IAAR,IAAgBA,SAAS,MAAhC;AACD,KA7Ue;AA8UhB0D,eAAW,qBAAY;AACrB,UAAIzD,SAAS,KAAKA,MAAlB;AACA,aAAOA,UAAU,IAAV,IAAkBA,WAAW,MAA7B,IAAuC,KAAKO,SAAL,GAAiB,CAA/D;AACD,KAjVe;;AAmVhB;;;;;;;AAOAd,gBAAY,oBAAUmE,UAAV,EAAsB3wB,SAAtB,EAAiC;AAC3C,UAAI2wB,UAAJ,EAAgB;AACd,aAAK,IAAI/xB,IAAT,IAAiB+xB,UAAjB,EAA6B;AAC3B,cAAIA,WAAW9wB,cAAX,CAA0BjB,IAA1B,MAAoCoB,cAAc,IAAd,KAAuBA,cAAc,KAAd,GAAsB,CAAC,KAAKH,cAAL,CAAoBjB,IAApB,CAAvB,GAAmD+xB,WAAW/xB,IAAX,KAAoB,IAA9F,CAApC,CAAJ,EAA8I;AAC5I,iBAAKA,IAAL,IAAa+xB,WAAW/xB,IAAX,CAAb;AACD;AACF;AACF;AACF,KAlWe;;AAoWhB;;;;;AAKA0F,SAAK,aAAU5C,GAAV,EAAeZ,KAAf,EAAsB;AACzB,UAAI,OAAOY,GAAP,KAAe,QAAnB,EAA6B;AAC3B,aAAKA,GAAL,IAAYZ,KAAZ;AACD,OAFD,MAEO;AACL,aAAK0rB,UAAL,CAAgB9qB,GAAhB,EAAqB,IAArB;AACD;AACF,KA/We;;AAiXhB;;;;AAIA3C,WAAO,iBAAY;AACjB,UAAI6xB,WAAW,IAAI,KAAKnxB,WAAT,EAAf;AACAmxB,eAASpE,UAAT,CAAoB,IAApB,EAA0B,IAA1B;AACA,aAAOoE,QAAP;AACD,KAzXe;AA0XhBC,iBAAa,qBAAUnnB,GAAV,EAAehI,GAAf,EAAoBokB,IAApB,EAA0B;AACrC,UAAIgL,SAASpvB,IAAIe,IAAJ,KAAa,QAAb,GAAwBoqB,oBAAxB,GAA+CJ,oBAA5D;AACA,UAAIG,iBAAiBkE,OAAOpnB,GAAP,EAAYhI,GAAZ,EAAiBokB,IAAjB,CAArB;AACA,UAAIiL,aAAarvB,IAAIqvB,UAArB;;AAEA,WAAK,IAAI1xB,IAAI,CAAb,EAAgBA,IAAI0xB,WAAWxxB,MAA/B,EAAuCF,GAAvC,EAA4C;AAC1CutB,uBAAeoE,YAAf,CAA4BD,WAAW1xB,CAAX,EAAcyF,MAA1C,EAAkDisB,WAAW1xB,CAAX,EAAc4b,KAAhE;AACD;;AAED,aAAO2R,cAAP;AACD;AApYe,GAAlB;AAsYA,MAAIqE,aAAa3E,MAAM1uB,SAAvB;;AAEA,OAAK,IAAIyB,IAAI,CAAb,EAAgBA,IAAIgtB,mBAAmB9sB,MAAvC,EAA+CF,GAA/C,EAAoD;AAClD,QAAI+B,OAAOirB,mBAAmBhtB,CAAnB,CAAX;;AAEA,QAAI,EAAE+B,KAAK,CAAL,KAAW6vB,UAAb,CAAJ,EAA8B;AAC5BA,iBAAW7vB,KAAK,CAAL,CAAX,IAAsBA,KAAK,CAAL,CAAtB;AACD;AACF,GA16M2B,CA06M1B;;;AAGFkrB,QAAMuE,WAAN,GAAoBI,WAAWJ,WAA/B;;AAEA,MAAIK,UAAU,SAAVA,OAAU,CAAUC,KAAV,EAAiBC,MAAjB,EAAyB;AACrC;AACA;AACA,SAAKD,KAAL,GAAaA,KAAb;AACA,SAAKC,MAAL,GAAcA,MAAd,CAJqC,CAIf;;AAEtB,SAAK3uB,IAAL,GAAY,SAAZ;AACD,GAPD;;AASAyuB,UAAQtzB,SAAR,CAAkByzB,gBAAlB,GAAqC,UAAU3nB,GAAV,EAAe;AAClD,WAAOA,IAAI4nB,aAAJ,CAAkB,KAAKH,KAAvB,EAA8B,KAAKC,MAAL,IAAe,QAA7C,CAAP;AACD,GAFD;;AAIA;;;;AAIA,WAASG,WAAT,GAAuB;AACrB,WAAO,KAAP;AACD;AACD;;;;;;;;;AAUA,WAASC,SAAT,CAAmB5O,EAAnB,EAAuBrX,OAAvB,EAAgCiG,GAAhC,EAAqC;AACnC,QAAIigB,SAAS9wB,cAAb;AACA,QAAI+jB,QAAQnZ,QAAQmmB,QAAR,EAAZ;AACA,QAAI/M,SAASpZ,QAAQomB,SAAR,EAAb;AACA,QAAIC,cAAcH,OAAOzB,KAAzB;;AAEA,QAAI4B,WAAJ,EAAiB;AACf;AACAA,kBAAY/gB,QAAZ,GAAuB,UAAvB;AACA+gB,kBAAYvJ,IAAZ,GAAmB,CAAnB;AACAuJ,kBAAYC,GAAZ,GAAkB,CAAlB;AACAD,kBAAYlN,KAAZ,GAAoBA,QAAQ,IAA5B;AACAkN,kBAAYjN,MAAZ,GAAqBA,SAAS,IAA9B;AACA8M,aAAOK,YAAP,CAAoB,gBAApB,EAAsClP,EAAtC;AACD;;AAED6O,WAAO/M,KAAP,GAAeA,QAAQlT,GAAvB;AACAigB,WAAO9M,MAAP,GAAgBA,SAASnT,GAAzB;AACA,WAAOigB,MAAP;AACD;AACD;;;;;;;;;AAUA,MAAIM,QAAQ,SAARA,KAAQ,CAAUnP,EAAV,EAAcrX,OAAd,EAAuBiG,GAAvB,EAA4B;AACtC,QAAIwgB,GAAJ;AACAxgB,UAAMA,OAAOwQ,gBAAb;;AAEA,QAAI,OAAOY,EAAP,KAAc,QAAlB,EAA4B;AAC1BoP,YAAMR,UAAU5O,EAAV,EAAcrX,OAAd,EAAuBiG,GAAvB,CAAN;AACD,KAFD,CAEE;AAFF,SAGK,IAAIvR,WAAW2iB,EAAX,CAAJ,EAAoB;AACrBoP,cAAMpP,EAAN;AACAA,aAAKoP,IAAIpP,EAAT;AACD;;AAEH,SAAKA,EAAL,GAAUA,EAAV;AACA,SAAKoP,GAAL,GAAWA,GAAX;AACA,QAAIC,WAAWD,IAAIhC,KAAnB;;AAEA,QAAIiC,QAAJ,EAAc;AACZ;AACAD,UAAIE,aAAJ,GAAoBX,WAApB,CAFY,CAEqB;;AAEjCU,eAAS,qBAAT,IAAkC,MAAlC;AACAA,eAAS,aAAT,IAA0B,MAA1B;AACAA,eAAS,uBAAT,IAAoC,MAApC;AACAA,eAAS,6BAAT,IAA0C,eAA1C;AACAA,eAAS,SAAT,IAAsB,CAAtB;AACAA,eAAS,QAAT,IAAqB,CAArB;AACAA,eAAS,cAAT,IAA2B,CAA3B;AACD;;AAED,SAAKE,OAAL,GAAe,IAAf;AACA,SAAKC,OAAL,GAAe,IAAf;AACA,SAAK7mB,OAAL,GAAeA,OAAf;AACA,SAAK8mB,MAAL,GAAc,IAAd,CAhCsC,CAgClB;;AAEpB;;;;;;AAMA,SAAKC,UAAL,GAAkB,CAAlB;AACA;;;;;;AAMA,SAAKC,UAAL,GAAkB,KAAlB;AACA;;;;;;AAMA,SAAKC,cAAL,GAAsB,GAAtB;AACA;;;;;AAKA,SAAKhhB,GAAL,GAAWA,GAAX;AACD,GA7DD;;AA+DAugB,QAAMn0B,SAAN,GAAkB;AAChB6B,iBAAasyB,KADG;AAEhB5L,aAAS,IAFO;AAGhBsM,YAAQ,KAHQ;AAIhBC,iBAAa,CAJG;AAKhBC,kBAAc,CALE;AAMhBC,gBAAY,CANI;AAOhBC,iBAAa,KAPG;AAQhBC,qBAAiB,2BAAY;AAC3B,aAAO,KAAKF,UAAL,GAAkB,KAAKD,YAA9B;AACD,KAVe;AAWhBI,iBAAa,uBAAY;AACvB,WAAKrpB,GAAL,GAAW,KAAKsoB,GAAL,CAAS50B,UAAT,CAAoB,IAApB,CAAX;AACA,WAAKsM,GAAL,CAAS8H,GAAT,GAAe,KAAKA,GAApB;AACD,KAde;AAehBwhB,sBAAkB,4BAAY;AAC5B,UAAIxhB,MAAM,KAAKA,GAAf;AACA,WAAK2gB,OAAL,GAAeX,UAAU,UAAU,KAAK5O,EAAzB,EAA6B,KAAKrX,OAAlC,EAA2CiG,GAA3C,CAAf;AACA,WAAK4gB,OAAL,GAAe,KAAKD,OAAL,CAAa/0B,UAAb,CAAwB,IAAxB,CAAf;;AAEA,UAAIoU,OAAO,CAAX,EAAc;AACZ,aAAK4gB,OAAL,CAAa1rB,KAAb,CAAmB8K,GAAnB,EAAwBA,GAAxB;AACD;AACF,KAvBe;;AAyBhB;;;;AAIA3E,YAAQ,gBAAU6X,KAAV,EAAiBC,MAAjB,EAAyB;AAC/B,UAAInT,MAAM,KAAKA,GAAf;AACA,UAAIwgB,MAAM,KAAKA,GAAf;AACA,UAAIC,WAAWD,IAAIhC,KAAnB;AACA,UAAImC,UAAU,KAAKA,OAAnB;;AAEA,UAAIF,QAAJ,EAAc;AACZA,iBAASvN,KAAT,GAAiBA,QAAQ,IAAzB;AACAuN,iBAAStN,MAAT,GAAkBA,SAAS,IAA3B;AACD;;AAEDqN,UAAItN,KAAJ,GAAYA,QAAQlT,GAApB;AACAwgB,UAAIrN,MAAJ,GAAaA,SAASnT,GAAtB;;AAEA,UAAI2gB,OAAJ,EAAa;AACXA,gBAAQzN,KAAR,GAAgBA,QAAQlT,GAAxB;AACA2gB,gBAAQxN,MAAR,GAAiBA,SAASnT,GAA1B;;AAEA,YAAIA,OAAO,CAAX,EAAc;AACZ,eAAK4gB,OAAL,CAAa1rB,KAAb,CAAmB8K,GAAnB,EAAwBA,GAAxB;AACD;AACF;AACF,KAnDe;;AAqDhB;;;;;AAKA2F,WAAO,eAAU8b,QAAV,EAAoBX,UAApB,EAAgC;AACrC,UAAIN,MAAM,KAAKA,GAAf;AACA,UAAItoB,MAAM,KAAKA,GAAf;AACA,UAAIgb,QAAQsN,IAAItN,KAAhB;AACA,UAAIC,SAASqN,IAAIrN,MAAjB;AACA,UAAI2N,aAAaA,cAAc,KAAKA,UAApC;AACA,UAAIY,iBAAiB,KAAKX,UAAL,IAAmB,CAACU,QAAzC;AACA,UAAIT,iBAAiB,KAAKA,cAA1B;AACA,UAAIhhB,MAAM,KAAKA,GAAf;;AAEA,UAAI0hB,cAAJ,EAAoB;AAClB,YAAI,CAAC,KAAKf,OAAV,EAAmB;AACjB,eAAKa,gBAAL;AACD;;AAED,aAAKZ,OAAL,CAAa7B,wBAAb,GAAwC,MAAxC;AACA,aAAK6B,OAAL,CAAae,SAAb,CAAuBnB,GAAvB,EAA4B,CAA5B,EAA+B,CAA/B,EAAkCtN,QAAQlT,GAA1C,EAA+CmT,SAASnT,GAAxD;AACD;;AAED9H,UAAI0pB,SAAJ,CAAc,CAAd,EAAiB,CAAjB,EAAoB1O,KAApB,EAA2BC,MAA3B;;AAEA,UAAI2N,cAAcA,eAAe,aAAjC,EAAgD;AAC9C,YAAIe,2BAAJ,CAD8C,CACb;;AAEjC,YAAIf,WAAWvB,UAAf,EAA2B;AACzB;AACAsC,wCAA8Bf,WAAWgB,gBAAX,IAA+BhH,MAAMuE,WAAN,CAAkBnnB,GAAlB,EAAuB4oB,UAAvB,EAAmC;AAC9F9sB,eAAG,CAD2F;AAE9FC,eAAG,CAF2F;AAG9Fif,mBAAOA,KAHuF;AAI9FC,oBAAQA;AAJsF,WAAnC,CAA7D;AAMA2N,qBAAWgB,gBAAX,GAA8BD,2BAA9B;AACD,SATD,CASE;AATF,aAUK,IAAIf,WAAWnB,KAAf,EAAsB;AACvBkC,0CAA8BnC,QAAQtzB,SAAR,CAAkByzB,gBAAlB,CAAmClyB,IAAnC,CAAwCmzB,UAAxC,EAAoD5oB,GAApD,CAA9B;AACD;;AAEHA,YAAI6pB,IAAJ;AACA7pB,YAAI0mB,SAAJ,GAAgBiD,+BAA+Bf,UAA/C;AACA5oB,YAAI8pB,QAAJ,CAAa,CAAb,EAAgB,CAAhB,EAAmB9O,KAAnB,EAA0BC,MAA1B;AACAjb,YAAI+pB,OAAJ;AACD;;AAED,UAAIP,cAAJ,EAAoB;AAClB,YAAIf,UAAU,KAAKA,OAAnB;AACAzoB,YAAI6pB,IAAJ;AACA7pB,YAAI4mB,WAAJ,GAAkBkC,cAAlB;AACA9oB,YAAIypB,SAAJ,CAAchB,OAAd,EAAuB,CAAvB,EAA0B,CAA1B,EAA6BzN,KAA7B,EAAoCC,MAApC;AACAjb,YAAI+pB,OAAJ;AACD;AACF;AA7Ge,GAAlB;;AAgHA,MAAIC,wBAAwB,OAAOp2B,MAAP,KAAkB,WAAlB,KAAkCA,OAAOo2B,qBAAP,IAAgCp2B,OAAOo2B,qBAAP,CAA6B1xB,IAA7B,CAAkC1E,MAAlC,CAAhC,IAA6E;AAC3IA,SAAOq2B,uBAAP,IAAkCr2B,OAAOq2B,uBAAP,CAA+B3xB,IAA/B,CAAoC1E,MAApC,CAD4B,IACmBA,OAAOs2B,wBAD1B,IACsDt2B,OAAOu2B,2BAD/F,KAC+H,UAAU5xB,IAAV,EAAgB;AACzK6xB,eAAW7xB,IAAX,EAAiB,EAAjB;AACD,GAHD;;AAKA,MAAI8xB,mBAAmB,IAAI3c,GAAJ,CAAQ,EAAR,CAAvB;AACA;;;;;AAKA,WAAS4c,cAAT,CAAwBC,aAAxB,EAAuC;AACrC,QAAI,OAAOA,aAAP,KAAyB,QAA7B,EAAuC;AACrC,UAAIC,eAAeH,iBAAiBxvB,GAAjB,CAAqB0vB,aAArB,CAAnB;AACA,aAAOC,gBAAgBA,aAAa/C,KAApC;AACD,KAHD,MAGO;AACL,aAAO8C,aAAP;AACD;AACF;AACD;;;;;;;;;;;;AAYA,WAASE,mBAAT,CAA6BF,aAA7B,EAA4C9C,KAA5C,EAAmDiD,MAAnD,EAA2DzyB,EAA3D,EAA+D0yB,SAA/D,EAA0E;AACxE,QAAI,CAACJ,aAAL,EAAoB;AAClB,aAAO9C,KAAP;AACD,KAFD,MAEO,IAAI,OAAO8C,aAAP,KAAyB,QAA7B,EAAuC;AAC5C;AACA,UAAI9C,SAASA,MAAMmD,YAAN,KAAuBL,aAAhC,IAAiD,CAACG,MAAtD,EAA8D;AAC5D,eAAOjD,KAAP;AACD,OAJ2C,CAI1C;AACF;;;AAGA,UAAI+C,eAAeH,iBAAiBxvB,GAAjB,CAAqB0vB,aAArB,CAAnB;AACA,UAAIM,cAAc;AAChBH,gBAAQA,MADQ;AAEhBzyB,YAAIA,EAFY;AAGhB0yB,mBAAWA;AAHK,OAAlB;;AAMA,UAAIH,YAAJ,EAAkB;AAChB/C,gBAAQ+C,aAAa/C,KAArB;AACA,SAACqD,aAAarD,KAAb,CAAD,IAAwB+C,aAAaO,OAAb,CAAqB5yB,IAArB,CAA0B0yB,WAA1B,CAAxB;AACD,OAHD,MAGO;AACL,SAACpD,KAAD,KAAWA,QAAQ,IAAIuD,KAAJ,EAAnB;AACAvD,cAAMwD,MAAN,GAAeC,WAAf;AACAb,yBAAiBpc,GAAjB,CAAqBsc,aAArB,EAAoC9C,MAAM0D,cAAN,GAAuB;AACzD1D,iBAAOA,KADkD;AAEzDsD,mBAAS,CAACF,WAAD;AAFgD,SAA3D;AAIApD,cAAM2D,GAAN,GAAY3D,MAAMmD,YAAN,GAAqBL,aAAjC;AACD;;AAED,aAAO9C,KAAP;AACD,KA7BM,CA6BL;AA7BK,SA8BF;AACD,eAAO8C,aAAP;AACD;AACJ;;AAED,WAASW,WAAT,GAAuB;AACrB,QAAIV,eAAe,KAAKW,cAAxB;AACA,SAAKF,MAAL,GAAc,KAAKE,cAAL,GAAsB,IAApC;;AAEA,SAAK,IAAIx1B,IAAI,CAAb,EAAgBA,IAAI60B,aAAaO,OAAb,CAAqBl1B,MAAzC,EAAiDF,GAAjD,EAAsD;AACpD,UAAIk1B,cAAcL,aAAaO,OAAb,CAAqBp1B,CAArB,CAAlB;AACA,UAAIsC,KAAK4yB,YAAY5yB,EAArB;AACAA,YAAMA,GAAG,IAAH,EAAS4yB,YAAYF,SAArB,CAAN;AACAE,kBAAYH,MAAZ,CAAmBvR,KAAnB;AACD;;AAEDqR,iBAAaO,OAAb,CAAqBl1B,MAArB,GAA8B,CAA9B;AACD;;AAED,WAASi1B,YAAT,CAAsBrD,KAAtB,EAA6B;AAC3B,WAAOA,SAASA,MAAMzM,KAAf,IAAwByM,MAAMxM,MAArC;AACD;;AAED,MAAIoQ,iBAAiB,EAArB;AACA,MAAIC,wBAAwB,CAA5B;AACA,MAAIC,iBAAiB,IAArB;AACA,MAAIC,YAAY,+BAAhB;AACA,MAAIC,eAAe,iBAAnB,CArvN4B,CAqvNU;;AAEtC,MAAIC,YAAY,EAAhB;;AAEA;;;;;;;AAOA,WAAS1D,QAAT,CAAkBlE,IAAlB,EAAwBC,IAAxB,EAA8B;AAC5BA,WAAOA,QAAQ0H,YAAf;AACA,QAAIv1B,MAAM4tB,OAAO,GAAP,GAAaC,IAAvB;;AAEA,QAAIsH,eAAen1B,GAAf,CAAJ,EAAyB;AACvB,aAAOm1B,eAAen1B,GAAf,CAAP;AACD;;AAED,QAAIy1B,YAAY,CAAC7H,OAAO,EAAR,EAAY3T,KAAZ,CAAkB,IAAlB,CAAhB;AACA,QAAI6K,QAAQ,CAAZ;;AAEA,SAAK,IAAIrlB,IAAI,CAAR,EAAWyK,IAAIurB,UAAU91B,MAA9B,EAAsCF,IAAIyK,CAA1C,EAA6CzK,GAA7C,EAAkD;AAChD;AACAqlB,cAAQve,KAAKqB,GAAL,CAAS8tB,YAAYD,UAAUh2B,CAAV,CAAZ,EAA0BouB,IAA1B,EAAgC/I,KAAzC,EAAgDA,KAAhD,CAAR;AACD;;AAED,QAAIsQ,wBAAwBC,cAA5B,EAA4C;AAC1CD,8BAAwB,CAAxB;AACAD,uBAAiB,EAAjB;AACD;;AAEDC;AACAD,mBAAen1B,GAAf,IAAsB8kB,KAAtB;AACA,WAAOA,KAAP;AACD;AACD;;;;;;;;;;;;AAYA,WAASyC,gBAAT,CAAyBqG,IAAzB,EAA+BC,IAA/B,EAAqCgB,SAArC,EAAgDC,iBAAhD,EAAmEiB,WAAnE,EAAgFC,IAAhF,EAAsFC,QAAtF,EAAgG;AAC9F,WAAOD,OAAO2F,gBAAgB/H,IAAhB,EAAsBC,IAAtB,EAA4BgB,SAA5B,EAAuCC,iBAAvC,EAA0DiB,WAA1D,EAAuEC,IAAvE,EAA6EC,QAA7E,CAAP,GAAgG2F,iBAAiBhI,IAAjB,EAAuBC,IAAvB,EAA6BgB,SAA7B,EAAwCC,iBAAxC,EAA2DiB,WAA3D,EAAwEE,QAAxE,CAAvG;AACD;;AAED,WAAS2F,gBAAT,CAA0BhI,IAA1B,EAAgCC,IAAhC,EAAsCgB,SAAtC,EAAiDC,iBAAjD,EAAoEiB,WAApE,EAAiFE,QAAjF,EAA2F;AACzF,QAAI4F,eAAeC,eAAelI,IAAf,EAAqBC,IAArB,EAA2BkC,WAA3B,EAAwCE,QAAxC,CAAnB;AACA,QAAI8F,aAAajE,SAASlE,IAAT,EAAeC,IAAf,CAAjB;;AAEA,QAAIkC,WAAJ,EAAiB;AACfgG,oBAAchG,YAAY,CAAZ,IAAiBA,YAAY,CAAZ,CAA/B;AACD;;AAED,QAAIiG,cAAcH,aAAaG,WAA/B;AACA,QAAIpwB,IAAIqwB,YAAY,CAAZ,EAAeF,UAAf,EAA2BlH,SAA3B,CAAR;AACA,QAAIhpB,IAAIqwB,YAAY,CAAZ,EAAeF,WAAf,EAA4BlH,iBAA5B,CAAR;AACA,QAAI5I,OAAO,IAAIrB,YAAJ,CAAiBjf,CAAjB,EAAoBC,CAApB,EAAuBkwB,UAAvB,EAAmCC,WAAnC,CAAX;AACA9P,SAAKiQ,UAAL,GAAkBN,aAAaM,UAA/B;AACA,WAAOjQ,IAAP;AACD;;AAED,WAASyP,eAAT,CAAyB/H,IAAzB,EAA+BC,IAA/B,EAAqCgB,SAArC,EAAgDC,iBAAhD,EAAmEiB,WAAnE,EAAgFC,IAAhF,EAAsFC,QAAtF,EAAgG;AAC9F,QAAI4F,eAAeO,cAAcxI,IAAd,EAAoB;AACrCoC,YAAMA,IAD+B;AAErCC,gBAAUA,QAF2B;AAGrCpC,YAAMA,IAH+B;AAIrCgB,iBAAWA,SAJ0B;AAKrCkB,mBAAaA;AALwB,KAApB,CAAnB;AAOA,QAAIgG,aAAaF,aAAaE,UAA9B;AACA,QAAIC,cAAcH,aAAaG,WAA/B;AACA,QAAIpwB,IAAIqwB,YAAY,CAAZ,EAAeF,UAAf,EAA2BlH,SAA3B,CAAR;AACA,QAAIhpB,IAAIqwB,YAAY,CAAZ,EAAeF,WAAf,EAA4BlH,iBAA5B,CAAR;AACA,WAAO,IAAIjK,YAAJ,CAAiBjf,CAAjB,EAAoBC,CAApB,EAAuBkwB,UAAvB,EAAmCC,WAAnC,CAAP;AACD;AACD;;;;;;;;AASA,WAASC,WAAT,CAAqBrwB,CAArB,EAAwBkf,KAAxB,EAA+B+J,SAA/B,EAA0C;AACxC;AACA,QAAIA,cAAc,OAAlB,EAA2B;AACzBjpB,WAAKkf,KAAL;AACD,KAFD,MAEO,IAAI+J,cAAc,QAAlB,EAA4B;AACjCjpB,WAAKkf,QAAQ,CAAb;AACD;;AAED,WAAOlf,CAAP;AACD;AACD;;;;;;;;AAQA,WAASswB,WAAT,CAAqBrwB,CAArB,EAAwBkf,MAAxB,EAAgC+J,iBAAhC,EAAmD;AACjD,QAAIA,sBAAsB,QAA1B,EAAoC;AAClCjpB,WAAKkf,SAAS,CAAd;AACD,KAFD,MAEO,IAAI+J,sBAAsB,QAA1B,EAAoC;AACzCjpB,WAAKkf,MAAL;AACD;;AAED,WAAOlf,CAAP;AACD;AACD;;;;;;;;AAQA,WAASwwB,wBAAT,CAAkC3H,YAAlC,EAAgDxI,IAAhD,EAAsDhf,QAAtD,EAAgE;AAC9D,QAAItB,IAAIsgB,KAAKtgB,CAAb;AACA,QAAIC,IAAIqgB,KAAKrgB,CAAb;AACA,QAAIkf,SAASmB,KAAKnB,MAAlB;AACA,QAAID,QAAQoB,KAAKpB,KAAjB;AACA,QAAIwR,aAAavR,SAAS,CAA1B;AACA,QAAI8J,YAAY,MAAhB;AACA,QAAIC,oBAAoB,KAAxB;;AAEA,YAAQJ,YAAR;AACE,WAAK,MAAL;AACE9oB,aAAKsB,QAAL;AACArB,aAAKywB,UAAL;AACAzH,oBAAY,OAAZ;AACAC,4BAAoB,QAApB;AACA;;AAEF,WAAK,OAAL;AACElpB,aAAKsB,WAAW4d,KAAhB;AACAjf,aAAKywB,UAAL;AACAxH,4BAAoB,QAApB;AACA;;AAEF,WAAK,KAAL;AACElpB,aAAKkf,QAAQ,CAAb;AACAjf,aAAKqB,QAAL;AACA2nB,oBAAY,QAAZ;AACAC,4BAAoB,QAApB;AACA;;AAEF,WAAK,QAAL;AACElpB,aAAKkf,QAAQ,CAAb;AACAjf,aAAKkf,SAAS7d,QAAd;AACA2nB,oBAAY,QAAZ;AACA;;AAEF,WAAK,QAAL;AACEjpB,aAAKkf,QAAQ,CAAb;AACAjf,aAAKywB,UAAL;AACAzH,oBAAY,QAAZ;AACAC,4BAAoB,QAApB;AACA;;AAEF,WAAK,YAAL;AACElpB,aAAKsB,QAAL;AACArB,aAAKywB,UAAL;AACAxH,4BAAoB,QAApB;AACA;;AAEF,WAAK,aAAL;AACElpB,aAAKkf,QAAQ5d,QAAb;AACArB,aAAKywB,UAAL;AACAzH,oBAAY,OAAZ;AACAC,4BAAoB,QAApB;AACA;;AAEF,WAAK,WAAL;AACElpB,aAAKkf,QAAQ,CAAb;AACAjf,aAAKqB,QAAL;AACA2nB,oBAAY,QAAZ;AACA;;AAEF,WAAK,cAAL;AACEjpB,aAAKkf,QAAQ,CAAb;AACAjf,aAAKkf,SAAS7d,QAAd;AACA2nB,oBAAY,QAAZ;AACAC,4BAAoB,QAApB;AACA;;AAEF,WAAK,eAAL;AACElpB,aAAKsB,QAAL;AACArB,aAAKqB,QAAL;AACA;;AAEF,WAAK,gBAAL;AACEtB,aAAKkf,QAAQ5d,QAAb;AACArB,aAAKqB,QAAL;AACA2nB,oBAAY,OAAZ;AACA;;AAEF,WAAK,kBAAL;AACEjpB,aAAKsB,QAAL;AACArB,aAAKkf,SAAS7d,QAAd;AACA4nB,4BAAoB,QAApB;AACA;;AAEF,WAAK,mBAAL;AACElpB,aAAKkf,QAAQ5d,QAAb;AACArB,aAAKkf,SAAS7d,QAAd;AACA2nB,oBAAY,OAAZ;AACAC,4BAAoB,QAApB;AACA;AAlFJ;;AAqFA,WAAO;AACLlpB,SAAGA,CADE;AAELC,SAAGA,CAFE;AAGLgpB,iBAAWA,SAHN;AAILC,yBAAmBA;AAJd,KAAP;AAMD;AACD;;;;;;;;;;;;;;;;;AAiBA,WAASyH,YAAT,CAAsB3I,IAAtB,EAA4B4I,cAA5B,EAA4C3I,IAA5C,EAAkD4I,QAAlD,EAA4D5hB,OAA5D,EAAqE;AACnE,QAAI,CAAC2hB,cAAL,EAAqB;AACnB,aAAO,EAAP;AACD;;AAED,QAAIf,YAAY,CAAC7H,OAAO,EAAR,EAAY3T,KAAZ,CAAkB,IAAlB,CAAhB;AACApF,cAAU6hB,uBAAuBF,cAAvB,EAAuC3I,IAAvC,EAA6C4I,QAA7C,EAAuD5hB,OAAvD,CAAV,CANmE,CAMQ;AAC3E;;AAEA,SAAK,IAAIpV,IAAI,CAAR,EAAWC,MAAM+1B,UAAU91B,MAAhC,EAAwCF,IAAIC,GAA5C,EAAiDD,GAAjD,EAAsD;AACpDg2B,gBAAUh2B,CAAV,IAAek3B,mBAAmBlB,UAAUh2B,CAAV,CAAnB,EAAiCoV,OAAjC,CAAf;AACD;;AAED,WAAO4gB,UAAUjX,IAAV,CAAe,IAAf,CAAP;AACD;;AAED,WAASkY,sBAAT,CAAgCF,cAAhC,EAAgD3I,IAAhD,EAAsD4I,QAAtD,EAAgE5hB,OAAhE,EAAyE;AACvEA,cAAUjU,OAAO,EAAP,EAAWiU,OAAX,CAAV;AACAA,YAAQgZ,IAAR,GAAeA,IAAf;AACA,QAAI4I,WAAWrzB,UAAUqzB,QAAV,EAAoB,KAApB,CAAf;AACA5hB,YAAQ+hB,aAAR,GAAwBxzB,UAAUyR,QAAQ+hB,aAAlB,EAAiC,CAAjC,CAAxB;AACA,QAAIC,UAAUhiB,QAAQgiB,OAAR,GAAkBzzB,UAAUyR,QAAQgiB,OAAlB,EAA2B,CAA3B,CAAhC,CALuE,CAKR;AAC/D;;AAEAhiB,YAAQiiB,WAAR,GAAsBhF,SAAS,GAAT,EAAcjE,IAAd,CAAtB,CARuE,CAQ5B;AAC3C;;AAEA,QAAIkJ,eAAeliB,QAAQkiB,YAAR,GAAuBjF,SAAS,GAAT,EAAcjE,IAAd,CAA1C;AACAhZ,YAAQmiB,WAAR,GAAsB5zB,UAAUyR,QAAQmiB,WAAlB,EAA+B,EAA/B,CAAtB,CAZuE,CAYb;AAC1D;;AAEA,QAAIC,eAAeT,iBAAiBjwB,KAAKqB,GAAL,CAAS,CAAT,EAAY4uB,iBAAiB,CAA7B,CAApC,CAfuE,CAeF;;AAErE,SAAK,IAAI/2B,IAAI,CAAb,EAAgBA,IAAIo3B,OAAJ,IAAeI,gBAAgBF,YAA/C,EAA6Dt3B,GAA7D,EAAkE;AAChEw3B,sBAAgBF,YAAhB;AACD;;AAED,QAAIG,gBAAgBpF,SAAS2E,QAAT,CAApB;;AAEA,QAAIS,gBAAgBD,YAApB,EAAkC;AAChCR,iBAAW,EAAX;AACAS,sBAAgB,CAAhB;AACD;;AAEDD,mBAAeT,iBAAiBU,aAAhC;AACAriB,YAAQ4hB,QAAR,GAAmBA,QAAnB;AACA5hB,YAAQqiB,aAAR,GAAwBA,aAAxB;AACAriB,YAAQoiB,YAAR,GAAuBA,YAAvB;AACApiB,YAAQ2hB,cAAR,GAAyBA,cAAzB;AACA,WAAO3hB,OAAP;AACD;;AAED,WAAS8hB,kBAAT,CAA4BQ,QAA5B,EAAsCtiB,OAAtC,EAA+C;AAC7C,QAAI2hB,iBAAiB3hB,QAAQ2hB,cAA7B;AACA,QAAI3I,OAAOhZ,QAAQgZ,IAAnB;AACA,QAAIoJ,eAAepiB,QAAQoiB,YAA3B;;AAEA,QAAI,CAACT,cAAL,EAAqB;AACnB,aAAO,EAAP;AACD;;AAED,QAAI9I,YAAYoE,SAASqF,QAAT,EAAmBtJ,IAAnB,CAAhB;;AAEA,QAAIH,aAAa8I,cAAjB,EAAiC;AAC/B,aAAOW,QAAP;AACD;;AAED,SAAK,IAAI9Z,IAAI,CAAb,GAAiBA,GAAjB,EAAsB;AACpB,UAAIqQ,aAAauJ,YAAb,IAA6B5Z,KAAKxI,QAAQ+hB,aAA9C,EAA6D;AAC3DO,oBAAYtiB,QAAQ4hB,QAApB;AACA;AACD;;AAED,UAAIW,YAAY/Z,MAAM,CAAN,GAAUga,eAAeF,QAAf,EAAyBF,YAAzB,EAAuCpiB,QAAQkiB,YAA/C,EAA6DliB,QAAQiiB,WAArE,CAAV,GAA8FpJ,YAAY,CAAZ,GAAgBnnB,KAAKuV,KAAL,CAAWqb,SAASx3B,MAAT,GAAkBs3B,YAAlB,GAAiCvJ,SAA5C,CAAhB,GAAyE,CAAvL;AACAyJ,iBAAWA,SAASvd,MAAT,CAAgB,CAAhB,EAAmBwd,SAAnB,CAAX;AACA1J,kBAAYoE,SAASqF,QAAT,EAAmBtJ,IAAnB,CAAZ;AACD;;AAED,QAAIsJ,aAAa,EAAjB,EAAqB;AACnBA,iBAAWtiB,QAAQmiB,WAAnB;AACD;;AAED,WAAOG,QAAP;AACD;;AAED,WAASE,cAAT,CAAwBzJ,IAAxB,EAA8BqJ,YAA9B,EAA4CF,YAA5C,EAA0DD,WAA1D,EAAuE;AACrE,QAAIhS,QAAQ,CAAZ;AACA,QAAIrlB,IAAI,CAAR;;AAEA,SAAK,IAAIC,MAAMkuB,KAAKjuB,MAApB,EAA4BF,IAAIC,GAAJ,IAAWolB,QAAQmS,YAA/C,EAA6Dx3B,GAA7D,EAAkE;AAChE,UAAI63B,WAAW1J,KAAK2J,UAAL,CAAgB93B,CAAhB,CAAf;AACAqlB,eAAS,KAAKwS,QAAL,IAAiBA,YAAY,GAA7B,GAAmCP,YAAnC,GAAkDD,WAA3D;AACD;;AAED,WAAOr3B,CAAP;AACD;AACD;;;;;;AAOA,WAAS+3B,aAAT,CAAuB3J,IAAvB,EAA6B;AAC3B;AACA,WAAOiE,SAAS,GAAT,EAAcjE,IAAd,CAAP;AACD;AACD;;;;;;;AAOA,WAAS6H,WAAT,CAAqB9H,IAArB,EAA2BC,IAA3B,EAAiC;AAC/B,WAAO2H,UAAUE,WAAV,CAAsB9H,IAAtB,EAA4BC,IAA5B,CAAP;AACD,GA7lO2B,CA6lO1B;;AAEF2H,YAAUE,WAAV,GAAwB,UAAU9H,IAAV,EAAgBC,IAAhB,EAAsB;AAC5C,QAAI/jB,MAAMtM,YAAV;AACAsM,QAAI+jB,IAAJ,GAAWA,QAAQ0H,YAAnB;AACA,WAAOzrB,IAAI4rB,WAAJ,CAAgB9H,IAAhB,CAAP;AACD,GAJD;AAKA;;;;;;;;;AAUA,WAASkI,cAAT,CAAwBlI,IAAxB,EAA8BC,IAA9B,EAAoC4J,OAApC,EAA6CxH,QAA7C,EAAuD;AACrDrC,YAAQ,IAAR,KAAiBA,QAAQ,EAAzB;AACA,QAAIuI,aAAaqB,cAAc3J,IAAd,CAAjB;AACA,QAAI6J,QAAQ9J,OAAOA,KAAK3T,KAAL,CAAW,IAAX,CAAP,GAA0B,EAAtC;AACA,QAAI8K,SAAS2S,MAAM/3B,MAAN,GAAew2B,UAA5B;AACA,QAAIH,cAAcjR,MAAlB;;AAEA,QAAI0S,OAAJ,EAAa;AACXzB,qBAAeyB,QAAQ,CAAR,IAAaA,QAAQ,CAAR,CAA5B;AACD;;AAED,QAAI7J,QAAQqC,QAAZ,EAAsB;AACpB,UAAI0H,mBAAmB1H,SAAS+F,WAAhC;AACA,UAAI4B,kBAAkB3H,SAAS8F,UAA/B;;AAEA,UAAI4B,oBAAoB,IAApB,IAA4B3B,cAAc2B,gBAA9C,EAAgE;AAC9D/J,eAAO,EAAP;AACA8J,gBAAQ,EAAR;AACD,OAHD,MAGO,IAAIE,mBAAmB,IAAvB,EAA6B;AAClC,YAAI/iB,UAAU6hB,uBAAuBkB,mBAAmBH,UAAUA,QAAQ,CAAR,IAAaA,QAAQ,CAAR,CAAvB,GAAoC,CAAvD,CAAvB,EAAkF5J,IAAlF,EAAwFoC,SAASwG,QAAjG,EAA2G;AACvHI,mBAAS5G,SAAS4G,OADqG;AAEvHG,uBAAa/G,SAAS+G;AAFiG,SAA3G,CAAd,CADkC,CAI9B;AACJ;;AAEA,aAAK,IAAIv3B,IAAI,CAAR,EAAWC,MAAMg4B,MAAM/3B,MAA5B,EAAoCF,IAAIC,GAAxC,EAA6CD,GAA7C,EAAkD;AAChDi4B,gBAAMj4B,CAAN,IAAWk3B,mBAAmBe,MAAMj4B,CAAN,CAAnB,EAA6BoV,OAA7B,CAAX;AACD;AACF;AACF;;AAED,WAAO;AACL6iB,aAAOA,KADF;AAEL3S,cAAQA,MAFH;AAGLiR,mBAAaA,WAHR;AAILG,kBAAYA;AAJP,KAAP;AAMD;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+BA,WAASC,aAAT,CAAuBxI,IAAvB,EAA6BwC,KAA7B,EAAoC;AAClC,QAAIyF,eAAe;AACjB6B,aAAO,EADU;AAEjB5S,aAAO,CAFU;AAGjBC,cAAQ;AAHS,KAAnB;AAKA6I,YAAQ,IAAR,KAAiBA,QAAQ,EAAzB;;AAEA,QAAI,CAACA,IAAL,EAAW;AACT,aAAOiI,YAAP;AACD;;AAED,QAAIgC,YAAYvC,UAAUuC,SAAV,GAAsB,CAAtC;AACA,QAAIx4B,MAAJ;;AAEA,WAAO,CAACA,SAASi2B,UAAUwC,IAAV,CAAelK,IAAf,CAAV,KAAmC,IAA1C,EAAgD;AAC9C,UAAImK,eAAe14B,OAAO24B,KAA1B;;AAEA,UAAID,eAAeF,SAAnB,EAA8B;AAC5BI,mBAAWpC,YAAX,EAAyBjI,KAAKsK,SAAL,CAAeL,SAAf,EAA0BE,YAA1B,CAAzB;AACD;;AAEDE,iBAAWpC,YAAX,EAAyBx2B,OAAO,CAAP,CAAzB,EAAoCA,OAAO,CAAP,CAApC;AACAw4B,kBAAYvC,UAAUuC,SAAtB;AACD;;AAED,QAAIA,YAAYjK,KAAKjuB,MAArB,EAA6B;AAC3Bs4B,iBAAWpC,YAAX,EAAyBjI,KAAKsK,SAAL,CAAeL,SAAf,EAA0BjK,KAAKjuB,MAA/B,CAAzB;AACD;;AAED,QAAI+3B,QAAQ7B,aAAa6B,KAAzB;AACA,QAAIS,gBAAgB,CAApB;AACA,QAAIlB,eAAe,CAAnB,CAhCkC,CAgCZ;;AAEtB,QAAImB,cAAc,EAAlB;AACA,QAAIC,aAAajI,MAAML,WAAvB;AACA,QAAIE,WAAWG,MAAMH,QAArB;AACA,QAAIqI,gBAAgBrI,YAAYA,SAAS8F,UAAzC;AACA,QAAIwC,iBAAiBtI,YAAYA,SAAS+F,WAA1C;;AAEA,QAAIqC,UAAJ,EAAgB;AACdC,uBAAiB,IAAjB,KAA0BA,iBAAiBD,WAAW,CAAX,IAAgBA,WAAW,CAAX,CAA3D;AACAE,wBAAkB,IAAlB,KAA2BA,kBAAkBF,WAAW,CAAX,IAAgBA,WAAW,CAAX,CAA7D;AACD,KA3CiC,CA2ChC;;;AAGF,SAAK,IAAI54B,IAAI,CAAb,EAAgBA,IAAIi4B,MAAM/3B,MAA1B,EAAkCF,GAAlC,EAAuC;AACrC,UAAI+4B,OAAOd,MAAMj4B,CAAN,CAAX;AACA,UAAI02B,aAAa,CAAjB;AACA,UAAIzI,YAAY,CAAhB;;AAEA,WAAK,IAAIrQ,IAAI,CAAb,EAAgBA,IAAImb,KAAKC,MAAL,CAAY94B,MAAhC,EAAwC0d,GAAxC,EAA6C;AAC3C,YAAIqb,QAAQF,KAAKC,MAAL,CAAYpb,CAAZ,CAAZ;AACA,YAAIsb,aAAaD,MAAMnI,SAAN,IAAmBH,MAAMJ,IAAN,CAAW0I,MAAMnI,SAAjB,CAAnB,IAAkD,EAAnE,CAF2C,CAE4B;;AAEvE,YAAIR,cAAc2I,MAAM3I,WAAN,GAAoB4I,WAAW5I,WAAjD,CAJ2C,CAImB;;AAE9D,YAAIlC,OAAO6K,MAAM7K,IAAN,GAAa8K,WAAW9K,IAAX,IAAmBuC,MAAMvC,IAAjD,CAN2C,CAMY;;AAEvD,YAAI+K,cAAcF,MAAMnK,UAAN,GAAmBnrB,WAAW;AAChD;AACAu1B,mBAAWpK,UAF0B,EAEdiJ,cAAc3J,IAAd,CAFc,CAArC;AAGAkC,wBAAgB6I,eAAe7I,YAAY,CAAZ,IAAiBA,YAAY,CAAZ,CAAhD;AACA2I,cAAM3T,MAAN,GAAe6T,WAAf;AACAF,cAAMvC,UAAN,GAAmB5yB,UAAUo1B,WAAWlK,cAArB,EAAqC2B,MAAM3B,cAA3C,EAA2DmK,WAA3D,CAAnB;AACAF,cAAM7J,SAAN,GAAkB8J,cAAcA,WAAW9J,SAAzB,IAAsCuB,MAAMvB,SAA9D;AACA6J,cAAM5J,iBAAN,GAA0B6J,cAAcA,WAAW7J,iBAAzB,IAA8C,QAAxE;;AAEA,YAAIyJ,kBAAkB,IAAlB,IAA0BJ,gBAAgBO,MAAMvC,UAAtB,GAAmCoC,cAAjE,EAAiF;AAC/E,iBAAO;AACLb,mBAAO,EADF;AAEL5S,mBAAO,CAFF;AAGLC,oBAAQ;AAHH,WAAP;AAKD;;AAED2T,cAAMpK,SAAN,GAAkBwD,SAAS4G,MAAM9K,IAAf,EAAqBC,IAArB,CAAlB;AACA,YAAIgL,aAAaF,WAAWrK,SAA5B;AACA,YAAIwK,yBAAyBD,cAAc,IAAd,IAAsBA,eAAe,MAAlE,CA3B2C,CA2B+B;AAC1E;;AAEA,YAAI,OAAOA,UAAP,KAAsB,QAAtB,IAAkCA,WAAWpgB,MAAX,CAAkBogB,WAAWl5B,MAAX,GAAoB,CAAtC,MAA6C,GAAnF,EAAwF;AACtF+4B,gBAAMK,YAAN,GAAqBF,UAArB;AACAT,sBAAYn2B,IAAZ,CAAiBy2B,KAAjB;AACAG,uBAAa,CAAb,CAHsF,CAGtE;AAChB;AACD,SALD,MAKO;AACL,cAAIC,sBAAJ,EAA4B;AAC1BD,yBAAaH,MAAMpK,SAAnB,CAD0B,CACI;AAC9B;;AAEA,gBAAIqB,sBAAsBgJ,WAAWhJ,mBAArC;AACA,gBAAIqJ,QAAQrJ,uBAAuBA,oBAAoB4B,KAAvD,CAL0B,CAKoC;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,gBAAIyH,KAAJ,EAAW;AACTA,sBAAQ5E,eAAe4E,KAAf,CAAR;;AAEA,kBAAIpE,aAAaoE,KAAb,CAAJ,EAAyB;AACvBH,6BAAatyB,KAAKqB,GAAL,CAASixB,UAAT,EAAqBG,MAAMlU,KAAN,GAAc8T,WAAd,GAA4BI,MAAMjU,MAAvD,CAAb;AACD;AACF;AACF;;AAED,cAAIkU,WAAWlJ,cAAcA,YAAY,CAAZ,IAAiBA,YAAY,CAAZ,CAA/B,GAAgD,CAA/D;AACA8I,wBAAcI,QAAd;AACA,cAAIC,mBAAmBZ,iBAAiB,IAAjB,GAAwBA,gBAAgB5K,SAAxC,GAAoD,IAA3E;;AAEA,cAAIwL,oBAAoB,IAApB,IAA4BA,mBAAmBL,UAAnD,EAA+D;AAC7D,gBAAI,CAACC,sBAAD,IAA2BI,mBAAmBD,QAAlD,EAA4D;AAC1DP,oBAAM9K,IAAN,GAAa,EAAb;AACA8K,oBAAMpK,SAAN,GAAkBuK,aAAa,CAA/B;AACD,aAHD,MAGO;AACLH,oBAAM9K,IAAN,GAAa2I,aAAamC,MAAM9K,IAAnB,EAAyBsL,mBAAmBD,QAA5C,EAAsDpL,IAAtD,EAA4DoC,SAASwG,QAArE,EAA+E;AAC1FI,yBAAS5G,SAAS4G;AADwE,eAA/E,CAAb;AAGA6B,oBAAMpK,SAAN,GAAkBwD,SAAS4G,MAAM9K,IAAf,EAAqBC,IAArB,CAAlB;AACAgL,2BAAaH,MAAMpK,SAAN,GAAkB2K,QAA/B;AACD;AACF;AACF;;AAEDvL,qBAAagL,MAAM5T,KAAN,GAAc+T,UAA3B;AACAF,uBAAexC,aAAa5vB,KAAKqB,GAAL,CAASuuB,UAAT,EAAqBuC,MAAMvC,UAA3B,CAA5B;AACD;;AAEDqC,WAAK1T,KAAL,GAAa4I,SAAb;AACA8K,WAAKrC,UAAL,GAAkBA,UAAlB;AACAgC,uBAAiBhC,UAAjB;AACAc,qBAAe1wB,KAAKqB,GAAL,CAASqvB,YAAT,EAAuBvJ,SAAvB,CAAf;AACD;;AAEDmI,iBAAaE,UAAb,GAA0BF,aAAa/Q,KAAb,GAAqB1hB,UAAUgtB,MAAM9B,SAAhB,EAA2B2I,YAA3B,CAA/C;AACApB,iBAAaG,WAAb,GAA2BH,aAAa9Q,MAAb,GAAsB3hB,UAAUgtB,MAAM7B,UAAhB,EAA4B4J,aAA5B,CAAjD;;AAEA,QAAIE,UAAJ,EAAgB;AACdxC,mBAAaE,UAAb,IAA2BsC,WAAW,CAAX,IAAgBA,WAAW,CAAX,CAA3C;AACAxC,mBAAaG,WAAb,IAA4BqC,WAAW,CAAX,IAAgBA,WAAW,CAAX,CAA5C;AACD;;AAED,SAAK,IAAI54B,IAAI,CAAb,EAAgBA,IAAI24B,YAAYz4B,MAAhC,EAAwCF,GAAxC,EAA6C;AAC3C,UAAIi5B,QAAQN,YAAY34B,CAAZ,CAAZ;AACA,UAAIs5B,eAAeL,MAAMK,YAAzB,CAF2C,CAEJ;;AAEvCL,YAAM5T,KAAN,GAAcnM,SAASogB,YAAT,EAAuB,EAAvB,IAA6B,GAA7B,GAAmC9B,YAAjD;AACD;;AAED,WAAOpB,YAAP;AACD;;AAED,WAASoC,UAAT,CAAoBkB,KAApB,EAA2Bl1B,GAA3B,EAAgCssB,SAAhC,EAA2C;AACzC,QAAI6I,aAAan1B,QAAQ,EAAzB;AACA,QAAIo1B,OAAOp1B,IAAIgW,KAAJ,CAAU,IAAV,CAAX;AACA,QAAIyd,QAAQyB,MAAMzB,KAAlB;;AAEA,SAAK,IAAIj4B,IAAI,CAAb,EAAgBA,IAAI45B,KAAK15B,MAAzB,EAAiCF,GAAjC,EAAsC;AACpC,UAAImuB,OAAOyL,KAAK55B,CAAL,CAAX;AACA,UAAIi5B,QAAQ;AACVnI,mBAAWA,SADD;AAEV3C,cAAMA,IAFI;AAGV0L,sBAAc,CAAC1L,IAAD,IAAS,CAACwL;AAHd,OAAZ,CAFoC,CAMjC;;AAEH,UAAI,CAAC35B,CAAL,EAAQ;AACN,YAAIg5B,SAAS,CAACf,MAAMA,MAAM/3B,MAAN,GAAe,CAArB,MAA4B+3B,MAAM,CAAN,IAAW;AACnDe,kBAAQ;AAD2C,SAAvC,CAAD,EAETA,MAFJ,CADM,CAGM;AACZ;AACA;AACA;AACA;AACA;AACA;;AAEA,YAAIc,YAAYd,OAAO94B,MAAvB;AACA45B,sBAAc,CAAd,IAAmBd,OAAO,CAAP,EAAUa,YAA7B,GAA4Cb,OAAO,CAAP,IAAYC,KAAxD,GAAgE;AAChE;AACA,SAAC9K,QAAQ,CAAC2L,SAAT,IAAsBH,UAAvB,KAAsCX,OAAOx2B,IAAP,CAAYy2B,KAAZ,CAFtC;AAGD,OAfD,CAeE;AAfF,WAgBK;AACD;AACAhB,gBAAMz1B,IAAN,CAAW;AACTw2B,oBAAQ,CAACC,KAAD;AADC,WAAX;AAGD;AACJ;AACF;;AAED,WAASc,QAAT,CAAkBpJ,KAAlB,EAAyB;AACvB;AACA;AACA,QAAIvC,OAAO,CAACuC,MAAMnC,QAAN,IAAkBmC,MAAMlC,UAAzB,KAAwC,CAACkC,MAAMrC,SAAP,EAAkBqC,MAAMpC,UAAxB,EAAoC,CAACoC,MAAMnC,QAAN,IAAkB,EAAnB,IAAyB,IAA7D,EAAmE;AACtHmC,UAAMlC,UAAN,IAAoB,YAD+B,EACjB1P,IADiB,CACZ,GADY,CAAnD;AAEA,WAAOqP,QAAQ7pB,KAAK6pB,IAAL,CAAR,IAAsBuC,MAAMtC,QAA5B,IAAwCsC,MAAMvC,IAArD;AACD;;AAED,WAAS4L,UAAT,CAAmB3vB,GAAnB,EAAwB4vB,KAAxB,EAA+B;AAC7B,QAAI9zB,IAAI8zB,MAAM9zB,CAAd;AACA,QAAIC,IAAI6zB,MAAM7zB,CAAd;AACA,QAAIif,QAAQ4U,MAAM5U,KAAlB;AACA,QAAIC,SAAS2U,MAAM3U,MAAnB;AACA,QAAI/L,IAAI0gB,MAAM1gB,CAAd;AACA,QAAI2gB,EAAJ;AACA,QAAIC,EAAJ;AACA,QAAIC,EAAJ;AACA,QAAIC,EAAJ,CAT6B,CASrB;;AAER,QAAIhV,QAAQ,CAAZ,EAAe;AACblf,UAAIA,IAAIkf,KAAR;AACAA,cAAQ,CAACA,KAAT;AACD;;AAED,QAAIC,SAAS,CAAb,EAAgB;AACdlf,UAAIA,IAAIkf,MAAR;AACAA,eAAS,CAACA,MAAV;AACD;;AAED,QAAI,OAAO/L,CAAP,KAAa,QAAjB,EAA2B;AACzB2gB,WAAKC,KAAKC,KAAKC,KAAK9gB,CAApB;AACD,KAFD,MAEO,IAAIA,aAAa7a,KAAjB,EAAwB;AAC7B,UAAI6a,EAAErZ,MAAF,KAAa,CAAjB,EAAoB;AAClBg6B,aAAKC,KAAKC,KAAKC,KAAK9gB,EAAE,CAAF,CAApB;AACD,OAFD,MAEO,IAAIA,EAAErZ,MAAF,KAAa,CAAjB,EAAoB;AACzBg6B,aAAKE,KAAK7gB,EAAE,CAAF,CAAV;AACA4gB,aAAKE,KAAK9gB,EAAE,CAAF,CAAV;AACD,OAHM,MAGA,IAAIA,EAAErZ,MAAF,KAAa,CAAjB,EAAoB;AACzBg6B,aAAK3gB,EAAE,CAAF,CAAL;AACA4gB,aAAKE,KAAK9gB,EAAE,CAAF,CAAV;AACA6gB,aAAK7gB,EAAE,CAAF,CAAL;AACD,OAJM,MAIA;AACL2gB,aAAK3gB,EAAE,CAAF,CAAL;AACA4gB,aAAK5gB,EAAE,CAAF,CAAL;AACA6gB,aAAK7gB,EAAE,CAAF,CAAL;AACA8gB,aAAK9gB,EAAE,CAAF,CAAL;AACD;AACF,KAhBM,MAgBA;AACL2gB,WAAKC,KAAKC,KAAKC,KAAK,CAApB;AACD;;AAED,QAAIC,KAAJ;;AAEA,QAAIJ,KAAKC,EAAL,GAAU9U,KAAd,EAAqB;AACnBiV,cAAQJ,KAAKC,EAAb;AACAD,YAAM7U,QAAQiV,KAAd;AACAH,YAAM9U,QAAQiV,KAAd;AACD;;AAED,QAAIF,KAAKC,EAAL,GAAUhV,KAAd,EAAqB;AACnBiV,cAAQF,KAAKC,EAAb;AACAD,YAAM/U,QAAQiV,KAAd;AACAD,YAAMhV,QAAQiV,KAAd;AACD;;AAED,QAAIH,KAAKC,EAAL,GAAU9U,MAAd,EAAsB;AACpBgV,cAAQH,KAAKC,EAAb;AACAD,YAAM7U,SAASgV,KAAf;AACAF,YAAM9U,SAASgV,KAAf;AACD;;AAED,QAAIJ,KAAKG,EAAL,GAAU/U,MAAd,EAAsB;AACpBgV,cAAQJ,KAAKG,EAAb;AACAH,YAAM5U,SAASgV,KAAf;AACAD,YAAM/U,SAASgV,KAAf;AACD;;AAEDjwB,QAAIkwB,MAAJ,CAAWp0B,IAAI+zB,EAAf,EAAmB9zB,CAAnB;AACAiE,QAAImwB,MAAJ,CAAWr0B,IAAIkf,KAAJ,GAAY8U,EAAvB,EAA2B/zB,CAA3B;AACA+zB,WAAO,CAAP,IAAY9vB,IAAIowB,GAAJ,CAAQt0B,IAAIkf,KAAJ,GAAY8U,EAApB,EAAwB/zB,IAAI+zB,EAA5B,EAAgCA,EAAhC,EAAoC,CAACrzB,KAAKgN,EAAN,GAAW,CAA/C,EAAkD,CAAlD,CAAZ;AACAzJ,QAAImwB,MAAJ,CAAWr0B,IAAIkf,KAAf,EAAsBjf,IAAIkf,MAAJ,GAAa8U,EAAnC;AACAA,WAAO,CAAP,IAAY/vB,IAAIowB,GAAJ,CAAQt0B,IAAIkf,KAAJ,GAAY+U,EAApB,EAAwBh0B,IAAIkf,MAAJ,GAAa8U,EAArC,EAAyCA,EAAzC,EAA6C,CAA7C,EAAgDtzB,KAAKgN,EAAL,GAAU,CAA1D,CAAZ;AACAzJ,QAAImwB,MAAJ,CAAWr0B,IAAIk0B,EAAf,EAAmBj0B,IAAIkf,MAAvB;AACA+U,WAAO,CAAP,IAAYhwB,IAAIowB,GAAJ,CAAQt0B,IAAIk0B,EAAZ,EAAgBj0B,IAAIkf,MAAJ,GAAa+U,EAA7B,EAAiCA,EAAjC,EAAqCvzB,KAAKgN,EAAL,GAAU,CAA/C,EAAkDhN,KAAKgN,EAAvD,CAAZ;AACAzJ,QAAImwB,MAAJ,CAAWr0B,CAAX,EAAcC,IAAI8zB,EAAlB;AACAA,WAAO,CAAP,IAAY7vB,IAAIowB,GAAJ,CAAQt0B,IAAI+zB,EAAZ,EAAgB9zB,IAAI8zB,EAApB,EAAwBA,EAAxB,EAA4BpzB,KAAKgN,EAAjC,EAAqChN,KAAKgN,EAAL,GAAU,GAA/C,CAAZ;AACD;;AAED,MAAI4mB,mBAAmB;AACrB1R,UAAM,CADe;AAErBC,WAAO,CAFc;AAGrB0R,YAAQ;AAHa,GAAvB;AAKA,MAAIC,4BAA4B;AAC9BpI,SAAK,CADyB;AAE9BqI,YAAQ,CAFsB;AAG9BC,YAAQ;AAHsB,GAAhC;AAKA;;;;;AAKA,WAASC,kBAAT,CAA4BpK,KAA5B,EAAmC;AACjCqK,mBAAerK,KAAf;AACAvuB,WAAOuuB,MAAMJ,IAAb,EAAmByK,cAAnB;AACA,WAAOrK,KAAP;AACD;;AAED,WAASqK,cAAT,CAAwBrK,KAAxB,EAA+B;AAC7B,QAAIA,KAAJ,EAAW;AACTA,YAAMvC,IAAN,GAAa2L,SAASpJ,KAAT,CAAb;AACA,UAAIvB,YAAYuB,MAAMvB,SAAtB;AACAA,oBAAc,QAAd,KAA2BA,YAAY,QAAvC;AACAuB,YAAMvB,SAAN,GAAkBA,aAAa,IAAb,IAAqBsL,iBAAiBtL,SAAjB,CAArB,GAAmDA,SAAnD,GAA+D,MAAjF,CAJS,CAIgF;;AAEzF,UAAIC,oBAAoBsB,MAAMtB,iBAAN,IAA2BsB,MAAMsK,YAAzD;AACA5L,4BAAsB,QAAtB,KAAmCA,oBAAoB,QAAvD;AACAsB,YAAMtB,iBAAN,GAA0BA,qBAAqB,IAArB,IAA6BuL,0BAA0BvL,iBAA1B,CAA7B,GAA4EA,iBAA5E,GAAgG,KAA1H;AACA,UAAIiB,cAAcK,MAAML,WAAxB;;AAEA,UAAIA,WAAJ,EAAiB;AACfK,cAAML,WAAN,GAAoBrsB,kBAAkB0sB,MAAML,WAAxB,CAApB;AACD;AACF;AACF;AACD;;;;;;;;AASA,WAAS4K,UAAT,CAAoBnG,MAApB,EAA4B1qB,GAA5B,EAAiC8jB,IAAjC,EAAuCwC,KAAvC,EAA8ClK,IAA9C,EAAoD;AAClDkK,UAAMJ,IAAN,GAAa4K,eAAepG,MAAf,EAAuB1qB,GAAvB,EAA4B8jB,IAA5B,EAAkCwC,KAAlC,EAAyClK,IAAzC,CAAb,GAA8D2U,gBAAgBrG,MAAhB,EAAwB1qB,GAAxB,EAA6B8jB,IAA7B,EAAmCwC,KAAnC,EAA0ClK,IAA1C,CAA9D;AACD;;AAED,WAAS2U,eAAT,CAAyBrG,MAAzB,EAAiC1qB,GAAjC,EAAsC8jB,IAAtC,EAA4CwC,KAA5C,EAAmDlK,IAAnD,EAAyD;AACvD,QAAI2H,OAAOiN,OAAOhxB,GAAP,EAAY,MAAZ,EAAoBsmB,MAAMvC,IAAN,IAAc0H,YAAlC,CAAX;AACA,QAAIxF,cAAcK,MAAML,WAAxB;AACA,QAAI8F,eAAerB,OAAOuG,iBAA1B;;AAEA,QAAI,CAAClF,YAAD,IAAiBrB,OAAOjO,OAA5B,EAAqC;AACnCsP,qBAAerB,OAAOuG,iBAAP,GAA2BjF,eAAelI,IAAf,EAAqBC,IAArB,EAA2BkC,WAA3B,EAAwCK,MAAMH,QAA9C,CAA1C;AACD;;AAED,QAAI+F,cAAcH,aAAaG,WAA/B;AACA,QAAIP,YAAYI,aAAa6B,KAA7B;AACA,QAAIvB,aAAaN,aAAaM,UAA9B;AACA,QAAI6E,SAASC,eAAejF,WAAf,EAA4B5F,KAA5B,EAAmClK,IAAnC,CAAb;AACA,QAAIgV,QAAQF,OAAOE,KAAnB;AACA,QAAIC,QAAQH,OAAOG,KAAnB;AACA,QAAItM,YAAYmM,OAAOnM,SAAvB;AACA,QAAIC,oBAAoBkM,OAAOlM,iBAA/B,CAhBuD,CAgBL;;AAElDsM,sBAAkBtxB,GAAlB,EAAuBsmB,KAAvB,EAA8BlK,IAA9B,EAAoCgV,KAApC,EAA2CC,KAA3C;AACA,QAAIE,OAAOnF,YAAYiF,KAAZ,EAAmBnF,WAAnB,EAAgClH,iBAAhC,CAAX;AACA,QAAIwM,QAAQJ,KAAZ;AACA,QAAIK,QAAQF,IAAZ;AACA,QAAIG,aAAaC,mBAAmBrL,KAAnB,CAAjB;;AAEA,QAAIoL,cAAczL,WAAlB,EAA+B;AAC7B;AACA,UAAIzB,YAAYwD,SAASlE,IAAT,EAAeC,IAAf,CAAhB;AACA,UAAIkI,aAAazH,SAAjB;AACAyB,sBAAgBgG,cAAchG,YAAY,CAAZ,IAAiBA,YAAY,CAAZ,CAA/C;AACA,UAAI2L,OAAOzF,YAAYiF,KAAZ,EAAmBnF,UAAnB,EAA+BlH,SAA/B,CAAX;AACA2M,oBAAcG,eAAenH,MAAf,EAAuB1qB,GAAvB,EAA4BsmB,KAA5B,EAAmCsL,IAAnC,EAAyCL,IAAzC,EAA+CtF,UAA/C,EAA2DC,WAA3D,CAAd;;AAEA,UAAIjG,WAAJ,EAAiB;AACfuL,gBAAQM,mBAAmBV,KAAnB,EAA0BrM,SAA1B,EAAqCkB,WAArC,CAAR;AACAwL,iBAASxL,YAAY,CAAZ,CAAT;AACD;AACF;;AAED+K,WAAOhxB,GAAP,EAAY,WAAZ,EAAyB+kB,aAAa,MAAtC,EAtCuD,CAsCR;AAC/C;;AAEAiM,WAAOhxB,GAAP,EAAY,cAAZ,EAA4B,QAA5B,EAzCuD,CAyChB;;AAEvCgxB,WAAOhxB,GAAP,EAAY,YAAZ,EAA0BsmB,MAAMnB,cAAN,IAAwB,CAAlD;AACA6L,WAAOhxB,GAAP,EAAY,aAAZ,EAA2BsmB,MAAMpB,eAAN,IAAyB,aAApD;AACA8L,WAAOhxB,GAAP,EAAY,eAAZ,EAA6BsmB,MAAMlB,iBAAN,IAA2B,CAAxD;AACA4L,WAAOhxB,GAAP,EAAY,eAAZ,EAA6BsmB,MAAMjB,iBAAN,IAA2B,CAAxD,EA9CuD,CA8CK;;AAE5DoM,aAASpF,aAAa,CAAtB;AACA,QAAI3H,kBAAkB4B,MAAM5B,eAA5B;AACA,QAAIH,aAAawN,UAAUzL,MAAM/B,UAAhB,EAA4BG,eAA5B,CAAjB;AACA,QAAIJ,WAAW0N,QAAQ1L,MAAMhC,QAAd,CAAf;;AAEA,QAAIC,UAAJ,EAAgB;AACdyM,aAAOhxB,GAAP,EAAY,WAAZ,EAAyB0kB,eAAzB;AACAsM,aAAOhxB,GAAP,EAAY,aAAZ,EAA2BukB,UAA3B;AACD;;AAED,QAAID,QAAJ,EAAc;AACZ0M,aAAOhxB,GAAP,EAAY,WAAZ,EAAyBskB,QAAzB;AACD;;AAED,SAAK,IAAI3uB,IAAI,CAAb,EAAgBA,IAAIg2B,UAAU91B,MAA9B,EAAsCF,GAAtC,EAA2C;AACzC;AACA4uB,oBAAcvkB,IAAIiyB,UAAJ,CAAetG,UAAUh2B,CAAV,CAAf,EAA6B67B,KAA7B,EAAoCC,KAApC,CAAd;AACAnN,kBAAYtkB,IAAIkyB,QAAJ,CAAavG,UAAUh2B,CAAV,CAAb,EAA2B67B,KAA3B,EAAkCC,KAAlC,CAAZ;AACAA,eAASpF,UAAT;AACD;AACF;;AAED,WAASyE,cAAT,CAAwBpG,MAAxB,EAAgC1qB,GAAhC,EAAqC8jB,IAArC,EAA2CwC,KAA3C,EAAkDlK,IAAlD,EAAwD;AACtD,QAAI2P,eAAerB,OAAOuG,iBAA1B;;AAEA,QAAI,CAAClF,YAAD,IAAiBrB,OAAOjO,OAA5B,EAAqC;AACnCsP,qBAAerB,OAAOuG,iBAAP,GAA2B3E,cAAcxI,IAAd,EAAoBwC,KAApB,CAA1C;AACD;;AAED6L,iBAAazH,MAAb,EAAqB1qB,GAArB,EAA0B+rB,YAA1B,EAAwCzF,KAAxC,EAA+ClK,IAA/C;AACD;;AAED,WAAS+V,YAAT,CAAsBzH,MAAtB,EAA8B1qB,GAA9B,EAAmC+rB,YAAnC,EAAiDzF,KAAjD,EAAwDlK,IAAxD,EAA8D;AAC5D,QAAI+Q,eAAepB,aAAa/Q,KAAhC;AACA,QAAIiR,aAAaF,aAAaE,UAA9B;AACA,QAAIC,cAAcH,aAAaG,WAA/B;AACA,QAAIjG,cAAcK,MAAML,WAAxB;AACA,QAAIiL,SAASC,eAAejF,WAAf,EAA4B5F,KAA5B,EAAmClK,IAAnC,CAAb;AACA,QAAIgV,QAAQF,OAAOE,KAAnB;AACA,QAAIC,QAAQH,OAAOG,KAAnB;AACA,QAAItM,YAAYmM,OAAOnM,SAAvB;AACA,QAAIC,oBAAoBkM,OAAOlM,iBAA/B,CAT4D,CASV;;AAElDsM,sBAAkBtxB,GAAlB,EAAuBsmB,KAAvB,EAA8BlK,IAA9B,EAAoCgV,KAApC,EAA2CC,KAA3C;AACA,QAAIO,OAAOzF,YAAYiF,KAAZ,EAAmBnF,UAAnB,EAA+BlH,SAA/B,CAAX;AACA,QAAIwM,OAAOnF,YAAYiF,KAAZ,EAAmBnF,WAAnB,EAAgClH,iBAAhC,CAAX;AACA,QAAIoN,QAAQR,IAAZ;AACA,QAAIS,UAAUd,IAAd;;AAEA,QAAItL,WAAJ,EAAiB;AACfmM,eAASnM,YAAY,CAAZ,CAAT;AACAoM,iBAAWpM,YAAY,CAAZ,CAAX;AACD;;AAED,QAAIqM,SAASF,QAAQjF,YAArB;AACAwE,uBAAmBrL,KAAnB,KAA6BuL,eAAenH,MAAf,EAAuB1qB,GAAvB,EAA4BsmB,KAA5B,EAAmCsL,IAAnC,EAAyCL,IAAzC,EAA+CtF,UAA/C,EAA2DC,WAA3D,CAA7B;;AAEA,SAAK,IAAIv2B,IAAI,CAAb,EAAgBA,IAAIo2B,aAAa6B,KAAb,CAAmB/3B,MAAvC,EAA+CF,GAA/C,EAAoD;AAClD,UAAI+4B,OAAO3C,aAAa6B,KAAb,CAAmBj4B,CAAnB,CAAX;AACA,UAAIg5B,SAASD,KAAKC,MAAlB;AACA,UAAI4D,aAAa5D,OAAO94B,MAAxB;AACA,UAAIw2B,aAAaqC,KAAKrC,UAAtB;AACA,UAAImG,YAAY9D,KAAK1T,KAArB;AACA,UAAIjJ,YAAY,CAAhB;AACA,UAAI0gB,YAAYL,KAAhB;AACA,UAAIM,aAAaJ,MAAjB;AACA,UAAIrgB,aAAasgB,aAAa,CAA9B;AACA,UAAI3D,KAAJ;;AAEA,aAAO7c,YAAYwgB,UAAZ,KAA2B3D,QAAQD,OAAO5c,SAAP,CAAR,EAA2B,CAAC6c,MAAM7J,SAAP,IAAoB6J,MAAM7J,SAAN,KAAoB,MAA9F,CAAP,EAA8G;AAC5G4N,mBAAWjI,MAAX,EAAmB1qB,GAAnB,EAAwB4uB,KAAxB,EAA+BtI,KAA/B,EAAsC+F,UAAtC,EAAkDgG,OAAlD,EAA2DI,SAA3D,EAAsE,MAAtE;AACAD,qBAAa5D,MAAM5T,KAAnB;AACAyX,qBAAa7D,MAAM5T,KAAnB;AACAjJ;AACD;;AAED,aAAOE,cAAc,CAAd,KAAoB2c,QAAQD,OAAO1c,UAAP,CAAR,EAA4B2c,MAAM7J,SAAN,KAAoB,OAApE,CAAP,EAAqF;AACnF4N,mBAAWjI,MAAX,EAAmB1qB,GAAnB,EAAwB4uB,KAAxB,EAA+BtI,KAA/B,EAAsC+F,UAAtC,EAAkDgG,OAAlD,EAA2DK,UAA3D,EAAuE,OAAvE;AACAF,qBAAa5D,MAAM5T,KAAnB;AACA0X,sBAAc9D,MAAM5T,KAApB;AACA/I;AACD,OAxBiD,CAwBhD;;;AAGFwgB,mBAAa,CAACtF,gBAAgBsF,YAAYL,KAA5B,KAAsCE,SAASI,UAA/C,IAA6DF,SAA9D,IAA2E,CAAxF;;AAEA,aAAOzgB,aAAaE,UAApB,EAAgC;AAC9B2c,gBAAQD,OAAO5c,SAAP,CAAR,CAD8B,CACH;;AAE3B4gB,mBAAWjI,MAAX,EAAmB1qB,GAAnB,EAAwB4uB,KAAxB,EAA+BtI,KAA/B,EAAsC+F,UAAtC,EAAkDgG,OAAlD,EAA2DI,YAAY7D,MAAM5T,KAAN,GAAc,CAArF,EAAwF,QAAxF;AACAyX,qBAAa7D,MAAM5T,KAAnB;AACAjJ;AACD;;AAEDsgB,iBAAWhG,UAAX;AACD;AACF;;AAED,WAASiF,iBAAT,CAA2BtxB,GAA3B,EAAgCsmB,KAAhC,EAAuClK,IAAvC,EAA6CtgB,CAA7C,EAAgDC,CAAhD,EAAmD;AACjD;AACA,QAAIqgB,QAAQkK,MAAMX,YAAlB,EAAgC;AAC9B,UAAIte,SAASif,MAAMV,UAAnB;;AAEA,UAAIve,WAAW,QAAf,EAAyB;AACvBvL,YAAIsgB,KAAKpB,KAAL,GAAa,CAAb,GAAiBoB,KAAKtgB,CAA1B;AACAC,YAAIqgB,KAAKnB,MAAL,GAAc,CAAd,GAAkBmB,KAAKrgB,CAA3B;AACD,OAHD,MAGO,IAAIsL,MAAJ,EAAY;AACjBvL,YAAIuL,OAAO,CAAP,IAAY+U,KAAKtgB,CAArB;AACAC,YAAIsL,OAAO,CAAP,IAAY+U,KAAKrgB,CAArB;AACD;;AAEDiE,UAAI0F,SAAJ,CAAc5J,CAAd,EAAiBC,CAAjB,EAX8B,CAWT;;AAErBiE,UAAI2F,MAAJ,CAAW,CAAC2gB,MAAMX,YAAlB;AACA3lB,UAAI0F,SAAJ,CAAc,CAAC5J,CAAf,EAAkB,CAACC,CAAnB;AACD;AACF;;AAED,WAAS42B,UAAT,CAAoBjI,MAApB,EAA4B1qB,GAA5B,EAAiC4uB,KAAjC,EAAwCtI,KAAxC,EAA+C+F,UAA/C,EAA2DgG,OAA3D,EAAoEv2B,CAApE,EAAuEipB,SAAvE,EAAkF;AAChF,QAAI8J,aAAavI,MAAMJ,IAAN,CAAW0I,MAAMnI,SAAjB,KAA+B,EAAhD,CADgF,CAC5B;AACpD;;AAEA,QAAIzB,oBAAoB4J,MAAM5J,iBAA9B;AACA,QAAIjpB,IAAIs2B,UAAUhG,aAAa,CAA/B;;AAEA,QAAIrH,sBAAsB,KAA1B,EAAiC;AAC/BjpB,UAAIs2B,UAAUzD,MAAM3T,MAAN,GAAe,CAA7B;AACD,KAFD,MAEO,IAAI+J,sBAAsB,QAA1B,EAAoC;AACzCjpB,UAAIs2B,UAAUhG,UAAV,GAAuBuC,MAAM3T,MAAN,GAAe,CAA1C;AACD;;AAED,KAAC2T,MAAMY,YAAP,IAAuBmC,mBAAmB9C,UAAnB,CAAvB,IAAyDgD,eAAenH,MAAf,EAAuB1qB,GAAvB,EAA4B6uB,UAA5B,EAAwC9J,cAAc,OAAd,GAAwBjpB,IAAI8yB,MAAM5T,KAAlC,GAA0C+J,cAAc,QAAd,GAAyBjpB,IAAI8yB,MAAM5T,KAAN,GAAc,CAA3C,GAA+Clf,CAAjI,EAAoIC,IAAI6yB,MAAM3T,MAAN,GAAe,CAAvJ,EAA0J2T,MAAM5T,KAAhK,EAAuK4T,MAAM3T,MAA7K,CAAzD;AACA,QAAIgL,cAAc2I,MAAM3I,WAAxB;;AAEA,QAAIA,WAAJ,EAAiB;AACfnqB,UAAIg2B,mBAAmBh2B,CAAnB,EAAsBipB,SAAtB,EAAiCkB,WAAjC,CAAJ;AACAlqB,WAAK6yB,MAAM3T,MAAN,GAAe,CAAf,GAAmBgL,YAAY,CAAZ,CAAnB,GAAoC2I,MAAMnK,UAAN,GAAmB,CAA5D;AACD;;AAEDuM,WAAOhxB,GAAP,EAAY,YAAZ,EAA0BvG,UAAUo1B,WAAW1J,cAArB,EAAqCmB,MAAMnB,cAA3C,EAA2D,CAA3D,CAA1B;AACA6L,WAAOhxB,GAAP,EAAY,aAAZ,EAA2B6uB,WAAW3J,eAAX,IAA8BoB,MAAMpB,eAApC,IAAuD,aAAlF;AACA8L,WAAOhxB,GAAP,EAAY,eAAZ,EAA6BvG,UAAUo1B,WAAWzJ,iBAArB,EAAwCkB,MAAMlB,iBAA9C,EAAiE,CAAjE,CAA7B;AACA4L,WAAOhxB,GAAP,EAAY,eAAZ,EAA6BvG,UAAUo1B,WAAWxJ,iBAArB,EAAwCiB,MAAMjB,iBAA9C,EAAiE,CAAjE,CAA7B;AACA2L,WAAOhxB,GAAP,EAAY,WAAZ,EAAyB+kB,SAAzB,EAzBgF,CAyB3C;AACrC;;AAEAiM,WAAOhxB,GAAP,EAAY,cAAZ,EAA4B,QAA5B;AACAgxB,WAAOhxB,GAAP,EAAY,MAAZ,EAAoB4uB,MAAM7K,IAAN,IAAc0H,YAAlC;AACA,QAAIlH,aAAawN,UAAUlD,WAAWtK,UAAX,IAAyB+B,MAAM/B,UAAzC,EAAqDG,eAArD,CAAjB;AACA,QAAIJ,WAAW0N,QAAQnD,WAAWvK,QAAX,IAAuBgC,MAAMhC,QAArC,CAAf;AACA,QAAII,kBAAkBprB,UAAUu1B,WAAWnK,eAArB,EAAsC4B,MAAM5B,eAA5C,CAAtB,CAhCgF,CAgCI;;AAEpF,QAAIH,UAAJ,EAAgB;AACdyM,aAAOhxB,GAAP,EAAY,WAAZ,EAAyB0kB,eAAzB;AACAsM,aAAOhxB,GAAP,EAAY,aAAZ,EAA2BukB,UAA3B;AACAvkB,UAAIiyB,UAAJ,CAAerD,MAAM9K,IAArB,EAA2BhoB,CAA3B,EAA8BC,CAA9B;AACD;;AAED,QAAIuoB,QAAJ,EAAc;AACZ0M,aAAOhxB,GAAP,EAAY,WAAZ,EAAyBskB,QAAzB;AACAtkB,UAAIkyB,QAAJ,CAAatD,MAAM9K,IAAnB,EAAyBhoB,CAAzB,EAA4BC,CAA5B;AACD;AACF;;AAED,WAAS41B,kBAAT,CAA4BrL,KAA5B,EAAmC;AACjC,WAAOA,MAAMT,mBAAN,IAA6BS,MAAMP,eAAN,IAAyBO,MAAMR,eAAnE;AACD,GAxtP2B,CAwtP1B;AACF;;;AAGA,WAAS+L,cAAT,CAAwBnH,MAAxB,EAAgC1qB,GAAhC,EAAqCsmB,KAArC,EAA4CxqB,CAA5C,EAA+CC,CAA/C,EAAkDif,KAAlD,EAAyDC,MAAzD,EAAiE;AAC/D,QAAI4K,sBAAsBS,MAAMT,mBAAhC;AACA,QAAIE,kBAAkBO,MAAMP,eAA5B;AACA,QAAID,kBAAkBQ,MAAMR,eAA5B;AACA,QAAI8M,YAAY95B,SAAS+sB,mBAAT,CAAhB;AACAmL,WAAOhxB,GAAP,EAAY,YAAZ,EAA0BsmB,MAAMf,iBAAN,IAA2B,CAArD;AACAyL,WAAOhxB,GAAP,EAAY,aAAZ,EAA2BsmB,MAAMhB,kBAAN,IAA4B,aAAvD;AACA0L,WAAOhxB,GAAP,EAAY,eAAZ,EAA6BsmB,MAAMd,oBAAN,IAA8B,CAA3D;AACAwL,WAAOhxB,GAAP,EAAY,eAAZ,EAA6BsmB,MAAMb,oBAAN,IAA8B,CAA3D;;AAEA,QAAImN,aAAa7M,mBAAmBD,eAApC,EAAqD;AACnD9lB,UAAI6yB,SAAJ;AACA,UAAI7M,mBAAmBM,MAAMN,gBAA7B;;AAEA,UAAI,CAACA,gBAAL,EAAuB;AACrBhmB,YAAIoc,IAAJ,CAAStgB,CAAT,EAAYC,CAAZ,EAAeif,KAAf,EAAsBC,MAAtB;AACD,OAFD,MAEO;AACL0U,mBAAU3vB,GAAV,EAAe;AACblE,aAAGA,CADU;AAEbC,aAAGA,CAFU;AAGbif,iBAAOA,KAHM;AAIbC,kBAAQA,MAJK;AAKb/L,aAAG8W;AALU,SAAf;AAOD;;AAEDhmB,UAAI8yB,SAAJ;AACD;;AAED,QAAIF,SAAJ,EAAe;AACb5B,aAAOhxB,GAAP,EAAY,WAAZ,EAAyB6lB,mBAAzB;AACA7lB,UAAIojB,IAAJ;AACD,KAHD,MAGO,IAAI7sB,WAAWsvB,mBAAX,CAAJ,EAAqC;AAC1C,UAAI4B,QAAQ5B,oBAAoB4B,KAAhC;AACAA,cAAQgD,oBAAoBhD,KAApB,EAA2B,IAA3B,EAAiCiD,MAAjC,EAAyCqI,eAAzC,EAA0DlN,mBAA1D,CAAR;;AAEA,UAAI4B,SAASqD,aAAarD,KAAb,CAAb,EAAkC;AAChCznB,YAAIypB,SAAJ,CAAchC,KAAd,EAAqB3rB,CAArB,EAAwBC,CAAxB,EAA2Bif,KAA3B,EAAkCC,MAAlC;AACD;AACF;;AAED,QAAI8K,mBAAmBD,eAAvB,EAAwC;AACtCkL,aAAOhxB,GAAP,EAAY,WAAZ,EAAyB+lB,eAAzB;AACAiL,aAAOhxB,GAAP,EAAY,aAAZ,EAA2B8lB,eAA3B;AACA9lB,UAAIqjB,MAAJ;AACD;AACF;;AAED,WAAS0P,eAAT,CAAyBtL,KAAzB,EAAgC5B,mBAAhC,EAAqD;AACnD;AACA;AACAA,wBAAoB4B,KAApB,GAA4BA,KAA5B;AACD;;AAED,WAAS0J,cAAT,CAAwB6B,UAAxB,EAAoC1M,KAApC,EAA2ClK,IAA3C,EAAiD;AAC/C,QAAIgV,QAAQ9K,MAAMxqB,CAAN,IAAW,CAAvB;AACA,QAAIu1B,QAAQ/K,MAAMvqB,CAAN,IAAW,CAAvB;AACA,QAAIgpB,YAAYuB,MAAMvB,SAAtB;AACA,QAAIC,oBAAoBsB,MAAMtB,iBAA9B,CAJ+C,CAIE;;AAEjD,QAAI5I,IAAJ,EAAU;AACR,UAAIwI,eAAe0B,MAAM1B,YAAzB;;AAEA,UAAIA,wBAAwBvwB,KAA5B,EAAmC;AACjC;AACA+8B,gBAAQhV,KAAKtgB,CAAL,GAASm3B,aAAarO,aAAa,CAAb,CAAb,EAA8BxI,KAAKpB,KAAnC,CAAjB;AACAqW,gBAAQjV,KAAKrgB,CAAL,GAASk3B,aAAarO,aAAa,CAAb,CAAb,EAA8BxI,KAAKnB,MAAnC,CAAjB;AACD,OAJD,MAIO;AACL,YAAIiY,MAAM3G,yBAAyB3H,YAAzB,EAAuCxI,IAAvC,EAA6CkK,MAAMrB,YAAnD,CAAV;AACAmM,gBAAQ8B,IAAIp3B,CAAZ;AACAu1B,gBAAQ6B,IAAIn3B,CAAZ,CAHK,CAGU;;AAEfgpB,oBAAYA,aAAamO,IAAInO,SAA7B;AACAC,4BAAoBA,qBAAqBkO,IAAIlO,iBAA7C;AACD,OAdO,CAcN;AACF;;;AAGA,UAAIF,aAAawB,MAAMxB,UAAvB;;AAEA,UAAIA,UAAJ,EAAgB;AACdsM,iBAAStM,WAAW,CAAX,CAAT;AACAuM,iBAASvM,WAAW,CAAX,CAAT;AACD;AACF;;AAED,WAAO;AACLsM,aAAOA,KADF;AAELC,aAAOA,KAFF;AAGLtM,iBAAWA,SAHN;AAILC,yBAAmBA;AAJd,KAAP;AAMD;;AAED,WAASgM,MAAT,CAAgBhxB,GAAhB,EAAqBtI,IAArB,EAA2BN,KAA3B,EAAkC;AAChC4I,QAAItI,IAAJ,IAAYgrB,UAAU1iB,GAAV,EAAetI,IAAf,EAAqBN,KAArB,CAAZ;AACA,WAAO4I,IAAItI,IAAJ,CAAP;AACD;AACD;;;;;;AAOA,WAASq6B,SAAT,CAAmB1O,MAAnB,EAA2BO,SAA3B,EAAsC;AACpC,WAAOP,UAAU,IAAV,IAAkBO,aAAa,CAA/B,IAAoCP,WAAW,aAA/C,IAAgEA,WAAW,MAA3E,GAAoF,IAApF,CAAyF;AAAzF,MACLA,OAAOoE,KAAP,IAAgBpE,OAAOgE,UAAvB,GAAoC,MAApC,GAA6ChE,MAD/C;AAED;AACD,WAAS2O,OAAT,CAAiB5O,IAAjB,EAAuB;AACrB,WAAOA,QAAQ,IAAR,IAAgBA,SAAS,MAAzB,GAAkC,IAAlC,CAAuC;AAAvC,MACLA,KAAKqE,KAAL,IAAcrE,KAAKiE,UAAnB,GAAgC,MAAhC,GAAyCjE,IAD3C;AAED;;AAED,WAAS6P,YAAT,CAAsB77B,KAAtB,EAA6B+7B,QAA7B,EAAuC;AACrC,QAAI,OAAO/7B,KAAP,KAAiB,QAArB,EAA+B;AAC7B,UAAIA,MAAMg8B,WAAN,CAAkB,GAAlB,KAA0B,CAA9B,EAAiC;AAC/B,eAAOxkB,WAAWxX,KAAX,IAAoB,GAApB,GAA0B+7B,QAAjC;AACD;;AAED,aAAOvkB,WAAWxX,KAAX,CAAP;AACD;;AAED,WAAOA,KAAP;AACD;;AAED,WAAS06B,kBAAT,CAA4Bh2B,CAA5B,EAA+BipB,SAA/B,EAA0CkB,WAA1C,EAAuD;AACrD,WAAOlB,cAAc,OAAd,GAAwBjpB,IAAImqB,YAAY,CAAZ,CAA5B,GAA6ClB,cAAc,QAAd,GAAyBjpB,IAAImqB,YAAY,CAAZ,IAAiB,CAArB,GAAyBA,YAAY,CAAZ,IAAiB,CAAnE,GAAuEnqB,IAAImqB,YAAY,CAAZ,CAA/H;AACD;AACD;;;;;;AAOA,WAASoN,YAAT,CAAsBvP,IAAtB,EAA4BwC,KAA5B,EAAmC;AACjC,WAAOxC,QAAQ,IAAR,KAAiBA,QAAQwC,MAAMT,mBAAd,IAAqCS,MAAMP,eAAN,IAAyBO,MAAMR,eAApE,IAAuFQ,MAAML,WAA9G,CAAP;AACD;;AAED;;;;AAIA,MAAIqN,YAAY,IAAIvY,YAAJ,EAAhB;;AAEA,MAAIwY,WAAW,SAAXA,QAAW,GAAY,CAAE,CAA7B;;AAEAA,WAASr/B,SAAT,GAAqB;AACnB6B,iBAAaw9B,QADM;;AAGnB;;;;;AAKAC,kBAAc,sBAAUxzB,GAAV,EAAeoc,IAAf,EAAqB;AACjC,UAAIkK,QAAQ,KAAKA,KAAjB;AACAlK,aAAOkK,MAAMzB,QAAN,IAAkBzI,IAAzB,CAFiC,CAEF;;AAE/B,WAAKK,OAAL,IAAgBiU,mBAAmBpK,KAAnB,EAA0B,IAA1B,CAAhB;AACA,UAAIxC,OAAOwC,MAAMxC,IAAjB,CALiC,CAKV;;AAEvBA,cAAQ,IAAR,KAAiBA,QAAQ,EAAzB;;AAEA,UAAI,CAACuP,aAAavP,IAAb,EAAmBwC,KAAnB,CAAL,EAAgC;AAC9B;AACD,OAXgC,CAW/B;;;AAGFtmB,UAAI6pB,IAAJ,GAdiC,CAcrB;;AAEZ,UAAItiB,YAAY,KAAKA,SAArB;;AAEA,UAAI,CAAC+e,MAAMZ,aAAX,EAA0B;AACxB,YAAIne,SAAJ,EAAe;AACb+rB,oBAAUr3B,IAAV,CAAemgB,IAAf;AACAkX,oBAAU31B,cAAV,CAAyB4J,SAAzB;AACA6U,iBAAOkX,SAAP;AACD;AACF,OAND,MAMO;AACL,aAAKzrB,YAAL,CAAkB7H,GAAlB;AACD,OA1BgC,CA0B/B;;;AAGF6wB,iBAAW,IAAX,EAAiB7wB,GAAjB,EAAsB8jB,IAAtB,EAA4BwC,KAA5B,EAAmClK,IAAnC;AACApc,UAAI+pB,OAAJ;AACD;AAvCkB,GAArB;;AA0CA;;;;;AAKA;;;;;;AAMA,WAAS0J,WAAT,CAAqBvsB,IAArB,EAA2B;AACzBA,WAAOA,QAAQ,EAAf;AACA0S,YAAQnkB,IAAR,CAAa,IAAb,EAAmByR,IAAnB,EAFyB,CAEC;;AAE1B,SAAK,IAAIhS,IAAT,IAAiBgS,IAAjB,EAAuB;AACrB,UAAIA,KAAK/Q,cAAL,CAAoBjB,IAApB,KAA6BA,SAAS,OAA1C,EAAmD;AACjD,aAAKA,IAAL,IAAagS,KAAKhS,IAAL,CAAb;AACD;AACF;AACD;;;;AAKA,SAAKoxB,KAAL,GAAa,IAAI1D,KAAJ,CAAU1b,KAAKof,KAAf,EAAsB,IAAtB,CAAb;AACA,SAAKoN,KAAL,GAAa,IAAb,CAfyB,CAeN;;AAEnB,SAAKvR,WAAL,GAAmB,EAAnB,CAjByB,CAiBF;AACvB;AACD;;AAEDsR,cAAYv/B,SAAZ,GAAwB;AACtB6B,iBAAa09B,WADS;AAEtB16B,UAAM,aAFgB;;AAItB;;;;;;AAMA0jB,aAAS,IAVa;;AAYtB;;;;;;;AAOAoB,eAAW,KAnBW;;AAqBtB;;;;;AAKAuD,OAAG,CA1BmB;;AA4BtB;;;;;AAKAC,QAAI,CAjCkB;;AAmCtB;;;;;;AAMAF,YAAQ,CAzCc;;AA2CtB;;;;;;AAMA5iB,eAAW,KAjDW;;AAmDtB;;;;;;AAMAE,cAAU,KAzDY;;AA2DtB;;;;;;AAMAiF,YAAQ,KAjEc;;AAmEtB;;;;;AAKAiwB,aAAS,KAxEa;;AA0EtB;;;;;AAKA/wB,YAAQ,SA/Ec;;AAiFtB;;;;;AAKA8B,eAAW,KAtFW;;AAwFtB;;;;;AAKAkvB,iBAAa,KA7FS;;AA+FtB;;;AAGAzK,iBAAa,KAlGS;AAmGtB;AACA0K,aAAS,KApGa;AAqGtBC,iBAAa,qBAAU9zB,GAAV,EAAe,CAAE,CArGR;AAsGtB+zB,gBAAY,oBAAU/zB,GAAV,EAAe,CAAE,CAtGP;;AAwGtB;;;;AAIA;AACAg0B,WAAO,eAAUh0B,GAAV,EAAeqmB,MAAf,EAAuB,CAAE,CA7GV;;AA+GtB;;;;AAIA;AACA5I,qBAAiB,2BAAY,CAAE,CApHT;;AAsHtB;;;;;;;AAOA7Y,aAAS,iBAAU9I,CAAV,EAAaC,CAAb,EAAgB;AACvB,aAAO,KAAKk4B,WAAL,CAAiBn4B,CAAjB,EAAoBC,CAApB,CAAP;AACD,KA/HqB;;AAiItB;;;;AAIAke,cAAU,kBAAUhiB,EAAV,EAAcC,OAAd,EAAuB;AAC/BD,SAAGxC,IAAH,CAAQyC,OAAR,EAAiB,IAAjB;AACD,KAvIqB;;AAyItB;;;;;;;AAOA+7B,iBAAa,qBAAUn4B,CAAV,EAAaC,CAAb,EAAgB;AAC3B,UAAIm4B,QAAQ,KAAK3rB,qBAAL,CAA2BzM,CAA3B,EAA8BC,CAA9B,CAAZ;AACA,UAAIqgB,OAAO,KAAKqB,eAAL,EAAX;AACA,aAAOrB,KAAKxX,OAAL,CAAasvB,MAAM,CAAN,CAAb,EAAuBA,MAAM,CAAN,CAAvB,CAAP;AACD,KApJqB;;AAsJtB;;;;AAIA/a,WAAO,iBAAY;AACjB,WAAKsD,OAAL,GAAe,IAAf;AACA,WAAKiX,KAAL,GAAa,IAAb;AACA,WAAKlxB,IAAL,IAAa,KAAKA,IAAL,CAAU4X,OAAV,EAAb;AACD,KA9JqB;;AAgKtB;;;;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;AAIA+Z,kBAAc,sBAAU7oB,IAAV,EAAgB;AAC5B,aAAO,KAAKuN,OAAL,CAAa,OAAb,EAAsBvN,IAAtB,CAAP;AACD,KAtLqB;AAuLtB4O,YAAQ,gBAAUhkB,GAAV,EAAekB,KAAf,EAAsB;AAC5B,UAAIlB,QAAQ,OAAZ,EAAqB;AACnB0jB,gBAAQ1lB,SAAR,CAAkBgmB,MAAlB,CAAyBzkB,IAAzB,CAA8B,IAA9B,EAAoCS,GAApC,EAAyCkB,KAAzC;AACD,OAFD,MAEO;AACL,aAAKkvB,KAAL,CAAW1rB,GAAX,CAAexD,KAAf;AACD;AACF,KA7LqB;;AA+LtB;;;;AAIAg9B,cAAU,kBAAUl+B,GAAV,EAAekB,KAAf,EAAsB;AAC9B,WAAKkvB,KAAL,CAAW1rB,GAAX,CAAe1E,GAAf,EAAoBkB,KAApB;AACA,WAAK+hB,KAAL,CAAW,KAAX;AACA,aAAO,IAAP;AACD,KAvMqB;;AAyMtB;;;;AAIAkb,cAAU,kBAAUr8B,GAAV,EAAe;AACvB,WAAKsuB,KAAL,GAAa,IAAI1D,KAAJ,CAAU5qB,GAAV,EAAe,IAAf,CAAb;AACA,WAAKmhB,KAAL,CAAW,KAAX;AACA,aAAO,IAAP;AACD;AAjNqB,GAAxB;AAmNA9hB,WAASo8B,WAAT,EAAsB7Z,OAAtB;AACAhiB,QAAM67B,WAAN,EAAmBF,QAAnB,EA9oQ4B,CA8oQE;;AAE9B;;;;;;;AAOA,WAASe,MAAT,CAAgBptB,IAAhB,EAAsB;AACpBusB,gBAAYh+B,IAAZ,CAAiB,IAAjB,EAAuByR,IAAvB;AACD;;AAEDotB,SAAOpgC,SAAP,GAAmB;AACjB6B,iBAAau+B,MADI;AAEjBv7B,UAAM,OAFW;AAGjBi7B,WAAO,eAAUh0B,GAAV,EAAeqmB,MAAf,EAAuB;AAC5B,UAAIC,QAAQ,KAAKA,KAAjB;AACA,UAAI8E,MAAM9E,MAAMmB,KAAhB,CAF4B,CAEL;;AAEvBnB,YAAMhuB,IAAN,CAAW0H,GAAX,EAAgB,IAAhB,EAAsBqmB,MAAtB;AACA,UAAIoB,QAAQ,KAAK8M,MAAL,GAAc9J,oBAAoBW,GAApB,EAAyB,KAAKmJ,MAA9B,EAAsC,IAAtC,EAA4C,KAAKtJ,MAAjD,CAA1B;;AAEA,UAAI,CAACxD,KAAD,IAAU,CAACqD,aAAarD,KAAb,CAAf,EAAoC;AAClC;AACD,OAT2B,CAS1B;AACF;AACA;AACA;AACA;AACA;AACA;;;AAGA,UAAI3rB,IAAIwqB,MAAMxqB,CAAN,IAAW,CAAnB;AACA,UAAIC,IAAIuqB,MAAMvqB,CAAN,IAAW,CAAnB;AACA,UAAIif,QAAQsL,MAAMtL,KAAlB;AACA,UAAIC,SAASqL,MAAMrL,MAAnB;AACA,UAAIuZ,SAAS/M,MAAMzM,KAAN,GAAcyM,MAAMxM,MAAjC;;AAEA,UAAID,SAAS,IAAT,IAAiBC,UAAU,IAA/B,EAAqC;AACnC;AACAD,gBAAQC,SAASuZ,MAAjB;AACD,OAHD,MAGO,IAAIvZ,UAAU,IAAV,IAAkBD,SAAS,IAA/B,EAAqC;AAC1CC,iBAASD,QAAQwZ,MAAjB;AACD,OAFM,MAEA,IAAIxZ,SAAS,IAAT,IAAiBC,UAAU,IAA/B,EAAqC;AAC1CD,gBAAQyM,MAAMzM,KAAd;AACAC,iBAASwM,MAAMxM,MAAf;AACD,OAhC2B,CAgC1B;;;AAGF,WAAKpT,YAAL,CAAkB7H,GAAlB;;AAEA,UAAIsmB,MAAMmO,MAAN,IAAgBnO,MAAMoO,OAA1B,EAAmC;AACjC,YAAIxsB,KAAKoe,MAAMpe,EAAN,IAAY,CAArB;AACA,YAAIC,KAAKme,MAAMne,EAAN,IAAY,CAArB;AACAnI,YAAIypB,SAAJ,CAAchC,KAAd,EAAqBvf,EAArB,EAAyBC,EAAzB,EAA6Bme,MAAMmO,MAAnC,EAA2CnO,MAAMoO,OAAjD,EAA0D54B,CAA1D,EAA6DC,CAA7D,EAAgEif,KAAhE,EAAuEC,MAAvE;AACD,OAJD,MAIO,IAAIqL,MAAMpe,EAAN,IAAYoe,MAAMne,EAAtB,EAA0B;AAC/B,YAAID,KAAKoe,MAAMpe,EAAf;AACA,YAAIC,KAAKme,MAAMne,EAAf;AACA,YAAIssB,SAASzZ,QAAQ9S,EAArB;AACA,YAAIwsB,UAAUzZ,SAAS9S,EAAvB;AACAnI,YAAIypB,SAAJ,CAAchC,KAAd,EAAqBvf,EAArB,EAAyBC,EAAzB,EAA6BssB,MAA7B,EAAqCC,OAArC,EAA8C54B,CAA9C,EAAiDC,CAAjD,EAAoDif,KAApD,EAA2DC,MAA3D;AACD,OANM,MAMA;AACLjb,YAAIypB,SAAJ,CAAchC,KAAd,EAAqB3rB,CAArB,EAAwBC,CAAxB,EAA2Bif,KAA3B,EAAkCC,MAAlC;AACD,OAjD2B,CAiD1B;;;AAGF,UAAIqL,MAAMxC,IAAN,IAAc,IAAlB,EAAwB;AACtB;AACA,aAAK/b,gBAAL,CAAsB/H,GAAtB;AACA,aAAKwzB,YAAL,CAAkBxzB,GAAlB,EAAuB,KAAKyd,eAAL,EAAvB;AACD;AACF,KA5DgB;AA6DjBA,qBAAiB,2BAAY;AAC3B,UAAI6I,QAAQ,KAAKA,KAAjB;;AAEA,UAAI,CAAC,KAAKoN,KAAV,EAAiB;AACf,aAAKA,KAAL,GAAa,IAAI3Y,YAAJ,CAAiBuL,MAAMxqB,CAAN,IAAW,CAA5B,EAA+BwqB,MAAMvqB,CAAN,IAAW,CAA1C,EAA6CuqB,MAAMtL,KAAN,IAAe,CAA5D,EAA+DsL,MAAMrL,MAAN,IAAgB,CAA/E,CAAb;AACD;;AAED,aAAO,KAAKyY,KAAZ;AACD;AArEgB,GAAnB;AAuEAr8B,WAASi9B,MAAT,EAAiBb,WAAjB;;AAEA,MAAIkB,qBAAqB,GAAzB;AACA,MAAIC,gBAAgB,MAApB;AACA,MAAIC,2BAA2B,IAA/B;AACA,MAAIC,kBAAkB,KAAtB;;AAEA,WAASC,UAAT,CAAoBl7B,GAApB,EAAyB;AACvB,WAAOgV,SAAShV,GAAT,EAAc,EAAd,CAAP;AACD;;AAED,WAASm7B,YAAT,CAAsBjxB,KAAtB,EAA6B;AAC3B,QAAI,CAACA,KAAL,EAAY;AACV,aAAO,KAAP;AACD;;AAED,QAAIA,MAAMkxB,WAAV,EAAuB;AACrB,aAAO,IAAP;AACD;;AAED,QAAI,OAAOlxB,MAAMZ,MAAb,KAAwB,UAAxB,IAAsC,OAAOY,MAAMqW,OAAb,KAAyB,UAAnE,EAA+E;AAC7E,aAAO,KAAP;AACD;;AAED,WAAO,IAAP;AACD;;AAED,MAAIuD,UAAU,IAAI5C,YAAJ,CAAiB,CAAjB,EAAoB,CAApB,EAAuB,CAAvB,EAA0B,CAA1B,CAAd;AACA,MAAIma,WAAW,IAAIna,YAAJ,CAAiB,CAAjB,EAAoB,CAApB,EAAuB,CAAvB,EAA0B,CAA1B,CAAf;;AAEA,WAASoa,mBAAT,CAA6B1xB,EAA7B,EAAiCuX,KAAjC,EAAwCC,MAAxC,EAAgD;AAC9C0C,YAAQ1hB,IAAR,CAAawH,GAAGga,eAAH,EAAb;;AAEA,QAAIha,GAAG8D,SAAP,EAAkB;AAChBoW,cAAQhgB,cAAR,CAAuB8F,GAAG8D,SAA1B;AACD;;AAED2tB,aAASla,KAAT,GAAiBA,KAAjB;AACAka,aAASja,MAAT,GAAkBA,MAAlB;AACA,WAAO,CAAC0C,QAAQhC,SAAR,CAAkBuZ,QAAlB,CAAR;AACD;;AAED,WAASE,iBAAT,CAA2BrT,SAA3B,EAAsCsT,aAAtC,EAAqD;AACnD,QAAItT,aAAasT,aAAjB,EAAgC;AAC9B;AACA,aAAO,KAAP;AACD;;AAED,QAAI,CAACtT,SAAD,IAAc,CAACsT,aAAf,IAAgCtT,UAAUlsB,MAAV,KAAqBw/B,cAAcx/B,MAAvE,EAA+E;AAC7E,aAAO,IAAP;AACD;;AAED,SAAK,IAAIF,IAAI,CAAb,EAAgBA,IAAIosB,UAAUlsB,MAA9B,EAAsCF,GAAtC,EAA2C;AACzC,UAAIosB,UAAUpsB,CAAV,MAAiB0/B,cAAc1/B,CAAd,CAArB,EAAuC;AACrC,eAAO,IAAP;AACD;AACF;AACF;;AAED,WAAS2/B,MAAT,CAAgBvT,SAAhB,EAA2B/hB,GAA3B,EAAgC;AAC9B,SAAK,IAAIrK,IAAI,CAAb,EAAgBA,IAAIosB,UAAUlsB,MAA9B,EAAsCF,GAAtC,EAA2C;AACzC,UAAIgP,WAAWod,UAAUpsB,CAAV,CAAf;AACAgP,eAASkD,YAAT,CAAsB7H,GAAtB;AACAA,UAAI6yB,SAAJ;AACAluB,eAASgrB,SAAT,CAAmB3vB,GAAnB,EAAwB2E,SAASirB,KAAjC;AACA5vB,UAAI2W,IAAJ,GALyC,CAK7B;;AAEZhS,eAASoD,gBAAT,CAA0B/H,GAA1B;AACD;AACF;;AAED,WAASu1B,UAAT,CAAoBva,KAApB,EAA2BC,MAA3B,EAAmC;AACjC,QAAIua,UAAU9iC,SAASe,aAAT,CAAuB,KAAvB,CAAd,CADiC,CACY;;AAE7C+hC,YAAQlP,KAAR,CAAcmP,OAAd,GAAwB,CAAC,mBAAD,EAAsB,iBAAtB,EAAyC,WAAWza,KAAX,GAAmB,IAA5D,EAAkE,YAAYC,MAAZ,GAAqB,IAAvF,EAA6F,WAA7F,EAA0G,UAA1G,EAAsH,gBAAtH,EAAwIvG,IAAxI,CAA6I,GAA7I,IAAoJ,GAA5K;AACA,WAAO8gB,OAAP;AACD;AACD;;;;;;;;AASA,MAAIE,UAAU,SAAVA,OAAU,CAAUpT,IAAV,EAAgB1gB,OAAhB,EAAyBsF,IAAzB,EAA+B;AAC3C,SAAKnO,IAAL,GAAY,QAAZ,CAD2C,CACrB;;AAEtB,QAAI48B,eAAe,CAACrT,KAAKsT,QAAN,CAAe;AAAf,OAChBtT,KAAKsT,QAAL,CAAcC,WAAd,OAAgC,QADnC;AAEA,SAAKC,KAAL,GAAa5uB,OAAOpQ,OAAO,EAAP,EAAWoQ,QAAQ,EAAnB,CAApB;AACA;;;;AAIA,SAAKY,GAAL,GAAWZ,KAAKoR,gBAAL,IAAyBA,gBAApC;AACA;;;;;AAKA,SAAKyd,aAAL,GAAqBJ,YAArB;AACA;;;;;AAKA,SAAKrT,IAAL,GAAYA,IAAZ;AACA,QAAI0T,YAAY1T,KAAKgE,KAArB;;AAEA,QAAI0P,SAAJ,EAAe;AACbA,gBAAU,6BAAV,IAA2C,aAA3C;AACAA,gBAAU,qBAAV,IAAmCA,UAAU,aAAV,IAA2BA,UAAU,uBAAV,IAAqC,MAAnG;AACA1T,WAAK2T,SAAL,GAAiB,EAAjB;AACD;AACD;;;;AAKA,SAAKr0B,OAAL,GAAeA,OAAf;AACA;;;;;AAKA,QAAIs0B,aAAa,KAAKC,WAAL,GAAmB,EAApC;AACA;;;;;AAKA,QAAIC,SAAS,KAAKC,OAAL,GAAe,EAA5B;AACA;;;;;AAKA,SAAKC,YAAL,GAAoB,EAApB;AACA;;;;AAIA,SAAKC,yBAAL,GAAiC,KAAjC;;AAEA,QAAI,CAACZ,YAAL,EAAmB;AACjB,WAAKa,MAAL,GAAc,KAAKC,QAAL,CAAc,CAAd,CAAd;AACA,WAAKC,OAAL,GAAe,KAAKD,QAAL,CAAc,CAAd,CAAf;AACA,UAAIjB,UAAU,KAAKmB,QAAL,GAAgBpB,WAAW,KAAKiB,MAAhB,EAAwB,KAAKE,OAA7B,CAA9B;AACApU,WAAKsU,WAAL,CAAiBpB,OAAjB;AACD,KALD,MAKO;AACL,UAAIxa,QAAQsH,KAAKtH,KAAjB;AACA,UAAIC,SAASqH,KAAKrH,MAAlB;;AAEA,UAAI/T,KAAK8T,KAAL,IAAc,IAAlB,EAAwB;AACtBA,gBAAQ9T,KAAK8T,KAAb;AACD;;AAED,UAAI9T,KAAK+T,MAAL,IAAe,IAAnB,EAAyB;AACvBA,iBAAS/T,KAAK+T,MAAd;AACD;;AAED,WAAKnT,GAAL,GAAWZ,KAAKoR,gBAAL,IAAyB,CAApC,CAZK,CAYkC;;AAEvCgK,WAAKtH,KAAL,GAAaA,QAAQ,KAAKlT,GAA1B;AACAwa,WAAKrH,MAAL,GAAcA,SAAS,KAAKnT,GAA5B;AACA,WAAK0uB,MAAL,GAAcxb,KAAd;AACA,WAAK0b,OAAL,GAAezb,MAAf,CAjBK,CAiBkB;AACvB;;AAEA,UAAI4b,YAAY,IAAIxO,KAAJ,CAAU/F,IAAV,EAAgB,IAAhB,EAAsB,KAAKxa,GAA3B,CAAhB;AACA+uB,gBAAU5B,WAAV,GAAwB,IAAxB;AACA4B,gBAAUxN,WAAV,GAtBK,CAsBoB;AACzB;;AAEA+M,aAAOxB,aAAP,IAAwBiC,SAAxB;AACAA,gBAAU1V,MAAV,GAAmByT,aAAnB,CA1BK,CA0B6B;;AAElCsB,iBAAW/9B,IAAX,CAAgBy8B,aAAhB;AACA,WAAK+B,QAAL,GAAgBrU,IAAhB;AACD;AACD;;;;;AAMA,SAAKwU,WAAL,GAAmB,IAAnB;AACA,SAAKC,cAAL,GAAsB,EAAtB;AACD,GAxGD;;AA0GArB,UAAQxhC,SAAR,GAAoB;AAClB6B,iBAAa2/B,OADK;AAElBsB,aAAS,mBAAY;AACnB,aAAO,QAAP;AACD,KAJiB;;AAMlB;;;;AAIAC,oBAAgB,0BAAY;AAC1B,aAAO,KAAKlB,aAAZ;AACD,KAZiB;;AAclB;;;AAGAmB,qBAAiB,2BAAY;AAC3B,aAAO,KAAKP,QAAZ;AACD,KAnBiB;AAoBlBQ,2BAAuB,iCAAY;AACjC,UAAIC,eAAe,KAAKF,eAAL,EAAnB;;AAEA,UAAIE,YAAJ,EAAkB;AAChB,eAAO;AACLC,sBAAYD,aAAaC,UAAb,IAA2B,CADlC;AAELC,qBAAWF,aAAaE,SAAb,IAA0B;AAFhC,SAAP;AAID;AACF,KA7BiB;;AA+BlB;;;;AAIAld,aAAS,iBAAUmd,QAAV,EAAoB;AAC3B,UAAItzB,OAAO,KAAKrC,OAAL,CAAasC,cAAb,CAA4B,IAA5B,CAAX;AACA,UAAIgyB,aAAa,KAAKC,WAAtB;AACA,WAAKqB,SAAL,GAAiB/6B,KAAKg7B,MAAL,EAAjB;;AAEA,WAAKC,UAAL,CAAgBzzB,IAAhB,EAAsBszB,QAAtB,EAAgC,KAAKC,SAArC,EAL2B,CAKsB;;;AAGjD,WAAK,IAAI7hC,IAAI,CAAb,EAAgBA,IAAIugC,WAAWrgC,MAA/B,EAAuCF,GAAvC,EAA4C;AAC1C,YAAIyrB,IAAI8U,WAAWvgC,CAAX,CAAR;AACA,YAAIoO,QAAQ,KAAKsyB,OAAL,CAAajV,CAAb,CAAZ;;AAEA,YAAI,CAACrd,MAAMkxB,WAAP,IAAsBlxB,MAAMqW,OAAhC,EAAyC;AACvC,cAAIwO,aAAajzB,MAAM,CAAN,GAAU,KAAKgiC,gBAAf,GAAkC,IAAnD;AACA5zB,gBAAMqW,OAAN,CAAcwO,UAAd;AACD;AACF;;AAED,WAAKgP,YAAL;AACA,aAAO,IAAP;AACD,KAvDiB;AAwDlBC,cAAU,kBAAUp0B,EAAV,EAAcq0B,UAAd,EAA0B;AAClC,UAAIr0B,GAAGs0B,UAAP,EAAmB;AACjB;AACD;;AAED,UAAIC,WAAW,IAAIv0B,GAAG1N,WAAP,CAAmB;AAChCuwB,eAAO7iB,GAAG6iB,KADsB;AAEhCsJ,eAAOnsB,GAAGmsB;AAFsB,OAAnB,CAAf;AAIAoI,eAASC,MAAT,GAAkBx0B,EAAlB;AACAA,SAAGs0B,UAAH,GAAgBC,QAAhB;AACAA,eAAS5D,QAAT,CAAkB0D,UAAlB;;AAEA,WAAKf,cAAL,CAAoB5+B,IAApB,CAAyB6/B,QAAzB;AACD,KAtEiB;AAuElBE,iBAAa,qBAAUz0B,EAAV,EAAc;AACzB,UAAIu0B,WAAWv0B,GAAGs0B,UAAlB;AACA,UAAII,gBAAgB,KAAKpB,cAAzB;AACA,UAAIna,MAAM1lB,QAAQihC,aAAR,EAAuBH,QAAvB,CAAV;;AAEA,UAAIpb,OAAO,CAAX,EAAc;AACZub,sBAAc53B,MAAd,CAAqBqc,GAArB,EAA0B,CAA1B;AACD;;AAEDnZ,SAAGs0B,UAAH,GAAgB,IAAhB;AACD,KAjFiB;AAkFlBK,gBAAY,oBAAU30B,EAAV,EAAc;AACxB,UAAI00B,gBAAgB,KAAKpB,cAAzB;;AAEA,WAAK,IAAIphC,IAAI,CAAb,EAAgBA,IAAIwiC,cAActiC,MAAlC,EAA0CF,GAA1C,EAA+C;AAC7C,YAAIK,OAAOmiC,cAAcxiC,CAAd,EAAiBsiC,MAA5B;;AAEA,YAAIjiC,IAAJ,EAAU;AACRA,eAAK+hC,UAAL,GAAkB,IAAlB;AACD;AACF;;AAEDI,oBAActiC,MAAd,GAAuB,CAAvB;AACD,KA9FiB;AA+FlB+hC,kBAAc,wBAAY;AACxB,UAAIO,gBAAgB,KAAKpB,cAAzB;AACA,UAAInhC,MAAMuiC,cAActiC,MAAxB;AACA,UAAIwiC,aAAa,KAAKvB,WAAtB;AACAuB,oBAAcA,WAAW5qB,KAAX,EAAd;;AAEA,UAAI,CAAC7X,GAAL,EAAU;AACR;AACD;;AAEDkgB,WAAKqiB,aAAL,EAAoB,KAAKv2B,OAAL,CAAa4gB,mBAAjC,EAVwB,CAU+B;AACvD;;AAEA,UAAI,CAAC6V,UAAL,EAAiB;AACfA,qBAAa,KAAKvB,WAAL,GAAmB,KAAKwB,QAAL,CAAc3D,kBAAd,CAAhC;AACD;;AAED,UAAI4D,QAAQ,EAAZ;AACAF,iBAAWr4B,GAAX,CAAe6pB,IAAf;;AAEA,WAAK,IAAIl0B,IAAI,CAAb,EAAgBA,IAAIC,GAApB,GAA0B;AACxB,YAAI6N,KAAK00B,cAAcxiC,CAAd,CAAT;AACA,YAAI6iC,aAAa/0B,GAAGw0B,MAApB,CAFwB,CAEI;AAC5B;;AAEA,YAAI,EAAEO,cAAcA,WAAWh2B,IAA3B,CAAJ,EAAsC;AACpC21B,wBAAc53B,MAAd,CAAqB5K,CAArB,EAAwB,CAAxB;AACA6iC,qBAAWT,UAAX,GAAwB,IAAxB;AACAniC;AACA;AACD;;AAEDD,YAZwB,CAYnB;AACL;;AAEA,YAAI,CAAC6iC,WAAW3a,SAAhB,EAA2B;AACzBpa,aAAG8D,SAAH,GAAeixB,WAAWjxB,SAA1B;AACA9D,aAAGmE,YAAH,GAAkB4wB,WAAW5wB,YAA7B;AACAnE,aAAG0e,WAAH,GAAiBqW,WAAWrW,WAA5B,CAHyB,CAGgB;;AAEzC,eAAKsW,UAAL,CAAgBh1B,EAAhB,EAAoB40B,UAApB,EAAgC,IAAhC,EAAsCE,KAAtC;AACD;AACF;;AAEDF,iBAAWr4B,GAAX,CAAe+pB,OAAf;AACD,KA5IiB;AA6IlB2O,mBAAe,yBAAY;AACzB,aAAO,KAAKJ,QAAL,CAAc3D,kBAAd,CAAP;AACD,KA/IiB;AAgJlB+C,gBAAY,oBAAUzzB,IAAV,EAAgBszB,QAAhB,EAA0BoB,QAA1B,EAAoC;AAC9C,UAAI,KAAKnB,SAAL,KAAmBmB,QAAvB,EAAiC;AAC/B;AACD;;AAEDpB,iBAAWA,YAAY,KAAvB;;AAEA,WAAKqB,kBAAL,CAAwB30B,IAAxB;;AAEA,UAAI40B,WAAW,KAAKC,YAAL,CAAkB70B,IAAlB,EAAwBszB,QAAxB,CAAf;;AAEA,UAAI,KAAKhB,yBAAT,EAAoC;AAClC,aAAKwC,kBAAL;AACD;;AAED,UAAI,CAACF,QAAL,EAAe;AACb,YAAIlmC,OAAO,IAAX;AACAq3B,8BAAsB,YAAY;AAChCr3B,eAAK+kC,UAAL,CAAgBzzB,IAAhB,EAAsBszB,QAAtB,EAAgCoB,QAAhC;AACD,SAFD;AAGD;AACF,KArKiB;AAsKlBI,wBAAoB,8BAAY;AAC9B,UAAI/4B,MAAM,KAAKs4B,QAAL,CAAc1D,aAAd,EAA6B50B,GAAvC;AACA,UAAIgb,QAAQ,KAAK2b,QAAL,CAAc3b,KAA1B;AACA,UAAIC,SAAS,KAAK0b,QAAL,CAAc1b,MAA3B;AACAjb,UAAI0pB,SAAJ,CAAc,CAAd,EAAiB,CAAjB,EAAoB1O,KAApB,EAA2BC,MAA3B,EAJ8B,CAIM;;AAEpC,WAAK+d,gBAAL,CAAsB,UAAUj1B,KAAV,EAAiB;AACrC,YAAIA,MAAMk1B,OAAV,EAAmB;AACjBj5B,cAAIypB,SAAJ,CAAc1lB,MAAMukB,GAApB,EAAyB,CAAzB,EAA4B,CAA5B,EAA+BtN,KAA/B,EAAsCC,MAAtC;AACD;AACF,OAJD;AAKD,KAjLiB;AAkLlB6d,kBAAc,sBAAU70B,IAAV,EAAgBszB,QAAhB,EAA0B;AACtC,UAAI2B,YAAY,EAAhB;;AAEA,WAAK,IAAIC,KAAK,CAAd,EAAiBA,KAAK,KAAKhD,WAAL,CAAiBtgC,MAAvC,EAA+CsjC,IAA/C,EAAqD;AACnD,YAAIhY,SAAS,KAAKgV,WAAL,CAAiBgD,EAAjB,CAAb;AACA,YAAIp1B,QAAQ,KAAKsyB,OAAL,CAAalV,MAAb,CAAZ;;AAEA,YAAIpd,MAAMkxB,WAAN,IAAqBlxB,UAAU,KAAK+yB,WAApC,KAAoD/yB,MAAM0Y,OAAN,IAAiB8a,QAArE,CAAJ,EAAoF;AAClF2B,oBAAU/gC,IAAV,CAAe4L,KAAf;AACD;AACF;;AAED,UAAI80B,WAAW,IAAf;;AAEA,WAAK,IAAIlwB,IAAI,CAAb,EAAgBA,IAAIuwB,UAAUrjC,MAA9B,EAAsC8S,GAAtC,EAA2C;AACzC,YAAI5E,QAAQm1B,UAAUvwB,CAAV,CAAZ;AACA,YAAI3I,MAAM+D,MAAM/D,GAAhB;AACA,YAAIu4B,QAAQ,EAAZ;AACAv4B,YAAI6pB,IAAJ;AACA,YAAItT,QAAQghB,WAAWxzB,MAAMklB,YAAjB,GAAgCllB,MAAMilB,WAAlD;AACA,YAAIoQ,WAAW,CAAC7B,QAAD,IAAaxzB,MAAMolB,WAAnB,IAAkCkQ,KAAKC,GAAtD;AACA,YAAIC,YAAYH,YAAYC,KAAKC,GAAL,EAA5B;AACA,YAAI1Q,aAAa7kB,MAAMod,MAAN,KAAiB,KAAKgV,WAAL,CAAiB,CAAjB,CAAjB,GAAuC,KAAKwB,gBAA5C,GAA+D,IAAhF,CARyC,CAQ6C;;AAEtF,YAAI5zB,MAAMklB,YAAN,KAAuBllB,MAAMmlB,UAAjC,EAA6C;AAC3CnlB,gBAAM0J,KAAN,CAAY,KAAZ,EAAmBmb,UAAnB;AACD,SAFD,MAEO,IAAIrS,UAAUxS,MAAMklB,YAApB,EAAkC;AACvC,cAAIuQ,UAAUv1B,KAAKsS,KAAL,CAAd;;AAEA,cAAI,CAACijB,QAAQrQ,WAAT,IAAwB,CAACqQ,QAAQC,QAAjC,IAA6ClC,QAAjD,EAA2D;AACzDxzB,kBAAM0J,KAAN,CAAY,KAAZ,EAAmBmb,UAAnB;AACD;AACF;;AAED,YAAIrS,UAAU,CAAC,CAAf,EAAkB;AAChBkC,kBAAQihB,KAAR,CAAc,0CAAd;AACAnjB,kBAAQxS,MAAMklB,YAAd;AACD;;AAED,aAAK,IAAItzB,IAAI4gB,KAAb,EAAoB5gB,IAAIoO,MAAMmlB,UAA9B,EAA0CvzB,GAA1C,EAA+C;AAC7C,cAAI8N,KAAKQ,KAAKtO,CAAL,CAAT;;AAEA,eAAK8iC,UAAL,CAAgBh1B,EAAhB,EAAoBM,KAApB,EAA2BwzB,QAA3B,EAAqCgB,KAArC;;AAEA90B,aAAGgZ,OAAH,GAAa,KAAb;;AAEA,cAAI2c,QAAJ,EAAc;AACZ;AACA,gBAAIO,QAAQN,KAAKC,GAAL,KAAaC,SAAzB,CAFY,CAEwB;AACpC;;AAEA,gBAAII,QAAQ,EAAZ,EAAgB;AACd;AACD;AACF;AACF;;AAED51B,cAAMilB,WAAN,GAAoBrzB,CAApB;;AAEA,YAAIoO,MAAMilB,WAAN,GAAoBjlB,MAAMmlB,UAA9B,EAA0C;AACxC2P,qBAAW,KAAX;AACD;;AAED,YAAIN,MAAMqB,eAAV,EAA2B;AACzB;AACA55B,cAAI+pB,OAAJ;AACD;;AAED/pB,YAAI+pB,OAAJ;AACD;;AAED,UAAI/2B,MAAMV,GAAV,EAAe;AACb;AACAyF,eAAO,KAAKs+B,OAAZ,EAAqB,UAAUtyB,KAAV,EAAiB;AACpC,cAAIA,SAASA,MAAM/D,GAAf,IAAsB+D,MAAM/D,GAAN,CAAU65B,IAApC,EAA0C;AACxC91B,kBAAM/D,GAAN,CAAU65B,IAAV;AACD;AACF,SAJD;AAKD;;AAED,aAAOhB,QAAP;AACD,KAnQiB;AAoQlBJ,gBAAY,oBAAUh1B,EAAV,EAAcq2B,YAAd,EAA4BC,UAA5B,EAAwCxB,KAAxC,EAA+C;AACzD,UAAIv4B,MAAM85B,aAAa95B,GAAvB;AACA,UAAIpC,IAAI6F,GAAG8D,SAAX;;AAEA,UAAI,CAACuyB,aAAard,OAAb,IAAwBsd,UAAzB,KAAwC;AAC5C,OAACt2B,GAAGoa,SADA,CACU;AADV,SAEDpa,GAAG6iB,KAAH,CAAShD,OAAT,KAAqB,CAFpB,CAEsB;AAC1B;AACA;AAJI,SAKD,EAAE1lB,KAAK,CAACA,EAAE,CAAF,CAAN,IAAc,CAACA,EAAE,CAAF,CAAjB,CALC,CAKsB;AALtB,SAMD,EAAE6F,GAAGkwB,OAAH,IAAcwB,oBAAoB1xB,EAApB,EAAwB,KAAK+yB,MAA7B,EAAqC,KAAKE,OAA1C,CAAhB,CANH,EAMwE;AACtE,YAAI3U,YAAYte,GAAG0e,WAAnB,CADsE,CACtC;;AAEhC,YAAI,CAACoW,MAAMqB,eAAP,IAA0BxE,kBAAkBrT,SAAlB,EAA6BwW,MAAMqB,eAAnC,CAA9B,EAAmF;AACjF;AACA,cAAIrB,MAAMqB,eAAV,EAA2B;AACzBE,yBAAa95B,GAAb,CAAiB+pB,OAAjB;AACAwO,kBAAMqB,eAAN,GAAwB,IAAxB,CAFyB,CAEK;;AAE9BrB,kBAAMlS,MAAN,GAAe,IAAf;AACD,WAPgF,CAO/E;;;AAGF,cAAItE,SAAJ,EAAe;AACb/hB,gBAAI6pB,IAAJ;AACAyL,mBAAOvT,SAAP,EAAkB/hB,GAAlB;AACAu4B,kBAAMqB,eAAN,GAAwB7X,SAAxB;AACD;AACF;;AAEDte,WAAGqwB,WAAH,IAAkBrwB,GAAGqwB,WAAH,CAAe9zB,GAAf,CAAlB;AACAyD,WAAGuwB,KAAH,CAASh0B,GAAT,EAAcu4B,MAAMlS,MAAN,IAAgB,IAA9B;AACAkS,cAAMlS,MAAN,GAAe5iB,EAAf;AACAA,WAAGswB,UAAH,IAAiBtwB,GAAGswB,UAAH,CAAc/zB,GAAd,CAAjB;AACD;AACF,KAvSiB;;AAySlB;;;;;;AAMAs4B,cAAU,kBAAUnX,MAAV,EAAkB8X,OAAlB,EAA2B;AACnC,UAAI,KAAKlD,aAAL,IAAsB,CAAC,KAAKQ,yBAAhC,EAA2D;AACzDpV,iBAASyT,aAAT;AACD;;AAED,UAAI7wB,QAAQ,KAAKsyB,OAAL,CAAalV,MAAb,CAAZ;;AAEA,UAAI,CAACpd,KAAL,EAAY;AACV;AACAA,gBAAQ,IAAIskB,KAAJ,CAAU,QAAQlH,MAAlB,EAA0B,IAA1B,EAAgC,KAAKrZ,GAArC,CAAR;AACA/D,cAAMod,MAAN,GAAeA,MAAf;AACApd,cAAMkxB,WAAN,GAAoB,IAApB;;AAEA,YAAI,KAAKqB,YAAL,CAAkBnV,MAAlB,CAAJ,EAA+B;AAC7B/qB,gBAAM2N,KAAN,EAAa,KAAKuyB,YAAL,CAAkBnV,MAAlB,CAAb,EAAwC,IAAxC;AACD;;AAED,YAAI8X,OAAJ,EAAa;AACXl1B,gBAAMk1B,OAAN,GAAgBA,OAAhB;AACD;;AAED,aAAKe,WAAL,CAAiB7Y,MAAjB,EAAyBpd,KAAzB,EAdU,CAcuB;AACjC;;AAEAA,cAAMslB,WAAN;AACD;;AAED,aAAOtlB,KAAP;AACD,KA3UiB;AA4UlBi2B,iBAAa,qBAAU7Y,MAAV,EAAkBpd,KAAlB,EAAyB;AACpC,UAAIk2B,YAAY,KAAK5D,OAArB;AACA,UAAIH,aAAa,KAAKC,WAAtB;AACA,UAAIvgC,MAAMsgC,WAAWrgC,MAArB;AACA,UAAIqkC,YAAY,IAAhB;AACA,UAAIvkC,IAAI,CAAC,CAAT;AACA,UAAI6/B,UAAU,KAAKmB,QAAnB;;AAEA,UAAIsD,UAAU9Y,MAAV,CAAJ,EAAuB;AACrBzI,cAAM,YAAYyI,MAAZ,GAAqB,wBAA3B;AACA;AACD,OAXmC,CAWlC;;;AAGF,UAAI,CAAC6T,aAAajxB,KAAb,CAAL,EAA0B;AACxB2U,cAAM,qBAAqByI,MAArB,GAA8B,eAApC;AACA;AACD;;AAED,UAAIvrB,MAAM,CAAN,IAAWurB,SAAS+U,WAAW,CAAX,CAAxB,EAAuC;AACrC,aAAKvgC,IAAI,CAAT,EAAYA,IAAIC,MAAM,CAAtB,EAAyBD,GAAzB,EAA8B;AAC5B,cAAIugC,WAAWvgC,CAAX,IAAgBwrB,MAAhB,IAA0B+U,WAAWvgC,IAAI,CAAf,IAAoBwrB,MAAlD,EAA0D;AACxD;AACD;AACF;;AAED+Y,oBAAYD,UAAU/D,WAAWvgC,CAAX,CAAV,CAAZ;AACD;;AAEDugC,iBAAW31B,MAAX,CAAkB5K,IAAI,CAAtB,EAAyB,CAAzB,EAA4BwrB,MAA5B;AACA8Y,gBAAU9Y,MAAV,IAAoBpd,KAApB,CA9BoC,CA8BT;AAC3B;AACA;;AAEA,UAAI,CAACA,MAAMk1B,OAAX,EAAoB;AAClB,YAAIiB,SAAJ,EAAe;AACb,cAAIC,UAAUD,UAAU5R,GAAxB;;AAEA,cAAI6R,QAAQjd,WAAZ,EAAyB;AACvBsY,oBAAQ4E,YAAR,CAAqBr2B,MAAMukB,GAA3B,EAAgC6R,QAAQjd,WAAxC;AACD,WAFD,MAEO;AACLsY,oBAAQoB,WAAR,CAAoB7yB,MAAMukB,GAA1B;AACD;AACF,SARD,MAQO;AACL,cAAIkN,QAAQ6E,UAAZ,EAAwB;AACtB7E,oBAAQ4E,YAAR,CAAqBr2B,MAAMukB,GAA3B,EAAgCkN,QAAQ6E,UAAxC;AACD,WAFD,MAEO;AACL7E,oBAAQoB,WAAR,CAAoB7yB,MAAMukB,GAA1B;AACD;AACF;AACF;AACF,KA/XiB;AAgYlB;AACAgS,eAAW,mBAAUriC,EAAV,EAAcC,OAAd,EAAuB;AAChC,UAAIg+B,aAAa,KAAKC,WAAtB;AACA,UAAI/U,CAAJ;AACA,UAAIzrB,CAAJ;;AAEA,WAAKA,IAAI,CAAT,EAAYA,IAAIugC,WAAWrgC,MAA3B,EAAmCF,GAAnC,EAAwC;AACtCyrB,YAAI8U,WAAWvgC,CAAX,CAAJ;AACAsC,WAAGxC,IAAH,CAAQyC,OAAR,EAAiB,KAAKm+B,OAAL,CAAajV,CAAb,CAAjB,EAAkCA,CAAlC;AACD;AACF,KA1YiB;AA2YlB;AACA4X,sBAAkB,0BAAU/gC,EAAV,EAAcC,OAAd,EAAuB;AACvC,UAAIg+B,aAAa,KAAKC,WAAtB;AACA,UAAIpyB,KAAJ;AACA,UAAIqd,CAAJ;AACA,UAAIzrB,CAAJ;;AAEA,WAAKA,IAAI,CAAT,EAAYA,IAAIugC,WAAWrgC,MAA3B,EAAmCF,GAAnC,EAAwC;AACtCyrB,YAAI8U,WAAWvgC,CAAX,CAAJ;AACAoO,gBAAQ,KAAKsyB,OAAL,CAAajV,CAAb,CAAR;;AAEA,YAAIrd,MAAMkxB,WAAV,EAAuB;AACrBh9B,aAAGxC,IAAH,CAAQyC,OAAR,EAAiB6L,KAAjB,EAAwBqd,CAAxB;AACD;AACF;AACF,KA1ZiB;AA2ZlB;AACAtd,oBAAgB,wBAAU7L,EAAV,EAAcC,OAAd,EAAuB;AACrC,UAAIg+B,aAAa,KAAKC,WAAtB;AACA,UAAIpyB,KAAJ;AACA,UAAIqd,CAAJ;AACA,UAAIzrB,CAAJ;;AAEA,WAAKA,IAAI,CAAT,EAAYA,IAAIugC,WAAWrgC,MAA3B,EAAmCF,GAAnC,EAAwC;AACtCyrB,YAAI8U,WAAWvgC,CAAX,CAAJ;AACAoO,gBAAQ,KAAKsyB,OAAL,CAAajV,CAAb,CAAR;;AAEA,YAAI,CAACrd,MAAMkxB,WAAX,EAAwB;AACtBh9B,aAAGxC,IAAH,CAAQyC,OAAR,EAAiB6L,KAAjB,EAAwBqd,CAAxB;AACD;AACF;AACF,KA1aiB;;AA4alB;;;;AAIAmZ,eAAW,qBAAY;AACrB,aAAO,KAAKlE,OAAZ;AACD,KAlbiB;AAmblBuC,wBAAoB,4BAAU30B,IAAV,EAAgB;AAClC,WAAK+0B,gBAAL,CAAsB,UAAUj1B,KAAV,EAAiBqd,CAAjB,EAAoB;AACxCrd,cAAM0Y,OAAN,GAAgB1Y,MAAMglB,MAAN,GAAe,KAA/B;AACD,OAFD;;AAIA,eAASyR,eAAT,CAAyB5d,GAAzB,EAA8B;AAC5B,YAAIsd,SAAJ,EAAe;AACb,cAAIA,UAAUhR,UAAV,KAAyBtM,GAA7B,EAAkC;AAChCsd,sBAAUzd,OAAV,GAAoB,IAApB;AACD;;AAEDyd,oBAAUhR,UAAV,GAAuBtM,GAAvB;AACD;AACF;;AAED,UAAI,KAAKmZ,aAAT,EAAwB;AACtB,aAAK,IAAIpgC,IAAI,CAAb,EAAgBA,IAAIsO,KAAKpO,MAAzB,EAAiCF,GAAjC,EAAsC;AACpC,cAAI8N,KAAKQ,KAAKtO,CAAL,CAAT;;AAEA,cAAI8N,GAAG0d,MAAH,KAAcld,KAAKtO,IAAI,CAAT,EAAYwrB,MAA1B,IAAoC1d,GAAG0lB,WAA3C,EAAwD;AACtD,iBAAKoN,yBAAL,GAAiC,IAAjC;AACA;AACD;AACF;AACF;;AAED,UAAI2D,YAAY,IAAhB;AACA,UAAIO,wBAAwB,CAA5B;;AAEA,WAAK,IAAI9kC,IAAI,CAAb,EAAgBA,IAAIsO,KAAKpO,MAAzB,EAAiCF,GAAjC,EAAsC;AACpC,YAAI8N,KAAKQ,KAAKtO,CAAL,CAAT;AACA,YAAIwrB,SAAS1d,GAAG0d,MAAhB;AACA,YAAIpd,KAAJ,CAHoC,CAGzB;AACX;;AAEA,YAAIN,GAAG0lB,WAAP,EAAoB;AAClBplB,kBAAQ,KAAKu0B,QAAL,CAAcnX,SAAS2T,eAAvB,EAAwC,KAAKyB,yBAA7C,CAAR;AACAxyB,gBAAMolB,WAAN,GAAoB,IAApB;AACAsR,kCAAwB,CAAxB;AACD,SAJD,MAIO;AACL12B,kBAAQ,KAAKu0B,QAAL,CAAcnX,UAAUsZ,wBAAwB,CAAxB,GAA4B5F,wBAA5B,GAAuD,CAAjE,CAAd,EAAmF,KAAK0B,yBAAxF,CAAR;AACD;;AAED,YAAI,CAACxyB,MAAMkxB,WAAX,EAAwB;AACtBvc,gBAAM,YAAYyI,MAAZ,GAAqB,iCAArB,GAAyDpd,MAAMmV,EAArE;AACD;;AAED,YAAInV,UAAUm2B,SAAd,EAAyB;AACvBn2B,gBAAMglB,MAAN,GAAe,IAAf;;AAEA,cAAIhlB,MAAMklB,YAAN,KAAuBtzB,CAA3B,EAA8B;AAC5BoO,kBAAM0Y,OAAN,GAAgB,IAAhB;AACD;;AAED1Y,gBAAMklB,YAAN,GAAqBtzB,CAArB;;AAEA,cAAI,CAACoO,MAAMolB,WAAX,EAAwB;AACtBplB,kBAAMilB,WAAN,GAAoBrzB,CAApB;AACD,WAFD,MAEO;AACL;AACAoO,kBAAMilB,WAAN,GAAoB,CAAC,CAArB;AACD;;AAEDwR,0BAAgB7kC,CAAhB;AACAukC,sBAAYn2B,KAAZ;AACD;;AAED,YAAIN,GAAGgZ,OAAP,EAAgB;AACd1Y,gBAAM0Y,OAAN,GAAgB,IAAhB;;AAEA,cAAI1Y,MAAMolB,WAAN,IAAqBplB,MAAMilB,WAAN,GAAoB,CAA7C,EAAgD;AAC9C;AACAjlB,kBAAMilB,WAAN,GAAoBrzB,CAApB;AACD;AACF;AACF;;AAED6kC,sBAAgB7kC,CAAhB;AACA,WAAKqjC,gBAAL,CAAsB,UAAUj1B,KAAV,EAAiBqd,CAAjB,EAAoB;AACxC;AACA,YAAI,CAACrd,MAAMglB,MAAP,IAAiBhlB,MAAMqlB,eAAN,KAA0B,CAA/C,EAAkD;AAChDrlB,gBAAM0Y,OAAN,GAAgB,IAAhB;AACA1Y,gBAAMklB,YAAN,GAAqBllB,MAAMmlB,UAAN,GAAmBnlB,MAAMilB,WAAN,GAAoB,CAA5D;AACD,SALuC,CAKtC;;;AAGF,YAAIjlB,MAAM0Y,OAAN,IAAiB1Y,MAAMilB,WAAN,GAAoB,CAAzC,EAA4C;AAC1CjlB,gBAAMilB,WAAN,GAAoBjlB,MAAMklB,YAA1B;AACD;AACF,OAXD;AAYD,KA7gBiB;;AA+gBlB;;;AAGAxb,WAAO,iBAAY;AACjB,WAAKurB,gBAAL,CAAsB,KAAK0B,WAA3B;AACA,aAAO,IAAP;AACD,KArhBiB;AAshBlBA,iBAAa,qBAAU32B,KAAV,EAAiB;AAC5BA,YAAM0J,KAAN;AACD,KAxhBiB;AAyhBlBktB,wBAAoB,4BAAUC,eAAV,EAA2B;AAC7C,WAAKjD,gBAAL,GAAwBiD,eAAxB;AACD,KA3hBiB;;AA6hBlB;;;;;;;;;;AAUAC,iBAAa,qBAAU1Z,MAAV,EAAkBwH,MAAlB,EAA0B;AACrC,UAAIA,MAAJ,EAAY;AACV,YAAImS,cAAc,KAAKxE,YAAvB;;AAEA,YAAI,CAACwE,YAAY3Z,MAAZ,CAAL,EAA0B;AACxB2Z,sBAAY3Z,MAAZ,IAAsBwH,MAAtB;AACD,SAFD,MAEO;AACLvyB,gBAAM0kC,YAAY3Z,MAAZ,CAAN,EAA2BwH,MAA3B,EAAmC,IAAnC;AACD;;AAED,aAAK,IAAIhzB,IAAI,CAAb,EAAgBA,IAAI,KAAKwgC,WAAL,CAAiBtgC,MAArC,EAA6CF,GAA7C,EAAkD;AAChD,cAAIolC,UAAU,KAAK5E,WAAL,CAAiBxgC,CAAjB,CAAd;;AAEA,cAAIolC,YAAY5Z,MAAZ,IAAsB4Z,YAAY5Z,SAAS0T,wBAA/C,EAAyE;AACvE,gBAAI9wB,QAAQ,KAAKsyB,OAAL,CAAa0E,OAAb,CAAZ;AACA3kC,kBAAM2N,KAAN,EAAa+2B,YAAY3Z,MAAZ,CAAb,EAAkC,IAAlC;AACD;AACF;AACF;AACF,KA1jBiB;;AA4jBlB;;;;AAIA6Z,cAAU,kBAAU7Z,MAAV,EAAkB;AAC1B,UAAIiV,SAAS,KAAKC,OAAlB;AACA,UAAIH,aAAa,KAAKC,WAAtB;AACA,UAAIpyB,QAAQqyB,OAAOjV,MAAP,CAAZ;;AAEA,UAAI,CAACpd,KAAL,EAAY;AACV;AACD;;AAEDA,YAAMukB,GAAN,CAAUplB,UAAV,CAAqB+3B,WAArB,CAAiCl3B,MAAMukB,GAAvC;AACA,aAAO8N,OAAOjV,MAAP,CAAP;AACA+U,iBAAW31B,MAAX,CAAkBrJ,QAAQg/B,UAAR,EAAoB/U,MAApB,CAAlB,EAA+C,CAA/C;AACD,KA5kBiB;;AA8kBlB;;;AAGAhe,YAAQ,gBAAU6X,KAAV,EAAiBC,MAAjB,EAAyB;AAC/B,UAAI,CAAC,KAAK0b,QAAL,CAAcrQ,KAAnB,EAA0B;AACxB;AACA,YAAItL,SAAS,IAAT,IAAiBC,UAAU,IAA/B,EAAqC;AACnC;AACD;;AAED,aAAKub,MAAL,GAAcxb,KAAd;AACA,aAAK0b,OAAL,GAAezb,MAAf;AACA,aAAKqd,QAAL,CAAc1D,aAAd,EAA6BzxB,MAA7B,CAAoC6X,KAApC,EAA2CC,MAA3C;AACD,OATD,MASO;AACL,YAAIua,UAAU,KAAKmB,QAAnB,CADK,CACwB;;AAE7BnB,gBAAQlP,KAAR,CAAc4U,OAAd,GAAwB,MAAxB,CAHK,CAG2B;;AAEhC,YAAIh0B,OAAO,KAAK4uB,KAAhB;AACA9a,iBAAS,IAAT,KAAkB9T,KAAK8T,KAAL,GAAaA,KAA/B;AACAC,kBAAU,IAAV,KAAmB/T,KAAK+T,MAAL,GAAcA,MAAjC;AACAD,gBAAQ,KAAKyb,QAAL,CAAc,CAAd,CAAR;AACAxb,iBAAS,KAAKwb,QAAL,CAAc,CAAd,CAAT;AACAjB,gBAAQlP,KAAR,CAAc4U,OAAd,GAAwB,EAAxB,CAVK,CAUuB;;AAE5B,YAAI,KAAK1E,MAAL,IAAexb,KAAf,IAAwBC,UAAU,KAAKyb,OAA3C,EAAoD;AAClDlB,kBAAQlP,KAAR,CAActL,KAAd,GAAsBA,QAAQ,IAA9B;AACAwa,kBAAQlP,KAAR,CAAcrL,MAAd,GAAuBA,SAAS,IAAhC;;AAEA,eAAK,IAAI/B,EAAT,IAAe,KAAKmd,OAApB,EAA6B;AAC3B,gBAAI,KAAKA,OAAL,CAAalgC,cAAb,CAA4B+iB,EAA5B,CAAJ,EAAqC;AACnC,mBAAKmd,OAAL,CAAand,EAAb,EAAiB/V,MAAjB,CAAwB6X,KAAxB,EAA+BC,MAA/B;AACD;AACF;;AAEDljB,iBAAO,KAAKojC,kBAAZ,EAAgC,UAAUp3B,KAAV,EAAiB;AAC/CA,kBAAMZ,MAAN,CAAa6X,KAAb,EAAoBC,MAApB;AACD,WAFD;AAGA,eAAKb,OAAL,CAAa,IAAb;AACD;;AAED,aAAKoc,MAAL,GAAcxb,KAAd;AACA,aAAK0b,OAAL,GAAezb,MAAf;AACD;;AAED,aAAO,IAAP;AACD,KA5nBiB;;AA8nBlB;;;;AAIAmgB,gBAAY,oBAAUja,MAAV,EAAkB;AAC5B,UAAIpd,QAAQ,KAAKsyB,OAAL,CAAalV,MAAb,CAAZ;;AAEA,UAAIpd,KAAJ,EAAW;AACTA,cAAM0J,KAAN;AACD;AACF,KAxoBiB;;AA0oBlB;;;AAGAhM,aAAS,mBAAY;AACnB,WAAK6gB,IAAL,CAAU2T,SAAV,GAAsB,EAAtB;AACA,WAAK3T,IAAL,GAAY,KAAK1gB,OAAL,GAAe,KAAK+0B,QAAL,GAAgB,KAAKN,OAAL,GAAe,IAA1D;AACD,KAhpBiB;;AAkpBlB;;;;;;AAMAgF,uBAAmB,2BAAUn0B,IAAV,EAAgB;AACjCA,aAAOA,QAAQ,EAAf;;AAEA,UAAI,KAAK6uB,aAAL,IAAsB,CAAC,KAAKgD,kBAAhC,EAAoD;AAClD,eAAO,KAAK1C,OAAL,CAAazB,aAAb,EAA4BtM,GAAnC;AACD;;AAED,UAAIgT,aAAa,IAAIjT,KAAJ,CAAU,OAAV,EAAmB,IAAnB,EAAyBnhB,KAAKq0B,UAAL,IAAmB,KAAKzzB,GAAjD,CAAjB;AACAwzB,iBAAWjS,WAAX;AACAiS,iBAAW7tB,KAAX,CAAiB,KAAjB,EAAwBvG,KAAK0zB,eAAL,IAAwB,KAAKjD,gBAArD;;AAEA,UAAIzwB,KAAKq0B,UAAL,IAAmB,KAAKzzB,GAA5B,EAAiC;AAC/B,aAAKsS,OAAL;AACA,YAAIY,QAAQsgB,WAAWhT,GAAX,CAAetN,KAA3B;AACA,YAAIC,SAASqgB,WAAWhT,GAAX,CAAerN,MAA5B;AACA,YAAIjb,MAAMs7B,WAAWt7B,GAArB;AACA,aAAKs6B,SAAL,CAAe,UAAUv2B,KAAV,EAAiB;AAC9B,cAAIA,MAAMkxB,WAAV,EAAuB;AACrBj1B,gBAAIypB,SAAJ,CAAc1lB,MAAMukB,GAApB,EAAyB,CAAzB,EAA4B,CAA5B,EAA+BtN,KAA/B,EAAsCC,MAAtC;AACD,WAFD,MAEO,IAAIlX,MAAMy3B,cAAV,EAA0B;AAC/BF,uBAAWt7B,GAAX,CAAe6pB,IAAf;AACA9lB,kBAAMy3B,cAAN,CAAqBF,WAAWt7B,GAAhC;AACAs7B,uBAAWt7B,GAAX,CAAe+pB,OAAf;AACD;AACF,SARD;AASD,OAdD,MAcO;AACL;AACA,YAAIwO,QAAQ,EAAZ;AACA,YAAI1W,cAAc,KAAKjgB,OAAL,CAAasC,cAAb,CAA4B,IAA5B,CAAlB;;AAEA,aAAK,IAAIvO,IAAI,CAAb,EAAgBA,IAAIksB,YAAYhsB,MAAhC,EAAwCF,GAAxC,EAA6C;AAC3C,cAAI8N,KAAKoe,YAAYlsB,CAAZ,CAAT;;AAEA,eAAK8iC,UAAL,CAAgBh1B,EAAhB,EAAoB63B,UAApB,EAAgC,IAAhC,EAAsC/C,KAAtC;AACD;AACF;;AAED,aAAO+C,WAAWhT,GAAlB;AACD,KA9rBiB;;AAgsBlB;;;AAGAN,cAAU,oBAAY;AACpB,aAAO,KAAKwO,MAAZ;AACD,KArsBiB;;AAusBlB;;;AAGAvO,eAAW,qBAAY;AACrB,aAAO,KAAKyO,OAAZ;AACD,KA5sBiB;AA6sBlBD,cAAU,kBAAUgF,KAAV,EAAiB;AACzB,UAAIv0B,OAAO,KAAK4uB,KAAhB;AACA,UAAI4F,KAAK,CAAC,OAAD,EAAU,QAAV,EAAoBD,KAApB,CAAT;AACA,UAAIE,MAAM,CAAC,aAAD,EAAgB,cAAhB,EAAgCF,KAAhC,CAAV;AACA,UAAIG,MAAM,CAAC,aAAD,EAAgB,YAAhB,EAA8BH,KAA9B,CAAV;AACA,UAAII,MAAM,CAAC,cAAD,EAAiB,eAAjB,EAAkCJ,KAAlC,CAAV;;AAEA,UAAIv0B,KAAKw0B,EAAL,KAAY,IAAZ,IAAoBx0B,KAAKw0B,EAAL,MAAa,MAArC,EAA6C;AAC3C,eAAO9sB,WAAW1H,KAAKw0B,EAAL,CAAX,CAAP;AACD;;AAED,UAAIpZ,OAAO,KAAKA,IAAhB,CAXyB,CAWH;;AAEtB,UAAIwZ,MAAMppC,SAASqpC,WAAT,CAAqBC,gBAArB,CAAsC1Z,IAAtC,CAAV;AACA,aAAO,CAACA,KAAKqZ,GAAL,KAAa5G,WAAW+G,IAAIJ,EAAJ,CAAX,CAAb,IAAoC3G,WAAWzS,KAAKgE,KAAL,CAAWoV,EAAX,CAAX,CAArC,KAAoE3G,WAAW+G,IAAIF,GAAJ,CAAX,KAAwB,CAA5F,KAAkG7G,WAAW+G,IAAID,GAAJ,CAAX,KAAwB,CAA1H,IAA+H,CAAtI;AACD,KA5tBiB;AA6tBlBI,iBAAa,qBAAUnjB,IAAV,EAAgBhR,GAAhB,EAAqB;AAChCA,YAAMA,OAAO,KAAKA,GAAlB;AACA,UAAIo0B,SAASxpC,SAASe,aAAT,CAAuB,QAAvB,CAAb;AACA,UAAIuM,MAAMk8B,OAAOxoC,UAAP,CAAkB,IAAlB,CAAV;AACA,UAAI0oB,OAAOtD,KAAK2E,eAAL,EAAX;AACA,UAAI6I,QAAQxN,KAAKwN,KAAjB;AACA,UAAI6V,iBAAiB7V,MAAM7C,UAAN,GAAmB3b,GAAxC;AACA,UAAI4b,gBAAgB4C,MAAM5C,aAAN,GAAsB5b,GAA1C;AACA,UAAI6b,gBAAgB2C,MAAM3C,aAAN,GAAsB7b,GAA1C;AACA,UAAI8b,YAAY0C,MAAMQ,SAAN,KAAoBR,MAAM1C,SAA1B,GAAsC,CAAtD;AACA,UAAIwY,aAAa3/B,KAAKqB,GAAL,CAAS8lB,YAAY,CAArB,EAAwB,CAACF,aAAD,GAAiByY,cAAzC,CAAjB;AACA,UAAIE,cAAc5/B,KAAKqB,GAAL,CAAS8lB,YAAY,CAArB,EAAwBF,gBAAgByY,cAAxC,CAAlB;AACA,UAAIG,YAAY7/B,KAAKqB,GAAL,CAAS8lB,YAAY,CAArB,EAAwB,CAACD,aAAD,GAAiBwY,cAAzC,CAAhB;AACA,UAAII,eAAe9/B,KAAKqB,GAAL,CAAS8lB,YAAY,CAArB,EAAwBD,gBAAgBwY,cAAxC,CAAnB;AACA,UAAInhB,QAAQoB,KAAKpB,KAAL,GAAaohB,UAAb,GAA0BC,WAAtC;AACA,UAAIphB,SAASmB,KAAKnB,MAAL,GAAcqhB,SAAd,GAA0BC,YAAvC;AACAL,aAAOlhB,KAAP,GAAeA,QAAQlT,GAAvB;AACAo0B,aAAOjhB,MAAP,GAAgBA,SAASnT,GAAzB;AACA9H,UAAIhD,KAAJ,CAAU8K,GAAV,EAAeA,GAAf;AACA9H,UAAI0pB,SAAJ,CAAc,CAAd,EAAiB,CAAjB,EAAoB1O,KAApB,EAA2BC,MAA3B;AACAjb,UAAI8H,GAAJ,GAAUA,GAAV;AACA,UAAI00B,gBAAgB;AAClBr1B,kBAAU2R,KAAK3R,QADG;AAElBC,kBAAU0R,KAAK1R,QAFG;AAGlBpK,eAAO8b,KAAK9b;AAHM,OAApB;AAKA8b,WAAK3R,QAAL,GAAgB,CAACi1B,aAAahgB,KAAKtgB,CAAnB,EAAsBwgC,YAAYlgB,KAAKrgB,CAAvC,CAAhB;AACA+c,WAAK1R,QAAL,GAAgB,CAAhB;AACA0R,WAAK9b,KAAL,GAAa,CAAC,CAAD,EAAI,CAAJ,CAAb;AACA8b,WAAKrR,eAAL;;AAEA,UAAIqR,IAAJ,EAAU;AACRA,aAAKkb,KAAL,CAAWh0B,GAAX;AACD;;AAED,UAAIy8B,aAAanI,MAAjB;AACA,UAAIoI,WAAW,IAAID,UAAJ,CAAe;AAC5BnW,eAAO;AACLxqB,aAAG,CADE;AAELC,aAAG,CAFE;AAGL0rB,iBAAOyU;AAHF;AADqB,OAAf,CAAf;;AAQA,UAAIM,cAAcr1B,QAAd,IAA0B,IAA9B,EAAoC;AAClCu1B,iBAASv1B,QAAT,GAAoB2R,KAAK3R,QAAL,GAAgBq1B,cAAcr1B,QAAlD;AACD;;AAED,UAAIq1B,cAAcp1B,QAAd,IAA0B,IAA9B,EAAoC;AAClCs1B,iBAASt1B,QAAT,GAAoB0R,KAAK1R,QAAL,GAAgBo1B,cAAcp1B,QAAlD;AACD;;AAED,UAAIo1B,cAAcx/B,KAAd,IAAuB,IAA3B,EAAiC;AAC/B0/B,iBAAS1/B,KAAT,GAAiB8b,KAAK9b,KAAL,GAAaw/B,cAAcx/B,KAA5C;AACD;;AAED,aAAO0/B,QAAP;AACD;AAtxBiB,GAApB;;AAyxBA;;;;;AAKA,MAAIC,cAAc,OAAO/oC,MAAP,KAAkB,WAAlB,IAAiC,CAAC,CAACA,OAAOgpC,gBAA5D;AACA,MAAIC,kBAAkB,gDAAtB;;AAEA,WAASC,qBAAT,CAA+Br5B,EAA/B,EAAmC;AACjC;AACA,WAAOA,GAAGq5B,qBAAH,GAA2Br5B,GAAGq5B,qBAAH,EAA3B,GAAwD;AAC7Dne,YAAM,CADuD;AAE7DwJ,WAAK;AAFwD,KAA/D;AAID,GAzsS2B,CAysS1B;;;AAGF,WAAS4U,aAAT,CAAuBt5B,EAAvB,EAA2BpF,CAA3B,EAA8BrC,GAA9B,EAAmCghC,SAAnC,EAA8C;AAC5ChhC,UAAMA,OAAO,EAAb,CAD4C,CAC3B;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,QAAIghC,aAAa,CAAChqC,MAAMT,eAAxB,EAAyC;AACvC0qC,qBAAex5B,EAAf,EAAmBpF,CAAnB,EAAsBrC,GAAtB;AACD,KAFD,CAEE;AACF;AACA;AACA;AACA;AACA;AACA;AARA,SASK,IAAIhJ,MAAMb,OAAN,CAAce,OAAd,IAAyBmL,EAAE6+B,MAAF,IAAY,IAArC,IAA6C7+B,EAAE6+B,MAAF,KAAa7+B,EAAEM,OAAhE,EAAyE;AAC1E3C,YAAI8E,GAAJ,GAAUzC,EAAE6+B,MAAZ;AACAlhC,YAAI+E,GAAJ,GAAU1C,EAAE8+B,MAAZ;AACD,OAHE,CAGD;AAHC,WAIE,IAAI9+B,EAAEM,OAAF,IAAa,IAAjB,EAAuB;AACxB3C,cAAI8E,GAAJ,GAAUzC,EAAEM,OAAZ;AACA3C,cAAI+E,GAAJ,GAAU1C,EAAEQ,OAAZ;AACD,SAHE,CAGD;AAHC,aAIE;AACDo+B,2BAAex5B,EAAf,EAAmBpF,CAAnB,EAAsBrC,GAAtB;AACD;;AAEP,WAAOA,GAAP;AACD;;AAED,WAASihC,cAAT,CAAwBx5B,EAAxB,EAA4BpF,CAA5B,EAA+BrC,GAA/B,EAAoC;AAClC;AACA,QAAIohC,MAAMN,sBAAsBr5B,EAAtB,CAAV;AACAzH,QAAI8E,GAAJ,GAAUzC,EAAEg/B,OAAF,GAAYD,IAAIze,IAA1B;AACA3iB,QAAI+E,GAAJ,GAAU1C,EAAEi/B,OAAF,GAAYF,IAAIjV,GAA1B;AACD;AACD;;;;;AAMA,WAASoV,cAAT,CAAwB95B,EAAxB,EAA4BpF,CAA5B,EAA+B2+B,SAA/B,EAA0C;AACxC3+B,QAAIA,KAAKzK,OAAOoL,KAAhB;;AAEA,QAAIX,EAAEyC,GAAF,IAAS,IAAb,EAAmB;AACjB,aAAOzC,CAAP;AACD;;AAED,QAAIoO,YAAYpO,EAAEtF,IAAlB;AACA,QAAIykC,UAAU/wB,aAAaA,UAAUvV,OAAV,CAAkB,OAAlB,KAA8B,CAAzD;;AAEA,QAAI,CAACsmC,OAAL,EAAc;AACZT,oBAAct5B,EAAd,EAAkBpF,CAAlB,EAAqBA,CAArB,EAAwB2+B,SAAxB;AACA3+B,QAAEgD,OAAF,GAAYhD,EAAE+C,UAAF,GAAe/C,EAAE+C,UAAF,GAAe,GAA9B,GAAoC,EAAE/C,EAAEo/B,MAAF,IAAY,CAAd,IAAmB,CAAnE;AACD,KAHD,MAGO;AACL,UAAIC,QAAQjxB,aAAa,UAAb,GAA0BpO,EAAEs/B,aAAF,CAAgB,CAAhB,CAA1B,GAA+Ct/B,EAAEu/B,cAAF,CAAiB,CAAjB,CAA3D;AACAF,eAASX,cAAct5B,EAAd,EAAkBi6B,KAAlB,EAAyBr/B,CAAzB,EAA4B2+B,SAA5B,CAAT;AACD,KAhBuC,CAgBtC;AACF;AACA;AACA;;;AAGA,QAAIa,SAASx/B,EAAEw/B,MAAf;;AAEA,QAAIx/B,EAAEkD,KAAF,IAAW,IAAX,IAAmBs8B,WAAWC,SAA9B,IAA2CjB,gBAAgBtpC,IAAhB,CAAqB8K,EAAEtF,IAAvB,CAA/C,EAA6E;AAC3EsF,QAAEkD,KAAF,GAAUs8B,SAAS,CAAT,GAAa,CAAb,GAAiBA,SAAS,CAAT,GAAa,CAAb,GAAiBA,SAAS,CAAT,GAAa,CAAb,GAAiB,CAA7D;AACD;;AAED,WAAOx/B,CAAP;AACD;AACD;;;;;;AAMA,WAASu+B,gBAAT,CAA0Bn5B,EAA1B,EAA8BvO,IAA9B,EAAoC2K,OAApC,EAA6C;AAC3C,QAAI88B,WAAJ,EAAiB;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAl5B,SAAGm5B,gBAAH,CAAoB1nC,IAApB,EAA0B2K,OAA1B;AACD,KAtBD,MAsBO;AACL4D,SAAGs6B,WAAH,CAAe,OAAO7oC,IAAtB,EAA4B2K,OAA5B;AACD;AACF;AACD,WAASm+B,mBAAT,CAA6Bv6B,EAA7B,EAAiCvO,IAAjC,EAAuC2K,OAAvC,EAAgD;AAC9C,QAAI88B,WAAJ,EAAiB;AACfl5B,SAAGu6B,mBAAH,CAAuB9oC,IAAvB,EAA6B2K,OAA7B;AACD,KAFD,MAEO;AACL4D,SAAGw6B,WAAH,CAAe,OAAO/oC,IAAtB,EAA4B2K,OAA5B;AACD;AACF;AACD;;;;;;;;;;AAUA,MAAImY,OAAO2kB,cAAc,UAAUt+B,CAAV,EAAa;AACpCA,MAAE6/B,cAAF;AACA7/B,MAAE8/B,eAAF;AACA9/B,MAAEwC,YAAF,GAAiB,IAAjB;AACD,GAJU,GAIP,UAAUxC,CAAV,EAAa;AACfA,MAAE+/B,WAAF,GAAgB,KAAhB;AACA//B,MAAEwC,YAAF,GAAiB,IAAjB;AACD,GAPD;AAQC;;AAED;;;;;;AAMA;AACA;AACA;AACA;;;;;AAKA;;;;;;;;;;;;;;;;;;;;;;;;AAwBA,MAAIw9B,YAAY,SAAZA,SAAY,CAAUtzB,OAAV,EAAmB;AACjCA,cAAUA,WAAW,EAArB;AACA,SAAKuzB,KAAL,GAAavzB,QAAQuzB,KAAR,IAAiB,EAA9B;;AAEA,SAAK9yB,OAAL,GAAeT,QAAQS,OAAR,IAAmB,YAAY,CAAE,CAAhD,CAJiC,CAIiB;;;AAGlD,SAAK+yB,MAAL,GAAc,EAAd;AACA,SAAKC,QAAL,GAAgB,KAAhB;AACA,SAAKC,KAAL;AACA,SAAK9yB,WAAL;AACA,SAAK+yB,WAAL;AACA,SAAK9yB,OAAL,GAAe,KAAf;AACAlM,aAASjK,IAAT,CAAc,IAAd;AACD,GAdD;;AAgBA4oC,YAAUnqC,SAAV,GAAsB;AACpB6B,iBAAasoC,SADO;;AAGpB;;;;AAIAvmB,aAAS,iBAAUnB,IAAV,EAAgB;AACvB,WAAK4nB,MAAL,CAAYpmC,IAAZ,CAAiBwe,IAAjB;AACD,KATmB;;AAWpB;;;;AAIAyC,iBAAa,qBAAUrE,QAAV,EAAoB;AAC/BA,eAAS8C,SAAT,GAAqB,IAArB;AACA,UAAI8mB,QAAQ5pB,SAASsD,QAAT,EAAZ;;AAEA,WAAK,IAAI1iB,IAAI,CAAb,EAAgBA,IAAIgpC,MAAM9oC,MAA1B,EAAkCF,GAAlC,EAAuC;AACrC,aAAKmiB,OAAL,CAAa6mB,MAAMhpC,CAAN,CAAb;AACD;AACF,KAtBmB;;AAwBpB;;;;AAIAwiB,gBAAY,oBAAUxB,IAAV,EAAgB;AAC1B,UAAIiG,MAAM1lB,QAAQ,KAAKqnC,MAAb,EAAqB5nB,IAArB,CAAV;;AAEA,UAAIiG,OAAO,CAAX,EAAc;AACZ,aAAK2hB,MAAL,CAAYh+B,MAAZ,CAAmBqc,GAAnB,EAAwB,CAAxB;AACD;AACF,KAlCmB;;AAoCpB;;;;AAIAjC,oBAAgB,wBAAU5F,QAAV,EAAoB;AAClC,UAAI4pB,QAAQ5pB,SAASsD,QAAT,EAAZ;;AAEA,WAAK,IAAI1iB,IAAI,CAAb,EAAgBA,IAAIgpC,MAAM9oC,MAA1B,EAAkCF,GAAlC,EAAuC;AACrC,aAAKwiB,UAAL,CAAgBwmB,MAAMhpC,CAAN,CAAhB;AACD;;AAEDof,eAAS8C,SAAT,GAAqB,IAArB;AACD,KAhDmB;AAiDpB+mB,aAAS,mBAAY;AACnB,UAAI7oB,OAAO,IAAIsjB,IAAJ,GAAWwF,OAAX,KAAuB,KAAKlzB,WAAvC;;AAEA,UAAIoF,QAAQgF,OAAO,KAAK0oB,KAAxB;AACA,UAAIE,QAAQ,KAAKJ,MAAjB;AACA,UAAI3oC,MAAM+oC,MAAM9oC,MAAhB;AACA,UAAIipC,iBAAiB,EAArB;AACA,UAAIC,gBAAgB,EAApB;;AAEA,WAAK,IAAIppC,IAAI,CAAb,EAAgBA,IAAIC,GAApB,EAAyBD,GAAzB,EAA8B;AAC5B,YAAIghB,OAAOgoB,MAAMhpC,CAAN,CAAX;AACA,YAAI0I,IAAIsY,KAAK9K,IAAL,CAAUkK,IAAV,EAAgBhF,KAAhB,CAAR,CAF4B,CAEI;AAChC;;AAEA,YAAI1S,CAAJ,EAAO;AACLygC,yBAAe3mC,IAAf,CAAoBkG,CAApB;AACA0gC,wBAAc5mC,IAAd,CAAmBwe,IAAnB;AACD;AACF,OAlBkB,CAkBjB;;;AAGF,WAAK,IAAIhhB,IAAI,CAAb,EAAgBA,IAAIC,GAApB,GAA0B;AACxB,YAAI+oC,MAAMhpC,CAAN,EAAS4W,YAAb,EAA2B;AACzBoyB,gBAAMhpC,CAAN,IAAWgpC,MAAM/oC,MAAM,CAAZ,CAAX;AACA+oC,gBAAMtuB,GAAN;AACAza;AACD,SAJD,MAIO;AACLD;AACD;AACF;;AAEDC,YAAMkpC,eAAejpC,MAArB;;AAEA,WAAK,IAAIF,IAAI,CAAb,EAAgBA,IAAIC,GAApB,EAAyBD,GAAzB,EAA8B;AAC5BopC,sBAAcppC,CAAd,EAAiB0W,IAAjB,CAAsByyB,eAAenpC,CAAf,CAAtB;AACD;;AAED,WAAK8oC,KAAL,GAAa1oB,IAAb;AACA,WAAKvK,OAAL,CAAauF,KAAb,EAtCmB,CAsCE;AACrB;AACA;;AAEA,WAAK1Q,OAAL,CAAa,OAAb,EAAsB0Q,KAAtB;;AAEA,UAAI,KAAKutB,KAAL,CAAWtkB,MAAf,EAAuB;AACrB,aAAKskB,KAAL,CAAWtkB,MAAX;AACD;AACF,KAhGmB;AAiGpBglB,gBAAY,sBAAY;AACtB,UAAIrsC,OAAO,IAAX;AACA,WAAK6rC,QAAL,GAAgB,IAAhB;;AAEA,eAAS3yB,IAAT,GAAgB;AACd,YAAIlZ,KAAK6rC,QAAT,EAAmB;AACjBxU,gCAAsBne,IAAtB;AACA,WAAClZ,KAAKiZ,OAAN,IAAiBjZ,KAAKisC,OAAL,EAAjB;AACD;AACF;;AAED5U,4BAAsBne,IAAtB;AACD,KA7GmB;;AA+GpB;;;AAGA0K,WAAO,iBAAY;AACjB,WAAKkoB,KAAL,GAAa,IAAIpF,IAAJ,GAAWwF,OAAX,EAAb;AACA,WAAKlzB,WAAL,GAAmB,CAAnB;;AAEA,WAAKqzB,UAAL;AACD,KAvHmB;;AAyHpB;;;AAGAhnB,UAAM,gBAAY;AAChB,WAAKwmB,QAAL,GAAgB,KAAhB;AACD,KA9HmB;;AAgIpB;;;AAGA7xB,WAAO,iBAAY;AACjB,UAAI,CAAC,KAAKf,OAAV,EAAmB;AACjB,aAAK8yB,WAAL,GAAmB,IAAIrF,IAAJ,GAAWwF,OAAX,EAAnB;AACA,aAAKjzB,OAAL,GAAe,IAAf;AACD;AACF,KAxImB;;AA0IpB;;;AAGAgB,YAAQ,kBAAY;AAClB,UAAI,KAAKhB,OAAT,EAAkB;AAChB,aAAKD,WAAL,IAAoB,IAAI0tB,IAAJ,GAAWwF,OAAX,KAAuB,KAAKH,WAAhD;AACA,aAAK9yB,OAAL,GAAe,KAAf;AACD;AACF,KAlJmB;;AAoJpB;;;AAGA6B,WAAO,iBAAY;AACjB,WAAK8wB,MAAL,GAAc,EAAd;AACD,KAzJmB;;AA2JpB;;;AAGAU,gBAAY,sBAAY;AACtB,aAAO,CAAC,KAAKV,MAAL,CAAY1oC,MAApB;AACD,KAhKmB;;AAkKpB;;;;;;;;;;AAUA;AACAgjB,aAAS,iBAAUxiB,MAAV,EAAkB0U,OAAlB,EAA2B;AAClCA,gBAAUA,WAAW,EAArB;AACA,UAAIgK,WAAW,IAAI8B,QAAJ,CAAaxgB,MAAb,EAAqB0U,QAAQO,IAA7B,EAAmCP,QAAQoK,MAA3C,EAAmDpK,QAAQsK,MAA3D,CAAf;AACA,WAAK+D,WAAL,CAAiBrE,QAAjB;AACA,aAAOA,QAAP;AACD;AAlLmB,GAAtB;AAoLAnd,QAAMymC,SAAN,EAAiB3+B,QAAjB;;AAEA;;;AAGA,MAAIw/B,aAAa,SAAbA,UAAa,GAAY;AAC3B;;;;AAIA,SAAKC,MAAL,GAAc,EAAd;AACD,GAND;;AAQAD,aAAWhrC,SAAX,GAAuB;AACrB6B,iBAAampC,UADQ;AAErBE,eAAW,mBAAUpgC,KAAV,EAAiB3I,MAAjB,EAAyBisB,IAAzB,EAA+B;AACxC,WAAK+c,QAAL,CAAcrgC,KAAd,EAAqB3I,MAArB,EAA6BisB,IAA7B;;AAEA,aAAO,KAAKgd,UAAL,CAAgBtgC,KAAhB,CAAP;AACD,KANoB;AAOrByO,WAAO,iBAAY;AACjB,WAAK0xB,MAAL,CAAYtpC,MAAZ,GAAqB,CAArB;AACA,aAAO,IAAP;AACD,KAVoB;AAWrBwpC,cAAU,kBAAUrgC,KAAV,EAAiB3I,MAAjB,EAAyBisB,IAAzB,EAA+B;AACvC,UAAIid,UAAUvgC,MAAMugC,OAApB;;AAEA,UAAI,CAACA,OAAL,EAAc;AACZ;AACD;;AAED,UAAIC,YAAY;AACdC,gBAAQ,EADM;AAEdF,iBAAS,EAFK;AAGdlpC,gBAAQA,MAHM;AAId2I,eAAOA;AAJO,OAAhB;;AAOA,WAAK,IAAIrJ,IAAI,CAAR,EAAWC,MAAM2pC,QAAQ1pC,MAA9B,EAAsCF,IAAIC,GAA1C,EAA+CD,GAA/C,EAAoD;AAClD,YAAI+nC,QAAQ6B,QAAQ5pC,CAAR,CAAZ;AACA,YAAI+pC,MAAM3C,cAAcza,IAAd,EAAoBob,KAApB,EAA2B,EAA3B,CAAV;AACA8B,kBAAUC,MAAV,CAAiBtnC,IAAjB,CAAsB,CAACunC,IAAI5+B,GAAL,EAAU4+B,IAAI3+B,GAAd,CAAtB;AACAy+B,kBAAUD,OAAV,CAAkBpnC,IAAlB,CAAuBulC,KAAvB;AACD;;AAED,WAAKyB,MAAL,CAAYhnC,IAAZ,CAAiBqnC,SAAjB;AACD,KAjCoB;AAkCrBF,gBAAY,oBAAUtgC,KAAV,EAAiB;AAC3B,WAAK,IAAIqE,SAAT,IAAsBs8B,WAAtB,EAAmC;AACjC,YAAIA,YAAYxpC,cAAZ,CAA2BkN,SAA3B,CAAJ,EAA2C;AACzC,cAAIu8B,cAAcD,YAAYt8B,SAAZ,EAAuB,KAAK87B,MAA5B,EAAoCngC,KAApC,CAAlB;;AAEA,cAAI4gC,WAAJ,EAAiB;AACf,mBAAOA,WAAP;AACD;AACF;AACF;AACF;AA5CoB,GAAvB;;AA+CA,WAASC,MAAT,CAAgBC,SAAhB,EAA2B;AACzB,QAAI7gC,KAAK6gC,UAAU,CAAV,EAAa,CAAb,IAAkBA,UAAU,CAAV,EAAa,CAAb,CAA3B;AACA,QAAI5gC,KAAK4gC,UAAU,CAAV,EAAa,CAAb,IAAkBA,UAAU,CAAV,EAAa,CAAb,CAA3B;AACA,WAAOrjC,KAAKC,IAAL,CAAUuC,KAAKA,EAAL,GAAUC,KAAKA,EAAzB,CAAP;AACD;;AAED,WAASoxB,MAAT,CAAgBwP,SAAhB,EAA2B;AACzB,WAAO,CAAC,CAACA,UAAU,CAAV,EAAa,CAAb,IAAkBA,UAAU,CAAV,EAAa,CAAb,CAAnB,IAAsC,CAAvC,EAA0C,CAACA,UAAU,CAAV,EAAa,CAAb,IAAkBA,UAAU,CAAV,EAAa,CAAb,CAAnB,IAAsC,CAAhF,CAAP;AACD;;AAED,MAAIH,cAAc;AAChBI,WAAO,eAAUC,KAAV,EAAiBhhC,KAAjB,EAAwB;AAC7B,UAAIwW,WAAWwqB,MAAMnqC,MAArB;;AAEA,UAAI,CAAC2f,QAAL,EAAe;AACb;AACD;;AAED,UAAIyqB,WAAW,CAACD,MAAMxqB,WAAW,CAAjB,KAAuB,EAAxB,EAA4BiqB,MAA3C;AACA,UAAIS,WAAW,CAACF,MAAMxqB,WAAW,CAAjB,KAAuB,EAAxB,EAA4BiqB,MAA5B,IAAsCQ,QAArD;;AAEA,UAAIC,YAAYA,SAASrqC,MAAT,GAAkB,CAA9B,IAAmCoqC,QAAnC,IAA+CA,SAASpqC,MAAT,GAAkB,CAArE,EAAwE;AACtE,YAAIsL,aAAa0+B,OAAOI,QAAP,IAAmBJ,OAAOK,QAAP,CAApC;AACA,SAACC,SAASh/B,UAAT,CAAD,KAA0BA,aAAa,CAAvC;AACAnC,cAAMmC,UAAN,GAAmBA,UAAnB;AACA,YAAIi/B,cAAc9P,OAAO2P,QAAP,CAAlB;AACAjhC,cAAMiC,MAAN,GAAem/B,YAAY,CAAZ,CAAf;AACAphC,cAAMkC,MAAN,GAAek/B,YAAY,CAAZ,CAAf;AACA,eAAO;AACLrnC,gBAAM,OADD;AAEL1C,kBAAQ2pC,MAAM,CAAN,EAAS3pC,MAFZ;AAGL2I,iBAAOA;AAHF,SAAP;AAKD;AACF,KAxBe,CAwBd;;AAxBc,GAAlB;;AA4BA,MAAIqhC,oBAAoB,GAAxB;AACA,MAAIC,oBAAoB,CAAC,OAAD,EAAU,UAAV,EAAsB,YAAtB,EAAoC,UAApC,EAAgD,SAAhD,EAA2D,WAA3D,EAAwE,WAAxE,EAAqF,aAArF,CAAxB;AACA,MAAIC,oBAAoB,CAAC,YAAD,EAAe,UAAf,EAA2B,WAA3B,CAAxB;AACA,MAAIC,oBAAoB;AACtBC,iBAAa,CADS;AAEtBC,eAAW,CAFW;AAGtBC,iBAAa,CAHS;AAItBC,gBAAY;AAJU,GAAxB;AAMA,MAAIC,sBAAsBhsC,IAAIyrC,iBAAJ,EAAuB,UAAUprC,IAAV,EAAgB;AAC/D,QAAI4rC,KAAK5rC,KAAKkF,OAAL,CAAa,OAAb,EAAsB,SAAtB,CAAT;AACA,WAAOomC,kBAAkBM,EAAlB,IAAwBA,EAAxB,GAA6B5rC,IAApC;AACD,GAHyB,CAA1B;;AAKA,WAAS6rC,YAAT,CAAsB7rC,IAAtB,EAA4B;AAC1B,WAAOA,SAAS,YAAT,IAAyBlC,MAAMb,OAAN,CAAce,OAAvC,GAAiD,gBAAjD,GAAoEgC,IAA3E;AACD;;AAED,WAAS8rC,cAAT,CAAwBl/B,KAAxB,EAA+B9C,KAA/B,EAAsCs/B,KAAtC,EAA6C;AAC3C,QAAI2C,aAAan/B,MAAMo/B,WAAvB;AACA5C,cAAU,OAAV,IAAqB2C,WAAWxzB,KAAX,EAArB;AACA,QAAImyB,cAAcqB,WAAW7B,SAAX,CAAqBpgC,KAArB,EAA4B8C,MAAMjC,OAAN,CAAcR,SAAd,CAAwBL,MAAM8B,GAA9B,EAAmC9B,MAAM+B,GAAzC,EAA8C,IAA9C,EAAoD1K,MAAhF,EAAwFyL,MAAMwmB,GAA9F,CAAlB;AACAgW,cAAU,KAAV,IAAmB2C,WAAWxzB,KAAX,EAAnB,CAJ2C,CAIJ;;AAEvC,QAAImyB,WAAJ,EAAiB;AACf,UAAI7mC,OAAO6mC,YAAY7mC,IAAvB;AACAiG,YAAMgC,YAAN,GAAqBjI,IAArB;AACA+I,YAAMjC,OAAN,CAAcf,iBAAd,CAAgC;AAC9BzI,gBAAQupC,YAAYvpC;AADU,OAAhC,EAEG0C,IAFH,EAES6mC,YAAY5gC,KAFrB;AAGD;AACF,GAjsT2B,CAisT1B;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;AASA,WAASmiC,aAAT,CAAuBC,QAAvB,EAAiC;AAC/BA,aAASC,SAAT,GAAqB,IAArB;AACAC,iBAAaF,SAASG,WAAtB;AACAH,aAASG,WAAT,GAAuBnX,WAAW,YAAY;AAC5CgX,eAASC,SAAT,GAAqB,KAArB;AACD,KAFsB,EAEpB,GAFoB,CAAvB;AAGD;;AAED,MAAIG,cAAc;AAChB;;;;;AAKAn/B,eAAW,mBAAUrD,KAAV,EAAiB;AAC1BA,cAAQu+B,eAAe,KAAKjV,GAApB,EAAyBtpB,KAAzB,CAAR;AACA,WAAKqB,OAAL,CAAa,WAAb,EAA0BrB,KAA1B;AACD,KATe;;AAWhB;;;;;AAKA6D,cAAU,kBAAU7D,KAAV,EAAiB;AACzBA,cAAQu+B,eAAe,KAAKjV,GAApB,EAAyBtpB,KAAzB,CAAR;AACA,UAAI8D,UAAU9D,MAAM+D,SAAN,IAAmB/D,MAAMgE,aAAvC;;AAEA,UAAIF,WAAW,KAAKwlB,GAApB,EAAyB;AACvB,eAAOxlB,WAAWA,QAAQ7J,QAAR,IAAoB,CAAtC,EAAyC;AACvC;AACA,cAAI6J,YAAY,KAAKwlB,GAArB,EAA0B;AACxB;AACD;;AAEDxlB,oBAAUA,QAAQI,UAAlB;AACD;AACF;;AAED,WAAK7C,OAAL,CAAa,UAAb,EAAyBrB,KAAzB;AACD,KAhCe;;AAkChB;;;;;AAKAyiC,gBAAY,oBAAUziC,KAAV,EAAiB;AAC3B;AACA;AACAA,cAAQu+B,eAAe,KAAKjV,GAApB,EAAyBtpB,KAAzB,CAAR,CAH2B,CAGc;AACzC;;AAEAA,YAAMsC,SAAN,GAAkB,IAAlB;AACA,WAAKW,gBAAL,GAAwB,IAAIo3B,IAAJ,EAAxB;AACA2H,qBAAe,IAAf,EAAqBhiC,KAArB,EAA4B,OAA5B,EAR2B,CAQW;AACtC;;AAEAwiC,kBAAYn/B,SAAZ,CAAsB5M,IAAtB,CAA2B,IAA3B,EAAiCuJ,KAAjC;AACAwiC,kBAAYE,SAAZ,CAAsBjsC,IAAtB,CAA2B,IAA3B,EAAiCuJ,KAAjC;AACAmiC,oBAAc,IAAd;AACD,KArDe;;AAuDhB;;;;;AAKAQ,eAAW,mBAAU3iC,KAAV,EAAiB;AAC1BA,cAAQu+B,eAAe,KAAKjV,GAApB,EAAyBtpB,KAAzB,CAAR,CAD0B,CACe;AACzC;;AAEAA,YAAMsC,SAAN,GAAkB,IAAlB;AACA0/B,qBAAe,IAAf,EAAqBhiC,KAArB,EAA4B,QAA5B,EAL0B,CAKa;AACvC;AACA;;AAEAwiC,kBAAYn/B,SAAZ,CAAsB5M,IAAtB,CAA2B,IAA3B,EAAiCuJ,KAAjC;AACAmiC,oBAAc,IAAd;AACD,KAvEe;;AAyEhB;;;;;AAKAS,cAAU,kBAAU5iC,KAAV,EAAiB;AACzBA,cAAQu+B,eAAe,KAAKjV,GAApB,EAAyBtpB,KAAzB,CAAR,CADyB,CACgB;AACzC;;AAEAA,YAAMsC,SAAN,GAAkB,IAAlB;AACA0/B,qBAAe,IAAf,EAAqBhiC,KAArB,EAA4B,KAA5B;AACAwiC,kBAAYK,OAAZ,CAAoBpsC,IAApB,CAAyB,IAAzB,EAA+BuJ,KAA/B,EANyB,CAMc;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,UAAI,CAAC,IAAIq6B,IAAJ,EAAD,GAAc,KAAKp3B,gBAAnB,GAAsCo+B,iBAA1C,EAA6D;AAC3DmB,oBAAYM,KAAZ,CAAkBrsC,IAAlB,CAAuB,IAAvB,EAA6BuJ,KAA7B;AACD;;AAEDmiC,oBAAc,IAAd;AACD,KAnGe;AAoGhBV,iBAAa,qBAAUzhC,KAAV,EAAiB;AAC5BwiC,kBAAYE,SAAZ,CAAsBjsC,IAAtB,CAA2B,IAA3B,EAAiCuJ,KAAjC,EAD4B,CACa;AACzC;AACA;AACD,KAxGe;AAyGhB2hC,iBAAa,qBAAU3hC,KAAV,EAAiB;AAC5B;AACA;AACA;AACA;AACA;AACA,UAAI,CAAC+iC,mBAAmB/iC,KAAnB,CAAL,EAAgC;AAC9BwiC,oBAAYn/B,SAAZ,CAAsB5M,IAAtB,CAA2B,IAA3B,EAAiCuJ,KAAjC;AACD;AACF,KAlHe;AAmHhB0hC,eAAW,mBAAU1hC,KAAV,EAAiB;AAC1BwiC,kBAAYK,OAAZ,CAAoBpsC,IAApB,CAAyB,IAAzB,EAA+BuJ,KAA/B;AACD,KArHe;AAsHhB4hC,gBAAY,oBAAU5hC,KAAV,EAAiB;AAC3B;AACA;AACA;AACA;AACA;AACA,UAAI,CAAC+iC,mBAAmB/iC,KAAnB,CAAL,EAAgC;AAC9BwiC,oBAAY3+B,QAAZ,CAAqBpN,IAArB,CAA0B,IAA1B,EAAgCuJ,KAAhC;AACD;AACF;AA/He,GAAlB;;AAkIA,WAAS+iC,kBAAT,CAA4B/iC,KAA5B,EAAmC;AACjC,QAAIgjC,cAAchjC,MAAMgjC,WAAxB;AACA,WAAOA,gBAAgB,KAAhB,IAAyBA,gBAAgB,OAAhD;AACD,GAp2T2B,CAo2T1B;AACF;AACA;AACA;;;AAGAjqC,SAAO,CAAC,OAAD,EAAU,WAAV,EAAuB,SAAvB,EAAkC,YAAlC,EAAgD,UAAhD,EAA4D,aAA5D,CAAP,EAAmF,UAAU7C,IAAV,EAAgB;AACjGssC,gBAAYtsC,IAAZ,IAAoB,UAAU8J,KAAV,EAAiB;AACnCA,cAAQu+B,eAAe,KAAKjV,GAApB,EAAyBtpB,KAAzB,CAAR;AACA,WAAKqB,OAAL,CAAanL,IAAb,EAAmB8J,KAAnB;AACD,KAHD;AAID,GALD;AAMA;;;;;;;AAOA,WAASijC,cAAT,CAAwBb,QAAxB,EAAkC;AAChCrpC,WAAOwoC,iBAAP,EAA0B,UAAUrrC,IAAV,EAAgB;AACxCksC,eAASc,SAAT,CAAmBhtC,IAAnB,IAA2BoD,KAAKkpC,YAAYtsC,IAAZ,CAAL,EAAwBksC,QAAxB,CAA3B;AACD,KAFD;AAGArpC,WAAO8oC,mBAAP,EAA4B,UAAU3rC,IAAV,EAAgB;AAC1CksC,eAASc,SAAT,CAAmBhtC,IAAnB,IAA2BoD,KAAKkpC,YAAYtsC,IAAZ,CAAL,EAAwBksC,QAAxB,CAA3B;AACD,KAFD;AAGArpC,WAAOuoC,iBAAP,EAA0B,UAAUprC,IAAV,EAAgB;AACxCksC,eAASc,SAAT,CAAmBhtC,IAAnB,IAA2BitC,iBAAiBX,YAAYtsC,IAAZ,CAAjB,EAAoCksC,QAApC,CAA3B;AACD,KAFD;;AAIA,aAASe,gBAAT,CAA0BhtC,EAA1B,EAA8BisC,QAA9B,EAAwC;AACtC,aAAO,YAAY;AACjB,YAAIA,SAASC,SAAb,EAAwB;AACtB;AACD;;AAED,eAAOlsC,GAAGuD,KAAH,CAAS0oC,QAAT,EAAmB3oC,SAAnB,CAAP;AACD,OAND;AAOD;AACF;;AAED,WAAS2pC,eAAT,CAAyB9Z,GAAzB,EAA8B;AAC5B5oB,aAASjK,IAAT,CAAc,IAAd;AACA,SAAK6yB,GAAL,GAAWA,GAAX;AACA;;;;;AAKA,SAAK+Y,SAAL,GAAiB,KAAjB;AACA;;;;;AAKA,SAAKE,WAAL;AACA;;;;;AAKA,SAAKL,WAAL,GAAmB,IAAIhC,UAAJ,EAAnB;AACA,SAAKgD,SAAL,GAAiB,EAAjB;AACAD,mBAAe,IAAf;;AAEA,QAAIjvC,MAAMa,sBAAV,EAAkC;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACAwuC,oBAAcxB,mBAAd,EAAmC,IAAnC,EARgC,CAQU;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACD,KArBD,MAqBO;AACL,UAAI7tC,MAAMP,oBAAV,EAAgC;AAC9B4vC,sBAAc9B,iBAAd,EAAiC,IAAjC,EAD8B,CACU;AACxC;AACD,OAJI,CAIH;AACF;AACA;AACA;AACA;;;AAGA8B,oBAAc/B,iBAAd,EAAiC,IAAjC;AACD;;AAED,aAAS+B,aAAT,CAAuB3gC,YAAvB,EAAqC0/B,QAArC,EAA+C;AAC7CrpC,aAAO2J,YAAP,EAAqB,UAAUxM,IAAV,EAAgB;AACnC0nC,yBAAiBtU,GAAjB,EAAsByY,aAAa7rC,IAAb,CAAtB,EAA0CksC,SAASc,SAAT,CAAmBhtC,IAAnB,CAA1C;AACD,OAFD,EAEGksC,QAFH;AAGD;AACF;;AAED,MAAIkB,uBAAuBF,gBAAgBluC,SAA3C;;AAEAouC,uBAAqB7gC,OAArB,GAA+B,YAAY;AACzC,QAAIC,eAAe4+B,kBAAkB3nC,MAAlB,CAAyB4nC,iBAAzB,CAAnB;;AAEA,SAAK,IAAI5qC,IAAI,CAAb,EAAgBA,IAAI+L,aAAa7L,MAAjC,EAAyCF,GAAzC,EAA8C;AAC5C,UAAIT,OAAOwM,aAAa/L,CAAb,CAAX;AACAqoC,0BAAoB,KAAK1V,GAAzB,EAA8ByY,aAAa7rC,IAAb,CAA9B,EAAkD,KAAKgtC,SAAL,CAAehtC,IAAf,CAAlD;AACD;AACF,GAPD;;AASAotC,uBAAqB3/B,SAArB,GAAiC,UAAUa,WAAV,EAAuB;AACtD,SAAK8kB,GAAL,CAAShC,KAAT,KAAmB,KAAKgC,GAAL,CAAShC,KAAT,CAAe1jB,MAAf,GAAwBY,eAAe,SAA1D;AACD,GAFD;;AAIA5L,QAAMwqC,eAAN,EAAuB1iC,QAAvB;;AAEA;;;;;;;;;AASA,MAAI6iC,SAAS,CAACvvC,MAAMT,eAApB;AACA,MAAIiwC,eAAe;AACjBtG,YAAQxG;AADS,GAAnB;AAGA,MAAI+M,cAAc,EAAlB,CA7+T4B,CA6+TN;;AAEtB;;;;AAIA,MAAIC,YAAY,OAAhB;AACA;;;;;;;;;;;AAWA,WAASC,MAAT,CAAgBra,GAAhB,EAAqBphB,IAArB,EAA2B;AACzB,QAAI8R,KAAK,IAAI4pB,OAAJ,CAAY7wC,MAAZ,EAAoBu2B,GAApB,EAAyBphB,IAAzB,CAAT;AACAu7B,gBAAYzpB,GAAGE,EAAf,IAAqBF,EAArB;AACA,WAAOA,EAAP;AACD;AACD;;;;;AAKA,WAAS6pB,SAAT,CAAmB7pB,EAAnB,EAAuB;AACrB,QAAIA,EAAJ,EAAQ;AACNA,SAAGvX,OAAH;AACD,KAFD,MAEO;AACL,WAAK,IAAIvL,GAAT,IAAgBusC,WAAhB,EAA6B;AAC3B,YAAIA,YAAYtsC,cAAZ,CAA2BD,GAA3B,CAAJ,EAAqC;AACnCusC,sBAAYvsC,GAAZ,EAAiBuL,OAAjB;AACD;AACF;;AAEDghC,oBAAc,EAAd;AACD;;AAED,WAAO,IAAP;AACD;AACD;;;;;;AAMA,WAASK,WAAT,CAAqB5pB,EAArB,EAAyB;AACvB,WAAOupB,YAAYvpB,EAAZ,CAAP;AACD;AACD,WAAS6pB,eAAT,CAAyB7tC,IAAzB,EAA+BY,IAA/B,EAAqC;AACnC0sC,iBAAattC,IAAb,IAAqBY,IAArB;AACD;;AAED,WAASktC,WAAT,CAAqB9pB,EAArB,EAAyB;AACvB,WAAOupB,YAAYvpB,EAAZ,CAAP;AACD;AACD;;;;AAIA;;;;;;;;;;;;AAaA,MAAI0pB,UAAU,SAAVA,OAAU,CAAU1pB,EAAV,EAAcoP,GAAd,EAAmBphB,IAAnB,EAAyB;AACrCA,WAAOA,QAAQ,EAAf;AACA;;;;AAIA,SAAKohB,GAAL,GAAWA,GAAX;AACA;;;;AAIA,SAAKpP,EAAL,GAAUA,EAAV;AACA,QAAIvmB,OAAO,IAAX;AACA,QAAIiP,UAAU,IAAI0f,OAAJ,EAAd;AACA,QAAI2hB,eAAe/7B,KAAKg8B,QAAxB,CAdqC,CAcH;;AAElC,QAAIX,MAAJ,EAAY;AACV,UAAI,CAACC,aAAaW,GAAlB,EAAuB;AACrB,cAAM,IAAIlpC,KAAJ,CAAU,wDAAV,CAAN;AACD;;AAEDgpC,qBAAe,KAAf;AACD,KAND,MAMO,IAAI,CAACA,YAAD,IAAiB,CAACT,aAAaS,YAAb,CAAtB,EAAkD;AACvDA,qBAAe,QAAf;AACD;;AAED,QAAIphC,UAAU,IAAI2gC,aAAaS,YAAb,CAAJ,CAA+B3a,GAA/B,EAAoC1mB,OAApC,EAA6CsF,IAA7C,EAAmDgS,EAAnD,CAAd;AACA,SAAKtX,OAAL,GAAeA,OAAf;AACA,SAAKC,OAAL,GAAeA,OAAf;AACA,QAAIuhC,cAAc,CAACpwC,MAAMX,IAAP,IAAe,CAACW,MAAMJ,MAAtB,GAA+B,IAAIwvC,eAAJ,CAAoBvgC,QAAQq1B,eAAR,EAApB,CAA/B,GAAgF,IAAlG;AACA,SAAKr3B,OAAL,GAAe,IAAI8B,OAAJ,CAAYC,OAAZ,EAAqBC,OAArB,EAA8BuhC,WAA9B,EAA2CvhC,QAAQygB,IAAnD,CAAf;AACA;;;;AAIA,SAAKzK,SAAL,GAAiB,IAAIwmB,SAAJ,CAAc;AAC7BC,aAAO;AACLtkB,gBAAQ1hB,KAAK,KAAK+qC,KAAV,EAAiB,IAAjB;AADH;AADsB,KAAd,CAAjB;AAKA,SAAKxrB,SAAL,CAAetB,KAAf;AACA;;;;;AAKA,SAAK+sB,aAAL,CA9CqC,CA8CjB;AACpB;;AAEA,QAAIC,oBAAoB3hC,QAAQyb,cAAhC;AACA,QAAImmB,kBAAkB5hC,QAAQub,YAA9B;;AAEAvb,YAAQyb,cAAR,GAAyB,UAAU5Z,EAAV,EAAc;AACrC8/B,wBAAkB9tC,IAAlB,CAAuBmM,OAAvB,EAAgC6B,EAAhC;AACAA,YAAMA,GAAGiX,gBAAH,CAAoB/nB,IAApB,CAAN;AACD,KAHD;;AAKAiP,YAAQub,YAAR,GAAuB,UAAU1Z,EAAV,EAAc;AACnC+/B,sBAAgB/tC,IAAhB,CAAqBmM,OAArB,EAA8B6B,EAA9B;AACAA,SAAG8W,WAAH,CAAe5nB,IAAf;AACD,KAHD;AAID,GA7DD;;AA+DAiwC,UAAQ1uC,SAAR,GAAoB;AAClB6B,iBAAa6sC,OADK;;AAGlB;;;;AAIAa,WAAO,iBAAY;AACjB,aAAO,KAAKvqB,EAAZ;AACD,KATiB;;AAWlB;;;;AAIA9c,SAAK,aAAUqH,EAAV,EAAc;AACjB,WAAK7B,OAAL,CAAawgB,OAAb,CAAqB3e,EAArB;AACA,WAAK6/B,aAAL,GAAqB,IAArB;AACD,KAlBiB;;AAoBlB;;;;AAIA91B,YAAQ,gBAAU/J,EAAV,EAAc;AACpB,WAAK7B,OAAL,CAAaygB,OAAb,CAAqB5e,EAArB;AACA,WAAK6/B,aAAL,GAAqB,IAArB;AACD,KA3BiB;;AA6BlB;;;;;;;;AAQAzI,iBAAa,qBAAU6I,MAAV,EAAkB/a,MAAlB,EAA0B;AACrC,UAAI,KAAK9mB,OAAL,CAAag5B,WAAjB,EAA8B;AAC5B,aAAKh5B,OAAL,CAAag5B,WAAb,CAAyB6I,MAAzB,EAAiC/a,MAAjC;AACD;;AAED,WAAK2a,aAAL,GAAqB,IAArB;AACD,KA3CiB;;AA6ClB;;;;AAIA3I,wBAAoB,4BAAUC,eAAV,EAA2B;AAC7C,UAAI,KAAK/4B,OAAL,CAAa84B,kBAAjB,EAAqC;AACnC,aAAK94B,OAAL,CAAa84B,kBAAb,CAAgCC,eAAhC;AACD;;AAED,WAAK0I,aAAL,GAAqB,IAArB;AACD,KAvDiB;;AAyDlB;;;AAGAK,wBAAoB,8BAAY;AAC9B;AACA;AACA;AACA,WAAKL,aAAL,GAAqB,KAArB;AACA,WAAKzhC,OAAL,CAAauY,OAAb;AACA;;;;AAIA,WAAKkpB,aAAL,GAAqB,KAArB,CAV8B,CAUF;AAC5B;AACA;AACA;AACA;AACD,KA3EiB;;AA6ElB;;;AAGAlpB,aAAS,mBAAY;AACnB,WAAKkpB,aAAL,GAAqB,IAArB;AACD,KAlFiB;;AAoFlB;;;AAGAD,WAAO,iBAAY;AACjB,UAAIO,eAAJ;;AAEA,UAAI,KAAKN,aAAT,EAAwB;AACtBM,0BAAkB,IAAlB;AACA,aAAKD,kBAAL;AACD;;AAED,UAAI,KAAKE,kBAAT,EAA6B;AAC3BD,0BAAkB,IAAlB;AACA,aAAKE,uBAAL;AACD;;AAEDF,yBAAmB,KAAKvjC,OAAL,CAAa,UAAb,CAAnB;AACD,KArGiB;;AAuGlB;;;;;AAKAw3B,cAAU,kBAAUp0B,EAAV,EAAc6iB,KAAd,EAAqB;AAC7B,UAAI,KAAKzkB,OAAL,CAAag2B,QAAjB,EAA2B;AACzB,aAAKh2B,OAAL,CAAag2B,QAAb,CAAsBp0B,EAAtB,EAA0B6iB,KAA1B;AACA,aAAKsR,YAAL;AACD;AACF,KAjHiB;;AAmHlB;;;;AAIAM,iBAAa,qBAAUz0B,EAAV,EAAc;AACzB,UAAI,KAAK5B,OAAL,CAAaq2B,WAAjB,EAA8B;AAC5B,aAAKr2B,OAAL,CAAaq2B,WAAb,CAAyBz0B,EAAzB;AACA,aAAKm0B,YAAL;AACD;AACF,KA5HiB;;AA8HlB;;;;AAIAQ,gBAAY,sBAAY;AACtB,UAAI,KAAKv2B,OAAL,CAAau2B,UAAjB,EAA6B;AAC3B,aAAKv2B,OAAL,CAAau2B,UAAb;AACA,aAAKR,YAAL;AACD;AACF,KAvIiB;;AAyIlB;;;AAGAA,kBAAc,wBAAY;AACxB,WAAKiM,kBAAL,GAA0B,IAA1B;AACD,KA9IiB;;AAgJlB;;;AAGAC,6BAAyB,mCAAY;AACnC,WAAKD,kBAAL,GAA0B,KAA1B;AACA,WAAKhiC,OAAL,CAAa+1B,YAAb,IAA6B,KAAK/1B,OAAL,CAAa+1B,YAAb,EAA7B;AACD,KAtJiB;;AAwJlB;;;;;;;AAOAz0B,YAAQ,gBAAU+D,IAAV,EAAgB;AACtBA,aAAOA,QAAQ,EAAf;AACA,WAAKrF,OAAL,CAAasB,MAAb,CAAoB+D,KAAK8T,KAAzB,EAAgC9T,KAAK+T,MAArC;AACA,WAAKpb,OAAL,CAAasD,MAAb;AACD,KAnKiB;;AAqKlB;;;AAGA4gC,oBAAgB,0BAAY;AAC1B,WAAKlsB,SAAL,CAAepK,KAAf;AACD,KA1KiB;;AA4KlB;;;AAGAua,cAAU,oBAAY;AACpB,aAAO,KAAKnmB,OAAL,CAAammB,QAAb,EAAP;AACD,KAjLiB;;AAmLlB;;;AAGAC,eAAW,qBAAY;AACrB,aAAO,KAAKpmB,OAAL,CAAaomB,SAAb,EAAP;AACD,KAxLiB;;AA0LlB;;;;;;AAMA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;AAOAgU,iBAAa,qBAAU59B,CAAV,EAAayJ,GAAb,EAAkB;AAC7B,aAAO,KAAKjG,OAAL,CAAao6B,WAAb,CAAyB59B,CAAzB,EAA4ByJ,GAA5B,CAAP;AACD,KA/MiB;;AAiNlB;;;;AAIAvE,oBAAgB,wBAAUC,WAAV,EAAuB;AACrC,WAAK3D,OAAL,CAAa0D,cAAb,CAA4BC,WAA5B;AACD,KAvNiB;;AAyNlB;;;;;;AAMAnE,eAAW,mBAAUvD,CAAV,EAAaC,CAAb,EAAgB;AACzB,aAAO,KAAK8D,OAAL,CAAaR,SAAb,CAAuBvD,CAAvB,EAA0BC,CAA1B,CAAP;AACD,KAjOiB;;AAmOlB;;;;;;;AAOAkC,QAAI,YAAUoF,SAAV,EAAqBM,YAArB,EAAmCzL,OAAnC,EAA4C;AAC9C,WAAK2H,OAAL,CAAa5B,EAAb,CAAgBoF,SAAhB,EAA2BM,YAA3B,EAAyCzL,OAAzC;AACD,KA5OiB;;AA8OlB;;;;;AAKAgI,SAAK,aAAUmD,SAAV,EAAqBM,YAArB,EAAmC;AACtC,WAAK9D,OAAL,CAAaK,GAAb,CAAiBmD,SAAjB,EAA4BM,YAA5B;AACD,KArPiB;;AAuPlB;;;;;;AAMAtD,aAAS,iBAAUgD,SAAV,EAAqBrE,KAArB,EAA4B;AACnC,WAAKa,OAAL,CAAaQ,OAAb,CAAqBgD,SAArB,EAAgCrE,KAAhC;AACD,KA/PiB;;AAiQlB;;;AAGAyO,WAAO,iBAAY;AACjB,WAAK7L,OAAL,CAAaygB,OAAb;AACA,WAAKxgB,OAAL,CAAa4L,KAAb;AACD,KAvQiB;;AAyQlB;;;AAGAhM,aAAS,mBAAY;AACnB,WAAKoW,SAAL,CAAeG,IAAf;AACA,WAAKvK,KAAL;AACA,WAAK7L,OAAL,CAAaH,OAAb;AACA,WAAKI,OAAL,CAAaJ,OAAb;AACA,WAAK5B,OAAL,CAAa4B,OAAb;AACA,WAAKoW,SAAL,GAAiB,KAAKjW,OAAL,GAAe,KAAKC,OAAL,GAAe,KAAKhC,OAAL,GAAe,IAA9D;AACAmjC,kBAAY,KAAK9pB,EAAjB;AACD;AApRiB,GAApB;;AAuRA,MAAI8qB,UAAU,CAAC/vC,OAAOsH,MAAP,IAAiBtH,MAAlB,EAA0B;AACvCT,aAASkvC,SAD8B;AAEvCuB,UAAMtB,MAFiC;AAGvClhC,aAASohC,SAH8B;AAIvCC,iBAAaA,WAJ0B;AAKvCC,qBAAiBA;AALsB,GAA1B,CAAd;;AAQA;;;;;;;;;;;;;;;;;;AAkBA,MAAImB,SAASnsC,MAAb;AACA,MAAIosC,aAAa5tC,UAAjB;AACA,MAAI6tC,YAAY1tC,OAAhB;AACA;;;;;;AAMA,MAAI2tC,8BAA8B,UAAlC;AACA;;;;;;AAMA,WAASC,gBAAT,CAA0BltC,KAA1B,EAAiC;AAC/B,WAAOA,iBAAiB/C,KAAjB,GAAyB+C,KAAzB,GAAiCA,SAAS,IAAT,GAAgB,EAAhB,GAAqB,CAACA,KAAD,CAA7D;AACD;AACD;;;;;;;;;;;;;;;;AAgBA,WAASmtC,eAAT,CAAyBC,GAAzB,EAA8BtuC,GAA9B,EAAmCuuC,OAAnC,EAA4C;AAC1C;AACA,QAAID,GAAJ,EAAS;AACPA,UAAItuC,GAAJ,IAAWsuC,IAAItuC,GAAJ,KAAY,EAAvB;AACAsuC,UAAIE,QAAJ,GAAeF,IAAIE,QAAJ,IAAgB,EAA/B;AACAF,UAAIE,QAAJ,CAAaxuC,GAAb,IAAoBsuC,IAAIE,QAAJ,CAAaxuC,GAAb,KAAqB,EAAzC,CAHO,CAGsC;;AAE7C,WAAK,IAAIP,IAAI,CAAR,EAAWC,MAAM6uC,QAAQ5uC,MAA9B,EAAsCF,IAAIC,GAA1C,EAA+CD,GAA/C,EAAoD;AAClD,YAAIgvC,aAAaF,QAAQ9uC,CAAR,CAAjB;;AAEA,YAAI,CAAC6uC,IAAIE,QAAJ,CAAaxuC,GAAb,EAAkBC,cAAlB,CAAiCwuC,UAAjC,CAAD,IAAiDH,IAAItuC,GAAJ,EAASC,cAAT,CAAwBwuC,UAAxB,CAArD,EAA0F;AACxFH,cAAIE,QAAJ,CAAaxuC,GAAb,EAAkByuC,UAAlB,IAAgCH,IAAItuC,GAAJ,EAASyuC,UAAT,CAAhC;AACD;AACF;AACF;AACF;AACD,MAAIC,qBAAqB,CAAC,WAAD,EAAc,YAAd,EAA4B,UAA5B,EAAwC,YAAxC,EAAsD,MAAtD,EAA8D,KAA9D,EAAqE,OAArE,EAA8E,iBAA9E,EAAiG,iBAAjG,EAAoH,OAApH,EAA6H,QAA7H,EAAuI,YAAvI,EAAqJ,OAArJ,EAA8J,eAA9J,EAA+K,UAA/K,EAA2L,aAA3L,EAA0M,YAA1M,EAAwN,eAAxN,EAAyO,eAAzO,EAA0P,iBAA1P,EAA6Q,gBAA7Q,EAA+R,mBAA/R,EAAoT,mBAApT,EAAyU,iBAAzU,EAA4V,aAA5V,EAA2W,aAA3W,EAA0X,cAA1X,EAA0Y,SAA1Y,CAAzB,CA59U4B,CA49UmZ;AAC/a;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;AAQA,WAASC,gBAAT,CAA0BC,QAA1B,EAAoC;AAClC,WAAOX,WAAWW,QAAX,KAAwB,CAACV,UAAUU,QAAV,CAAzB,IAAgD,EAAEA,oBAAoBzL,IAAtB,CAAhD,GAA8EyL,SAAS1tC,KAAvF,GAA+F0tC,QAAtG;AACD;AACD;;;;;;AAMA,WAASC,gBAAT,CAA0BD,QAA1B,EAAoC;AAClC,WAAOX,WAAWW,QAAX,KAAwB,EAAEA,oBAAoBzwC,KAAtB,CAA/B,CADkC,CAC2B;AAC7D;AACD;AACD;;;;;;;;;;AAUA,WAAS2wC,eAAT,CAAyBC,MAAzB,EAAiCC,aAAjC,EAAgD;AAC9C;AACA;AACA;AACA;AACA;AACA;AACAA,oBAAgB,CAACA,iBAAiB,EAAlB,EAAsBvwC,KAAtB,EAAhB;AACA,QAAIY,SAASV,IAAIowC,UAAU,EAAd,EAAkB,UAAUjtC,GAAV,EAAek2B,KAAf,EAAsB;AACnD,aAAO;AACLiX,eAAOntC;AADF,OAAP;AAGD,KAJY,CAAb,CAR8C,CAY1C;;AAEJksC,WAAOgB,aAAP,EAAsB,UAAUE,SAAV,EAAqBlX,KAArB,EAA4B;AAChD,UAAI,CAACiW,WAAWiB,SAAX,CAAL,EAA4B;AAC1B;AACD,OAH+C,CAG9C;;;AAGF,WAAK,IAAIzvC,IAAI,CAAb,EAAgBA,IAAIJ,OAAOM,MAA3B,EAAmCF,GAAnC,EAAwC;AACtC,YAAI,CAACJ,OAAOI,CAAP,EAAU0vC,MAAX,CAAkB;AAAlB,WACDD,UAAUlsB,EAAV,IAAgB,IADf,IACuB3jB,OAAOI,CAAP,EAAUwvC,KAAV,CAAgBjsB,EAAhB,KAAuBksB,UAAUlsB,EAAV,GAAe,EADjE,EACqE;AACnE3jB,iBAAOI,CAAP,EAAU0vC,MAAV,GAAmBD,SAAnB;AACAF,wBAAchX,KAAd,IAAuB,IAAvB;AACA;AACD;AACF;;AAED,WAAK,IAAIv4B,IAAI,CAAb,EAAgBA,IAAIJ,OAAOM,MAA3B,EAAmCF,GAAnC,EAAwC;AACtC,YAAIwvC,QAAQ5vC,OAAOI,CAAP,EAAUwvC,KAAtB;;AAEA,YAAI,CAAC5vC,OAAOI,CAAP,EAAU0vC,MAAX,CAAkB;AACtB;AADI,YAEAF,MAAMjsB,EAAN,IAAY,IAAZ,IAAoBksB,UAAUlsB,EAAV,IAAgB,IAFpC,KAE6CksB,UAAUlwC,IAAV,IAAkB,IAF/D,IAEuE,CAACowC,UAAUF,SAAV,CAFxE,IAEgG,CAACE,UAAUH,KAAV,CAFjG,IAEqHA,MAAMjwC,IAAN,KAAekwC,UAAUlwC,IAAV,GAAiB,EAFzJ,EAE6J;AAC3JK,iBAAOI,CAAP,EAAU0vC,MAAV,GAAmBD,SAAnB;AACAF,wBAAchX,KAAd,IAAuB,IAAvB;AACA;AACD;AACF;AACF,KA1BD,EAd8C,CAwC1C;;AAEJgW,WAAOgB,aAAP,EAAsB,UAAUE,SAAV,EAAqBlX,KAArB,EAA4B;AAChD,UAAI,CAACiW,WAAWiB,SAAX,CAAL,EAA4B;AAC1B;AACD;;AAED,UAAIzvC,IAAI,CAAR;;AAEA,aAAOA,IAAIJ,OAAOM,MAAlB,EAA0BF,GAA1B,EAA+B;AAC7B,YAAIwvC,QAAQ5vC,OAAOI,CAAP,EAAUwvC,KAAtB;;AAEA,YAAI,CAAC5vC,OAAOI,CAAP,EAAU0vC,MAAX,CAAkB;AACtB;AACA;AACA;AAHI,WAID,CAACC,UAAUH,KAAV,CAJA,CAIiB;AACrB;AACA;AACA;AACA;AARI,WASDC,UAAUlsB,EAAV,IAAgB,IATnB,EASyB;AACvB3jB,iBAAOI,CAAP,EAAU0vC,MAAV,GAAmBD,SAAnB;AACA;AACD;AACF;;AAED,UAAIzvC,KAAKJ,OAAOM,MAAhB,EAAwB;AACtBN,eAAO4C,IAAP,CAAY;AACVktC,kBAAQD;AADE,SAAZ;AAGD;AACF,KA9BD;AA+BA,WAAO7vC,MAAP;AACD;AACD;;;;;;;;;;AAUA,WAASgwC,aAAT,CAAuBC,SAAvB,EAAkC;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAIC,QAAQ1qC,eAAZ;AACAmpC,WAAOsB,SAAP,EAAkB,UAAUE,IAAV,EAAgBxX,KAAhB,EAAuB;AACvC,UAAIyX,WAAWD,KAAKP,KAApB;AACAQ,kBAAYF,MAAM7qC,GAAN,CAAU+qC,SAASzsB,EAAnB,EAAuBwsB,IAAvB,CAAZ;AACD,KAHD;AAIAxB,WAAOsB,SAAP,EAAkB,UAAUE,IAAV,EAAgBxX,KAAhB,EAAuB;AACvC,UAAIsW,MAAMkB,KAAKL,MAAf;AACAvrC,eAAS,CAAC0qC,GAAD,IAAQA,IAAItrB,EAAJ,IAAU,IAAlB,IAA0B,CAACusB,MAAM5qC,GAAN,CAAU2pC,IAAItrB,EAAd,CAA3B,IAAgDusB,MAAM5qC,GAAN,CAAU2pC,IAAItrB,EAAd,MAAsBwsB,IAA/E,EAAqF,qBAAqBlB,OAAOA,IAAItrB,EAAhC,CAArF;AACAsrB,aAAOA,IAAItrB,EAAJ,IAAU,IAAjB,IAAyBusB,MAAM7qC,GAAN,CAAU4pC,IAAItrB,EAAd,EAAkBwsB,IAAlB,CAAzB;AACA,OAACA,KAAKE,OAAN,KAAkBF,KAAKE,OAAL,GAAe,EAAjC;AACD,KALD,EAfgC,CAoB5B;;AAEJ1B,WAAOsB,SAAP,EAAkB,UAAUE,IAAV,EAAgBxX,KAAhB,EAAuB;AACvC,UAAIyX,WAAWD,KAAKP,KAApB;AACA,UAAIX,MAAMkB,KAAKL,MAAf;AACA,UAAIO,UAAUF,KAAKE,OAAnB;;AAEA,UAAI,CAACzB,WAAWK,GAAX,CAAL,EAAsB;AACpB;AACD,OAPsC,CAOrC;AACF;AACA;AACA;;;AAGAoB,cAAQ1wC,IAAR,GAAesvC,IAAItvC,IAAJ,IAAY,IAAZ,GAAmBsvC,IAAItvC,IAAJ,GAAW,EAA9B,GAAmCywC,WAAWA,SAASzwC,IAApB,CAAyB;AAC3E;AADkD,QAEhDmvC,8BAA8BnW,KAFhC;;AAIA,UAAIyX,QAAJ,EAAc;AACZC,gBAAQ1sB,EAAR,GAAaysB,SAASzsB,EAAtB;AACD,OAFD,MAEO,IAAIsrB,IAAItrB,EAAJ,IAAU,IAAd,EAAoB;AACzB0sB,gBAAQ1sB,EAAR,GAAasrB,IAAItrB,EAAJ,GAAS,EAAtB;AACD,OAFM,MAEA;AACL;AACA;AACA;AACA;AACA;AACA,YAAI2sB,QAAQ,CAAZ;;AAEA,WAAG;AACDD,kBAAQ1sB,EAAR,GAAa,OAAO0sB,QAAQ1wC,IAAf,GAAsB,IAAtB,GAA6B2wC,OAA1C;AACD,SAFD,QAESJ,MAAM5qC,GAAN,CAAU+qC,QAAQ1sB,EAAlB,CAFT;AAGD;;AAEDusB,YAAM7qC,GAAN,CAAUgrC,QAAQ1sB,EAAlB,EAAsBwsB,IAAtB;AACD,KAnCD;AAoCD;AACD,WAASI,eAAT,CAAyBC,cAAzB,EAAyC;AACvC,QAAI7wC,OAAO6wC,eAAe7wC,IAA1B,CADuC,CACP;;AAEhC,WAAO,CAAC,EAAEA,QAAQA,KAAKgC,OAAL,CAAamtC,2BAAb,CAAV,CAAR;AACD;AACD;;;;;;AAMA,WAASiB,SAAT,CAAmBF,SAAnB,EAA8B;AAC5B,WAAOjB,WAAWiB,SAAX,KAAyBA,UAAUlsB,EAAnC,IAAyC,CAACksB,UAAUlsB,EAAV,GAAe,EAAhB,EAAoBhiB,OAApB,CAA4B,UAA5B,MAA4C,CAA5F;AACD;AACD;;;;;;;;;AAUA;;;;;;;AAOA,WAAS8uC,cAAT,CAAwBluC,IAAxB,EAA8BmuC,OAA9B,EAAuC;AACrC,QAAIA,QAAQC,eAAR,IAA2B,IAA/B,EAAqC;AACnC,aAAOD,QAAQC,eAAf;AACD,KAFD,MAEO,IAAID,QAAQE,SAAR,IAAqB,IAAzB,EAA+B;AACpC,aAAOzvC,QAAQuvC,QAAQE,SAAhB,IAA6BtxC,IAAIoxC,QAAQE,SAAZ,EAAuB,UAAU/uC,KAAV,EAAiB;AAC1E,eAAOU,KAAKsuC,eAAL,CAAqBhvC,KAArB,CAAP;AACD,OAFmC,CAA7B,GAEFU,KAAKsuC,eAAL,CAAqBH,QAAQE,SAA7B,CAFL;AAGD,KAJM,MAIA,IAAIF,QAAQ/wC,IAAR,IAAgB,IAApB,EAA0B;AAC/B,aAAOwB,QAAQuvC,QAAQ/wC,IAAhB,IAAwBL,IAAIoxC,QAAQ/wC,IAAZ,EAAkB,UAAUkC,KAAV,EAAiB;AAChE,eAAOU,KAAKuuC,WAAL,CAAiBjvC,KAAjB,CAAP;AACD,OAF8B,CAAxB,GAEFU,KAAKuuC,WAAL,CAAiBJ,QAAQ/wC,IAAzB,CAFL;AAGD;AACF;AACD;;;;;;;;;;;;;;;;;;;;;AAqBA,WAASoxC,SAAT,GAAqB;AACnB;AACA,QAAIpwC,MAAM,kBAAkBqwC,kBAAlB,GAAuC,GAAvC,GAA6C9pC,KAAKg7B,MAAL,GAAc+O,OAAd,CAAsB,CAAtB,CAAvD;AACA,WAAO,UAAUC,OAAV,EAAmB;AACxB,aAAOA,QAAQvwC,GAAR,MAAiBuwC,QAAQvwC,GAAR,IAAe,EAAhC,CAAP;AACD,KAFD;AAGD;AACD,MAAIqwC,mBAAmB,CAAvB;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoCA,WAASG,WAAT,CAAqBC,OAArB,EAA8BC,MAA9B,EAAsCpC,GAAtC,EAA2C;AACzC,QAAI1rC,SAAS8tC,MAAT,CAAJ,EAAsB;AACpB,UAAI5uC,MAAM,EAAV;AACAA,UAAI4uC,SAAS,OAAb,IAAwB,CAAxB;AACAA,eAAS5uC,GAAT;AACD;;AAED,QAAI6uC,kBAAkBrC,OAAOA,IAAIqC,eAAjC;;AAEA,QAAIA,mBAAmB,CAACC,IAAIF,MAAJ,EAAYC,kBAAkB,OAA9B,CAApB,IAA8D,CAACC,IAAIF,MAAJ,EAAYC,kBAAkB,IAA9B,CAA/D,IAAsG,CAACC,IAAIF,MAAJ,EAAYC,kBAAkB,MAA9B,CAA3G,EAAkJ;AAChJD,aAAOC,kBAAkB,OAAzB,IAAoC,CAApC;AACD;;AAED,QAAItxC,SAAS,EAAb;AACA2uC,WAAO0C,MAAP,EAAe,UAAUxvC,KAAV,EAAiBlB,GAAjB,EAAsB;AACnC,UAAIkB,QAAQwvC,OAAO1wC,GAAP,CAAZ,CADmC,CACV;;AAEzB,UAAIA,QAAQ,WAAR,IAAuBA,QAAQ,iBAAnC,EAAsD;AACpDX,eAAOW,GAAP,IAAckB,KAAd;AACA;AACD;;AAED,UAAI2vC,YAAY7wC,IAAI/C,KAAJ,CAAU,wBAAV,KAAuC,EAAvD;AACA,UAAI6zC,WAAWD,UAAU,CAAV,CAAf;AACA,UAAIE,YAAY,CAACF,UAAU,CAAV,KAAgB,EAAjB,EAAqBn3B,WAArB,EAAhB;;AAEA,UAAI,CAACo3B,QAAD,IAAa,CAACC,SAAd,IAA2B7vC,SAAS,IAApC,IAA4C6vC,cAAc,OAAd,IAAyB7vC,UAAU,MAA/E,IAAyFotC,OAAOA,IAAI0C,gBAAX,IAA+BhwC,QAAQstC,IAAI0C,gBAAZ,EAA8BF,QAA9B,IAA0C,CAAtK,EAAyK;AACvK;AACD;;AAED,UAAIG,aAAa;AACfH,kBAAUA;AADK,OAAjB;;AAIA,UAAIC,cAAc,OAAd,IAAyB7vC,UAAU,KAAvC,EAA8C;AAC5C+vC,mBAAWF,SAAX,IAAwB7vC,KAAxB;AACD;;AAED,UAAIgwC,SAAST,QAAQU,eAAR,CAAwBF,UAAxB,CAAb;AACA5xC,aAAOyxC,WAAW,QAAlB,IAA8BI,MAA9B;AACA7xC,aAAOyxC,WAAW,OAAlB,IAA6BI,OAAO,CAAP,CAA7B;AACD,KA3BD;AA4BA,WAAO7xC,MAAP;AACD;;AAED,WAASuxC,GAAT,CAAa9uC,GAAb,EAAkBN,IAAlB,EAAwB;AACtB,WAAOM,OAAOA,IAAI7B,cAAJ,CAAmBuB,IAAnB,CAAd;AACD;;AAED,WAAS0wB,YAAT,CAAsBE,GAAtB,EAA2BpyB,GAA3B,EAAgCkB,KAAhC,EAAuC;AACrCkxB,QAAIF,YAAJ,GAAmBE,IAAIF,YAAJ,CAAiBlyB,GAAjB,EAAsBkB,KAAtB,CAAnB,GAAkDkxB,IAAIpyB,GAAJ,IAAWkB,KAA7D;AACD;AACD,WAASkwC,YAAT,CAAsBhf,GAAtB,EAA2BpyB,GAA3B,EAAgC;AAC9B,WAAOoyB,IAAIgf,YAAJ,GAAmBhf,IAAIgf,YAAJ,CAAiBpxC,GAAjB,CAAnB,GAA2CoyB,IAAIpyB,GAAJ,CAAlD;AACD;;AAED;;;;;;;;;;;;;;;;;;AAkBA,MAAIqxC,iBAAiB,GAArB;AACA,MAAIC,eAAe,gCAAnB;AACA;;;;;AAKA,WAASC,gBAAT,CAA0BC,aAA1B,EAAyC;AACvC,QAAIlzB,MAAM;AACRmzB,YAAM,EADE;AAERnrC,WAAK;AAFG,KAAV;;AAKA,QAAIkrC,aAAJ,EAAmB;AACjBA,sBAAgBA,cAAcv3B,KAAd,CAAoBo3B,cAApB,CAAhB;AACA/yB,UAAImzB,IAAJ,GAAWD,cAAc,CAAd,KAAoB,EAA/B;AACAlzB,UAAIhY,GAAJ,GAAUkrC,cAAc,CAAd,KAAoB,EAA9B;AACD;;AAED,WAAOlzB,GAAP;AACD;AACD;;;;AAIA,WAASozB,cAAT,CAAwBF,aAAxB,EAAuC;AACrC5tC,aAAS,qCAAqCvG,IAArC,CAA0Cm0C,aAA1C,CAAT,EAAmE,oBAAoBA,aAApB,GAAoC,WAAvG;AACD;AACD;;;;AAKA,WAASG,iBAAT,CAA2BC,SAA3B,EAAsCC,gBAAtC,EAAwD;AACtDD,cAAUE,YAAV,GAAyBF,SAAzB;;AAEAA,cAAUhxC,MAAV,GAAmB,UAAUmxC,KAAV,EAAiB;AAClC,UAAItwC,aAAa,IAAjB;;AAEA,UAAIuwC,gBAAgB,SAAhBA,aAAgB,GAAY;AAC9B,YAAI,CAACD,MAAMD,YAAX,EAAyB;AACvBrwC,qBAAWe,KAAX,CAAiB,IAAjB,EAAuBD,SAAvB;AACD,SAFD,MAEO;AACLwvC,gBAAMD,YAAN,CAAmBtvC,KAAnB,CAAyB,IAAzB,EAA+BD,SAA/B;AACD;AACF,OAND;;AAQA3B,aAAOoxC,cAAch0C,SAArB,EAAgC+zC,KAAhC;AACAC,oBAAcpxC,MAAd,GAAuB,KAAKA,MAA5B;AACAoxC,oBAAcC,SAAd,GAA0BA,SAA1B;AACAD,oBAAcE,UAAd,GAA2BA,UAA3B;AACA/wC,eAAS6wC,aAAT,EAAwB,IAAxB;AACAA,oBAAcvwC,UAAd,GAA2BA,UAA3B;AACA,aAAOuwC,aAAP;AACD,KAlBD;AAmBD;AACD,MAAIG,YAAY,CAAhB;AACA;;;;;;AAMA,WAASC,gBAAT,CAA0BC,GAA1B,EAA+B;AAC7B,QAAIC,YAAY,CAAC,YAAD,EAAeH,WAAf,EAA4B5rC,KAAKg7B,MAAL,GAAc+O,OAAd,CAAsB,CAAtB,CAA5B,EAAsD9xB,IAAtD,CAA2D,GAA3D,CAAhB;AACA6zB,QAAIr0C,SAAJ,CAAcs0C,SAAd,IAA2B,IAA3B;;AAEAD,QAAIE,UAAJ,GAAiB,UAAUzwC,GAAV,EAAe;AAC9B,aAAO,CAAC,EAAEA,OAAOA,IAAIwwC,SAAJ,CAAT,CAAR;AACD,KAFD;AAGD,GA/4V2B,CA+4V1B;AACF;AACA;AACA;AACA;AACA;;AAEA,WAASL,SAAT,CAAmBjwC,OAAnB,EAA4BwwC,UAA5B,EAAwC;AACtC,QAAIlwC,OAAO7D,MAAM8D,SAAN,EAAiB,CAAjB,CAAX;AACA,WAAO,KAAKd,UAAL,CAAgBzD,SAAhB,CAA0Bw0C,UAA1B,EAAsChwC,KAAtC,CAA4CR,OAA5C,EAAqDM,IAArD,CAAP;AACD;;AAED,WAAS4vC,UAAT,CAAoBlwC,OAApB,EAA6BwwC,UAA7B,EAAyClwC,IAAzC,EAA+C;AAC7C,WAAO,KAAKb,UAAL,CAAgBzD,SAAhB,CAA0Bw0C,UAA1B,EAAsChwC,KAAtC,CAA4CR,OAA5C,EAAqDM,IAArD,CAAP;AACD;AACD;;;;;;;AAQA,WAASmwC,qBAAT,CAA+BC,MAA/B,EAAuC79B,OAAvC,EAAgD;AAC9CA,cAAUA,WAAW,EAArB;AACA;;;;;;;;;AASA,QAAInJ,UAAU,EAAd;;AAEAgnC,WAAOC,aAAP,GAAuB,UAAUC,KAAV,EAAiBpB,aAAjB,EAAgC;AACrD,UAAIA,aAAJ,EAAmB;AACjBE,uBAAeF,aAAf;AACAA,wBAAgBD,iBAAiBC,aAAjB,CAAhB;;AAEA,YAAI,CAACA,cAAclrC,GAAnB,EAAwB;AACtBoF,kBAAQ8lC,cAAcC,IAAtB,IAA8BmB,KAA9B;AACD,SAFD,MAEO,IAAIpB,cAAclrC,GAAd,KAAsBgrC,YAA1B,EAAwC;AAC7C,cAAIuB,YAAYC,cAActB,aAAd,CAAhB;AACAqB,oBAAUrB,cAAclrC,GAAxB,IAA+BssC,KAA/B;AACD;AACF;;AAED,aAAOA,KAAP;AACD,KAdD;;AAgBAF,WAAOK,QAAP,GAAkB,UAAUC,iBAAV,EAA6BC,OAA7B,EAAsCC,iBAAtC,EAAyD;AACzE,UAAIN,QAAQlnC,QAAQsnC,iBAAR,CAAZ;;AAEA,UAAIJ,SAASA,MAAMtB,YAAN,CAAb,EAAkC;AAChCsB,gBAAQK,UAAUL,MAAMK,OAAN,CAAV,GAA2B,IAAnC;AACD;;AAED,UAAIC,qBAAqB,CAACN,KAA1B,EAAiC;AAC/B,cAAM,IAAI7uC,KAAJ,CAAU,CAACkvC,OAAD,GAAWD,oBAAoB,GAApB,GAA0B,2BAArC,GAAmE,eAAeA,iBAAf,GAAmC,GAAnC,IAA0CC,WAAW,EAArD,IAA2D,6BAAxI,CAAN;AACD;;AAED,aAAOL,KAAP;AACD,KAZD;;AAcAF,WAAOS,oBAAP,GAA8B,UAAU3B,aAAV,EAAyB;AACrDA,sBAAgBD,iBAAiBC,aAAjB,CAAhB;AACA,UAAInyC,SAAS,EAAb;AACA,UAAIyC,MAAM4J,QAAQ8lC,cAAcC,IAAtB,CAAV;;AAEA,UAAI3vC,OAAOA,IAAIwvC,YAAJ,CAAX,EAA8B;AAC5BzvC,eAAOC,GAAP,EAAY,UAAUsxC,CAAV,EAAavwC,IAAb,EAAmB;AAC7BA,mBAASyuC,YAAT,IAAyBjyC,OAAO4C,IAAP,CAAYmxC,CAAZ,CAAzB;AACD,SAFD;AAGD,OAJD,MAIO;AACL/zC,eAAO4C,IAAP,CAAYH,GAAZ;AACD;;AAED,aAAOzC,MAAP;AACD,KAdD;;AAgBAqzC,WAAOW,QAAP,GAAkB,UAAU7B,aAAV,EAAyB;AACzC;AACAA,sBAAgBD,iBAAiBC,aAAjB,CAAhB;AACA,aAAO,CAAC,CAAC9lC,QAAQ8lC,cAAcC,IAAtB,CAAT;AACD,KAJD;AAKA;;;;AAKAiB,WAAOY,oBAAP,GAA8B,YAAY;AACxC,UAAIC,QAAQ,EAAZ;AACA1xC,aAAO6J,OAAP,EAAgB,UAAU5J,GAAV,EAAee,IAAf,EAAqB;AACnC0wC,cAAMtxC,IAAN,CAAWY,IAAX;AACD,OAFD;AAGA,aAAO0wC,KAAP;AACD,KAND;AAOA;;;;;;AAOAb,WAAOc,WAAP,GAAqB,UAAUhC,aAAV,EAAyB;AAC5CA,sBAAgBD,iBAAiBC,aAAjB,CAAhB;AACA,UAAI1vC,MAAM4J,QAAQ8lC,cAAcC,IAAtB,CAAV;AACA,aAAO3vC,OAAOA,IAAIwvC,YAAJ,CAAd;AACD,KAJD;;AAMAoB,WAAOe,cAAP,GAAwBlC,gBAAxB;;AAEA,aAASuB,aAAT,CAAuBtB,aAAvB,EAAsC;AACpC,UAAIqB,YAAYnnC,QAAQ8lC,cAAcC,IAAtB,CAAhB;;AAEA,UAAI,CAACoB,SAAD,IAAc,CAACA,UAAUvB,YAAV,CAAnB,EAA4C;AAC1CuB,oBAAYnnC,QAAQ8lC,cAAcC,IAAtB,IAA8B,EAA1C;AACAoB,kBAAUvB,YAAV,IAA0B,IAA1B;AACD;;AAED,aAAOuB,SAAP;AACD;;AAED,QAAIh+B,QAAQ6+B,kBAAZ,EAAgC;AAC9B,UAAIC,iBAAiBjB,OAAO9xC,MAA5B;;AAEA,UAAI+yC,cAAJ,EAAoB;AAClBjB,eAAO9xC,MAAP,GAAgB,UAAUmxC,KAAV,EAAiB;AAC/B,cAAIC,gBAAgB2B,eAAep0C,IAAf,CAAoB,IAApB,EAA0BwyC,KAA1B,CAApB;AACA,iBAAOW,OAAOC,aAAP,CAAqBX,aAArB,EAAoCD,MAAMlvC,IAA1C,CAAP;AACD,SAHD;AAID;AACF;;AAED,WAAO6vC,MAAP;AACD;AACD;;;;AAIA;;;;;;;;;;;;;;;;;;AAkBA;AACA;AACA,MAAIkB,kBAAkB,SAAlBA,eAAkB,CAAUC,UAAV,EAAsB;AAC1C;AACA,SAAK,IAAIp0C,IAAI,CAAb,EAAgBA,IAAIo0C,WAAWl0C,MAA/B,EAAuCF,GAAvC,EAA4C;AAC1C,UAAI,CAACo0C,WAAWp0C,CAAX,EAAc,CAAd,CAAL,EAAuB;AACrBo0C,mBAAWp0C,CAAX,EAAc,CAAd,IAAmBo0C,WAAWp0C,CAAX,EAAc,CAAd,CAAnB;AACD;AACF;;AAED,WAAO,UAAUq0C,KAAV,EAAiBC,QAAjB,EAA2BC,QAA3B,EAAqC;AAC1C,UAAI5jB,QAAQ,EAAZ;;AAEA,WAAK,IAAI3wB,IAAI,CAAb,EAAgBA,IAAIo0C,WAAWl0C,MAA/B,EAAuCF,GAAvC,EAA4C;AAC1C,YAAIsf,WAAW80B,WAAWp0C,CAAX,EAAc,CAAd,CAAf;;AAEA,YAAIs0C,YAAY/yC,QAAQ+yC,QAAR,EAAkBh1B,QAAlB,KAA+B,CAA3C,IAAgDi1B,YAAYhzC,QAAQgzC,QAAR,EAAkBj1B,QAAlB,IAA8B,CAA9F,EAAiG;AAC/F;AACD;;AAED,YAAIpb,MAAMmwC,MAAMG,UAAN,CAAiBl1B,QAAjB,CAAV;;AAEA,YAAIpb,OAAO,IAAX,EAAiB;AACfysB,gBAAMyjB,WAAWp0C,CAAX,EAAc,CAAd,CAAN,IAA0BkE,GAA1B;AACD;AACF;;AAED,aAAOysB,KAAP;AACD,KAlBD;AAmBD,GA3BD;;AA6BA;;;;;;;;;;;;;;;;;;AAkBA,MAAI8jB,gBAAeN,gBAAgB,CAAC,CAAC,WAAD,EAAc,OAAd,CAAD,EAAyB,CAAC,QAAD,EAAW,OAAX,CAAzB,EAA8C,CAAC,SAAD,CAA9C,EAA2D,CAAC,YAAD,CAA3D,EAA2E,CAAC,eAAD,CAA3E,EAA8F,CAAC,eAAD,CAA9F,EAAiH,CAAC,aAAD,CAAjH,CAAhB,CAAnB;AACA,MAAIO,iBAAiB;AACnBD,kBAAc,sBAAUH,QAAV,EAAoB;AAChC,UAAI3jB,QAAQ8jB,cAAa,IAAb,EAAmBH,QAAnB,CAAZ;AACA,UAAI1mB,WAAW,KAAK+mB,WAAL,CAAiBhkB,MAAM1C,SAAvB,CAAf;AACAL,mBAAa+C,MAAM/C,QAAN,GAAiBA,QAA9B;AACA,aAAO+C,KAAP;AACD,KANkB;AAOnBgkB,iBAAa,qBAAU1mB,SAAV,EAAqB;AAChC,UAAIA,aAAa,IAAjB,EAAuB;AACrBA,oBAAY,CAAZ;AACD;;AAED,UAAI2mB,WAAW,KAAK1vC,GAAL,CAAS,MAAT,CAAf;AACA,UAAI2vC,UAAU/tC,KAAKqB,GAAL,CAAS8lB,SAAT,EAAoB,CAApB,CAAd;AACA,UAAI6mB,WAAW7mB,YAAY,CAA3B;AACA,aAAO2mB,aAAa,OAAb,IAAwBA,YAAY,IAApC,GAA2C,IAA3C,GAAkDA,aAAa,QAAb,GAAwB,CAACE,QAAD,EAAWA,QAAX,CAAxB,GAA+C,CAACD,OAAD,EAAUA,OAAV,CAAxG;AACD;AAhBkB,GAArB;;AAmBA;;;;;;;;;;;;;;;;;;AAkBA,MAAIE,gBAAeZ,gBAAgB,CAAC,CAAC,MAAD,EAAS,OAAT,CAAD,EAAoB,CAAC,YAAD,CAApB,EAAoC,CAAC,eAAD,CAApC,EAAuD,CAAC,eAAD,CAAvD,EAA0E,CAAC,SAAD,CAA1E,EAAuF,CAAC,aAAD,CAAvF,CAAhB,CAAnB;AACA,MAAIa,iBAAiB;AACnBD,kBAAc,sBAAUT,QAAV,EAAoBC,QAApB,EAA8B;AAC1C,aAAOQ,cAAa,IAAb,EAAmBT,QAAnB,EAA6BC,QAA7B,CAAP;AACD;AAHkB,GAArB;;AAMA;;;;;AAKA,MAAIU,UAAUnuC,KAAKoN,GAAnB;AACA,MAAIghC,aAAapuC,KAAKC,IAAtB;AACA,MAAIouC,YAAY,IAAhB;AACA,MAAIC,kBAAkB,IAAtB;AACA,MAAIC,aAAaH,WAAW,CAAX,CAAjB;AACA,MAAII,YAAY,IAAI,CAApB,CAvpW4B,CAupWL;;AAEvB,MAAIC,MAAMrvC,QAAV;;AAEA,MAAIsvC,MAAMtvC,QAAV;;AAEA,MAAIuvC,MAAMvvC,QAAV;;AAEA,WAASwvC,YAAT,CAAsBxxC,GAAtB,EAA2B;AACzB,WAAOA,MAAM,CAACixC,SAAP,IAAoBjxC,MAAMixC,SAAjC;AACD;;AAED,WAASQ,iBAAT,CAA2BzxC,GAA3B,EAAgC;AAC9B,WAAOA,MAAMixC,SAAN,IAAmBjxC,MAAM,CAACixC,SAAjC;AACD;AACD;;;;;;;;;;;AAYA,WAASS,OAAT,CAAiBt4B,EAAjB,EAAqBC,EAArB,EAAyBe,EAAzB,EAA6BC,EAA7B,EAAiCxW,CAAjC,EAAoC;AAClC,QAAI8tC,OAAO,IAAI9tC,CAAf;AACA,WAAO8tC,OAAOA,IAAP,IAAeA,OAAOv4B,EAAP,GAAY,IAAIvV,CAAJ,GAAQwV,EAAnC,IAAyCxV,IAAIA,CAAJ,IAASA,IAAIwW,EAAJ,GAAS,IAAIs3B,IAAJ,GAAWv3B,EAA7B,CAAhD;AACD;AACD;;;;;;;;;;;AAWA,WAASw3B,iBAAT,CAA2Bx4B,EAA3B,EAA+BC,EAA/B,EAAmCe,EAAnC,EAAuCC,EAAvC,EAA2CxW,CAA3C,EAA8C;AAC5C,QAAI8tC,OAAO,IAAI9tC,CAAf;AACA,WAAO,KAAK,CAAC,CAACwV,KAAKD,EAAN,IAAYu4B,IAAZ,GAAmB,KAAKv3B,KAAKf,EAAV,IAAgBxV,CAApC,IAAyC8tC,IAAzC,GAAgD,CAACt3B,KAAKD,EAAN,IAAYvW,CAAZ,GAAgBA,CAArE,CAAP;AACD;AACD;;;;;;;;;;;;AAYA,WAASguC,WAAT,CAAqBz4B,EAArB,EAAyBC,EAAzB,EAA6Be,EAA7B,EAAiCC,EAAjC,EAAqCra,GAArC,EAA0C+nB,KAA1C,EAAiD;AAC/C;AACA,QAAI3mB,IAAIiZ,KAAK,KAAKhB,KAAKe,EAAV,CAAL,GAAqBhB,EAA7B;AACA,QAAI/X,IAAI,KAAK+Y,KAAKf,KAAK,CAAV,GAAcD,EAAnB,CAAR;AACA,QAAI04B,IAAI,KAAKz4B,KAAKD,EAAV,CAAR;AACA,QAAI9V,IAAI8V,KAAKpZ,GAAb;AACA,QAAI+xC,IAAI1wC,IAAIA,CAAJ,GAAQ,IAAID,CAAJ,GAAQ0wC,CAAxB;AACA,QAAI/6B,IAAI1V,IAAIywC,CAAJ,GAAQ,IAAI1wC,CAAJ,GAAQkC,CAAxB;AACA,QAAI0uC,IAAIF,IAAIA,CAAJ,GAAQ,IAAIzwC,CAAJ,GAAQiC,CAAxB;AACA,QAAI+gB,IAAI,CAAR;;AAEA,QAAImtB,aAAaO,CAAb,KAAmBP,aAAaz6B,CAAb,CAAvB,EAAwC;AACtC,UAAIy6B,aAAanwC,CAAb,CAAJ,EAAqB;AACnB0mB,cAAM,CAAN,IAAW,CAAX;AACD,OAFD,MAEO;AACL,YAAIkqB,KAAK,CAACH,CAAD,GAAKzwC,CAAd,CADK,CACY;;AAEjB,YAAI4wC,MAAM,CAAN,IAAWA,MAAM,CAArB,EAAwB;AACtBlqB,gBAAM1D,GAAN,IAAa4tB,EAAb;AACD;AACF;AACF,KAVD,MAUO;AACL,UAAIC,OAAOn7B,IAAIA,CAAJ,GAAQ,IAAIg7B,CAAJ,GAAQC,CAA3B;;AAEA,UAAIR,aAAaU,IAAb,CAAJ,EAAwB;AACtB,YAAIC,IAAIp7B,IAAIg7B,CAAZ;AACA,YAAIE,KAAK,CAAC5wC,CAAD,GAAKD,CAAL,GAAS+wC,CAAlB,CAFsB,CAED;;AAErB,YAAI73B,KAAK,CAAC63B,CAAD,GAAK,CAAd,CAJsB,CAIL;;AAEjB,YAAIF,MAAM,CAAN,IAAWA,MAAM,CAArB,EAAwB;AACtBlqB,gBAAM1D,GAAN,IAAa4tB,EAAb;AACD;;AAED,YAAI33B,MAAM,CAAN,IAAWA,MAAM,CAArB,EAAwB;AACtByN,gBAAM1D,GAAN,IAAa/J,EAAb;AACD;AACF,OAbD,MAaO,IAAI43B,OAAO,CAAX,EAAc;AACnB,YAAIE,WAAWpB,WAAWkB,IAAX,CAAf;AACA,YAAIG,KAAKN,IAAI1wC,CAAJ,GAAQ,MAAMD,CAAN,IAAW,CAAC2V,CAAD,GAAKq7B,QAAhB,CAAjB;AACA,YAAIE,KAAKP,IAAI1wC,CAAJ,GAAQ,MAAMD,CAAN,IAAW,CAAC2V,CAAD,GAAKq7B,QAAhB,CAAjB;;AAEA,YAAIC,KAAK,CAAT,EAAY;AACVA,eAAK,CAACtB,QAAQ,CAACsB,EAAT,EAAajB,SAAb,CAAN;AACD,SAFD,MAEO;AACLiB,eAAKtB,QAAQsB,EAAR,EAAYjB,SAAZ,CAAL;AACD;;AAED,YAAIkB,KAAK,CAAT,EAAY;AACVA,eAAK,CAACvB,QAAQ,CAACuB,EAAT,EAAalB,SAAb,CAAN;AACD,SAFD,MAEO;AACLkB,eAAKvB,QAAQuB,EAAR,EAAYlB,SAAZ,CAAL;AACD;;AAED,YAAIa,KAAK,CAAC,CAAC5wC,CAAD,IAAMgxC,KAAKC,EAAX,CAAD,KAAoB,IAAIlxC,CAAxB,CAAT;;AAEA,YAAI6wC,MAAM,CAAN,IAAWA,MAAM,CAArB,EAAwB;AACtBlqB,gBAAM1D,GAAN,IAAa4tB,EAAb;AACD;AACF,OAtBM,MAsBA;AACL,YAAIM,IAAI,CAAC,IAAIR,CAAJ,GAAQ1wC,CAAR,GAAY,IAAID,CAAJ,GAAQ2V,CAArB,KAA2B,IAAIi6B,WAAWe,IAAIA,CAAJ,GAAQA,CAAnB,CAA/B,CAAR;AACA,YAAIS,QAAQ5vC,KAAK6vC,IAAL,CAAUF,CAAV,IAAe,CAA3B;AACA,YAAIG,QAAQ1B,WAAWe,CAAX,CAAZ;AACA,YAAI1sB,MAAMziB,KAAK6J,GAAL,CAAS+lC,KAAT,CAAV;AACA,YAAIP,KAAK,CAAC,CAAC5wC,CAAD,GAAK,IAAIqxC,KAAJ,GAAYrtB,GAAlB,KAA0B,IAAIjkB,CAA9B,CAAT;AACA,YAAIkZ,KAAK,CAAC,CAACjZ,CAAD,GAAKqxC,SAASrtB,MAAM8rB,aAAavuC,KAAK2J,GAAL,CAASimC,KAAT,CAA5B,CAAN,KAAuD,IAAIpxC,CAA3D,CAAT;AACA,YAAImZ,KAAK,CAAC,CAAClZ,CAAD,GAAKqxC,SAASrtB,MAAM8rB,aAAavuC,KAAK2J,GAAL,CAASimC,KAAT,CAA5B,CAAN,KAAuD,IAAIpxC,CAA3D,CAAT;;AAEA,YAAI6wC,MAAM,CAAN,IAAWA,MAAM,CAArB,EAAwB;AACtBlqB,gBAAM1D,GAAN,IAAa4tB,EAAb;AACD;;AAED,YAAI33B,MAAM,CAAN,IAAWA,MAAM,CAArB,EAAwB;AACtByN,gBAAM1D,GAAN,IAAa/J,EAAb;AACD;;AAED,YAAIC,MAAM,CAAN,IAAWA,MAAM,CAArB,EAAwB;AACtBwN,gBAAM1D,GAAN,IAAa9J,EAAb;AACD;AACF;AACF;;AAED,WAAO8J,CAAP;AACD;AACD;;;;;;;;;;;AAWA,WAASsuB,YAAT,CAAsBv5B,EAAtB,EAA0BC,EAA1B,EAA8Be,EAA9B,EAAkCC,EAAlC,EAAsCu4B,OAAtC,EAA+C;AAC7C,QAAIvxC,IAAI,IAAI+Y,EAAJ,GAAS,KAAKf,EAAd,GAAmB,IAAID,EAA/B;AACA,QAAIhY,IAAI,IAAIiY,EAAJ,GAAS,IAAIgB,EAAb,GAAkB,IAAIjB,EAAtB,GAA2B,IAAIgB,EAAvC;AACA,QAAI03B,IAAI,IAAIz4B,EAAJ,GAAS,IAAID,EAArB;AACA,QAAIiL,IAAI,CAAR;;AAEA,QAAImtB,aAAapwC,CAAb,CAAJ,EAAqB;AACnB,UAAIqwC,kBAAkBpwC,CAAlB,CAAJ,EAA0B;AACxB,YAAI4wC,KAAK,CAACH,CAAD,GAAKzwC,CAAd;;AAEA,YAAI4wC,MAAM,CAAN,IAAWA,MAAM,CAArB,EAAwB;AACtBW,kBAAQvuB,GAAR,IAAe4tB,EAAf;AACD;AACF;AACF,KARD,MAQO;AACL,UAAIC,OAAO7wC,IAAIA,CAAJ,GAAQ,IAAID,CAAJ,GAAQ0wC,CAA3B;;AAEA,UAAIN,aAAaU,IAAb,CAAJ,EAAwB;AACtBU,gBAAQ,CAAR,IAAa,CAACvxC,CAAD,IAAM,IAAID,CAAV,CAAb;AACD,OAFD,MAEO,IAAI8wC,OAAO,CAAX,EAAc;AACnB,YAAIE,WAAWpB,WAAWkB,IAAX,CAAf;AACA,YAAID,KAAK,CAAC,CAAC5wC,CAAD,GAAK+wC,QAAN,KAAmB,IAAIhxC,CAAvB,CAAT;AACA,YAAIkZ,KAAK,CAAC,CAACjZ,CAAD,GAAK+wC,QAAN,KAAmB,IAAIhxC,CAAvB,CAAT;;AAEA,YAAI6wC,MAAM,CAAN,IAAWA,MAAM,CAArB,EAAwB;AACtBW,kBAAQvuB,GAAR,IAAe4tB,EAAf;AACD;;AAED,YAAI33B,MAAM,CAAN,IAAWA,MAAM,CAArB,EAAwB;AACtBs4B,kBAAQvuB,GAAR,IAAe/J,EAAf;AACD;AACF;AACF;;AAED,WAAO+J,CAAP;AACD;AACD;;;;;;;;;;;AAWA,WAASwuB,cAAT,CAAwBz5B,EAAxB,EAA4BC,EAA5B,EAAgCe,EAAhC,EAAoCC,EAApC,EAAwCxW,CAAxC,EAA2C1B,GAA3C,EAAgD;AAC9C,QAAI2wC,MAAM,CAACz5B,KAAKD,EAAN,IAAYvV,CAAZ,GAAgBuV,EAA1B;AACA,QAAI25B,MAAM,CAAC34B,KAAKf,EAAN,IAAYxV,CAAZ,GAAgBwV,EAA1B;AACA,QAAI25B,MAAM,CAAC34B,KAAKD,EAAN,IAAYvW,CAAZ,GAAgBuW,EAA1B;AACA,QAAI64B,OAAO,CAACF,MAAMD,GAAP,IAAcjvC,CAAd,GAAkBivC,GAA7B;AACA,QAAII,OAAO,CAACF,MAAMD,GAAP,IAAclvC,CAAd,GAAkBkvC,GAA7B;AACA,QAAII,QAAQ,CAACD,OAAOD,IAAR,IAAgBpvC,CAAhB,GAAoBovC,IAAhC,CAN8C,CAMR;;AAEtC9wC,QAAI,CAAJ,IAASiX,EAAT;AACAjX,QAAI,CAAJ,IAAS2wC,GAAT;AACA3wC,QAAI,CAAJ,IAAS8wC,IAAT;AACA9wC,QAAI,CAAJ,IAASgxC,KAAT,CAX8C,CAW9B;;AAEhBhxC,QAAI,CAAJ,IAASgxC,KAAT;AACAhxC,QAAI,CAAJ,IAAS+wC,IAAT;AACA/wC,QAAI,CAAJ,IAAS6wC,GAAT;AACA7wC,QAAI,CAAJ,IAASkY,EAAT;AACD;AACD;;;;;;;;;;;;;;;;;AAiBA,WAAS+4B,iBAAT,CAA2BC,EAA3B,EAA+BC,EAA/B,EAAmCC,EAAnC,EAAuCC,EAAvC,EAA2CrqB,EAA3C,EAA+CC,EAA/C,EAAmDqqB,EAAnD,EAAuDC,EAAvD,EAA2DzxC,CAA3D,EAA8DC,CAA9D,EAAiEC,GAAjE,EAAsE;AACpE;AACA,QAAI0B,CAAJ;AACA,QAAI8vC,WAAW,KAAf;AACA,QAAIrwC,IAAIswC,QAAR;AACA,QAAIlgC,IAAJ;AACA,QAAID,IAAJ;AACA,QAAIogC,EAAJ;AACA,QAAIC,EAAJ;AACAzC,QAAI,CAAJ,IAASpvC,CAAT;AACAovC,QAAI,CAAJ,IAASnvC,CAAT,CAVoE,CAUxD;AACZ;;AAEA,SAAK,IAAI6xC,KAAK,CAAd,EAAiBA,KAAK,CAAtB,EAAyBA,MAAM,IAA/B,EAAqC;AACnCzC,UAAI,CAAJ,IAASI,QAAQ2B,EAAR,EAAYE,EAAZ,EAAgBpqB,EAAhB,EAAoBsqB,EAApB,EAAwBM,EAAxB,CAAT;AACAzC,UAAI,CAAJ,IAASI,QAAQ4B,EAAR,EAAYE,EAAZ,EAAgBpqB,EAAhB,EAAoBsqB,EAApB,EAAwBK,EAAxB,CAAT;AACAF,WAAKnwC,WAAW2tC,GAAX,EAAgBC,GAAhB,CAAL;;AAEA,UAAIuC,KAAKvwC,CAAT,EAAY;AACVO,YAAIkwC,EAAJ;AACAzwC,YAAIuwC,EAAJ;AACD;AACF;;AAEDvwC,QAAIswC,QAAJ,CAxBoE,CAwBtD;;AAEd,SAAK,IAAI93C,IAAI,CAAb,EAAgBA,IAAI,EAApB,EAAwBA,GAAxB,EAA6B;AAC3B,UAAI63C,WAAWzC,eAAf,EAAgC;AAC9B;AACD;;AAEDx9B,aAAO7P,IAAI8vC,QAAX;AACAlgC,aAAO5P,IAAI8vC,QAAX,CAN2B,CAMN;;AAErBrC,UAAI,CAAJ,IAASI,QAAQ2B,EAAR,EAAYE,EAAZ,EAAgBpqB,EAAhB,EAAoBsqB,EAApB,EAAwB//B,IAAxB,CAAT;AACA49B,UAAI,CAAJ,IAASI,QAAQ4B,EAAR,EAAYE,EAAZ,EAAgBpqB,EAAhB,EAAoBsqB,EAApB,EAAwBhgC,IAAxB,CAAT;AACAmgC,WAAKnwC,WAAW4tC,GAAX,EAAgBD,GAAhB,CAAL;;AAEA,UAAI39B,QAAQ,CAAR,IAAamgC,KAAKvwC,CAAtB,EAAyB;AACvBO,YAAI6P,IAAJ;AACApQ,YAAIuwC,EAAJ;AACD,OAHD,MAGO;AACL;AACAtC,YAAI,CAAJ,IAASG,QAAQ2B,EAAR,EAAYE,EAAZ,EAAgBpqB,EAAhB,EAAoBsqB,EAApB,EAAwBhgC,IAAxB,CAAT;AACA89B,YAAI,CAAJ,IAASG,QAAQ4B,EAAR,EAAYE,EAAZ,EAAgBpqB,EAAhB,EAAoBsqB,EAApB,EAAwBjgC,IAAxB,CAAT;AACAqgC,aAAKpwC,WAAW6tC,GAAX,EAAgBF,GAAhB,CAAL;;AAEA,YAAI59B,QAAQ,CAAR,IAAaqgC,KAAKxwC,CAAtB,EAAyB;AACvBO,cAAI4P,IAAJ;AACAnQ,cAAIwwC,EAAJ;AACD,SAHD,MAGO;AACLH,sBAAY,GAAZ;AACD;AACF;AACF,KAtDmE,CAsDlE;;;AAGF,QAAIxxC,GAAJ,EAAS;AACPA,UAAI,CAAJ,IAASuvC,QAAQ2B,EAAR,EAAYE,EAAZ,EAAgBpqB,EAAhB,EAAoBsqB,EAApB,EAAwB5vC,CAAxB,CAAT;AACA1B,UAAI,CAAJ,IAASuvC,QAAQ4B,EAAR,EAAYE,EAAZ,EAAgBpqB,EAAhB,EAAoBsqB,EAApB,EAAwB7vC,CAAxB,CAAT;AACD,KA5DmE,CA4DlE;;;AAGF,WAAOmtC,WAAW1tC,CAAX,CAAP;AACD;AACD;;;;;;;;;AASA,WAAS0wC,WAAT,CAAqB56B,EAArB,EAAyBC,EAAzB,EAA6Be,EAA7B,EAAiCvW,CAAjC,EAAoC;AAClC,QAAI8tC,OAAO,IAAI9tC,CAAf;AACA,WAAO8tC,QAAQA,OAAOv4B,EAAP,GAAY,IAAIvV,CAAJ,GAAQwV,EAA5B,IAAkCxV,IAAIA,CAAJ,GAAQuW,EAAjD;AACD;AACD;;;;;;;;;AASA,WAAS65B,qBAAT,CAA+B76B,EAA/B,EAAmCC,EAAnC,EAAuCe,EAAvC,EAA2CvW,CAA3C,EAA8C;AAC5C,WAAO,KAAK,CAAC,IAAIA,CAAL,KAAWwV,KAAKD,EAAhB,IAAsBvV,KAAKuW,KAAKf,EAAV,CAA3B,CAAP;AACD;AACD;;;;;;;;;;AAUA,WAAS66B,eAAT,CAAyB96B,EAAzB,EAA6BC,EAA7B,EAAiCe,EAAjC,EAAqCpa,GAArC,EAA0C+nB,KAA1C,EAAiD;AAC/C,QAAI3mB,IAAIgY,KAAK,IAAIC,EAAT,GAAce,EAAtB;AACA,QAAI/Y,IAAI,KAAKgY,KAAKD,EAAV,CAAR;AACA,QAAI04B,IAAI14B,KAAKpZ,GAAb;AACA,QAAIqkB,IAAI,CAAR;;AAEA,QAAImtB,aAAapwC,CAAb,CAAJ,EAAqB;AACnB,UAAIqwC,kBAAkBpwC,CAAlB,CAAJ,EAA0B;AACxB,YAAI4wC,KAAK,CAACH,CAAD,GAAKzwC,CAAd;;AAEA,YAAI4wC,MAAM,CAAN,IAAWA,MAAM,CAArB,EAAwB;AACtBlqB,gBAAM1D,GAAN,IAAa4tB,EAAb;AACD;AACF;AACF,KARD,MAQO;AACL,UAAIC,OAAO7wC,IAAIA,CAAJ,GAAQ,IAAID,CAAJ,GAAQ0wC,CAA3B;;AAEA,UAAIN,aAAaU,IAAb,CAAJ,EAAwB;AACtB,YAAID,KAAK,CAAC5wC,CAAD,IAAM,IAAID,CAAV,CAAT;;AAEA,YAAI6wC,MAAM,CAAN,IAAWA,MAAM,CAArB,EAAwB;AACtBlqB,gBAAM1D,GAAN,IAAa4tB,EAAb;AACD;AACF,OAND,MAMO,IAAIC,OAAO,CAAX,EAAc;AACnB,YAAIE,WAAWpB,WAAWkB,IAAX,CAAf;AACA,YAAID,KAAK,CAAC,CAAC5wC,CAAD,GAAK+wC,QAAN,KAAmB,IAAIhxC,CAAvB,CAAT;AACA,YAAIkZ,KAAK,CAAC,CAACjZ,CAAD,GAAK+wC,QAAN,KAAmB,IAAIhxC,CAAvB,CAAT;;AAEA,YAAI6wC,MAAM,CAAN,IAAWA,MAAM,CAArB,EAAwB;AACtBlqB,gBAAM1D,GAAN,IAAa4tB,EAAb;AACD;;AAED,YAAI33B,MAAM,CAAN,IAAWA,MAAM,CAArB,EAAwB;AACtByN,gBAAM1D,GAAN,IAAa/J,EAAb;AACD;AACF;AACF;;AAED,WAAO+J,CAAP;AACD;AACD;;;;;;;;;AASA,WAAS8vB,iBAAT,CAA2B/6B,EAA3B,EAA+BC,EAA/B,EAAmCe,EAAnC,EAAuC;AACrC,QAAIg6B,UAAUh7B,KAAKgB,EAAL,GAAU,IAAIf,EAA5B;;AAEA,QAAI+6B,YAAY,CAAhB,EAAmB;AACjB;AACA,aAAO,GAAP;AACD,KAHD,MAGO;AACL,aAAO,CAACh7B,KAAKC,EAAN,IAAY+6B,OAAnB;AACD;AACF;AACD;;;;;;;;;;AAUA,WAASC,kBAAT,CAA4Bj7B,EAA5B,EAAgCC,EAAhC,EAAoCe,EAApC,EAAwCvW,CAAxC,EAA2C1B,GAA3C,EAAgD;AAC9C,QAAI2wC,MAAM,CAACz5B,KAAKD,EAAN,IAAYvV,CAAZ,GAAgBuV,EAA1B;AACA,QAAI25B,MAAM,CAAC34B,KAAKf,EAAN,IAAYxV,CAAZ,GAAgBwV,EAA1B;AACA,QAAI45B,OAAO,CAACF,MAAMD,GAAP,IAAcjvC,CAAd,GAAkBivC,GAA7B,CAH8C,CAGZ;;AAElC3wC,QAAI,CAAJ,IAASiX,EAAT;AACAjX,QAAI,CAAJ,IAAS2wC,GAAT;AACA3wC,QAAI,CAAJ,IAAS8wC,IAAT,CAP8C,CAO/B;;AAEf9wC,QAAI,CAAJ,IAAS8wC,IAAT;AACA9wC,QAAI,CAAJ,IAAS4wC,GAAT;AACA5wC,QAAI,CAAJ,IAASiY,EAAT;AACD;AACD;;;;;;;;;;;;;;;AAeA,WAASk6B,qBAAT,CAA+BjB,EAA/B,EAAmCC,EAAnC,EAAuCC,EAAvC,EAA2CC,EAA3C,EAA+CrqB,EAA/C,EAAmDC,EAAnD,EAAuDnnB,CAAvD,EAA0DC,CAA1D,EAA6DC,GAA7D,EAAkE;AAChE;AACA,QAAI0B,CAAJ;AACA,QAAI8vC,WAAW,KAAf;AACA,QAAIrwC,IAAIswC,QAAR;AACAvC,QAAI,CAAJ,IAASpvC,CAAT;AACAovC,QAAI,CAAJ,IAASnvC,CAAT,CANgE,CAMpD;AACZ;;AAEA,SAAK,IAAI6xC,KAAK,CAAd,EAAiBA,KAAK,CAAtB,EAAyBA,MAAM,IAA/B,EAAqC;AACnCzC,UAAI,CAAJ,IAAS0C,YAAYX,EAAZ,EAAgBE,EAAhB,EAAoBpqB,EAApB,EAAwB4qB,EAAxB,CAAT;AACAzC,UAAI,CAAJ,IAAS0C,YAAYV,EAAZ,EAAgBE,EAAhB,EAAoBpqB,EAApB,EAAwB2qB,EAAxB,CAAT;AACA,UAAIF,KAAKnwC,WAAW2tC,GAAX,EAAgBC,GAAhB,CAAT;;AAEA,UAAIuC,KAAKvwC,CAAT,EAAY;AACVO,YAAIkwC,EAAJ;AACAzwC,YAAIuwC,EAAJ;AACD;AACF;;AAEDvwC,QAAIswC,QAAJ,CApBgE,CAoBlD;;AAEd,SAAK,IAAI93C,IAAI,CAAb,EAAgBA,IAAI,EAApB,EAAwBA,GAAxB,EAA6B;AAC3B,UAAI63C,WAAWzC,eAAf,EAAgC;AAC9B;AACD;;AAED,UAAIx9B,OAAO7P,IAAI8vC,QAAf;AACA,UAAIlgC,OAAO5P,IAAI8vC,QAAf,CAN2B,CAMF;;AAEzBrC,UAAI,CAAJ,IAAS0C,YAAYX,EAAZ,EAAgBE,EAAhB,EAAoBpqB,EAApB,EAAwBzV,IAAxB,CAAT;AACA49B,UAAI,CAAJ,IAAS0C,YAAYV,EAAZ,EAAgBE,EAAhB,EAAoBpqB,EAApB,EAAwB1V,IAAxB,CAAT;AACA,UAAImgC,KAAKnwC,WAAW4tC,GAAX,EAAgBD,GAAhB,CAAT;;AAEA,UAAI39B,QAAQ,CAAR,IAAamgC,KAAKvwC,CAAtB,EAAyB;AACvBO,YAAI6P,IAAJ;AACApQ,YAAIuwC,EAAJ;AACD,OAHD,MAGO;AACL;AACAtC,YAAI,CAAJ,IAASyC,YAAYX,EAAZ,EAAgBE,EAAhB,EAAoBpqB,EAApB,EAAwB1V,IAAxB,CAAT;AACA89B,YAAI,CAAJ,IAASyC,YAAYV,EAAZ,EAAgBE,EAAhB,EAAoBpqB,EAApB,EAAwB3V,IAAxB,CAAT;AACA,YAAIqgC,KAAKpwC,WAAW6tC,GAAX,EAAgBF,GAAhB,CAAT;;AAEA,YAAI59B,QAAQ,CAAR,IAAaqgC,KAAKxwC,CAAtB,EAAyB;AACvBO,cAAI4P,IAAJ;AACAnQ,cAAIwwC,EAAJ;AACD,SAHD,MAGO;AACLH,sBAAY,GAAZ;AACD;AACF;AACF,KAlD+D,CAkD9D;;;AAGF,QAAIxxC,GAAJ,EAAS;AACPA,UAAI,CAAJ,IAAS6xC,YAAYX,EAAZ,EAAgBE,EAAhB,EAAoBpqB,EAApB,EAAwBtlB,CAAxB,CAAT;AACA1B,UAAI,CAAJ,IAAS6xC,YAAYV,EAAZ,EAAgBE,EAAhB,EAAoBpqB,EAApB,EAAwBvlB,CAAxB,CAAT;AACD,KAxD+D,CAwD9D;;;AAGF,WAAOmtC,WAAW1tC,CAAX,CAAP;AACD;;AAED;;;AAGA,MAAIixC,YAAY3xC,KAAKoB,GAArB;AACA,MAAIwwC,YAAY5xC,KAAKqB,GAArB;AACA,MAAIwwC,YAAY7xC,KAAK2J,GAArB;AACA,MAAImoC,YAAY9xC,KAAK6J,GAArB;AACA,MAAIkoC,MAAM/xC,KAAKgN,EAAL,GAAU,CAApB;AACA,MAAI8M,QAAQ1a,QAAZ;AACA,MAAI4yC,MAAM5yC,QAAV;AACA,MAAI6yC,YAAY7yC,QAAhB;AACA;;;;;;;;AAQA,WAAS8yC,UAAT,CAAoBlP,MAApB,EAA4BmP,MAA5B,EAAoCC,MAApC,EAA4C;AAC1C,QAAIpP,OAAO5pC,MAAP,KAAkB,CAAtB,EAAyB;AACvB;AACD;;AAED,QAAIuU,IAAIq1B,OAAO,CAAP,CAAR;AACA,QAAI9gB,OAAOvU,EAAE,CAAF,CAAX;AACA,QAAIwU,QAAQxU,EAAE,CAAF,CAAZ;AACA,QAAI+d,MAAM/d,EAAE,CAAF,CAAV;AACA,QAAIomB,SAASpmB,EAAE,CAAF,CAAb;AACA,QAAIzU,CAAJ;;AAEA,SAAKA,IAAI,CAAT,EAAYA,IAAI8pC,OAAO5pC,MAAvB,EAA+BF,GAA/B,EAAoC;AAClCyU,UAAIq1B,OAAO9pC,CAAP,CAAJ;AACAgpB,aAAOyvB,UAAUzvB,IAAV,EAAgBvU,EAAE,CAAF,CAAhB,CAAP;AACAwU,cAAQyvB,UAAUzvB,KAAV,EAAiBxU,EAAE,CAAF,CAAjB,CAAR;AACA+d,YAAMimB,UAAUjmB,GAAV,EAAe/d,EAAE,CAAF,CAAf,CAAN;AACAomB,eAAS6d,UAAU7d,MAAV,EAAkBpmB,EAAE,CAAF,CAAlB,CAAT;AACD;;AAEDwkC,WAAO,CAAP,IAAYjwB,IAAZ;AACAiwB,WAAO,CAAP,IAAYzmB,GAAZ;AACA0mB,WAAO,CAAP,IAAYjwB,KAAZ;AACAiwB,WAAO,CAAP,IAAYre,MAAZ;AACD;AACD;;;;;;;;;;AAUA,WAASse,QAAT,CAAkB5B,EAAlB,EAAsBC,EAAtB,EAA0BC,EAA1B,EAA8BC,EAA9B,EAAkCuB,MAAlC,EAA0CC,MAA1C,EAAkD;AAChDD,WAAO,CAAP,IAAYR,UAAUlB,EAAV,EAAcE,EAAd,CAAZ;AACAwB,WAAO,CAAP,IAAYR,UAAUjB,EAAV,EAAcE,EAAd,CAAZ;AACAwB,WAAO,CAAP,IAAYR,UAAUnB,EAAV,EAAcE,EAAd,CAAZ;AACAyB,WAAO,CAAP,IAAYR,UAAUlB,EAAV,EAAcE,EAAd,CAAZ;AACD;AACD,MAAI0B,OAAO,EAAX;AACA,MAAIC,OAAO,EAAX;AACA;;;;;;;;;;;;;;;AAeA,WAASC,SAAT,CAAmB/B,EAAnB,EAAuBC,EAAvB,EAA2BC,EAA3B,EAA+BC,EAA/B,EAAmCrqB,EAAnC,EAAuCC,EAAvC,EAA2CqqB,EAA3C,EAA+CC,EAA/C,EAAmDqB,MAAnD,EAA2DC,MAA3D,EAAmE;AACjE,QAAIK,kBAAkB1C,YAAtB;AACA,QAAI2C,aAAa5D,OAAjB;AACA,QAAI51C,CAAJ;AACA,QAAIuoB,IAAIgxB,gBAAgBhC,EAAhB,EAAoBE,EAApB,EAAwBpqB,EAAxB,EAA4BsqB,EAA5B,EAAgCyB,IAAhC,CAAR;AACAH,WAAO,CAAP,IAAYnB,QAAZ;AACAmB,WAAO,CAAP,IAAYnB,QAAZ;AACAoB,WAAO,CAAP,IAAY,CAACpB,QAAb;AACAoB,WAAO,CAAP,IAAY,CAACpB,QAAb;;AAEA,SAAK93C,IAAI,CAAT,EAAYA,IAAIuoB,CAAhB,EAAmBvoB,GAAnB,EAAwB;AACtB,UAAImG,IAAIqzC,WAAWjC,EAAX,EAAeE,EAAf,EAAmBpqB,EAAnB,EAAuBsqB,EAAvB,EAA2ByB,KAAKp5C,CAAL,CAA3B,CAAR;AACAi5C,aAAO,CAAP,IAAYR,UAAUtyC,CAAV,EAAa8yC,OAAO,CAAP,CAAb,CAAZ;AACAC,aAAO,CAAP,IAAYR,UAAUvyC,CAAV,EAAa+yC,OAAO,CAAP,CAAb,CAAZ;AACD;;AAED3wB,QAAIgxB,gBAAgB/B,EAAhB,EAAoBE,EAApB,EAAwBpqB,EAAxB,EAA4BsqB,EAA5B,EAAgCyB,IAAhC,CAAJ;;AAEA,SAAKr5C,IAAI,CAAT,EAAYA,IAAIuoB,CAAhB,EAAmBvoB,GAAnB,EAAwB;AACtB,UAAIoG,IAAIozC,WAAWhC,EAAX,EAAeE,EAAf,EAAmBpqB,EAAnB,EAAuBsqB,EAAvB,EAA2ByB,KAAKr5C,CAAL,CAA3B,CAAR;AACAi5C,aAAO,CAAP,IAAYR,UAAUryC,CAAV,EAAa6yC,OAAO,CAAP,CAAb,CAAZ;AACAC,aAAO,CAAP,IAAYR,UAAUtyC,CAAV,EAAa8yC,OAAO,CAAP,CAAb,CAAZ;AACD;;AAEDD,WAAO,CAAP,IAAYR,UAAUlB,EAAV,EAAc0B,OAAO,CAAP,CAAd,CAAZ;AACAC,WAAO,CAAP,IAAYR,UAAUnB,EAAV,EAAc2B,OAAO,CAAP,CAAd,CAAZ;AACAD,WAAO,CAAP,IAAYR,UAAUd,EAAV,EAAcsB,OAAO,CAAP,CAAd,CAAZ;AACAC,WAAO,CAAP,IAAYR,UAAUf,EAAV,EAAcuB,OAAO,CAAP,CAAd,CAAZ;AACAD,WAAO,CAAP,IAAYR,UAAUjB,EAAV,EAAcyB,OAAO,CAAP,CAAd,CAAZ;AACAC,WAAO,CAAP,IAAYR,UAAUlB,EAAV,EAAc0B,OAAO,CAAP,CAAd,CAAZ;AACAD,WAAO,CAAP,IAAYR,UAAUb,EAAV,EAAcqB,OAAO,CAAP,CAAd,CAAZ;AACAC,WAAO,CAAP,IAAYR,UAAUd,EAAV,EAAcsB,OAAO,CAAP,CAAd,CAAZ;AACD;AACD;;;;;;;;;;;;;AAaA,WAASO,aAAT,CAAuBlC,EAAvB,EAA2BC,EAA3B,EAA+BC,EAA/B,EAAmCC,EAAnC,EAAuCrqB,EAAvC,EAA2CC,EAA3C,EAA+C2rB,MAA/C,EAAuDC,MAAvD,EAA+D;AAC7D,QAAIQ,uBAAuBrB,iBAA3B;AACA,QAAIsB,iBAAiBzB,WAArB,CAF6D,CAE3B;;AAElC,QAAI0B,KAAKlB,UAAUD,UAAUiB,qBAAqBnC,EAArB,EAAyBE,EAAzB,EAA6BpqB,EAA7B,CAAV,EAA4C,CAA5C,CAAV,EAA0D,CAA1D,CAAT;AACA,QAAIwsB,KAAKnB,UAAUD,UAAUiB,qBAAqBlC,EAArB,EAAyBE,EAAzB,EAA6BpqB,EAA7B,CAAV,EAA4C,CAA5C,CAAV,EAA0D,CAA1D,CAAT;AACA,QAAInnB,IAAIwzC,eAAepC,EAAf,EAAmBE,EAAnB,EAAuBpqB,EAAvB,EAA2BusB,EAA3B,CAAR;AACA,QAAIxzC,IAAIuzC,eAAenC,EAAf,EAAmBE,EAAnB,EAAuBpqB,EAAvB,EAA2BusB,EAA3B,CAAR;AACAZ,WAAO,CAAP,IAAYR,UAAUlB,EAAV,EAAclqB,EAAd,EAAkBlnB,CAAlB,CAAZ;AACA8yC,WAAO,CAAP,IAAYR,UAAUjB,EAAV,EAAclqB,EAAd,EAAkBlnB,CAAlB,CAAZ;AACA8yC,WAAO,CAAP,IAAYR,UAAUnB,EAAV,EAAclqB,EAAd,EAAkBlnB,CAAlB,CAAZ;AACA+yC,WAAO,CAAP,IAAYR,UAAUlB,EAAV,EAAclqB,EAAd,EAAkBlnB,CAAlB,CAAZ;AACD;AACD;;;;;;;;;;;;;;;AAeA,WAAS0zC,OAAT,CAAiB3zC,CAAjB,EAAoBC,CAApB,EAAuB2zC,EAAvB,EAA2BC,EAA3B,EAA+BC,UAA/B,EAA2CC,QAA3C,EAAqDC,aAArD,EAAoElB,MAApE,EAA4EC,MAA5E,EAAoF;AAClF,QAAIkB,UAAUlyC,GAAd;AACA,QAAImyC,UAAUlyC,GAAd;AACA,QAAImyC,OAAOxzC,KAAKyzC,GAAL,CAASN,aAAaC,QAAtB,CAAX;;AAEA,QAAII,OAAOzB,GAAP,GAAa,IAAb,IAAqByB,OAAO,IAAhC,EAAsC;AACpC;AACArB,aAAO,CAAP,IAAY9yC,IAAI4zC,EAAhB;AACAd,aAAO,CAAP,IAAY7yC,IAAI4zC,EAAhB;AACAd,aAAO,CAAP,IAAY/yC,IAAI4zC,EAAhB;AACAb,aAAO,CAAP,IAAY9yC,IAAI4zC,EAAhB;AACA;AACD;;AAEDp5B,UAAM,CAAN,IAAWg4B,UAAUqB,UAAV,IAAwBF,EAAxB,GAA6B5zC,CAAxC;AACAya,UAAM,CAAN,IAAW+3B,UAAUsB,UAAV,IAAwBD,EAAxB,GAA6B5zC,CAAxC;AACA0yC,QAAI,CAAJ,IAASF,UAAUsB,QAAV,IAAsBH,EAAtB,GAA2B5zC,CAApC;AACA2yC,QAAI,CAAJ,IAASH,UAAUuB,QAAV,IAAsBF,EAAtB,GAA2B5zC,CAApC;AACAg0C,YAAQnB,MAAR,EAAgBr4B,KAAhB,EAAuBk4B,GAAvB;AACAuB,YAAQnB,MAAR,EAAgBt4B,KAAhB,EAAuBk4B,GAAvB,EAnBkF,CAmBrD;;AAE7BmB,iBAAaA,aAAapB,GAA1B;;AAEA,QAAIoB,aAAa,CAAjB,EAAoB;AAClBA,mBAAaA,aAAapB,GAA1B;AACD;;AAEDqB,eAAWA,WAAWrB,GAAtB;;AAEA,QAAIqB,WAAW,CAAf,EAAkB;AAChBA,iBAAWA,WAAWrB,GAAtB;AACD;;AAED,QAAIoB,aAAaC,QAAb,IAAyB,CAACC,aAA9B,EAA6C;AAC3CD,kBAAYrB,GAAZ;AACD,KAFD,MAEO,IAAIoB,aAAaC,QAAb,IAAyBC,aAA7B,EAA4C;AACjDF,oBAAcpB,GAAd;AACD;;AAED,QAAIsB,aAAJ,EAAmB;AACjB,UAAI5wB,MAAM2wB,QAAV;AACAA,iBAAWD,UAAX;AACAA,mBAAa1wB,GAAb;AACD,KA3CiF,CA2ChF;AACF;;;AAGA,SAAK,IAAIixB,QAAQ,CAAjB,EAAoBA,QAAQN,QAA5B,EAAsCM,SAAS1zC,KAAKgN,EAAL,GAAU,CAAzD,EAA4D;AAC1D,UAAI0mC,QAAQP,UAAZ,EAAwB;AACtBlB,kBAAU,CAAV,IAAeH,UAAU4B,KAAV,IAAmBT,EAAnB,GAAwB5zC,CAAvC;AACA4yC,kBAAU,CAAV,IAAeJ,UAAU6B,KAAV,IAAmBR,EAAnB,GAAwB5zC,CAAvC;AACAg0C,gBAAQnB,MAAR,EAAgBF,SAAhB,EAA2BE,MAA3B;AACAoB,gBAAQnB,MAAR,EAAgBH,SAAhB,EAA2BG,MAA3B;AACD;AACF;AACF;;AAED;;;;;;;AAOA;AACA,MAAIuB,MAAM;AACRC,OAAG,CADK;AAERr/B,OAAG,CAFK;AAGR66B,OAAG,CAHK;AAIRyE,OAAG,CAJK;AAKR1E,OAAG,CALK;AAMR2E,OAAG,CANK;AAOR;AACA7/B,OAAG;AARK,GAAV,CA71X4B,CAs2XzB;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,MAAI8/B,QAAQ,EAAZ;AACA,MAAIC,QAAQ,EAAZ;AACA,MAAIC,OAAO,EAAX;AACA,MAAIC,OAAO,EAAX;AACA,MAAIC,YAAYn0C,KAAKoB,GAArB;AACA,MAAIgzC,YAAYp0C,KAAKqB,GAArB;AACA,MAAIgzC,YAAYr0C,KAAK6J,GAArB;AACA,MAAIyqC,YAAYt0C,KAAK2J,GAArB;AACA,MAAI4qC,aAAav0C,KAAKC,IAAtB;AACA,MAAIu0C,UAAUx0C,KAAKyzC,GAAnB;AACA,MAAIgB,gBAAgB,OAAOt1C,YAAP,IAAuB,WAA3C;AACA;;;;;AAKA,MAAIu1C,YAAY,SAAZA,SAAY,CAAUC,WAAV,EAAuB;AACrC,SAAKC,SAAL,GAAiB,EAAED,eAAe,KAAjB,CAAjB;;AAEA,QAAI,KAAKC,SAAT,EAAoB;AAClB;;;;AAIA,WAAKv5C,IAAL,GAAY,EAAZ;AACD;;AAED,SAAK1C,IAAL,GAAY,IAAZ;AACD,GAZD;AAaA;;;;;AAMA+7C,YAAUj9C,SAAV,GAAsB;AACpB6B,iBAAao7C,SADO;AAEpBG,SAAK,CAFe;AAGpBC,SAAK,CAHe;AAIpBC,SAAK,CAJe;AAKpBC,SAAK,CALe;AAMpB;AACAC,SAAK,CAPe;AAQpBC,SAAK,CARe;AASpB3kC,UAAM,CATc;AAUpB4kC,eAAW,IAVS;AAWpBC,iBAAa,CAXO;AAYpBC,cAAU,CAZU;AAapBC,cAAU,CAbU;;AAepB;;;AAGAC,cAAU,kBAAU9pC,EAAV,EAAcC,EAAd,EAAkB;AAC1B,WAAKupC,GAAL,GAAWT,QAAQ,IAAI34B,gBAAJ,GAAuBpQ,EAA/B,KAAsC,CAAjD;AACA,WAAKypC,GAAL,GAAWV,QAAQ,IAAI34B,gBAAJ,GAAuBnQ,EAA/B,KAAsC,CAAjD;AACD,KArBmB;AAsBpBzU,gBAAY,sBAAY;AACtB,aAAO,KAAK0B,IAAZ;AACD,KAxBmB;;AA0BpB;;;;AAIAy9B,eAAW,mBAAU7yB,GAAV,EAAe;AACxB,WAAK5K,IAAL,GAAY4K,GAAZ;AACAA,aAAOA,IAAI6yB,SAAJ,EAAP;AACA7yB,cAAQ,KAAK8H,GAAL,GAAW9H,IAAI8H,GAAvB,EAHwB,CAGK;;AAE7B,UAAI,KAAKupC,SAAT,EAAoB;AAClB,aAAKrkC,IAAL,GAAY,CAAZ;AACD;;AAED,UAAI,KAAK4kC,SAAT,EAAoB;AAClB,aAAKA,SAAL,GAAiB,IAAjB;AACA,aAAKC,WAAL,GAAmB,CAAnB;AACD;;AAED,aAAO,IAAP;AACD,KA7CmB;;AA+CpB;;;;;AAKA3hB,YAAQ,gBAAUp0B,CAAV,EAAaC,CAAb,EAAgB;AACtB,WAAKk2C,OAAL,CAAa7B,IAAIC,CAAjB,EAAoBv0C,CAApB,EAAuBC,CAAvB;AACA,WAAK3G,IAAL,IAAa,KAAKA,IAAL,CAAU86B,MAAV,CAAiBp0B,CAAjB,EAAoBC,CAApB,CAAb,CAFsB,CAEe;AACrC;AACA;AACA;;AAEA,WAAKy1C,GAAL,GAAW11C,CAAX;AACA,WAAK21C,GAAL,GAAW11C,CAAX;AACA,WAAKu1C,GAAL,GAAWx1C,CAAX;AACA,WAAKy1C,GAAL,GAAWx1C,CAAX;AACA,aAAO,IAAP;AACD,KAhEmB;;AAkEpB;;;;;AAKAo0B,YAAQ,gBAAUr0B,CAAV,EAAaC,CAAb,EAAgB;AACtB,UAAIm2C,aAAajB,QAAQn1C,IAAI,KAAKw1C,GAAjB,IAAwB,KAAKI,GAA7B,IAAoCT,QAAQl1C,IAAI,KAAKw1C,GAAjB,IAAwB,KAAKI,GAAjE,CAAqE;AAArE,SACd,KAAK3kC,IAAL,GAAY,CADf;AAEA,WAAKilC,OAAL,CAAa7B,IAAIp/B,CAAjB,EAAoBlV,CAApB,EAAuBC,CAAvB;;AAEA,UAAI,KAAK3G,IAAL,IAAa88C,UAAjB,EAA6B;AAC3B,aAAKC,UAAL,KAAoB,KAAKC,aAAL,CAAmBt2C,CAAnB,EAAsBC,CAAtB,CAApB,GAA+C,KAAK3G,IAAL,CAAU+6B,MAAV,CAAiBr0B,CAAjB,EAAoBC,CAApB,CAA/C;AACD;;AAED,UAAIm2C,UAAJ,EAAgB;AACd,aAAKZ,GAAL,GAAWx1C,CAAX;AACA,aAAKy1C,GAAL,GAAWx1C,CAAX;AACD;;AAED,aAAO,IAAP;AACD,KAtFmB;;AAwFpB;;;;;;;;;AASAs2C,mBAAe,uBAAUjF,EAAV,EAAcC,EAAd,EAAkBrqB,EAAlB,EAAsBC,EAAtB,EAA0BqqB,EAA1B,EAA8BC,EAA9B,EAAkC;AAC/C,WAAK0E,OAAL,CAAa7B,IAAIvE,CAAjB,EAAoBuB,EAApB,EAAwBC,EAAxB,EAA4BrqB,EAA5B,EAAgCC,EAAhC,EAAoCqqB,EAApC,EAAwCC,EAAxC;;AAEA,UAAI,KAAKn4C,IAAT,EAAe;AACb,aAAK+8C,UAAL,KAAoB,KAAKG,eAAL,CAAqBlF,EAArB,EAAyBC,EAAzB,EAA6BrqB,EAA7B,EAAiCC,EAAjC,EAAqCqqB,EAArC,EAAyCC,EAAzC,CAApB,GAAmE,KAAKn4C,IAAL,CAAUi9C,aAAV,CAAwBjF,EAAxB,EAA4BC,EAA5B,EAAgCrqB,EAAhC,EAAoCC,EAApC,EAAwCqqB,EAAxC,EAA4CC,EAA5C,CAAnE;AACD;;AAED,WAAK+D,GAAL,GAAWhE,EAAX;AACA,WAAKiE,GAAL,GAAWhE,EAAX;AACA,aAAO,IAAP;AACD,KA3GmB;;AA6GpB;;;;;;;AAOAgF,sBAAkB,0BAAUnF,EAAV,EAAcC,EAAd,EAAkBrqB,EAAlB,EAAsBC,EAAtB,EAA0B;AAC1C,WAAKgvB,OAAL,CAAa7B,IAAIE,CAAjB,EAAoBlD,EAApB,EAAwBC,EAAxB,EAA4BrqB,EAA5B,EAAgCC,EAAhC;;AAEA,UAAI,KAAK7tB,IAAT,EAAe;AACb,aAAK+8C,UAAL,KAAoB,KAAKK,kBAAL,CAAwBpF,EAAxB,EAA4BC,EAA5B,EAAgCrqB,EAAhC,EAAoCC,EAApC,CAApB,GAA8D,KAAK7tB,IAAL,CAAUm9C,gBAAV,CAA2BnF,EAA3B,EAA+BC,EAA/B,EAAmCrqB,EAAnC,EAAuCC,EAAvC,CAA9D;AACD;;AAED,WAAKquB,GAAL,GAAWtuB,EAAX;AACA,WAAKuuB,GAAL,GAAWtuB,EAAX;AACA,aAAO,IAAP;AACD,KA9HmB;;AAgIpB;;;;;;;;;AASAmN,SAAK,aAAUqiB,EAAV,EAAcC,EAAd,EAAkBxjC,CAAlB,EAAqB0gC,UAArB,EAAiCC,QAAjC,EAA2CC,aAA3C,EAA0D;AAC7D,WAAKmC,OAAL,CAAa7B,IAAIxE,CAAjB,EAAoB6G,EAApB,EAAwBC,EAAxB,EAA4BxjC,CAA5B,EAA+BA,CAA/B,EAAkC0gC,UAAlC,EAA8CC,WAAWD,UAAzD,EAAqE,CAArE,EAAwEE,gBAAgB,CAAhB,GAAoB,CAA5F;AACA,WAAK16C,IAAL,IAAa,KAAKA,IAAL,CAAUg7B,GAAV,CAAcqiB,EAAd,EAAkBC,EAAlB,EAAsBxjC,CAAtB,EAAyB0gC,UAAzB,EAAqCC,QAArC,EAA+CC,aAA/C,CAAb;AACA,WAAKwB,GAAL,GAAWR,UAAUjB,QAAV,IAAsB3gC,CAAtB,GAA0BujC,EAArC;AACA,WAAKlB,GAAL,GAAWR,UAAUlB,QAAV,IAAsB3gC,CAAtB,GAA0BujC,EAArC;AACA,aAAO,IAAP;AACD,KA/ImB;AAgJpB;AACAE,WAAO,eAAUvF,EAAV,EAAcC,EAAd,EAAkBrqB,EAAlB,EAAsBC,EAAtB,EAA0B2vB,MAA1B,EAAkC;AACvC,UAAI,KAAKx9C,IAAT,EAAe;AACb,aAAKA,IAAL,CAAUu9C,KAAV,CAAgBvF,EAAhB,EAAoBC,EAApB,EAAwBrqB,EAAxB,EAA4BC,EAA5B,EAAgC2vB,MAAhC;AACD;;AAED,aAAO,IAAP;AACD,KAvJmB;AAwJpB;AACAx2B,UAAM,cAAUtgB,CAAV,EAAaC,CAAb,EAAgBya,CAAhB,EAAmBzW,CAAnB,EAAsB;AAC1B,WAAK3K,IAAL,IAAa,KAAKA,IAAL,CAAUgnB,IAAV,CAAetgB,CAAf,EAAkBC,CAAlB,EAAqBya,CAArB,EAAwBzW,CAAxB,CAAb;AACA,WAAKkyC,OAAL,CAAa7B,IAAI1/B,CAAjB,EAAoB5U,CAApB,EAAuBC,CAAvB,EAA0Bya,CAA1B,EAA6BzW,CAA7B;AACA,aAAO,IAAP;AACD,KA7JmB;;AA+JpB;;;AAGA+yB,eAAW,qBAAY;AACrB,WAAKmf,OAAL,CAAa7B,IAAIG,CAAjB;AACA,UAAIvwC,MAAM,KAAK5K,IAAf;AACA,UAAI83C,KAAK,KAAKsE,GAAd;AACA,UAAIrE,KAAK,KAAKsE,GAAd;;AAEA,UAAIzxC,GAAJ,EAAS;AACP,aAAKmyC,UAAL,MAAqB,KAAKC,aAAL,CAAmBlF,EAAnB,EAAuBC,EAAvB,CAArB;AACAntC,YAAI8yB,SAAJ;AACD;;AAED,WAAKwe,GAAL,GAAWpE,EAAX;AACA,WAAKqE,GAAL,GAAWpE,EAAX;AACA,aAAO,IAAP;AACD,KAhLmB;;AAkLpB;;;;;;AAMA/pB,UAAM,cAAUpjB,GAAV,EAAe;AACnBA,aAAOA,IAAIojB,IAAJ,EAAP;AACA,WAAKyvB,QAAL;AACD,KA3LmB;;AA6LpB;;;;AAIAxvB,YAAQ,gBAAUrjB,GAAV,EAAe;AACrBA,aAAOA,IAAIqjB,MAAJ,EAAP;AACA,WAAKwvB,QAAL;AACD,KApMmB;;AAsMpB;;;;;AAKAC,iBAAa,qBAAUvvB,QAAV,EAAoB;AAC/B,UAAIA,oBAAoBlvB,KAAxB,EAA+B;AAC7B,aAAKu9C,SAAL,GAAiBruB,QAAjB;AACA,aAAKuuB,QAAL,GAAgB,CAAhB;AACA,YAAIiB,cAAc,CAAlB;;AAEA,aAAK,IAAIp9C,IAAI,CAAb,EAAgBA,IAAI4tB,SAAS1tB,MAA7B,EAAqCF,GAArC,EAA0C;AACxCo9C,yBAAexvB,SAAS5tB,CAAT,CAAf;AACD;;AAED,aAAKo8C,QAAL,GAAgBgB,WAAhB;AACD;;AAED,aAAO,IAAP;AACD,KAzNmB;;AA2NpB;;;;;AAKAC,uBAAmB,2BAAU53C,MAAV,EAAkB;AACnC,WAAKy2C,WAAL,GAAmBz2C,MAAnB;AACA,aAAO,IAAP;AACD,KAnOmB;;AAqOpB;;;;AAIAxF,SAAK,eAAY;AACf,aAAO,KAAKoX,IAAZ;AACD,KA3OmB;;AA6OpB;;;AAGAimC,aAAS,iBAAUn7C,IAAV,EAAgB;AACvB,UAAIo7C,SAASp7C,KAAKjC,MAAlB;;AAEA,UAAI,EAAE,KAAKiC,IAAL,IAAa,KAAKA,IAAL,CAAUjC,MAAV,IAAoBq9C,MAAnC,KAA8ChC,aAAlD,EAAiE;AAC/D,aAAKp5C,IAAL,GAAY,IAAI8D,YAAJ,CAAiBs3C,MAAjB,CAAZ;AACD;;AAED,WAAK,IAAIv9C,IAAI,CAAb,EAAgBA,IAAIu9C,MAApB,EAA4Bv9C,GAA5B,EAAiC;AAC/B,aAAKmC,IAAL,CAAUnC,CAAV,IAAemC,KAAKnC,CAAL,CAAf;AACD;;AAED,WAAKqX,IAAL,GAAYkmC,MAAZ;AACD,KA5PmB;;AA8PpB;;;;AAIAC,gBAAY,oBAAUr6B,IAAV,EAAgB;AAC1B,UAAI,EAAEA,gBAAgBzkB,KAAlB,CAAJ,EAA8B;AAC5BykB,eAAO,CAACA,IAAD,CAAP;AACD;;AAED,UAAIo6B,SAASp6B,KAAKjjB,MAAlB;AACA,UAAIu9C,aAAa,CAAjB;AACA,UAAIh4C,SAAS,KAAK4R,IAAlB;;AAEA,WAAK,IAAIrX,IAAI,CAAb,EAAgBA,IAAIu9C,MAApB,EAA4Bv9C,GAA5B,EAAiC;AAC/By9C,sBAAct6B,KAAKnjB,CAAL,EAAQC,GAAR,EAAd;AACD;;AAED,UAAIs7C,iBAAiB,KAAKp5C,IAAL,YAAqB8D,YAA1C,EAAwD;AACtD,aAAK9D,IAAL,GAAY,IAAI8D,YAAJ,CAAiBR,SAASg4C,UAA1B,CAAZ;AACD;;AAED,WAAK,IAAIz9C,IAAI,CAAb,EAAgBA,IAAIu9C,MAApB,EAA4Bv9C,GAA5B,EAAiC;AAC/B,YAAI09C,iBAAiBv6B,KAAKnjB,CAAL,EAAQmC,IAA7B;;AAEA,aAAK,IAAI6Q,IAAI,CAAb,EAAgBA,IAAI0qC,eAAex9C,MAAnC,EAA2C8S,GAA3C,EAAgD;AAC9C,eAAK7Q,IAAL,CAAUsD,QAAV,IAAsBi4C,eAAe1qC,CAAf,CAAtB;AACD;AACF;;AAED,WAAKqE,IAAL,GAAY5R,MAAZ;AACD,KA5RmB;;AA8RpB;;;;AAIA62C,aAAS,iBAAUqB,GAAV,EAAe;AACtB,UAAI,CAAC,KAAKjC,SAAV,EAAqB;AACnB;AACD;;AAED,UAAIv5C,OAAO,KAAKA,IAAhB;;AAEA,UAAI,KAAKkV,IAAL,GAAYvU,UAAU5C,MAAtB,GAA+BiC,KAAKjC,MAAxC,EAAgD;AAC9C;AACA;AACA,aAAK09C,WAAL;;AAEAz7C,eAAO,KAAKA,IAAZ;AACD;;AAED,WAAK,IAAInC,IAAI,CAAb,EAAgBA,IAAI8C,UAAU5C,MAA9B,EAAsCF,GAAtC,EAA2C;AACzCmC,aAAK,KAAKkV,IAAL,EAAL,IAAoBvU,UAAU9C,CAAV,CAApB;AACD;;AAED,WAAK69C,QAAL,GAAgBF,GAAhB;AACD,KAtTmB;AAuTpBC,iBAAa,uBAAY;AACvB;AACA,UAAI,EAAE,KAAKz7C,IAAL,YAAqBzD,KAAvB,CAAJ,EAAmC;AACjC,YAAIo/C,UAAU,EAAd;;AAEA,aAAK,IAAI99C,IAAI,CAAb,EAAgBA,IAAI,KAAKqX,IAAzB,EAA+BrX,GAA/B,EAAoC;AAClC89C,kBAAQ99C,CAAR,IAAa,KAAKmC,IAAL,CAAUnC,CAAV,CAAb;AACD;;AAED,aAAKmC,IAAL,GAAY27C,OAAZ;AACD;AACF,KAlUmB;;AAoUpB;;;;;AAKAtB,gBAAY,sBAAY;AACtB,aAAO,KAAKP,SAAZ;AACD,KA3UmB;AA4UpBQ,mBAAe,uBAAUhF,EAAV,EAAcC,EAAd,EAAkB;AAC/B,UAAIqG,UAAU,KAAK3B,QAAnB;AACA,UAAI32C,SAAS,KAAKy2C,WAAlB;AACA,UAAItuB,WAAW,KAAKquB,SAApB;AACA,UAAI5xC,MAAM,KAAK5K,IAAf;AACA,UAAI83C,KAAK,KAAKoE,GAAd;AACA,UAAInE,KAAK,KAAKoE,GAAd;AACA,UAAItyC,KAAKmuC,KAAKF,EAAd;AACA,UAAIhuC,KAAKmuC,KAAKF,EAAd;AACA,UAAIwG,UAAU3C,WAAW/xC,KAAKA,EAAL,GAAUC,KAAKA,EAA1B,CAAd;AACA,UAAIpD,IAAIoxC,EAAR;AACA,UAAInxC,IAAIoxC,EAAR;AACA,UAAIyG,IAAJ;AACA,UAAIC,QAAQtwB,SAAS1tB,MAArB;AACA,UAAI+mB,GAAJ;AACA3d,YAAM00C,OAAN;AACAz0C,YAAMy0C,OAAN;;AAEA,UAAIv4C,SAAS,CAAb,EAAgB;AACd;AACAA,iBAASs4C,UAAUt4C,MAAnB;AACD;;AAEDA,gBAAUs4C,OAAV;AACA53C,WAAKV,SAAS6D,EAAd;AACAlD,WAAKX,SAAS8D,EAAd;;AAEA,aAAOD,KAAK,CAAL,IAAUnD,KAAKsxC,EAAf,IAAqBnuC,KAAK,CAAL,IAAUnD,KAAKsxC,EAApC,IAA0CnuC,MAAM,CAAN,KAAYC,KAAK,CAAL,IAAUnD,KAAKsxC,EAAf,IAAqBnuC,KAAK,CAAL,IAAUnD,KAAKsxC,EAAhD,CAAjD,EAAsG;AACpGzwB,cAAM,KAAKk1B,QAAX;AACA8B,eAAOrwB,SAAS3G,GAAT,CAAP;AACA9gB,aAAKmD,KAAK20C,IAAV;AACA73C,aAAKmD,KAAK00C,IAAV;AACA,aAAK9B,QAAL,GAAgB,CAACl1B,MAAM,CAAP,IAAYi3B,KAA5B,CALoG,CAKjE;;AAEnC,YAAI50C,KAAK,CAAL,IAAUnD,IAAIoxC,EAAd,IAAoBjuC,KAAK,CAAL,IAAUnD,IAAIoxC,EAAlC,IAAwChuC,KAAK,CAAL,IAAUnD,IAAIoxC,EAAtD,IAA4DjuC,KAAK,CAAL,IAAUnD,IAAIoxC,EAA9E,EAAkF;AAChF;AACD;;AAEDntC,YAAI4c,MAAM,CAAN,GAAU,QAAV,GAAqB,QAAzB,EAAmC3d,MAAM,CAAN,GAAU2xC,UAAU90C,CAAV,EAAasxC,EAAb,CAAV,GAA6ByD,UAAU/0C,CAAV,EAAasxC,EAAb,CAAhE,EAAkFluC,MAAM,CAAN,GAAU0xC,UAAU70C,CAAV,EAAasxC,EAAb,CAAV,GAA6BwD,UAAU90C,CAAV,EAAasxC,EAAb,CAA/G;AACD,OAvC8B,CAuC7B;;;AAGFpuC,WAAKnD,IAAIsxC,EAAT;AACAluC,WAAKnD,IAAIsxC,EAAT;AACA,WAAKwE,WAAL,GAAmB,CAACb,WAAW/xC,KAAKA,EAAL,GAAUC,KAAKA,EAA1B,CAApB;AACD,KAzXmB;AA0XpB;AACAozC,qBAAiB,yBAAUlF,EAAV,EAAcC,EAAd,EAAkBrqB,EAAlB,EAAsBC,EAAtB,EAA0BqqB,EAA1B,EAA8BC,EAA9B,EAAkC;AACjD,UAAImG,UAAU,KAAK3B,QAAnB;AACA,UAAI32C,SAAS,KAAKy2C,WAAlB;AACA,UAAItuB,WAAW,KAAKquB,SAApB;AACA,UAAI5xC,MAAM,KAAK5K,IAAf;AACA,UAAI83C,KAAK,KAAKoE,GAAd;AACA,UAAInE,KAAK,KAAKoE,GAAd;AACA,UAAI7zC,CAAJ;AACA,UAAIuB,EAAJ;AACA,UAAIC,EAAJ;AACA,UAAIiwC,aAAa5D,OAAjB;AACA,UAAIuI,YAAY,CAAhB;AACA,UAAIl3B,MAAM,KAAKk1B,QAAf;AACA,UAAI+B,QAAQtwB,SAAS1tB,MAArB;AACA,UAAIiG,CAAJ;AACA,UAAIC,CAAJ;AACA,UAAIg4C,SAAS,CAAb;;AAEA,UAAI34C,SAAS,CAAb,EAAgB;AACd;AACAA,iBAASs4C,UAAUt4C,MAAnB;AACD;;AAEDA,gBAAUs4C,OAAV,CAvBiD,CAuB9B;;AAEnB,WAAKh2C,IAAI,CAAT,EAAYA,IAAI,CAAhB,EAAmBA,KAAK,GAAxB,EAA6B;AAC3BuB,aAAKkwC,WAAWjC,EAAX,EAAeE,EAAf,EAAmBpqB,EAAnB,EAAuBsqB,EAAvB,EAA2B5vC,IAAI,GAA/B,IAAsCyxC,WAAWjC,EAAX,EAAeE,EAAf,EAAmBpqB,EAAnB,EAAuBsqB,EAAvB,EAA2B5vC,CAA3B,CAA3C;AACAwB,aAAKiwC,WAAWhC,EAAX,EAAeE,EAAf,EAAmBpqB,EAAnB,EAAuBsqB,EAAvB,EAA2B7vC,IAAI,GAA/B,IAAsCyxC,WAAWhC,EAAX,EAAeE,EAAf,EAAmBpqB,EAAnB,EAAuBsqB,EAAvB,EAA2B7vC,CAA3B,CAA3C;AACAo2C,qBAAa9C,WAAW/xC,KAAKA,EAAL,GAAUC,KAAKA,EAA1B,CAAb;AACD,OA7BgD,CA6B/C;;;AAGF,aAAO0d,MAAMi3B,KAAb,EAAoBj3B,KAApB,EAA2B;AACzBm3B,kBAAUxwB,SAAS3G,GAAT,CAAV;;AAEA,YAAIm3B,SAAS34C,MAAb,EAAqB;AACnB;AACD;AACF;;AAEDsC,UAAI,CAACq2C,SAAS34C,MAAV,IAAoB04C,SAAxB;;AAEA,aAAOp2C,KAAK,CAAZ,EAAe;AACb5B,YAAIqzC,WAAWjC,EAAX,EAAeE,EAAf,EAAmBpqB,EAAnB,EAAuBsqB,EAAvB,EAA2B5vC,CAA3B,CAAJ;AACA3B,YAAIozC,WAAWhC,EAAX,EAAeE,EAAf,EAAmBpqB,EAAnB,EAAuBsqB,EAAvB,EAA2B7vC,CAA3B,CAAJ,CAFa,CAEsB;AACnC;;AAEAkf,cAAM,CAAN,GAAU5c,IAAIkwB,MAAJ,CAAWp0B,CAAX,EAAcC,CAAd,CAAV,GAA6BiE,IAAImwB,MAAJ,CAAWr0B,CAAX,EAAcC,CAAd,CAA7B;AACA2B,aAAK6lB,SAAS3G,GAAT,IAAgBk3B,SAArB;AACAl3B,cAAM,CAACA,MAAM,CAAP,IAAYi3B,KAAlB;AACD,OAlDgD,CAkD/C;;;AAGFj3B,YAAM,CAAN,KAAY,CAAZ,IAAiB5c,IAAImwB,MAAJ,CAAWmd,EAAX,EAAeC,EAAf,CAAjB;AACAtuC,WAAKquC,KAAKxxC,CAAV;AACAoD,WAAKquC,KAAKxxC,CAAV;AACA,WAAK81C,WAAL,GAAmB,CAACb,WAAW/xC,KAAKA,EAAL,GAAUC,KAAKA,EAA1B,CAApB;AACD,KApbmB;AAqbpBszC,wBAAoB,4BAAUpF,EAAV,EAAcC,EAAd,EAAkBrqB,EAAlB,EAAsBC,EAAtB,EAA0B;AAC5C;AACA,UAAIqqB,KAAKtqB,EAAT;AACA,UAAIuqB,KAAKtqB,EAAT;AACAD,WAAK,CAACA,KAAK,IAAIoqB,EAAV,IAAgB,CAArB;AACAnqB,WAAK,CAACA,KAAK,IAAIoqB,EAAV,IAAgB,CAArB;AACAD,WAAK,CAAC,KAAKkE,GAAL,GAAW,IAAIlE,EAAhB,IAAsB,CAA3B;AACAC,WAAK,CAAC,KAAKkE,GAAL,GAAW,IAAIlE,EAAhB,IAAsB,CAA3B;;AAEA,WAAKiF,eAAL,CAAqBlF,EAArB,EAAyBC,EAAzB,EAA6BrqB,EAA7B,EAAiCC,EAAjC,EAAqCqqB,EAArC,EAAyCC,EAAzC;AACD,KA/bmB;;AAicpB;;;;AAIAsF,cAAU,oBAAY;AACpB,UAAI/6C,OAAO,KAAKA,IAAhB;;AAEA,UAAIA,gBAAgBzD,KAApB,EAA2B;AACzByD,aAAKjC,MAAL,GAAc,KAAKmX,IAAnB;;AAEA,YAAIkkC,aAAJ,EAAmB;AACjB,eAAKp5C,IAAL,GAAY,IAAI8D,YAAJ,CAAiB9D,IAAjB,CAAZ;AACD;AACF;AACF,KA/cmB;;AAidpB;;;AAGA2lB,qBAAiB,2BAAY;AAC3B+yB,YAAM,CAAN,IAAWA,MAAM,CAAN,IAAWE,KAAK,CAAL,IAAUA,KAAK,CAAL,IAAUsD,OAAOC,SAAjD;AACAxD,YAAM,CAAN,IAAWA,MAAM,CAAN,IAAWE,KAAK,CAAL,IAAUA,KAAK,CAAL,IAAU,CAACqD,OAAOC,SAAlD;AACA,UAAIn8C,OAAO,KAAKA,IAAhB;AACA,UAAIo8C,KAAK,CAAT;AACA,UAAIC,KAAK,CAAT;AACA,UAAIjH,KAAK,CAAT;AACA,UAAIC,KAAK,CAAT;;AAEA,WAAK,IAAIx3C,IAAI,CAAb,EAAgBA,IAAImC,KAAKjC,MAAzB,GAAkC;AAChC,YAAIy9C,MAAMx7C,KAAKnC,GAAL,CAAV;;AAEA,YAAIA,KAAK,CAAT,EAAY;AACV;AACA;AACA;AACA;AACAu+C,eAAKp8C,KAAKnC,CAAL,CAAL;AACAw+C,eAAKr8C,KAAKnC,IAAI,CAAT,CAAL;AACAu3C,eAAKgH,EAAL;AACA/G,eAAKgH,EAAL;AACD;;AAED,gBAAQb,GAAR;AACE,eAAKlD,IAAIC,CAAT;AACE;AACA;AACAnD,iBAAKp1C,KAAKnC,GAAL,CAAL;AACAw3C,iBAAKr1C,KAAKnC,GAAL,CAAL;AACAu+C,iBAAKhH,EAAL;AACAiH,iBAAKhH,EAAL;AACAuD,iBAAK,CAAL,IAAUxD,EAAV;AACAwD,iBAAK,CAAL,IAAUvD,EAAV;AACAwD,iBAAK,CAAL,IAAUzD,EAAV;AACAyD,iBAAK,CAAL,IAAUxD,EAAV;AACA;;AAEF,eAAKiD,IAAIp/B,CAAT;AACE89B,qBAASoF,EAAT,EAAaC,EAAb,EAAiBr8C,KAAKnC,CAAL,CAAjB,EAA0BmC,KAAKnC,IAAI,CAAT,CAA1B,EAAuC+6C,IAAvC,EAA6CC,IAA7C;AACAuD,iBAAKp8C,KAAKnC,GAAL,CAAL;AACAw+C,iBAAKr8C,KAAKnC,GAAL,CAAL;AACA;;AAEF,eAAKy6C,IAAIvE,CAAT;AACEoD,sBAAUiF,EAAV,EAAcC,EAAd,EAAkBr8C,KAAKnC,GAAL,CAAlB,EAA6BmC,KAAKnC,GAAL,CAA7B,EAAwCmC,KAAKnC,GAAL,CAAxC,EAAmDmC,KAAKnC,GAAL,CAAnD,EAA8DmC,KAAKnC,CAAL,CAA9D,EAAuEmC,KAAKnC,IAAI,CAAT,CAAvE,EAAoF+6C,IAApF,EAA0FC,IAA1F;AACAuD,iBAAKp8C,KAAKnC,GAAL,CAAL;AACAw+C,iBAAKr8C,KAAKnC,GAAL,CAAL;AACA;;AAEF,eAAKy6C,IAAIE,CAAT;AACElB,0BAAc8E,EAAd,EAAkBC,EAAlB,EAAsBr8C,KAAKnC,GAAL,CAAtB,EAAiCmC,KAAKnC,GAAL,CAAjC,EAA4CmC,KAAKnC,CAAL,CAA5C,EAAqDmC,KAAKnC,IAAI,CAAT,CAArD,EAAkE+6C,IAAlE,EAAwEC,IAAxE;AACAuD,iBAAKp8C,KAAKnC,GAAL,CAAL;AACAw+C,iBAAKr8C,KAAKnC,GAAL,CAAL;AACA;;AAEF,eAAKy6C,IAAIxE,CAAT;AACE;AACA,gBAAI6G,KAAK36C,KAAKnC,GAAL,CAAT;AACA,gBAAI+8C,KAAK56C,KAAKnC,GAAL,CAAT;AACA,gBAAI+5C,KAAK53C,KAAKnC,GAAL,CAAT;AACA,gBAAIg6C,KAAK73C,KAAKnC,GAAL,CAAT;AACA,gBAAIi6C,aAAa93C,KAAKnC,GAAL,CAAjB;AACA,gBAAIk6C,WAAW/3C,KAAKnC,GAAL,IAAYi6C,UAA3B,CAPF,CAOyC;;AAEvC,gBAAIwE,MAAMt8C,KAAKnC,GAAL,CAAV;AACA,gBAAIm6C,gBAAgB,IAAIh4C,KAAKnC,GAAL,CAAxB;;AAEA,gBAAIA,KAAK,CAAT,EAAY;AACV;AACA;AACAu3C,mBAAK4D,UAAUlB,UAAV,IAAwBF,EAAxB,GAA6B+C,EAAlC;AACAtF,mBAAK4D,UAAUnB,UAAV,IAAwBD,EAAxB,GAA6B+C,EAAlC;AACD;;AAEDjD,oBAAQgD,EAAR,EAAYC,EAAZ,EAAgBhD,EAAhB,EAAoBC,EAApB,EAAwBC,UAAxB,EAAoCC,QAApC,EAA8CC,aAA9C,EAA6DY,IAA7D,EAAmEC,IAAnE;AACAuD,iBAAKpD,UAAUjB,QAAV,IAAsBH,EAAtB,GAA2B+C,EAAhC;AACA0B,iBAAKpD,UAAUlB,QAAV,IAAsBF,EAAtB,GAA2B+C,EAAhC;AACA;;AAEF,eAAKtC,IAAI1/B,CAAT;AACEw8B,iBAAKgH,KAAKp8C,KAAKnC,GAAL,CAAV;AACAw3C,iBAAKgH,KAAKr8C,KAAKnC,GAAL,CAAV;AACA,gBAAIqlB,QAAQljB,KAAKnC,GAAL,CAAZ;AACA,gBAAIslB,SAASnjB,KAAKnC,GAAL,CAAb,CAJF,CAI0B;;AAExBm5C,qBAAS5B,EAAT,EAAaC,EAAb,EAAiBD,KAAKlyB,KAAtB,EAA6BmyB,KAAKlyB,MAAlC,EAA0Cy1B,IAA1C,EAAgDC,IAAhD;AACA;;AAEF,eAAKP,IAAIG,CAAT;AACE2D,iBAAKhH,EAAL;AACAiH,iBAAKhH,EAAL;AACA;AApEJ,SAdgC,CAmF9B;;;AAGFtvC,YAAI2yC,KAAJ,EAAWA,KAAX,EAAkBE,IAAlB;AACA5yC,YAAI2yC,KAAJ,EAAWA,KAAX,EAAkBE,IAAlB;AACD,OAjG0B,CAiGzB;;;AAGF,UAAIh7C,MAAM,CAAV,EAAa;AACX66C,cAAM,CAAN,IAAWA,MAAM,CAAN,IAAWC,MAAM,CAAN,IAAWA,MAAM,CAAN,IAAW,CAA5C;AACD;;AAED,aAAO,IAAI11B,YAAJ,CAAiBy1B,MAAM,CAAN,CAAjB,EAA2BA,MAAM,CAAN,CAA3B,EAAqCC,MAAM,CAAN,IAAWD,MAAM,CAAN,CAAhD,EAA0DC,MAAM,CAAN,IAAWD,MAAM,CAAN,CAArE,CAAP;AACD,KA7jBmB;;AA+jBpB;;;;;AAKA6D,iBAAa,qBAAUr0C,GAAV,EAAe;AAC1B,UAAI7C,IAAI,KAAKrF,IAAb;AACA,UAAIo1C,EAAJ,EAAQC,EAAR;AACA,UAAI+G,EAAJ,EAAQC,EAAR;AACA,UAAIr4C,CAAJ,EAAOC,CAAP;AACA,UAAIu4C,KAAK,KAAK5C,GAAd;AACA,UAAI6C,KAAK,KAAK5C,GAAd;AACA,UAAIuB,SAAS,KAAKlmC,IAAlB;;AAEA,WAAK,IAAIrX,IAAI,CAAb,EAAgBA,IAAIu9C,MAApB,GAA6B;AAC3B,YAAII,MAAMn2C,EAAExH,GAAF,CAAV;;AAEA,YAAIA,KAAK,CAAT,EAAY;AACV;AACA;AACA;AACA;AACAu+C,eAAK/2C,EAAExH,CAAF,CAAL;AACAw+C,eAAKh3C,EAAExH,IAAI,CAAN,CAAL;AACAu3C,eAAKgH,EAAL;AACA/G,eAAKgH,EAAL;AACD;;AAED,gBAAQb,GAAR;AACE,eAAKlD,IAAIC,CAAT;AACEnD,iBAAKgH,KAAK/2C,EAAExH,GAAF,CAAV;AACAw3C,iBAAKgH,KAAKh3C,EAAExH,GAAF,CAAV;AACAqK,gBAAIkwB,MAAJ,CAAWgkB,EAAX,EAAeC,EAAf;AACA;;AAEF,eAAK/D,IAAIp/B,CAAT;AACElV,gBAAIqB,EAAExH,GAAF,CAAJ;AACAoG,gBAAIoB,EAAExH,GAAF,CAAJ,CAFF,CAEc;;AAEZ,gBAAIs7C,QAAQn1C,IAAIo4C,EAAZ,IAAkBI,EAAlB,IAAwBrD,QAAQl1C,IAAIo4C,EAAZ,IAAkBI,EAA1C,IAAgD5+C,MAAMu9C,SAAS,CAAnE,EAAsE;AACpElzC,kBAAImwB,MAAJ,CAAWr0B,CAAX,EAAcC,CAAd;AACAm4C,mBAAKp4C,CAAL;AACAq4C,mBAAKp4C,CAAL;AACD;;AAED;;AAEF,eAAKq0C,IAAIvE,CAAT;AACE7rC,gBAAIqyC,aAAJ,CAAkBl1C,EAAExH,GAAF,CAAlB,EAA0BwH,EAAExH,GAAF,CAA1B,EAAkCwH,EAAExH,GAAF,CAAlC,EAA0CwH,EAAExH,GAAF,CAA1C,EAAkDwH,EAAExH,GAAF,CAAlD,EAA0DwH,EAAExH,GAAF,CAA1D;AACAu+C,iBAAK/2C,EAAExH,IAAI,CAAN,CAAL;AACAw+C,iBAAKh3C,EAAExH,IAAI,CAAN,CAAL;AACA;;AAEF,eAAKy6C,IAAIE,CAAT;AACEtwC,gBAAIuyC,gBAAJ,CAAqBp1C,EAAExH,GAAF,CAArB,EAA6BwH,EAAExH,GAAF,CAA7B,EAAqCwH,EAAExH,GAAF,CAArC,EAA6CwH,EAAExH,GAAF,CAA7C;AACAu+C,iBAAK/2C,EAAExH,IAAI,CAAN,CAAL;AACAw+C,iBAAKh3C,EAAExH,IAAI,CAAN,CAAL;AACA;;AAEF,eAAKy6C,IAAIxE,CAAT;AACE,gBAAI6G,KAAKt1C,EAAExH,GAAF,CAAT;AACA,gBAAI+8C,KAAKv1C,EAAExH,GAAF,CAAT;AACA,gBAAI+5C,KAAKvyC,EAAExH,GAAF,CAAT;AACA,gBAAIg6C,KAAKxyC,EAAExH,GAAF,CAAT;AACA,gBAAI02C,QAAQlvC,EAAExH,GAAF,CAAZ;AACA,gBAAI6+C,SAASr3C,EAAExH,GAAF,CAAb;AACA,gBAAIy+C,MAAMj3C,EAAExH,GAAF,CAAV;AACA,gBAAI8+C,KAAKt3C,EAAExH,GAAF,CAAT;AACA,gBAAIuZ,IAAIwgC,KAAKC,EAAL,GAAUD,EAAV,GAAeC,EAAvB;AACA,gBAAI+E,SAAShF,KAAKC,EAAL,GAAU,CAAV,GAAcD,KAAKC,EAAhC;AACA,gBAAIgF,SAASjF,KAAKC,EAAL,GAAUA,KAAKD,EAAf,GAAoB,CAAjC;AACA,gBAAIkF,YAAYn4C,KAAKyzC,GAAL,CAASR,KAAKC,EAAd,IAAoB,IAApC;AACA,gBAAIE,WAAWxD,QAAQmI,MAAvB;;AAEA,gBAAII,SAAJ,EAAe;AACb50C,kBAAI0F,SAAJ,CAAc+sC,EAAd,EAAkBC,EAAlB;AACA1yC,kBAAI2F,MAAJ,CAAWyuC,GAAX;AACAp0C,kBAAIhD,KAAJ,CAAU03C,MAAV,EAAkBC,MAAlB;AACA30C,kBAAIowB,GAAJ,CAAQ,CAAR,EAAW,CAAX,EAAclhB,CAAd,EAAiBm9B,KAAjB,EAAwBwD,QAAxB,EAAkC,IAAI4E,EAAtC;AACAz0C,kBAAIhD,KAAJ,CAAU,IAAI03C,MAAd,EAAsB,IAAIC,MAA1B;AACA30C,kBAAI2F,MAAJ,CAAW,CAACyuC,GAAZ;AACAp0C,kBAAI0F,SAAJ,CAAc,CAAC+sC,EAAf,EAAmB,CAACC,EAApB;AACD,aARD,MAQO;AACL1yC,kBAAIowB,GAAJ,CAAQqiB,EAAR,EAAYC,EAAZ,EAAgBxjC,CAAhB,EAAmBm9B,KAAnB,EAA0BwD,QAA1B,EAAoC,IAAI4E,EAAxC;AACD;;AAED,gBAAI9+C,KAAK,CAAT,EAAY;AACV;AACA;AACAu3C,mBAAK4D,UAAUzE,KAAV,IAAmBqD,EAAnB,GAAwB+C,EAA7B;AACAtF,mBAAK4D,UAAU1E,KAAV,IAAmBsD,EAAnB,GAAwB+C,EAA7B;AACD;;AAEDwB,iBAAKpD,UAAUjB,QAAV,IAAsBH,EAAtB,GAA2B+C,EAAhC;AACA0B,iBAAKpD,UAAUlB,QAAV,IAAsBF,EAAtB,GAA2B+C,EAAhC;AACA;;AAEF,eAAKtC,IAAI1/B,CAAT;AACEw8B,iBAAKgH,KAAK/2C,EAAExH,CAAF,CAAV;AACAw3C,iBAAKgH,KAAKh3C,EAAExH,IAAI,CAAN,CAAV;AACAqK,gBAAIoc,IAAJ,CAASjf,EAAExH,GAAF,CAAT,EAAiBwH,EAAExH,GAAF,CAAjB,EAAyBwH,EAAExH,GAAF,CAAzB,EAAiCwH,EAAExH,GAAF,CAAjC;AACA;;AAEF,eAAKy6C,IAAIG,CAAT;AACEvwC,gBAAI8yB,SAAJ;AACAohB,iBAAKhH,EAAL;AACAiH,iBAAKhH,EAAL;AA9EJ;AAgFD;AACF;AA5qBmB,GAAtB;AA8qBAgE,YAAUf,GAAV,GAAgBA,GAAhB;;AAEA;;;;;;;;;;;AAWA,WAASyE,eAAT,CAAyB3H,EAAzB,EAA6BC,EAA7B,EAAiCC,EAAjC,EAAqCC,EAArC,EAAyCzpB,SAAzC,EAAoD9nB,CAApD,EAAuDC,CAAvD,EAA0D;AACxD,QAAI6nB,cAAc,CAAlB,EAAqB;AACnB,aAAO,KAAP;AACD;;AAED,QAAIkxB,KAAKlxB,SAAT;AACA,QAAImxB,KAAK,CAAT;AACA,QAAIC,KAAK9H,EAAT,CAPwD,CAO3C;;AAEb,QAAInxC,IAAIoxC,KAAK2H,EAAT,IAAe/4C,IAAIsxC,KAAKyH,EAAxB,IAA8B/4C,IAAIoxC,KAAK2H,EAAT,IAAe/4C,IAAIsxC,KAAKyH,EAAtD,IAA4Dh5C,IAAIoxC,KAAK4H,EAAT,IAAeh5C,IAAIsxC,KAAK0H,EAApF,IAA0Fh5C,IAAIoxC,KAAK4H,EAAT,IAAeh5C,IAAIsxC,KAAK0H,EAAtH,EAA0H;AACxH,aAAO,KAAP;AACD;;AAED,QAAI5H,OAAOE,EAAX,EAAe;AACb2H,WAAK,CAAC5H,KAAKE,EAAN,KAAaH,KAAKE,EAAlB,CAAL;AACA4H,WAAK,CAAC9H,KAAKG,EAAL,GAAUD,KAAKD,EAAhB,KAAuBD,KAAKE,EAA5B,CAAL;AACD,KAHD,MAGO;AACL,aAAO3wC,KAAKyzC,GAAL,CAASp0C,IAAIoxC,EAAb,KAAoB4H,KAAK,CAAhC;AACD;;AAED,QAAI51B,MAAM61B,KAAKj5C,CAAL,GAASC,CAAT,GAAai5C,EAAvB;;AAEA,QAAIC,KAAK/1B,MAAMA,GAAN,IAAa61B,KAAKA,EAAL,GAAU,CAAvB,CAAT;;AAEA,WAAOE,MAAMH,KAAK,CAAL,GAASA,EAAT,GAAc,CAA3B;AACD;;AAED;;;;;;;;;;;;;;;;AAgBA,WAASI,eAAT,CAAyBhI,EAAzB,EAA6BC,EAA7B,EAAiCC,EAAjC,EAAqCC,EAArC,EAAyCrqB,EAAzC,EAA6CC,EAA7C,EAAiDqqB,EAAjD,EAAqDC,EAArD,EAAyD3pB,SAAzD,EAAoE9nB,CAApE,EAAuEC,CAAvE,EAA0E;AACxE,QAAI6nB,cAAc,CAAlB,EAAqB;AACnB,aAAO,KAAP;AACD;;AAED,QAAIkxB,KAAKlxB,SAAT,CALwE,CAKpD;;AAEpB,QAAI7nB,IAAIoxC,KAAK2H,EAAT,IAAe/4C,IAAIsxC,KAAKyH,EAAxB,IAA8B/4C,IAAIknB,KAAK6xB,EAAvC,IAA6C/4C,IAAIwxC,KAAKuH,EAAtD,IAA4D/4C,IAAIoxC,KAAK2H,EAAT,IAAe/4C,IAAIsxC,KAAKyH,EAAxB,IAA8B/4C,IAAIknB,KAAK6xB,EAAvC,IAA6C/4C,IAAIwxC,KAAKuH,EAAlH,IAAwHh5C,IAAIoxC,KAAK4H,EAAT,IAAeh5C,IAAIsxC,KAAK0H,EAAxB,IAA8Bh5C,IAAIknB,KAAK8xB,EAAvC,IAA6Ch5C,IAAIwxC,KAAKwH,EAA9K,IAAoLh5C,IAAIoxC,KAAK4H,EAAT,IAAeh5C,IAAIsxC,KAAK0H,EAAxB,IAA8Bh5C,IAAIknB,KAAK8xB,EAAvC,IAA6Ch5C,IAAIwxC,KAAKwH,EAA9O,EAAkP;AAChP,aAAO,KAAP;AACD;;AAED,QAAI33C,IAAI8vC,kBAAkBC,EAAlB,EAAsBC,EAAtB,EAA0BC,EAA1B,EAA8BC,EAA9B,EAAkCrqB,EAAlC,EAAsCC,EAAtC,EAA0CqqB,EAA1C,EAA8CC,EAA9C,EAAkDzxC,CAAlD,EAAqDC,CAArD,EAAwD,IAAxD,CAAR;AACA,WAAOoB,KAAK23C,KAAK,CAAjB;AACD;;AAED;;;;;;;;;;;;;;AAcA,WAASK,eAAT,CAAyBjI,EAAzB,EAA6BC,EAA7B,EAAiCC,EAAjC,EAAqCC,EAArC,EAAyCrqB,EAAzC,EAA6CC,EAA7C,EAAiDW,SAAjD,EAA4D9nB,CAA5D,EAA+DC,CAA/D,EAAkE;AAChE,QAAI6nB,cAAc,CAAlB,EAAqB;AACnB,aAAO,KAAP;AACD;;AAED,QAAIkxB,KAAKlxB,SAAT,CALgE,CAK5C;;AAEpB,QAAI7nB,IAAIoxC,KAAK2H,EAAT,IAAe/4C,IAAIsxC,KAAKyH,EAAxB,IAA8B/4C,IAAIknB,KAAK6xB,EAAvC,IAA6C/4C,IAAIoxC,KAAK2H,EAAT,IAAe/4C,IAAIsxC,KAAKyH,EAAxB,IAA8B/4C,IAAIknB,KAAK6xB,EAApF,IAA0Fh5C,IAAIoxC,KAAK4H,EAAT,IAAeh5C,IAAIsxC,KAAK0H,EAAxB,IAA8Bh5C,IAAIknB,KAAK8xB,EAAjI,IAAuIh5C,IAAIoxC,KAAK4H,EAAT,IAAeh5C,IAAIsxC,KAAK0H,EAAxB,IAA8Bh5C,IAAIknB,KAAK8xB,EAAlL,EAAsL;AACpL,aAAO,KAAP;AACD;;AAED,QAAI33C,IAAIgxC,sBAAsBjB,EAAtB,EAA0BC,EAA1B,EAA8BC,EAA9B,EAAkCC,EAAlC,EAAsCrqB,EAAtC,EAA0CC,EAA1C,EAA8CnnB,CAA9C,EAAiDC,CAAjD,EAAoD,IAApD,CAAR;AACA,WAAOoB,KAAK23C,KAAK,CAAjB;AACD;;AAED,MAAIM,QAAQ34C,KAAKgN,EAAL,GAAU,CAAtB;AACA,WAAS4rC,eAAT,CAAyBlF,KAAzB,EAAgC;AAC9BA,aAASiF,KAAT;;AAEA,QAAIjF,QAAQ,CAAZ,EAAe;AACbA,eAASiF,KAAT;AACD;;AAED,WAAOjF,KAAP;AACD;;AAED,MAAImF,QAAQ74C,KAAKgN,EAAL,GAAU,CAAtB;AACA;;;;;;;;;;;;;;AAcA,WAAS8rC,eAAT,CAAyB9C,EAAzB,EAA6BC,EAA7B,EAAiCxjC,CAAjC,EAAoC0gC,UAApC,EAAgDC,QAAhD,EAA0DC,aAA1D,EAAyElsB,SAAzE,EAAoF9nB,CAApF,EAAuFC,CAAvF,EAA0F;AACxF,QAAI6nB,cAAc,CAAlB,EAAqB;AACnB,aAAO,KAAP;AACD;;AAED,QAAIkxB,KAAKlxB,SAAT;AACA9nB,SAAK22C,EAAL;AACA12C,SAAK22C,EAAL;AACA,QAAIv1C,IAAIV,KAAKC,IAAL,CAAUZ,IAAIA,CAAJ,GAAQC,IAAIA,CAAtB,CAAR;;AAEA,QAAIoB,IAAI23C,EAAJ,GAAS5lC,CAAT,IAAc/R,IAAI23C,EAAJ,GAAS5lC,CAA3B,EAA8B;AAC5B,aAAO,KAAP;AACD;;AAED,QAAIzS,KAAKyzC,GAAL,CAASN,aAAaC,QAAtB,IAAkCyF,KAAlC,GAA0C,IAA9C,EAAoD;AAClD;AACA,aAAO,IAAP;AACD;;AAED,QAAIxF,aAAJ,EAAmB;AACjB,UAAI5wB,MAAM0wB,UAAV;AACAA,mBAAayF,gBAAgBxF,QAAhB,CAAb;AACAA,iBAAWwF,gBAAgBn2B,GAAhB,CAAX;AACD,KAJD,MAIO;AACL0wB,mBAAayF,gBAAgBzF,UAAhB,CAAb;AACAC,iBAAWwF,gBAAgBxF,QAAhB,CAAX;AACD;;AAED,QAAID,aAAaC,QAAjB,EAA2B;AACzBA,kBAAYyF,KAAZ;AACD;;AAED,QAAInF,QAAQ1zC,KAAK4L,KAAL,CAAWtM,CAAX,EAAcD,CAAd,CAAZ;;AAEA,QAAIq0C,QAAQ,CAAZ,EAAe;AACbA,eAASmF,KAAT;AACD;;AAED,WAAOnF,SAASP,UAAT,IAAuBO,SAASN,QAAhC,IAA4CM,QAAQmF,KAAR,IAAiB1F,UAAjB,IAA+BO,QAAQmF,KAAR,IAAiBzF,QAAnG;AACD;;AAED,WAAS2F,WAAT,CAAqBtI,EAArB,EAAyBC,EAAzB,EAA6BC,EAA7B,EAAiCC,EAAjC,EAAqCvxC,CAArC,EAAwCC,CAAxC,EAA2C;AACzC,QAAIA,IAAIoxC,EAAJ,IAAUpxC,IAAIsxC,EAAd,IAAoBtxC,IAAIoxC,EAAJ,IAAUpxC,IAAIsxC,EAAtC,EAA0C;AACxC,aAAO,CAAP;AACD,KAHwC,CAGvC;;;AAGF,QAAIA,OAAOF,EAAX,EAAe;AACb,aAAO,CAAP;AACD;;AAED,QAAIsI,MAAMpI,KAAKF,EAAL,GAAU,CAAV,GAAc,CAAC,CAAzB;AACA,QAAIzvC,IAAI,CAAC3B,IAAIoxC,EAAL,KAAYE,KAAKF,EAAjB,CAAR,CAXyC,CAWX;;AAE9B,QAAIzvC,MAAM,CAAN,IAAWA,MAAM,CAArB,EAAwB;AACtB+3C,YAAMpI,KAAKF,EAAL,GAAU,GAAV,GAAgB,CAAC,GAAvB;AACD;;AAED,QAAIuI,KAAKh4C,KAAK0vC,KAAKF,EAAV,IAAgBA,EAAzB,CAjByC,CAiBZ;;AAE7B,WAAOwI,OAAO55C,CAAP,GAAW2xC,QAAX,GAAsBiI,KAAK55C,CAAL,GAAS25C,GAAT,GAAe,CAA5C;AACD;;AAED,MAAIE,QAAQxE,UAAUf,GAAtB;AACA,MAAIwF,QAAQn5C,KAAKgN,EAAL,GAAU,CAAtB;AACA,MAAIosC,YAAY,IAAhB;;AAEA,WAASC,aAAT,CAAuB76C,CAAvB,EAA0BC,CAA1B,EAA6B;AAC3B,WAAOuB,KAAKyzC,GAAL,CAASj1C,IAAIC,CAAb,IAAkB26C,SAAzB;AACD,GApwZ2B,CAowZ1B;;;AAGF,MAAIj0B,QAAQ,CAAC,CAAC,CAAF,EAAK,CAAC,CAAN,EAAS,CAAC,CAAV,CAAZ;AACA,MAAI6qB,UAAU,CAAC,CAAC,CAAF,EAAK,CAAC,CAAN,CAAd;;AAEA,WAASsJ,WAAT,GAAuB;AACrB,QAAI72B,MAAMutB,QAAQ,CAAR,CAAV;AACAA,YAAQ,CAAR,IAAaA,QAAQ,CAAR,CAAb;AACAA,YAAQ,CAAR,IAAavtB,GAAb;AACD;;AAED,WAAS82B,YAAT,CAAsB9I,EAAtB,EAA0BC,EAA1B,EAA8BC,EAA9B,EAAkCC,EAAlC,EAAsCrqB,EAAtC,EAA0CC,EAA1C,EAA8CqqB,EAA9C,EAAkDC,EAAlD,EAAsDzxC,CAAtD,EAAyDC,CAAzD,EAA4D;AAC1D;AACA,QAAIA,IAAIoxC,EAAJ,IAAUpxC,IAAIsxC,EAAd,IAAoBtxC,IAAIknB,EAAxB,IAA8BlnB,IAAIwxC,EAAlC,IAAwCxxC,IAAIoxC,EAAJ,IAAUpxC,IAAIsxC,EAAd,IAAoBtxC,IAAIknB,EAAxB,IAA8BlnB,IAAIwxC,EAA9E,EAAkF;AAChF,aAAO,CAAP;AACD;;AAED,QAAI0I,SAASvK,YAAYyB,EAAZ,EAAgBE,EAAhB,EAAoBpqB,EAApB,EAAwBsqB,EAAxB,EAA4BxxC,CAA5B,EAA+B6lB,KAA/B,CAAb;;AAEA,QAAIq0B,WAAW,CAAf,EAAkB;AAChB,aAAO,CAAP;AACD,KAFD,MAEO;AACL,UAAIz/B,IAAI,CAAR;AACA,UAAI0/B,WAAW,CAAC,CAAhB;AACA,UAAIC,GAAJ,EAASC,GAAT;;AAEA,WAAK,IAAIzgD,IAAI,CAAb,EAAgBA,IAAIsgD,MAApB,EAA4BtgD,GAA5B,EAAiC;AAC/B,YAAI+H,IAAIkkB,MAAMjsB,CAAN,CAAR,CAD+B,CACb;;AAElB,YAAI0gD,OAAO34C,MAAM,CAAN,IAAWA,MAAM,CAAjB,GAAqB,GAArB,GAA2B,CAAtC;AACA,YAAIg4C,KAAKnK,QAAQ2B,EAAR,EAAYE,EAAZ,EAAgBpqB,EAAhB,EAAoBsqB,EAApB,EAAwB5vC,CAAxB,CAAT;;AAEA,YAAIg4C,KAAK55C,CAAT,EAAY;AACV;AACA;AACD;;AAED,YAAIo6C,WAAW,CAAf,EAAkB;AAChBA,qBAAW1J,aAAaW,EAAb,EAAiBE,EAAjB,EAAqBpqB,EAArB,EAAyBsqB,EAAzB,EAA6Bd,OAA7B,CAAX;;AAEA,cAAIA,QAAQ,CAAR,IAAaA,QAAQ,CAAR,CAAb,IAA2ByJ,WAAW,CAA1C,EAA6C;AAC3CH;AACD;;AAEDI,gBAAM5K,QAAQ4B,EAAR,EAAYE,EAAZ,EAAgBpqB,EAAhB,EAAoBsqB,EAApB,EAAwBd,QAAQ,CAAR,CAAxB,CAAN;;AAEA,cAAIyJ,WAAW,CAAf,EAAkB;AAChBE,kBAAM7K,QAAQ4B,EAAR,EAAYE,EAAZ,EAAgBpqB,EAAhB,EAAoBsqB,EAApB,EAAwBd,QAAQ,CAAR,CAAxB,CAAN;AACD;AACF;;AAED,YAAIyJ,YAAY,CAAhB,EAAmB;AACjB;AACA,cAAIx4C,IAAI+uC,QAAQ,CAAR,CAAR,EAAoB;AAClBj2B,iBAAK2/B,MAAMhJ,EAAN,GAAWkJ,IAAX,GAAkB,CAACA,IAAxB;AACD,WAFD,MAEO,IAAI34C,IAAI+uC,QAAQ,CAAR,CAAR,EAAoB;AACzBj2B,iBAAK4/B,MAAMD,GAAN,GAAYE,IAAZ,GAAmB,CAACA,IAAzB;AACD,WAFM,MAEA;AACL7/B,iBAAK+2B,KAAK6I,GAAL,GAAWC,IAAX,GAAkB,CAACA,IAAxB;AACD;AACF,SATD,MASO;AACL;AACA,cAAI34C,IAAI+uC,QAAQ,CAAR,CAAR,EAAoB;AAClBj2B,iBAAK2/B,MAAMhJ,EAAN,GAAWkJ,IAAX,GAAkB,CAACA,IAAxB;AACD,WAFD,MAEO;AACL7/B,iBAAK+2B,KAAK4I,GAAL,GAAWE,IAAX,GAAkB,CAACA,IAAxB;AACD;AACF;AACF;;AAED,aAAO7/B,CAAP;AACD;AACF;;AAED,WAAS8/B,gBAAT,CAA0BpJ,EAA1B,EAA8BC,EAA9B,EAAkCC,EAAlC,EAAsCC,EAAtC,EAA0CrqB,EAA1C,EAA8CC,EAA9C,EAAkDnnB,CAAlD,EAAqDC,CAArD,EAAwD;AACtD;AACA,QAAIA,IAAIoxC,EAAJ,IAAUpxC,IAAIsxC,EAAd,IAAoBtxC,IAAIknB,EAAxB,IAA8BlnB,IAAIoxC,EAAJ,IAAUpxC,IAAIsxC,EAAd,IAAoBtxC,IAAIknB,EAA1D,EAA8D;AAC5D,aAAO,CAAP;AACD;;AAED,QAAIgzB,SAASlI,gBAAgBZ,EAAhB,EAAoBE,EAApB,EAAwBpqB,EAAxB,EAA4BlnB,CAA5B,EAA+B6lB,KAA/B,CAAb;;AAEA,QAAIq0B,WAAW,CAAf,EAAkB;AAChB,aAAO,CAAP;AACD,KAFD,MAEO;AACL,UAAIv4C,IAAIswC,kBAAkBb,EAAlB,EAAsBE,EAAtB,EAA0BpqB,EAA1B,CAAR;;AAEA,UAAIvlB,KAAK,CAAL,IAAUA,KAAK,CAAnB,EAAsB;AACpB,YAAI8Y,IAAI,CAAR;AACA,YAAI+/B,KAAK1I,YAAYV,EAAZ,EAAgBE,EAAhB,EAAoBpqB,EAApB,EAAwBvlB,CAAxB,CAAT;;AAEA,aAAK,IAAI/H,IAAI,CAAb,EAAgBA,IAAIsgD,MAApB,EAA4BtgD,GAA5B,EAAiC;AAC/B;AACA,cAAI0gD,OAAOz0B,MAAMjsB,CAAN,MAAa,CAAb,IAAkBisB,MAAMjsB,CAAN,MAAa,CAA/B,GAAmC,GAAnC,GAAyC,CAApD;AACA,cAAI+/C,KAAK7H,YAAYX,EAAZ,EAAgBE,EAAhB,EAAoBpqB,EAApB,EAAwBpB,MAAMjsB,CAAN,CAAxB,CAAT;;AAEA,cAAI+/C,KAAK55C,CAAT,EAAY;AACV;AACA;AACD;;AAED,cAAI8lB,MAAMjsB,CAAN,IAAW+H,CAAf,EAAkB;AAChB8Y,iBAAK+/B,KAAKpJ,EAAL,GAAUkJ,IAAV,GAAiB,CAACA,IAAvB;AACD,WAFD,MAEO;AACL7/B,iBAAKyM,KAAKszB,EAAL,GAAUF,IAAV,GAAiB,CAACA,IAAvB;AACD;AACF;;AAED,eAAO7/B,CAAP;AACD,OAtBD,MAsBO;AACL;AACA,YAAI6/B,OAAOz0B,MAAM,CAAN,MAAa,CAAb,IAAkBA,MAAM,CAAN,MAAa,CAA/B,GAAmC,GAAnC,GAAyC,CAApD;AACA,YAAI8zB,KAAK7H,YAAYX,EAAZ,EAAgBE,EAAhB,EAAoBpqB,EAApB,EAAwBpB,MAAM,CAAN,CAAxB,CAAT;;AAEA,YAAI8zB,KAAK55C,CAAT,EAAY;AACV;AACA,iBAAO,CAAP;AACD;;AAED,eAAOmnB,KAAKkqB,EAAL,GAAUkJ,IAAV,GAAiB,CAACA,IAAzB;AACD;AACF;AACF,GA/3Z2B,CA+3Z1B;AACF;;;AAGA,WAASG,UAAT,CAAoB/D,EAApB,EAAwBC,EAAxB,EAA4BxjC,CAA5B,EAA+B0gC,UAA/B,EAA2CC,QAA3C,EAAqDC,aAArD,EAAoEh0C,CAApE,EAAuEC,CAAvE,EAA0E;AACxEA,SAAK22C,EAAL;;AAEA,QAAI32C,IAAImT,CAAJ,IAASnT,IAAI,CAACmT,CAAlB,EAAqB;AACnB,aAAO,CAAP;AACD;;AAED,QAAIgQ,MAAMziB,KAAKC,IAAL,CAAUwS,IAAIA,CAAJ,GAAQnT,IAAIA,CAAtB,CAAV;AACA6lB,UAAM,CAAN,IAAW,CAAC1C,GAAZ;AACA0C,UAAM,CAAN,IAAW1C,GAAX;AACA,QAAI+wB,OAAOxzC,KAAKyzC,GAAL,CAASN,aAAaC,QAAtB,CAAX;;AAEA,QAAII,OAAO,IAAX,EAAiB;AACf,aAAO,CAAP;AACD;;AAED,QAAIA,OAAO2F,KAAP,GAAe,IAAnB,EAAyB;AACvB;AACAhG,mBAAa,CAAb;AACAC,iBAAW+F,KAAX;AACA,UAAIH,MAAM3F,gBAAgB,CAAhB,GAAoB,CAAC,CAA/B;;AAEA,UAAIh0C,KAAK8lB,MAAM,CAAN,IAAW6wB,EAAhB,IAAsB32C,KAAK8lB,MAAM,CAAN,IAAW6wB,EAA1C,EAA8C;AAC5C,eAAOgD,GAAP;AACD,OAFD,MAEO;AACL,eAAO,CAAP;AACD;AACF;;AAED,QAAI3F,aAAJ,EAAmB;AACjB,UAAI5wB,MAAM0wB,UAAV;AACAA,mBAAayF,gBAAgBxF,QAAhB,CAAb;AACAA,iBAAWwF,gBAAgBn2B,GAAhB,CAAX;AACD,KAJD,MAIO;AACL0wB,mBAAayF,gBAAgBzF,UAAhB,CAAb;AACAC,iBAAWwF,gBAAgBxF,QAAhB,CAAX;AACD;;AAED,QAAID,aAAaC,QAAjB,EAA2B;AACzBA,kBAAY+F,KAAZ;AACD;;AAED,QAAIp/B,IAAI,CAAR;;AAEA,SAAK,IAAI7gB,IAAI,CAAb,EAAgBA,IAAI,CAApB,EAAuBA,GAAvB,EAA4B;AAC1B,UAAI+/C,KAAK9zB,MAAMjsB,CAAN,CAAT;;AAEA,UAAI+/C,KAAKjD,EAAL,GAAU32C,CAAd,EAAiB;AACf,YAAIq0C,QAAQ1zC,KAAK4L,KAAL,CAAWtM,CAAX,EAAc25C,EAAd,CAAZ;AACA,YAAID,MAAM3F,gBAAgB,CAAhB,GAAoB,CAAC,CAA/B;;AAEA,YAAIK,QAAQ,CAAZ,EAAe;AACbA,kBAAQyF,QAAQzF,KAAhB;AACD;;AAED,YAAIA,SAASP,UAAT,IAAuBO,SAASN,QAAhC,IAA4CM,QAAQyF,KAAR,IAAiBhG,UAAjB,IAA+BO,QAAQyF,KAAR,IAAiB/F,QAAhG,EAA0G;AACxG,cAAIM,QAAQ1zC,KAAKgN,EAAL,GAAU,CAAlB,IAAuB0mC,QAAQ1zC,KAAKgN,EAAL,GAAU,GAA7C,EAAkD;AAChDgsC,kBAAM,CAACA,GAAP;AACD;;AAEDj/B,eAAKi/B,GAAL;AACD;AACF;AACF;;AAED,WAAOj/B,CAAP;AACD;;AAED,WAASigC,WAAT,CAAqB3+C,IAArB,EAA2B8rB,SAA3B,EAAsC8yB,QAAtC,EAAgD56C,CAAhD,EAAmDC,CAAnD,EAAsD;AACpD,QAAIya,IAAI,CAAR;AACA,QAAI09B,KAAK,CAAT;AACA,QAAIC,KAAK,CAAT;AACA,QAAIjH,KAAK,CAAT;AACA,QAAIC,KAAK,CAAT;;AAEA,SAAK,IAAIx3C,IAAI,CAAb,EAAgBA,IAAImC,KAAKjC,MAAzB,GAAkC;AAChC,UAAIy9C,MAAMx7C,KAAKnC,GAAL,CAAV,CADgC,CACX;;AAErB,UAAI29C,QAAQqC,MAAMtF,CAAd,IAAmB16C,IAAI,CAA3B,EAA8B;AAC5B;AACA,YAAI,CAAC+gD,QAAL,EAAe;AACblgC,eAAKg/B,YAAYtB,EAAZ,EAAgBC,EAAhB,EAAoBjH,EAApB,EAAwBC,EAAxB,EAA4BrxC,CAA5B,EAA+BC,CAA/B,CAAL;AACD,SAJ2B,CAI1B;AACF;AACA;AACA;AAED;;AAED,UAAIpG,KAAK,CAAT,EAAY;AACV;AACA;AACA;AACA;AACAu+C,aAAKp8C,KAAKnC,CAAL,CAAL;AACAw+C,aAAKr8C,KAAKnC,IAAI,CAAT,CAAL;AACAu3C,aAAKgH,EAAL;AACA/G,aAAKgH,EAAL;AACD;;AAED,cAAQb,GAAR;AACE,aAAKqC,MAAMtF,CAAX;AACE;AACA;AACAnD,eAAKp1C,KAAKnC,GAAL,CAAL;AACAw3C,eAAKr1C,KAAKnC,GAAL,CAAL;AACAu+C,eAAKhH,EAAL;AACAiH,eAAKhH,EAAL;AACA;;AAEF,aAAKwI,MAAM3kC,CAAX;AACE,cAAI0lC,QAAJ,EAAc;AACZ,gBAAI7B,gBAAgBX,EAAhB,EAAoBC,EAApB,EAAwBr8C,KAAKnC,CAAL,CAAxB,EAAiCmC,KAAKnC,IAAI,CAAT,CAAjC,EAA8CiuB,SAA9C,EAAyD9nB,CAAzD,EAA4DC,CAA5D,CAAJ,EAAoE;AAClE,qBAAO,IAAP;AACD;AACF,WAJD,MAIO;AACL;AACAya,iBAAKg/B,YAAYtB,EAAZ,EAAgBC,EAAhB,EAAoBr8C,KAAKnC,CAAL,CAApB,EAA6BmC,KAAKnC,IAAI,CAAT,CAA7B,EAA0CmG,CAA1C,EAA6CC,CAA7C,KAAmD,CAAxD;AACD;;AAEDm4C,eAAKp8C,KAAKnC,GAAL,CAAL;AACAw+C,eAAKr8C,KAAKnC,GAAL,CAAL;AACA;;AAEF,aAAKggD,MAAM9J,CAAX;AACE,cAAI6K,QAAJ,EAAc;AACZ,gBAAIxB,gBAAgBhB,EAAhB,EAAoBC,EAApB,EAAwBr8C,KAAKnC,GAAL,CAAxB,EAAmCmC,KAAKnC,GAAL,CAAnC,EAA8CmC,KAAKnC,GAAL,CAA9C,EAAyDmC,KAAKnC,GAAL,CAAzD,EAAoEmC,KAAKnC,CAAL,CAApE,EAA6EmC,KAAKnC,IAAI,CAAT,CAA7E,EAA0FiuB,SAA1F,EAAqG9nB,CAArG,EAAwGC,CAAxG,CAAJ,EAAgH;AAC9G,qBAAO,IAAP;AACD;AACF,WAJD,MAIO;AACLya,iBAAKw/B,aAAa9B,EAAb,EAAiBC,EAAjB,EAAqBr8C,KAAKnC,GAAL,CAArB,EAAgCmC,KAAKnC,GAAL,CAAhC,EAA2CmC,KAAKnC,GAAL,CAA3C,EAAsDmC,KAAKnC,GAAL,CAAtD,EAAiEmC,KAAKnC,CAAL,CAAjE,EAA0EmC,KAAKnC,IAAI,CAAT,CAA1E,EAAuFmG,CAAvF,EAA0FC,CAA1F,KAAgG,CAArG;AACD;;AAEDm4C,eAAKp8C,KAAKnC,GAAL,CAAL;AACAw+C,eAAKr8C,KAAKnC,GAAL,CAAL;AACA;;AAEF,aAAKggD,MAAMrF,CAAX;AACE,cAAIoG,QAAJ,EAAc;AACZ,gBAAIvB,gBAAgBjB,EAAhB,EAAoBC,EAApB,EAAwBr8C,KAAKnC,GAAL,CAAxB,EAAmCmC,KAAKnC,GAAL,CAAnC,EAA8CmC,KAAKnC,CAAL,CAA9C,EAAuDmC,KAAKnC,IAAI,CAAT,CAAvD,EAAoEiuB,SAApE,EAA+E9nB,CAA/E,EAAkFC,CAAlF,CAAJ,EAA0F;AACxF,qBAAO,IAAP;AACD;AACF,WAJD,MAIO;AACLya,iBAAK8/B,iBAAiBpC,EAAjB,EAAqBC,EAArB,EAAyBr8C,KAAKnC,GAAL,CAAzB,EAAoCmC,KAAKnC,GAAL,CAApC,EAA+CmC,KAAKnC,CAAL,CAA/C,EAAwDmC,KAAKnC,IAAI,CAAT,CAAxD,EAAqEmG,CAArE,EAAwEC,CAAxE,KAA8E,CAAnF;AACD;;AAEDm4C,eAAKp8C,KAAKnC,GAAL,CAAL;AACAw+C,eAAKr8C,KAAKnC,GAAL,CAAL;AACA;;AAEF,aAAKggD,MAAM/J,CAAX;AACE;AACA,cAAI6G,KAAK36C,KAAKnC,GAAL,CAAT;AACA,cAAI+8C,KAAK56C,KAAKnC,GAAL,CAAT;AACA,cAAI+5C,KAAK53C,KAAKnC,GAAL,CAAT;AACA,cAAIg6C,KAAK73C,KAAKnC,GAAL,CAAT;AACA,cAAI02C,QAAQv0C,KAAKnC,GAAL,CAAZ;AACA,cAAI6+C,SAAS18C,KAAKnC,GAAL,CAAb,CAPF,CAO0B;;AAExB,cAAIy+C,MAAMt8C,KAAKnC,GAAL,CAAV;AACA,cAAIm6C,gBAAgB,IAAIh4C,KAAKnC,GAAL,CAAxB;AACA,cAAIy3C,KAAK3wC,KAAK6J,GAAL,CAAS+lC,KAAT,IAAkBqD,EAAlB,GAAuB+C,EAAhC;AACA,cAAIpF,KAAK5wC,KAAK2J,GAAL,CAASimC,KAAT,IAAkBsD,EAAlB,GAAuB+C,EAAhC,CAZF,CAYsC;;AAEpC,cAAI/8C,IAAI,CAAR,EAAW;AACT6gB,iBAAKg/B,YAAYtB,EAAZ,EAAgBC,EAAhB,EAAoB/G,EAApB,EAAwBC,EAAxB,EAA4BvxC,CAA5B,EAA+BC,CAA/B,CAAL;AACD,WAFD,MAEO;AACL;AACAmxC,iBAAKE,EAAL;AACAD,iBAAKE,EAAL;AACD,WApBH,CAoBI;;;AAGF,cAAI3uC,KAAK,CAAC5C,IAAI22C,EAAL,IAAW9C,EAAX,GAAgBD,EAAhB,GAAqB+C,EAA9B;;AAEA,cAAIiE,QAAJ,EAAc;AACZ,gBAAInB,gBAAgB9C,EAAhB,EAAoBC,EAApB,EAAwB/C,EAAxB,EAA4BtD,KAA5B,EAAmCA,QAAQmI,MAA3C,EAAmD1E,aAAnD,EAAkElsB,SAAlE,EAA6EllB,EAA7E,EAAiF3C,CAAjF,CAAJ,EAAyF;AACvF,qBAAO,IAAP;AACD;AACF,WAJD,MAIO;AACLya,iBAAKggC,WAAW/D,EAAX,EAAeC,EAAf,EAAmB/C,EAAnB,EAAuBtD,KAAvB,EAA8BA,QAAQmI,MAAtC,EAA8C1E,aAA9C,EAA6DpxC,EAA7D,EAAiE3C,CAAjE,CAAL;AACD;;AAEDm4C,eAAKz3C,KAAK6J,GAAL,CAAS+lC,QAAQmI,MAAjB,IAA2B9E,EAA3B,GAAgC+C,EAArC;AACA0B,eAAK13C,KAAK2J,GAAL,CAASimC,QAAQmI,MAAjB,IAA2B7E,EAA3B,GAAgC+C,EAArC;AACA;;AAEF,aAAKiD,MAAMjlC,CAAX;AACEw8B,eAAKgH,KAAKp8C,KAAKnC,GAAL,CAAV;AACAw3C,eAAKgH,KAAKr8C,KAAKnC,GAAL,CAAV;AACA,cAAIqlB,QAAQljB,KAAKnC,GAAL,CAAZ;AACA,cAAIslB,SAASnjB,KAAKnC,GAAL,CAAb;AACA,cAAIy3C,KAAKF,KAAKlyB,KAAd;AACA,cAAIqyB,KAAKF,KAAKlyB,MAAd;;AAEA,cAAIy7B,QAAJ,EAAc;AACZ,gBAAI7B,gBAAgB3H,EAAhB,EAAoBC,EAApB,EAAwBC,EAAxB,EAA4BD,EAA5B,EAAgCvpB,SAAhC,EAA2C9nB,CAA3C,EAA8CC,CAA9C,KAAoD84C,gBAAgBzH,EAAhB,EAAoBD,EAApB,EAAwBC,EAAxB,EAA4BC,EAA5B,EAAgCzpB,SAAhC,EAA2C9nB,CAA3C,EAA8CC,CAA9C,CAApD,IAAwG84C,gBAAgBzH,EAAhB,EAAoBC,EAApB,EAAwBH,EAAxB,EAA4BG,EAA5B,EAAgCzpB,SAAhC,EAA2C9nB,CAA3C,EAA8CC,CAA9C,CAAxG,IAA4J84C,gBAAgB3H,EAAhB,EAAoBG,EAApB,EAAwBH,EAAxB,EAA4BC,EAA5B,EAAgCvpB,SAAhC,EAA2C9nB,CAA3C,EAA8CC,CAA9C,CAAhK,EAAkN;AAChN,qBAAO,IAAP;AACD;AACF,WAJD,MAIO;AACL;AACAya,iBAAKg/B,YAAYpI,EAAZ,EAAgBD,EAAhB,EAAoBC,EAApB,EAAwBC,EAAxB,EAA4BvxC,CAA5B,EAA+BC,CAA/B,CAAL;AACAya,iBAAKg/B,YAAYtI,EAAZ,EAAgBG,EAAhB,EAAoBH,EAApB,EAAwBC,EAAxB,EAA4BrxC,CAA5B,EAA+BC,CAA/B,CAAL;AACD;;AAED;;AAEF,aAAK45C,MAAMpF,CAAX;AACE,cAAImG,QAAJ,EAAc;AACZ,gBAAI7B,gBAAgBX,EAAhB,EAAoBC,EAApB,EAAwBjH,EAAxB,EAA4BC,EAA5B,EAAgCvpB,SAAhC,EAA2C9nB,CAA3C,EAA8CC,CAA9C,CAAJ,EAAsD;AACpD,qBAAO,IAAP;AACD;AACF,WAJD,MAIO;AACL;AACAya,iBAAKg/B,YAAYtB,EAAZ,EAAgBC,EAAhB,EAAoBjH,EAApB,EAAwBC,EAAxB,EAA4BrxC,CAA5B,EAA+BC,CAA/B,CAAL,CAFK,CAEmC;AACxC;AACA;AACA;AACA;AACD;;AAEDm4C,eAAKhH,EAAL;AACAiH,eAAKhH,EAAL;AACA;AA3HJ;AA6HD;;AAED,QAAI,CAACuJ,QAAD,IAAa,CAACZ,cAAc3B,EAAd,EAAkBhH,EAAlB,CAAlB,EAAyC;AACvC32B,WAAKg/B,YAAYtB,EAAZ,EAAgBC,EAAhB,EAAoBjH,EAApB,EAAwBC,EAAxB,EAA4BrxC,CAA5B,EAA+BC,CAA/B,KAAqC,CAA1C;AACD;;AAED,WAAOya,MAAM,CAAb;AACD;;AAED,WAAS5R,QAAT,CAAiB+xC,QAAjB,EAA2B76C,CAA3B,EAA8BC,CAA9B,EAAiC;AAC/B,WAAO06C,YAAYE,QAAZ,EAAsB,CAAtB,EAAyB,KAAzB,EAAgC76C,CAAhC,EAAmCC,CAAnC,CAAP;AACD;AACD,WAAS66C,aAAT,CAAuBD,QAAvB,EAAiC/yB,SAAjC,EAA4C9nB,CAA5C,EAA+CC,CAA/C,EAAkD;AAChD,WAAO06C,YAAYE,QAAZ,EAAsB/yB,SAAtB,EAAiC,IAAjC,EAAuC9nB,CAAvC,EAA0CC,CAA1C,CAAP;AACD;;AAED,MAAI4rB,mBAAmBH,QAAQtzB,SAAR,CAAkByzB,gBAAzC;AACA,MAAIuoB,MAAMzzC,KAAKyzC,GAAf;AACA,MAAI2G,mBAAmB,IAAI1F,SAAJ,CAAc,IAAd,CAAvB;AACA;;;;;;;AAOA,WAAS2F,IAAT,CAAc5vC,IAAd,EAAoB;AAClBusB,gBAAYh+B,IAAZ,CAAiB,IAAjB,EAAuByR,IAAvB;AACA;;;;;AAKA,SAAK4R,IAAL,GAAY,IAAZ;AACD;;AAEDg+B,OAAK5iD,SAAL,GAAiB;AACf6B,iBAAa+gD,IADE;AAEf/9C,UAAM,MAFS;AAGfg+C,iBAAa,IAHE;AAIfC,4BAAwB,CAJT;AAKfhjB,WAAO,eAAUh0B,GAAV,EAAeqmB,MAAf,EAAuB;AAC5B,UAAIC,QAAQ,KAAKA,KAAjB;AACA,UAAIxN,OAAO,KAAKA,IAAL,IAAa+9B,gBAAxB;AACA,UAAI/vB,YAAYR,MAAMQ,SAAN,EAAhB;AACA,UAAIE,UAAUV,MAAMU,OAAN,EAAd;AACA,UAAI5D,OAAOkD,MAAMlD,IAAjB;AACA,UAAIC,SAASiD,MAAMjD,MAAnB;AACA,UAAI4zB,kBAAkBjwB,WAAW,CAAC,CAAC5D,KAAKiE,UAAxC;AACA,UAAI6vB,oBAAoBpwB,aAAa,CAAC,CAACzD,OAAOgE,UAA9C;AACA,UAAI8vB,iBAAiBnwB,WAAW,CAAC,CAAC5D,KAAKqE,KAAvC;AACA,UAAI2vB,mBAAmBtwB,aAAa,CAAC,CAACzD,OAAOoE,KAA7C;AACAnB,YAAMhuB,IAAN,CAAW0H,GAAX,EAAgB,IAAhB,EAAsBqmB,MAAtB;AACA,WAAKxe,YAAL,CAAkB7H,GAAlB;;AAEA,UAAI,KAAKyc,OAAT,EAAkB;AAChB,YAAIL,IAAJ,CADgB,CACN;;AAEV,YAAI66B,eAAJ,EAAqB;AACnB76B,iBAAOA,QAAQ,KAAKqB,eAAL,EAAf;AACA,eAAK45B,aAAL,GAAqB/wB,MAAMa,WAAN,CAAkBnnB,GAAlB,EAAuBojB,IAAvB,EAA6BhH,IAA7B,CAArB;AACD;;AAED,YAAI86B,iBAAJ,EAAuB;AACrB96B,iBAAOA,QAAQ,KAAKqB,eAAL,EAAf;AACA,eAAK65B,eAAL,GAAuBhxB,MAAMa,WAAN,CAAkBnnB,GAAlB,EAAuBqjB,MAAvB,EAA+BjH,IAA/B,CAAvB;AACD;AACF,OA1B2B,CA0B1B;;;AAGF,UAAI66B,eAAJ,EAAqB;AACnB;AACAj3C,YAAI0mB,SAAJ,GAAgB,KAAK2wB,aAArB;AACD,OAHD,MAGO,IAAIF,cAAJ,EAAoB;AACzBn3C,YAAI0mB,SAAJ,GAAgBiB,iBAAiBlyB,IAAjB,CAAsB2tB,IAAtB,EAA4BpjB,GAA5B,CAAhB;AACD;;AAED,UAAIk3C,iBAAJ,EAAuB;AACrBl3C,YAAI2mB,WAAJ,GAAkB,KAAK2wB,eAAvB;AACD,OAFD,MAEO,IAAIF,gBAAJ,EAAsB;AAC3Bp3C,YAAI2mB,WAAJ,GAAkBgB,iBAAiBlyB,IAAjB,CAAsB4tB,MAAtB,EAA8BrjB,GAA9B,CAAlB;AACD;;AAED,UAAIujB,WAAW+C,MAAM/C,QAArB;AACA,UAAIC,iBAAiB8C,MAAM9C,cAA3B;AACA,UAAI+zB,cAAc,CAAC,CAACv3C,IAAI8yC,WAAxB,CA5C4B,CA4CS;;AAErC,UAAI91C,QAAQ,KAAKsL,cAAL,EAAZ;AACAwQ,WAAKk5B,QAAL,CAAch1C,MAAM,CAAN,CAAd,EAAwBA,MAAM,CAAN,CAAxB,EA/C4B,CA+CO;AACnC;AACA;AACA;AACA;;AAEA,UAAI,KAAK+5C,WAAL,IAAoBxzB,YAAY,CAACg0B,WAAb,IAA4BzwB,SAApD,EAA+D;AAC7DhO,aAAK+Z,SAAL,CAAe7yB,GAAf,EAD6D,CACxC;;AAErB,YAAIujB,YAAY,CAACg0B,WAAjB,EAA8B;AAC5Bz+B,eAAKg6B,WAAL,CAAiBvvB,QAAjB;AACAzK,eAAKk6B,iBAAL,CAAuBxvB,cAAvB;AACD;;AAED,aAAKmM,SAAL,CAAe7W,IAAf,EAAqB,KAAK8W,KAA1B,EAAiC,KAAjC,EAR6D,CAQpB;;AAEzC,YAAI,KAAK9W,IAAT,EAAe;AACb,eAAKi+B,WAAL,GAAmB,KAAnB;AACD;AACF,OAbD,MAaO;AACL;AACA/2C,YAAI6yB,SAAJ;AACA,aAAK/Z,IAAL,CAAUu7B,WAAV,CAAsBr0C,GAAtB;AACD;;AAEDgnB,iBAAWlO,KAAKsK,IAAL,CAAUpjB,GAAV,CAAX;;AAEA,UAAIujB,YAAYg0B,WAAhB,EAA6B;AAC3Bv3C,YAAI8yC,WAAJ,CAAgBvvB,QAAhB;AACAvjB,YAAIwjB,cAAJ,GAAqBA,cAArB;AACD;;AAEDsD,mBAAahO,KAAKuK,MAAL,CAAYrjB,GAAZ,CAAb;;AAEA,UAAIujB,YAAYg0B,WAAhB,EAA6B;AAC3B;AACA;AACAv3C,YAAI8yC,WAAJ,CAAgB,EAAhB;AACD,OArF2B,CAqF1B;;;AAGF,UAAIxsB,MAAMxC,IAAN,IAAc,IAAlB,EAAwB;AACtB;AACA,aAAK/b,gBAAL,CAAsB/H,GAAtB;AACA,aAAKwzB,YAAL,CAAkBxzB,GAAlB,EAAuB,KAAKyd,eAAL,EAAvB;AACD;AACF,KAlGc;AAmGf;AACA;AACAkS,eAAW,mBAAU3vB,GAAV,EAAew3C,QAAf,EAAyBC,QAAzB,EAAmC,CAAE,CArGjC;AAsGfC,qBAAiB,2BAAY;AAC3B,WAAK5+B,IAAL,GAAY,IAAIq4B,SAAJ,EAAZ;AACD,KAxGc;AAyGf1zB,qBAAiB,2BAAY;AAC3B,UAAIrB,OAAO,KAAKsX,KAAhB;AACA,UAAIpN,QAAQ,KAAKA,KAAjB;AACA,UAAIqxB,kBAAkB,CAACv7B,IAAvB;;AAEA,UAAIu7B,eAAJ,EAAqB;AACnB,YAAI7+B,OAAO,KAAKA,IAAhB;;AAEA,YAAI,CAACA,IAAL,EAAW;AACT;AACAA,iBAAO,KAAKA,IAAL,GAAY,IAAIq4B,SAAJ,EAAnB;AACD;;AAED,YAAI,KAAK4F,WAAT,EAAsB;AACpBj+B,eAAK+Z,SAAL;AACA,eAAKlD,SAAL,CAAe7W,IAAf,EAAqB,KAAK8W,KAA1B,EAAiC,KAAjC;AACD;;AAEDxT,eAAOtD,KAAK2E,eAAL,EAAP;AACD;;AAED,WAAKiW,KAAL,GAAatX,IAAb;;AAEA,UAAIkK,MAAMQ,SAAN,EAAJ,EAAuB;AACrB;AACA;AACA;AACA,YAAI8wB,iBAAiB,KAAKC,eAAL,KAAyB,KAAKA,eAAL,GAAuBz7B,KAAK/mB,KAAL,EAAhD,CAArB;;AAEA,YAAI,KAAKonB,OAAL,IAAgBk7B,eAApB,EAAqC;AACnCC,yBAAe37C,IAAf,CAAoBmgB,IAApB,EADmC,CACR;;AAE3B,cAAI5F,IAAI8P,MAAM1C,SAAd,CAHmC,CAGV;;AAEzB,cAAIk0B,YAAYxxB,MAAMzC,aAAN,GAAsB,KAAKkD,YAAL,EAAtB,GAA4C,CAA5D,CALmC,CAK4B;;AAE/D,cAAI,CAACT,MAAMU,OAAN,EAAL,EAAsB;AACpBxQ,gBAAI/Z,KAAKqB,GAAL,CAAS0Y,CAAT,EAAY,KAAKwgC,sBAAL,IAA+B,CAA3C,CAAJ;AACD,WATkC,CASjC;AACF;;;AAGA,cAAIc,YAAY,KAAhB,EAAuB;AACrBF,2BAAe58B,KAAf,IAAwBxE,IAAIshC,SAA5B;AACAF,2BAAe38B,MAAf,IAAyBzE,IAAIshC,SAA7B;AACAF,2BAAe97C,CAAf,IAAoB0a,IAAIshC,SAAJ,GAAgB,CAApC;AACAF,2BAAe77C,CAAf,IAAoBya,IAAIshC,SAAJ,GAAgB,CAApC;AACD;AACF,SAzBoB,CAyBnB;;;AAGF,eAAOF,cAAP;AACD;;AAED,aAAOx7B,IAAP;AACD,KAhKc;AAiKfxX,aAAS,iBAAU9I,CAAV,EAAaC,CAAb,EAAgB;AACvB,UAAIg8C,WAAW,KAAKxvC,qBAAL,CAA2BzM,CAA3B,EAA8BC,CAA9B,CAAf;AACA,UAAIqgB,OAAO,KAAKqB,eAAL,EAAX;AACA,UAAI6I,QAAQ,KAAKA,KAAjB;AACAxqB,UAAIi8C,SAAS,CAAT,CAAJ;AACAh8C,UAAIg8C,SAAS,CAAT,CAAJ;;AAEA,UAAI37B,KAAKxX,OAAL,CAAa9I,CAAb,EAAgBC,CAAhB,CAAJ,EAAwB;AACtB,YAAI46C,WAAW,KAAK79B,IAAL,CAAUhhB,IAAzB;;AAEA,YAAIwuB,MAAMQ,SAAN,EAAJ,EAAuB;AACrB,cAAIlD,YAAY0C,MAAM1C,SAAtB;AACA,cAAIk0B,YAAYxxB,MAAMzC,aAAN,GAAsB,KAAKkD,YAAL,EAAtB,GAA4C,CAA5D,CAFqB,CAE0C;;AAE/D,cAAI+wB,YAAY,KAAhB,EAAuB;AACrB;AACA,gBAAI,CAACxxB,MAAMU,OAAN,EAAL,EAAsB;AACpBpD,0BAAYnnB,KAAKqB,GAAL,CAAS8lB,SAAT,EAAoB,KAAKozB,sBAAzB,CAAZ;AACD;;AAED,gBAAIJ,cAAcD,QAAd,EAAwB/yB,YAAYk0B,SAApC,EAA+Ch8C,CAA/C,EAAkDC,CAAlD,CAAJ,EAA0D;AACxD,qBAAO,IAAP;AACD;AACF;AACF;;AAED,YAAIuqB,MAAMU,OAAN,EAAJ,EAAqB;AACnB,iBAAOpiB,SAAQ+xC,QAAR,EAAkB76C,CAAlB,EAAqBC,CAArB,CAAP;AACD;AACF;;AAED,aAAO,KAAP;AACD,KAjMc;;AAmMf;;;AAGAod,WAAO,eAAU6+B,SAAV,EAAqB;AAC1B,UAAIA,aAAa,IAAjB,EAAuB;AACrBA,oBAAY,IAAZ;AACD,OAHyB,CAGxB;;;AAGF,UAAIA,SAAJ,EAAe;AACb,aAAKjB,WAAL,GAAmBiB,SAAnB;AACA,aAAKtkB,KAAL,GAAa,IAAb;AACD;;AAED,WAAKjX,OAAL,GAAe,IAAf;AACA,WAAKja,IAAL,IAAa,KAAKA,IAAL,CAAU4X,OAAV,EAAb,CAZ0B,CAYQ;;AAElC,UAAI,KAAKK,YAAT,EAAuB;AACrB,aAAKA,YAAL,CAAkBtB,KAAlB;AACD;AACF,KAvNc;;AAyNf;;;;AAIA8+B,kBAAc,sBAAU3sC,IAAV,EAAgB;AAC5B,aAAO,KAAKuN,OAAL,CAAa,OAAb,EAAsBvN,IAAtB,CAAP;AACD,KA/Nc;AAgOf;AACA4O,YAAQ,gBAAUhkB,GAAV,EAAekB,KAAf,EAAsB;AAC5B;AACA,UAAIlB,QAAQ,OAAZ,EAAqB;AACnB,aAAKgiD,QAAL,CAAc9gD,KAAd;AACA,aAAK2/C,WAAL,GAAmB,IAAnB;AACA,aAAKrjB,KAAL,GAAa,IAAb;AACD,OAJD,MAIO;AACLD,oBAAYv/B,SAAZ,CAAsBgmB,MAAtB,CAA6BzkB,IAA7B,CAAkC,IAAlC,EAAwCS,GAAxC,EAA6CkB,KAA7C;AACD;AACF,KA1Oc;;AA4Of;;;;AAIA8gD,cAAU,kBAAUhiD,GAAV,EAAekB,KAAf,EAAsB;AAC9B,UAAIw4B,QAAQ,KAAKA,KAAjB,CAD8B,CACN;;AAExB,UAAIA,KAAJ,EAAW;AACT,YAAIr5B,WAAWL,GAAX,CAAJ,EAAqB;AACnB,eAAK,IAAIhB,IAAT,IAAiBgB,GAAjB,EAAsB;AACpB,gBAAIA,IAAIC,cAAJ,CAAmBjB,IAAnB,CAAJ,EAA8B;AAC5B06B,oBAAM16B,IAAN,IAAcgB,IAAIhB,IAAJ,CAAd;AACD;AACF;AACF,SAND,MAMO;AACL06B,gBAAM15B,GAAN,IAAakB,KAAb;AACD;;AAED,aAAK+hB,KAAL,CAAW,IAAX;AACD;;AAED,aAAO,IAAP;AACD,KAlQc;AAmQf4N,kBAAc,wBAAY;AACxB,UAAInpB,IAAI,KAAK2J,SAAb,CADwB,CACA;AACxB;AACA;AACA;;AAEA,aAAO3J,KAAKsyC,IAAItyC,EAAE,CAAF,IAAO,CAAX,IAAgB,KAArB,IAA8BsyC,IAAItyC,EAAE,CAAF,IAAO,CAAX,IAAgB,KAA9C,GAAsDnB,KAAKC,IAAL,CAAUwzC,IAAItyC,EAAE,CAAF,IAAOA,EAAE,CAAF,CAAP,GAAcA,EAAE,CAAF,IAAOA,EAAE,CAAF,CAAzB,CAAV,CAAtD,GAAkG,CAAzG;AACD;AA1Qc,GAAjB;AA4QA;;;;;;;;;;;AAWAk5C,OAAKhgD,MAAL,GAAc,UAAUqhD,WAAV,EAAuB;AACnC,QAAIC,MAAM,SAANA,GAAM,CAAUlxC,IAAV,EAAgB;AACxB4vC,WAAKrhD,IAAL,CAAU,IAAV,EAAgByR,IAAhB;;AAEA,UAAIixC,YAAY7xB,KAAhB,EAAuB;AACrB;AACA,aAAKA,KAAL,CAAWxD,UAAX,CAAsBq1B,YAAY7xB,KAAlC,EAAyC,KAAzC;AACD,OANuB,CAMtB;;;AAGF,UAAI+xB,eAAeF,YAAYvoB,KAA/B;;AAEA,UAAIyoB,YAAJ,EAAkB;AAChB,aAAKzoB,KAAL,GAAa,KAAKA,KAAL,IAAc,EAA3B;AACA,YAAI0oB,YAAY,KAAK1oB,KAArB;;AAEA,aAAK,IAAI16B,IAAT,IAAiBmjD,YAAjB,EAA+B;AAC7B,cAAI,CAACC,UAAUniD,cAAV,CAAyBjB,IAAzB,CAAD,IAAmCmjD,aAAaliD,cAAb,CAA4BjB,IAA5B,CAAvC,EAA0E;AACxEojD,sBAAUpjD,IAAV,IAAkBmjD,aAAanjD,IAAb,CAAlB;AACD;AACF;AACF;;AAEDijD,kBAAYlU,IAAZ,IAAoBkU,YAAYlU,IAAZ,CAAiBxuC,IAAjB,CAAsB,IAAtB,EAA4ByR,IAA5B,CAApB;AACD,KAvBD;;AAyBA7P,aAAS+gD,GAAT,EAActB,IAAd,EA1BmC,CA0Bd;;AAErB,SAAK,IAAI5hD,IAAT,IAAiBijD,WAAjB,EAA8B;AAC5B;AACA,UAAIjjD,SAAS,OAAT,IAAoBA,SAAS,OAAjC,EAA0C;AACxCkjD,YAAIlkD,SAAJ,CAAcgB,IAAd,IAAsBijD,YAAYjjD,IAAZ,CAAtB;AACD;AACF;;AAED,WAAOkjD,GAAP;AACD,GApCD;;AAsCA/gD,WAASy/C,IAAT,EAAerjB,WAAf;;AAEA,MAAI8kB,QAAQpH,UAAUf,GAAtB;AACA,MAAI3Q,SAAS,CAAC,EAAD,EAAK,EAAL,EAAS,EAAT,CAAb;AACA,MAAI+Y,aAAa/7C,KAAKC,IAAtB;AACA,MAAI+7C,YAAYh8C,KAAK4L,KAArB;AACA,MAAIqwC,gBAAgB,SAAhBA,aAAgB,CAAU5/B,IAAV,EAAgBlb,CAAhB,EAAmB;AACrC,QAAI9F,OAAOghB,KAAKhhB,IAAhB;AACA,QAAIw7C,GAAJ;AACA,QAAIqF,MAAJ;AACA,QAAIhjD,CAAJ;AACA,QAAI4d,CAAJ;AACA,QAAI5K,CAAJ;AACA,QAAIyB,CAAJ;AACA,QAAIimC,IAAIkI,MAAMlI,CAAd;AACA,QAAIxE,IAAI0M,MAAM1M,CAAd;AACA,QAAI76B,IAAIunC,MAAMvnC,CAAd;AACA,QAAIN,IAAI6nC,MAAM7nC,CAAd;AACA,QAAIk7B,IAAI2M,MAAM3M,CAAd;AACA,QAAI0E,IAAIiI,MAAMjI,CAAd;;AAEA,SAAK36C,IAAI,CAAJ,EAAO4d,IAAI,CAAhB,EAAmB5d,IAAImC,KAAKjC,MAA5B,GAAqC;AACnCy9C,YAAMx7C,KAAKnC,GAAL,CAAN;AACA4d,UAAI5d,CAAJ;AACAgjD,eAAS,CAAT;;AAEA,cAAQrF,GAAR;AACE,aAAKjD,CAAL;AACEsI,mBAAS,CAAT;AACA;;AAEF,aAAK3nC,CAAL;AACE2nC,mBAAS,CAAT;AACA;;AAEF,aAAK9M,CAAL;AACE8M,mBAAS,CAAT;AACA;;AAEF,aAAKrI,CAAL;AACEqI,mBAAS,CAAT;AACA;;AAEF,aAAK/M,CAAL;AACE,cAAI9vC,IAAI8B,EAAE,CAAF,CAAR;AACA,cAAI7B,IAAI6B,EAAE,CAAF,CAAR;AACA,cAAIsK,KAAKswC,WAAW56C,EAAE,CAAF,IAAOA,EAAE,CAAF,CAAP,GAAcA,EAAE,CAAF,IAAOA,EAAE,CAAF,CAAhC,CAAT;AACA,cAAIuK,KAAKqwC,WAAW56C,EAAE,CAAF,IAAOA,EAAE,CAAF,CAAP,GAAcA,EAAE,CAAF,IAAOA,EAAE,CAAF,CAAhC,CAAT;AACA,cAAIuyC,QAAQsI,UAAU,CAAC76C,EAAE,CAAF,CAAD,GAAQuK,EAAlB,EAAsBvK,EAAE,CAAF,IAAOsK,EAA7B,CAAZ,CALF,CAKgD;;AAE9CpQ,eAAKnC,CAAL,KAAWuS,EAAX;AACApQ,eAAKnC,GAAL,KAAamG,CAAb,CARF,CAQkB;;AAEhBhE,eAAKnC,CAAL,KAAWwS,EAAX;AACArQ,eAAKnC,GAAL,KAAaoG,CAAb,CAXF,CAWkB;AAChB;;AAEAjE,eAAKnC,GAAL,KAAauS,EAAb;AACApQ,eAAKnC,GAAL,KAAawS,EAAb,CAfF,CAemB;;AAEjBrQ,eAAKnC,GAAL,KAAaw6C,KAAb,CAjBF,CAiBsB;;AAEpBr4C,eAAKnC,GAAL,KAAaw6C,KAAb,CAnBF,CAmBsB;;AAEpBx6C,eAAK,CAAL;AACA4d,cAAI5d,CAAJ;AACA;;AAEF,aAAK+a,CAAL;AACE;AACAtG,YAAE,CAAF,IAAOtS,KAAKnC,GAAL,CAAP;AACAyU,YAAE,CAAF,IAAOtS,KAAKnC,GAAL,CAAP;AACAgI,yBAAeyM,CAAf,EAAkBA,CAAlB,EAAqBxM,CAArB;AACA9F,eAAKyb,GAAL,IAAYnJ,EAAE,CAAF,CAAZ;AACAtS,eAAKyb,GAAL,IAAYnJ,EAAE,CAAF,CAAZ,CANF,CAMoB;;AAElBA,YAAE,CAAF,KAAQtS,KAAKnC,GAAL,CAAR;AACAyU,YAAE,CAAF,KAAQtS,KAAKnC,GAAL,CAAR;AACAgI,yBAAeyM,CAAf,EAAkBA,CAAlB,EAAqBxM,CAArB;AACA9F,eAAKyb,GAAL,IAAYnJ,EAAE,CAAF,CAAZ;AACAtS,eAAKyb,GAAL,IAAYnJ,EAAE,CAAF,CAAZ;AAtDJ;;AAyDA,WAAKzB,IAAI,CAAT,EAAYA,IAAIgwC,MAAhB,EAAwBhwC,GAAxB,EAA6B;AAC3B,YAAIyB,IAAIq1B,OAAO92B,CAAP,CAAR;AACAyB,UAAE,CAAF,IAAOtS,KAAKnC,GAAL,CAAP;AACAyU,UAAE,CAAF,IAAOtS,KAAKnC,GAAL,CAAP;AACAgI,uBAAeyM,CAAf,EAAkBA,CAAlB,EAAqBxM,CAArB,EAJ2B,CAIF;;AAEzB9F,aAAKyb,GAAL,IAAYnJ,EAAE,CAAF,CAAZ;AACAtS,aAAKyb,GAAL,IAAYnJ,EAAE,CAAF,CAAZ;AACD;AACF;AACF,GAvFD;;AAyFA,MAAIwuC,KAAK,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,GAAhB,EAAqB,GAArB,EAA0B,GAA1B,EAA+B,GAA/B,EAAoC,GAApC,EAAyC,GAAzC,EAA8C,GAA9C,EAAmD,GAAnD,EAAwD,GAAxD,EAA6D,GAA7D,EAAkE,GAAlE,EAAuE,GAAvE,EAA4E,GAA5E,EAAiF,GAAjF,EAAsF,GAAtF,EAA2F,GAA3F,EAAgG,GAAhG,CAAT;AACA,MAAIC,WAAWp8C,KAAKC,IAApB;AACA,MAAIo8C,UAAUr8C,KAAK2J,GAAnB;AACA,MAAI2yC,UAAUt8C,KAAK6J,GAAnB;AACA,MAAImD,KAAKhN,KAAKgN,EAAd;;AAEA,MAAIuvC,OAAO,SAAPA,IAAO,CAAU98C,CAAV,EAAa;AACtB,WAAOO,KAAKC,IAAL,CAAUR,EAAE,CAAF,IAAOA,EAAE,CAAF,CAAP,GAAcA,EAAE,CAAF,IAAOA,EAAE,CAAF,CAA/B,CAAP;AACD,GAFD;;AAIA,MAAI+8C,SAAS,SAATA,MAAS,CAAUC,CAAV,EAAah9C,CAAb,EAAgB;AAC3B,WAAO,CAACg9C,EAAE,CAAF,IAAOh9C,EAAE,CAAF,CAAP,GAAcg9C,EAAE,CAAF,IAAOh9C,EAAE,CAAF,CAAtB,KAA+B88C,KAAKE,CAAL,IAAUF,KAAK98C,CAAL,CAAzC,CAAP;AACD,GAFD;;AAIA,MAAIi9C,SAAS,SAATA,MAAS,CAAUD,CAAV,EAAah9C,CAAb,EAAgB;AAC3B,WAAO,CAACg9C,EAAE,CAAF,IAAOh9C,EAAE,CAAF,CAAP,GAAcg9C,EAAE,CAAF,IAAOh9C,EAAE,CAAF,CAArB,GAA4B,CAAC,CAA7B,GAAiC,CAAlC,IAAuCO,KAAK6vC,IAAL,CAAU2M,OAAOC,CAAP,EAAUh9C,CAAV,CAAV,CAA9C;AACD,GAFD;;AAIA,WAASk9C,UAAT,CAAoBhM,EAApB,EAAwBC,EAAxB,EAA4BrqB,EAA5B,EAAgCC,EAAhC,EAAoCo2B,EAApC,EAAwC5E,EAAxC,EAA4C/E,EAA5C,EAAgDC,EAAhD,EAAoD2J,MAApD,EAA4DhG,GAA5D,EAAiEx6B,IAAjE,EAAuE;AACrE,QAAIs7B,MAAMkF,UAAU7vC,KAAK,KAAf,CAAV;AACA,QAAI8vC,KAAKR,QAAQ3E,GAAR,KAAgBhH,KAAKpqB,EAArB,IAA2B,GAA3B,GAAiC81B,QAAQ1E,GAAR,KAAgB/G,KAAKpqB,EAArB,IAA2B,GAArE;AACA,QAAIu2B,KAAK,CAAC,CAAD,GAAKV,QAAQ1E,GAAR,CAAL,IAAqBhH,KAAKpqB,EAA1B,IAAgC,GAAhC,GAAsC+1B,QAAQ3E,GAAR,KAAgB/G,KAAKpqB,EAArB,IAA2B,GAA1E;AACA,QAAIw2B,SAASF,KAAKA,EAAL,IAAW7J,KAAKA,EAAhB,IAAsB8J,KAAKA,EAAL,IAAW7J,KAAKA,EAAhB,CAAnC;;AAEA,QAAI8J,SAAS,CAAb,EAAgB;AACd/J,YAAMmJ,SAASY,MAAT,CAAN;AACA9J,YAAMkJ,SAASY,MAAT,CAAN;AACD;;AAED,QAAIhrC,IAAI,CAAC4qC,OAAO5E,EAAP,GAAY,CAAC,CAAb,GAAiB,CAAlB,IAAuBoE,SAAS,CAACnJ,KAAKA,EAAL,IAAWC,KAAKA,EAAhB,IAAsBD,KAAKA,EAAL,IAAW8J,KAAKA,EAAhB,CAAtB,GAA4C7J,KAAKA,EAAL,IAAW4J,KAAKA,EAAhB,CAA7C,KAAqE7J,KAAKA,EAAL,IAAW8J,KAAKA,EAAhB,IAAsB7J,KAAKA,EAAL,IAAW4J,KAAKA,EAAhB,CAA3F,CAAT,CAAvB,IAAoJ,CAA5J;AACA,QAAIG,MAAMjrC,IAAIihC,EAAJ,GAAS8J,EAAT,GAAc7J,EAAxB;AACA,QAAIgK,MAAMlrC,IAAI,CAACkhC,EAAL,GAAU4J,EAAV,GAAe7J,EAAzB;AACA,QAAI+C,KAAK,CAACrF,KAAKpqB,EAAN,IAAY,GAAZ,GAAkB+1B,QAAQ3E,GAAR,IAAesF,GAAjC,GAAuCZ,QAAQ1E,GAAR,IAAeuF,GAA/D;AACA,QAAIjH,KAAK,CAACrF,KAAKpqB,EAAN,IAAY,GAAZ,GAAkB61B,QAAQ1E,GAAR,IAAesF,GAAjC,GAAuCX,QAAQ3E,GAAR,IAAeuF,GAA/D;AACA,QAAItN,QAAQ8M,OAAO,CAAC,CAAD,EAAI,CAAJ,CAAP,EAAe,CAAC,CAACI,KAAKG,GAAN,IAAahK,EAAd,EAAkB,CAAC8J,KAAKG,GAAN,IAAahK,EAA/B,CAAf,CAAZ;AACA,QAAIuJ,IAAI,CAAC,CAACK,KAAKG,GAAN,IAAahK,EAAd,EAAkB,CAAC8J,KAAKG,GAAN,IAAahK,EAA/B,CAAR;AACA,QAAIzzC,IAAI,CAAC,CAAC,CAAC,CAAD,GAAKq9C,EAAL,GAAUG,GAAX,IAAkBhK,EAAnB,EAAuB,CAAC,CAAC,CAAD,GAAK8J,EAAL,GAAUG,GAAX,IAAkBhK,EAAzC,CAAR;AACA,QAAI6E,SAAS2E,OAAOD,CAAP,EAAUh9C,CAAV,CAAb;;AAEA,QAAI+8C,OAAOC,CAAP,EAAUh9C,CAAV,KAAgB,CAAC,CAArB,EAAwB;AACtBs4C,eAAS/qC,EAAT;AACD;;AAED,QAAIwvC,OAAOC,CAAP,EAAUh9C,CAAV,KAAgB,CAApB,EAAuB;AACrBs4C,eAAS,CAAT;AACD;;AAED,QAAIC,OAAO,CAAP,IAAYD,SAAS,CAAzB,EAA4B;AAC1BA,eAASA,SAAS,IAAI/qC,EAAtB;AACD;;AAED,QAAIgrC,OAAO,CAAP,IAAYD,SAAS,CAAzB,EAA4B;AAC1BA,eAASA,SAAS,IAAI/qC,EAAtB;AACD;;AAEDqP,SAAKm5B,OAAL,CAAaqB,GAAb,EAAkBb,EAAlB,EAAsBC,EAAtB,EAA0BhD,EAA1B,EAA8BC,EAA9B,EAAkCtD,KAAlC,EAAyCmI,MAAzC,EAAiDJ,GAAjD,EAAsDK,EAAtD;AACD;;AAED,WAASmF,yBAAT,CAAmC9hD,IAAnC,EAAyC;AACvC,QAAI,CAACA,IAAL,EAAW;AACT,aAAO,EAAP;AACD,KAHsC,CAGrC;;;AAGF,QAAI+hD,KAAK/hD,KAAKsC,OAAL,CAAa,IAAb,EAAmB,IAAnB,EAAyBA,OAAzB,CAAiC,KAAjC,EAAwC,GAAxC,EAA6CA,OAA7C,CAAqD,IAArD,EAA2D,GAA3D,EAAgEA,OAAhE,CAAwE,KAAxE,EAA+E,GAA/E,CAAT;AACA,QAAI8jB,CAAJ,CAPuC,CAOhC;;AAEP,SAAKA,IAAI,CAAT,EAAYA,IAAI06B,GAAG/iD,MAAnB,EAA2BqoB,GAA3B,EAAgC;AAC9B27B,WAAKA,GAAGz/C,OAAH,CAAW,IAAI0/C,MAAJ,CAAWlB,GAAG16B,CAAH,CAAX,EAAkB,GAAlB,CAAX,EAAmC,MAAM06B,GAAG16B,CAAH,CAAzC,CAAL;AACD,KAXsC,CAWrC;;;AAGF,QAAI67B,MAAMF,GAAG1pC,KAAH,CAAS,GAAT,CAAV,CAduC,CAcd;;AAEzB,QAAI6pC,MAAM,CAAV;AACA,QAAIC,MAAM,CAAV;AACA,QAAInhC,OAAO,IAAIq4B,SAAJ,EAAX;AACA,QAAIf,MAAMe,UAAUf,GAApB;AACA,QAAI8J,OAAJ;;AAEA,SAAKh8B,IAAI,CAAT,EAAYA,IAAI67B,IAAIlkD,MAApB,EAA4BqoB,GAA5B,EAAiC;AAC/B,UAAI/jB,MAAM4/C,IAAI77B,CAAJ,CAAV;AACA,UAAIytB,IAAIxxC,IAAIwU,MAAJ,CAAW,CAAX,CAAR;AACA,UAAIzO,MAAM,CAAV;AACA,UAAIkK,IAAIjQ,IAAIxF,KAAJ,CAAU,CAAV,EAAayF,OAAb,CAAqB,MAArB,EAA6B,IAA7B,EAAmC+V,KAAnC,CAAyC,GAAzC,CAAR;AACA,UAAImjC,GAAJ;;AAEA,UAAIlpC,EAAEvU,MAAF,GAAW,CAAX,IAAgBuU,EAAE,CAAF,MAAS,EAA7B,EAAiC;AAC/BA,UAAE+vC,KAAF;AACD;;AAED,WAAK,IAAIxkD,IAAI,CAAb,EAAgBA,IAAIyU,EAAEvU,MAAtB,EAA8BF,GAA9B,EAAmC;AACjCyU,UAAEzU,CAAF,IAAOiZ,WAAWxE,EAAEzU,CAAF,CAAX,CAAP;AACD;;AAED,aAAOuK,MAAMkK,EAAEvU,MAAR,IAAkB,CAACie,MAAM1J,EAAElK,GAAF,CAAN,CAA1B,EAAyC;AACvC,YAAI4T,MAAM1J,EAAE,CAAF,CAAN,CAAJ,EAAiB;AACf;AACD;;AAED,YAAIgwC,MAAJ;AACA,YAAIC,MAAJ;AACA,YAAI3K,EAAJ;AACA,YAAIC,EAAJ;AACA,YAAIyE,GAAJ;AACA,YAAIiF,EAAJ;AACA,YAAI5E,EAAJ;AACA,YAAIrH,KAAK4M,GAAT;AACA,YAAI3M,KAAK4M,GAAT,CAbuC,CAazB;;AAEd,gBAAQtO,CAAR;AACE,eAAK,GAAL;AACEqO,mBAAO5vC,EAAElK,KAAF,CAAP;AACA+5C,mBAAO7vC,EAAElK,KAAF,CAAP;AACAozC,kBAAMlD,IAAIp/B,CAAV;AACA8H,iBAAKm5B,OAAL,CAAaqB,GAAb,EAAkB0G,GAAlB,EAAuBC,GAAvB;AACA;;AAEF,eAAK,GAAL;AACED,kBAAM5vC,EAAElK,KAAF,CAAN;AACA+5C,kBAAM7vC,EAAElK,KAAF,CAAN;AACAozC,kBAAMlD,IAAIp/B,CAAV;AACA8H,iBAAKm5B,OAAL,CAAaqB,GAAb,EAAkB0G,GAAlB,EAAuBC,GAAvB;AACA;;AAEF,eAAK,GAAL;AACED,mBAAO5vC,EAAElK,KAAF,CAAP;AACA+5C,mBAAO7vC,EAAElK,KAAF,CAAP;AACAozC,kBAAMlD,IAAIC,CAAV;AACAv3B,iBAAKm5B,OAAL,CAAaqB,GAAb,EAAkB0G,GAAlB,EAAuBC,GAAvB;AACAtO,gBAAI,GAAJ;AACA;;AAEF,eAAK,GAAL;AACEqO,kBAAM5vC,EAAElK,KAAF,CAAN;AACA+5C,kBAAM7vC,EAAElK,KAAF,CAAN;AACAozC,kBAAMlD,IAAIC,CAAV;AACAv3B,iBAAKm5B,OAAL,CAAaqB,GAAb,EAAkB0G,GAAlB,EAAuBC,GAAvB;AACAtO,gBAAI,GAAJ;AACA;;AAEF,eAAK,GAAL;AACEqO,mBAAO5vC,EAAElK,KAAF,CAAP;AACAozC,kBAAMlD,IAAIp/B,CAAV;AACA8H,iBAAKm5B,OAAL,CAAaqB,GAAb,EAAkB0G,GAAlB,EAAuBC,GAAvB;AACA;;AAEF,eAAK,GAAL;AACED,kBAAM5vC,EAAElK,KAAF,CAAN;AACAozC,kBAAMlD,IAAIp/B,CAAV;AACA8H,iBAAKm5B,OAAL,CAAaqB,GAAb,EAAkB0G,GAAlB,EAAuBC,GAAvB;AACA;;AAEF,eAAK,GAAL;AACEA,mBAAO7vC,EAAElK,KAAF,CAAP;AACAozC,kBAAMlD,IAAIp/B,CAAV;AACA8H,iBAAKm5B,OAAL,CAAaqB,GAAb,EAAkB0G,GAAlB,EAAuBC,GAAvB;AACA;;AAEF,eAAK,GAAL;AACEA,kBAAM7vC,EAAElK,KAAF,CAAN;AACAozC,kBAAMlD,IAAIp/B,CAAV;AACA8H,iBAAKm5B,OAAL,CAAaqB,GAAb,EAAkB0G,GAAlB,EAAuBC,GAAvB;AACA;;AAEF,eAAK,GAAL;AACE3G,kBAAMlD,IAAIvE,CAAV;AACA/yB,iBAAKm5B,OAAL,CAAaqB,GAAb,EAAkBlpC,EAAElK,KAAF,CAAlB,EAA4BkK,EAAElK,KAAF,CAA5B,EAAsCkK,EAAElK,KAAF,CAAtC,EAAgDkK,EAAElK,KAAF,CAAhD,EAA0DkK,EAAElK,KAAF,CAA1D,EAAoEkK,EAAElK,KAAF,CAApE;AACA85C,kBAAM5vC,EAAElK,MAAM,CAAR,CAAN;AACA+5C,kBAAM7vC,EAAElK,MAAM,CAAR,CAAN;AACA;;AAEF,eAAK,GAAL;AACEozC,kBAAMlD,IAAIvE,CAAV;AACA/yB,iBAAKm5B,OAAL,CAAaqB,GAAb,EAAkBlpC,EAAElK,KAAF,IAAW85C,GAA7B,EAAkC5vC,EAAElK,KAAF,IAAW+5C,GAA7C,EAAkD7vC,EAAElK,KAAF,IAAW85C,GAA7D,EAAkE5vC,EAAElK,KAAF,IAAW+5C,GAA7E,EAAkF7vC,EAAElK,KAAF,IAAW85C,GAA7F,EAAkG5vC,EAAElK,KAAF,IAAW+5C,GAA7G;AACAD,mBAAO5vC,EAAElK,MAAM,CAAR,CAAP;AACA+5C,mBAAO7vC,EAAElK,MAAM,CAAR,CAAP;AACA;;AAEF,eAAK,GAAL;AACEk6C,qBAASJ,GAAT;AACAK,qBAASJ,GAAT;AACA,gBAAIrkD,MAAMkjB,KAAKljB,GAAL,EAAV;AACA,gBAAI+gD,WAAW79B,KAAKhhB,IAApB;;AAEA,gBAAIoiD,YAAY9J,IAAIvE,CAApB,EAAuB;AACrBuO,wBAAUJ,MAAMrD,SAAS/gD,MAAM,CAAf,CAAhB;AACAykD,wBAAUJ,MAAMtD,SAAS/gD,MAAM,CAAf,CAAhB;AACD;;AAED09C,kBAAMlD,IAAIvE,CAAV;AACAuB,iBAAKhjC,EAAElK,KAAF,CAAL;AACAmtC,iBAAKjjC,EAAElK,KAAF,CAAL;AACA85C,kBAAM5vC,EAAElK,KAAF,CAAN;AACA+5C,kBAAM7vC,EAAElK,KAAF,CAAN;AACA4Y,iBAAKm5B,OAAL,CAAaqB,GAAb,EAAkB8G,MAAlB,EAA0BC,MAA1B,EAAkCjN,EAAlC,EAAsCC,EAAtC,EAA0C2M,GAA1C,EAA+CC,GAA/C;AACA;;AAEF,eAAK,GAAL;AACEG,qBAASJ,GAAT;AACAK,qBAASJ,GAAT;AACA,gBAAIrkD,MAAMkjB,KAAKljB,GAAL,EAAV;AACA,gBAAI+gD,WAAW79B,KAAKhhB,IAApB;;AAEA,gBAAIoiD,YAAY9J,IAAIvE,CAApB,EAAuB;AACrBuO,wBAAUJ,MAAMrD,SAAS/gD,MAAM,CAAf,CAAhB;AACAykD,wBAAUJ,MAAMtD,SAAS/gD,MAAM,CAAf,CAAhB;AACD;;AAED09C,kBAAMlD,IAAIvE,CAAV;AACAuB,iBAAK4M,MAAM5vC,EAAElK,KAAF,CAAX;AACAmtC,iBAAK4M,MAAM7vC,EAAElK,KAAF,CAAX;AACA85C,mBAAO5vC,EAAElK,KAAF,CAAP;AACA+5C,mBAAO7vC,EAAElK,KAAF,CAAP;AACA4Y,iBAAKm5B,OAAL,CAAaqB,GAAb,EAAkB8G,MAAlB,EAA0BC,MAA1B,EAAkCjN,EAAlC,EAAsCC,EAAtC,EAA0C2M,GAA1C,EAA+CC,GAA/C;AACA;;AAEF,eAAK,GAAL;AACE7M,iBAAKhjC,EAAElK,KAAF,CAAL;AACAmtC,iBAAKjjC,EAAElK,KAAF,CAAL;AACA85C,kBAAM5vC,EAAElK,KAAF,CAAN;AACA+5C,kBAAM7vC,EAAElK,KAAF,CAAN;AACAozC,kBAAMlD,IAAIE,CAAV;AACAx3B,iBAAKm5B,OAAL,CAAaqB,GAAb,EAAkBlG,EAAlB,EAAsBC,EAAtB,EAA0B2M,GAA1B,EAA+BC,GAA/B;AACA;;AAEF,eAAK,GAAL;AACE7M,iBAAKhjC,EAAElK,KAAF,IAAW85C,GAAhB;AACA3M,iBAAKjjC,EAAElK,KAAF,IAAW+5C,GAAhB;AACAD,mBAAO5vC,EAAElK,KAAF,CAAP;AACA+5C,mBAAO7vC,EAAElK,KAAF,CAAP;AACAozC,kBAAMlD,IAAIE,CAAV;AACAx3B,iBAAKm5B,OAAL,CAAaqB,GAAb,EAAkBlG,EAAlB,EAAsBC,EAAtB,EAA0B2M,GAA1B,EAA+BC,GAA/B;AACA;;AAEF,eAAK,GAAL;AACEG,qBAASJ,GAAT;AACAK,qBAASJ,GAAT;AACA,gBAAIrkD,MAAMkjB,KAAKljB,GAAL,EAAV;AACA,gBAAI+gD,WAAW79B,KAAKhhB,IAApB;;AAEA,gBAAIoiD,YAAY9J,IAAIE,CAApB,EAAuB;AACrB8J,wBAAUJ,MAAMrD,SAAS/gD,MAAM,CAAf,CAAhB;AACAykD,wBAAUJ,MAAMtD,SAAS/gD,MAAM,CAAf,CAAhB;AACD;;AAEDokD,kBAAM5vC,EAAElK,KAAF,CAAN;AACA+5C,kBAAM7vC,EAAElK,KAAF,CAAN;AACAozC,kBAAMlD,IAAIE,CAAV;AACAx3B,iBAAKm5B,OAAL,CAAaqB,GAAb,EAAkB8G,MAAlB,EAA0BC,MAA1B,EAAkCL,GAAlC,EAAuCC,GAAvC;AACA;;AAEF,eAAK,GAAL;AACEG,qBAASJ,GAAT;AACAK,qBAASJ,GAAT;AACA,gBAAIrkD,MAAMkjB,KAAKljB,GAAL,EAAV;AACA,gBAAI+gD,WAAW79B,KAAKhhB,IAApB;;AAEA,gBAAIoiD,YAAY9J,IAAIE,CAApB,EAAuB;AACrB8J,wBAAUJ,MAAMrD,SAAS/gD,MAAM,CAAf,CAAhB;AACAykD,wBAAUJ,MAAMtD,SAAS/gD,MAAM,CAAf,CAAhB;AACD;;AAEDokD,mBAAO5vC,EAAElK,KAAF,CAAP;AACA+5C,mBAAO7vC,EAAElK,KAAF,CAAP;AACAozC,kBAAMlD,IAAIE,CAAV;AACAx3B,iBAAKm5B,OAAL,CAAaqB,GAAb,EAAkB8G,MAAlB,EAA0BC,MAA1B,EAAkCL,GAAlC,EAAuCC,GAAvC;AACA;;AAEF,eAAK,GAAL;AACEvK,iBAAKtlC,EAAElK,KAAF,CAAL;AACAyvC,iBAAKvlC,EAAElK,KAAF,CAAL;AACAk0C,kBAAMhqC,EAAElK,KAAF,CAAN;AACAm5C,iBAAKjvC,EAAElK,KAAF,CAAL;AACAu0C,iBAAKrqC,EAAElK,KAAF,CAAL;AACAktC,iBAAK4M,GAAL,EAAU3M,KAAK4M,GAAf;AACAD,kBAAM5vC,EAAElK,KAAF,CAAN;AACA+5C,kBAAM7vC,EAAElK,KAAF,CAAN;AACAozC,kBAAMlD,IAAIxE,CAAV;AACAwN,uBAAWhM,EAAX,EAAeC,EAAf,EAAmB2M,GAAnB,EAAwBC,GAAxB,EAA6BZ,EAA7B,EAAiC5E,EAAjC,EAAqC/E,EAArC,EAAyCC,EAAzC,EAA6CyE,GAA7C,EAAkDd,GAAlD,EAAuDx6B,IAAvD;AACA;;AAEF,eAAK,GAAL;AACE42B,iBAAKtlC,EAAElK,KAAF,CAAL;AACAyvC,iBAAKvlC,EAAElK,KAAF,CAAL;AACAk0C,kBAAMhqC,EAAElK,KAAF,CAAN;AACAm5C,iBAAKjvC,EAAElK,KAAF,CAAL;AACAu0C,iBAAKrqC,EAAElK,KAAF,CAAL;AACAktC,iBAAK4M,GAAL,EAAU3M,KAAK4M,GAAf;AACAD,mBAAO5vC,EAAElK,KAAF,CAAP;AACA+5C,mBAAO7vC,EAAElK,KAAF,CAAP;AACAozC,kBAAMlD,IAAIxE,CAAV;AACAwN,uBAAWhM,EAAX,EAAeC,EAAf,EAAmB2M,GAAnB,EAAwBC,GAAxB,EAA6BZ,EAA7B,EAAiC5E,EAAjC,EAAqC/E,EAArC,EAAyCC,EAAzC,EAA6CyE,GAA7C,EAAkDd,GAAlD,EAAuDx6B,IAAvD;AACA;AAvLJ;AAyLD;;AAED,UAAI6yB,MAAM,GAAN,IAAaA,MAAM,GAAvB,EAA4B;AAC1B2H,cAAMlD,IAAIG,CAAV;AACAz3B,aAAKm5B,OAAL,CAAaqB,GAAb;AACD;;AAED4G,gBAAU5G,GAAV;AACD;;AAEDx6B,SAAK+5B,QAAL;AACA,WAAO/5B,IAAP;AACD,GAv1b2B,CAu1b1B;;;AAGF,WAASwhC,iBAAT,CAA2BngD,GAA3B,EAAgC+M,IAAhC,EAAsC;AACpC,QAAIqzC,YAAYX,0BAA0Bz/C,GAA1B,CAAhB;AACA+M,WAAOA,QAAQ,EAAf;;AAEAA,SAAKyoB,SAAL,GAAiB,UAAU7W,IAAV,EAAgB;AAC/B,UAAIA,KAAKm6B,OAAT,EAAkB;AAChBn6B,aAAKm6B,OAAL,CAAasH,UAAUziD,IAAvB,EADgB,CACc;;AAE9B,YAAIkI,MAAM8Y,KAAKplB,UAAL,EAAV;;AAEA,YAAIsM,GAAJ,EAAS;AACP8Y,eAAKu7B,WAAL,CAAiBr0C,GAAjB;AACD;AACF,OARD,MAQO;AACL,YAAIA,MAAM8Y,IAAV;AACAyhC,kBAAUlG,WAAV,CAAsBr0C,GAAtB;AACD;AACF,KAbD;;AAeAkH,SAAKvJ,cAAL,GAAsB,UAAUC,CAAV,EAAa;AACjC86C,oBAAc6B,SAAd,EAAyB38C,CAAzB;AACA,WAAKub,KAAL,CAAW,IAAX;AACD,KAHD;;AAKA,WAAOjS,IAAP;AACD;AACD;;;;;;AAOA,WAASszC,gBAAT,CAA0BrgD,GAA1B,EAA+B+M,IAA/B,EAAqC;AACnC,WAAO,IAAI4vC,IAAJ,CAASwD,kBAAkBngD,GAAlB,EAAuB+M,IAAvB,CAAT,CAAP;AACD;AACD;;;;;;AAMA,WAASuzC,gBAAT,CAA0BtgD,GAA1B,EAA+B+M,IAA/B,EAAqC;AACnC,WAAO4vC,KAAKhgD,MAAL,CAAYwjD,kBAAkBngD,GAAlB,EAAuB+M,IAAvB,CAAZ,CAAP;AACD;AACD;;;AAGA;AACA;AACA;;AAEA,WAASwzC,WAAT,CAAqBC,OAArB,EAA8BzzC,IAA9B,EAAoC;AAClC,QAAI0zC,WAAW,EAAf;AACA,QAAIhlD,MAAM+kD,QAAQ9kD,MAAlB;;AAEA,SAAK,IAAIF,IAAI,CAAb,EAAgBA,IAAIC,GAApB,EAAyBD,GAAzB,EAA8B;AAC5B,UAAIklD,SAASF,QAAQhlD,CAAR,CAAb;;AAEA,UAAI,CAACklD,OAAO/hC,IAAZ,EAAkB;AAChB+hC,eAAOnD,eAAP;AACD;;AAED,UAAImD,OAAO9D,WAAX,EAAwB;AACtB8D,eAAOlrB,SAAP,CAAiBkrB,OAAO/hC,IAAxB,EAA8B+hC,OAAOjrB,KAArC,EAA4C,IAA5C;AACD;;AAEDgrB,eAASziD,IAAT,CAAc0iD,OAAO/hC,IAArB;AACD;;AAED,QAAIgiC,aAAa,IAAIhE,IAAJ,CAAS5vC,IAAT,CAAjB,CAlBkC,CAkBD;;AAEjC4zC,eAAWpD,eAAX;;AAEAoD,eAAWnrB,SAAX,GAAuB,UAAU7W,IAAV,EAAgB;AACrCA,WAAKq6B,UAAL,CAAgByH,QAAhB,EADqC,CACV;;AAE3B,UAAI56C,MAAM8Y,KAAKplB,UAAL,EAAV;;AAEA,UAAIsM,GAAJ,EAAS;AACP8Y,aAAKu7B,WAAL,CAAiBr0C,GAAjB;AACD;AACF,KARD;;AAUA,WAAO86C,UAAP;AACD;;AAED;;;;;;;AAOA,MAAIC,OAAO,SAAPA,IAAO,CAAU7zC,IAAV,EAAgB;AACzB;AACAusB,gBAAYh+B,IAAZ,CAAiB,IAAjB,EAAuByR,IAAvB;AACD,GAHD;;AAKA6zC,OAAK7mD,SAAL,GAAiB;AACf6B,iBAAaglD,IADE;AAEfhiD,UAAM,MAFS;AAGfi7B,WAAO,eAAUh0B,GAAV,EAAeqmB,MAAf,EAAuB;AAC5B,UAAIC,QAAQ,KAAKA,KAAjB,CAD4B,CACJ;;AAExB,WAAK7J,OAAL,IAAgBiU,mBAAmBpK,KAAnB,EAA0B,IAA1B,CAAhB,CAH4B,CAGqB;;AAEjDA,YAAMlD,IAAN,GAAakD,MAAMjD,MAAN,GAAeiD,MAAM7C,UAAN,GAAmB6C,MAAM00B,WAAN,GAAoB10B,MAAM5C,aAAN,GAAsB4C,MAAM3C,aAAN,GAAsB,IAA/G;AACA,UAAIG,OAAOwC,MAAMxC,IAAjB,CAN4B,CAML;;AAEvBA,cAAQ,IAAR,KAAiBA,QAAQ,EAAzB,EAR4B,CAQE;;AAE9BwC,YAAMhuB,IAAN,CAAW0H,GAAX,EAAgB,IAAhB,EAAsBqmB,MAAtB;;AAEA,UAAI,CAACgN,aAAavP,IAAb,EAAmBwC,KAAnB,CAAL,EAAgC;AAC9B;AACD;;AAED,WAAKze,YAAL,CAAkB7H,GAAlB;AACA6wB,iBAAW,IAAX,EAAiB7wB,GAAjB,EAAsB8jB,IAAtB,EAA4BwC,KAA5B;AACA,WAAKve,gBAAL,CAAsB/H,GAAtB;AACD,KAtBc;AAuBfyd,qBAAiB,2BAAY;AAC3B,UAAI6I,QAAQ,KAAKA,KAAjB,CAD2B,CACH;;AAExB,WAAK7J,OAAL,IAAgBiU,mBAAmBpK,KAAnB,EAA0B,IAA1B,CAAhB;;AAEA,UAAI,CAAC,KAAKoN,KAAV,EAAiB;AACf,YAAI5P,OAAOwC,MAAMxC,IAAjB;AACAA,gBAAQ,IAAR,GAAeA,QAAQ,EAAvB,GAA4BA,OAAO,EAAnC;AACA,YAAI1H,OAAOqB,iBAAgB6I,MAAMxC,IAAN,GAAa,EAA7B,EAAiCwC,MAAMvC,IAAvC,EAA6CuC,MAAMvB,SAAnD,EAA8DuB,MAAMtB,iBAApE,EAAuFsB,MAAML,WAA7F,EAA0GK,MAAMJ,IAAhH,CAAX;AACA9J,aAAKtgB,CAAL,IAAUwqB,MAAMxqB,CAAN,IAAW,CAArB;AACAsgB,aAAKrgB,CAAL,IAAUuqB,MAAMvqB,CAAN,IAAW,CAArB;;AAEA,YAAIg2B,UAAUzL,MAAM/B,UAAhB,EAA4B+B,MAAM5B,eAAlC,CAAJ,EAAwD;AACtD,cAAIlO,IAAI8P,MAAM5B,eAAd;AACAtI,eAAKtgB,CAAL,IAAU0a,IAAI,CAAd;AACA4F,eAAKrgB,CAAL,IAAUya,IAAI,CAAd;AACA4F,eAAKpB,KAAL,IAAcxE,CAAd;AACA4F,eAAKnB,MAAL,IAAezE,CAAf;AACD;;AAED,aAAKkd,KAAL,GAAatX,IAAb;AACD;;AAED,aAAO,KAAKsX,KAAZ;AACD;AA/Cc,GAAjB;AAiDAr8B,WAAS0jD,IAAT,EAAetnB,WAAf;;AAEA;;;;AAIA,MAAIwnB,SAASnE,KAAKhgD,MAAL,CAAY;AACvBiC,UAAM,QADiB;AAEvB62B,WAAO;AACL6iB,UAAI,CADC;AAELC,UAAI,CAFC;AAGLxjC,SAAG;AAHE,KAFgB;AAOvBygB,eAAW,mBAAU3vB,GAAV,EAAe4vB,KAAf,EAAsB6nB,QAAtB,EAAgC;AACzC;AACA;AACA,UAAIA,QAAJ,EAAc;AACZz3C,YAAIkwB,MAAJ,CAAWN,MAAM6iB,EAAN,GAAW7iB,MAAM1gB,CAA5B,EAA+B0gB,MAAM8iB,EAArC;AACD,OALwC,CAKvC;AACF;AACA;AACA;AACA;AACA;AACA;;;AAGA1yC,UAAIowB,GAAJ,CAAQR,MAAM6iB,EAAd,EAAkB7iB,MAAM8iB,EAAxB,EAA4B9iB,MAAM1gB,CAAlC,EAAqC,CAArC,EAAwCzS,KAAKgN,EAAL,GAAU,CAAlD,EAAqD,IAArD;AACD;AAtBsB,GAAZ,CAAb;;AAyBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,MAAIyxC,aAAa,CAAC,CAAC,YAAD,EAAe,CAAf,CAAD,EAAoB,CAAC,aAAD,EAAgB,MAAhB,CAApB,EAA6C,CAAC,eAAD,EAAkB,CAAlB,CAA7C,EAAmE,CAAC,eAAD,EAAkB,CAAlB,CAAnE,CAAjB;AACA,MAAIC,oBAAoB,SAApBA,iBAAoB,CAAUC,YAAV,EAAwB;AAC9C;AACA,WAAOpoD,MAAMb,OAAN,CAAciB,EAAd,IAAoBJ,MAAMb,OAAN,CAAcqB,OAAd,IAAyB,EAA7C,GAAkD,YAAY;AACnE,UAAIuuB,YAAY,KAAKI,WAArB;AACA,UAAImE,QAAQ,KAAKA,KAAjB;AACA,UAAI+0B,QAAJ;;AAEA,UAAIt5B,SAAJ,EAAe;AACb,aAAK,IAAIpsB,IAAI,CAAb,EAAgBA,IAAIosB,UAAUlsB,MAA9B,EAAsCF,GAAtC,EAA2C;AACzC,cAAIgP,WAAWod,UAAUpsB,CAAV,CAAf;AACA,cAAIi6B,QAAQjrB,YAAYA,SAASirB,KAAjC;AACA,cAAI72B,OAAO4L,YAAYA,SAAS5L,IAAhC;;AAEA,cAAI62B,UAAU72B,SAAS,QAAT,IAAqB62B,MAAMggB,UAAN,KAAqBhgB,MAAMigB,QAAhD,IAA4D92C,SAAS,MAAT,KAAoB,CAAC62B,MAAM5U,KAAP,IAAgB,CAAC4U,MAAM3U,MAA3C,CAAtE,CAAJ,EAA+H;AAC7H,iBAAK,IAAI1H,IAAI,CAAb,EAAgBA,IAAI2nC,WAAWrlD,MAA/B,EAAuC0d,GAAvC,EAA4C;AAC1C;AACA;AACA2nC,yBAAW3nC,CAAX,EAAc,CAAd,IAAmB+S,MAAM40B,WAAW3nC,CAAX,EAAc,CAAd,CAAN,CAAnB;AACA+S,oBAAM40B,WAAW3nC,CAAX,EAAc,CAAd,CAAN,IAA0B2nC,WAAW3nC,CAAX,EAAc,CAAd,CAA1B;AACD;;AAED8nC,uBAAW,IAAX;AACA;AACD;AACF;AACF;;AAEDD,mBAAa1iD,KAAb,CAAmB,IAAnB,EAAyBD,SAAzB;;AAEA,UAAI4iD,QAAJ,EAAc;AACZ,aAAK,IAAI9nC,IAAI,CAAb,EAAgBA,IAAI2nC,WAAWrlD,MAA/B,EAAuC0d,GAAvC,EAA4C;AAC1C+S,gBAAM40B,WAAW3nC,CAAX,EAAc,CAAd,CAAN,IAA0B2nC,WAAW3nC,CAAX,EAAc,CAAd,CAA1B;AACD;AACF;AACF,KAhCM,GAgCH6nC,YAhCJ;AAiCD,GAnCD;;AAqCA;;;;AAIA,MAAIE,SAASxE,KAAKhgD,MAAL,CAAY;AACvBiC,UAAM,QADiB;AAEvB62B,WAAO;AACL6iB,UAAI,CADC;AAELC,UAAI,CAFC;AAGL6I,UAAI,CAHC;AAILrsC,SAAG,CAJE;AAKL0gC,kBAAY,CALP;AAMLC,gBAAUpzC,KAAKgN,EAAL,GAAU,CANf;AAOL+xC,iBAAW;AAPN,KAFgB;AAWvBxnB,WAAOmnB,kBAAkBrE,KAAK5iD,SAAL,CAAe8/B,KAAjC,CAXgB;AAYvBrE,eAAW,mBAAU3vB,GAAV,EAAe4vB,KAAf,EAAsB;AAC/B,UAAI9zB,IAAI8zB,MAAM6iB,EAAd;AACA,UAAI12C,IAAI6zB,MAAM8iB,EAAd;AACA,UAAI6I,KAAK9+C,KAAKqB,GAAL,CAAS8xB,MAAM2rB,EAAN,IAAY,CAArB,EAAwB,CAAxB,CAAT;AACA,UAAIrsC,IAAIzS,KAAKqB,GAAL,CAAS8xB,MAAM1gB,CAAf,EAAkB,CAAlB,CAAR;AACA,UAAI0gC,aAAahgB,MAAMggB,UAAvB;AACA,UAAIC,WAAWjgB,MAAMigB,QAArB;AACA,UAAI2L,YAAY5rB,MAAM4rB,SAAtB;AACA,UAAIC,QAAQh/C,KAAK6J,GAAL,CAASspC,UAAT,CAAZ;AACA,UAAI8L,QAAQj/C,KAAK2J,GAAL,CAASwpC,UAAT,CAAZ;AACA5vC,UAAIkwB,MAAJ,CAAWurB,QAAQF,EAAR,GAAaz/C,CAAxB,EAA2B4/C,QAAQH,EAAR,GAAax/C,CAAxC;AACAiE,UAAImwB,MAAJ,CAAWsrB,QAAQvsC,CAAR,GAAYpT,CAAvB,EAA0B4/C,QAAQxsC,CAAR,GAAYnT,CAAtC;AACAiE,UAAIowB,GAAJ,CAAQt0B,CAAR,EAAWC,CAAX,EAAcmT,CAAd,EAAiB0gC,UAAjB,EAA6BC,QAA7B,EAAuC,CAAC2L,SAAxC;AACAx7C,UAAImwB,MAAJ,CAAW1zB,KAAK6J,GAAL,CAASupC,QAAT,IAAqB0L,EAArB,GAA0Bz/C,CAArC,EAAwCW,KAAK2J,GAAL,CAASypC,QAAT,IAAqB0L,EAArB,GAA0Bx/C,CAAlE;;AAEA,UAAIw/C,OAAO,CAAX,EAAc;AACZv7C,YAAIowB,GAAJ,CAAQt0B,CAAR,EAAWC,CAAX,EAAcw/C,EAAd,EAAkB1L,QAAlB,EAA4BD,UAA5B,EAAwC4L,SAAxC;AACD;;AAEDx7C,UAAI8yB,SAAJ;AACD;AAhCsB,GAAZ,CAAb;;AAmCA;;;;AAIA,MAAI6oB,OAAO7E,KAAKhgD,MAAL,CAAY;AACrBiC,UAAM,MADe;AAErB62B,WAAO;AACL6iB,UAAI,CADC;AAELC,UAAI,CAFC;AAGLxjC,SAAG,CAHE;AAILqsC,UAAI;AAJC,KAFc;AAQrB5rB,eAAW,mBAAU3vB,GAAV,EAAe4vB,KAAf,EAAsB;AAC/B,UAAI9zB,IAAI8zB,MAAM6iB,EAAd;AACA,UAAI12C,IAAI6zB,MAAM8iB,EAAd;AACA,UAAIlE,MAAM/xC,KAAKgN,EAAL,GAAU,CAApB;AACAzJ,UAAIkwB,MAAJ,CAAWp0B,IAAI8zB,MAAM1gB,CAArB,EAAwBnT,CAAxB;AACAiE,UAAIowB,GAAJ,CAAQt0B,CAAR,EAAWC,CAAX,EAAc6zB,MAAM1gB,CAApB,EAAuB,CAAvB,EAA0Bs/B,GAA1B,EAA+B,KAA/B;AACAxuC,UAAIkwB,MAAJ,CAAWp0B,IAAI8zB,MAAM2rB,EAArB,EAAyBx/C,CAAzB;AACAiE,UAAIowB,GAAJ,CAAQt0B,CAAR,EAAWC,CAAX,EAAc6zB,MAAM2rB,EAApB,EAAwB,CAAxB,EAA2B/M,GAA3B,EAAgC,IAAhC;AACD;AAhBoB,GAAZ,CAAX;;AAmBA;;;;;;;AAOA;;;;AAIA,WAASoN,WAAT,CAAqB3oC,EAArB,EAAyBC,EAAzB,EAA6Be,EAA7B,EAAiCC,EAAjC,EAAqCxW,CAArC,EAAwCyW,EAAxC,EAA4CC,EAA5C,EAAgD;AAC9C,QAAIE,KAAK,CAACL,KAAKhB,EAAN,IAAY,GAArB;AACA,QAAI5W,KAAK,CAAC6X,KAAKhB,EAAN,IAAY,GAArB;AACA,WAAO,CAAC,KAAKA,KAAKe,EAAV,IAAgBK,EAAhB,GAAqBjY,EAAtB,IAA4B+X,EAA5B,GAAiC,CAAC,CAAC,CAAD,IAAMlB,KAAKe,EAAX,IAAiB,IAAIK,EAArB,GAA0BjY,EAA3B,IAAiC8X,EAAlE,GAAuEG,KAAK5W,CAA5E,GAAgFwV,EAAvF;AACD;AACD;;;;;;;AAQA,MAAI2oC,eAAe,SAAfA,YAAe,CAAUpc,MAAV,EAAkBqc,MAAlB,EAA0B;AAC3C,QAAI5I,SAASzT,OAAO5pC,MAApB;AACA,QAAI2e,MAAM,EAAV;AACA,QAAIunC,cAAc,CAAlB;;AAEA,SAAK,IAAIpmD,IAAI,CAAb,EAAgBA,IAAIu9C,MAApB,EAA4Bv9C,GAA5B,EAAiC;AAC/BomD,qBAAe3+C,SAASqiC,OAAO9pC,IAAI,CAAX,CAAT,EAAwB8pC,OAAO9pC,CAAP,CAAxB,CAAf;AACD;;AAED,QAAIqmD,OAAOD,cAAc,CAAzB;AACAC,WAAOA,OAAO9I,MAAP,GAAgBA,MAAhB,GAAyB8I,IAAhC;;AAEA,SAAK,IAAIrmD,IAAI,CAAb,EAAgBA,IAAIqmD,IAApB,EAA0BrmD,GAA1B,EAA+B;AAC7B,UAAI+pC,MAAM/pC,KAAKqmD,OAAO,CAAZ,KAAkBF,SAAS5I,MAAT,GAAkBA,SAAS,CAA7C,CAAV;AACA,UAAIt2B,MAAMngB,KAAKuV,KAAL,CAAW0tB,GAAX,CAAV;AACA,UAAIlpB,IAAIkpB,MAAM9iB,GAAd;AACA,UAAI3J,EAAJ;AACA,UAAIC,KAAKusB,OAAO7iB,MAAMs2B,MAAb,CAAT;AACA,UAAIj/B,EAAJ;AACA,UAAIC,EAAJ;;AAEA,UAAI,CAAC4nC,MAAL,EAAa;AACX7oC,aAAKwsB,OAAO7iB,QAAQ,CAAR,GAAYA,GAAZ,GAAkBA,MAAM,CAA/B,CAAL;AACA3I,aAAKwrB,OAAO7iB,MAAMs2B,SAAS,CAAf,GAAmBA,SAAS,CAA5B,GAAgCt2B,MAAM,CAA7C,CAAL;AACA1I,aAAKurB,OAAO7iB,MAAMs2B,SAAS,CAAf,GAAmBA,SAAS,CAA5B,GAAgCt2B,MAAM,CAA7C,CAAL;AACD,OAJD,MAIO;AACL3J,aAAKwsB,OAAO,CAAC7iB,MAAM,CAAN,GAAUs2B,MAAX,IAAqBA,MAA5B,CAAL;AACAj/B,aAAKwrB,OAAO,CAAC7iB,MAAM,CAAP,IAAYs2B,MAAnB,CAAL;AACAh/B,aAAKurB,OAAO,CAAC7iB,MAAM,CAAP,IAAYs2B,MAAnB,CAAL;AACD;;AAED,UAAI+I,KAAKzlC,IAAIA,CAAb;AACA,UAAI0lC,KAAK1lC,IAAIylC,EAAb;AACAznC,UAAIrc,IAAJ,CAAS,CAACyjD,YAAY3oC,GAAG,CAAH,CAAZ,EAAmBC,GAAG,CAAH,CAAnB,EAA0Be,GAAG,CAAH,CAA1B,EAAiCC,GAAG,CAAH,CAAjC,EAAwCsC,CAAxC,EAA2CylC,EAA3C,EAA+CC,EAA/C,CAAD,EAAqDN,YAAY3oC,GAAG,CAAH,CAAZ,EAAmBC,GAAG,CAAH,CAAnB,EAA0Be,GAAG,CAAH,CAA1B,EAAiCC,GAAG,CAAH,CAAjC,EAAwCsC,CAAxC,EAA2CylC,EAA3C,EAA+CC,EAA/C,CAArD,CAAT;AACD;;AAED,WAAO1nC,GAAP;AACD,GArCD;;AAuCA;;;;;;;AAOA;;;;;;;;;;;;AAYA,MAAI2nC,eAAe,SAAfA,YAAe,CAAU1c,MAAV,EAAkB2c,MAAlB,EAA0BN,MAA1B,EAAkCO,UAAlC,EAA8C;AAC/D,QAAIC,MAAM,EAAV;AACA,QAAIpgD,IAAI,EAAR;AACA,QAAIG,KAAK,EAAT;AACA,QAAIC,KAAK,EAAT;AACA,QAAIigD,SAAJ;AACA,QAAIC,SAAJ;AACA,QAAI5N,MAAJ,EAAYC,MAAZ;;AAEA,QAAIwN,UAAJ,EAAgB;AACdzN,eAAS,CAACnB,QAAD,EAAWA,QAAX,CAAT;AACAoB,eAAS,CAAC,CAACpB,QAAF,EAAY,CAACA,QAAb,CAAT;;AAEA,WAAK,IAAI93C,IAAI,CAAR,EAAWu9C,SAASzT,OAAO5pC,MAAhC,EAAwCF,IAAIu9C,MAA5C,EAAoDv9C,GAApD,EAAyD;AACvDkI,YAAI+wC,MAAJ,EAAYA,MAAZ,EAAoBnP,OAAO9pC,CAAP,CAApB;AACAmI,YAAI+wC,MAAJ,EAAYA,MAAZ,EAAoBpP,OAAO9pC,CAAP,CAApB;AACD,OAPa,CAOZ;;;AAGFkI,UAAI+wC,MAAJ,EAAYA,MAAZ,EAAoByN,WAAW,CAAX,CAApB;AACAv+C,UAAI+wC,MAAJ,EAAYA,MAAZ,EAAoBwN,WAAW,CAAX,CAApB;AACD;;AAED,SAAK,IAAI1mD,IAAI,CAAR,EAAWu9C,SAASzT,OAAO5pC,MAAhC,EAAwCF,IAAIu9C,MAA5C,EAAoDv9C,GAApD,EAAyD;AACvD,UAAI8mD,QAAQhd,OAAO9pC,CAAP,CAAZ;;AAEA,UAAImmD,MAAJ,EAAY;AACVS,oBAAY9c,OAAO9pC,IAAIA,IAAI,CAAR,GAAYu9C,SAAS,CAA5B,CAAZ;AACAsJ,oBAAY/c,OAAO,CAAC9pC,IAAI,CAAL,IAAUu9C,MAAjB,CAAZ;AACD,OAHD,MAGO;AACL,YAAIv9C,MAAM,CAAN,IAAWA,MAAMu9C,SAAS,CAA9B,EAAiC;AAC/BoJ,cAAInkD,IAAJ,CAASgE,QAAQsjC,OAAO9pC,CAAP,CAAR,CAAT;AACA;AACD,SAHD,MAGO;AACL4mD,sBAAY9c,OAAO9pC,IAAI,CAAX,CAAZ;AACA6mD,sBAAY/c,OAAO9pC,IAAI,CAAX,CAAZ;AACD;AACF;;AAED6G,UAAIN,CAAJ,EAAOsgD,SAAP,EAAkBD,SAAlB,EAhBuD,CAgBzB;;AAE9Bv/C,YAAMd,CAAN,EAASA,CAAT,EAAYkgD,MAAZ;AACA,UAAIM,KAAKt/C,SAASq/C,KAAT,EAAgBF,SAAhB,CAAT;AACA,UAAI7O,KAAKtwC,SAASq/C,KAAT,EAAgBD,SAAhB,CAAT;AACA,UAAIG,MAAMD,KAAKhP,EAAf;;AAEA,UAAIiP,QAAQ,CAAZ,EAAe;AACbD,cAAMC,GAAN;AACAjP,cAAMiP,GAAN;AACD;;AAED3/C,YAAMX,EAAN,EAAUH,CAAV,EAAa,CAACwgD,EAAd;AACA1/C,YAAMV,EAAN,EAAUJ,CAAV,EAAawxC,EAAb;AACA,UAAIkP,MAAMxgD,IAAI,EAAJ,EAAQqgD,KAAR,EAAepgD,EAAf,CAAV;AACA,UAAIwgD,MAAMzgD,IAAI,EAAJ,EAAQqgD,KAAR,EAAengD,EAAf,CAAV;;AAEA,UAAI+/C,UAAJ,EAAgB;AACdv+C,YAAI8+C,GAAJ,EAASA,GAAT,EAAchO,MAAd;AACA/wC,YAAI++C,GAAJ,EAASA,GAAT,EAAc/N,MAAd;AACA/wC,YAAI++C,GAAJ,EAASA,GAAT,EAAcjO,MAAd;AACA/wC,YAAIg/C,GAAJ,EAASA,GAAT,EAAchO,MAAd;AACD;;AAEDyN,UAAInkD,IAAJ,CAASykD,GAAT;AACAN,UAAInkD,IAAJ,CAAS0kD,GAAT;AACD;;AAED,QAAIf,MAAJ,EAAY;AACVQ,UAAInkD,IAAJ,CAASmkD,IAAInC,KAAJ,EAAT;AACD;;AAED,WAAOmC,GAAP;AACD,GAxED;;AA0EA,WAASQ,WAAT,CAAqB98C,GAArB,EAA0B4vB,KAA1B,EAAiCkD,SAAjC,EAA4C;AAC1C,QAAI2M,SAAS7P,MAAM6P,MAAnB;AACA,QAAI2c,SAASxsB,MAAMwsB,MAAnB;;AAEA,QAAI3c,UAAUA,OAAO5pC,MAAP,IAAiB,CAA/B,EAAkC;AAChC,UAAIumD,UAAUA,WAAW,QAAzB,EAAmC;AACjC,YAAIW,gBAAgBZ,aAAa1c,MAAb,EAAqB2c,MAArB,EAA6BtpB,SAA7B,EAAwClD,MAAMotB,gBAA9C,CAApB;AACAh9C,YAAIkwB,MAAJ,CAAWuP,OAAO,CAAP,EAAU,CAAV,CAAX,EAAyBA,OAAO,CAAP,EAAU,CAAV,CAAzB;AACA,YAAI7pC,MAAM6pC,OAAO5pC,MAAjB;;AAEA,aAAK,IAAIF,IAAI,CAAb,EAAgBA,KAAKm9B,YAAYl9B,GAAZ,GAAkBA,MAAM,CAA7B,CAAhB,EAAiDD,GAAjD,EAAsD;AACpD,cAAIknD,MAAME,cAAcpnD,IAAI,CAAlB,CAAV;AACA,cAAIsnD,MAAMF,cAAcpnD,IAAI,CAAJ,GAAQ,CAAtB,CAAV;AACA,cAAIyU,IAAIq1B,OAAO,CAAC9pC,IAAI,CAAL,IAAUC,GAAjB,CAAR;AACAoK,cAAIqyC,aAAJ,CAAkBwK,IAAI,CAAJ,CAAlB,EAA0BA,IAAI,CAAJ,CAA1B,EAAkCI,IAAI,CAAJ,CAAlC,EAA0CA,IAAI,CAAJ,CAA1C,EAAkD7yC,EAAE,CAAF,CAAlD,EAAwDA,EAAE,CAAF,CAAxD;AACD;AACF,OAXD,MAWO;AACL,YAAIgyC,WAAW,QAAf,EAAyB;AACvB3c,mBAASoc,aAAapc,MAAb,EAAqB3M,SAArB,CAAT;AACD;;AAED9yB,YAAIkwB,MAAJ,CAAWuP,OAAO,CAAP,EAAU,CAAV,CAAX,EAAyBA,OAAO,CAAP,EAAU,CAAV,CAAzB;;AAEA,aAAK,IAAI9pC,IAAI,CAAR,EAAWyK,IAAIq/B,OAAO5pC,MAA3B,EAAmCF,IAAIyK,CAAvC,EAA0CzK,GAA1C,EAA+C;AAC7CqK,cAAImwB,MAAJ,CAAWsP,OAAO9pC,CAAP,EAAU,CAAV,CAAX,EAAyB8pC,OAAO9pC,CAAP,EAAU,CAAV,CAAzB;AACD;AACF;;AAEDm9B,mBAAa9yB,IAAI8yB,SAAJ,EAAb;AACD;AACF;;AAED;;;;AAIA,MAAIoqB,UAAUpG,KAAKhgD,MAAL,CAAY;AACxBiC,UAAM,SADkB;AAExB62B,WAAO;AACL6P,cAAQ,IADH;AAEL2c,cAAQ,KAFH;AAGLY,wBAAkB;AAHb,KAFiB;AAOxBrtB,eAAW,mBAAU3vB,GAAV,EAAe4vB,KAAf,EAAsB;AAC/BktB,kBAAY98C,GAAZ,EAAiB4vB,KAAjB,EAAwB,IAAxB;AACD;AATuB,GAAZ,CAAd;;AAYA;;;AAGA,MAAIutB,WAAWrG,KAAKhgD,MAAL,CAAY;AACzBiC,UAAM,UADmB;AAEzB62B,WAAO;AACL6P,cAAQ,IADH;AAEL2c,cAAQ,KAFH;AAGLY,wBAAkB;AAHb,KAFkB;AAOzB12B,WAAO;AACLjD,cAAQ,MADH;AAELD,YAAM;AAFD,KAPkB;AAWzBuM,eAAW,mBAAU3vB,GAAV,EAAe4vB,KAAf,EAAsB;AAC/BktB,kBAAY98C,GAAZ,EAAiB4vB,KAAjB,EAAwB,KAAxB;AACD;AAbwB,GAAZ,CAAf;;AAgBA;;;;AAIA,MAAIwtB,OAAOtG,KAAKhgD,MAAL,CAAY;AACrBiC,UAAM,MADe;AAErB62B,WAAO;AACL;AACA;AACA;AACA;AACA;AACA1gB,SAAG,CANE;AAOLpT,SAAG,CAPE;AAQLC,SAAG,CARE;AASLif,aAAO,CATF;AAULC,cAAQ;AAVH,KAFc;AAcrB0U,eAAW,mBAAU3vB,GAAV,EAAe4vB,KAAf,EAAsB;AAC/B,UAAI9zB,IAAI8zB,MAAM9zB,CAAd;AACA,UAAIC,IAAI6zB,MAAM7zB,CAAd;AACA,UAAIif,QAAQ4U,MAAM5U,KAAlB;AACA,UAAIC,SAAS2U,MAAM3U,MAAnB;;AAEA,UAAI,CAAC2U,MAAM1gB,CAAX,EAAc;AACZlP,YAAIoc,IAAJ,CAAStgB,CAAT,EAAYC,CAAZ,EAAeif,KAAf,EAAsBC,MAAtB;AACD,OAFD,MAEO;AACL0U,mBAAU3vB,GAAV,EAAe4vB,KAAf;AACD;;AAED5vB,UAAI8yB,SAAJ;AACA;AACD;AA5BoB,GAAZ,CAAX;;AA+BA;;;;AAIA,MAAIuqB,OAAOvG,KAAKhgD,MAAL,CAAY;AACrBiC,UAAM,MADe;AAErB62B,WAAO;AACL;AACAwd,UAAI,CAFC;AAGLC,UAAI,CAHC;AAIL;AACArqB,UAAI,CALC;AAMLC,UAAI,CANC;AAOLhX,eAAS;AAPJ,KAFc;AAWrBqa,WAAO;AACLjD,cAAQ,MADH;AAELD,YAAM;AAFD,KAXc;AAerBuM,eAAW,mBAAU3vB,GAAV,EAAe4vB,KAAf,EAAsB;AAC/B,UAAIwd,KAAKxd,MAAMwd,EAAf;AACA,UAAIC,KAAKzd,MAAMyd,EAAf;AACA,UAAIrqB,KAAK4M,MAAM5M,EAAf;AACA,UAAIC,KAAK2M,MAAM3M,EAAf;AACA,UAAIhX,UAAU2jB,MAAM3jB,OAApB;;AAEA,UAAIA,YAAY,CAAhB,EAAmB;AACjB;AACD;;AAEDjM,UAAIkwB,MAAJ,CAAWkd,EAAX,EAAeC,EAAf;;AAEA,UAAIphC,UAAU,CAAd,EAAiB;AACf+W,aAAKoqB,MAAM,IAAInhC,OAAV,IAAqB+W,KAAK/W,OAA/B;AACAgX,aAAKoqB,MAAM,IAAIphC,OAAV,IAAqBgX,KAAKhX,OAA/B;AACD;;AAEDjM,UAAImwB,MAAJ,CAAWnN,EAAX,EAAeC,EAAf;AACD,KAlCoB;;AAoCrB;;;;;AAKAq6B,aAAS,iBAAUlzC,CAAV,EAAa;AACpB,UAAIwlB,QAAQ,KAAKA,KAAjB;AACA,aAAO,CAACA,MAAMwd,EAAN,IAAY,IAAIhjC,CAAhB,IAAqBwlB,MAAM5M,EAAN,GAAW5Y,CAAjC,EAAoCwlB,MAAMyd,EAAN,IAAY,IAAIjjC,CAAhB,IAAqBwlB,MAAM3M,EAAN,GAAW7Y,CAApE,CAAP;AACD;AA5CoB,GAAZ,CAAX;;AA+CA;;;;AAIA,MAAIpO,MAAM,EAAV;;AAEA,WAASuhD,YAAT,CAAsB3tB,KAAtB,EAA6BlyB,CAA7B,EAAgC8/C,SAAhC,EAA2C;AACzC,QAAIC,OAAO7tB,MAAM6tB,IAAjB;AACA,QAAIC,OAAO9tB,MAAM8tB,IAAjB;;AAEA,QAAID,SAAS,IAAT,IAAiBC,SAAS,IAA9B,EAAoC;AAClC,aAAO,CAAC,CAACF,YAAY/R,iBAAZ,GAAgCF,OAAjC,EAA0C3b,MAAMwd,EAAhD,EAAoDxd,MAAM+tB,IAA1D,EAAgE/tB,MAAM6tB,IAAtE,EAA4E7tB,MAAM5M,EAAlF,EAAsFtlB,CAAtF,CAAD,EAA2F,CAAC8/C,YAAY/R,iBAAZ,GAAgCF,OAAjC,EAA0C3b,MAAMyd,EAAhD,EAAoDzd,MAAMguB,IAA1D,EAAgEhuB,MAAM8tB,IAAtE,EAA4E9tB,MAAM3M,EAAlF,EAAsFvlB,CAAtF,CAA3F,CAAP;AACD,KAFD,MAEO;AACL,aAAO,CAAC,CAAC8/C,YAAY1P,qBAAZ,GAAoCD,WAArC,EAAkDje,MAAMwd,EAAxD,EAA4Dxd,MAAM+tB,IAAlE,EAAwE/tB,MAAM5M,EAA9E,EAAkFtlB,CAAlF,CAAD,EAAuF,CAAC8/C,YAAY1P,qBAAZ,GAAoCD,WAArC,EAAkDje,MAAMyd,EAAxD,EAA4Dzd,MAAMguB,IAAlE,EAAwEhuB,MAAM3M,EAA9E,EAAkFvlB,CAAlF,CAAvF,CAAP;AACD;AACF;;AAED,MAAImgD,cAAc/G,KAAKhgD,MAAL,CAAY;AAC5BiC,UAAM,cADsB;AAE5B62B,WAAO;AACLwd,UAAI,CADC;AAELC,UAAI,CAFC;AAGLrqB,UAAI,CAHC;AAILC,UAAI,CAJC;AAKL06B,YAAM,CALD;AAMLC,YAAM,CAND;AAOL;AACA;AACA;AACA3xC,eAAS;AAVJ,KAFqB;AAc5Bqa,WAAO;AACLjD,cAAQ,MADH;AAELD,YAAM;AAFD,KAdqB;AAkB5BuM,eAAW,mBAAU3vB,GAAV,EAAe4vB,KAAf,EAAsB;AAC/B,UAAIwd,KAAKxd,MAAMwd,EAAf;AACA,UAAIC,KAAKzd,MAAMyd,EAAf;AACA,UAAIrqB,KAAK4M,MAAM5M,EAAf;AACA,UAAIC,KAAK2M,MAAM3M,EAAf;AACA,UAAI06B,OAAO/tB,MAAM+tB,IAAjB;AACA,UAAIC,OAAOhuB,MAAMguB,IAAjB;AACA,UAAIH,OAAO7tB,MAAM6tB,IAAjB;AACA,UAAIC,OAAO9tB,MAAM8tB,IAAjB;AACA,UAAIzxC,UAAU2jB,MAAM3jB,OAApB;;AAEA,UAAIA,YAAY,CAAhB,EAAmB;AACjB;AACD;;AAEDjM,UAAIkwB,MAAJ,CAAWkd,EAAX,EAAeC,EAAf;;AAEA,UAAIoQ,QAAQ,IAAR,IAAgBC,QAAQ,IAA5B,EAAkC;AAChC,YAAIzxC,UAAU,CAAd,EAAiB;AACfiiC,6BAAmBd,EAAnB,EAAuBuQ,IAAvB,EAA6B36B,EAA7B,EAAiC/W,OAAjC,EAA0CjQ,GAA1C;AACA2hD,iBAAO3hD,IAAI,CAAJ,CAAP;AACAgnB,eAAKhnB,IAAI,CAAJ,CAAL;AACAkyC,6BAAmBb,EAAnB,EAAuBuQ,IAAvB,EAA6B36B,EAA7B,EAAiChX,OAAjC,EAA0CjQ,GAA1C;AACA4hD,iBAAO5hD,IAAI,CAAJ,CAAP;AACAinB,eAAKjnB,IAAI,CAAJ,CAAL;AACD;;AAEDgE,YAAIuyC,gBAAJ,CAAqBoL,IAArB,EAA2BC,IAA3B,EAAiC56B,EAAjC,EAAqCC,EAArC;AACD,OAXD,MAWO;AACL,YAAIhX,UAAU,CAAd,EAAiB;AACfygC,yBAAeU,EAAf,EAAmBuQ,IAAnB,EAAyBF,IAAzB,EAA+Bz6B,EAA/B,EAAmC/W,OAAnC,EAA4CjQ,GAA5C;AACA2hD,iBAAO3hD,IAAI,CAAJ,CAAP;AACAyhD,iBAAOzhD,IAAI,CAAJ,CAAP;AACAgnB,eAAKhnB,IAAI,CAAJ,CAAL;AACA0wC,yBAAeW,EAAf,EAAmBuQ,IAAnB,EAAyBF,IAAzB,EAA+Bz6B,EAA/B,EAAmChX,OAAnC,EAA4CjQ,GAA5C;AACA4hD,iBAAO5hD,IAAI,CAAJ,CAAP;AACA0hD,iBAAO1hD,IAAI,CAAJ,CAAP;AACAinB,eAAKjnB,IAAI,CAAJ,CAAL;AACD;;AAEDgE,YAAIqyC,aAAJ,CAAkBsL,IAAlB,EAAwBC,IAAxB,EAA8BH,IAA9B,EAAoCC,IAApC,EAA0C16B,EAA1C,EAA8CC,EAA9C;AACD;AACF,KA5D2B;;AA8D5B;;;;;AAKAq6B,aAAS,iBAAU5/C,CAAV,EAAa;AACpB,aAAO6/C,aAAa,KAAK3tB,KAAlB,EAAyBlyB,CAAzB,EAA4B,KAA5B,CAAP;AACD,KArE2B;;AAuE5B;;;;;AAKAogD,eAAW,mBAAUpgD,CAAV,EAAa;AACtB,UAAI0M,IAAImzC,aAAa,KAAK3tB,KAAlB,EAAyBlyB,CAAzB,EAA4B,IAA5B,CAAR;AACA,aAAOR,UAAUkN,CAAV,EAAaA,CAAb,CAAP;AACD;AA/E2B,GAAZ,CAAlB;;AAkFA;;;;AAIA,MAAI2zC,MAAMjH,KAAKhgD,MAAL,CAAY;AACpBiC,UAAM,KADc;AAEpB62B,WAAO;AACL6iB,UAAI,CADC;AAELC,UAAI,CAFC;AAGLxjC,SAAG,CAHE;AAIL0gC,kBAAY,CAJP;AAKLC,gBAAUpzC,KAAKgN,EAAL,GAAU,CALf;AAML+xC,iBAAW;AANN,KAFa;AAUpBl1B,WAAO;AACLjD,cAAQ,MADH;AAELD,YAAM;AAFD,KAVa;AAcpBuM,eAAW,mBAAU3vB,GAAV,EAAe4vB,KAAf,EAAsB;AAC/B,UAAI9zB,IAAI8zB,MAAM6iB,EAAd;AACA,UAAI12C,IAAI6zB,MAAM8iB,EAAd;AACA,UAAIxjC,IAAIzS,KAAKqB,GAAL,CAAS8xB,MAAM1gB,CAAf,EAAkB,CAAlB,CAAR;AACA,UAAI0gC,aAAahgB,MAAMggB,UAAvB;AACA,UAAIC,WAAWjgB,MAAMigB,QAArB;AACA,UAAI2L,YAAY5rB,MAAM4rB,SAAtB;AACA,UAAIC,QAAQh/C,KAAK6J,GAAL,CAASspC,UAAT,CAAZ;AACA,UAAI8L,QAAQj/C,KAAK2J,GAAL,CAASwpC,UAAT,CAAZ;AACA5vC,UAAIkwB,MAAJ,CAAWurB,QAAQvsC,CAAR,GAAYpT,CAAvB,EAA0B4/C,QAAQxsC,CAAR,GAAYnT,CAAtC;AACAiE,UAAIowB,GAAJ,CAAQt0B,CAAR,EAAWC,CAAX,EAAcmT,CAAd,EAAiB0gC,UAAjB,EAA6BC,QAA7B,EAAuC,CAAC2L,SAAxC;AACD;AAzBmB,GAAZ,CAAV;;AA4BA;AACA,MAAIwC,eAAelH,KAAKhgD,MAAL,CAAY;AAC7BiC,UAAM,UADuB;AAE7B62B,WAAO;AACLquB,aAAO;AADF,KAFsB;AAK7BC,sBAAkB,4BAAY;AAC5B,UAAIlG,YAAY,KAAKjB,WAArB;AACA,UAAIkH,QAAQ,KAAKruB,KAAL,CAAWquB,KAAvB;;AAEA,WAAK,IAAItoD,IAAI,CAAb,EAAgBA,IAAIsoD,MAAMpoD,MAA1B,EAAkCF,GAAlC,EAAuC;AACrC;AACAqiD,oBAAYA,aAAaiG,MAAMtoD,CAAN,EAASohD,WAAlC;AACD;;AAED,WAAKA,WAAL,GAAmBiB,SAAnB;AACA,WAAKv7B,OAAL,GAAe,KAAKA,OAAL,IAAgBu7B,SAA/B;AACD,KAhB4B;AAiB7BlkB,iBAAa,uBAAY;AACvB,WAAKoqB,gBAAL;;AAEA,UAAID,QAAQ,KAAKruB,KAAL,CAAWquB,KAAX,IAAoB,EAAhC;AACA,UAAIjhD,QAAQ,KAAKsL,cAAL,EAAZ,CAJuB,CAIY;;AAEnC,WAAK,IAAI3S,IAAI,CAAb,EAAgBA,IAAIsoD,MAAMpoD,MAA1B,EAAkCF,GAAlC,EAAuC;AACrC,YAAI,CAACsoD,MAAMtoD,CAAN,EAASmjB,IAAd,EAAoB;AAClBmlC,gBAAMtoD,CAAN,EAAS+hD,eAAT;AACD;;AAEDuG,cAAMtoD,CAAN,EAASmjB,IAAT,CAAck5B,QAAd,CAAuBh1C,MAAM,CAAN,CAAvB,EAAiCA,MAAM,CAAN,CAAjC;AACD;AACF,KA9B4B;AA+B7B2yB,eAAW,mBAAU3vB,GAAV,EAAe4vB,KAAf,EAAsB;AAC/B,UAAIquB,QAAQruB,MAAMquB,KAAN,IAAe,EAA3B;;AAEA,WAAK,IAAItoD,IAAI,CAAb,EAAgBA,IAAIsoD,MAAMpoD,MAA1B,EAAkCF,GAAlC,EAAuC;AACrCsoD,cAAMtoD,CAAN,EAASg6B,SAAT,CAAmB3vB,GAAnB,EAAwBi+C,MAAMtoD,CAAN,EAASi6B,KAAjC,EAAwC,IAAxC;AACD;AACF,KArC4B;AAsC7BmE,gBAAY,sBAAY;AACtB,UAAIkqB,QAAQ,KAAKruB,KAAL,CAAWquB,KAAX,IAAoB,EAAhC;;AAEA,WAAK,IAAItoD,IAAI,CAAb,EAAgBA,IAAIsoD,MAAMpoD,MAA1B,EAAkCF,GAAlC,EAAuC;AACrCsoD,cAAMtoD,CAAN,EAASohD,WAAT,GAAuB,KAAvB;AACD;AACF,KA5C4B;AA6C7Bt5B,qBAAiB,2BAAY;AAC3B,WAAKygC,gBAAL;;AAEA,aAAOpH,KAAK5iD,SAAL,CAAeupB,eAAf,CAA+BhoB,IAA/B,CAAoC,IAApC,CAAP;AACD;AAjD4B,GAAZ,CAAnB;;AAoDA;;;AAGA,MAAI0oD,WAAW,SAAXA,QAAW,CAAU92B,UAAV,EAAsB;AACnC,SAAKA,UAAL,GAAkBA,cAAc,EAAhC;AACD,GAFD;;AAIA82B,WAASjqD,SAAT,GAAqB;AACnB6B,iBAAaooD,QADM;AAEnB72B,kBAAc,sBAAUlsB,MAAV,EAAkBmW,KAAlB,EAAyB;AACrC,WAAK8V,UAAL,CAAgBlvB,IAAhB,CAAqB;AACnBiD,gBAAQA,MADW;AAEnBmW,eAAOA;AAFY,OAArB;AAID;AAPkB,GAArB;;AAUA;;;;;;;;;;AAUA,MAAI6sC,iBAAiB,SAAjBA,cAAiB,CAAUtiD,CAAV,EAAaC,CAAb,EAAgBinB,EAAhB,EAAoBC,EAApB,EAAwBoE,UAAxB,EAAoCg3B,WAApC,EAAiD;AACpE;AACA;AACA;AACA,SAAKviD,CAAL,GAASA,KAAK,IAAL,GAAY,CAAZ,GAAgBA,CAAzB;AACA,SAAKC,CAAL,GAASA,KAAK,IAAL,GAAY,CAAZ,GAAgBA,CAAzB;AACA,SAAKinB,EAAL,GAAUA,MAAM,IAAN,GAAa,CAAb,GAAiBA,EAA3B;AACA,SAAKC,EAAL,GAAUA,MAAM,IAAN,GAAa,CAAb,GAAiBA,EAA3B,CAPoE,CAOrC;;AAE/B,SAAKlqB,IAAL,GAAY,QAAZ,CAToE,CAS9C;;AAEtB,SAAKxH,MAAL,GAAc8sD,eAAe,KAA7B;AACAF,aAAS1oD,IAAT,CAAc,IAAd,EAAoB4xB,UAApB;AACD,GAbD;;AAeA+2B,iBAAelqD,SAAf,GAA2B;AACzB6B,iBAAaqoD;AADY,GAA3B;AAGA/mD,WAAS+mD,cAAT,EAAyBD,QAAzB;;AAEA;;;;;;;;;AASA,MAAIG,iBAAiB,SAAjBA,cAAiB,CAAUxiD,CAAV,EAAaC,CAAb,EAAgBmT,CAAhB,EAAmBmY,UAAnB,EAA+Bg3B,WAA/B,EAA4C;AAC/D;AACA;AACA;AACA,SAAKviD,CAAL,GAASA,KAAK,IAAL,GAAY,GAAZ,GAAkBA,CAA3B;AACA,SAAKC,CAAL,GAASA,KAAK,IAAL,GAAY,GAAZ,GAAkBA,CAA3B;AACA,SAAKmT,CAAL,GAASA,KAAK,IAAL,GAAY,GAAZ,GAAkBA,CAA3B,CAN+D,CAMjC;;AAE9B,SAAKnW,IAAL,GAAY,QAAZ,CAR+D,CAQzC;;AAEtB,SAAKxH,MAAL,GAAc8sD,eAAe,KAA7B;AACAF,aAAS1oD,IAAT,CAAc,IAAd,EAAoB4xB,UAApB;AACD,GAZD;;AAcAi3B,iBAAepqD,SAAf,GAA2B;AACzB6B,iBAAauoD;AADY,GAA3B;AAGAjnD,WAASinD,cAAT,EAAyBH,QAAzB;;AAEA;;;;;;;AAOA,WAASI,qBAAT,CAA+Br3C,IAA/B,EAAqC;AACnCusB,gBAAYh+B,IAAZ,CAAiB,IAAjB,EAAuByR,IAAvB;AACA,SAAKs3C,aAAL,GAAqB,EAArB;AACA,SAAKC,sBAAL,GAA8B,EAA9B;AACA,SAAKC,OAAL,GAAe,CAAf;AACA,SAAKjlB,QAAL,GAAgB,IAAhB;AACD;;AAED8kB,wBAAsBrqD,SAAtB,CAAgCi1B,WAAhC,GAA8C,IAA9C;;AAEAo1B,wBAAsBrqD,SAAtB,CAAgCyqD,gBAAhC,GAAmD,YAAY;AAC7D,SAAKH,aAAL,GAAqB,EAArB;AACA,SAAKC,sBAAL,GAA8B,EAA9B;AACA,SAAKC,OAAL,GAAe,CAAf;AACA,SAAKvlC,KAAL;AACA,SAAKsgB,QAAL,GAAgB,KAAhB;AACD,GAND;;AAQA8kB,wBAAsBrqD,SAAtB,CAAgC0qD,cAAhC,GAAiD,UAAUn6C,WAAV,EAAuBo6C,aAAvB,EAAsC;AACrF,QAAIA,aAAJ,EAAmB;AACjB,WAAKJ,sBAAL,CAA4BtmD,IAA5B,CAAiCsM,WAAjC;AACD,KAFD,MAEO;AACL,WAAK+5C,aAAL,CAAmBrmD,IAAnB,CAAwBsM,WAAxB;AACD;;AAED,SAAK0U,KAAL;AACD,GARD;;AAUAolC,wBAAsBrqD,SAAtB,CAAgC4qD,eAAhC,GAAkD,UAAUC,YAAV,EAAwBF,aAAxB,EAAuC;AACvFA,oBAAgBA,iBAAiB,KAAjC;;AAEA,SAAK,IAAIlpD,IAAI,CAAb,EAAgBA,IAAIopD,aAAalpD,MAAjC,EAAyCF,GAAzC,EAA8C;AAC5C,WAAKipD,cAAL,CAAoBG,aAAappD,CAAb,CAApB,EAAqCkpD,aAArC;AACD;AACF,GAND;;AAQAN,wBAAsBrqD,SAAtB,CAAgC8qD,sBAAhC,GAAyD,UAAU/mD,EAAV,EAAc;AACrE,SAAK,IAAItC,IAAI,KAAK+oD,OAAlB,EAA2B/oD,IAAI,KAAK6oD,aAAL,CAAmB3oD,MAAlD,EAA0DF,GAA1D,EAA+D;AAC7DsC,YAAMA,GAAG,KAAKumD,aAAL,CAAmB7oD,CAAnB,CAAH,CAAN;AACD;;AAED,SAAK,IAAIA,IAAI,CAAb,EAAgBA,IAAI,KAAK8oD,sBAAL,CAA4B5oD,MAAhD,EAAwDF,GAAxD,EAA6D;AAC3DsC,YAAMA,GAAG,KAAKwmD,sBAAL,CAA4B9oD,CAA5B,CAAH,CAAN;AACD;AACF,GARD;;AAUA4oD,wBAAsBrqD,SAAtB,CAAgC8lB,MAAhC,GAAyC,YAAY;AACnD,SAAKvS,eAAL;;AAEA,SAAK,IAAI9R,IAAI,KAAK+oD,OAAlB,EAA2B/oD,IAAI,KAAK6oD,aAAL,CAAmB3oD,MAAlD,EAA0DF,GAA1D,EAA+D;AAC7D,UAAI8O,cAAc,KAAK+5C,aAAL,CAAmB7oD,CAAnB,CAAlB,CAD6D,CACpB;;AAEzC8O,kBAAYZ,MAAZ,GAAqB,IAArB;AACAY,kBAAYuV,MAAZ;AACAvV,kBAAYZ,MAAZ,GAAqB,IAArB;AACD;;AAED,SAAK,IAAIlO,IAAI,CAAb,EAAgBA,IAAI,KAAK8oD,sBAAL,CAA4B5oD,MAAhD,EAAwDF,GAAxD,EAA6D;AAC3D,UAAI8O,cAAc,KAAKg6C,sBAAL,CAA4B9oD,CAA5B,CAAlB,CAD2D,CACT;;AAElD8O,kBAAYZ,MAAZ,GAAqB,IAArB;AACAY,kBAAYuV,MAAZ;AACAvV,kBAAYZ,MAAZ,GAAqB,IAArB;AACD;AACF,GAlBD;;AAoBA06C,wBAAsBrqD,SAAtB,CAAgC8/B,KAAhC,GAAwC,UAAUh0B,GAAV,EAAeqmB,MAAf,EAAuB;AAC7D;AACA,SAAK,IAAI1wB,IAAI,KAAK+oD,OAAlB,EAA2B/oD,IAAI,KAAK6oD,aAAL,CAAmB3oD,MAAlD,EAA0DF,GAA1D,EAA+D;AAC7D,UAAI8O,cAAc,KAAK+5C,aAAL,CAAmB7oD,CAAnB,CAAlB;AACA8O,kBAAYqvB,WAAZ,IAA2BrvB,YAAYqvB,WAAZ,CAAwB9zB,GAAxB,CAA3B;AACAyE,kBAAYuvB,KAAZ,CAAkBh0B,GAAlB,EAAuBrK,MAAM,KAAK+oD,OAAX,GAAqB,IAArB,GAA4B,KAAKF,aAAL,CAAmB7oD,IAAI,CAAvB,CAAnD;AACA8O,kBAAYsvB,UAAZ,IAA0BtvB,YAAYsvB,UAAZ,CAAuB/zB,GAAvB,CAA1B;AACD;;AAED,SAAK0+C,OAAL,GAAe/oD,CAAf,CAT6D,CAS3C;;AAElB,SAAK,IAAIA,IAAI,CAAb,EAAgBA,IAAI,KAAK8oD,sBAAL,CAA4B5oD,MAAhD,EAAwDF,GAAxD,EAA6D;AAC3D,UAAI8O,cAAc,KAAKg6C,sBAAL,CAA4B9oD,CAA5B,CAAlB;AACA8O,kBAAYqvB,WAAZ,IAA2BrvB,YAAYqvB,WAAZ,CAAwB9zB,GAAxB,CAA3B;AACAyE,kBAAYuvB,KAAZ,CAAkBh0B,GAAlB,EAAuBrK,MAAM,CAAN,GAAU,IAAV,GAAiB,KAAK8oD,sBAAL,CAA4B9oD,IAAI,CAAhC,CAAxC;AACA8O,kBAAYsvB,UAAZ,IAA0BtvB,YAAYsvB,UAAZ,CAAuB/zB,GAAvB,CAA1B;AACD;;AAED,SAAKy+C,sBAAL,GAA8B,EAA9B;AACA,SAAKhlB,QAAL,GAAgB,IAAhB;AACD,GApBD;;AAsBA,MAAI77B,IAAI,EAAR;;AAEA2gD,wBAAsBrqD,SAAtB,CAAgCupB,eAAhC,GAAkD,YAAY;AAC5D,QAAI,CAAC,KAAKiW,KAAV,EAAiB;AACf,UAAItX,OAAO,IAAIrB,YAAJ,CAAiB0yB,QAAjB,EAA2BA,QAA3B,EAAqC,CAACA,QAAtC,EAAgD,CAACA,QAAjD,CAAX;;AAEA,WAAK,IAAI93C,IAAI,CAAb,EAAgBA,IAAI,KAAK6oD,aAAL,CAAmB3oD,MAAvC,EAA+CF,GAA/C,EAAoD;AAClD,YAAI8O,cAAc,KAAK+5C,aAAL,CAAmB7oD,CAAnB,CAAlB;AACA,YAAImoB,YAAYrZ,YAAYgZ,eAAZ,GAA8BpoB,KAA9B,EAAhB;;AAEA,YAAIoP,YAAY+C,kBAAZ,EAAJ,EAAsC;AACpCsW,oBAAUngB,cAAV,CAAyB8G,YAAYkD,iBAAZ,CAA8B/J,CAA9B,CAAzB;AACD;;AAEDwe,aAAKlB,KAAL,CAAW4C,SAAX;AACD;;AAED,WAAK4V,KAAL,GAAatX,IAAb;AACD;;AAED,WAAO,KAAKsX,KAAZ;AACD,GAnBD;;AAqBA6qB,wBAAsBrqD,SAAtB,CAAgC0Q,OAAhC,GAA0C,UAAU9I,CAAV,EAAaC,CAAb,EAAgB;AACxD,QAAIg8C,WAAW,KAAKxvC,qBAAL,CAA2BzM,CAA3B,EAA8BC,CAA9B,CAAf;AACA,QAAIqgB,OAAO,KAAKqB,eAAL,EAAX;;AAEA,QAAIrB,KAAKxX,OAAL,CAAamzC,SAAS,CAAT,CAAb,EAA0BA,SAAS,CAAT,CAA1B,CAAJ,EAA4C;AAC1C,WAAK,IAAIpiD,IAAI,CAAb,EAAgBA,IAAI,KAAK6oD,aAAL,CAAmB3oD,MAAvC,EAA+CF,GAA/C,EAAoD;AAClD,YAAI8O,cAAc,KAAK+5C,aAAL,CAAmB7oD,CAAnB,CAAlB;;AAEA,YAAI8O,YAAYG,OAAZ,CAAoB9I,CAApB,EAAuBC,CAAvB,CAAJ,EAA+B;AAC7B,iBAAO,IAAP;AACD;AACF;AACF;;AAED,WAAO,KAAP;AACD,GAfD;;AAiBA1E,WAASknD,qBAAT,EAAgC9qB,WAAhC;;AAEA;;;;;;;;;;;;;;;;;;AAkBA,MAAInlB,QAAQ7R,KAAK6R,KAAjB;AACA,MAAI2wC,YAAYxiD,KAAKqB,GAArB;AACA,MAAIohD,YAAYziD,KAAKoB,GAArB;AACA,MAAIshD,YAAY,EAAhB;AACA;;;;AAIA,WAASC,WAAT,CAAqBl4C,IAArB,EAA2B;AACzB,WAAO4vC,KAAKhgD,MAAL,CAAYoQ,IAAZ,CAAP;AACD;AACD;;;;AAIA,WAASm4C,UAAT,CAAoB1I,QAApB,EAA8BzvC,IAA9B,EAAoC;AAClC,WAAOuzC,iBAAiB9D,QAAjB,EAA2BzvC,IAA3B,CAAP;AACD;AACD;;;;;;;;AAQA,WAASo4C,QAAT,CAAkB3I,QAAlB,EAA4BzvC,IAA5B,EAAkCkV,IAAlC,EAAwCmjC,MAAxC,EAAgD;AAC9C,QAAIzmC,OAAO0hC,iBAAiB7D,QAAjB,EAA2BzvC,IAA3B,CAAX;AACA,QAAIs4C,eAAe1mC,KAAK2E,eAAL,EAAnB;;AAEA,QAAIrB,IAAJ,EAAU;AACR,UAAImjC,WAAW,QAAf,EAAyB;AACvBnjC,eAAOqjC,cAAcrjC,IAAd,EAAoBojC,YAApB,CAAP;AACD;;AAEDE,iBAAW5mC,IAAX,EAAiBsD,IAAjB;AACD;;AAED,WAAOtD,IAAP;AACD;AACD;;;;;;;;AAQA,WAAS6mC,SAAT,CAAmBC,QAAnB,EAA6BxjC,IAA7B,EAAmCmjC,MAAnC,EAA2C;AACzC,QAAIzmC,OAAO,IAAIwb,MAAJ,CAAW;AACpBhO,aAAO;AACLmB,eAAOm4B,QADF;AAEL9jD,WAAGsgB,KAAKtgB,CAFH;AAGLC,WAAGqgB,KAAKrgB,CAHH;AAILif,eAAOoB,KAAKpB,KAJP;AAKLC,gBAAQmB,KAAKnB;AALR,OADa;AAQpBgQ,cAAQ,gBAAU40B,GAAV,EAAe;AACrB,YAAIN,WAAW,QAAf,EAAyB;AACvB,cAAIC,eAAe;AACjBxkC,mBAAO6kC,IAAI7kC,KADM;AAEjBC,oBAAQ4kC,IAAI5kC;AAFK,WAAnB;AAIAnC,eAAKsb,QAAL,CAAcqrB,cAAcrjC,IAAd,EAAoBojC,YAApB,CAAd;AACD;AACF;AAhBmB,KAAX,CAAX;AAkBA,WAAO1mC,IAAP;AACD;AACD;;;;;;;;AAQA,WAAS2mC,aAAT,CAAuBrjC,IAAvB,EAA6BojC,YAA7B,EAA2C;AACzC;AACA,QAAIhrB,SAASgrB,aAAaxkC,KAAb,GAAqBwkC,aAAavkC,MAA/C;AACA,QAAID,QAAQoB,KAAKnB,MAAL,GAAcuZ,MAA1B;AACA,QAAIvZ,MAAJ;;AAEA,QAAID,SAASoB,KAAKpB,KAAlB,EAAyB;AACvBC,eAASmB,KAAKnB,MAAd;AACD,KAFD,MAEO;AACLD,cAAQoB,KAAKpB,KAAb;AACAC,eAASD,QAAQwZ,MAAjB;AACD;;AAED,QAAIie,KAAKr2B,KAAKtgB,CAAL,GAASsgB,KAAKpB,KAAL,GAAa,CAA/B;AACA,QAAI03B,KAAKt2B,KAAKrgB,CAAL,GAASqgB,KAAKnB,MAAL,GAAc,CAAhC;AACA,WAAO;AACLnf,SAAG22C,KAAKz3B,QAAQ,CADX;AAELjf,SAAG22C,KAAKz3B,SAAS,CAFZ;AAGLD,aAAOA,KAHF;AAILC,cAAQA;AAJH,KAAP;AAMD;;AAED,MAAI6kC,YAAYpF,WAAhB;AACA;;;;;;AAMA,WAASgF,UAAT,CAAoB5mC,IAApB,EAA0BsD,IAA1B,EAAgC;AAC9B,QAAI,CAACtD,KAAKnb,cAAV,EAA0B;AACxB;AACD;;AAED,QAAIoiD,WAAWjnC,KAAK2E,eAAL,EAAf;AACA,QAAI7f,IAAImiD,SAASrkC,kBAAT,CAA4BU,IAA5B,CAAR;AACAtD,SAAKnb,cAAL,CAAoBC,CAApB;AACD;AACD;;;;;;;;;;;;;;AAcA,WAASoiD,oBAAT,CAA8BjhD,KAA9B,EAAqC;AACnC,QAAI6wB,QAAQ7wB,MAAM6wB,KAAlB;AACA,QAAIhM,YAAY7kB,MAAMunB,KAAN,CAAY1C,SAA5B;;AAEA,QAAItV,MAAMshB,MAAMwd,EAAN,GAAW,CAAjB,MAAwB9+B,MAAMshB,MAAM5M,EAAN,GAAW,CAAjB,CAA5B,EAAiD;AAC/C4M,YAAMwd,EAAN,GAAWxd,MAAM5M,EAAN,GAAWi9B,iBAAiBrwB,MAAMwd,EAAvB,EAA2BxpB,SAA3B,EAAsC,IAAtC,CAAtB;AACD;;AAED,QAAItV,MAAMshB,MAAMyd,EAAN,GAAW,CAAjB,MAAwB/+B,MAAMshB,MAAM3M,EAAN,GAAW,CAAjB,CAA5B,EAAiD;AAC/C2M,YAAMyd,EAAN,GAAWzd,MAAM3M,EAAN,GAAWg9B,iBAAiBrwB,MAAMyd,EAAvB,EAA2BzpB,SAA3B,EAAsC,IAAtC,CAAtB;AACD;;AAED,WAAO7kB,KAAP;AACD;AACD;;;;;;;;;;;;;;AAcA,WAASmhD,oBAAT,CAA8BnhD,KAA9B,EAAqC;AACnC,QAAI6wB,QAAQ7wB,MAAM6wB,KAAlB;AACA,QAAIhM,YAAY7kB,MAAMunB,KAAN,CAAY1C,SAA5B;AACA,QAAIu8B,UAAUvwB,MAAM9zB,CAApB;AACA,QAAIskD,UAAUxwB,MAAM7zB,CAApB;AACA,QAAIskD,cAAczwB,MAAM5U,KAAxB;AACA,QAAIslC,eAAe1wB,MAAM3U,MAAzB;AACA2U,UAAM9zB,CAAN,GAAUmkD,iBAAiBrwB,MAAM9zB,CAAvB,EAA0B8nB,SAA1B,EAAqC,IAArC,CAAV;AACAgM,UAAM7zB,CAAN,GAAUkkD,iBAAiBrwB,MAAM7zB,CAAvB,EAA0B6nB,SAA1B,EAAqC,IAArC,CAAV;AACAgM,UAAM5U,KAAN,GAAcve,KAAKqB,GAAL,CAASmiD,iBAAiBE,UAAUE,WAA3B,EAAwCz8B,SAAxC,EAAmD,KAAnD,IAA4DgM,MAAM9zB,CAA3E,EAA8EukD,gBAAgB,CAAhB,GAAoB,CAApB,GAAwB,CAAtG,CAAd;AACAzwB,UAAM3U,MAAN,GAAexe,KAAKqB,GAAL,CAASmiD,iBAAiBG,UAAUE,YAA3B,EAAyC18B,SAAzC,EAAoD,KAApD,IAA6DgM,MAAM7zB,CAA5E,EAA+EukD,iBAAiB,CAAjB,GAAqB,CAArB,GAAyB,CAAxG,CAAf;AACA,WAAOvhD,KAAP;AACD;AACD;;;;;;;;;AASA,WAASkhD,gBAAT,CAA0B94C,QAA1B,EAAoCyc,SAApC,EAA+C28B,kBAA/C,EAAmE;AACjE;AACA;AACA,QAAIC,kBAAkBlyC,MAAMnH,WAAW,CAAjB,CAAtB;AACA,WAAO,CAACq5C,kBAAkBlyC,MAAMsV,SAAN,CAAnB,IAAuC,CAAvC,KAA6C,CAA7C,GAAiD48B,kBAAkB,CAAnE,GAAuE,CAACA,mBAAmBD,qBAAqB,CAArB,GAAyB,CAAC,CAA7C,CAAD,IAAoD,CAAlI;AACD;;AAED,WAASE,eAAT,CAAyBC,YAAzB,EAAuC;AACrC,WAAOA,gBAAgB,IAAhB,IAAwBA,gBAAgB,MAA/C;AACD;;AAED,WAASC,SAAT,CAAmBpvC,KAAnB,EAA0B;AACxB,WAAO,OAAOA,KAAP,KAAiB,QAAjB,GAA4BD,KAAKC,KAAL,EAAY,CAAC,GAAb,CAA5B,GAAgDA,KAAvD;AACD;AACD;;;;AAKA,WAASqvC,eAAT,CAAyBn9C,EAAzB,EAA6B;AAC3B,QAAIA,GAAGo9C,eAAP,EAAwB;AACtB,UAAIx9B,SAAS5f,GAAG6iB,KAAH,CAASjD,MAAtB;AACA,UAAID,OAAO3f,GAAG6iB,KAAH,CAASlD,IAApB,CAFsB,CAEI;;AAE1B,UAAI0U,aAAar0B,GAAGq9C,UAApB;AACAhpB,iBAAW1U,IAAX,GAAkB0U,WAAW1U,IAAX,KAAoBq9B,gBAAgBr9B,IAAhB,IAAwBu9B,UAAUv9B,IAAV,CAAxB,GAA0C,IAA9D,CAAlB;AACA0U,iBAAWzU,MAAX,GAAoByU,WAAWzU,MAAX,KAAsBo9B,gBAAgBp9B,MAAhB,IAA0Bs9B,UAAUt9B,MAAV,CAA1B,GAA8C,IAApE,CAApB;AACA,UAAI09B,cAAc,EAAlB;;AAEA,WAAK,IAAI7rD,IAAT,IAAiB4iC,UAAjB,EAA6B;AAC3B;AACA,YAAIA,WAAW5iC,IAAX,KAAoB,IAAxB,EAA8B;AAC5B6rD,sBAAY7rD,IAAZ,IAAoBuO,GAAG6iB,KAAH,CAASpxB,IAAT,CAApB;AACD;AACF;;AAEDuO,SAAGu9C,WAAH,GAAiBD,WAAjB;AACAt9C,SAAGo9C,eAAH,GAAqB,KAArB;AACD;AACF;AACD;;;;AAKA,WAASI,kBAAT,CAA4Bx9C,EAA5B,EAAgC;AAC9B,QAAIA,GAAGy9C,SAAP,EAAkB;AAChB;AACD;;AAEDN,oBAAgBn9C,EAAhB;;AAEA,QAAIA,GAAG09C,aAAP,EAAsB;AACpB19C,SAAGjB,IAAH,IAAWiB,GAAGjB,IAAH,CAAQq1B,QAAR,CAAiBp0B,EAAjB,EAAqBA,GAAGq9C,UAAxB,CAAX;AACD,KAFD,MAEO;AACL,UAAIx6B,QAAQ7iB,GAAG6iB,KAAf;AACA,UAAI86B,oBAAoB96B,MAAM86B,iBAA9B,CAFK,CAE4C;AACjD;AACA;;AAEAA,2BAAqBC,oBAAoB/6B,KAApB,CAArB,CANK,CAM4C;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAA,YAAMxD,UAAN,CAAiBrf,GAAGq9C,UAApB,EA1BK,CA0B4B;;AAEjC,UAAIM,iBAAJ,EAAuB;AACrBE,yBAAiBh7B,KAAjB,EAAwBA,MAAMi7B,0BAA9B,EAA0DH,iBAA1D,EADqB,CACyD;;AAE9E,YAAI96B,MAAMhC,QAAN,IAAkB,IAAtB,EAA4B;AAC1BgC,gBAAMhC,QAAN,GAAiB88B,kBAAkBI,SAAnC;AACD;AACF;;AAED/9C,SAAG0V,KAAH,CAAS,KAAT;AACA1V,SAAG4d,EAAH,IAAS,CAAT;AACD;;AAED5d,OAAGy9C,SAAH,GAAe,IAAf;AACD;AACD;;;;AAKA,WAASO,kBAAT,CAA4Bh+C,EAA5B,EAAgC;AAC9B,QAAI,CAACA,GAAGy9C,SAAR,EAAmB;AACjB;AACD;;AAED,QAAIQ,YAAYj+C,GAAGu9C,WAAnB;;AAEA,QAAIv9C,GAAG09C,aAAP,EAAsB;AACpB19C,SAAGjB,IAAH,IAAWiB,GAAGjB,IAAH,CAAQ01B,WAAR,CAAoBz0B,EAApB,CAAX;AACD,KAFD,MAEO;AACL;AACA;AACAi+C,mBAAaj+C,GAAG2wB,QAAH,CAAYstB,SAAZ,CAAb;AACAj+C,SAAG4d,EAAH,IAAS,CAAT;AACD;;AAED5d,OAAGy9C,SAAH,GAAe,KAAf;AACD;AACD;;;;AAKA,WAASS,YAAT,CAAsBl+C,EAAtB,EAA0B;AACxBA,OAAG1K,IAAH,KAAY,OAAZ,GAAsB0K,GAAGwW,QAAH,CAAY,UAAU8C,KAAV,EAAiB;AACjD,UAAIA,MAAMhkB,IAAN,KAAe,OAAnB,EAA4B;AAC1BkoD,2BAAmBlkC,KAAnB;AACD;AACF,KAJqB,CAAtB,GAIKkkC,mBAAmBx9C,EAAnB,CAJL;AAKD;;AAED,WAASm+C,YAAT,CAAsBn+C,EAAtB,EAA0B;AACxBA,OAAG1K,IAAH,KAAY,OAAZ,GAAsB0K,GAAGwW,QAAH,CAAY,UAAU8C,KAAV,EAAiB;AACjD,UAAIA,MAAMhkB,IAAN,KAAe,OAAnB,EAA4B;AAC1B0oD,2BAAmB1kC,KAAnB;AACD;AACF,KAJqB,CAAtB,GAIK0kC,mBAAmBh+C,EAAnB,CAJL;AAKD;AACD;;;;AAKA,WAASo+C,kBAAT,CAA4Bp+C,EAA5B,EAAgCq+C,QAAhC,EAA0C;AACxC;AACA;AACAr+C,OAAGq9C,UAAH,GAAgBr9C,GAAGq0B,UAAH,IAAiBgqB,QAAjB,IAA6B,EAA7C;AACAr+C,OAAGo9C,eAAH,GAAqB,IAArB;;AAEA,QAAIp9C,GAAGy9C,SAAP,EAAkB;AAChBN,sBAAgBn9C,EAAhB;AACD;AACF;AACD;;;;AAKA,WAASs+C,kBAAT,CAA4B1jD,CAA5B,EAA+B;AAC7B,QAAI,KAAK2jD,oBAAL,IAA6B3jD,EAAEiD,SAAnC,EAA8C;AAC5C;AACD,KAH4B,CAG3B;;;AAGF,KAAC,KAAK2gD,YAAN,IAAsBN,aAAa,IAAb,CAAtB;AACD;AACD;;;;AAKA,WAASO,iBAAT,CAA2B7jD,CAA3B,EAA8B;AAC5B,QAAI,KAAK2jD,oBAAL,IAA6B3jD,EAAEiD,SAAnC,EAA8C;AAC5C;AACD,KAH2B,CAG1B;;;AAGF,KAAC,KAAK2gD,YAAN,IAAsBL,aAAa,IAAb,CAAtB;AACD;AACD;;;;AAKA,WAASO,aAAT,GAAyB;AACvB,SAAKF,YAAL,GAAoB,IAApB;AACAN,iBAAa,IAAb;AACD;AACD;;;;AAKA,WAASS,aAAT,GAAyB;AACvB,SAAKH,YAAL,GAAoB,KAApB;AACAL,iBAAa,IAAb;AACD;AACD;;;;;;;;;;;;;;;;;;AAmBA,WAASS,aAAT,CAAuB5+C,EAAvB,EAA2Bq0B,UAA3B,EAAuC0M,GAAvC,EAA4C;AAC1C/gC,OAAGu+C,oBAAH,GAA0Bxd,OAAOA,IAAI8d,kBAArC;AACA7+C,OAAG1K,IAAH,KAAY,OAAZ,GAAsB0K,GAAGwW,QAAH,CAAY,UAAU8C,KAAV,EAAiB;AACjD,UAAIA,MAAMhkB,IAAN,KAAe,OAAnB,EAA4B;AAC1B8oD,2BAAmB9kC,KAAnB,EAA0B+a,UAA1B;AACD;AACF,KAJqB,CAAtB,GAIK+pB,mBAAmBp+C,EAAnB,EAAuBq0B,UAAvB,CAJL,CAF0C,CAMD;;AAEzCr0B,OAAGxF,EAAH,CAAM,WAAN,EAAmB8jD,kBAAnB,EAAuC9jD,EAAvC,CAA0C,UAA1C,EAAsDikD,iBAAtD,EAR0C,CAQgC;;AAE1Ez+C,OAAGxF,EAAH,CAAM,UAAN,EAAkBkkD,aAAlB,EAAiClkD,EAAjC,CAAoC,QAApC,EAA8CmkD,aAA9C;AACD;AACD;;;;;;;;;;;;;;;;;AAiBA,WAASG,aAAT,CAAuBxB,WAAvB,EAAoCyB,aAApC,EAAmDC,WAAnD,EAAgEC,aAAhE,EAA+Ele,GAA/E,EAAoFme,eAApF,EAAqGC,iBAArG,EAAwH;AACtHpe,UAAMA,OAAO2a,SAAb;AACA,QAAI0D,eAAere,IAAIqe,YAAvB;AACA,QAAIC,iBAAiBte,IAAIse,cAAzB;AACA,QAAIC,gBAAgBve,IAAIue,aAAxB,CAJsH,CAI/E;AACvC;;AAEA,QAAIC,aAAaP,YAAYtY,UAAZ,CAAuB,MAAvB,CAAjB;AACA,QAAI8Y,eAAeP,cAAcvY,UAAd,CAAyB,MAAzB,CAAnB,CARsH,CAQjE;AACrD;AACA;;AAEA,QAAI+Y,QAAJ;;AAEA,QAAIF,cAAcC,YAAlB,EAAgC;AAC9B,UAAIJ,YAAJ,EAAkB;AAChBK,mBAAWL,aAAaM,iBAAb,CAA+BL,cAA/B,EAA+C,QAA/C,EAAyD,IAAzD,EAA+DC,aAA/D,CAAX;AACD;;AAED,UAAIG,YAAY,IAAhB,EAAsB;AACpBA,mBAAWrqD,aAAa2rC,IAAI4e,WAAjB,IAAgC5e,IAAI4e,WAAJ,CAAgBN,cAAhB,EAAgCte,GAAhC,CAAhC,GAAuEA,IAAI4e,WAAtF;AACD;AACF;;AAED,QAAIC,kBAAkBL,aAAaE,QAAb,GAAwB,IAA9C;AACA,QAAII,oBAAoBL,eAAe3pD,UAAUupD,eAAeA,aAAaM,iBAAb,CAA+BL,cAA/B,EAA+C,UAA/C,EAA2D,IAA3D,EAAiEC,aAAjE,CAAf,GAAiG,IAA3G,EAAiHG,QAAjH,CAAf,GAA4I,IAApK,CAzBsH,CAyBoD;;AAE1K,QAAIG,mBAAmB,IAAnB,IAA2BC,qBAAqB,IAApD,EAA0D;AACxD;AACA;AACA;AACA;AACA;AACA;AACAC,mBAAaxC,WAAb,EAA0B0B,WAA1B,EAAuCE,eAAvC,EAAwDne,GAAxD;AACA+e,mBAAaf,aAAb,EAA4BE,aAA5B,EAA2CE,iBAA3C,EAA8Dpe,GAA9D,EAAmE,IAAnE;AACD;;AAEDuc,gBAAYj9B,IAAZ,GAAmBu/B,eAAnB;AACAb,kBAAc1+B,IAAd,GAAqBw/B,iBAArB;AACD;AACD;;;;;;;;;AASA,WAASC,YAAT,CAAsBC,SAAtB,EAAiCC,cAAjC,EAAiDC,kBAAjD,EAAqElf,GAArE,EAA0Emf,UAA1E,EAAsF;AACpFC,uBAAmBJ,SAAnB,EAA8BC,cAA9B,EAA8Cjf,GAA9C,EAAmDmf,UAAnD;AACAD,0BAAsB5sD,OAAO0sD,SAAP,EAAkBE,kBAAlB,CAAtB;AACAF,cAAU3gC,IAAV,IAAkB2gC,UAAU3gC,IAAV,CAAe1J,KAAjC,IAA0CqqC,UAAU3gC,IAAV,CAAe1J,KAAf,CAAqB,KAArB,CAA1C;AACA,WAAOqqC,SAAP;AACD;AACD;;;;;;;;;AASA,WAASK,OAAT,CAAiBL,SAAjB,EAA4BM,UAA5B,EAAwCC,YAAxC,EAAsD;AACpD,QAAIvf,MAAM;AACRwf,kBAAY;AADJ,KAAV;AAGA,QAAIL,UAAJ;;AAEA,QAAII,iBAAiB,KAArB,EAA4B;AAC1BJ,mBAAa,IAAb;AACD,KAFD,MAEO;AACL;AACAnf,UAAIgd,SAAJ,GAAgBuC,YAAhB;AACD;;AAEDH,uBAAmBJ,SAAnB,EAA8BM,UAA9B,EAA0Ctf,GAA1C,EAA+Cmf,UAA/C;AACAH,cAAU3gC,IAAV,IAAkB2gC,UAAU3gC,IAAV,CAAe1J,KAAjC,IAA0CqqC,UAAU3gC,IAAV,CAAe1J,KAAf,CAAqB,KAArB,CAA1C;AACD;AACD;;;;;;;;;;;;;;;;;AAiBA,WAASyqC,kBAAT,CAA4BJ,SAA5B,EAAuCC,cAAvC,EAAuDjf,GAAvD,EAA4Dmf,UAA5D,EAAwE;AACtE;AACAnf,UAAMA,OAAO2a,SAAb;;AAEA,QAAI3a,IAAIwf,UAAR,EAAoB;AAClB,UAAIp/B,eAAe6+B,eAAetZ,UAAf,CAA0B,UAA1B,MAA0CwZ,aAAa,IAAb,GAAoB,QAA9D,CAAnB,CADkB,CAC0E;AAC5F;;AAEA/+B,uBAAiB,SAAjB,KAA+BA,eAAe,KAA9C;AACA4+B,gBAAU5+B,YAAV,GAAyBA,YAAzB;AACA4+B,gBAAU1+B,UAAV,GAAuB2+B,eAAetZ,UAAf,CAA0B,QAA1B,CAAvB;AACA,UAAI8Z,cAAcR,eAAetZ,UAAf,CAA0B,QAA1B,CAAlB;AACA8Z,qBAAe,IAAf,KAAwBA,eAAexnD,KAAKgN,EAAL,GAAU,GAAjD;AACA+5C,gBAAU79B,YAAV,GAAyBs+B,WAAzB;AACAT,gBAAUv+B,YAAV,GAAyB3rB,UAAUmqD,eAAetZ,UAAf,CAA0B,UAA1B,CAAV,EAAiDwZ,aAAa,IAAb,GAAoB,CAArE,CAAzB;AACD;;AAED,QAAIhd,UAAU8c,eAAe9c,OAA7B;AACA,QAAIud,kBAAkBvd,WAAWA,QAAQtB,MAAR,CAAeme,SAAhD,CAlBsE,CAkBX;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,QAAIW,gBAAgBC,iBAAiBX,cAAjB,CAApB;AACA,QAAIY,UAAJ;;AAEA,QAAIF,aAAJ,EAAmB;AACjBE,mBAAa,EAAb;;AAEA,WAAK,IAAInvD,IAAT,IAAiBivD,aAAjB,EAAgC;AAC9B,YAAIA,cAAchuD,cAAd,CAA6BjB,IAA7B,CAAJ,EAAwC;AACtC;AACA,cAAIovD,gBAAgBb,eAAec,QAAf,CAAwB,CAAC,MAAD,EAASrvD,IAAT,CAAxB,CAApB,CAFsC,CAEuB;;AAE7DsvD,4BAAkBH,WAAWnvD,IAAX,IAAmB,EAArC,EAAyCovD,aAAzC,EAAwDJ,eAAxD,EAAyE1f,GAAzE,EAA8Emf,UAA9E;AACD;AACF;AACF;;AAEDH,cAAUt9B,IAAV,GAAiBm+B,UAAjB;AACAG,sBAAkBhB,SAAlB,EAA6BC,cAA7B,EAA6CS,eAA7C,EAA8D1f,GAA9D,EAAmEmf,UAAnE,EAA+E,IAA/E;;AAEA,QAAInf,IAAIigB,SAAJ,IAAiB,CAACjgB,IAAIgf,SAA1B,EAAqC;AACnChf,UAAIgf,SAAJ,GAAgB,EAAhB;AACD;;AAED,WAAOA,SAAP;AACD,GAv5e2B,CAu5e1B;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,WAASY,gBAAT,CAA0BX,cAA1B,EAA0C;AACxC;AACA,QAAIiB,eAAJ;;AAEA,WAAOjB,kBAAkBA,mBAAmBA,eAAe9c,OAA3D,EAAoE;AAClE,UAAIzgB,OAAO,CAACu9B,eAAepe,MAAf,IAAyB8Z,SAA1B,EAAqCj5B,IAAhD;;AAEA,UAAIA,IAAJ,EAAU;AACRw+B,0BAAkBA,mBAAmB,EAArC;;AAEA,aAAK,IAAIxvD,IAAT,IAAiBgxB,IAAjB,EAAuB;AACrB,cAAIA,KAAK/vB,cAAL,CAAoBjB,IAApB,CAAJ,EAA+B;AAC7BwvD,4BAAgBxvD,IAAhB,IAAwB,CAAxB;AACD;AACF;AACF;;AAEDuuD,uBAAiBA,eAAekB,WAAhC;AACD;;AAED,WAAOD,eAAP;AACD;;AAED,WAASF,iBAAT,CAA2BhB,SAA3B,EAAsCC,cAAtC,EAAsDS,eAAtD,EAAuE1f,GAAvE,EAA4Emf,UAA5E,EAAwFiB,OAAxF,EAAiG;AAC/F;AACAV,sBAAkB,CAACP,UAAD,IAAeO,eAAf,IAAkC/E,SAApD;AACAqE,cAAUl/B,QAAV,GAAqBugC,aAAapB,eAAetZ,UAAf,CAA0B,OAA1B,CAAb,EAAiD3F,GAAjD,KAAyD0f,gBAAgB3yC,KAA9F;AACAiyC,cAAUj/B,UAAV,GAAuBsgC,aAAapB,eAAetZ,UAAf,CAA0B,iBAA1B,CAAb,EAA2D3F,GAA3D,KAAmE0f,gBAAgBp+B,eAA1G;AACA09B,cAAU9+B,eAAV,GAA4BprB,UAAUmqD,eAAetZ,UAAf,CAA0B,iBAA1B,CAAV,EAAwD+Z,gBAAgBn+B,eAAxE,CAA5B;;AAEA,QAAI,CAAC49B,UAAL,EAAiB;AACf,UAAIiB,OAAJ,EAAa;AACX;AACA,YAAIE,uBAAuBtB,UAAU5+B,YAArC;AACA4+B,kBAAUuB,cAAV,GAA2BzD,iBAAiBkC,SAAjB,EAA4BsB,oBAA5B,EAAkDtgB,GAAlD,CAA3B,CAHW,CAGwE;AACnF;;AAEAgf,kBAAUjC,0BAAV,GAAuCuD,oBAAvC;AACAtB,kBAAUpC,iBAAV,GAA8B5c,GAA9B;AACD,OATc,CASb;;;AAGF,UAAIgf,UAAUl/B,QAAV,IAAsB,IAA1B,EAAgC;AAC9Bk/B,kBAAUl/B,QAAV,GAAqBkgB,IAAIgd,SAAzB;AACD;AACF,KAtB8F,CAsB7F;AACF;AACA;;;AAGAgC,cAAUv/B,SAAV,GAAsBw/B,eAAetZ,UAAf,CAA0B,WAA1B,KAA0C+Z,gBAAgBjgC,SAAhF;AACAu/B,cAAUt/B,UAAV,GAAuBu/B,eAAetZ,UAAf,CAA0B,YAA1B,KAA2C+Z,gBAAgBhgC,UAAlF;AACAs/B,cAAUr/B,QAAV,GAAqBs/B,eAAetZ,UAAf,CAA0B,UAA1B,KAAyC+Z,gBAAgB//B,QAA9E;AACAq/B,cAAUp/B,UAAV,GAAuBq/B,eAAetZ,UAAf,CAA0B,YAA1B,KAA2C+Z,gBAAgB9/B,UAAlF;AACAo/B,cAAUz+B,SAAV,GAAsB0+B,eAAetZ,UAAf,CAA0B,OAA1B,CAAtB;AACAqZ,cAAUx+B,iBAAV,GAA8By+B,eAAetZ,UAAf,CAA0B,eAA1B,KAA8CsZ,eAAetZ,UAAf,CAA0B,UAA1B,CAA5E;AACAqZ,cAAU7+B,cAAV,GAA2B8+B,eAAetZ,UAAf,CAA0B,YAA1B,CAA3B;AACAqZ,cAAUh/B,SAAV,GAAsBi/B,eAAetZ,UAAf,CAA0B,OAA1B,CAAtB;AACAqZ,cAAU/+B,UAAV,GAAuBg/B,eAAetZ,UAAf,CAA0B,QAA1B,CAAvB;AACAqZ,cAAUn/B,OAAV,GAAoBo/B,eAAetZ,UAAf,CAA0B,KAA1B,CAApB;;AAEA,QAAI,CAACya,OAAD,IAAY,CAACpgB,IAAIwgB,UAArB,EAAiC;AAC/BxB,gBAAU39B,mBAAV,GAAgCg/B,aAAapB,eAAetZ,UAAf,CAA0B,iBAA1B,CAAb,EAA2D3F,GAA3D,CAAhC;AACAgf,gBAAUv9B,WAAV,GAAwBw9B,eAAetZ,UAAf,CAA0B,SAA1B,CAAxB;AACAqZ,gBAAU19B,eAAV,GAA4B++B,aAAapB,eAAetZ,UAAf,CAA0B,aAA1B,CAAb,EAAuD3F,GAAvD,CAA5B;AACAgf,gBAAUz9B,eAAV,GAA4B09B,eAAetZ,UAAf,CAA0B,aAA1B,CAA5B;AACAqZ,gBAAUx9B,gBAAV,GAA6By9B,eAAetZ,UAAf,CAA0B,cAA1B,CAA7B;AACAqZ,gBAAUl+B,kBAAV,GAA+Bm+B,eAAetZ,UAAf,CAA0B,aAA1B,CAA/B;AACAqZ,gBAAUj+B,iBAAV,GAA8Bk+B,eAAetZ,UAAf,CAA0B,YAA1B,CAA9B;AACAqZ,gBAAUh+B,oBAAV,GAAiCi+B,eAAetZ,UAAf,CAA0B,eAA1B,CAAjC;AACAqZ,gBAAU/9B,oBAAV,GAAiCg+B,eAAetZ,UAAf,CAA0B,eAA1B,CAAjC;AACD;;AAEDqZ,cAAUt+B,eAAV,GAA4Bu+B,eAAetZ,UAAf,CAA0B,iBAA1B,KAAgD+Z,gBAAgBh/B,eAA5F;AACAs+B,cAAUr+B,cAAV,GAA2Bs+B,eAAetZ,UAAf,CAA0B,gBAA1B,KAA+C+Z,gBAAgB/+B,cAA1F;AACAq+B,cAAUp+B,iBAAV,GAA8Bq+B,eAAetZ,UAAf,CAA0B,mBAA1B,KAAkD+Z,gBAAgB9+B,iBAAhG;AACAo+B,cAAUn+B,iBAAV,GAA8Bo+B,eAAetZ,UAAf,CAA0B,mBAA1B,KAAkD+Z,gBAAgB7+B,iBAAhG;AACD;;AAED,WAASw/B,YAAT,CAAsBtzC,KAAtB,EAA6BizB,GAA7B,EAAkC;AAChC,WAAOjzB,UAAU,MAAV,GAAmBA,KAAnB,GAA2BizB,OAAOA,IAAIgd,SAAX,GAAuBhd,IAAIgd,SAA3B,GAAuC,IAAzE;AACD;;AAED,WAASF,gBAAT,CAA0BkC,SAA1B,EAAqC5+B,YAArC,EAAmD4f,GAAnD,EAAwD;AACtD,QAAIygB,iBAAiBzgB,IAAIygB,cAAzB;AACA,QAAIF,cAAJ;;AAEA,QAAIvB,UAAUl/B,QAAV,IAAsB,IAAtB,IAA8B2gC,mBAAmB,KAAjD,KAA2DA,mBAAmB,IAAnB,IAA2BzgB,IAAIwf,UAAJ,IAAkBp/B,YAAlB,CAA+B;AAA/B,OACvF,OAAOA,YAAP,KAAwB,QAD+D,IACnDA,aAAa1tB,OAAb,CAAqB,QAArB,KAAkC,CADrE,CAAJ,EAC6E;AAC3E6tD,uBAAiB;AACfzgC,kBAAU,IADK;AAEfC,oBAAYi/B,UAAUj/B,UAFP;AAGfG,yBAAiB8+B,UAAU9+B;AAHZ,OAAjB;AAKA8+B,gBAAUl/B,QAAV,GAAqB,MAArB,CAN2E,CAM9C;;AAE7B,UAAIk/B,UAAUj/B,UAAV,IAAwB,IAA5B,EAAkC;AAChCi/B,kBAAUj/B,UAAV,GAAuBigB,IAAIgd,SAA3B;AACAgC,kBAAU9+B,eAAV,IAA6B,IAA7B,KAAsC8+B,UAAU9+B,eAAV,GAA4B,CAAlE;AACD;AACF;;AAED,WAAOqgC,cAAP;AACD;;AAED,WAAS1D,mBAAT,CAA6B/6B,KAA7B,EAAoC;AAClC,QAAIy+B,iBAAiBz+B,MAAMy+B,cAA3B;;AAEA,QAAIA,cAAJ,EAAoB;AAClBz+B,YAAMhC,QAAN,GAAiBygC,eAAezgC,QAAhC;AACAgC,YAAM/B,UAAN,GAAmBwgC,eAAexgC,UAAlC;AACA+B,YAAM5B,eAAN,GAAwBqgC,eAAergC,eAAvC;AACD;AACF;;AAED,WAASwgC,QAAT,CAAiB1gB,GAAjB,EAAsBmC,OAAtB,EAA+B;AAC7B;AACA,QAAIwe,kBAAkBxe,WAAWA,QAAQ4d,QAAR,CAAiB,WAAjB,CAAjC;AACA,WAAOrqD,KAAK,CAAC;AACbsqC,QAAIvgB,SAAJ,IAAiBkhC,mBAAmBA,gBAAgBhb,UAAhB,CAA2B,WAA3B,CAApC,IAA+E,EADnE,EACuE3F,IAAItgB,UAAJ,IAAkBihC,mBAAmBA,gBAAgBhb,UAAhB,CAA2B,YAA3B,CAArC,IAAiF,EADxJ,EAC4J,CAAC3F,IAAIrgB,QAAJ,IAAgBghC,mBAAmBA,gBAAgBhb,UAAhB,CAA2B,UAA3B,CAAnC,IAA6E,EAA9E,IAAoF,IADhP,EACsP3F,IAAIpgB,UAAJ,IAAkB+gC,mBAAmBA,gBAAgBhb,UAAhB,CAA2B,YAA3B,CAArC,IAAiF,YADvU,EACqVz1B,IADrV,CAC0V,GAD1V,CAAL,CAAP;AAED;;AAED,WAAS0wC,iBAAT,CAA2BC,QAA3B,EAAqC5hD,EAArC,EAAyC2T,KAAzC,EAAgDkuC,eAAhD,EAAiEnf,SAAjE,EAA4EluC,EAA5E,EAAgF;AAC9E,QAAI,OAAOkuC,SAAP,KAAqB,UAAzB,EAAqC;AACnCluC,WAAKkuC,SAAL;AACAA,kBAAY,IAAZ;AACD,KAJ6E,CAI5E;AACF;AACA;;;AAGA,QAAIof,mBAAmBD,mBAAmBA,gBAAgBE,kBAAhB,EAA1C;;AAEA,QAAID,gBAAJ,EAAsB;AACpB,UAAIE,UAAUJ,WAAW,QAAX,GAAsB,EAApC;AACA,UAAIK,WAAWJ,gBAAgBnb,UAAhB,CAA2B,sBAAsBsb,OAAjD,CAAf;AACA,UAAIE,kBAAkBL,gBAAgBnb,UAAhB,CAA2B,oBAAoBsb,OAA/C,CAAtB;AACA,UAAIG,iBAAiBN,gBAAgBnb,UAAhB,CAA2B,mBAAmBsb,OAA9C,CAArB;;AAEA,UAAI,OAAOG,cAAP,KAA0B,UAA9B,EAA0C;AACxCA,yBAAiBA,eAAezf,SAAf,EAA0Bmf,gBAAgBO,uBAAhB,GAA0CP,gBAAgBO,uBAAhB,CAAwCpiD,EAAxC,EAA4C0iC,SAA5C,CAA1C,GAAmG,IAA7H,CAAjB;AACD;;AAED,UAAI,OAAOuf,QAAP,KAAoB,UAAxB,EAAoC;AAClCA,mBAAWA,SAASvf,SAAT,CAAX;AACD;;AAEDuf,iBAAW,CAAX,GAAejiD,GAAG6V,SAAH,CAAalC,KAAb,EAAoBsuC,QAApB,EAA8BE,kBAAkB,CAAhD,EAAmDD,eAAnD,EAAoE1tD,EAApE,EAAwE,CAAC,CAACA,EAA1E,CAAf,IAAgGwL,GAAG4V,aAAH,IAAoB5V,GAAGkW,IAAH,CAAQvC,KAAR,CAApB,EAAoCnf,MAAMA,IAA1I;AACD,KAfD,MAeO;AACLwL,SAAG4V,aAAH;AACA5V,SAAGkW,IAAH,CAAQvC,KAAR;AACAnf,YAAMA,IAAN;AACD;AACF;AACD;;;;;;;;;;;;;;;;;;;;;;;AAwBA,WAAS6tD,WAAT,CAAqBriD,EAArB,EAAyB2T,KAAzB,EAAgCkuC,eAAhC,EAAiDnf,SAAjD,EAA4DluC,EAA5D,EAAgE;AAC9DmtD,sBAAkB,IAAlB,EAAwB3hD,EAAxB,EAA4B2T,KAA5B,EAAmCkuC,eAAnC,EAAoDnf,SAApD,EAA+DluC,EAA/D;AACD;AACD;;;;;;;;;;;;;;;AAeA,WAAS8tD,SAAT,CAAmBtiD,EAAnB,EAAuB2T,KAAvB,EAA8BkuC,eAA9B,EAA+Cnf,SAA/C,EAA0DluC,EAA1D,EAA8D;AAC5DmtD,sBAAkB,KAAlB,EAAyB3hD,EAAzB,EAA6B2T,KAA7B,EAAoCkuC,eAApC,EAAqDnf,SAArD,EAAgEluC,EAAhE;AACD;AACD;;;;;;;;AAQA,WAAS+tD,YAAT,CAAsB3vD,MAAtB,EAA8B4vD,QAA9B,EAAwC;AACtC,QAAIC,MAAMnhD,SAAS,EAAT,CAAV;;AAEA,WAAO1O,UAAUA,WAAW4vD,QAA5B,EAAsC;AACpChhD,YAAMihD,GAAN,EAAW7vD,OAAOsR,iBAAP,EAAX,EAAuCu+C,GAAvC;AACA7vD,eAASA,OAAOwN,MAAhB;AACD;;AAED,WAAOqiD,GAAP;AACD;AACD;;;;;;;;;;AAUA,WAASC,gBAAT,CAA0B9vD,MAA1B,EAAkCkR,SAAlC,EAA6C6+C,SAA7C,EAAwD;AACtD,QAAI7+C,aAAa,CAAC1P,YAAY0P,SAAZ,CAAlB,EAA0C;AACxCA,kBAAYN,cAAcU,iBAAd,CAAgCJ,SAAhC,CAAZ;AACD;;AAED,QAAI6+C,SAAJ,EAAe;AACb7+C,kBAAYb,OAAO,EAAP,EAAWa,SAAX,CAAZ;AACD;;AAED,WAAO5J,eAAe,EAAf,EAAmBtH,MAAnB,EAA2BkR,SAA3B,CAAP;AACD;AACD;;;;;;;AAOA,WAAS8+C,kBAAT,CAA4BC,SAA5B,EAAuC/+C,SAAvC,EAAkD6+C,SAAlD,EAA6D;AAC3D;AACA,QAAIG,QAAQh/C,UAAU,CAAV,MAAiB,CAAjB,IAAsBA,UAAU,CAAV,MAAiB,CAAvC,IAA4CA,UAAU,CAAV,MAAiB,CAA7D,GAAiE,CAAjE,GAAqE9K,KAAKyzC,GAAL,CAAS,IAAI3oC,UAAU,CAAV,CAAJ,GAAmBA,UAAU,CAAV,CAA5B,CAAjF;AACA,QAAIi/C,QAAQj/C,UAAU,CAAV,MAAiB,CAAjB,IAAsBA,UAAU,CAAV,MAAiB,CAAvC,IAA4CA,UAAU,CAAV,MAAiB,CAA7D,GAAiE,CAAjE,GAAqE9K,KAAKyzC,GAAL,CAAS,IAAI3oC,UAAU,CAAV,CAAJ,GAAmBA,UAAU,CAAV,CAA5B,CAAjF;AACA,QAAIk/C,SAAS,CAACH,cAAc,MAAd,GAAuB,CAACC,KAAxB,GAAgCD,cAAc,OAAd,GAAwBC,KAAxB,GAAgC,CAAjE,EAAoED,cAAc,KAAd,GAAsB,CAACE,KAAvB,GAA+BF,cAAc,QAAd,GAAyBE,KAAzB,GAAiC,CAApI,CAAb;AACAC,aAASN,iBAAiBM,MAAjB,EAAyBl/C,SAAzB,EAAoC6+C,SAApC,CAAT;AACA,WAAO3pD,KAAKyzC,GAAL,CAASuW,OAAO,CAAP,CAAT,IAAsBhqD,KAAKyzC,GAAL,CAASuW,OAAO,CAAP,CAAT,CAAtB,GAA4CA,OAAO,CAAP,IAAY,CAAZ,GAAgB,OAAhB,GAA0B,MAAtE,GAA+EA,OAAO,CAAP,IAAY,CAAZ,GAAgB,QAAhB,GAA2B,KAAjH;AACD;AACD;;;;;AAKA,WAASC,eAAT,CAAyBC,EAAzB,EAA6BC,EAA7B,EAAiCtB,eAAjC,EAAkDrtD,EAAlD,EAAsD;AACpD,QAAI,CAAC0uD,EAAD,IAAO,CAACC,EAAZ,EAAgB;AACd;AACD;;AAED,aAASC,QAAT,CAAkB13C,CAAlB,EAAqB;AACnB,UAAI23C,QAAQ,EAAZ;AACA33C,QAAE8K,QAAF,CAAW,UAAUxW,EAAV,EAAc;AACvB,YAAI,CAACA,GAAGoW,OAAJ,IAAepW,GAAGsjD,IAAtB,EAA4B;AAC1BD,gBAAMrjD,GAAGsjD,IAAT,IAAiBtjD,EAAjB;AACD;AACF,OAJD;AAKA,aAAOqjD,KAAP;AACD;;AAED,aAASE,kBAAT,CAA4BvjD,EAA5B,EAAgC;AAC9B,UAAIzL,MAAM;AACRmP,kBAAUhL,QAAQsH,GAAG0D,QAAX,CADF;AAERC,kBAAU3D,GAAG2D;AAFL,OAAV;;AAKA,UAAI3D,GAAGmsB,KAAP,EAAc;AACZ53B,YAAI43B,KAAJ,GAAY94B,OAAO,EAAP,EAAW2M,GAAGmsB,KAAd,CAAZ;AACD;;AAED,aAAO53B,GAAP;AACD;;AAED,QAAIivD,SAASJ,SAASF,EAAT,CAAb;AACAC,OAAG3sC,QAAH,CAAY,UAAUxW,EAAV,EAAc;AACxB,UAAI,CAACA,GAAGoW,OAAJ,IAAepW,GAAGsjD,IAAtB,EAA4B;AAC1B,YAAIG,QAAQD,OAAOxjD,GAAGsjD,IAAV,CAAZ;;AAEA,YAAIG,KAAJ,EAAW;AACT,cAAIC,UAAUH,mBAAmBvjD,EAAnB,CAAd;AACAA,aAAGkW,IAAH,CAAQqtC,mBAAmBE,KAAnB,CAAR;AACApB,sBAAYriD,EAAZ,EAAgB0jD,OAAhB,EAAyB7B,eAAzB,EAA0C7hD,GAAG0iC,SAA7C;AACD,SAPyB,CAOxB;AACF;AACA;AACA;AACA;AAED;AACF,KAfD;AAgBD;AACD;;;;;;AAMA,WAASihB,gBAAT,CAA0B3nB,MAA1B,EAAkCrjB,IAAlC,EAAwC;AACtC,WAAOvnB,IAAI4qC,MAAJ,EAAY,UAAUgd,KAAV,EAAiB;AAClC,UAAI3gD,IAAI2gD,MAAM,CAAN,CAAR;AACA3gD,UAAImjD,UAAUnjD,CAAV,EAAasgB,KAAKtgB,CAAlB,CAAJ;AACAA,UAAIojD,UAAUpjD,CAAV,EAAasgB,KAAKtgB,CAAL,GAASsgB,KAAKpB,KAA3B,CAAJ;AACA,UAAIjf,IAAI0gD,MAAM,CAAN,CAAR;AACA1gD,UAAIkjD,UAAUljD,CAAV,EAAaqgB,KAAKrgB,CAAlB,CAAJ;AACAA,UAAImjD,UAAUnjD,CAAV,EAAaqgB,KAAKrgB,CAAL,GAASqgB,KAAKnB,MAA3B,CAAJ;AACA,aAAO,CAACnf,CAAD,EAAIC,CAAJ,CAAP;AACD,KARM,CAAP;AASD;AACD;;;;;;AAMA,WAASsrD,cAAT,CAAwBC,UAAxB,EAAoClrC,IAApC,EAA0C;AACxC,QAAItgB,IAAImjD,UAAUqI,WAAWxrD,CAArB,EAAwBsgB,KAAKtgB,CAA7B,CAAR;AACA,QAAIknB,KAAKk8B,UAAUoI,WAAWxrD,CAAX,GAAewrD,WAAWtsC,KAApC,EAA2CoB,KAAKtgB,CAAL,GAASsgB,KAAKpB,KAAzD,CAAT;AACA,QAAIjf,IAAIkjD,UAAUqI,WAAWvrD,CAArB,EAAwBqgB,KAAKrgB,CAA7B,CAAR;AACA,QAAIknB,KAAKi8B,UAAUoI,WAAWvrD,CAAX,GAAeurD,WAAWrsC,MAApC,EAA4CmB,KAAKrgB,CAAL,GAASqgB,KAAKnB,MAA1D,CAAT;;AAEA,QAAI+H,MAAMlnB,CAAN,IAAWmnB,MAAMlnB,CAArB,EAAwB;AACtB,aAAO;AACLD,WAAGA,CADE;AAELC,WAAGA,CAFE;AAGLif,eAAOgI,KAAKlnB,CAHP;AAILmf,gBAAQgI,KAAKlnB;AAJR,OAAP;AAMD;AACF;AACD;;;;;;;AAOA,WAASwrD,UAAT,CAAoBC,OAApB,EAA6BhjB,GAA7B,EAAkCpoB,IAAlC,EAAwC;AACtCooB,UAAM1tC,OAAO;AACX4N,iBAAW;AADA,KAAP,EAEH8/B,GAFG,CAAN;AAGA,QAAIle,QAAQke,IAAIle,KAAJ,GAAY;AACtBzC,qBAAe;AADO,KAAxB;AAGAzH,WAAOA,QAAQ;AACbtgB,SAAG,CAAC,CADS;AAEbC,SAAG,CAAC,CAFS;AAGbif,aAAO,CAHM;AAIbC,cAAQ;AAJK,KAAf;;AAOA,QAAIusC,OAAJ,EAAa;AACX,aAAOA,QAAQtwD,OAAR,CAAgB,UAAhB,MAAgC,CAAhC,IAAqCovB,MAAMmB,KAAN,GAAc+/B,QAAQ7yD,KAAR,CAAc,CAAd,CAAd,EAAgCoC,SAASuvB,KAAT,EAAgBlK,IAAhB,CAAhC,EAAuD,IAAIkY,MAAJ,CAAWkQ,GAAX,CAA5F,IAA+G8a,SAASkI,QAAQptD,OAAR,CAAgB,SAAhB,EAA2B,EAA3B,CAAT,EAAyCoqC,GAAzC,EAA8CpoB,IAA9C,EAAoD,QAApD,CAAtH;AACD;AACF;;AAGD,MAAIqrC,UAAU,CAACxzD,OAAOsH,MAAP,IAAiBtH,MAAlB,EAA0B;AACvCmrD,iBAAaA,WAD0B;AAEvCC,gBAAYA,UAF2B;AAGvCC,cAAUA,QAH6B;AAIvCK,eAAWA,SAJ4B;AAKvCG,eAAWA,SAL4B;AAMvCJ,gBAAYA,UAN2B;AAOvCM,0BAAsBA,oBAPiB;AAQvCE,0BAAsBA,oBARiB;AASvCD,sBAAkBA,gBATqB;AAUvCoC,mBAAeA,aAVwB;AAWvCE,mBAAeA,aAXwB;AAYvCgB,kBAAcA,YAZyB;AAavCM,aAASA,OAb8B;AAcvCqB,aAASA,QAd8B;AAevCY,iBAAaA,WAf0B;AAgBvCC,eAAWA,SAhB4B;AAiBvCC,kBAAcA,YAjByB;AAkBvCroD,oBAAgBwoD,gBAlBuB;AAmBvCE,wBAAoBA,kBAnBmB;AAoBvCK,qBAAiBA,eApBsB;AAqBvCU,sBAAkBA,gBArBqB;AAsBvCC,oBAAgBA,cAtBuB;AAuBvCE,gBAAYA,UAvB2B;AAwBvCjrC,WAAOA,KAxBgC;AAyBvC0O,WAAOsJ,MAzBgC;AA0BvCymB,UAAMA,IA1BiC;AA2BvCE,YAAQA,MA3B+B;AA4BvCK,YAAQA,MA5B+B;AA6BvCK,UAAMA,IA7BiC;AA8BvCuB,aAASA,OA9B8B;AA+BvCC,cAAUA,QA/B6B;AAgCvCC,UAAMA,IAhCiC;AAiCvCC,UAAMA,IAjCiC;AAkCvCQ,iBAAaA,WAlC0B;AAmCvCE,SAAKA,GAnCkC;AAoCvC2J,4BAAwBnJ,qBApCe;AAqCvCP,kBAAcA,YArCyB;AAsCvCI,oBAAgBA,cAtCuB;AAuCvCE,oBAAgBA,cAvCuB;AAwCvCvjC,kBAAcA;AAxCyB,GAA1B,CAAd;;AA2CA;;;;;;;;;;;;;;;;;;AAkBA,MAAI4sC,aAAa,CAAC,WAAD,EAAc,OAAd,CAAjB;AACA,MAAIC,iBAAiB;AACnB;;;;;AAKAC,kBAAc,sBAAUlE,UAAV,EAAsB;AAClC,UAAIhd,UAAU,KAAKA,OAAnB;AACA,aAAO,KAAKwD,UAAL,CAAgB,OAAhB,MAA6B,CAACwZ,UAAD,IAAehd,OAAf,GAAyBA,QAAQ9rC,GAAR,CAAY8sD,UAAZ,CAAzB,GAAmD,IAAhF,CAAP;AACD,KATkB;;AAWnB;;;;AAIAzC,aAAS,mBAAY;AACnB,aAAOA,SAAQ;AACbjhC,mBAAW,KAAKkmB,UAAL,CAAgB,WAAhB,CADE;AAEbjmB,oBAAY,KAAKimB,UAAL,CAAgB,YAAhB,CAFC;AAGbhmB,kBAAU,KAAKgmB,UAAL,CAAgB,UAAhB,CAHG;AAIb/lB,oBAAY,KAAK+lB,UAAL,CAAgB,YAAhB;AAJC,OAAR,EAKJ,KAAKxD,OALD,CAAP;AAMD,KAtBkB;AAuBnBmhB,iBAAa,qBAAUhkC,IAAV,EAAgB;AAC3B,aAAOrG,iBAAgBqG,IAAhB,EAAsB,KAAKohC,OAAL,EAAtB,EAAsC,KAAK/a,UAAL,CAAgB,OAAhB,CAAtC,EAAgE,KAAKA,UAAL,CAAgB,eAAhB,KAAoC,KAAKA,UAAL,CAAgB,UAAhB,CAApG,EAAiI,KAAKA,UAAL,CAAgB,SAAhB,CAAjI,EAA6J,KAAKA,UAAL,CAAgB,MAAhB,CAA7J,EAAsL,KAAKA,UAAL,CAAgB,cAAhB,CAAtL,CAAP;AACD;AAzBkB,GAArB;;AA4BA;;;;;;;;;;;;;;;;;;AAkBA,MAAI4d,gBAAeje,gBAAgB,CAAC,CAAC,MAAD,EAAS,OAAT,CAAD,EAAoB,CAAC,QAAD,EAAW,aAAX,CAApB,EAA+C,CAAC,WAAD,EAAc,aAAd,CAA/C,EAA6E,CAAC,SAAD,CAA7E,EAA0F,CAAC,YAAD,CAA1F,EAA0G,CAAC,eAAD,CAA1G,EAA6H,CAAC,eAAD,CAA7H,EAAgJ,CAAC,aAAD,CAAhJ,EAAiK,CAAC,cAAD,CAAjK,EAAmL,CAAC,WAAD,CAAnL,CAAhB,CAAnB;AACA,MAAIke,iBAAiB;AACnBD,kBAAc,sBAAU9d,QAAV,EAAoBC,QAApB,EAA8B;AAC1C,UAAI5jB,QAAQyhC,cAAa,IAAb,EAAmB9d,QAAnB,EAA6BC,QAA7B,CAAZ;AACA,UAAI3mB,WAAW,KAAK0kC,iBAAL,EAAf;AACA1kC,mBAAa+C,MAAM/C,QAAN,GAAiBA,QAA9B;AACA,aAAO+C,KAAP;AACD,KANkB;AAOnB2hC,uBAAmB,6BAAY;AAC7B,UAAI1d,WAAW,KAAK1vC,GAAL,CAAS,YAAT,CAAf;AACA,aAAO0vC,aAAa,OAAb,IAAwBA,YAAY,IAApC,GAA2C,IAA3C,GAAkDA,aAAa,QAAb,GAAwB,CAAC,CAAD,EAAI,CAAJ,CAAxB,GAAiC,CAAC,CAAD,EAAI,CAAJ,CAA1F;AACD;AAVkB,GAArB;;AAaA;;;;;;;;;;;;;;;;;;;AAmBA;;;AAGA,MAAI2d,UAAUtwD,KAAd;AACA,MAAIuwD,QAAQ7hB,WAAZ;AACA;;;;;;;;AAQA,WAAS8hB,KAAT,CAAe/iB,MAAf,EAAuBsf,WAAvB,EAAoChe,OAApC,EAA6C;AAC3C;;;;AAIA,SAAKge,WAAL,GAAmBA,WAAnB;AACA;;;;;AAKA,SAAKhe,OAAL,GAAeA,OAAf;AACA;;;;;AAKA,SAAKtB,MAAL,GAAcA,MAAd,CAjB2C,CAiBrB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACD;;AAED+iB,QAAMl0D,SAAN,GAAkB;AAChB6B,iBAAaqyD,KADG;;AAGhB;;;;AAIAnkB,UAAM,IAPU;;AAShB;;;AAGAokB,iBAAa,qBAAUhjB,MAAV,EAAkB;AAC7BjvC,YAAM,KAAKivC,MAAX,EAAmBA,MAAnB,EAA2B,IAA3B;AACD,KAde;;AAgBhB;;;;;AAKAxqC,SAAK,aAAUie,IAAV,EAAgBwvC,YAAhB,EAA8B;AACjC,UAAIxvC,QAAQ,IAAZ,EAAkB;AAChB,eAAO,KAAKusB,MAAZ;AACD;;AAED,aAAOkjB,MAAM,KAAKljB,MAAX,EAAmB,KAAKmjB,SAAL,CAAe1vC,IAAf,CAAnB,EAAyC,CAACwvC,YAAD,IAAiBG,UAAU,IAAV,EAAgB3vC,IAAhB,CAA1D,CAAP;AACD,KA3Be;;AA6BhB;;;;;AAKAqxB,gBAAY,oBAAUj0C,GAAV,EAAeoyD,YAAf,EAA6B;AACvC,UAAIjjB,SAAS,KAAKA,MAAlB;AACA,UAAIxrC,MAAMwrC,UAAU,IAAV,GAAiBA,MAAjB,GAA0BA,OAAOnvC,GAAP,CAApC;AACA,UAAIyuD,cAAc,CAAC2D,YAAD,IAAiBG,UAAU,IAAV,EAAgBvyD,GAAhB,CAAnC;;AAEA,UAAI2D,OAAO,IAAP,IAAe8qD,WAAnB,EAAgC;AAC9B9qD,cAAM8qD,YAAYxa,UAAZ,CAAuBj0C,GAAvB,CAAN;AACD;;AAED,aAAO2D,GAAP;AACD,KA5Ce;;AA8ChB;;;;;AAKA0qD,cAAU,kBAAUzrC,IAAV,EAAgB6rC,WAAhB,EAA6B;AACrC,UAAI3sD,MAAM8gB,QAAQ,IAAR,GAAe,KAAKusB,MAApB,GAA6BkjB,MAAM,KAAKljB,MAAX,EAAmBvsB,OAAO,KAAK0vC,SAAL,CAAe1vC,IAAf,CAA1B,CAAvC;AACA,UAAI4vC,eAAJ;AACA/D,oBAAcA,eAAe,CAAC+D,kBAAkBD,UAAU,IAAV,EAAgB3vC,IAAhB,CAAnB,KAA6C4vC,gBAAgBnE,QAAhB,CAAyBzrC,IAAzB,CAA1E;AACA,aAAO,IAAIsvC,KAAJ,CAAUpwD,GAAV,EAAe2sD,WAAf,EAA4B,KAAKhe,OAAjC,CAAP;AACD,KAxDe;;AA0DhB;;;AAGAgiB,aAAS,mBAAY;AACnB,aAAO,KAAKtjB,MAAL,IAAe,IAAtB;AACD,KA/De;AAgEhBujB,iBAAa,uBAAY,CAAE,CAhEX;AAiEhB;AACAvzD,WAAO,iBAAY;AACjB,UAAIS,OAAO,KAAKC,WAAhB;AACA,aAAO,IAAID,IAAJ,CAAST,OAAM,KAAKgwC,MAAX,CAAT,CAAP;AACD,KArEe;AAsEhBwjB,iBAAa,qBAAU9e,UAAV,EAAsB,CAAC;AACnC,KAvEe;AAwEhB;AACAye,eAAW,mBAAU1vC,IAAV,EAAgB;AACzB,UAAI,OAAOA,IAAP,KAAgB,QAApB,EAA8B;AAC5BA,eAAOA,KAAK3I,KAAL,CAAW,GAAX,CAAP;AACD;;AAED,aAAO2I,IAAP;AACD,KA/Ee;;AAiFhB;;;;;AAKAgwC,wBAAoB,4BAAUC,eAAV,EAA2B;AAC7CZ,YAAM,IAAN,EAAYM,SAAZ,GAAwBM,eAAxB;AACD,KAxFe;AAyFhBvD,wBAAoB,8BAAY;AAC9B,UAAI,CAACxyD,MAAMX,IAAX,EAAiB;AACf,YAAI,KAAKgzC,MAAL,CAAYxtB,SAAZ,IAAyB,IAA7B,EAAmC;AACjC,iBAAO,CAAC,CAAC,KAAKwtB,MAAL,CAAYxtB,SAArB;AACD,SAFD,MAEO,IAAI,KAAK8sC,WAAT,EAAsB;AAC3B,iBAAO,KAAKA,WAAL,CAAiBa,kBAAjB,EAAP;AACD;AACF;AACF;AAjGe,GAAlB;;AAoGA,WAAS+C,KAAT,CAAevwD,GAAf,EAAoBgxD,OAApB,EAA6BrE,WAA7B,EAA0C;AACxC,SAAK,IAAIhvD,IAAI,CAAb,EAAgBA,IAAIqzD,QAAQnzD,MAA5B,EAAoCF,GAApC,EAAyC;AACvC;AACA,UAAI,CAACqzD,QAAQrzD,CAAR,CAAL,EAAiB;AACf;AACD,OAJsC,CAIrC;;;AAGFqC,YAAMA,OAAO,QAAOA,GAAP,yCAAOA,GAAP,OAAe,QAAtB,GAAiCA,IAAIgxD,QAAQrzD,CAAR,CAAJ,CAAjC,GAAmD,IAAzD;;AAEA,UAAIqC,OAAO,IAAX,EAAiB;AACf;AACD;AACF;;AAED,QAAIA,OAAO,IAAP,IAAe2sD,WAAnB,EAAgC;AAC9B3sD,YAAM2sD,YAAY9pD,GAAZ,CAAgBmuD,OAAhB,CAAN;AACD;;AAED,WAAOhxD,GAAP;AACD,GAtkgB2B,CAskgB1B;;;AAGF,WAASywD,SAAT,CAAmBze,KAAnB,EAA0BlxB,IAA1B,EAAgC;AAC9B,QAAIiwC,kBAAkBZ,MAAMne,KAAN,EAAaye,SAAnC;AACA,WAAOM,kBAAkBA,gBAAgBtzD,IAAhB,CAAqBu0C,KAArB,EAA4BlxB,IAA5B,CAAlB,GAAsDkxB,MAAM2a,WAAnE;AACD,GA5kgB2B,CA4kgB1B;;;AAGF9c,oBAAkBugB,KAAlB;AACA9f,mBAAiB8f,KAAjB;AACAF,UAAQE,KAAR,EAAe/d,cAAf;AACA6d,UAAQE,KAAR,EAAezd,cAAf;AACAud,UAAQE,KAAR,EAAeR,cAAf;AACAM,UAAQE,KAAR,EAAeJ,cAAf;;AAEA;;;;;;;;;;;;;;;;;;AAkBA,MAAIiB,OAAO,CAAX;AACA;;;;;;AAMA,WAASC,MAAT,CAAgBnwD,IAAhB,EAAsB;AACpB;AACA;AACA,WAAO,CAACA,QAAQ,EAAT,EAAakwD,MAAb,EAAqBxsD,KAAKg7B,MAAL,GAAc+O,OAAd,CAAsB,CAAtB,CAArB,EAA+C9xB,IAA/C,CAAoD,GAApD,CAAP;AACD;AACD;;;;AAIA,WAASy0C,sBAAT,CAAgCvgB,MAAhC,EAAwC;AACtC,QAAIwgB,oBAAoB,EAAxB;;AAEAxgB,WAAOygB,wBAAP,GAAkC,UAAU3hB,aAAV,EAAyB4hB,SAAzB,EAAoC;AACpE5hB,sBAAgBD,iBAAiBC,aAAjB,CAAhB;AACA0hB,wBAAkB1hB,cAAcC,IAAhC,IAAwC2hB,SAAxC;AACD,KAHD;;AAKA1gB,WAAO2gB,gBAAP,GAA0B,UAAU7hB,aAAV,EAAyBrC,MAAzB,EAAiC;AACzD,UAAItsC,OAAOssC,OAAOtsC,IAAlB;;AAEA,UAAI,CAACA,IAAL,EAAW;AACT,YAAIywD,oBAAoB/hB,iBAAiBC,aAAjB,EAAgCC,IAAxD;;AAEA,YAAIiB,OAAOc,WAAP,CAAmBhC,aAAnB,KAAqC0hB,kBAAkBI,iBAAlB,CAAzC,EAA+E;AAC7EzwD,iBAAOqwD,kBAAkBI,iBAAlB,EAAqCnkB,MAArC,CAAP;AACD;AACF;;AAED,aAAOtsC,IAAP;AACD,KAZD;;AAcA,WAAO6vC,MAAP;AACD;AACD;;;;;;;;;;AAUA,WAAS6gB,uBAAT,CAAiC7gB,MAAjC,EAAyC8gB,gBAAzC,EAA2D;AACzD;;;;;;;;AAQA9gB,WAAO+gB,iBAAP,GAA2B,UAAUC,cAAV,EAA0BC,YAA1B,EAAwCtyC,QAAxC,EAAkDrf,OAAlD,EAA2D;AACpF,UAAI,CAAC0xD,eAAe/zD,MAApB,EAA4B;AAC1B;AACD;;AAED,UAAIN,SAASu0D,mBAAmBD,YAAnB,CAAb;AACA,UAAIE,QAAQx0D,OAAOw0D,KAAnB;AACA,UAAIC,QAAQz0D,OAAO00D,WAAnB;AACA,UAAIC,gBAAgB,EAApB;AACAnyD,aAAO6xD,cAAP,EAAuB,UAAU10D,IAAV,EAAgB;AACrCg1D,sBAAch1D,IAAd,IAAsB,IAAtB;AACD,OAFD;;AAIA,aAAO80D,MAAMn0D,MAAb,EAAqB;AACnB,YAAIs0D,oBAAoBH,MAAM35C,GAAN,EAAxB;AACA,YAAI+5C,aAAaL,MAAMI,iBAAN,CAAjB;AACA,YAAIE,oBAAoB,CAAC,CAACH,cAAcC,iBAAd,CAA1B;;AAEA,YAAIE,iBAAJ,EAAuB;AACrB9yC,mBAAS9hB,IAAT,CAAcyC,OAAd,EAAuBiyD,iBAAvB,EAA0CC,WAAWE,YAAX,CAAwB31D,KAAxB,EAA1C;AACA,iBAAOu1D,cAAcC,iBAAd,CAAP;AACD;;AAEDpyD,eAAOqyD,WAAWG,SAAlB,EAA6BF,oBAAoBG,gBAApB,GAAuCC,UAApE;AACD;;AAED1yD,aAAOmyD,aAAP,EAAsB,YAAY;AAChC,cAAM,IAAIjwD,KAAJ,CAAU,8BAAV,CAAN;AACD,OAFD;;AAIA,eAASwwD,UAAT,CAAoBC,iBAApB,EAAuC;AACrCX,cAAMW,iBAAN,EAAyBC,UAAzB;;AAEA,YAAIZ,MAAMW,iBAAN,EAAyBC,UAAzB,KAAwC,CAA5C,EAA+C;AAC7CX,gBAAM7xD,IAAN,CAAWuyD,iBAAX;AACD;AACF,OApCmF,CAoClF;AACF;AACA;AACA;AACA;AACA;;;AAGA,eAASF,gBAAT,CAA0BE,iBAA1B,EAA6C;AAC3CR,sBAAcQ,iBAAd,IAAmC,IAAnC;AACAD,mBAAWC,iBAAX;AACD;AACF,KAhDD;AAiDA;;;;;;;;;;AAWA,aAASZ,kBAAT,CAA4BD,YAA5B,EAA0C;AACxC,UAAIE,QAAQ,EAAZ;AACA,UAAIE,cAAc,EAAlB;AACAlyD,aAAO8xD,YAAP,EAAqB,UAAU30D,IAAV,EAAgB;AACnC,YAAI01D,WAAWC,0BAA0Bd,KAA1B,EAAiC70D,IAAjC,CAAf;AACA,YAAIo1D,eAAeM,SAASN,YAAT,GAAwBZ,iBAAiBx0D,IAAjB,CAA3C;AACA,YAAI41D,gBAAgBC,yBAAyBT,YAAzB,EAAuCT,YAAvC,CAApB;AACAe,iBAASD,UAAT,GAAsBG,cAAcj1D,MAApC;;AAEA,YAAI+0D,SAASD,UAAT,KAAwB,CAA5B,EAA+B;AAC7BV,sBAAY9xD,IAAZ,CAAiBjD,IAAjB;AACD;;AAED6C,eAAO+yD,aAAP,EAAsB,UAAUE,aAAV,EAAyB;AAC7C,cAAI9zD,QAAQ0zD,SAASK,WAAjB,EAA8BD,aAA9B,IAA+C,CAAnD,EAAsD;AACpDJ,qBAASK,WAAT,CAAqB9yD,IAArB,CAA0B6yD,aAA1B;AACD;;AAED,cAAIE,WAAWL,0BAA0Bd,KAA1B,EAAiCiB,aAAjC,CAAf;;AAEA,cAAI9zD,QAAQg0D,SAASX,SAAjB,EAA4BS,aAA5B,IAA6C,CAAjD,EAAoD;AAClDE,qBAASX,SAAT,CAAmBpyD,IAAnB,CAAwBjD,IAAxB;AACD;AACF,SAVD;AAWD,OArBD;AAsBA,aAAO;AACL60D,eAAOA,KADF;AAELE,qBAAaA;AAFR,OAAP;AAID;;AAED,aAASY,yBAAT,CAAmCd,KAAnC,EAA0C70D,IAA1C,EAAgD;AAC9C,UAAI,CAAC60D,MAAM70D,IAAN,CAAL,EAAkB;AAChB60D,cAAM70D,IAAN,IAAc;AACZ+1D,uBAAa,EADD;AAEZV,qBAAW;AAFC,SAAd;AAID;;AAED,aAAOR,MAAM70D,IAAN,CAAP;AACD;;AAED,aAAS61D,wBAAT,CAAkCT,YAAlC,EAAgDT,YAAhD,EAA8D;AAC5D,UAAIiB,gBAAgB,EAApB;AACA/yD,aAAOuyD,YAAP,EAAqB,UAAUa,GAAV,EAAe;AAClCj0D,gBAAQ2yD,YAAR,EAAsBsB,GAAtB,KAA8B,CAA9B,IAAmCL,cAAc3yD,IAAd,CAAmBgzD,GAAnB,CAAnC;AACD,OAFD;AAGA,aAAOL,aAAP;AACD;AACF;;AAED;;;;;;;;;;;;;;;;;;AAkBA,MAAIM,iBAAiB,IAArB;;AAEA,WAASC,KAAT,CAAelxD,GAAf,EAAoB;AAClB,WAAOA,IAAIC,OAAJ,CAAY,MAAZ,EAAoB,EAApB,EAAwBA,OAAxB,CAAgC,MAAhC,EAAwC,EAAxC,CAAP;AACD;AACD;;;;;;;;;;AAWA,WAASkxD,SAAT,CAAmBzxD,GAAnB,EAAwB0xD,MAAxB,EAAgC70C,KAAhC,EAAuC80C,KAAvC,EAA8C;AAC5C,QAAIC,YAAYF,OAAO,CAAP,IAAYA,OAAO,CAAP,CAA5B;AACA,QAAIG,WAAWh1C,MAAM,CAAN,IAAWA,MAAM,CAAN,CAA1B;;AAEA,QAAI+0C,cAAc,CAAlB,EAAqB;AACnB,aAAOC,aAAa,CAAb,GAAiBh1C,MAAM,CAAN,CAAjB,GAA4B,CAACA,MAAM,CAAN,IAAWA,MAAM,CAAN,CAAZ,IAAwB,CAA3D;AACD,KAN2C,CAM1C;AACF;AACA;AACA;AACA;;;AAGA,QAAI80C,KAAJ,EAAW;AACT,UAAIC,YAAY,CAAhB,EAAmB;AACjB,YAAI5xD,OAAO0xD,OAAO,CAAP,CAAX,EAAsB;AACpB,iBAAO70C,MAAM,CAAN,CAAP;AACD,SAFD,MAEO,IAAI7c,OAAO0xD,OAAO,CAAP,CAAX,EAAsB;AAC3B,iBAAO70C,MAAM,CAAN,CAAP;AACD;AACF,OAND,MAMO;AACL,YAAI7c,OAAO0xD,OAAO,CAAP,CAAX,EAAsB;AACpB,iBAAO70C,MAAM,CAAN,CAAP;AACD,SAFD,MAEO,IAAI7c,OAAO0xD,OAAO,CAAP,CAAX,EAAsB;AAC3B,iBAAO70C,MAAM,CAAN,CAAP;AACD;AACF;AACF,KAdD,MAcO;AACL,UAAI7c,QAAQ0xD,OAAO,CAAP,CAAZ,EAAuB;AACrB,eAAO70C,MAAM,CAAN,CAAP;AACD;;AAED,UAAI7c,QAAQ0xD,OAAO,CAAP,CAAZ,EAAuB;AACrB,eAAO70C,MAAM,CAAN,CAAP;AACD;AACF;;AAED,WAAO,CAAC7c,MAAM0xD,OAAO,CAAP,CAAP,IAAoBE,SAApB,GAAgCC,QAAhC,GAA2Ch1C,MAAM,CAAN,CAAlD;AACD;AACD;;;;;;;;;AASA,WAASi1C,cAAT,CAAwB1/C,OAAxB,EAAiC2/C,GAAjC,EAAsC;AACpC,YAAQ3/C,OAAR;AACE,WAAK,QAAL;AACA,WAAK,QAAL;AACEA,kBAAU,KAAV;AACA;;AAEF,WAAK,MAAL;AACA,WAAK,KAAL;AACEA,kBAAU,IAAV;AACA;;AAEF,WAAK,OAAL;AACA,WAAK,QAAL;AACEA,kBAAU,MAAV;AACA;AAdJ;;AAiBA,QAAI,OAAOA,OAAP,KAAmB,QAAvB,EAAiC;AAC/B,UAAIo/C,MAAMp/C,OAAN,EAAe9Y,KAAf,CAAqB,IAArB,CAAJ,EAAgC;AAC9B,eAAOyb,WAAW3C,OAAX,IAAsB,GAAtB,GAA4B2/C,GAAnC;AACD;;AAED,aAAOh9C,WAAW3C,OAAX,CAAP;AACD;;AAED,WAAOA,WAAW,IAAX,GAAkB4/C,GAAlB,GAAwB,CAAC5/C,OAAhC;AACD;AACD;;;;;;;;;;AAUA,WAAS6/C,OAAT,CAAiBhwD,CAAjB,EAAoBiwD,SAApB,EAA+BC,SAA/B,EAA0C;AACxC,QAAID,aAAa,IAAjB,EAAuB;AACrBA,kBAAY,EAAZ;AACD,KAHuC,CAGtC;;;AAGFA,gBAAYtvD,KAAKoB,GAAL,CAASpB,KAAKqB,GAAL,CAAS,CAAT,EAAYiuD,SAAZ,CAAT,EAAiC,EAAjC,CAAZ;AACAjwD,QAAI,CAAC,CAACA,CAAF,EAAK0qC,OAAL,CAAaulB,SAAb,CAAJ;AACA,WAAOC,YAAYlwD,CAAZ,GAAgB,CAACA,CAAxB;AACD;AACD,WAASmwD,GAAT,CAAalS,GAAb,EAAkB;AAChBA,QAAIjkC,IAAJ,CAAS,UAAU7a,CAAV,EAAaC,CAAb,EAAgB;AACvB,aAAOD,IAAIC,CAAX;AACD,KAFD;AAGA,WAAO6+C,GAAP;AACD;AACD;;;;;AAKA,WAASmS,YAAT,CAAsBryD,GAAtB,EAA2B;AACzBA,UAAM,CAACA,GAAP;;AAEA,QAAIia,MAAMja,GAAN,CAAJ,EAAgB;AACd,aAAO,CAAP;AACD,KALwB,CAKvB;AACF;AACA;AACA;;;AAGA,QAAIwE,IAAI,CAAR;AACA,QAAImb,QAAQ,CAAZ;;AAEA,WAAO/c,KAAK6R,KAAL,CAAWzU,MAAMwE,CAAjB,IAAsBA,CAAtB,KAA4BxE,GAAnC,EAAwC;AACtCwE,WAAK,EAAL;AACAmb;AACD;;AAED,WAAOA,KAAP;AACD;AACD;;;;;AAKA,WAAS2yC,gBAAT,CAA0BtyD,GAA1B,EAA+B;AAC7B,QAAIM,MAAMN,IAAI1F,QAAJ,EAAV,CAD6B,CACH;;AAE1B,QAAIi4D,SAASjyD,IAAIjD,OAAJ,CAAY,GAAZ,CAAb;;AAEA,QAAIk1D,SAAS,CAAb,EAAgB;AACd,UAAIL,YAAY,CAAC5xD,IAAIxF,KAAJ,CAAUy3D,SAAS,CAAnB,CAAjB;AACA,aAAOL,YAAY,CAAZ,GAAgB,CAACA,SAAjB,GAA6B,CAApC;AACD,KAHD,MAGO;AACL,UAAIM,WAAWlyD,IAAIjD,OAAJ,CAAY,GAAZ,CAAf;AACA,aAAOm1D,WAAW,CAAX,GAAe,CAAf,GAAmBlyD,IAAItE,MAAJ,GAAa,CAAb,GAAiBw2D,QAA3C;AACD;AACF;AACD;;;;;;;;AAQA,WAASC,kBAAT,CAA2BC,UAA3B,EAAuCC,WAAvC,EAAoD;AAClD,QAAIh0C,MAAM/b,KAAK+b,GAAf;AACA,QAAIi0C,OAAOhwD,KAAKgwD,IAAhB;AACA,QAAIC,eAAejwD,KAAKuV,KAAL,CAAWwG,IAAI+zC,WAAW,CAAX,IAAgBA,WAAW,CAAX,CAApB,IAAqCE,IAAhD,CAAnB;AACA,QAAIE,eAAelwD,KAAK6R,KAAL,CAAWkK,IAAI/b,KAAKyzC,GAAL,CAASsc,YAAY,CAAZ,IAAiBA,YAAY,CAAZ,CAA1B,CAAJ,IAAiDC,IAA5D,CAAnB,CAJkD,CAIoC;;AAEtF,QAAIV,YAAYtvD,KAAKoB,GAAL,CAASpB,KAAKqB,GAAL,CAAS,CAAC4uD,YAAD,GAAgBC,YAAzB,EAAuC,CAAvC,CAAT,EAAoD,EAApD,CAAhB;AACA,WAAO,CAACxsB,SAAS4rB,SAAT,CAAD,GAAuB,EAAvB,GAA4BA,SAAnC;AACD;AACD;;;;;;;;;;;;AAYA,WAASa,uBAAT,CAAiCC,SAAjC,EAA4CjwC,GAA5C,EAAiDmvC,SAAjD,EAA4D;AAC1D,QAAI,CAACc,UAAUjwC,GAAV,CAAL,EAAqB;AACnB,aAAO,CAAP;AACD;;AAED,QAAI+/B,MAAM5nD,OAAO83D,SAAP,EAAkB,UAAUC,GAAV,EAAejzD,GAAf,EAAoB;AAC9C,aAAOizD,OAAOh5C,MAAMja,GAAN,IAAa,CAAb,GAAiBA,GAAxB,CAAP;AACD,KAFS,EAEP,CAFO,CAAV;;AAIA,QAAI8iD,QAAQ,CAAZ,EAAe;AACb,aAAO,CAAP;AACD;;AAED,QAAIoQ,SAAStwD,KAAKoN,GAAL,CAAS,EAAT,EAAakiD,SAAb,CAAb;AACA,QAAIiB,gBAAgBn4D,IAAIg4D,SAAJ,EAAe,UAAUhzD,GAAV,EAAe;AAChD,aAAO,CAACia,MAAMja,GAAN,IAAa,CAAb,GAAiBA,GAAlB,IAAyB8iD,GAAzB,GAA+BoQ,MAA/B,GAAwC,GAA/C;AACD,KAFmB,CAApB;AAGA,QAAIE,cAAcF,SAAS,GAA3B;AACA,QAAIG,QAAQr4D,IAAIm4D,aAAJ,EAAmB,UAAUG,KAAV,EAAiB;AAC9C;AACA,aAAO1wD,KAAKuV,KAAL,CAAWm7C,KAAX,CAAP;AACD,KAHW,CAAZ;AAIA,QAAIC,aAAar4D,OAAOm4D,KAAP,EAAc,UAAUJ,GAAV,EAAejzD,GAAf,EAAoB;AACjD,aAAOizD,MAAMjzD,GAAb;AACD,KAFgB,EAEd,CAFc,CAAjB;AAGA,QAAI2S,YAAY3X,IAAIm4D,aAAJ,EAAmB,UAAUG,KAAV,EAAiBvwC,GAAjB,EAAsB;AACvD,aAAOuwC,QAAQD,MAAMtwC,GAAN,CAAf;AACD,KAFe,CAAhB,CAzB0D,CA2BtD;;AAEJ,WAAOwwC,aAAaH,WAApB,EAAiC;AAC/B;AACA,UAAInvD,MAAMk2C,OAAOqZ,iBAAjB;AACA,UAAIC,QAAQ,IAAZ;;AAEA,WAAK,IAAI33D,IAAI,CAAR,EAAWC,MAAM4W,UAAU3W,MAAhC,EAAwCF,IAAIC,GAA5C,EAAiD,EAAED,CAAnD,EAAsD;AACpD,YAAI6W,UAAU7W,CAAV,IAAemI,GAAnB,EAAwB;AACtBA,gBAAM0O,UAAU7W,CAAV,CAAN;AACA23D,kBAAQ33D,CAAR;AACD;AACF,OAV8B,CAU7B;;;AAGF,QAAEu3D,MAAMI,KAAN,CAAF;AACA9gD,gBAAU8gD,KAAV,IAAmB,CAAnB;AACA,QAAEF,UAAF;AACD;;AAED,WAAOF,MAAMtwC,GAAN,IAAamwC,MAApB;AACD,GAnhhB2B,CAmhhB1B;;AAEF,MAAIQ,mBAAmB,gBAAvB;AACA;;;;;;AAMA,WAASC,SAAT,CAAmBC,MAAnB,EAA2B;AACzB,QAAIC,MAAMjxD,KAAKgN,EAAL,GAAU,CAApB;AACA,WAAO,CAACgkD,SAASC,GAAT,GAAeA,GAAhB,IAAuBA,GAA9B;AACD;AACD;;;;;AAKA,WAASC,kBAAT,CAA4B9zD,GAA5B,EAAiC;AAC/B,WAAOA,MAAM,CAACuxD,cAAP,IAAyBvxD,MAAMuxD,cAAtC;AACD;AACD,MAAIwC,WAAW,mIAAf,CAxihB4B,CAwihBwH;;AAEpJ;;;;;;;;;;;;;;;;AAgBA,WAASC,SAAT,CAAmBz2D,KAAnB,EAA0B;AACxB,QAAIA,iBAAiBiiC,IAArB,EAA2B;AACzB,aAAOjiC,KAAP;AACD,KAFD,MAEO,IAAI,OAAOA,KAAP,KAAiB,QAArB,EAA+B;AACpC;AACA;AACA;AACA;AACA;AACA,UAAIjE,QAAQy6D,SAAS5/B,IAAT,CAAc52B,KAAd,CAAZ;;AAEA,UAAI,CAACjE,KAAL,EAAY;AACV;AACA,eAAO,IAAIkmC,IAAJ,CAASwyB,GAAT,CAAP;AACD,OAXmC,CAWlC;;;AAGF,UAAI,CAAC14D,MAAM,CAAN,CAAL,EAAe;AACb;AACA;AACA,eAAO,IAAIkmC,IAAJ,CAAS,CAAClmC,MAAM,CAAN,CAAV,EAAoB,EAAEA,MAAM,CAAN,KAAY,CAAd,IAAmB,CAAvC,EAA0C,CAACA,MAAM,CAAN,CAAD,IAAa,CAAvD,EAA0D,CAACA,MAAM,CAAN,CAAD,IAAa,CAAvE,EAA0E,EAAEA,MAAM,CAAN,KAAY,CAAd,CAA1E,EAA4F,CAACA,MAAM,CAAN,CAAD,IAAa,CAAzG,EAA4G,CAACA,MAAM,CAAN,CAAD,IAAa,CAAzH,CAAP;AACD,OAJD,CAIE;AACF;AACA;AACA;AACA;AACA;AACA;AAVA,WAWK;AACD,cAAI26D,OAAO,CAAC36D,MAAM,CAAN,CAAD,IAAa,CAAxB;;AAEA,cAAIA,MAAM,CAAN,EAAS0iC,WAAT,OAA2B,GAA/B,EAAoC;AAClCi4B,oBAAQ36D,MAAM,CAAN,EAASwB,KAAT,CAAe,CAAf,EAAkB,CAAlB,CAAR;AACD;;AAED,iBAAO,IAAI0kC,IAAJ,CAASA,KAAK00B,GAAL,CAAS,CAAC56D,MAAM,CAAN,CAAV,EAAoB,EAAEA,MAAM,CAAN,KAAY,CAAd,IAAmB,CAAvC,EAA0C,CAACA,MAAM,CAAN,CAAD,IAAa,CAAvD,EAA0D26D,IAA1D,EAAgE,EAAE36D,MAAM,CAAN,KAAY,CAAd,CAAhE,EAAkF,CAACA,MAAM,CAAN,CAAD,IAAa,CAA/F,EAAkG,CAACA,MAAM,CAAN,CAAD,IAAa,CAA/G,CAAT,CAAP;AACD;AACJ,KAlCM,MAkCA,IAAIiE,SAAS,IAAb,EAAmB;AACxB,aAAO,IAAIiiC,IAAJ,CAASwyB,GAAT,CAAP;AACD;;AAED,WAAO,IAAIxyB,IAAJ,CAAS58B,KAAK6R,KAAL,CAAWlX,KAAX,CAAT,CAAP;AACD;AACD;;;;;;;AAOA,WAAS42D,QAAT,CAAkBn0D,GAAlB,EAAuB;AACrB,WAAO4C,KAAKoN,GAAL,CAAS,EAAT,EAAaokD,iBAAiBp0D,GAAjB,CAAb,CAAP;AACD;;AAED,WAASo0D,gBAAT,CAA0Bp0D,GAA1B,EAA+B;AAC7B,WAAO4C,KAAKuV,KAAL,CAAWvV,KAAK+b,GAAL,CAAS3e,GAAT,IAAgB4C,KAAKgwD,IAAhC,CAAP;AACD;AACD;;;;;;;;;;;;AAaA,WAASyB,IAAT,CAAcr0D,GAAd,EAAmByU,KAAnB,EAA0B;AACxB,QAAI6/C,WAAWF,iBAAiBp0D,GAAjB,CAAf;AACA,QAAIu0D,QAAQ3xD,KAAKoN,GAAL,CAAS,EAAT,EAAaskD,QAAb,CAAZ;AACA,QAAI1/C,IAAI5U,MAAMu0D,KAAd,CAHwB,CAGH;;AAErB,QAAIC,EAAJ;;AAEA,QAAI//C,KAAJ,EAAW;AACT,UAAIG,IAAI,GAAR,EAAa;AACX4/C,aAAK,CAAL;AACD,OAFD,MAEO,IAAI5/C,IAAI,GAAR,EAAa;AAClB4/C,aAAK,CAAL;AACD,OAFM,MAEA,IAAI5/C,IAAI,CAAR,EAAW;AAChB4/C,aAAK,CAAL;AACD,OAFM,MAEA,IAAI5/C,IAAI,CAAR,EAAW;AAChB4/C,aAAK,CAAL;AACD,OAFM,MAEA;AACLA,aAAK,EAAL;AACD;AACF,KAZD,MAYO;AACL,UAAI5/C,IAAI,CAAR,EAAW;AACT4/C,aAAK,CAAL;AACD,OAFD,MAEO,IAAI5/C,IAAI,CAAR,EAAW;AAChB4/C,aAAK,CAAL;AACD,OAFM,MAEA,IAAI5/C,IAAI,CAAR,EAAW;AAChB4/C,aAAK,CAAL;AACD,OAFM,MAEA,IAAI5/C,IAAI,CAAR,EAAW;AAChB4/C,aAAK,CAAL;AACD,OAFM,MAEA;AACLA,aAAK,EAAL;AACD;AACF;;AAEDx0D,UAAMw0D,KAAKD,KAAX,CAjCwB,CAiCN;AAClB;;AAEA,WAAOD,YAAY,CAAC,EAAb,GAAkB,CAACt0D,IAAI2sC,OAAJ,CAAY2nB,WAAW,CAAX,GAAe,CAACA,QAAhB,GAA2B,CAAvC,CAAnB,GAA+Dt0D,GAAtE;AACD;AACD;;;;;;;;;;;;;;;;;;;;;;;AAuBA,WAASy0D,eAAT,CAAyBrqD,IAAzB,EAA+B;AAC7BA,SAAK6R,IAAL,CAAU,UAAU7a,CAAV,EAAaC,CAAb,EAAgB;AACxB,aAAOqzD,WAAWtzD,CAAX,EAAcC,CAAd,EAAiB,CAAjB,IAAsB,CAAC,CAAvB,GAA2B,CAAlC;AACD,KAFD;AAGA,QAAIszD,OAAO,CAAC/gB,QAAZ;AACA,QAAIghB,YAAY,CAAhB;;AAEA,SAAK,IAAI94D,IAAI,CAAb,EAAgBA,IAAIsO,KAAKpO,MAAzB,GAAkC;AAChC,UAAI23C,WAAWvpC,KAAKtO,CAAL,EAAQ63C,QAAvB;AACA,UAAIkhB,QAAQzqD,KAAKtO,CAAL,EAAQ+4D,KAApB;;AAEA,WAAK,IAAIC,KAAK,CAAd,EAAiBA,KAAK,CAAtB,EAAyBA,IAAzB,EAA+B;AAC7B,YAAInhB,SAASmhB,EAAT,KAAgBH,IAApB,EAA0B;AACxBhhB,mBAASmhB,EAAT,IAAeH,IAAf;AACAE,gBAAMC,EAAN,IAAY,CAACA,EAAD,GAAM,IAAIF,SAAV,GAAsB,CAAlC;AACD;;AAEDD,eAAOhhB,SAASmhB,EAAT,CAAP;AACAF,oBAAYC,MAAMC,EAAN,CAAZ;AACD;;AAED,UAAInhB,SAAS,CAAT,MAAgBA,SAAS,CAAT,CAAhB,IAA+BkhB,MAAM,CAAN,IAAWA,MAAM,CAAN,CAAX,KAAwB,CAA3D,EAA8D;AAC5DzqD,aAAK1D,MAAL,CAAY5K,CAAZ,EAAe,CAAf;AACD,OAFD,MAEO;AACLA;AACD;AACF;;AAED,WAAOsO,IAAP;;AAEA,aAASsqD,UAAT,CAAoBtzD,CAApB,EAAuBC,CAAvB,EAA0ByzD,EAA1B,EAA8B;AAC5B,aAAO1zD,EAAEuyC,QAAF,CAAWmhB,EAAX,IAAiBzzD,EAAEsyC,QAAF,CAAWmhB,EAAX,CAAjB,IAAmC1zD,EAAEuyC,QAAF,CAAWmhB,EAAX,MAAmBzzD,EAAEsyC,QAAF,CAAWmhB,EAAX,CAAnB,KAAsC1zD,EAAEyzD,KAAF,CAAQC,EAAR,IAAczzD,EAAEwzD,KAAF,CAAQC,EAAR,CAAd,MAA+B,CAACA,EAAD,GAAM,CAAN,GAAU,CAAC,CAA1C,KAAgD,CAACA,EAAD,IAAOJ,WAAWtzD,CAAX,EAAcC,CAAd,EAAiB,CAAjB,CAA7F,CAA1C;AACD;AACF;AACD;;;;;;;;;AASA,WAAS0zD,SAAT,CAAmB1yD,CAAnB,EAAsB;AACpB,WAAOA,IAAI0S,WAAW1S,CAAX,CAAJ,IAAqB,CAA5B;AACD;;AAED,MAAI2yD,SAAS,CAAC56D,OAAOsH,MAAP,IAAiBtH,MAAlB,EAA0B;AACtCq3D,eAAWA,SAD2B;AAEtCr4B,kBAAc04B,cAFwB;AAGtCr9C,WAAOw9C,OAH+B;AAItCG,SAAKA,GAJiC;AAKtCC,kBAAcA,YALwB;AAMtCC,sBAAkBA,gBANoB;AAOtCG,uBAAmBA,kBAPmB;AAQtCM,6BAAyBA,uBARa;AAStCW,sBAAkBA,gBAToB;AAUtCC,eAAWA,SAV2B;AAWtCG,wBAAoBA,kBAXkB;AAYtCE,eAAWA,SAZ2B;AAatCG,cAAUA,QAb4B;AActCE,UAAMA,IAdgC;AAetCI,qBAAiBA,eAfqB;AAgBtCM,eAAWA;AAhB2B,GAA1B,CAAb;;AAmBA;;;;;;;;;;;;;;;;;;AAkBA;;;;;;AAMA,WAASE,SAAT,CAAmBhzD,CAAnB,EAAsB;AACpB,QAAIgY,MAAMhY,CAAN,CAAJ,EAAc;AACZ,aAAO,GAAP;AACD;;AAEDA,QAAI,CAACA,IAAI,EAAL,EAASqU,KAAT,CAAe,GAAf,CAAJ;AACA,WAAOrU,EAAE,CAAF,EAAK1B,OAAL,CAAa,gCAAb,EAA+C,KAA/C,KAAyD0B,EAAEjG,MAAF,GAAW,CAAX,GAAe,MAAMiG,EAAE,CAAF,CAArB,GAA4B,EAArF,CAAP;AACD;AACD;;;;;;AAMA,WAASizD,WAAT,CAAqB50D,GAArB,EAA0B60D,cAA1B,EAA0C;AACxC70D,UAAM,CAACA,OAAO,EAAR,EAAYyV,WAAZ,GAA0BxV,OAA1B,CAAkC,OAAlC,EAA2C,UAAUjH,KAAV,EAAiB87D,MAAjB,EAAyB;AACxE,aAAOA,OAAOp5B,WAAP,EAAP;AACD,KAFK,CAAN;;AAIA,QAAIm5B,kBAAkB70D,GAAtB,EAA2B;AACzBA,YAAMA,IAAIwU,MAAJ,CAAW,CAAX,EAAcknB,WAAd,KAA8B17B,IAAIxF,KAAJ,CAAU,CAAV,CAApC;AACD;;AAED,WAAOwF,GAAP;AACD;AACD,MAAI+0D,sBAAsBt1D,iBAA1B;AACA,MAAIu1D,aAAa,YAAjB;AACA,MAAIC,aAAa;AACf,SAAK,OADU;AAEf,SAAK,MAFU;AAGf,SAAK,MAHU;AAIf,SAAK,QAJU;AAKf,UAAM;AALS,GAAjB;AAOA,WAASC,UAAT,CAAoB/5D,MAApB,EAA4B;AAC1B,WAAOA,UAAU,IAAV,GAAiB,EAAjB,GAAsB,CAACA,SAAS,EAAV,EAAc8E,OAAd,CAAsB+0D,UAAtB,EAAkC,UAAUh1D,GAAV,EAAewxC,CAAf,EAAkB;AAC/E,aAAOyjB,WAAWzjB,CAAX,CAAP;AACD,KAF4B,CAA7B;AAGD;AACD,MAAI2jB,gBAAgB,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,GAAhB,EAAqB,GAArB,EAA0B,GAA1B,EAA+B,GAA/B,CAApB;;AAEA,MAAIC,UAAU,SAAVA,OAAU,CAAUC,OAAV,EAAmBC,SAAnB,EAA8B;AAC1C,WAAO,MAAMD,OAAN,IAAiBC,aAAa,IAAb,GAAoB,EAApB,GAAyBA,SAA1C,IAAuD,GAA9D;AACD,GAFD;AAGA;;;;;;;;AASA,WAASC,SAAT,CAAmBC,GAAnB,EAAwBC,UAAxB,EAAoCC,MAApC,EAA4C;AAC1C,QAAI,CAACn5D,QAAQk5D,UAAR,CAAL,EAA0B;AACxBA,mBAAa,CAACA,UAAD,CAAb;AACD;;AAED,QAAIE,YAAYF,WAAW/5D,MAA3B;;AAEA,QAAI,CAACi6D,SAAL,EAAgB;AACd,aAAO,EAAP;AACD;;AAED,QAAIC,QAAQH,WAAW,CAAX,EAAcG,KAAd,IAAuB,EAAnC;;AAEA,SAAK,IAAIp6D,IAAI,CAAb,EAAgBA,IAAIo6D,MAAMl6D,MAA1B,EAAkCF,GAAlC,EAAuC;AACrC,UAAIq6D,QAAQV,cAAc35D,CAAd,CAAZ;AACAg6D,YAAMA,IAAIv1D,OAAJ,CAAYm1D,QAAQS,KAAR,CAAZ,EAA4BT,QAAQS,KAAR,EAAe,CAAf,CAA5B,CAAN;AACD;;AAED,SAAK,IAAIP,YAAY,CAArB,EAAwBA,YAAYK,SAApC,EAA+CL,WAA/C,EAA4D;AAC1D,WAAK,IAAI9mD,IAAI,CAAb,EAAgBA,IAAIonD,MAAMl6D,MAA1B,EAAkC8S,GAAlC,EAAuC;AACrC,YAAI9O,MAAM+1D,WAAWH,SAAX,EAAsBM,MAAMpnD,CAAN,CAAtB,CAAV;AACAgnD,cAAMA,IAAIv1D,OAAJ,CAAYm1D,QAAQD,cAAc3mD,CAAd,CAAR,EAA0B8mD,SAA1B,CAAZ,EAAkDI,SAASR,WAAWx1D,GAAX,CAAT,GAA2BA,GAA7E,CAAN;AACD;AACF;;AAED,WAAO81D,GAAP;AACD;AACD;;;;;;;;;AASA,WAASM,eAAT,CAAyBN,GAAzB,EAA8B5wD,KAA9B,EAAqC8wD,MAArC,EAA6C;AAC3C93D,WAAOgH,KAAP,EAAc,UAAU3H,KAAV,EAAiBlB,GAAjB,EAAsB;AAClCy5D,YAAMA,IAAIv1D,OAAJ,CAAY,MAAMlE,GAAN,GAAY,GAAxB,EAA6B25D,SAASR,WAAWj4D,KAAX,CAAT,GAA6BA,KAA1D,CAAN;AACD,KAFD;AAGA,WAAOu4D,GAAP;AACD;AACD;;;;;;;;AAQA,WAASO,gBAAT,CAA0B1rB,GAA1B,EAA+B2rB,YAA/B,EAA6C;AAC3C3rB,UAAM1rC,SAAS0rC,GAAT,IAAgB;AACpBjzB,aAAOizB,GADa;AAEpB2rB,oBAAcA;AAFM,KAAhB,GAGF3rB,OAAO,EAHX;AAIA,QAAIjzB,QAAQizB,IAAIjzB,KAAhB;AACA,QAAIxY,OAAOyrC,IAAIzrC,IAAf;AACA,QAAIo3D,eAAe3rB,IAAI2rB,YAAvB;;AAEA,QAAI,CAAC5+C,KAAL,EAAY;AACV,aAAO,EAAP;AACD;;AAED,WAAOxY,SAAS,SAAT,GAAqB,8FAA8F,0DAA9F,GAA2Js2D,WAAW99C,KAAX,CAA3J,GAA+K,GAA/K,IAAsL4+C,gBAAgB,EAAtM,IAA4M,WAAjO,GAA+O,wDAAwD,6DAAxD,GAAwHd,WAAW99C,KAAX,CAAxH,GAA4I,GAA5I,IAAmJ4+C,gBAAgB,EAAnK,IAAyK,WAA/Z;AACD;;AAED,WAASC,GAAT,CAAaj2D,GAAb,EAAkBvE,GAAlB,EAAuB;AACrBuE,WAAO,EAAP;AACA,WAAO,OAAO2V,MAAP,CAAc,CAAd,EAAiBla,MAAMuE,IAAItE,MAA3B,IAAqCsE,GAA5C;AACD;AACD;;;;;;;;;;AAWA,WAASk2D,UAAT,CAAoBV,GAApB,EAAyBv4D,KAAzB,EAAgCk5D,KAAhC,EAAuC;AACrC,QAAIX,QAAQ,MAAR,IAAkBA,QAAQ,OAA1B,IAAqCA,QAAQ,SAA7C,IAA0DA,QAAQ,WAAlE,IAAiFA,QAAQ,MAA7F,EAAqG;AACnGA,YAAM,aAAN;AACD;;AAED,QAAIY,OAAO1C,UAAUz2D,KAAV,CAAX;AACA,QAAIo5D,MAAMF,QAAQ,KAAR,GAAgB,EAA1B;AACA,QAAIv0D,IAAIw0D,KAAK,QAAQC,GAAR,GAAc,UAAnB,GAAR;AACA,QAAIngB,IAAIkgB,KAAK,QAAQC,GAAR,GAAc,OAAnB,MAAgC,CAAxC;AACA,QAAIrzD,IAAIozD,KAAK,QAAQC,GAAR,GAAc,MAAnB,GAAR;AACA,QAAIzwD,IAAIwwD,KAAK,QAAQC,GAAR,GAAc,OAAnB,GAAR;AACA,QAAI5yD,IAAI2yD,KAAK,QAAQC,GAAR,GAAc,SAAnB,GAAR;AACA,QAAIvzD,IAAIszD,KAAK,QAAQC,GAAR,GAAc,SAAnB,GAAR;AACA,QAAIt/C,IAAIq/C,KAAK,QAAQC,GAAR,GAAc,cAAnB,GAAR;AACAb,UAAMA,IAAIv1D,OAAJ,CAAY,IAAZ,EAAkBg2D,IAAI/f,CAAJ,EAAO,CAAP,CAAlB,EAA6Bj2C,OAA7B,CAAqC,GAArC,EAA0Ci2C,CAA1C,EAA6Cj2C,OAA7C,CAAqD,MAArD,EAA6D2B,CAA7D,EAAgE3B,OAAhE,CAAwE,IAAxE,EAA8E2B,IAAI,GAAlF,EAAuF3B,OAAvF,CAA+F,IAA/F,EAAqGg2D,IAAIjzD,CAAJ,EAAO,CAAP,CAArG,EAAgH/C,OAAhH,CAAwH,GAAxH,EAA6H+C,CAA7H,EAAgI/C,OAAhI,CAAwI,IAAxI,EAA8Ig2D,IAAIrwD,CAAJ,EAAO,CAAP,CAA9I,EAAyJ3F,OAAzJ,CAAiK,GAAjK,EAAsK2F,CAAtK,EAAyK3F,OAAzK,CAAiL,IAAjL,EAAuLg2D,IAAIxyD,CAAJ,EAAO,CAAP,CAAvL,EAAkMxD,OAAlM,CAA0M,GAA1M,EAA+MwD,CAA/M,EAAkNxD,OAAlN,CAA0N,IAA1N,EAAgOg2D,IAAInzD,CAAJ,EAAO,CAAP,CAAhO,EAA2O7C,OAA3O,CAAmP,GAAnP,EAAwP6C,CAAxP,EAA2P7C,OAA3P,CAAmQ,KAAnQ,EAA0Qg2D,IAAIl/C,CAAJ,EAAO,CAAP,CAA1Q,CAAN;AACA,WAAOy+C,GAAP;AACD;AACD;;;;;;AAMA,WAASc,YAAT,CAAsBt2D,GAAtB,EAA2B;AACzB,WAAOA,MAAMA,IAAIwU,MAAJ,CAAW,CAAX,EAAcknB,WAAd,KAA8B17B,IAAI2V,MAAJ,CAAW,CAAX,CAApC,GAAoD3V,GAA3D;AACD;AACD,MAAIu2D,iBAAiBjkC,YAArB;AACA,MAAIq7B,cAAcrqC,gBAAlB;;AAEA,MAAIkzC,SAAS,CAAC18D,OAAOsH,MAAP,IAAiBtH,MAAlB,EAA0B;AACtC66D,eAAWA,SAD2B;AAEtCC,iBAAaA,WAFyB;AAGtCn1D,uBAAmBs1D,mBAHmB;AAItCG,gBAAYA,UAJ0B;AAKtCK,eAAWA,SAL2B;AAMtCO,qBAAiBA,eANqB;AAOtCC,sBAAkBA,gBAPoB;AAQtCG,gBAAYA,UAR0B;AAStCI,kBAAcA,YATwB;AAUtChkC,kBAAcikC,cAVwB;AAWtC5I,iBAAaA;AAXyB,GAA1B,CAAb;;AAcA;;;;;;;;;;;;;;;;;;AAkBA;AACA,MAAI8I,SAAS74D,MAAb;AACA;;;;AAIA,MAAI84D,kBAAkB,CAAC,MAAD,EAAS,OAAT,EAAkB,KAAlB,EAAyB,QAAzB,EAAmC,OAAnC,EAA4C,QAA5C,CAAtB;AACA;;;;AAIA,MAAIC,WAAW,CAAC,CAAC,OAAD,EAAU,MAAV,EAAkB,OAAlB,CAAD,EAA6B,CAAC,QAAD,EAAW,KAAX,EAAkB,QAAlB,CAA7B,CAAf;;AAEA,WAASC,SAAT,CAAmBC,MAAnB,EAA2BC,KAA3B,EAAkC1lD,GAAlC,EAAuC2lD,QAAvC,EAAiDC,SAAjD,EAA4D;AAC1D,QAAIr1D,IAAI,CAAR;AACA,QAAIC,IAAI,CAAR;;AAEA,QAAIm1D,YAAY,IAAhB,EAAsB;AACpBA,iBAAWzjB,QAAX;AACD;;AAED,QAAI0jB,aAAa,IAAjB,EAAuB;AACrBA,kBAAY1jB,QAAZ;AACD;;AAED,QAAI2jB,qBAAqB,CAAzB;AACAH,UAAMzzC,SAAN,CAAgB,UAAUT,KAAV,EAAiBH,GAAjB,EAAsB;AACpC,UAAIzV,WAAW4V,MAAM5V,QAArB;AACA,UAAIiV,OAAOW,MAAMU,eAAN,EAAX;AACA,UAAI4zC,YAAYJ,MAAMt0C,OAAN,CAAcC,MAAM,CAApB,CAAhB;AACA,UAAI00C,gBAAgBD,aAAaA,UAAU5zC,eAAV,EAAjC;AACA,UAAI8zC,KAAJ;AACA,UAAIC,KAAJ;;AAEA,UAAIR,WAAW,YAAf,EAA6B;AAC3B,YAAIS,QAAQr1C,KAAKpB,KAAL,IAAcs2C,gBAAgB,CAACA,cAAcx1D,CAAf,GAAmBsgB,KAAKtgB,CAAxC,GAA4C,CAA1D,CAAZ;AACAy1D,gBAAQz1D,IAAI21D,KAAZ,CAF2B,CAER;AACnB;;AAEA,YAAIF,QAAQL,QAAR,IAAoBn0C,MAAM20C,OAA9B,EAAuC;AACrC51D,cAAI,CAAJ;AACAy1D,kBAAQE,KAAR;AACA11D,eAAKq1D,qBAAqB7lD,GAA1B;AACA6lD,+BAAqBh1C,KAAKnB,MAA1B;AACD,SALD,MAKO;AACL;AACAm2C,+BAAqB30D,KAAKqB,GAAL,CAASszD,kBAAT,EAA6Bh1C,KAAKnB,MAAlC,CAArB;AACD;AACF,OAdD,MAcO;AACL,YAAI02C,QAAQv1C,KAAKnB,MAAL,IAAeq2C,gBAAgB,CAACA,cAAcv1D,CAAf,GAAmBqgB,KAAKrgB,CAAxC,GAA4C,CAA3D,CAAZ;AACAy1D,gBAAQz1D,IAAI41D,KAAZ,CAFK,CAEc;;AAEnB,YAAIH,QAAQL,SAAR,IAAqBp0C,MAAM20C,OAA/B,EAAwC;AACtC51D,eAAKs1D,qBAAqB7lD,GAA1B;AACAxP,cAAI,CAAJ;AACAy1D,kBAAQG,KAAR;AACAP,+BAAqBh1C,KAAKpB,KAA1B;AACD,SALD,MAKO;AACLo2C,+BAAqB30D,KAAKqB,GAAL,CAASszD,kBAAT,EAA6Bh1C,KAAKpB,KAAlC,CAArB;AACD;AACF;;AAED,UAAI+B,MAAM20C,OAAV,EAAmB;AACjB;AACD;;AAEDvqD,eAAS,CAAT,IAAcrL,CAAd;AACAqL,eAAS,CAAT,IAAcpL,CAAd;AACAi1D,iBAAW,YAAX,GAA0Bl1D,IAAIy1D,QAAQhmD,GAAtC,GAA4CxP,IAAIy1D,QAAQjmD,GAAxD;AACD,KA3CD;AA4CD;AACD;;;;;;;;;AAUA,MAAI6xB,MAAM2zB,SAAV;AACA;;;;;;;;AAQA,MAAIa,OAAOh5D,MAAMm4D,SAAN,EAAiB,UAAjB,CAAX;AACA;;;;;;;;AAQA,MAAIc,OAAOj5D,MAAMm4D,SAAN,EAAiB,YAAjB,CAAX;AACA;;;;;;;;;;;;;;;;AAiBA;;;;;;;;;;;;;;;;;AAiBA,WAASe,aAAT,CAAuBC,YAAvB,EAAqCC,aAArC,EAAoDC,MAApD,EAA4D;AAC1DA,aAAS/C,oBAAoB+C,UAAU,CAA9B,CAAT;AACA,QAAIvlC,iBAAiBslC,cAAch3C,KAAnC;AACA,QAAIk3C,kBAAkBF,cAAc/2C,MAApC;AACA,QAAI0D,OAAOgtC,eAAeoG,aAAapzC,IAA5B,EAAkC+N,cAAlC,CAAX;AACA,QAAIvE,MAAMwjC,eAAeoG,aAAa5pC,GAA5B,EAAiC+pC,eAAjC,CAAV;AACA,QAAItzC,QAAQ+sC,eAAeoG,aAAanzC,KAA5B,EAAmC8N,cAAnC,CAAZ;AACA,QAAI8D,SAASm7B,eAAeoG,aAAavhC,MAA5B,EAAoC0hC,eAApC,CAAb;AACA,QAAIl3C,QAAQ2wC,eAAeoG,aAAa/2C,KAA5B,EAAmC0R,cAAnC,CAAZ;AACA,QAAIzR,SAAS0wC,eAAeoG,aAAa92C,MAA5B,EAAoCi3C,eAApC,CAAb;AACA,QAAIC,iBAAiBF,OAAO,CAAP,IAAYA,OAAO,CAAP,CAAjC;AACA,QAAIG,mBAAmBH,OAAO,CAAP,IAAYA,OAAO,CAAP,CAAnC;AACA,QAAIz9B,SAASu9B,aAAav9B,MAA1B,CAZ0D,CAYxB;;AAElC,QAAI1gB,MAAMkH,KAAN,CAAJ,EAAkB;AAChBA,cAAQ0R,iBAAiB9N,KAAjB,GAAyBwzC,gBAAzB,GAA4CzzC,IAApD;AACD;;AAED,QAAI7K,MAAMmH,MAAN,CAAJ,EAAmB;AACjBA,eAASi3C,kBAAkB1hC,MAAlB,GAA2B2hC,cAA3B,GAA4ChqC,GAArD;AACD;;AAED,QAAIqM,UAAU,IAAd,EAAoB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAI1gB,MAAMkH,KAAN,KAAgBlH,MAAMmH,MAAN,CAApB,EAAmC;AACjC,YAAIuZ,SAAS9H,iBAAiBwlC,eAA9B,EAA+C;AAC7Cl3C,kBAAQ0R,iBAAiB,GAAzB;AACD,SAFD,MAEO;AACLzR,mBAASi3C,kBAAkB,GAA3B;AACD;AACF,OAdiB,CAchB;;;AAGF,UAAIp+C,MAAMkH,KAAN,CAAJ,EAAkB;AAChBA,gBAAQwZ,SAASvZ,MAAjB;AACD;;AAED,UAAInH,MAAMmH,MAAN,CAAJ,EAAmB;AACjBA,iBAASD,QAAQwZ,MAAjB;AACD;AACF,KA9CyD,CA8CxD;;;AAGF,QAAI1gB,MAAM6K,IAAN,CAAJ,EAAiB;AACfA,aAAO+N,iBAAiB9N,KAAjB,GAAyB5D,KAAzB,GAAiCo3C,gBAAxC;AACD;;AAED,QAAIt+C,MAAMqU,GAAN,CAAJ,EAAgB;AACdA,YAAM+pC,kBAAkB1hC,MAAlB,GAA2BvV,MAA3B,GAAoCk3C,cAA1C;AACD,KAvDyD,CAuDxD;;;AAGF,YAAQJ,aAAapzC,IAAb,IAAqBozC,aAAanzC,KAA1C;AACE,WAAK,QAAL;AACED,eAAO+N,iBAAiB,CAAjB,GAAqB1R,QAAQ,CAA7B,GAAiCi3C,OAAO,CAAP,CAAxC;AACA;;AAEF,WAAK,OAAL;AACEtzC,eAAO+N,iBAAiB1R,KAAjB,GAAyBo3C,gBAAhC;AACA;AAPJ;;AAUA,YAAQL,aAAa5pC,GAAb,IAAoB4pC,aAAavhC,MAAzC;AACE,WAAK,QAAL;AACA,WAAK,QAAL;AACErI,cAAM+pC,kBAAkB,CAAlB,GAAsBj3C,SAAS,CAA/B,GAAmCg3C,OAAO,CAAP,CAAzC;AACA;;AAEF,WAAK,QAAL;AACE9pC,cAAM+pC,kBAAkBj3C,MAAlB,GAA2Bk3C,cAAjC;AACA;AARJ,KApE0D,CA6ExD;;;AAGFxzC,WAAOA,QAAQ,CAAf;AACAwJ,UAAMA,OAAO,CAAb;;AAEA,QAAIrU,MAAMkH,KAAN,CAAJ,EAAkB;AAChB;AACAA,cAAQ0R,iBAAiB0lC,gBAAjB,GAAoCzzC,IAApC,IAA4CC,SAAS,CAArD,CAAR;AACD;;AAED,QAAI9K,MAAMmH,MAAN,CAAJ,EAAmB;AACjB;AACAA,eAASi3C,kBAAkBC,cAAlB,GAAmChqC,GAAnC,IAA0CqI,UAAU,CAApD,CAAT;AACD;;AAED,QAAIpU,OAAO,IAAIrB,YAAJ,CAAiB4D,OAAOszC,OAAO,CAAP,CAAxB,EAAmC9pC,MAAM8pC,OAAO,CAAP,CAAzC,EAAoDj3C,KAApD,EAA2DC,MAA3D,CAAX;AACAmB,SAAK61C,MAAL,GAAcA,MAAd;AACA,WAAO71C,IAAP;AACD;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwCA;;;;;AAMA;;;;;;;;;;;;;;;;;;;;;;;;;;AA0BA,WAASi2C,gBAAT,CAA0BC,YAA1B,EAAwCC,SAAxC,EAAmD/tB,GAAnD,EAAwD;AACtD,KAACjuC,WAAWiuC,GAAX,CAAD,KAAqBA,MAAM,EAA3B;AACA,QAAIguB,aAAahuB,IAAIguB,UAArB;AACA,KAAC97D,QAAQ87D,UAAR,CAAD,KAAyBA,aAAa,CAACA,UAAD,EAAaA,UAAb,CAAtC;AACA,QAAIC,UAAUC,SAAS5B,SAAS,CAAT,CAAT,EAAsB,CAAtB,CAAd;AACA,QAAI6B,UAAUD,SAAS5B,SAAS,CAAT,CAAT,EAAsB,CAAtB,CAAd;AACA70D,SAAK60D,SAAS,CAAT,CAAL,EAAkBwB,YAAlB,EAAgCG,OAAhC;AACAx2D,SAAK60D,SAAS,CAAT,CAAL,EAAkBwB,YAAlB,EAAgCK,OAAhC;;AAEA,aAASD,QAAT,CAAkBE,KAAlB,EAAyBC,KAAzB,EAAgC;AAC9B,UAAIC,YAAY,EAAhB;AACA,UAAIC,gBAAgB,CAApB;AACA,UAAIC,SAAS,EAAb;AACA,UAAIC,mBAAmB,CAAvB;AACA,UAAIC,oBAAoB,CAAxB;AACAtC,aAAOgC,KAAP,EAAc,UAAU19D,IAAV,EAAgB;AAC5B89D,eAAO99D,IAAP,IAAeo9D,aAAap9D,IAAb,CAAf;AACD,OAFD;AAGA07D,aAAOgC,KAAP,EAAc,UAAU19D,IAAV,EAAgB;AAC5B;AACA;AACAi+D,gBAAQZ,SAAR,EAAmBr9D,IAAnB,MAA6B49D,UAAU59D,IAAV,IAAkB89D,OAAO99D,IAAP,IAAeq9D,UAAUr9D,IAAV,CAA9D;AACAk+D,iBAASN,SAAT,EAAoB59D,IAApB,KAA6B69D,eAA7B;AACAK,iBAASJ,MAAT,EAAiB99D,IAAjB,KAA0B+9D,kBAA1B;AACD,OAND;;AAQA,UAAIT,WAAWK,KAAX,CAAJ,EAAuB;AACrB;AACA,YAAIO,SAASb,SAAT,EAAoBK,MAAM,CAAN,CAApB,CAAJ,EAAmC;AACjCI,iBAAOJ,MAAM,CAAN,CAAP,IAAmB,IAAnB;AACD,SAFD,MAEO,IAAIQ,SAASb,SAAT,EAAoBK,MAAM,CAAN,CAApB,CAAJ,EAAmC;AACxCI,iBAAOJ,MAAM,CAAN,CAAP,IAAmB,IAAnB;AACD;;AAED,eAAOI,MAAP;AACD,OA1B6B,CA0B5B;AACF;AACA;AACA;;;AAGA,UAAIC,qBAAqBC,iBAArB,IAA0C,CAACH,aAA/C,EAA8D;AAC5D,eAAOC,MAAP;AACD,OAFD,CAEE;AACF;AACA;AAJA,WAKK,IAAID,iBAAiBG,iBAArB,EAAwC;AACzC,iBAAOJ,SAAP;AACD,SAFE,MAEI;AACL;AACA,eAAK,IAAIn9D,IAAI,CAAb,EAAgBA,IAAIi9D,MAAM/8D,MAA1B,EAAkCF,GAAlC,EAAuC;AACrC,gBAAIT,OAAO09D,MAAMj9D,CAAN,CAAX;;AAEA,gBAAI,CAACw9D,QAAQL,SAAR,EAAmB59D,IAAnB,CAAD,IAA6Bi+D,QAAQb,YAAR,EAAsBp9D,IAAtB,CAAjC,EAA8D;AAC5D49D,wBAAU59D,IAAV,IAAkBo9D,aAAap9D,IAAb,CAAlB;AACA;AACD;AACF;;AAED,iBAAO49D,SAAP;AACD;AACJ;;AAED,aAASK,OAAT,CAAiBn7D,GAAjB,EAAsB9C,IAAtB,EAA4B;AAC1B,aAAO8C,IAAI7B,cAAJ,CAAmBjB,IAAnB,CAAP;AACD;;AAED,aAASk+D,QAAT,CAAkBp7D,GAAlB,EAAuB9C,IAAvB,EAA6B;AAC3B,aAAO8C,IAAI9C,IAAJ,KAAa,IAAb,IAAqB8C,IAAI9C,IAAJ,MAAc,MAA1C;AACD;;AAED,aAAS+G,IAAT,CAAc22D,KAAd,EAAqBv8D,MAArB,EAA6Bf,MAA7B,EAAqC;AACnCs7D,aAAOgC,KAAP,EAAc,UAAU19D,IAAV,EAAgB;AAC5BmB,eAAOnB,IAAP,IAAeI,OAAOJ,IAAP,CAAf;AACD,OAFD;AAGD;AACF;AACD;;;;;;AAMA,WAASm+D,eAAT,CAAyB/9D,MAAzB,EAAiC;AAC/B,WAAOg+D,iBAAiB,EAAjB,EAAqBh+D,MAArB,CAAP;AACD;AACD;;;;;;AAMA,WAASg+D,gBAAT,CAA0Bj9D,MAA1B,EAAkCf,MAAlC,EAA0C;AACxCA,cAAUe,MAAV,IAAoBu6D,OAAOC,eAAP,EAAwB,UAAU37D,IAAV,EAAgB;AAC1DI,aAAOa,cAAP,CAAsBjB,IAAtB,MAAgCmB,OAAOnB,IAAP,IAAeI,OAAOJ,IAAP,CAA/C;AACD,KAFmB,CAApB;AAGA,WAAOmB,MAAP;AACD;;AAED;;;;;;;;;;;;;;;;;;AAkBA,MAAIk9D,iBAAiB;AACnBC,wBAAoB,8BAAY;AAC9B,aAAO;AACL70C,cAAM,KAAK9jB,GAAL,CAAS,MAAT,CADD;AAELstB,aAAK,KAAKttB,GAAL,CAAS,KAAT,CAFA;AAGL+jB,eAAO,KAAK/jB,GAAL,CAAS,OAAT,CAHF;AAIL21B,gBAAQ,KAAK31B,GAAL,CAAS,QAAT,CAJH;AAKLmgB,eAAO,KAAKngB,GAAL,CAAS,OAAT,CALF;AAMLogB,gBAAQ,KAAKpgB,GAAL,CAAS,QAAT;AANH,OAAP;AAQD;AAVkB,GAArB;;AAaA;;;;;;;;;;;;;;;;;;;AAmBA;;;;;AAKA,MAAI44D,UAAUntB,WAAd;AACA;;;;;;;;AAQA,MAAIotB,iBAAiBtL,MAAMtxD,MAAN,CAAa;AAChCiC,UAAM,WAD0B;;AAGhC;;;;AAIAmgB,QAAI,EAP4B;;AAShC;;;;;;;;;AASAhkB,UAAM,EAlB0B;;AAoBhC;;;;AAIA8xC,cAAU,EAxBsB;;AA0BhC;;;;AAIAmC,aAAS,EA9BuB;;AAgChC;;;;AAIAwqB,oBAAgB,CApCgB;;AAsChC;;;;AAIAC,mBAAe,IA1CiB;;AA4ChC;;;;AAIAjtB,aAAS,IAhDuB;;AAkDhC;;;;;;AAMAktB,qBAAiB,EAxDe;;AA0DhC;;;;AAIAC,SAAK,IA9D2B;;AAgEhC;;;;;;AAMAC,gBAAY,IAtEoB;AAuEhC/rB,kBAAc,sBAAU3C,MAAV,EAAkBsf,WAAlB,EAA+Bhe,OAA/B,EAAwCqtB,QAAxC,EAAkD;AAC9D5L,YAAM3yD,IAAN,CAAW,IAAX,EAAiB4vC,MAAjB,EAAyBsf,WAAzB,EAAsChe,OAAtC,EAA+CqtB,QAA/C;AACA,WAAKF,GAAL,GAAW5K,OAAO,cAAP,CAAX;AACD,KA1E+B;AA2EhCjlB,UAAM,cAAUoB,MAAV,EAAkBsf,WAAlB,EAA+Bhe,OAA/B,EAAwCqtB,QAAxC,EAAkD;AACtD,WAAKC,oBAAL,CAA0B5uB,MAA1B,EAAkCsB,OAAlC;AACD,KA7E+B;AA8EhCstB,0BAAsB,8BAAU5uB,MAAV,EAAkBsB,OAAlB,EAA2B;AAC/C,UAAIotB,aAAa,KAAKA,UAAtB;AACA,UAAIG,sBAAsBH,aAAaV,gBAAgBhuB,MAAhB,CAAb,GAAuC,EAAjE;AACA,UAAI8uB,aAAaxtB,QAAQytB,QAAR,EAAjB;AACAh+D,YAAMivC,MAAN,EAAc8uB,WAAWt5D,GAAX,CAAe,KAAKmsC,QAApB,CAAd;AACA5wC,YAAMivC,MAAN,EAAc,KAAKgvB,gBAAL,EAAd;;AAEA,UAAIN,UAAJ,EAAgB;AACd1B,yBAAiBhtB,MAAjB,EAAyB6uB,mBAAzB,EAA8CH,UAA9C;AACD;AACF,KAxF+B;AAyFhC1L,iBAAa,qBAAUhjB,MAAV,EAAkB2uB,QAAlB,EAA4B;AACvC59D,YAAM,KAAKivC,MAAX,EAAmBA,MAAnB,EAA2B,IAA3B;AACA,UAAI0uB,aAAa,KAAKA,UAAtB;;AAEA,UAAIA,UAAJ,EAAgB;AACd1B,yBAAiB,KAAKhtB,MAAtB,EAA8BA,MAA9B,EAAsC0uB,UAAtC;AACD;AACF,KAhG+B;AAiGhC;AACAO,mBAAe,uBAAUC,YAAV,EAAwBC,MAAxB,EAAgC,CAAE,CAlGjB;AAmGhCH,sBAAkB,4BAAY;AAC5B,UAAII,SAAShB,QAAQ,IAAR,CAAb;;AAEA,UAAI,CAACgB,OAAOb,aAAZ,EAA2B;AACzB,YAAIc,UAAU,EAAd;AACA,YAAIC,QAAQ,KAAK5+D,WAAjB;;AAEA,eAAO4+D,KAAP,EAAc;AACZ,cAAInwB,MAAMmwB,MAAMzgE,SAAN,CAAgB0/D,aAA1B;AACApvB,iBAAOkwB,QAAQv8D,IAAR,CAAaqsC,GAAb,CAAP;AACAmwB,kBAAQA,MAAMh9D,UAAd;AACD;;AAED,YAAIi8D,gBAAgB,EAApB;;AAEA,aAAK,IAAIj+D,IAAI++D,QAAQ7+D,MAAR,GAAiB,CAA9B,EAAiCF,KAAK,CAAtC,EAAyCA,GAAzC,EAA8C;AAC5Ci+D,0BAAgBx9D,MAAMw9D,aAAN,EAAqBc,QAAQ/+D,CAAR,CAArB,EAAiC,IAAjC,CAAhB;AACD;;AAED8+D,eAAOb,aAAP,GAAuBA,aAAvB;AACD;;AAED,aAAOa,OAAOb,aAAd;AACD,KA1H+B;AA2HhCgB,4BAAwB,gCAAU5tB,QAAV,EAAoB;AAC1C,aAAO,KAAKL,OAAL,CAAaU,eAAb,CAA6B;AAClCL,kBAAUA,QADwB;AAElC9Y,eAAO,KAAKrzB,GAAL,CAASmsC,WAAW,OAApB,EAA6B,IAA7B,CAF2B;AAGlC9tB,YAAI,KAAKre,GAAL,CAASmsC,WAAW,IAApB,EAA0B,IAA1B;AAH8B,OAA7B,CAAP;AAKD;AAjI+B,GAAb,CAArB,CA56iB4B,CA8ijBxB;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA2B,wBAAsB+qB,cAAtB,EAAsC;AACpC9pB,wBAAoB;AADgB,GAAtC;AAGAuf,yBAAuBuK,cAAvB,EAhkjB4B,CAgkjBY;;AAExCjK,0BAAwBiK,cAAxB,EAAwCmB,eAAxC;;AAEA,WAASA,eAAT,CAAyBntB,aAAzB,EAAwC;AACtC,QAAIotB,OAAO,EAAX;AACA/8D,WAAO27D,eAAerqB,oBAAf,CAAoC3B,aAApC,CAAP,EAA2D,UAAUoB,KAAV,EAAiB;AAC1EgsB,aAAOA,KAAKn8D,MAAL,CAAYmwC,MAAM50C,SAAN,CAAgB6gE,YAAhB,IAAgC,EAA5C,CAAP;AACD,KAFD,EAFsC,CAIlC;;AAEJD,WAAOjgE,IAAIigE,IAAJ,EAAU,UAAU/7D,IAAV,EAAgB;AAC/B,aAAO0uC,iBAAiB1uC,IAAjB,EAAuB4uC,IAA9B;AACD,KAFM,CAAP,CANsC,CAQlC;;AAEJ,QAAID,kBAAkB,SAAlB,IAA+BxwC,QAAQ49D,IAAR,EAAc,SAAd,KAA4B,CAA/D,EAAkE;AAChEA,WAAKE,OAAL,CAAa,SAAb;AACD;;AAED,WAAOF,IAAP;AACD;;AAEDl9D,QAAM87D,cAAN,EAAsBH,cAAtB;;AAEA;;;;;;;;;;;;;;;;;;AAkBA,MAAI0B,WAAW,EAAf,CAzmjB4B,CAymjBT;;AAEnB,MAAI,OAAOpiE,SAAP,KAAqB,WAAzB,EAAsC;AACpCoiE,eAAWpiE,UAAUoiE,QAAV,IAAsB,EAAjC;AACD;;AAED,MAAIC,gBAAgB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA3jD,WAAO,CAAC,SAAD,EAAY,SAAZ,EAAuB,SAAvB,EAAkC,SAAlC,EAA6C,SAA7C,EAAwD,SAAxD,EAAmE,SAAnE,EAA8E,SAA9E,EAAyF,SAAzF,EAAoG,SAApG,EAA+G,SAA/G,CARW;AASlB4jD,mBAAe,CAAC,SAAD,EAAY,SAAZ,EAAuB,SAAvB,CATG;AAUlB;AACA;AACA3R,eAAW;AACT;AACA;AACA;AACAp/B,kBAAY6wC,SAAS9hE,KAAT,CAAe,MAAf,IAAyB,iBAAzB,GAA6C,YAJhD;AAKT;AACAgxB,gBAAU,EAND;AAOTF,iBAAW,QAPF;AAQTC,kBAAY;AARH,KAZO;AAsBlB;AACA;AACA;AACAkxC,eAAW,IAzBO;AA0BlBv9C,eAAW,MA1BO;AA2BlBw9C,uBAAmB,IA3BD;AA4BlBC,6BAAyB,GA5BP;AA6BlB3P,qBAAiB,gBA7BC;AA8BlB4P,2BAAuB,UA9BL;AA+BlBC,wBAAoB,IA/BF;AAgClB;AACAC,0BAAsB,IAjCJ;AAkClB7hC,iBAAa,GAlCK;AAmClB;AACA;AACA;AACA;AACA;AACA8hC,yBAAqB,IAxCH;AAyClB;AACAC,YAAQ;AA1CU,GAApB;;AA6CA;;;;;;;;;;;;;;;;;;AAkBA,MAAIC,UAAUtvB,WAAd;;AAEA,WAASuvB,sBAAT,CAAgC/jD,MAAhC,EAAwCgkD,eAAxC,EAAyD;AACvD,QAAIC,aAAajkD,OAAOjc,MAAxB,CADuD,CACvB;;AAEhC,SAAK,IAAIF,IAAI,CAAb,EAAgBA,IAAIogE,UAApB,EAAgCpgE,GAAhC,EAAqC;AACnC,UAAImc,OAAOnc,CAAP,EAAUE,MAAV,GAAmBigE,eAAvB,EAAwC;AACtC,eAAOhkD,OAAOnc,CAAP,CAAP;AACD;AACF;;AAED,WAAOmc,OAAOikD,aAAa,CAApB,CAAP;AACD;;AAED,MAAIC,oBAAoB;AACtBC,uBAAmB,6BAAY;AAC7BL,cAAQ,IAAR,EAAcM,QAAd,GAAyB,CAAzB;AACAN,cAAQ,IAAR,EAAcO,YAAd,GAA6B,EAA7B;AACD,KAJqB;;AAMtB;;;;;;;AAOAC,yBAAqB,6BAAUlhE,IAAV,EAAgBqjC,KAAhB,EAAuBu9B,eAAvB,EAAwC;AAC3Dv9B,cAAQA,SAAS,IAAjB;AACA,UAAI89B,cAAcT,QAAQr9B,KAAR,CAAlB;AACA,UAAI29B,WAAWG,YAAYH,QAAZ,IAAwB,CAAvC;AACA,UAAIC,eAAeE,YAAYF,YAAZ,GAA2BE,YAAYF,YAAZ,IAA4B,EAA1E,CAJ2D,CAImB;;AAE9E,UAAIA,aAAahgE,cAAb,CAA4BjB,IAA5B,CAAJ,EAAuC;AACrC,eAAOihE,aAAajhE,IAAb,CAAP;AACD;;AAED,UAAIohE,sBAAsBhyB,iBAAiB,KAAKzpC,GAAL,CAAS,OAAT,EAAkB,IAAlB,CAAjB,CAA1B;AACA,UAAI07D,sBAAsB,KAAK17D,GAAL,CAAS,YAAT,EAAuB,IAAvB,CAA1B;AACA,UAAI27D,eAAeV,mBAAmB,IAAnB,IAA2B,CAACS,mBAA5B,GAAkDD,mBAAlD,GAAwET,uBAAuBU,mBAAvB,EAA4CT,eAA5C,CAA3F,CAZ2D,CAY8F;;AAEzJU,qBAAeA,gBAAgBF,mBAA/B;;AAEA,UAAI,CAACE,YAAD,IAAiB,CAACA,aAAa3gE,MAAnC,EAA2C;AACzC;AACD;;AAED,UAAI0b,QAAQilD,aAAaN,QAAb,CAAZ;;AAEA,UAAIhhE,IAAJ,EAAU;AACRihE,qBAAajhE,IAAb,IAAqBqc,KAArB;AACD;;AAED8kD,kBAAYH,QAAZ,GAAuB,CAACA,WAAW,CAAZ,IAAiBM,aAAa3gE,MAArD;AACA,aAAO0b,KAAP;AACD;AAzCqB,GAAxB;;AA4CA;;;;;;;;;;;;;;;;;;;AAmBA;;;;AAIA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;AAmBA,WAASklD,yBAAT,CAAmCC,WAAnC,EAAgD;AAC9C,QAAIC,eAAeD,YAAY77D,GAAZ,CAAgB,kBAAhB,CAAnB;AACA,QAAItF,SAAS;AACXohE,oBAAcA,YADH;AAEXC,oBAAc,EAFH;AAGXC,eAAS97D,eAHE;AAIX+7D,uBAAiB/7D;AAJN,KAAb;AAMA,QAAIg8D,QAAQC,SAASL,YAAT,CAAZ;;AAEA,QAAII,KAAJ,EAAW;AACTA,YAAML,WAAN,EAAmBnhE,MAAnB,EAA2BA,OAAOshE,OAAlC,EAA2CthE,OAAOuhE,eAAlD;AACA,aAAOvhE,MAAP;AACD;AACF;AACD,MAAIyhE,WAAW;AACbC,iBAAa,qBAAUP,WAAV,EAAuBnhE,MAAvB,EAA+BshE,OAA/B,EAAwCC,eAAxC,EAAyD;AACpE,UAAII,aAAaR,YAAY9B,sBAAZ,CAAmC,OAAnC,EAA4C,CAA5C,CAAjB;AACA,UAAIuC,aAAaT,YAAY9B,sBAAZ,CAAmC,OAAnC,EAA4C,CAA5C,CAAjB;AACAr/D,aAAOqhE,YAAP,GAAsB,CAAC,GAAD,EAAM,GAAN,CAAtB;AACAC,cAAQj8D,GAAR,CAAY,GAAZ,EAAiBs8D,UAAjB;AACAL,cAAQj8D,GAAR,CAAY,GAAZ,EAAiBu8D,UAAjB;;AAEA,UAAIC,WAAWF,UAAX,CAAJ,EAA4B;AAC1BJ,wBAAgBl8D,GAAhB,CAAoB,GAApB,EAAyBs8D,UAAzB;AACA3hE,eAAO8hE,qBAAP,GAA+B,CAA/B;AACD;;AAED,UAAID,WAAWD,UAAX,CAAJ,EAA4B;AAC1BL,wBAAgBl8D,GAAhB,CAAoB,GAApB,EAAyBu8D,UAAzB;AACA5hE,eAAO8hE,qBAAP,GAA+B,CAA/B;AACD;AACF,KAjBY;AAkBbC,gBAAY,oBAAUZ,WAAV,EAAuBnhE,MAAvB,EAA+BshE,OAA/B,EAAwCC,eAAxC,EAAyD;AACnE,UAAIS,kBAAkBb,YAAY9B,sBAAZ,CAAmC,YAAnC,EAAiD,CAAjD,CAAtB;AACAr/D,aAAOqhE,YAAP,GAAsB,CAAC,QAAD,CAAtB;AACAC,cAAQj8D,GAAR,CAAY,QAAZ,EAAsB28D,eAAtB;;AAEA,UAAIH,WAAWG,eAAX,CAAJ,EAAiC;AAC/BT,wBAAgBl8D,GAAhB,CAAoB,QAApB,EAA8B28D,eAA9B;AACAhiE,eAAO8hE,qBAAP,GAA+B,CAA/B;AACD;AACF,KA3BY;AA4BbG,WAAO,eAAUd,WAAV,EAAuBnhE,MAAvB,EAA+BshE,OAA/B,EAAwCC,eAAxC,EAAyD;AAC9D,UAAIW,aAAaf,YAAY9B,sBAAZ,CAAmC,OAAnC,EAA4C,CAA5C,CAAjB;AACA,UAAI8C,kBAAkBD,WAAWE,aAAX,CAAyB,YAAzB,CAAtB;AACA,UAAIC,iBAAiBH,WAAWE,aAAX,CAAyB,WAAzB,CAArB;AACApiE,aAAOqhE,YAAP,GAAsB,CAAC,QAAD,EAAW,OAAX,CAAtB;AACAC,cAAQj8D,GAAR,CAAY,QAAZ,EAAsB88D,eAAtB;AACAb,cAAQj8D,GAAR,CAAY,OAAZ,EAAqBg9D,cAArB;;AAEA,UAAIR,WAAWM,eAAX,CAAJ,EAAiC;AAC/BZ,wBAAgBl8D,GAAhB,CAAoB,QAApB,EAA8B88D,eAA9B;AACAniE,eAAO8hE,qBAAP,GAA+B,CAA/B;AACD;;AAED,UAAID,WAAWQ,cAAX,CAAJ,EAAgC;AAC9Bd,wBAAgBl8D,GAAhB,CAAoB,OAApB,EAA6Bg9D,cAA7B;AACAriE,eAAO8hE,qBAAP,GAA+B,CAA/B;AACD;AACF,KA7CY;AA8CbQ,SAAK,aAAUnB,WAAV,EAAuBnhE,MAAvB,EAA+BshE,OAA/B,EAAwCC,eAAxC,EAAyD;AAC5DvhE,aAAOqhE,YAAP,GAAsB,CAAC,KAAD,EAAQ,KAAR,CAAtB;AACD,KAhDY;AAiDbkB,cAAU,kBAAUpB,WAAV,EAAuBnhE,MAAvB,EAA+BshE,OAA/B,EAAwCC,eAAxC,EAAyD;AACjE,UAAInwB,UAAU+vB,YAAY/vB,OAA1B;AACA,UAAIoxB,gBAAgBpxB,QAAQqxB,YAAR,CAAqB,UAArB,EAAiCtB,YAAY77D,GAAZ,CAAgB,eAAhB,CAAjC,CAApB;AACA,UAAI+7D,eAAerhE,OAAOqhE,YAAP,GAAsBmB,cAAcE,UAAd,CAAyBtjE,KAAzB,EAAzC;AACAoD,aAAOggE,cAAcG,iBAArB,EAAwC,UAAUC,SAAV,EAAqBjqC,KAArB,EAA4B;AAClE,YAAIkqC,YAAYzxB,QAAQqxB,YAAR,CAAqB,cAArB,EAAqCG,SAArC,CAAhB;AACA,YAAIE,UAAUzB,aAAa1oC,KAAb,CAAd;AACA2oC,gBAAQj8D,GAAR,CAAYy9D,OAAZ,EAAqBD,SAArB;;AAEA,YAAIhB,WAAWgB,SAAX,KAAyB7iE,OAAO8hE,qBAAP,IAAgC,IAA7D,EAAmE;AACjEP,0BAAgBl8D,GAAhB,CAAoBy9D,OAApB,EAA6BD,SAA7B;AACA7iE,iBAAO8hE,qBAAP,GAA+BnpC,KAA/B;AACD;AACF,OATD;AAUD;AA/DY,GAAf;;AAkEA,WAASkpC,UAAT,CAAoBgB,SAApB,EAA+B;AAC7B,WAAOA,UAAUv9D,GAAV,CAAc,MAAd,MAA0B,UAAjC;AACD;;AAED;;;;;;;;;;;;;;;;;;AAkBA;AACA,MAAIy9D,yBAAyB,UAA7B;AACA,MAAIC,2BAA2B,WAA/B;AACA,MAAIC,4BAA4B,YAAhC;AACA,MAAIC,8BAA8B,cAAlC;AACA,MAAIC,wBAAwB,SAA5B,CAj4jB4B,CAi4jBW;;AAEvC,MAAIC,4BAA4B,YAAhC;AACA,MAAIC,0BAA0B,QAA9B;AACA,MAAIC,uBAAuB,KAA3B;;AAEA;;;;;;;;;;;;;;;;;;AAkBA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoCA;;;;;;;;;;;;;AAaA,WAASC,MAAT,CAAgBrE,MAAhB,EAAwB;AACtB;;;AAGA,SAAKsE,WAAL,GAAmBtE,OAAOsE,WAA1B;AACA;;;;;AAKA,SAAKjhE,IAAL,GAAY28D,OAAO38D,IAAP,KAAgB28D,OAAOuE,YAAP,KAAwBP,2BAAxB,GAAsD,EAAtD,GAA2D,EAA3E,CAAZ;AACA;;;;;;AAMA,SAAKO,YAAL,GAAoBvE,OAAOuE,YAAP,IAAuBN,qBAA3C;AACA;;;;;;AAMA,SAAKO,cAAL,GAAsBxE,OAAOwE,cAAP,IAAyBL,uBAA/C;AACA;;;;;;AAMA,SAAKM,gBAAL,GAAwBzE,OAAOyE,gBAA/B;AACA;;;;;;AAMA,SAAKC,YAAL,GAAoB1E,OAAO0E,YAAP,IAAuBp+D,cAAc05D,OAAO0E,YAArB,CAA3C;AACA;;;;;AAKA,SAAKC,UAAL,GAAkB3E,OAAO2E,UAAP,IAAqB,CAAvC;AACA;;;;;AAKA,SAAKC,qBAAL,GAA6B5E,OAAO4E,qBAApC;AACD;AACD;;;;AAKAP,SAAOQ,kBAAP,GAA4B,UAAUxhE,IAAV,EAAgB;AAC1C,WAAO,IAAIghE,MAAJ,CAAW;AAChBhhE,YAAMA,IADU;AAEhBkhE,oBAAchgE,aAAalB,IAAb,IAAqB6gE,yBAArB,GAAiDL,sBAF/C;AAGhBS,mBAAa;AAHG,KAAX,CAAP;AAKD,GAND;;AAQAzwB,mBAAiBwwB,MAAjB;;AAEA;;;;;;;;;;;;;;;;;;AAkBA,MAAIS,UAAUjzB,WAAd;AACA;;;;;;AAMA,WAASkzB,kBAAT,CAA4BC,YAA5B,EAA0C;AACxC,QAAI3hE,OAAO2hE,aAAap0B,MAAb,CAAoB/vC,MAA/B;AACA,QAAI0jE,eAAeN,qBAAnB;;AAEA,QAAI1/D,aAAalB,IAAb,CAAJ,EAAwB;AACtBkhE,qBAAeL,yBAAf;AACD,KAFD,MAEO,IAAIjiE,QAAQoB,IAAR,CAAJ,EAAmB;AACxB;AACA,WAAK,IAAInC,IAAI,CAAR,EAAWC,MAAMkC,KAAKjC,MAA3B,EAAmCF,IAAIC,GAAvC,EAA4CD,GAA5C,EAAiD;AAC/C,YAAI+vC,OAAO5tC,KAAKnC,CAAL,CAAX;;AAEA,YAAI+vC,QAAQ,IAAZ,EAAkB;AAChB;AACD,SAFD,MAEO,IAAIhvC,QAAQgvC,IAAR,CAAJ,EAAmB;AACxBszB,yBAAeT,wBAAf;AACA;AACD,SAHM,MAGA,IAAIhiE,WAAWmvC,IAAX,CAAJ,EAAsB;AAC3BszB,yBAAeR,yBAAf;AACA;AACD;AACF;AACF,KAfM,MAeA,IAAIjiE,WAAWuB,IAAX,CAAJ,EAAsB;AAC3B,WAAK,IAAI5B,GAAT,IAAgB4B,IAAhB,EAAsB;AACpB,YAAIA,KAAK3B,cAAL,CAAoBD,GAApB,KAA4B2B,YAAYC,KAAK5B,GAAL,CAAZ,CAAhC,EAAwD;AACtD8iE,yBAAeP,2BAAf;AACA;AACD;AACF;AACF,KAPM,MAOA,IAAI3gE,QAAQ,IAAZ,EAAkB;AACvB,YAAM,IAAImC,KAAJ,CAAU,cAAV,CAAN;AACD;;AAEDs/D,YAAQE,YAAR,EAAsBT,YAAtB,GAAqCA,YAArC;AACD;AACD;;;;;;;;;;;;;;;;;;;;;;;;AAwBA,WAASU,UAAT,CAAmBhD,WAAnB,EAAgC;AAC9B,WAAO6C,QAAQ7C,WAAR,EAAqBphE,MAA5B;AACD;AACD;;;;;AAKA,WAASqkE,oBAAT,CAA8BhzB,OAA9B,EAAuC;AACrC;AACA4yB,YAAQ5yB,OAAR,EAAiBizB,UAAjB,GAA8B7+D,eAA9B;AACD;AACD;;;;;;;;;;;;;;;;;AAiBA,WAAS8+D,aAAT,CAAuBnD,WAAvB,EAAoC;AAClC,QAAIoD,eAAepD,YAAYrxB,MAA/B;AACA,QAAIvtC,OAAOgiE,aAAahiE,IAAxB;AACA,QAAIkhE,eAAehgE,aAAalB,IAAb,IAAqB6gE,yBAArB,GAAiDL,sBAApE;AACA,QAAIS,cAAc,KAAlB;AACA,QAAIE,iBAAiBa,aAAab,cAAlC;AACA,QAAIc,eAAeD,aAAaC,YAAhC;AACA,QAAIb,mBAAmBY,aAAa7B,UAApC;AACA,QAAIwB,eAAeO,gBAAgBtD,WAAhB,CAAnB;;AAEA,QAAI+C,YAAJ,EAAkB;AAChB,UAAIQ,gBAAgBR,aAAap0B,MAAjC;AACAvtC,aAAOmiE,cAAc3kE,MAArB;AACA0jE,qBAAeO,QAAQE,YAAR,EAAsBT,YAArC;AACAD,oBAAc,IAAd,CAJgB,CAII;;AAEpBE,uBAAiBA,kBAAkBgB,cAAchB,cAAjD;AACAc,sBAAgB,IAAhB,KAAyBA,eAAeE,cAAcF,YAAtD;AACAb,yBAAmBA,oBAAoBe,cAAchC,UAArD;AACD;;AAED,QAAIiC,iBAAiBC,qBAAqBriE,IAArB,EAA2BkhE,YAA3B,EAAyCC,cAAzC,EAAyDc,YAAzD,EAAuEb,gBAAvE,CAArB,CArBkC,CAqB6E;;AAE/G,QAAIC,eAAeW,aAAajK,MAAhC;;AAEA,QAAI,CAACsJ,YAAD,IAAiBM,YAArB,EAAmC;AACjCN,qBAAeiB,kBAAkB1D,WAAlB,EAA+B+C,YAA/B,EAA6C3hE,IAA7C,EAAmDkhE,YAAnD,EAAiEC,cAAjE,EAAiFiB,cAAjF,CAAf;AACD;;AAEDX,YAAQ7C,WAAR,EAAqBphE,MAArB,GAA8B,IAAIwjE,MAAJ,CAAW;AACvChhE,YAAMA,IADiC;AAEvCihE,mBAAaA,WAF0B;AAGvCE,sBAAgBA,cAHuB;AAIvCD,oBAAcA,YAJyB;AAKvCE,wBAAkBgB,eAAehB,gBALM;AAMvCE,kBAAYc,eAAed,UANY;AAOvCC,6BAAuBa,eAAeb,qBAPC;AAQvCF,oBAAcA;AARyB,KAAX,CAA9B;AAUD,GApqkB2B,CAoqkB1B;;AAEF,WAASgB,oBAAT,CAA8BriE,IAA9B,EAAoCkhE,YAApC,EAAkDC,cAAlD,EAAkEc,YAAlE,EAAgFb,gBAAhF,EAAkG;AAChG,QAAI,CAACphE,IAAL,EAAW;AACT,aAAO;AACLohE,0BAAkBmB,0BAA0BnB,gBAA1B;AADb,OAAP;AAGD;;AAED,QAAIG,qBAAJ;AACA,QAAID,UAAJ;AACA,QAAIkB,iBAAJ;;AAEA,QAAItB,iBAAiBT,wBAArB,EAA+C;AAC7C;AACA;AACA;AACA;AACA,UAAIwB,iBAAiB,MAAjB,IAA2BA,gBAAgB,IAA/C,EAAqD;AACnDQ,6BAAqB,UAAU1gE,GAAV,EAAe;AAClC;AACA,cAAIA,OAAO,IAAP,IAAeA,QAAQ,GAA3B,EAAgC;AAC9B,gBAAIf,SAASe,GAAT,CAAJ,EAAmB;AACjBu/D,4BAAc,IAAd,KAAuBA,aAAa,CAApC;AACD,aAFD,MAEO;AACLA,2BAAa,CAAb;AACD;AACF,WARiC,CAQhC;AAEH,SAVD,EAUGH,cAVH,EAUmBnhE,IAVnB,EAUyB,EAVzB;AAWD,OAZD,MAYO;AACLshE,qBAAaW,eAAe,CAAf,GAAmB,CAAhC;AACD;;AAED,UAAI,CAACb,gBAAD,IAAqBE,eAAe,CAAxC,EAA2C;AACzCF,2BAAmB,EAAnB;AACAqB,6BAAqB,UAAU1gE,GAAV,EAAeq0B,KAAf,EAAsB;AACzCgrC,2BAAiBhrC,KAAjB,IAA0Br0B,OAAO,IAAP,GAAcA,GAAd,GAAoB,EAA9C;AACD,SAFD,EAEGo/D,cAFH,EAEmBnhE,IAFnB;AAGD;;AAEDuhE,8BAAwBH,mBAAmBA,iBAAiBrjE,MAApC,GAA6CojE,mBAAmBJ,oBAAnB,GAA0C/gE,KAAKjC,MAA/C,GAAwDiC,KAAK,CAAL,IAAUA,KAAK,CAAL,EAAQjC,MAAlB,GAA2B,IAAxJ;AACD,KA7BD,MA6BO,IAAImjE,iBAAiBR,yBAArB,EAAgD;AACrD,UAAI,CAACU,gBAAL,EAAuB;AACrBA,2BAAmBsB,4BAA4B1iE,IAA5B,CAAnB;AACAwiE,4BAAoB,IAApB;AACD;AACF,KALM,MAKA,IAAItB,iBAAiBP,2BAArB,EAAkD;AACvD,UAAI,CAACS,gBAAL,EAAuB;AACrBA,2BAAmB,EAAnB;AACAoB,4BAAoB,IAApB;AACAviE,eAAOD,IAAP,EAAa,UAAU2iE,MAAV,EAAkBvkE,GAAlB,EAAuB;AAClCgjE,2BAAiB/gE,IAAjB,CAAsBjC,GAAtB;AACD,SAFD;AAGD;AACF,KARM,MAQA,IAAI8iE,iBAAiBV,sBAArB,EAA6C;AAClD,UAAI/+D,SAASsrC,iBAAiB/sC,KAAK,CAAL,CAAjB,CAAb;AACAuhE,8BAAwB3iE,QAAQ6C,MAAR,KAAmBA,OAAO1D,MAA1B,IAAoC,CAA5D;AACD,KAHM,MAGA,IAAImjE,iBAAiBL,yBAArB,EAAgD,CAAE;;AAEzD,QAAI+B,qBAAJ;;AAEA,QAAIJ,iBAAJ,EAAuB;AACrBviE,aAAOmhE,gBAAP,EAAyB,UAAUyB,GAAV,EAAe/9C,GAAf,EAAoB;AAC3C,YAAI,CAACrmB,WAAWokE,GAAX,IAAkBA,IAAIzlE,IAAtB,GAA6BylE,GAA9B,MAAuC,MAA3C,EAAmD;AACjDD,kCAAwB99C,GAAxB;AACD;AACF,OAJD;AAKD;;AAED,WAAO;AACLw8C,kBAAYA,UADP;AAELF,wBAAkBmB,0BAA0BnB,gBAA1B,CAFb;AAGLG,6BAAuBA,qBAHlB;AAILqB,6BAAuBA,qBAJlB,CAIwC;;AAJxC,KAAP;AAOD,GAjvkB2B,CAivkB1B;AACF;AACA;;;AAGA,WAASL,yBAAT,CAAmCnB,gBAAnC,EAAqD;AACnD,QAAI,CAACA,gBAAL,EAAuB;AACrB;AACA;AACD;;AAED,QAAI0B,UAAU7/D,eAAd;AACA,WAAOlG,IAAIqkE,gBAAJ,EAAsB,UAAUxzB,IAAV,EAAgBxX,KAAhB,EAAuB;AAClDwX,aAAO5uC,OAAO,EAAP,EAAWP,WAAWmvC,IAAX,IAAmBA,IAAnB,GAA0B;AAC1CxwC,cAAMwwC;AADoC,OAArC,CAAP,CADkD,CAG9C;AACJ;AACA;;AAEA,UAAIA,KAAKxwC,IAAL,IAAa,IAAjB,EAAuB;AACrB,eAAOwwC,IAAP;AACD,OATiD,CAShD;;;AAGFA,WAAKxwC,IAAL,IAAa,EAAb,CAZkD,CAYjC;AACjB;AACA;AACA;AACA;;AAEA,UAAIwwC,KAAKm1B,WAAL,IAAoB,IAAxB,EAA8B;AAC5Bn1B,aAAKm1B,WAAL,GAAmBn1B,KAAKxwC,IAAxB;AACD;;AAED,UAAIiwC,QAAQy1B,QAAQ//D,GAAR,CAAY6qC,KAAKxwC,IAAjB,CAAZ;;AAEA,UAAI,CAACiwC,KAAL,EAAY;AACVy1B,gBAAQhgE,GAAR,CAAY8qC,KAAKxwC,IAAjB,EAAuB;AACrBskB,iBAAO;AADc,SAAvB;AAGD,OAJD,MAIO;AACLksB,aAAKxwC,IAAL,IAAa,MAAMiwC,MAAM3rB,KAAN,EAAnB;AACD;;AAED,aAAOksB,IAAP;AACD,KAjCM,CAAP;AAkCD;;AAED,WAAS60B,oBAAT,CAA8BtiE,EAA9B,EAAkCghE,cAAlC,EAAkDnhE,IAAlD,EAAwDgjE,OAAxD,EAAiE;AAC/DA,eAAW,IAAX,KAAoBA,UAAUrtB,QAA9B;;AAEA,QAAIwrB,mBAAmBJ,oBAAvB,EAA6C;AAC3C,WAAK,IAAIljE,IAAI,CAAb,EAAgBA,IAAImC,KAAKjC,MAAT,IAAmBF,IAAImlE,OAAvC,EAAgDnlE,GAAhD,EAAqD;AACnDsC,WAAGH,KAAKnC,CAAL,IAAUmC,KAAKnC,CAAL,EAAQ,CAAR,CAAV,GAAuB,IAA1B,EAAgCA,CAAhC;AACD;AACF,KAJD,MAIO;AACL,UAAI4D,SAASzB,KAAK,CAAL,KAAW,EAAxB;;AAEA,WAAK,IAAInC,IAAI,CAAb,EAAgBA,IAAI4D,OAAO1D,MAAX,IAAqBF,IAAImlE,OAAzC,EAAkDnlE,GAAlD,EAAuD;AACrDsC,WAAGsB,OAAO5D,CAAP,CAAH,EAAcA,CAAd;AACD;AACF;AACF;;AAED,WAAS6kE,2BAAT,CAAqC1iE,IAArC,EAA2C;AACzC,QAAIijE,aAAa,CAAjB;AACA,QAAI/iE,GAAJ;;AAEA,WAAO+iE,aAAajjE,KAAKjC,MAAlB,IAA4B,EAAEmC,MAAMF,KAAKijE,YAAL,CAAR,CAAnC,EAAgE,CAAE,CAJzB,CAI0B;;;AAGnE,QAAI/iE,GAAJ,EAAS;AACP,UAAIigE,aAAa,EAAjB;AACAlgE,aAAOC,GAAP,EAAY,UAAUZ,KAAV,EAAiBlB,GAAjB,EAAsB;AAChC+hE,mBAAW9/D,IAAX,CAAgBjC,GAAhB;AACD,OAFD;AAGA,aAAO+hE,UAAP;AACD;AACF,GA/zkB2B,CA+zkB1B;AACF;AACA;;;AAGA,WAASmC,iBAAT,CAA2B1D,WAA3B,EAAwC+C,YAAxC,EAAsD3hE,IAAtD,EAA4DkhE,YAA5D,EAA0EC,cAA1E,EAA0FiB,cAA1F,EAA0G;AACxG,QAAIc,iBAAiBvE,0BAA0BC,WAA1B,CAArB;AACA,QAAI7G,SAAS,EAAb,CAFwG,CAEvF;AACjB;;AAEA,QAAIoL,iBAAiB,EAArB;AACA,QAAIC,mBAAmB,EAAvB;AACA,QAAIC,aAAazE,YAAYvtB,OAA7B,CAPwG,CAOlE;AACtC;AACA;AACA;;AAEA,QAAIiyB,aAAargE,cAAc,CAAC,KAAD,EAAQ,KAAR,EAAe,QAAf,CAAd,CAAjB;AACA,QAAIsgE,aAAatgE,cAAc,CAAC,MAAD,EAAS,KAAT,EAAgB,cAAhB,EAAgC,SAAhC,EAA2C,eAA3C,EAA4D,aAA5D,EAA2E,SAA3E,CAAd,CAAjB,CAbwG,CAae;AACvH;AACA;;AAEA,QAAIigE,kBAAkBK,WAAWxgE,GAAX,CAAesgE,UAAf,KAA8B,IAApD,EAA0D;AACxD,UAAIx0B,UAAU+vB,YAAY/vB,OAA1B;AACA,UAAIizB,aAAaL,QAAQ5yB,OAAR,EAAiBizB,UAAlC;AACA,UAAI1jE,MAAMujE,aAAa3F,GAAb,GAAmB,GAAnB,GAAyBmF,cAAnC;AACA,UAAIqC,gBAAgB1B,WAAW/+D,GAAX,CAAe3E,GAAf,KAAuB0jE,WAAWh/D,GAAX,CAAe1E,GAAf,EAAoB;AAC7DqlE,wBAAgB,CAD6C;AAE7DC,qBAAa;AAFgD,OAApB,CAA3C,CAJwD,CAOpD;AACJ;;AAEAzjE,aAAOijE,eAAepE,YAAtB,EAAoC,UAAU6E,QAAV,EAAoB;AACtD;AACA,YAAIT,eAAe3D,qBAAf,IAAwC,IAA5C,EAAkD;AAChD,cAAIqE,UAAUJ,cAAcE,WAAd,EAAd;AACA3L,iBAAO4L,QAAP,IAAmBC,OAAnB,CAFgD,CAEpB;AAC5B;AACA;AACA;AACA;AACA;;AAEAR,2BAAiB/iE,IAAjB,CAAsBujE,OAAtB,EATgD,CAShB;AAChC;AACD,SAXD,CAWE;AAXF,aAYK,IAAIV,eAAelE,eAAf,CAA+Bj8D,GAA/B,CAAmC4gE,QAAnC,CAAJ,EAAkD;AACnD5L,mBAAO4L,QAAP,IAAmB,CAAnB;AACAR,2BAAe9iE,IAAf,CAAoB,CAApB;AACD,WAHE,CAGD;AAHC,eAIE;AACD,kBAAIujE,UAAUJ,cAAcC,cAAd,EAAd;AACA1L,qBAAO4L,QAAP,IAAmBC,OAAnB,CAFC,CAE2B;AAC5B;;AAEAR,+BAAiB/iE,IAAjB,CAAsBujE,OAAtB;AACD;AACN,OAzBD;AA0BD,KApCD,CAoCE;AACF;AACA;AAtCA,SAuCK,IAAIN,WAAWvgE,GAAX,CAAesgE,UAAf,KAA8B,IAAlC,EAAwC;AACzC;AACA,YAAIQ,eAAJ;;AAEA,aAAK,IAAIhmE,IAAI,CAAb,EAAgBA,IAAI,CAAJ,IAASgmE,mBAAmB,IAA5C,EAAkDhmE,GAAlD,EAAuD;AACrD,cAAI,CAACimE,eAAe9jE,IAAf,EAAqBkhE,YAArB,EAAmCC,cAAnC,EAAmDiB,eAAehB,gBAAlE,EAAoFgB,eAAed,UAAnG,EAA+GzjE,CAA/G,CAAL,EAAwH;AACtHgmE,8BAAkBhmE,CAAlB;AACD;AACF;;AAED,YAAIgmE,mBAAmB,IAAvB,EAA6B;AAC3B9L,iBAAOz4D,KAAP,GAAeukE,eAAf;AACA,cAAIE,eAAe3B,eAAeQ,qBAAf,IAAwCj+D,KAAKqB,GAAL,CAAS69D,kBAAkB,CAA3B,EAA8B,CAA9B,CAA3D,CAF2B,CAEkE;AAC7F;;AAEAT,2BAAiB/iE,IAAjB,CAAsB0jE,YAAtB;AACAZ,yBAAe9iE,IAAf,CAAoB0jE,YAApB,EAN2B,CAMQ;AACpC;AACF,OA1EqG,CA0EpG;AACJ;;;AAGAZ,mBAAeplE,MAAf,KAA0Bg6D,OAAOiM,QAAP,GAAkBb,cAA5C;AACAC,qBAAiBrlE,MAAjB,KAA4Bg6D,OAAOkM,UAAP,GAAoBb,gBAAhD;AACA,WAAOrL,MAAP;AACD;AACD;;;;AAKA,WAASmK,eAAT,CAAyBtD,WAAzB,EAAsC;AACpC,QAAIrxB,SAASqxB,YAAYrxB,MAAzB,CADoC,CACH;AACjC;AACA;AACA;AACA;;AAEA,QAAI22B,WAAW32B,OAAOvtC,IAAtB;;AAEA,QAAI,CAACkkE,QAAL,EAAe;AACb,aAAOtF,YAAY/vB,OAAZ,CAAoBqxB,YAApB,CAAiC,SAAjC,EAA4C3yB,OAAO42B,YAAP,IAAuB,CAAnE,CAAP;AACD;AACF;AACD;;;;;;;;;;AAWA,WAASC,YAAT,CAAsB5mE,MAAtB,EAA8B6mE,QAA9B,EAAwC;AACtC,WAAOP,eAAetmE,OAAOwC,IAAtB,EAA4BxC,OAAO0jE,YAAnC,EAAiD1jE,OAAO2jE,cAAxD,EAAwE3jE,OAAO4jE,gBAA/E,EAAiG5jE,OAAO8jE,UAAxG,EAAoH+C,QAApH,CAAP;AACD,GAr7kB2B,CAq7kB1B;;AAEF,WAASP,cAAT,CAAwB9jE,IAAxB,EAA8BkhE,YAA9B,EAA4CC,cAA5C,EAA4DC,gBAA5D,EAA8EE,UAA9E,EAA0F+C,QAA1F,EAAoG;AAClG,QAAI5mE,MAAJ,CADkG,CACtF;;AAEZ,QAAIulE,UAAU,CAAd;;AAEA,QAAI9hE,aAAalB,IAAb,CAAJ,EAAwB;AACtB,aAAO,KAAP;AACD,KAPiG,CAOhG;AACF;;;AAGA,QAAIskE,OAAJ;;AAEA,QAAIlD,gBAAJ,EAAsB;AACpBkD,gBAAUlD,iBAAiBiD,QAAjB,CAAV;AACAC,gBAAU7lE,WAAW6lE,OAAX,IAAsBA,QAAQlnE,IAA9B,GAAqCknE,OAA/C;AACD;;AAED,QAAIpD,iBAAiBT,wBAArB,EAA+C;AAC7C,UAAIU,mBAAmBJ,oBAAvB,EAA6C;AAC3C,YAAIwD,SAASvkE,KAAKqkE,QAAL,CAAb;;AAEA,aAAK,IAAIxmE,IAAI,CAAb,EAAgBA,IAAI,CAAC0mE,UAAU,EAAX,EAAexmE,MAAnB,IAA6BF,IAAImlE,OAAjD,EAA0DnlE,GAA1D,EAA+D;AAC7D,cAAI,CAACJ,SAAS+mE,YAAYD,OAAOjD,aAAazjE,CAApB,CAAZ,CAAV,KAAkD,IAAtD,EAA4D;AAC1D,mBAAOJ,MAAP;AACD;AACF;AACF,OARD,MAQO;AACL,aAAK,IAAII,IAAI,CAAb,EAAgBA,IAAImC,KAAKjC,MAAT,IAAmBF,IAAImlE,OAAvC,EAAgDnlE,GAAhD,EAAqD;AACnD,cAAI4mE,MAAMzkE,KAAKshE,aAAazjE,CAAlB,CAAV;;AAEA,cAAI4mE,OAAO,CAAChnE,SAAS+mE,YAAYC,IAAIJ,QAAJ,CAAZ,CAAV,KAAyC,IAApD,EAA0D;AACxD,mBAAO5mE,MAAP;AACD;AACF;AACF;AACF,KAlBD,MAkBO,IAAIyjE,iBAAiBR,yBAArB,EAAgD;AACrD,UAAI,CAAC4D,OAAL,EAAc;AACZ;AACD;;AAED,WAAK,IAAIzmE,IAAI,CAAb,EAAgBA,IAAImC,KAAKjC,MAAT,IAAmBF,IAAImlE,OAAvC,EAAgDnlE,GAAhD,EAAqD;AACnD,YAAI+vC,OAAO5tC,KAAKnC,CAAL,CAAX;;AAEA,YAAI+vC,QAAQ,CAACnwC,SAAS+mE,YAAY52B,KAAK02B,OAAL,CAAZ,CAAV,KAAyC,IAArD,EAA2D;AACzD,iBAAO7mE,MAAP;AACD;AACF;AACF,KAZM,MAYA,IAAIyjE,iBAAiBP,2BAArB,EAAkD;AACvD,UAAI,CAAC2D,OAAL,EAAc;AACZ;AACD;;AAED,UAAIC,SAASvkE,KAAKskE,OAAL,CAAb;;AAEA,UAAI,CAACC,MAAD,IAAWrjE,aAAaqjE,MAAb,CAAf,EAAqC;AACnC,eAAO,KAAP;AACD;;AAED,WAAK,IAAI1mE,IAAI,CAAb,EAAgBA,IAAI0mE,OAAOxmE,MAAX,IAAqBF,IAAImlE,OAAzC,EAAkDnlE,GAAlD,EAAuD;AACrD,YAAI,CAACJ,SAAS+mE,YAAYD,OAAO1mE,CAAP,CAAZ,CAAV,KAAqC,IAAzC,EAA+C;AAC7C,iBAAOJ,MAAP;AACD;AACF;AACF,KAhBM,MAgBA,IAAIyjE,iBAAiBV,sBAArB,EAA6C;AAClD,WAAK,IAAI3iE,IAAI,CAAb,EAAgBA,IAAImC,KAAKjC,MAAT,IAAmBF,IAAImlE,OAAvC,EAAgDnlE,GAAhD,EAAqD;AACnD,YAAI+vC,OAAO5tC,KAAKnC,CAAL,CAAX;AACA,YAAIkE,MAAMgrC,iBAAiBa,IAAjB,CAAV;;AAEA,YAAI,CAAChvC,QAAQmD,GAAR,CAAL,EAAmB;AACjB,iBAAO,KAAP;AACD;;AAED,YAAI,CAACtE,SAAS+mE,YAAYziE,IAAIsiE,QAAJ,CAAZ,CAAV,KAAyC,IAA7C,EAAmD;AACjD,iBAAO5mE,MAAP;AACD;AACF;AACF;;AAED,aAAS+mE,WAAT,CAAqBziE,GAArB,EAA0B;AACxB;AACA;AACA,UAAIA,OAAO,IAAP,IAAesmC,SAAStmC,GAAT,CAAf,IAAgCA,QAAQ,EAA5C,EAAgD;AAC9C,eAAO,KAAP;AACD,OAFD,MAEO,IAAIf,SAASe,GAAT,KAAiBA,QAAQ,GAA7B,EAAkC;AACvC,eAAO,IAAP;AACD;AACF;;AAED,WAAO,KAAP;AACD;;AAED;;;;;;;;;;;;;;;;;;;AAmBA;;;;;;AAMA;;;;;;;;;;;;AAYA,MAAI2iE,mBAAmB,aAAvB;AACA;;;;;;;;AAQA,MAAIC,cAAcrU,MAAMtxD,MAAN,CAAa;AAC7BmtC,UAAM,cAAUoB,MAAV,EAAkBsf,WAAlB,EAA+B+X,KAA/B,EAAsCC,aAAtC,EAAqD;AACzDD,cAAQA,SAAS,EAAjB;AACA,WAAKr3B,MAAL,GAAc,IAAd,CAFyD,CAErC;;AAEpB;;;;;AAKA,WAAKu3B,MAAL,GAAc,IAAIxU,KAAJ,CAAUsU,KAAV,CAAd;AACA;;;;AAIA,WAAKG,cAAL,GAAsBF,aAAtB;AACD,KAhB4B;AAiB7BG,eAAW,mBAAUz3B,MAAV,EAAkB03B,uBAAlB,EAA2C;AACpDjjE,eAAS,EAAE0iE,oBAAoBn3B,MAAtB,CAAT,EAAwC,8BAAxC;;AAEA,WAAKw3B,cAAL,CAAoBC,SAApB,CAA8Bz3B,MAA9B,EAAsC03B,uBAAtC;;AAEA,WAAKC,WAAL,CAAiB,IAAjB;AACD,KAvB4B;;AAyB7B;;;;;;;AAOAA,iBAAa,qBAAUjkE,IAAV,EAAgB;AAC3B,UAAIkkE,gBAAgB,KAApB;AACA,UAAIN,gBAAgB,KAAKE,cAAzB;;AAEA,UAAI,CAAC9jE,IAAD,IAASA,SAAS,UAAtB,EAAkC;AAChC,YAAImkE,aAAaP,cAAcQ,WAAd,CAA0BpkE,SAAS,UAAnC,CAAjB;;AAEA,YAAI,CAAC,KAAKssC,MAAN,IAAgBtsC,SAAS,UAA7B,EAAyC;AACvCqkE,mBAAS3nE,IAAT,CAAc,IAAd,EAAoBynE,UAApB;AACD,SAFD,MAEO;AACL,eAAKtU,WAAL;AACA,eAAKP,WAAL,CAAiB6U,UAAjB;AACD;;AAEDD,wBAAgB,IAAhB;AACD;;AAED,UAAIlkE,SAAS,UAAT,IAAuBA,SAAS,OAApC,EAA6C;AAC3C,aAAK6vD,WAAL;AACD;;AAED,UAAI,CAAC7vD,IAAD,IAASA,SAAS,UAAlB,IAAgCA,SAAS,UAA7C,EAAyD;AACvD,YAAIskE,iBAAiBV,cAAcW,iBAAd,CAAgC,IAAhC,CAArB;AACAD,2BAAmB,KAAKhV,WAAL,CAAiBgV,cAAjB,GAAkCJ,gBAAgB,IAArE;AACD;;AAED,UAAI,CAAClkE,IAAD,IAASA,SAAS,UAAlB,IAAgCA,SAAS,OAA7C,EAAsD;AACpD,YAAIwkE,eAAeZ,cAAca,cAAd,CAA6B,IAA7B,EAAmC,KAAKC,IAAxC,CAAnB;;AAEA,YAAIF,aAAa1nE,MAAjB,EAAyB;AACvBkC,iBAAOwlE,YAAP,EAAqB,UAAUG,WAAV,EAAuB;AAC1C,iBAAKrV,WAAL,CAAiBqV,WAAjB,EAA8BT,gBAAgB,IAA9C;AACD,WAFD,EAEG,IAFH;AAGD;AACF;;AAED,aAAOA,aAAP;AACD,KArE4B;;AAuE7B;;;AAGA5U,iBAAa,qBAAUkK,SAAV,EAAqB;AAChC,UAAIltB,SAAS,KAAKA,MAAlB;AACA,UAAIs4B,gBAAgB,KAAKC,cAAzB;AACA,UAAIC,cAAc,EAAlB;AACAlE,2BAAqB,IAArB,EAJgC,CAIJ;AAC5B;;AAEA5hE,aAAOw6D,SAAP,EAAkB,UAAUuL,eAAV,EAA2B92B,QAA3B,EAAqC;AACrD,YAAI82B,mBAAmB,IAAvB,EAA6B;AAC3B;AACD;;AAED,YAAI,CAACpK,eAAenqB,QAAf,CAAwBvC,QAAxB,CAAL,EAAwC;AACtC;AACA3B,iBAAO2B,QAAP,IAAmB3B,OAAO2B,QAAP,KAAoB,IAApB,GAA2B3xC,OAAMyoE,eAAN,CAA3B,GAAoD1nE,MAAMivC,OAAO2B,QAAP,CAAN,EAAwB82B,eAAxB,EAAyC,IAAzC,CAAvE;AACD,SAHD,MAGO,IAAI92B,QAAJ,EAAc;AACnB62B,sBAAY1lE,IAAZ,CAAiB6uC,QAAjB;AACD;AACF,OAXD;AAYA0sB,qBAAe/J,iBAAf,CAAiCkU,WAAjC,EAA8CnK,eAAelqB,oBAAf,EAA9C,EAAqFu0B,cAArF,EAAqG,IAArG;;AAEA,eAASA,cAAT,CAAwB/2B,QAAxB,EAAkC+tB,YAAlC,EAAgD;AAC9C,YAAIiJ,mBAAmB15B,iBAAiBiuB,UAAUvrB,QAAV,CAAjB,CAAvB;AACA,YAAIxB,YAAYR,gBAAgB24B,cAAc9iE,GAAd,CAAkBmsC,QAAlB,CAAhB,EAA6Cg3B,gBAA7C,CAAhB;AACAz4B,sBAAcC,SAAd,EAH8C,CAGpB;;AAE1BztC,eAAOytC,SAAP,EAAkB,UAAUE,IAAV,EAAgBxX,KAAhB,EAAuB;AACvC,cAAIsW,MAAMkB,KAAKL,MAAf;;AAEA,cAAI9uC,WAAWiuC,GAAX,CAAJ,EAAqB;AACnBkB,iBAAKE,OAAL,CAAaoB,QAAb,GAAwBA,QAAxB;AACAtB,iBAAKE,OAAL,CAAauD,OAAb,GAAuBogB,iBAAiBviB,QAAjB,EAA2BxC,GAA3B,EAAgCkB,KAAKP,KAArC,CAAvB;AACD;AACF,SAPD;AAQA,YAAI0uB,kBAAkBoK,qBAAqBN,aAArB,EAAoC5I,YAApC,CAAtB;AACA1vB,eAAO2B,QAAP,IAAmB,EAAnB;AACA22B,sBAAc/iE,GAAd,CAAkBosC,QAAlB,EAA4B,EAA5B;AACAjvC,eAAOytC,SAAP,EAAkB,UAAU04B,UAAV,EAAsBhwC,KAAtB,EAA6B;AAC7C,cAAI6X,iBAAiBm4B,WAAW/4B,KAAhC;AACA,cAAIovB,eAAe2J,WAAW74B,MAA9B;AACAvrC,mBAASvD,WAAWg+D,YAAX,KAA4BxuB,cAArC,EAAqD,4BAArD,EAH6C,CAGuC;AACpF;AACA;;AAEA,cAAI,CAACwuB,YAAL,EAAmB;AACjBxuB,2BAAesiB,WAAf,CAA2B,EAA3B,EAA+B,IAA/B;AACAtiB,2BAAeuuB,aAAf,CAA6B,EAA7B,EAAiC,KAAjC;AACD,WAHD,MAGO;AACL,gBAAI6J,sBAAsBzK,eAAezqB,QAAf,CAAwBjC,QAAxB,EAAkCk3B,WAAWt4B,OAAX,CAAmBuD,OAArD,EAA8D,IAA9D,CAA1B;;AAEA,gBAAIpD,kBAAkBA,0BAA0Bo4B,mBAAhD,EAAqE;AACnEp4B,6BAAe7wC,IAAf,GAAsBgpE,WAAWt4B,OAAX,CAAmB1wC,IAAzC,CADmE,CACpB;;AAE/C6wC,6BAAesiB,WAAf,CAA2BkM,YAA3B,EAAyC,IAAzC;AACAxuB,6BAAeuuB,aAAf,CAA6BC,YAA7B,EAA2C,KAA3C;AACD,aALD,MAKO;AACL;AACA,kBAAIP,WAAWl9D,OAAO;AACpB+8D,iCAAiBA,eADG;AAEpBF,gCAAgBzlC;AAFI,eAAP,EAGZgwC,WAAWt4B,OAHC,CAAf;AAIAG,+BAAiB,IAAIo4B,mBAAJ,CAAwB5J,YAAxB,EAAsC,IAAtC,EAA4C,IAA5C,EAAkDP,QAAlD,CAAjB;AACAl9D,qBAAOivC,cAAP,EAAuBiuB,QAAvB;AACAjuB,6BAAe9B,IAAf,CAAoBswB,YAApB,EAAkC,IAAlC,EAAwC,IAAxC,EAA8CP,QAA9C,EARK,CAQoD;AACzD;AACA;AACA;;AAEAjuB,6BAAeuuB,aAAf,CAA6B,IAA7B,EAAmC,IAAnC;AACD;AACF;;AAEDqJ,wBAAc9iE,GAAd,CAAkBmsC,QAAlB,EAA4B9Y,KAA5B,IAAqC6X,cAArC;AACAV,iBAAO2B,QAAP,EAAiB9Y,KAAjB,IAA0B6X,eAAeV,MAAzC;AACD,SArCD,EAqCG,IArCH,EAhB8C,CAqDpC;;AAEV,YAAI2B,aAAa,QAAjB,EAA2B;AACzBo3B,8BAAoB,IAApB,EAA0BT,cAAc9iE,GAAd,CAAkB,QAAlB,CAA1B;AACD;AACF;;AAED,WAAKwjE,iBAAL,GAAyBtjE,cAAc,KAAKujE,cAAL,GAAsB,KAAKA,cAAL,IAAuB,EAA3D,CAAzB;AACD,KA5J4B;;AA8J7B;;;;;AAKAC,eAAW,qBAAY;AACrB,UAAIl5B,SAAShwC,OAAM,KAAKgwC,MAAX,CAAb;AACAttC,aAAOstC,MAAP,EAAe,UAAUn+B,IAAV,EAAgB8/B,QAAhB,EAA0B;AACvC,YAAI0sB,eAAenqB,QAAf,CAAwBvC,QAAxB,CAAJ,EAAuC;AACrC,cAAI9/B,OAAOo9B,iBAAiBp9B,IAAjB,CAAX;;AAEA,eAAK,IAAIvR,IAAIuR,KAAKrR,MAAL,GAAc,CAA3B,EAA8BF,KAAK,CAAnC,EAAsCA,GAAtC,EAA2C;AACzC;AACA,gBAAI2vC,UAAUp+B,KAAKvR,CAAL,CAAV,CAAJ,EAAwB;AACtBuR,mBAAK3G,MAAL,CAAY5K,CAAZ,EAAe,CAAf;AACD;AACF;;AAED0vC,iBAAO2B,QAAP,IAAmB9/B,IAAnB;AACD;AACF,OAbD;AAcA,aAAOm+B,OAAOm3B,gBAAP,CAAP;AACA,aAAOn3B,MAAP;AACD,KArL4B;;AAuL7B;;;AAGA+uB,cAAU,oBAAY;AACpB,aAAO,KAAKwI,MAAZ;AACD,KA5L4B;;AA8L7B;;;;;AAKA5E,kBAAc,sBAAUhxB,QAAV,EAAoBpqB,GAApB,EAAyB;AACrC,UAAI3Y,OAAO,KAAK25D,cAAL,CAAoB/iE,GAApB,CAAwBmsC,QAAxB,CAAX;;AAEA,UAAI/iC,IAAJ,EAAU;AACR,eAAOA,KAAK2Y,OAAO,CAAZ,CAAP;AACD;AACF,KAzM4B;;AA2M7B;;;;;;;;;;AAUAyqB,qBAAiB,yBAAUttC,SAAV,EAAqB;AACpC,UAAIitC,WAAWjtC,UAAUitC,QAAzB;;AAEA,UAAI,CAACA,QAAL,EAAe;AACb,eAAO,EAAP;AACD;;AAED,UAAI9Y,QAAQn0B,UAAUm0B,KAAtB;AACA,UAAIhV,KAAKnf,UAAUmf,EAAnB;AACA,UAAIhkB,OAAO6E,UAAU7E,IAArB;;AAEA,UAAIspE,OAAO,KAAKZ,cAAL,CAAoB/iE,GAApB,CAAwBmsC,QAAxB,CAAX;;AAEA,UAAI,CAACw3B,IAAD,IAAS,CAACA,KAAK3oE,MAAnB,EAA2B;AACzB,eAAO,EAAP;AACD;;AAED,UAAIN,MAAJ;;AAEA,UAAI24B,SAAS,IAAb,EAAmB;AACjB,YAAI,CAACx3B,QAAQw3B,KAAR,CAAL,EAAqB;AACnBA,kBAAQ,CAACA,KAAD,CAAR;AACD;;AAED34B,iBAASd,OAAOI,IAAIq5B,KAAJ,EAAW,UAAUtR,GAAV,EAAe;AACxC,iBAAO4hD,KAAK5hD,GAAL,CAAP;AACD,SAFe,CAAP,EAEL,UAAU/iB,GAAV,EAAe;AACjB,iBAAO,CAAC,CAACA,GAAT;AACD,SAJQ,CAAT;AAKD,OAVD,MAUO,IAAIqf,MAAM,IAAV,EAAgB;AACrB,YAAIulD,YAAY/nE,QAAQwiB,EAAR,CAAhB;AACA3jB,iBAASd,OAAO+pE,IAAP,EAAa,UAAUE,GAAV,EAAe;AACnC,iBAAOD,aAAavnE,QAAQgiB,EAAR,EAAYwlD,IAAIxlD,EAAhB,KAAuB,CAApC,IAAyC,CAACulD,SAAD,IAAcC,IAAIxlD,EAAJ,KAAWA,EAAzE;AACD,SAFQ,CAAT;AAGD,OALM,MAKA,IAAIhkB,QAAQ,IAAZ,EAAkB;AACvB,YAAIypE,cAAcjoE,QAAQxB,IAAR,CAAlB;AACAK,iBAASd,OAAO+pE,IAAP,EAAa,UAAUE,GAAV,EAAe;AACnC,iBAAOC,eAAeznE,QAAQhC,IAAR,EAAcwpE,IAAIxpE,IAAlB,KAA2B,CAA1C,IAA+C,CAACypE,WAAD,IAAgBD,IAAIxpE,IAAJ,KAAaA,IAAnF;AACD,SAFQ,CAAT;AAGD,OALM,MAKA;AACL;AACAK,iBAASipE,KAAK7pE,KAAL,EAAT;AACD;;AAED,aAAOiqE,gBAAgBrpE,MAAhB,EAAwBwE,SAAxB,CAAP;AACD,KAlQ4B;;AAoQ7B;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4BA8kE,oBAAgB,wBAAU9kE,SAAV,EAAqB;AACnC,UAAI+kE,QAAQ/kE,UAAU+kE,KAAtB;AACA,UAAI93B,WAAWjtC,UAAUitC,QAAzB;AACA,UAAI+3B,YAAYC,aAAaF,KAAb,CAAhB;AACA,UAAIvpE,SAASwpE,YAAY,KAAK13B,eAAL,CAAqB03B,SAArB,CAAZ,GAA8C,KAAKnB,cAAL,CAAoB/iE,GAApB,CAAwBmsC,QAAxB,CAA3D;AACA,aAAOi4B,SAASL,gBAAgBrpE,MAAhB,EAAwBwE,SAAxB,CAAT,CAAP;;AAEA,eAASilE,YAAT,CAAsBE,CAAtB,EAAyB;AACvB,YAAIC,YAAYn4B,WAAW,OAA3B;AACA,YAAIo4B,SAASp4B,WAAW,IAAxB;AACA,YAAIq4B,WAAWr4B,WAAW,MAA1B;AACA,eAAOk4B,MAAMA,EAAEC,SAAF,KAAgB,IAAhB,IAAwBD,EAAEE,MAAF,KAAa,IAArC,IAA6CF,EAAEG,QAAF,KAAe,IAAlE,IAA0E;AAC/Er4B,oBAAUA,QADqE;AAE/E;AACA9Y,iBAAOgxC,EAAEC,SAAF,CAHwE;AAI/EjmD,cAAIgmD,EAAEE,MAAF,CAJ2E;AAK/ElqE,gBAAMgqE,EAAEG,QAAF;AALyE,SAA1E,GAMH,IANJ;AAOD;;AAED,eAASJ,QAAT,CAAkB/rC,GAAlB,EAAuB;AACrB,eAAOn5B,UAAUtF,MAAV,GAAmBA,OAAOy+B,GAAP,EAAYn5B,UAAUtF,MAAtB,CAAnB,GAAmDy+B,GAA1D;AACD;AACF,KAvT4B;;AAyT7B;;;;;;;;;;;;;;;;;;;;;;;AAuBAosC,mBAAe,uBAAUt4B,QAAV,EAAoB/uC,EAApB,EAAwBC,OAAxB,EAAiC;AAC9C,UAAIylE,gBAAgB,KAAKC,cAAzB;;AAEA,UAAI,OAAO52B,QAAP,KAAoB,UAAxB,EAAoC;AAClC9uC,kBAAUD,EAAV;AACAA,aAAK+uC,QAAL;AACA22B,sBAAcjjE,IAAd,CAAmB,UAAU6kE,UAAV,EAAsB73B,aAAtB,EAAqC;AACtD3vC,iBAAOwnE,UAAP,EAAmB,UAAUC,SAAV,EAAqBtxC,KAArB,EAA4B;AAC7Cj2B,eAAGxC,IAAH,CAAQyC,OAAR,EAAiBwvC,aAAjB,EAAgC83B,SAAhC,EAA2CtxC,KAA3C;AACD,WAFD;AAGD,SAJD;AAKD,OARD,MAQO,IAAIp1B,SAASkuC,QAAT,CAAJ,EAAwB;AAC7BjvC,eAAO4lE,cAAc9iE,GAAd,CAAkBmsC,QAAlB,CAAP,EAAoC/uC,EAApC,EAAwCC,OAAxC;AACD,OAFM,MAEA,IAAI3B,WAAWywC,QAAX,CAAJ,EAA0B;AAC/B,YAAIy4B,cAAc,KAAKZ,cAAL,CAAoB73B,QAApB,CAAlB;AACAjvC,eAAO0nE,WAAP,EAAoBxnE,EAApB,EAAwBC,OAAxB;AACD;AACF,KAjW4B;;AAmW7B;;;;AAIAwnE,qBAAiB,yBAAUxqE,IAAV,EAAgB;AAC/B,UAAIyqE,SAAS,KAAK/B,cAAL,CAAoB/iE,GAApB,CAAwB,QAAxB,CAAb;;AAEA,aAAOpG,OAAOkrE,MAAP,EAAe,UAAUC,SAAV,EAAqB;AACzC,eAAOA,UAAU1qE,IAAV,KAAmBA,IAA1B;AACD,OAFM,CAAP;AAGD,KA7W4B;;AA+W7B;;;;AAIA2qE,sBAAkB,0BAAUC,WAAV,EAAuB;AACvC,aAAO,KAAKlC,cAAL,CAAoB/iE,GAApB,CAAwB,QAAxB,EAAkCilE,WAAlC,CAAP;AACD,KArX4B;;AAuX7B;;;;;;;AAOAC,qBAAiB,yBAAU52B,OAAV,EAAmB;AAClC,UAAIw2B,SAAS,KAAK/B,cAAL,CAAoB/iE,GAApB,CAAwB,QAAxB,CAAb;;AAEA,aAAOpG,OAAOkrE,MAAP,EAAe,UAAUC,SAAV,EAAqB;AACzC,eAAOA,UAAUz2B,OAAV,KAAsBA,OAA7B;AACD,OAFM,CAAP;AAGD,KApY4B;;AAsY7B;;;AAGA62B,eAAW,qBAAY;AACrB,aAAO,KAAKpC,cAAL,CAAoB/iE,GAApB,CAAwB,QAAxB,EAAkClG,KAAlC,EAAP;AACD,KA3Y4B;;AA6Y7B;;;AAGAsrE,oBAAgB,0BAAY;AAC1B,aAAO,KAAKrC,cAAL,CAAoB/iE,GAApB,CAAwB,QAAxB,EAAkChF,MAAzC;AACD,KAlZ4B;;AAoZ7B;;;;;;;AAOAqqE,gBAAY,oBAAUjoE,EAAV,EAAcC,OAAd,EAAuB;AACjCH,aAAO,KAAKumE,cAAZ,EAA4B,UAAU6B,cAAV,EAA0B;AACpD,YAAIR,SAAS,KAAK/B,cAAL,CAAoB/iE,GAApB,CAAwB,QAAxB,EAAkCslE,cAAlC,CAAb;;AAEAloE,WAAGxC,IAAH,CAAQyC,OAAR,EAAiBynE,MAAjB,EAAyBQ,cAAzB;AACD,OAJD,EAIG,IAJH;AAKD,KAja4B;;AAma7B;;;;;;AAMAC,mBAAe,uBAAUnoE,EAAV,EAAcC,OAAd,EAAuB;AACpCH,aAAO,KAAK6lE,cAAL,CAAoB/iE,GAApB,CAAwB,QAAxB,CAAP,EAA0C5C,EAA1C,EAA8CC,OAA9C;AACD,KA3a4B;;AA6a7B;;;;;;;;AAQAmoE,sBAAkB,0BAAUl3B,OAAV,EAAmBlxC,EAAnB,EAAuBC,OAAvB,EAAgC;AAChDH,aAAO,KAAKumE,cAAZ,EAA4B,UAAU6B,cAAV,EAA0B;AACpD,YAAIR,SAAS,KAAK/B,cAAL,CAAoB/iE,GAApB,CAAwB,QAAxB,EAAkCslE,cAAlC,CAAb;;AAEA,YAAIR,OAAOx2B,OAAP,KAAmBA,OAAvB,EAAgC;AAC9BlxC,aAAGxC,IAAH,CAAQyC,OAAR,EAAiBynE,MAAjB,EAAyBQ,cAAzB;AACD;AACF,OAND,EAMG,IANH;AAOD,KA7b4B;;AA+b7B;;;;;;;AAOAG,yBAAqB,6BAAUn3B,OAAV,EAAmBlxC,EAAnB,EAAuBC,OAAvB,EAAgC;AACnD,aAAOH,OAAO,KAAKgoE,eAAL,CAAqB52B,OAArB,CAAP,EAAsClxC,EAAtC,EAA0CC,OAA1C,CAAP;AACD,KAxc4B;;AA0c7B;;;AAGAqoE,sBAAkB,0BAAU7J,WAAV,EAAuB;AACvC,aAAO,KAAK2H,iBAAL,CAAuBxjE,GAAvB,CAA2B67D,YAAY/C,cAAvC,KAA0D,IAAjE;AACD,KA/c4B;;AAid7B;;;AAGA6M,6BAAyB,mCAAY;AACnC,aAAO,CAAC,KAAKlC,cAAL,IAAuB,EAAxB,EAA4B3pE,KAA5B,EAAP;AACD,KAtd4B;;AAwd7B;;;;AAIA8rE,kBAAc,sBAAUxoE,EAAV,EAAcC,OAAd,EAAuB;AACnC,UAAIwoE,iBAAiBjsE,OAAO,KAAKmpE,cAAL,CAAoB/iE,GAApB,CAAwB,QAAxB,CAAP,EAA0C5C,EAA1C,EAA8CC,OAA9C,CAArB;AACAkmE,0BAAoB,IAApB,EAA0BsC,cAA1B;AACD,KA/d4B;AAge7B9X,iBAAa,qBAAU3iB,OAAV,EAAmB;AAC9B,UAAI03B,gBAAgB,KAAKC,cAAzB;AACAQ,0BAAoB,IAApB,EAA0BT,cAAc9iE,GAAd,CAAkB,QAAlB,CAA1B;AACA,UAAI8lE,iBAAiB,EAArB;AACAhD,oBAAcjjE,IAAd,CAAmB,UAAU6kE,UAAV,EAAsB73B,aAAtB,EAAqC;AACtDi5B,uBAAexoE,IAAf,CAAoBuvC,aAApB;AACD,OAFD;AAGAgsB,qBAAe/J,iBAAf,CAAiCgX,cAAjC,EAAiDjN,eAAelqB,oBAAf,EAAjD,EAAwF,UAAU9B,aAAV,EAAyBqtB,YAAzB,EAAuC;AAC7Hh9D,eAAO4lE,cAAc9iE,GAAd,CAAkB6sC,aAAlB,CAAP,EAAyC,UAAU83B,SAAV,EAAqB;AAC5D,WAAC93B,kBAAkB,QAAlB,IAA8B,CAACk5B,kBAAkBpB,SAAlB,EAA6Bv5B,OAA7B,CAAhC,KAA0Eu5B,UAAU5W,WAAV,EAA1E;AACD,SAFD;AAGD,OAJD;AAKD;AA5e4B,GAAb,CAAlB;;AA+eA,WAASgY,iBAAT,CAA2BlK,WAA3B,EAAwCzwB,OAAxC,EAAiD;AAC/C,QAAIA,OAAJ,EAAa;AACX,UAAI/X,QAAQ+X,QAAQ46B,WAApB;AACA,UAAI3nD,KAAK+sB,QAAQ66B,QAAjB;AACA,UAAI5rE,OAAO+wC,QAAQ81B,UAAnB;AACA,aAAO7tC,SAAS,IAAT,IAAiBwoC,YAAY/C,cAAZ,KAA+BzlC,KAAhD,IAAyDhV,MAAM,IAAN,IAAcw9C,YAAYx9C,EAAZ,KAAmBA,EAA1F,IAAgGhkB,QAAQ,IAAR,IAAgBwhE,YAAYxhE,IAAZ,KAAqBA,IAA5I;AACD;AACF;AACD;;;;AAKA,WAAS6rE,UAAT,CAAoB17B,MAApB,EAA4Bq3B,KAA5B,EAAmC;AACjC;AACA;AACA,QAAIsE,qBAAqB37B,OAAO9zB,KAAP,IAAgB,CAAC8zB,OAAO47B,UAAjD;AACAlpE,WAAO2kE,KAAP,EAAc,UAAUwE,SAAV,EAAqBhsE,IAArB,EAA2B;AACvC,UAAIA,SAAS,YAAT,IAAyB8rE,kBAA7B,EAAiD;AAC/C;AACD,OAHsC,CAGrC;;;AAGF,UAAI,CAACtN,eAAenqB,QAAf,CAAwBr0C,IAAxB,CAAL,EAAoC;AAClC,YAAI,QAAOgsE,SAAP,yCAAOA,SAAP,OAAqB,QAAzB,EAAmC;AACjC77B,iBAAOnwC,IAAP,IAAe,CAACmwC,OAAOnwC,IAAP,CAAD,GAAgBG,OAAM6rE,SAAN,CAAhB,GAAmC9qE,MAAMivC,OAAOnwC,IAAP,CAAN,EAAoBgsE,SAApB,EAA+B,KAA/B,CAAlD;AACD,SAFD,MAEO;AACL,cAAI77B,OAAOnwC,IAAP,KAAgB,IAApB,EAA0B;AACxBmwC,mBAAOnwC,IAAP,IAAegsE,SAAf;AACD;AACF;AACF;AACF,KAfD;AAgBD;;AAED,WAAS9D,QAAT,CAAkBF,UAAlB,EAA8B;AAC5BA,iBAAaA,UAAb,CAD4B,CACH;AACzB;;AAEA,SAAK73B,MAAL,GAAc,EAAd;AACA,SAAKA,MAAL,CAAYm3B,gBAAZ,IAAgC,CAAhC;AACA;;;;;;;AAOA,SAAKoB,cAAL,GAAsB7iE,cAAc;AAClC4kE,cAAQ;AAD0B,KAAd,CAAtB;AAGA;;;;;;;AAOA,SAAKrB,cAAL;AACA,SAAKD,iBAAL;AACA0C,eAAW7D,UAAX,EAAuB,KAAKN,MAAL,CAAYv3B,MAAnC,EAzB4B,CAyBgB;;AAE5CjvC,UAAM8mE,UAAN,EAAkBhI,aAAlB,EAAiC,KAAjC;AACA,SAAK7M,WAAL,CAAiB6U,UAAjB;AACD;AACD;;;;;;AAOA,WAASe,oBAAT,CAA8BN,aAA9B,EAA6Cl0B,KAA7C,EAAoD;AAClD,QAAI,CAAC/yC,QAAQ+yC,KAAR,CAAL,EAAqB;AACnBA,cAAQA,QAAQ,CAACA,KAAD,CAAR,GAAkB,EAA1B;AACD;;AAED,QAAIj1B,MAAM,EAAV;AACAzc,WAAO0xC,KAAP,EAAc,UAAU1wC,IAAV,EAAgB;AAC5Byb,UAAIzb,IAAJ,IAAY,CAAC4kE,cAAc9iE,GAAd,CAAkB9B,IAAlB,KAA2B,EAA5B,EAAgCpE,KAAhC,EAAZ;AACD,KAFD;AAGA,WAAO6f,GAAP;AACD;AACD;;;;AAKA,WAAS+0C,gBAAT,CAA0BviB,QAA1B,EAAoCutB,YAApC,EAAkD4M,cAAlD,EAAkE;AAChE,QAAIh4B,UAAUorB,aAAax7D,IAAb,GAAoBw7D,aAAax7D,IAAjC,GAAwCooE,iBAAiBA,eAAeh4B,OAAhC,CAAwC;AAAxC,MACpDuqB,eAAenK,gBAAf,CAAgCviB,QAAhC,EAA0CutB,YAA1C,CADF,CADgE,CAEL;;AAE3D,WAAOprB,OAAP;AACD;AACD;;;;AAKA,WAASi1B,mBAAT,CAA6Bz3B,OAA7B,EAAsCy6B,YAAtC,EAAoD;AAClDz6B,YAAQ03B,iBAAR,GAA4BtjE,cAAc4rC,QAAQ23B,cAAR,GAAyBzpE,IAAIusE,YAAJ,EAAkB,UAAUzB,MAAV,EAAkB;AACrG,aAAOA,OAAOhM,cAAd;AACD,KAFkE,KAE7D,EAFsB,CAA5B;AAGD;AACD;;;;AAKA,WAASiL,eAAT,CAAyBW,UAAzB,EAAqCxlE,SAArC,EAAgD;AAC9C;AACA;AACA,WAAOA,UAAU5D,cAAV,CAAyB,SAAzB,IAAsC1B,OAAO8qE,UAAP,EAAmB,UAAUb,GAAV,EAAe;AAC7E,aAAOA,IAAIv1B,OAAJ,KAAgBpvC,UAAUovC,OAAjC;AACD,KAF4C,CAAtC,GAEFo2B,UAFL;AAGD;AACD3nE,QAAM6kE,WAAN,EAAmBzG,iBAAnB;;AAEA;;;;;;;;;;;;;;;;;;AAkBA,MAAIqL,iBAAiB,CAAC,QAAD,EAAW,OAAX,EAAoB,UAApB,EAAgC,WAAhC,EAA6C,qBAA7C,EAAoE,gBAApE,EAAsF,YAAtF,EAAoG,IAApG,EAA0G,KAA1G,EAAiH,YAAjH,EAA+H,qBAA/H,EAAsJ,UAAtJ,EAAkK,WAAlK,EAA+K,yBAA/K,EAA0M,sBAA1M,CAArB,CAxrmB4B,CAwrmB4N;;AAExP,WAASC,YAAT,CAAsBC,aAAtB,EAAqC;AACnCxpE,WAAOspE,cAAP,EAAuB,UAAUnsE,IAAV,EAAgB;AACrC,WAAKA,IAAL,IAAaoD,KAAKipE,cAAcrsE,IAAd,CAAL,EAA0BqsE,aAA1B,CAAb;AACD,KAFD,EAEG,IAFH;AAGD;;AAED;;;;;;;;;;;;;;;;;;AAkBA,MAAIC,2BAA2B,EAA/B;;AAEA,WAASC,uBAAT,GAAmC;AACjC,SAAKC,kBAAL,GAA0B,EAA1B;AACD;;AAEDD,0BAAwBvtE,SAAxB,GAAoC;AAClC6B,iBAAa0rE,uBADqB;AAElC5lE,YAAQ,gBAAU8qC,OAAV,EAAmBg7B,GAAnB,EAAwB;AAC9B,UAAIC,oBAAoB,EAAxB;AACA7pE,aAAOypE,wBAAP,EAAiC,UAAUK,OAAV,EAAmB9oE,IAAnB,EAAyB;AACxD,YAAIkL,OAAO49D,QAAQhmE,MAAR,CAAe8qC,OAAf,EAAwBg7B,GAAxB,CAAX;AACAC,4BAAoBA,kBAAkBjpE,MAAlB,CAAyBsL,QAAQ,EAAjC,CAApB;AACD,OAHD;AAIA,WAAKy9D,kBAAL,GAA0BE,iBAA1B;AACD,KATiC;AAUlC5nD,YAAQ,gBAAU2sB,OAAV,EAAmBg7B,GAAnB,EAAwB;AAC9B5pE,aAAO,KAAK2pE,kBAAZ,EAAgC,UAAUI,QAAV,EAAoB;AAClDA,iBAAS9nD,MAAT,IAAmB8nD,SAAS9nD,MAAT,CAAgB2sB,OAAhB,EAAyBg7B,GAAzB,CAAnB;AACD,OAFD;AAGD,KAdiC;AAelCI,0BAAsB,gCAAY;AAChC,aAAO,KAAKL,kBAAL,CAAwB/sE,KAAxB,EAAP;AACD;AAjBiC,GAApC;;AAoBA8sE,0BAAwBO,QAAxB,GAAmC,UAAUjpE,IAAV,EAAgBkpE,uBAAhB,EAAyC;AAC1ET,6BAAyBzoE,IAAzB,IAAiCkpE,uBAAjC;AACD,GAFD;;AAIAR,0BAAwB5mE,GAAxB,GAA8B,UAAU9B,IAAV,EAAgB;AAC5C,WAAOyoE,yBAAyBzoE,IAAzB,CAAP;AACD,GAFD;;AAIA;;;;;;;;;;;;;;;;;;;AAmBA;;;;;AAKA,MAAImpE,SAASnqE,MAAb;AACA,MAAIoqE,UAAU9sE,MAAd;AACA,MAAI+sE,QAAQvtE,GAAZ;AACA,MAAIwtE,UAAUjsE,KAAd;AACA,MAAIksE,YAAY,kBAAhB;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwDA,WAASC,aAAT,CAAuBZ,GAAvB,EAA4B;AAC1B;;;;AAIA,SAAKlE,IAAL,GAAYkE,GAAZ;AACA;;;;;AAKA,SAAKa,gBAAL,GAAwB,EAAxB;AACA;;;;;AAKA,SAAKC,UAAL,GAAkB,EAAlB;AACA;;;;;AAKA,SAAKC,aAAL;AACA;;;;;;;AAOA,SAAKC,oBAAL,GAA4B,EAA5B;AACA;;;;;AAKA,SAAKC,aAAL;AACA;;;;;AAKA,SAAKC,cAAL;AACD,GAr3mB2B,CAq3mB1B;AACF;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGAN,gBAAcruE,SAAd,GAA0B;AACxB6B,iBAAawsE,aADW;;AAGxB;;;;;;;AAOAzF,eAAW,mBAAUgG,SAAV,EAAqB/F,uBAArB,EAA8C;AACvD,UAAI+F,SAAJ,EAAe;AACb;AACA/qE,eAAOusC,iBAAiBw+B,UAAUnD,MAA3B,CAAP,EAA2C,UAAUA,MAAV,EAAkB;AAC3DA,oBAAUA,OAAO7nE,IAAjB,IAAyBkB,aAAa2mE,OAAO7nE,IAApB,CAAzB,IAAsDwC,eAAeqlE,OAAO7nE,IAAtB,CAAtD;AACD,SAFD;AAGD,OANsD,CAMrD;AACF;AACA;;;AAGAgrE,kBAAYX,QAAQW,SAAR,EAAmB,IAAnB,CAAZ,CAXuD,CAWjB;AACtC;;AAEA,UAAIC,kBAAkB,KAAKH,aAA3B;AACA,UAAII,kBAAkBC,eAAextE,IAAf,CAAoB,IAApB,EAA0BqtE,SAA1B,EAAqC/F,uBAArC,EAA8D,CAACgG,eAA/D,CAAtB;AACA,WAAKF,cAAL,GAAsBG,gBAAgB9F,UAAtC,CAhBuD,CAgBL;;AAElD,UAAI6F,eAAJ,EAAqB;AACnB;AACA1a,oBAAY0a,gBAAgB7F,UAA5B,EAAwC8F,gBAAgB9F,UAAxD,EAFmB,CAEkD;AACrE;AACA;;AAEA,YAAI8F,gBAAgBE,eAAhB,CAAgCrtE,MAApC,EAA4C;AAC1CktE,0BAAgBG,eAAhB,GAAkCF,gBAAgBE,eAAlD;AACD;;AAED,YAAIF,gBAAgBG,SAAhB,CAA0BttE,MAA9B,EAAsC;AACpCktE,0BAAgBI,SAAhB,GAA4BH,gBAAgBG,SAA5C;AACD;;AAED,YAAIH,gBAAgBI,YAApB,EAAkC;AAChCL,0BAAgBK,YAAhB,GAA+BJ,gBAAgBI,YAA/C;AACD;AACF,OAjBD,MAiBO;AACL,aAAKR,aAAL,GAAqBI,eAArB;AACD;AACF,KAhDuB;;AAkDxB;;;;AAIA7F,iBAAa,qBAAUkG,UAAV,EAAsB;AACjC,UAAIC,eAAe,KAAKV,aAAxB,CADiC,CACM;AACvC;;AAEA,WAAKJ,gBAAL,GAAwBJ,MAAMkB,aAAaJ,eAAnB,EAAoCf,OAApC,CAAxB;AACA,WAAKM,UAAL,GAAkBL,MAAMkB,aAAaH,SAAnB,EAA8BhB,OAA9B,CAAlB;AACA,WAAKO,aAAL,GAAqBP,QAAQmB,aAAaF,YAArB,CAArB;AACA,WAAKT,oBAAL,GAA4B,EAA5B;AACA,aAAOR,QAAQkB,WAAW;AAC1B;AACA;AACA;AACA;AAJe,QAKbC,aAAapG,UALA,GAKa,KAAK2F,cAL1B,CAAP;AAMD,KApEuB;;AAsExB;;;;AAIAvF,uBAAmB,2BAAU32B,OAAV,EAAmB;AACpC,UAAItB,MAAJ;AACA,UAAI69B,kBAAkB,KAAKV,gBAA3B;;AAEA,UAAIU,gBAAgBrtE,MAApB,EAA4B;AAC1B;AACA;AACA,YAAI0tE,gBAAgB58B,QAAQqxB,YAAR,CAAqB,UAArB,CAApB;;AAEA,YAAIuL,aAAJ,EAAmB;AACjBl+B,mBAAS88B,QAAQe,gBAAgBK,cAAcC,eAAd,EAAhB,CAAR,EAA0D,IAA1D,CAAT;AACD;AACF;;AAED,aAAOn+B,MAAP;AACD,KAzFuB;;AA2FxB;;;;AAIAm4B,oBAAgB,wBAAU72B,OAAV,EAAmB;AACjC,UAAI88B,UAAU,KAAKhG,IAAL,CAAUz1C,QAAV,EAAd;;AAEA,UAAI07C,WAAW,KAAKjG,IAAL,CAAUx1C,SAAV,EAAf;;AAEA,UAAIk7C,YAAY,KAAKV,UAArB;AACA,UAAIW,eAAe,KAAKV,aAAxB;AACA,UAAIiB,UAAU,EAAd;AACA,UAAIpuE,SAAS,EAAb,CARiC,CAQhB;;AAEjB,UAAI,CAAC4tE,UAAUttE,MAAX,IAAqB,CAACutE,YAA1B,EAAwC;AACtC,eAAO7tE,MAAP;AACD,OAZgC,CAY/B;;;AAGF,WAAK,IAAII,IAAI,CAAR,EAAWC,MAAMutE,UAAUttE,MAAhC,EAAwCF,IAAIC,GAA5C,EAAiDD,GAAjD,EAAsD;AACpD,YAAIiuE,gBAAgBT,UAAUxtE,CAAV,EAAampE,KAA7B,EAAoC2E,OAApC,EAA6CC,QAA7C,CAAJ,EAA4D;AAC1DC,kBAAQxrE,IAAR,CAAaxC,CAAb;AACD;AACF,OAnBgC,CAmB/B;AACF;;;AAGA,UAAI,CAACguE,QAAQ9tE,MAAT,IAAmButE,YAAvB,EAAqC;AACnCO,kBAAU,CAAC,CAAC,CAAF,CAAV;AACD;;AAED,UAAIA,QAAQ9tE,MAAR,IAAkB,CAACguE,cAAcF,OAAd,EAAuB,KAAKhB,oBAA5B,CAAvB,EAA0E;AACxEptE,iBAAS6sE,MAAMuB,OAAN,EAAe,UAAUz1C,KAAV,EAAiB;AACvC,iBAAOi0C,QAAQj0C,UAAU,CAAC,CAAX,GAAek1C,aAAa/9B,MAA5B,GAAqC89B,UAAUj1C,KAAV,EAAiBmX,MAA9D,CAAP;AACD,SAFQ,CAAT;AAGD,OA/BgC,CA+B/B;;;AAGF,WAAKs9B,oBAAL,GAA4BgB,OAA5B;AACA,aAAOpuE,MAAP;AACD;AAnIuB,GAA1B;;AAsIA,WAAS0tE,cAAT,CAAwBH,SAAxB,EAAmC/F,uBAAnC,EAA4D+G,KAA5D,EAAmE;AACjE,QAAIZ,kBAAkB,EAAtB;AACA,QAAIC,YAAY,EAAhB;AACA,QAAIC,YAAJ;AACA,QAAIlG,UAAJ,CAJiE,CAIjD;;AAEhB,QAAI6G,cAAcjB,UAAUkB,QAA5B;;AAEA,QAAIlB,UAAU5F,UAAd,EAA0B;AACxBA,mBAAa4F,UAAU5F,UAAvB;AACD,KAVgE,CAU/D;;;AAGF,QAAI6G,eAAejB,UAAU/3D,OAA7B,EAAsC;AACpCmyD,mBAAaA,cAAc,EAA3B;AACAgG,wBAAkB,CAACJ,UAAU/3D,OAAV,IAAqB,EAAtB,EAA0BpW,KAA1B,EAAlB;AACD,KAhBgE,CAgB/D;;;AAGF,QAAImuE,UAAUmB,KAAd,EAAqB;AACnB/G,mBAAaA,cAAc,EAA3B;AACA,UAAI+G,QAAQnB,UAAUmB,KAAtB;AACA/B,aAAO+B,KAAP,EAAc,UAAUC,WAAV,EAAuB;AACnC,YAAIA,eAAeA,YAAY7+B,MAA/B,EAAuC;AACrC,cAAI6+B,YAAYpF,KAAhB,EAAuB;AACrBqE,sBAAUhrE,IAAV,CAAe+rE,WAAf;AACD,WAFD,MAEO,IAAI,CAACd,YAAL,EAAmB;AACxB;AACAA,2BAAec,WAAf;AACD;AACF;AACF,OATD;AAUD,KAhCgE,CAgC/D;;;AAGF,QAAI,CAAChH,UAAL,EAAiB;AACfA,mBAAa4F,SAAb;AACD,KArCgE,CAqC/D;AACF;;;AAGA,QAAI,CAAC5F,WAAW8G,QAAhB,EAA0B;AACxB9G,iBAAW8G,QAAX,GAAsBD,WAAtB;AACD,KA3CgE,CA2C/D;;;AAGF7B,WAAO,CAAChF,UAAD,EAAavkE,MAAb,CAAoBuqE,eAApB,EAAqCvqE,MAArC,CAA4C9D,IAAIsuE,SAAJ,EAAe,UAAUc,KAAV,EAAiB;AACjF,aAAOA,MAAM5+B,MAAb;AACD,KAFkD,CAA5C,CAAP,EAEK,UAAUA,MAAV,EAAkB;AACrB68B,aAAOnF,uBAAP,EAAgC,UAAUoH,UAAV,EAAsB;AACpDA,mBAAW9+B,MAAX,EAAmBy+B,KAAnB;AACD,OAFD;AAGD,KAND;AAOA,WAAO;AACL5G,kBAAYA,UADP;AAELgG,uBAAiBA,eAFZ;AAGLE,oBAAcA,YAHT;AAILD,iBAAWA;AAJN,KAAP;AAMD;AACD;;;;;;AAOA,WAASS,eAAT,CAAyB9E,KAAzB,EAAgC2E,OAAhC,EAAyCC,QAAzC,EAAmD;AACjD,QAAIU,UAAU;AACZppD,aAAOyoD,OADK;AAEZxoD,cAAQyoD,QAFI;AAGZW,mBAAaZ,UAAUC,QAHX,CAGoB;;AAHpB,KAAd;AAMA,QAAIY,eAAe,IAAnB;AACAvsE,WAAO+mE,KAAP,EAAc,UAAU1nE,KAAV,EAAiBuiB,IAAjB,EAAuB;AACnC,UAAI4qD,UAAU5qD,KAAKxmB,KAAL,CAAWmvE,SAAX,CAAd;;AAEA,UAAI,CAACiC,OAAD,IAAY,CAACA,QAAQ,CAAR,CAAb,IAA2B,CAACA,QAAQ,CAAR,CAAhC,EAA4C;AAC1C;AACD;;AAED,UAAIC,WAAWD,QAAQ,CAAR,CAAf;AACA,UAAIE,WAAWF,QAAQ,CAAR,EAAW30D,WAAX,EAAf;;AAEA,UAAI,CAAC0O,QAAQ8lD,QAAQK,QAAR,CAAR,EAA2BrtE,KAA3B,EAAkCotE,QAAlC,CAAL,EAAkD;AAChDF,uBAAe,KAAf;AACD;AACF,KAbD;AAcA,WAAOA,YAAP;AACD;;AAED,WAAShmD,OAAT,CAAiBomD,IAAjB,EAAuBC,MAAvB,EAA+BH,QAA/B,EAAyC;AACvC,QAAIA,aAAa,KAAjB,EAAwB;AACtB,aAAOE,QAAQC,MAAf;AACD,KAFD,MAEO,IAAIH,aAAa,KAAjB,EAAwB;AAC7B,aAAOE,QAAQC,MAAf;AACD,KAFM,MAEA;AACL;AACA,aAAOD,SAASC,MAAhB;AACD;AACF;;AAED,WAASd,aAAT,CAAuBe,QAAvB,EAAiCC,QAAjC,EAA2C;AACzC;AACA,WAAOD,SAASlwD,IAAT,CAAc,GAAd,MAAuBmwD,SAASnwD,IAAT,CAAc,GAAd,CAA9B;AACD;AACD;;;;;;;;;;;;;;;;;;;;;;AAuBA,WAAS2zC,WAAT,CAAqByc,SAArB,EAAgCvS,SAAhC,EAA2C;AACzCA,gBAAYA,aAAa,EAAzB;AACA2P,WAAO3P,SAAP,EAAkB,UAAUwS,SAAV,EAAqB/9B,QAArB,EAA+B;AAC/C,UAAI+9B,aAAa,IAAjB,EAAuB;AACrB;AACD;;AAED,UAAIC,YAAYF,UAAU99B,QAAV,CAAhB;;AAEA,UAAI,CAAC0sB,eAAenqB,QAAf,CAAwBvC,QAAxB,CAAL,EAAwC;AACtC89B,kBAAU99B,QAAV,IAAsBq7B,QAAQ2C,SAAR,EAAmBD,SAAnB,EAA8B,IAA9B,CAAtB;AACD,OAFD,MAEO;AACLA,oBAAYzgC,iBAAiBygC,SAAjB,CAAZ;AACAC,oBAAY1gC,iBAAiB0gC,SAAjB,CAAZ;AACA,YAAIx/B,YAAYR,gBAAgBggC,SAAhB,EAA2BD,SAA3B,CAAhB;AACAD,kBAAU99B,QAAV,IAAsBo7B,MAAM58B,SAAN,EAAiB,UAAUE,IAAV,EAAgB;AACrD,iBAAOA,KAAKL,MAAL,IAAeK,KAAKP,KAApB,GAA4Bk9B,QAAQ38B,KAAKP,KAAb,EAAoBO,KAAKL,MAAzB,EAAiC,IAAjC,CAA5B,GAAqEK,KAAKP,KAAL,IAAcO,KAAKL,MAA/F;AACD,SAFqB,CAAtB;AAGD;AACF,KAjBD;AAkBD;;AAED;;;;;;;;;;;;;;;;;;AAkBA,MAAI4/B,SAASltE,MAAb;AACA,MAAImtE,aAAa3uE,UAAjB;AACA,MAAI4uE,kBAAkB,CAAC,WAAD,EAAc,WAAd,EAA2B,WAA3B,EAAwC,WAAxC,EAAqD,YAArD,EAAmE,OAAnE,EAA4E,WAA5E,CAAtB;;AAEA,WAASC,kBAAT,CAA4B5gC,GAA5B,EAAiC;AAC/B,QAAI6gC,eAAe7gC,OAAOA,IAAI8gC,SAA9B;;AAEA,QAAI,CAACD,YAAL,EAAmB;AACjB;AACD;;AAED,SAAK,IAAI1vE,IAAI,CAAR,EAAWC,MAAMuvE,gBAAgBtvE,MAAtC,EAA8CF,IAAIC,GAAlD,EAAuDD,GAAvD,EAA4D;AAC1D,UAAI8wB,YAAY0+C,gBAAgBxvE,CAAhB,CAAhB;AACA,UAAI4vE,qBAAqBF,aAAaG,MAAtC;AACA,UAAIC,uBAAuBJ,aAAa3gC,QAAxC;;AAEA,UAAI6gC,sBAAsBA,mBAAmB9+C,SAAnB,CAA1B,EAAyD;AACvD+d,YAAI/d,SAAJ,IAAiB+d,IAAI/d,SAAJ,KAAkB,EAAnC;;AAEA,YAAI,CAAC+d,IAAI/d,SAAJ,EAAe++C,MAApB,EAA4B;AAC1BhhC,cAAI/d,SAAJ,EAAe++C,MAAf,GAAwBD,mBAAmB9+C,SAAnB,CAAxB;AACD,SAFD,MAEO;AACLrwB,gBAAMouC,IAAI/d,SAAJ,EAAe++C,MAArB,EAA6BD,mBAAmB9+C,SAAnB,CAA7B;AACD;;AAED8+C,2BAAmB9+C,SAAnB,IAAgC,IAAhC;AACD;;AAED,UAAIg/C,wBAAwBA,qBAAqBh/C,SAArB,CAA5B,EAA6D;AAC3D+d,YAAI/d,SAAJ,IAAiB+d,IAAI/d,SAAJ,KAAkB,EAAnC;;AAEA,YAAI,CAAC+d,IAAI/d,SAAJ,EAAeie,QAApB,EAA8B;AAC5BF,cAAI/d,SAAJ,EAAeie,QAAf,GAA0B+gC,qBAAqBh/C,SAArB,CAA1B;AACD,SAFD,MAEO;AACLrwB,gBAAMouC,IAAI/d,SAAJ,EAAeie,QAArB,EAA+B+gC,qBAAqBh/C,SAArB,CAA/B;AACD;;AAEDg/C,6BAAqBh/C,SAArB,IAAkC,IAAlC;AACD;AACF;AACF;;AAED,WAASi/C,qBAAT,CAA+BlhC,GAA/B,EAAoCmhC,OAApC,EAA6CC,SAA7C,EAAwD;AACtD,QAAIphC,OAAOA,IAAImhC,OAAJ,CAAP,KAAwBnhC,IAAImhC,OAAJ,EAAaH,MAAb,IAAuBhhC,IAAImhC,OAAJ,EAAajhC,QAA5D,CAAJ,EAA2E;AACzE,UAAImhC,YAAYrhC,IAAImhC,OAAJ,EAAaH,MAA7B;AACA,UAAIM,cAActhC,IAAImhC,OAAJ,EAAajhC,QAA/B;;AAEA,UAAImhC,SAAJ,EAAe;AACb;AACA,YAAID,SAAJ,EAAe;AACbphC,cAAImhC,OAAJ,EAAaH,MAAb,GAAsBhhC,IAAImhC,OAAJ,EAAajhC,QAAb,GAAwB,IAA9C;AACA3tC,mBAASytC,IAAImhC,OAAJ,CAAT,EAAuBE,SAAvB;AACD,SAHD,MAGO;AACLrhC,cAAImhC,OAAJ,IAAeE,SAAf;AACD;AACF;;AAED,UAAIC,WAAJ,EAAiB;AACfthC,YAAIE,QAAJ,GAAeF,IAAIE,QAAJ,IAAgB,EAA/B;AACAF,YAAIE,QAAJ,CAAaihC,OAAb,IAAwBG,WAAxB;AACD;AACF;AACF;;AAED,WAASC,qBAAT,CAA+BvhC,GAA/B,EAAoC;AAClCkhC,0BAAsBlhC,GAAtB,EAA2B,WAA3B;AACAkhC,0BAAsBlhC,GAAtB,EAA2B,WAA3B;AACAkhC,0BAAsBlhC,GAAtB,EAA2B,WAA3B;AACAkhC,0BAAsBlhC,GAAtB,EAA2B,OAA3B;AACAkhC,0BAAsBlhC,GAAtB,EAA2B,WAA3B,EALkC,CAKO;;AAEzCkhC,0BAAsBlhC,GAAtB,EAA2B,YAA3B,EAPkC,CAOQ;;AAE1CkhC,0BAAsBlhC,GAAtB,EAA2B,WAA3B;AACD;;AAED,WAASwhC,eAAT,CAAyBxhC,GAAzB,EAA8BvvB,QAA9B,EAAwC;AACtC;AACA,QAAIgxD,iBAAiBf,WAAW1gC,GAAX,KAAmBA,IAAIvvB,QAAJ,CAAxC;AACA,QAAIuuC,YAAY0hB,WAAWe,cAAX,KAA8BA,eAAeziB,SAA7D;;AAEA,QAAIA,SAAJ,EAAe;AACb,WAAK,IAAI7tD,IAAI,CAAR,EAAWC,MAAMgvC,mBAAmB/uC,MAAzC,EAAiDF,IAAIC,GAArD,EAA0DD,GAA1D,EAA+D;AAC7D,YAAIsf,WAAW2vB,mBAAmBjvC,CAAnB,CAAf;;AAEA,YAAI6tD,UAAUrtD,cAAV,CAAyB8e,QAAzB,CAAJ,EAAwC;AACtCgxD,yBAAehxD,QAAf,IAA2BuuC,UAAUvuC,QAAV,CAA3B;AACD;AACF;AACF;AACF;;AAED,WAASixD,qBAAT,CAA+B1hC,GAA/B,EAAoC;AAClC,QAAIA,GAAJ,EAAS;AACPuhC,4BAAsBvhC,GAAtB;AACAwhC,sBAAgBxhC,GAAhB,EAAqB,OAArB;AACAA,UAAIE,QAAJ,IAAgBshC,gBAAgBxhC,IAAIE,QAApB,EAA8B,OAA9B,CAAhB;AACD;AACF;;AAED,WAASyhC,aAAT,CAAuBC,SAAvB,EAAkC;AAChC,QAAI,CAAClB,WAAWkB,SAAX,CAAL,EAA4B;AAC1B;AACD;;AAEDhB,uBAAmBgB,SAAnB;AACAL,0BAAsBK,SAAtB;AACAJ,oBAAgBI,SAAhB,EAA2B,OAA3B,EAPgC,CAOK;;AAErCJ,oBAAgBI,SAAhB,EAA2B,YAA3B,EATgC,CASU;;AAE1CJ,oBAAgBI,SAAhB,EAA2B,WAA3B;;AAEA,QAAIA,UAAU1hC,QAAd,EAAwB;AACtBshC,sBAAgBI,UAAU1hC,QAA1B,EAAoC,OAApC,EADsB,CACwB;;AAE9CshC,sBAAgBI,UAAU1hC,QAA1B,EAAoC,YAApC,EAHsB,CAG6B;;AAEnDshC,sBAAgBI,UAAU1hC,QAA1B,EAAoC,WAApC;AACD;;AAED,QAAI2hC,YAAYD,UAAUC,SAA1B;;AAEA,QAAIA,SAAJ,EAAe;AACbjB,yBAAmBiB,SAAnB;AACAH,4BAAsBG,SAAtB;AACD;;AAED,QAAIC,WAAWF,UAAUE,QAAzB;;AAEA,QAAIA,QAAJ,EAAc;AACZlB,yBAAmBkB,QAAnB;AACAJ,4BAAsBI,QAAtB;AACD;;AAED,QAAIC,WAAWH,UAAUG,QAAzB;;AAEA,QAAIA,QAAJ,EAAc;AACZL,4BAAsBK,QAAtB;AACD;;AAED,QAAIzuE,OAAOsuE,UAAUtuE,IAArB,CAzCgC,CAyCL;AAC3B;;AAEA,QAAIsuE,UAAUrtE,IAAV,KAAmB,OAAvB,EAAgC;AAC9BjB,aAAOA,QAAQsuE,UAAUI,KAAzB;AACA,UAAIC,WAAWL,UAAUM,KAAV,IAAmBN,UAAUO,KAA5C;;AAEA,UAAIF,YAAY,CAACztE,aAAaytE,QAAb,CAAjB,EAAyC;AACvC,aAAK,IAAI9wE,IAAI,CAAb,EAAgBA,IAAI8wE,SAAS5wE,MAA7B,EAAqCF,GAArC,EAA0C;AACxCuwE,gCAAsBO,SAAS9wE,CAAT,CAAtB;AACD;AACF;;AAEDoC,aAAOquE,UAAUQ,UAAjB,EAA6B,UAAUpiC,GAAV,EAAe;AAC1CuhC,8BAAsBvhC,GAAtB;AACD,OAFD;AAGD;;AAED,QAAI1sC,QAAQ,CAACkB,aAAalB,IAAb,CAAb,EAAiC;AAC/B,WAAK,IAAInC,IAAI,CAAb,EAAgBA,IAAImC,KAAKjC,MAAzB,EAAiCF,GAAjC,EAAsC;AACpCuwE,8BAAsBpuE,KAAKnC,CAAL,CAAtB;AACD;AACF,KA/D+B,CA+D9B;;;AAGF,QAAI0wE,YAAYD,UAAUC,SAA1B;;AAEA,QAAIA,aAAaA,UAAUvuE,IAA3B,EAAiC;AAC/B,UAAI+uE,SAASR,UAAUvuE,IAAvB;;AAEA,WAAK,IAAInC,IAAI,CAAb,EAAgBA,IAAIkxE,OAAOhxE,MAA3B,EAAmCF,GAAnC,EAAwC;AACtCuwE,8BAAsBW,OAAOlxE,CAAP,CAAtB;AACD;AACF,KA1E+B,CA0E9B;;;AAGF,QAAI2wE,WAAWF,UAAUE,QAAzB;;AAEA,QAAIA,YAAYA,SAASxuE,IAAzB,EAA+B;AAC7B,UAAIgvE,SAASR,SAASxuE,IAAtB;;AAEA,WAAK,IAAInC,IAAI,CAAb,EAAgBA,IAAImxE,OAAOjxE,MAA3B,EAAmCF,GAAnC,EAAwC;AACtC,YAAIe,QAAQowE,OAAOnxE,CAAP,CAAR,CAAJ,EAAwB;AACtBuwE,gCAAsBY,OAAOnxE,CAAP,EAAU,CAAV,CAAtB;AACAuwE,gCAAsBY,OAAOnxE,CAAP,EAAU,CAAV,CAAtB;AACD,SAHD,MAGO;AACLuwE,gCAAsBY,OAAOnxE,CAAP,CAAtB;AACD;AACF;AACF,KA1F+B,CA0F9B;;;AAGF,QAAIywE,UAAUrtE,IAAV,KAAmB,OAAvB,EAAgC;AAC9BitE,sBAAgBI,SAAhB,EAA2B,WAA3B;AACAJ,sBAAgBI,SAAhB,EAA2B,OAA3B;AACAJ,sBAAgBI,SAAhB,EAA2B,QAA3B;AACD,KAJD,MAIO,IAAIA,UAAUrtE,IAAV,KAAmB,SAAvB,EAAkC;AACvC2sE,4BAAsBU,UAAUW,UAAhC,EAA4C,WAA5C;AACAhvE,aAAOquE,UAAUY,MAAjB,EAAyB,UAAUxiC,GAAV,EAAe;AACtCuhC,8BAAsBvhC,GAAtB;AACD,OAFD;AAGD,KALM,MAKA,IAAI4hC,UAAUrtE,IAAV,KAAmB,MAAvB,EAA+B;AACpCgtE,4BAAsBK,UAAUa,MAAhC;AACD,KAxG+B,CAwG9B;AAEH;;AAED,WAASC,KAAT,CAAe59B,CAAf,EAAkB;AAChB,WAAO5yC,QAAQ4yC,CAAR,IAAaA,CAAb,GAAiBA,IAAI,CAACA,CAAD,CAAJ,GAAU,EAAlC;AACD;;AAED,WAAS69B,KAAT,CAAe79B,CAAf,EAAkB;AAChB,WAAO,CAAC5yC,QAAQ4yC,CAAR,IAAaA,EAAE,CAAF,CAAb,GAAoBA,CAArB,KAA2B,EAAlC;AACD;;AAED,MAAI89B,cAAc,SAAdA,WAAc,CAAU/hC,MAAV,EAAkBgiC,OAAlB,EAA2B;AAC3CpC,WAAOiC,MAAM7hC,OAAOs6B,MAAb,CAAP,EAA6B,UAAUyG,SAAV,EAAqB;AAChDlB,iBAAWkB,SAAX,KAAyBD,cAAcC,SAAd,CAAzB;AACD,KAFD;AAGA,QAAIkB,OAAO,CAAC,OAAD,EAAU,OAAV,EAAmB,YAAnB,EAAiC,WAAjC,EAA8C,YAA9C,EAA4D,cAA5D,EAA4E,OAA5E,CAAX;AACAD,eAAWC,KAAKnvE,IAAL,CAAU,WAAV,EAAuB,cAAvB,EAAuC,SAAvC,EAAkD,UAAlD,CAAX;AACA8sE,WAAOqC,IAAP,EAAa,UAAUC,QAAV,EAAoB;AAC/BtC,aAAOiC,MAAM7hC,OAAOkiC,QAAP,CAAN,CAAP,EAAgC,UAAUC,OAAV,EAAmB;AACjD,YAAIA,OAAJ,EAAa;AACXxB,0BAAgBwB,OAAhB,EAAyB,WAAzB;AACAxB,0BAAgBwB,QAAQC,WAAxB,EAAqC,OAArC;AACD;AACF,OALD;AAMD,KAPD;AAQAxC,WAAOiC,MAAM7hC,OAAOyyB,QAAb,CAAP,EAA+B,UAAU4P,WAAV,EAAuB;AACpD,UAAIC,sBAAsBD,eAAeA,YAAYC,mBAArD;AACA3B,sBAAgB2B,mBAAhB,EAAqC,WAArC;AACA3B,sBAAgB2B,uBAAuBA,oBAAoBF,WAA3D,EAAwE,OAAxE;AACD,KAJD;AAKAxC,WAAOiC,MAAM7hC,OAAOuiC,QAAb,CAAP,EAA+B,UAAUC,WAAV,EAAuB;AACpDnC,4BAAsBmC,WAAtB,EAAmC,WAAnC;AACA7B,sBAAgB6B,WAAhB,EAA6B,UAA7B;AACA7B,sBAAgB6B,WAAhB,EAA6B,YAA7B;AACA7B,sBAAgB6B,WAAhB,EAA6B,WAA7B;AACD,KALD,EAnB2C,CAwBvC;;AAEJ5C,WAAOiC,MAAM7hC,OAAOyiC,KAAb,CAAP,EAA4B,UAAUC,QAAV,EAAoB;AAC9C/B,sBAAgB+B,QAAhB,EAA0B,MAA1B;AACD,KAFD;AAGA9C,WAAOiC,MAAM7hC,OAAOwyB,GAAb,CAAP,EAA0B,UAAUmQ,MAAV,EAAkB;AAC1C,UAAI9C,WAAW8C,MAAX,CAAJ,EAAwB;AACtB9B,8BAAsB8B,MAAtB;AACA/C,eAAOiC,MAAMc,OAAOC,OAAb,CAAP,EAA8B,UAAUC,SAAV,EAAqB;AACjDhC,gCAAsBgC,SAAtB;AACD,SAFD;AAGD;AACF,KAPD;AAQAjD,WAAOiC,MAAM7hC,OAAO2+B,QAAb,CAAP,EAA+B,UAAUD,WAAV,EAAuB;AACpDmC,4BAAsBnC,WAAtB;AACA2B,4BAAsB3B,WAAtB,EAAmC,OAAnC;AACA2B,4BAAsB3B,WAAtB,EAAmC,WAAnC;AACA2B,4BAAsB3B,WAAtB,EAAmC,cAAnC,EAAmD,IAAnD;AACA,UAAIjsE,OAAOisE,YAAYjsE,IAAvB;AACApB,cAAQoB,IAAR,KAAiBC,OAAOD,IAAP,EAAa,UAAU4tC,IAAV,EAAgB;AAC5C,YAAInvC,WAAWmvC,IAAX,CAAJ,EAAsB;AACpBggC,gCAAsBhgC,IAAtB,EAA4B,OAA5B;AACAggC,gCAAsBhgC,IAAtB,EAA4B,WAA5B;AACD;AACF,OALgB,CAAjB;AAMD,KAZD;AAaAu/B,WAAOiC,MAAM7hC,OAAO8iC,OAAb,CAAP,EAA8B,UAAUC,UAAV,EAAsB;AAClD1C,4BAAsB0C,UAAtB,EAAkC,WAAlC;AACAnD,aAAOmD,WAAWC,OAAlB,EAA2B,UAAUC,UAAV,EAAsB;AAC/C5C,8BAAsB4C,UAAtB,EAAkC,WAAlC;AACD,OAFD;AAGD,KALD;AAMAtC,oBAAgBmB,MAAM9hC,OAAOoiC,WAAb,CAAhB,EAA2C,OAA3C;AACAzB,oBAAgBmB,MAAM9hC,OAAOkjC,OAAb,EAAsBd,WAAtC,EAAmD,OAAnD;AACD,GA1DD;;AA4DA;;;;;;;;;;;;;;;;;;AAkBA;AACA,WAAS5sE,GAAT,CAAa2pC,GAAb,EAAkB1rB,IAAlB,EAAwB;AACtBA,WAAOA,KAAK3I,KAAL,CAAW,GAAX,CAAP;AACA,QAAInY,MAAMwsC,GAAV;;AAEA,SAAK,IAAI7uC,IAAI,CAAb,EAAgBA,IAAImjB,KAAKjjB,MAAzB,EAAiCF,GAAjC,EAAsC;AACpCqC,YAAMA,OAAOA,IAAI8gB,KAAKnjB,CAAL,CAAJ,CAAb;;AAEA,UAAIqC,OAAO,IAAX,EAAiB;AACf;AACD;AACF;;AAED,WAAOA,GAAP;AACD;;AAED,WAASwwE,KAAT,CAAehkC,GAAf,EAAoB1rB,IAApB,EAA0Bjf,GAA1B,EAA+BvD,SAA/B,EAA0C;AACxCwiB,WAAOA,KAAK3I,KAAL,CAAW,GAAX,CAAP;AACA,QAAInY,MAAMwsC,GAAV;AACA,QAAItuC,GAAJ;;AAEA,SAAK,IAAIP,IAAI,CAAb,EAAgBA,IAAImjB,KAAKjjB,MAAL,GAAc,CAAlC,EAAqCF,GAArC,EAA0C;AACxCO,YAAM4iB,KAAKnjB,CAAL,CAAN;;AAEA,UAAIqC,IAAI9B,GAAJ,KAAY,IAAhB,EAAsB;AACpB8B,YAAI9B,GAAJ,IAAW,EAAX;AACD;;AAED8B,YAAMA,IAAI9B,GAAJ,CAAN;AACD;;AAED,QAAII,aAAa0B,IAAI8gB,KAAKnjB,CAAL,CAAJ,KAAgB,IAAjC,EAAuC;AACrCqC,UAAI8gB,KAAKnjB,CAAL,CAAJ,IAAekE,GAAf;AACD;AACF;;AAED,WAAS4uE,sBAAT,CAAgCpjC,MAAhC,EAAwC;AACtCttC,WAAO2wE,iBAAP,EAA0B,UAAUhxE,IAAV,EAAgB;AACxC,UAAIA,KAAK,CAAL,KAAW2tC,MAAX,IAAqB,EAAE3tC,KAAK,CAAL,KAAW2tC,MAAb,CAAzB,EAA+C;AAC7CA,eAAO3tC,KAAK,CAAL,CAAP,IAAkB2tC,OAAO3tC,KAAK,CAAL,CAAP,CAAlB;AACD;AACF,KAJD;AAKD;;AAED,MAAIgxE,oBAAoB,CAAC,CAAC,GAAD,EAAM,MAAN,CAAD,EAAgB,CAAC,GAAD,EAAM,KAAN,CAAhB,EAA8B,CAAC,IAAD,EAAO,OAAP,CAA9B,EAA+C,CAAC,IAAD,EAAO,QAAP,CAA/C,CAAxB;AACA,MAAIC,0BAA0B,CAAC,MAAD,EAAS,KAAT,EAAgB,UAAhB,EAA4B,QAA5B,EAAsC,SAAtC,EAAiD,OAAjD,EAA0D,WAA1D,EAAuE,UAAvE,EAAmF,UAAnF,CAA9B;AACA,MAAIC,iBAAiB,SAAjBA,cAAiB,CAAUvjC,MAAV,EAAkBgiC,OAAlB,EAA2B;AAC9CD,gBAAY/hC,MAAZ,EAAoBgiC,OAApB,EAD8C,CAChB;;AAE9BhiC,WAAOs6B,MAAP,GAAgBr7B,iBAAiBe,OAAOs6B,MAAxB,CAAhB;AACA5nE,WAAOstC,OAAOs6B,MAAd,EAAsB,UAAUyG,SAAV,EAAqB;AACzC,UAAI,CAAC7vE,WAAW6vE,SAAX,CAAL,EAA4B;AAC1B;AACD;;AAED,UAAIjL,aAAaiL,UAAUrtE,IAA3B;;AAEA,UAAIoiE,eAAe,KAAf,IAAwBA,eAAe,OAA3C,EAAoD;AAClD,YAAIiL,UAAUyC,SAAV,IAAuB,IAA3B,EAAiC;AAC/BzC,oBAAU5qB,SAAV,GAAsB4qB,UAAUyC,SAAhC;AACD;AACF;;AAED,UAAI1N,eAAe,OAAnB,EAA4B;AAC1B,YAAI2N,eAAejuE,IAAIurE,SAAJ,EAAe,eAAf,CAAnB;AACA0C,wBAAgB,IAAhB,IAAwBN,MAAMpC,SAAN,EAAiB,wBAAjB,EAA2C0C,YAA3C,CAAxB;AACD;;AAEDL,6BAAuBrC,SAAvB;AACD,KAnBD,EAJ8C,CAuB1C;;AAEJ,QAAI/gC,OAAO0jC,SAAX,EAAsB;AACpB1jC,aAAO2jC,SAAP,GAAmB3jC,OAAO0jC,SAA1B;AACD;;AAEDhxE,WAAO4wE,uBAAP,EAAgC,UAAUM,aAAV,EAAyB;AACvD,UAAIl+D,UAAUs6B,OAAO4jC,aAAP,CAAd;;AAEA,UAAIl+D,OAAJ,EAAa;AACX,YAAI,CAACrU,QAAQqU,OAAR,CAAL,EAAuB;AACrBA,oBAAU,CAACA,OAAD,CAAV;AACD;;AAEDhT,eAAOgT,OAAP,EAAgB,UAAUs6B,MAAV,EAAkB;AAChCojC,iCAAuBpjC,MAAvB;AACD,SAFD;AAGD;AACF,KAZD;AAaD,GA1CD;;AA4CA;;;;;;;;;;;;;;;;;;AAkBA;AACA;AACA;AACA;;AAEA,MAAI6jC,YAAY,SAAZA,SAAY,CAAUviC,OAAV,EAAmB;AACjC,QAAIwiC,eAAepuE,eAAnB;AACA4rC,YAAQu5B,UAAR,CAAmB,UAAUxJ,WAAV,EAAuB;AACxC,UAAI1M,QAAQ0M,YAAY77D,GAAZ,CAAgB,OAAhB,CAAZ,CADwC,CACF;;AAEtC,UAAImvD,KAAJ,EAAW;AACT,YAAIof,gBAAgBD,aAAatuE,GAAb,CAAiBmvD,KAAjB,KAA2Bmf,aAAavuE,GAAb,CAAiBovD,KAAjB,EAAwB,EAAxB,CAA/C;AACA,YAAIlyD,OAAO4+D,YAAY2S,OAAZ,EAAX;AACA,YAAIC,YAAY;AACd;AACAC,gCAAsBzxE,KAAK0xE,kBAAL,CAAwB,sBAAxB,CAFR;AAGdC,gCAAsB3xE,KAAK0xE,kBAAL,CAAwB,sBAAxB,CAHR;AAIdE,4BAAkB5xE,KAAK0xE,kBAAL,CAAwB,kBAAxB,CAJJ;AAKdG,8BAAoB7xE,KAAK0xE,kBAAL,CAAwB,oBAAxB,CALN;AAMdI,4BAAkB9xE,KAAK0xE,kBAAL,CAAwB,kBAAxB,CANJ;AAOd1xE,gBAAMA,IAPQ;AAQd4+D,uBAAaA;AARC,SAAhB,CAHS,CAYN;;AAEH,YAAI,CAAC4S,UAAUI,gBAAX,IAA+B,EAAEJ,UAAUM,gBAAV,IAA8BN,UAAUK,kBAA1C,CAAnC,EAAkG;AAChG;AACD;;AAEDP,sBAAcvzE,MAAd,IAAwBiC,KAAK+xE,kBAAL,CAAwB,iBAAxB,EAA2CT,cAAcA,cAAcvzE,MAAd,GAAuB,CAArC,EAAwC6gE,WAAnF,CAAxB;AACA0S,sBAAcjxE,IAAd,CAAmBmxE,SAAnB;AACD;AACF,KAxBD;AAyBAH,iBAAazuE,IAAb,CAAkBovE,cAAlB;AACD,GA5BD;;AA8BA,WAASA,cAAT,CAAwBV,aAAxB,EAAuC;AACrCrxE,WAAOqxE,aAAP,EAAsB,UAAUW,eAAV,EAA2BC,UAA3B,EAAuC;AAC3D,UAAIC,YAAY,EAAhB;AACA,UAAIC,YAAY,CAACre,GAAD,EAAMA,GAAN,CAAhB;AACA,UAAIse,OAAO,CAACJ,gBAAgBR,oBAAjB,EAAuCQ,gBAAgBN,oBAAvD,CAAX;AACA,UAAIW,aAAaL,gBAAgBjyE,IAAjC;AACA,UAAI8xE,mBAAmBG,gBAAgBH,gBAAvC,CAL2D,CAKF;AACzD;;AAEA,UAAIn2B,UAAU22B,WAAWv1E,GAAX,CAAes1E,IAAf,EAAqB,UAAU71D,EAAV,EAAcjY,EAAd,EAAkB8pC,SAAlB,EAA6B;AAC9D,YAAIwW,MAAMytB,WAAWvvE,GAAX,CAAekvE,gBAAgBL,gBAA/B,EAAiDvjC,SAAjD,CAAV,CAD8D,CACS;AACvE;;AAEA,YAAIryB,MAAM6oC,GAAN,CAAJ,EAAgB;AACd,iBAAOutB,SAAP;AACD;;AAED,YAAIG,OAAJ;AACA,YAAIC,mBAAJ;;AAEA,YAAIV,gBAAJ,EAAsB;AACpBU,gCAAsBF,WAAWG,WAAX,CAAuBpkC,SAAvB,CAAtB;AACD,SAFD,MAEO;AACLkkC,oBAAUD,WAAWvvE,GAAX,CAAekvE,gBAAgBJ,kBAA/B,EAAmDxjC,SAAnD,CAAV;AACD,SAf6D,CAe5D;;;AAGF,YAAIqkC,cAAc3e,GAAlB;;AAEA,aAAK,IAAIt4C,IAAIy2D,aAAa,CAA1B,EAA6Bz2D,KAAK,CAAlC,EAAqCA,GAArC,EAA0C;AACxC,cAAI+1D,YAAYF,cAAc71D,CAAd,CAAhB,CADwC,CACN;;AAElC,cAAI,CAACq2D,gBAAL,EAAuB;AACrBU,kCAAsBhB,UAAUxxE,IAAV,CAAe2yE,UAAf,CAA0BnB,UAAUK,kBAApC,EAAwDU,OAAxD,CAAtB;AACD;;AAED,cAAIC,uBAAuB,CAA3B,EAA8B;AAC5B,gBAAIzwE,MAAMyvE,UAAUxxE,IAAV,CAAe4yE,aAAf,CAA6BpB,UAAUC,oBAAvC,EAA6De,mBAA7D,CAAV,CAD4B,CACiE;;AAE7F,gBAAI3tB,OAAO,CAAP,IAAY9iD,MAAM,CAAlB,IAAuB;AAC3B8iD,mBAAO,CAAP,IAAY9iD,MAAM,CADlB,CACoB;AADpB,cAEE;AACE8iD,uBAAO9iD,GAAP;AACA2wE,8BAAc3wE,GAAd;AACA;AACD;AACJ;AACF;;AAEDowE,kBAAU,CAAV,IAAettB,GAAf;AACAstB,kBAAU,CAAV,IAAeO,WAAf;AACA,eAAOP,SAAP;AACD,OA3Ca,CAAd;AA4CAG,iBAAWO,SAAX,CAAqB13B,OAArB,CAA6BQ,OAA7B,EApD2D,CAoDpB;;AAEvCs2B,sBAAgBjyE,IAAhB,GAAuB27C,OAAvB;AACD,KAvDD;AAwDD;;AAED;;;;;;;;;;;;;;;;;;AAkBA;AACA;AACA;AACA;;;;;AAKA,WAASm3B,mBAAT,CAA6Bt1E,MAA7B,EAAqCu1E,OAArC,EAA8C;AAC5C,QAAI,CAAC/R,OAAOrwB,UAAP,CAAkBnzC,MAAlB,CAAL,EAAgC;AAC9BA,eAASwjE,OAAOQ,kBAAP,CAA0BhkE,MAA1B,CAAT;AACD;;AAED,SAAKw1E,OAAL,GAAex1E,MAAf;AACA,QAAIwC,OAAO,KAAKizE,KAAL,GAAaz1E,OAAOwC,IAA/B;AACA,QAAIkhE,eAAe1jE,OAAO0jE,YAA1B,CAP4C,CAOJ;;AAExC,QAAIA,iBAAiBL,yBAArB,EAAgD;AAC9C,WAAKqS,OAAL,GAAe,CAAf;AACA,WAAKC,QAAL,GAAgBJ,OAAhB;AACA,WAAKE,KAAL,GAAajzE,IAAb;AACD;;AAED,QAAI9C,UAAUk2E,gBAAgBlS,iBAAiBT,wBAAjB,GAA4CS,eAAe,GAAf,GAAqB1jE,OAAO2jE,cAAxE,GAAyFD,YAAzG,CAAd;AACAliE,WAAO,IAAP,EAAa9B,OAAb;AACD;AACD,MAAIm2E,gBAAgBP,oBAAoB12E,SAAxC,CA3soB4B,CA2soBuB;;AAEnDi3E,gBAAcC,IAAd,GAAqB,KAArB,CA7soB4B,CA6soBA;;AAE5BD,gBAAcE,UAAd,GAA2B,IAA3B,CA/soB4B,CA+soBK;;AAEjCF,gBAAczR,SAAd,GAA0B,YAAY;AACpC,WAAO,KAAKoR,OAAZ;AACD,GAFD;;AAIA,MAAII,kBAAkB;AACpB,wBAAoB;AAClBE,YAAM,IADY;AAElB5xD,aAAO,iBAAY;AACjB,eAAO/c,KAAKqB,GAAL,CAAS,CAAT,EAAY,KAAKitE,KAAL,CAAWl1E,MAAX,GAAoB,KAAKi1E,OAAL,CAAa1R,UAA7C,CAAP;AACD,OAJiB;AAKlBkS,eAAS,iBAAU1uD,GAAV,EAAe;AACtB,eAAO,KAAKmuD,KAAL,CAAWnuD,MAAM,KAAKkuD,OAAL,CAAa1R,UAA9B,CAAP;AACD,OAPiB;AAQlBmS,kBAAYC;AARM,KADA;AAWpB,qBAAiB;AACfJ,YAAM,IADS;AAEf5xD,aAAO,iBAAY;AACjB,YAAI+iD,MAAM,KAAKwO,KAAL,CAAW,CAAX,CAAV;AACA,eAAOxO,MAAM9/D,KAAKqB,GAAL,CAAS,CAAT,EAAYy+D,IAAI1mE,MAAJ,GAAa,KAAKi1E,OAAL,CAAa1R,UAAtC,CAAN,GAA0D,CAAjE;AACD,OALc;AAMfkS,eAAS,iBAAU1uD,GAAV,EAAe;AACtBA,eAAO,KAAKkuD,OAAL,CAAa1R,UAApB;AACA,YAAI1zB,OAAO,EAAX;AACA,YAAI5tC,OAAO,KAAKizE,KAAhB;;AAEA,aAAK,IAAIp1E,IAAI,CAAb,EAAgBA,IAAImC,KAAKjC,MAAzB,EAAiCF,GAAjC,EAAsC;AACpC,cAAI4mE,MAAMzkE,KAAKnC,CAAL,CAAV;AACA+vC,eAAKvtC,IAAL,CAAUokE,MAAMA,IAAI3/C,GAAJ,CAAN,GAAiB,IAA3B;AACD;;AAED,eAAO8oB,IAAP;AACD,OAjBc;AAkBf6lC,kBAAY,sBAAY;AACtB,cAAM,IAAItxE,KAAJ,CAAU,2DAAV,CAAN;AACD;AApBc,KAXG;AAiCpB,kBAAc;AACZmxE,YAAM,IADM;AAEZ5xD,aAAOiyD,WAFK;AAGZH,eAASI,aAHG;AAIZH,kBAAYC;AAJA,KAjCM;AAuCpB,oBAAgB;AACdJ,YAAM,IADQ;AAEd5xD,aAAO,iBAAY;AACjB,YAAI4iD,UAAU,KAAK0O,OAAL,CAAa5R,gBAAb,CAA8B,CAA9B,EAAiChkE,IAA/C;AACA,YAAIy2E,MAAM,KAAKZ,KAAL,CAAW3O,OAAX,CAAV;AACA,eAAOuP,MAAMA,IAAI91E,MAAV,GAAmB,CAA1B;AACD,OANa;AAOdy1E,eAAS,iBAAU1uD,GAAV,EAAe;AACtB,YAAI8oB,OAAO,EAAX;AACA,YAAIykC,OAAO,KAAKW,OAAL,CAAa5R,gBAAxB;;AAEA,aAAK,IAAIvjE,IAAI,CAAb,EAAgBA,IAAIw0E,KAAKt0E,MAAzB,EAAiCF,GAAjC,EAAsC;AACpC,cAAIg2E,MAAM,KAAKZ,KAAL,CAAWZ,KAAKx0E,CAAL,EAAQT,IAAnB,CAAV;AACAwwC,eAAKvtC,IAAL,CAAUwzE,MAAMA,IAAI/uD,GAAJ,CAAN,GAAiB,IAA3B;AACD;;AAED,eAAO8oB,IAAP;AACD,OAjBa;AAkBd6lC,kBAAY,oBAAU93B,OAAV,EAAmB;AAC7B,YAAI37C,OAAO,KAAKizE,KAAhB;AACAhzE,eAAO07C,OAAP,EAAgB,UAAUm4B,MAAV,EAAkB11E,GAAlB,EAAuB;AACrC,cAAI21E,SAAS/zE,KAAK5B,GAAL,MAAc4B,KAAK5B,GAAL,IAAY,EAA1B,CAAb;;AAEA,eAAK,IAAIP,IAAI,CAAb,EAAgBA,IAAI,CAACi2E,UAAU,EAAX,EAAe/1E,MAAnC,EAA2CF,GAA3C,EAAgD;AAC9Ck2E,mBAAO1zE,IAAP,CAAYyzE,OAAOj2E,CAAP,CAAZ;AACD;AACF,SAND;AAOD;AA3Ba,KAvCI;AAoEpB,gBAAY;AACV6jB,aAAOiyD,WADG;AAEVH,eAASI,aAFC;AAGVH,kBAAYC;AAHF,KApEQ;AAyEpB,kBAAc;AACZH,kBAAY,KADA;AAEZD,YAAM,IAFM;AAGZ5xD,aAAO,iBAAY;AACjB,eAAO,KAAKuxD,KAAL,GAAa,KAAKA,KAAL,CAAWl1E,MAAX,GAAoB,KAAKo1E,QAAtC,GAAiD,CAAxD;AACD,OALW;AAMZK,eAAS,iBAAU1uD,GAAV,EAAe5gB,GAAf,EAAoB;AAC3B4gB,cAAMA,MAAM,KAAKouD,OAAjB;AACAhvE,cAAMA,OAAO,EAAb;AACA,YAAIZ,SAAS,KAAK6vE,QAAL,GAAgBruD,GAA7B;;AAEA,aAAK,IAAIjnB,IAAI,CAAb,EAAgBA,IAAI,KAAKs1E,QAAzB,EAAmCt1E,GAAnC,EAAwC;AACtCqG,cAAIrG,CAAJ,IAAS,KAAKo1E,KAAL,CAAW3vE,SAASzF,CAApB,CAAT;AACD;;AAED,eAAOqG,GAAP;AACD,OAhBW;AAiBZuvE,kBAAY,oBAAU93B,OAAV,EAAmB;AAC7B,aAAKs3B,KAAL,GAAat3B,OAAb;AACD,OAnBW;AAoBZ;AACAq4B,aAAO,iBAAY;AACjB;AACA,aAAKd,OAAL,IAAgB,KAAKxxD,KAAL,EAAhB;AACA,aAAKuxD,KAAL,GAAa,IAAb;AACD;AAzBW;AAzEM,GAAtB;;AAsGA,WAASU,WAAT,GAAuB;AACrB,WAAO,KAAKV,KAAL,CAAWl1E,MAAlB;AACD;;AAED,WAAS61E,aAAT,CAAuB9uD,GAAvB,EAA4B;AAC1B,WAAO,KAAKmuD,KAAL,CAAWnuD,GAAX,CAAP;AACD;;AAED,WAAS4uD,gBAAT,CAA0B/3B,OAA1B,EAAmC;AACjC,SAAK,IAAI99C,IAAI,CAAb,EAAgBA,IAAI89C,QAAQ59C,MAA5B,EAAoCF,GAApC,EAAyC;AACvC,WAAKo1E,KAAL,CAAW5yE,IAAX,CAAgBs7C,QAAQ99C,CAAR,CAAhB;AACD;AACF;;AAED,MAAIo2E,kBAAkB;AACpBC,eAAWC,iBADS;AAEpBC,gBAAY,oBAAUpnC,QAAV,EAAoBqB,SAApB,EAA+Bg2B,QAA/B,EAAyCC,OAAzC,EAAkD;AAC5D,aAAOD,YAAY,IAAZ,GAAmBr3B,SAASs3B,OAAT,CAAnB,GAAuCt3B,QAA9C;AACD,KAJmB;AAKpBqnC,kBAAcF,iBALM;AAMpBG,cAAU,kBAAUtnC,QAAV,EAAoBqB,SAApB,EAA+Bg2B,QAA/B,EAAyCC,OAAzC,EAAkD;AAC1D;AACA;AACA;AACA,UAAIhlE,QAAQytC,iBAAiBC,QAAjB,CAAZ;AACA,aAAOq3B,YAAY,IAAZ,IAAoB,EAAE/kE,iBAAiB/C,KAAnB,CAApB,GAAgD+C,KAAhD,GAAwDA,MAAM+kE,QAAN,CAA/D;AACD,KAZmB;AAapBkQ,gBAAYJ;AAbQ,GAAtB;;AAgBA,WAASA,iBAAT,CAA2BnnC,QAA3B,EAAqCqB,SAArC,EAAgDg2B,QAAhD,EAA0DC,OAA1D,EAAmE;AACjE,WAAOD,YAAY,IAAZ,GAAmBr3B,SAASq3B,QAAT,CAAnB,GAAwCr3B,QAA/C;AACD;;AAED,MAAIwnC,yBAAyB;AAC3BN,eAAWO,iBADgB;AAE3BL,gBAAY,oBAAUpnC,QAAV,EAAoBs3B,OAApB,EAA6Bj2B,SAA7B,EAAwCg2B,QAAxC,EAAkD;AAC5D,aAAOqQ,gBAAgB1nC,SAASs3B,OAAT,CAAhB,EAAmC,KAAKqQ,eAAL,CAAqBrQ,OAArB,CAAnC,CAAP;AACD,KAJ0B;AAK3B+P,kBAAcI,iBALa;AAM3BH,cAAU,kBAAUtnC,QAAV,EAAoBs3B,OAApB,EAA6Bj2B,SAA7B,EAAwCg2B,QAAxC,EAAkD;AAC1D;AACA;AACA;AACA;AACA,UAAI/kE,QAAQ0tC,aAAaA,SAAS1tC,KAAT,IAAkB,IAAlB,GAAyB0tC,QAAzB,GAAoCA,SAAS1tC,KAA1D,CAAZ,CAL0D,CAKoB;;AAE9E,UAAI,CAAC,KAAKs1E,QAAL,CAActB,IAAf,IAAuBrmC,iBAAiBD,QAAjB,CAA3B,EAAuD;AACrD,aAAK6nC,aAAL,GAAqB,IAArB;AACD;;AAED,aAAOH,gBAAgBp1E,iBAAiB/C,KAAjB,GAAyB+C,MAAM+kE,QAAN,CAAzB,CAAyC;AAAzC,QACrB/kE,KADK,EACE,KAAKq1E,eAAL,CAAqBrQ,OAArB,CADF,CAAP;AAED,KAnB0B;AAoB3BiQ,gBAAY,oBAAUvnC,QAAV,EAAoBs3B,OAApB,EAA6Bj2B,SAA7B,EAAwCg2B,QAAxC,EAAkD;AAC5D,aAAOr3B,SAASq3B,QAAT,CAAP;AACD;AAtB0B,GAA7B;;AAyBA,WAASoQ,iBAAT,CAA2BznC,QAA3B,EAAqCs3B,OAArC,EAA8Cj2B,SAA9C,EAAyDg2B,QAAzD,EAAmE;AACjE,WAAOqQ,gBAAgB1nC,SAASq3B,QAAT,CAAhB,EAAoC,KAAKsQ,eAAL,CAAqBrQ,OAArB,CAApC,CAAP;AACD;AACD;;;;;;;AAQA,WAASoQ,eAAT,CAAyBp1E,KAAzB,EAAgCw1E,OAAhC,EAAyC;AACvC;AACA,QAAIC,UAAUD,WAAWA,QAAQ7zE,IAAjC;;AAEA,QAAI8zE,YAAY,SAAhB,EAA2B;AACzB;AACA,UAAIC,cAAcF,WAAWA,QAAQE,WAArC;AACA,aAAOA,cAAcA,YAAYC,eAAZ,CAA4B31E,KAA5B,CAAd,GAAmDA,KAA1D;AACD;;AAED,QAAIy1E,YAAY,MAAZ,CAAmB;AAAnB,OACD,OAAOz1E,KAAP,KAAiB,QADhB,IAC4BA,SAAS,IADrC,IAC6CA,UAAU,GAD3D,EACgE;AAC9DA,cAAQ,CAACy2D,UAAUz2D,KAAV,CAAT;AACD,KAbsC,CAarC;AACF;AACA;;;AAGA,WAAOA,SAAS,IAAT,IAAiBA,UAAU,EAA3B,GAAgCy0D,GAAhC,CAAoC;AAC3C;AADO,MAEL,CAACz0D,KAFH;AAGD,GAt5oB2B,CAs5oB1B;AACF;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;AAQA,WAAS41E,gBAAT,CAA0Bl1E,IAA1B,EAAgCquC,SAAhC,EAA2Cw0B,GAA3C,EAAgD;AAC9C,QAAI,CAAC7iE,IAAL,EAAW;AACT;AACD,KAH6C,CAG5C;;;AAGF,QAAIgtC,WAAWhtC,KAAKm1E,cAAL,CAAoB9mC,SAApB,CAAf;;AAEA,QAAIrB,YAAY,IAAhB,EAAsB;AACpB;AACD;;AAED,QAAIk0B,eAAelhE,KAAKo1E,WAAL,GAAmBxT,SAAnB,GAA+BV,YAAlD;AACA,QAAIoD,OAAJ;AACA,QAAID,QAAJ;AACA,QAAIyQ,UAAU90E,KAAKq1E,gBAAL,CAAsBxS,GAAtB,CAAd;;AAEA,QAAIiS,OAAJ,EAAa;AACXxQ,gBAAUwQ,QAAQ13E,IAAlB;AACAinE,iBAAWyQ,QAAQ1+C,KAAnB;AACD;;AAED,WAAO69C,gBAAgB/S,YAAhB,EAA8Bl0B,QAA9B,EAAwCqB,SAAxC,EAAmDg2B,QAAnD,EAA6DC,OAA7D,CAAP;AACD;AACD;;;;;;;;;;;;;AAaA;;;;;;;;;;;;;;;;;;AAkBA,MAAIgR,sBAAsB,aAA1B,CA79oB4B,CA69oBa;;AAEzC,MAAIC,kBAAkB;AACpB;;;;;;AAMAC,mBAAe,uBAAUnnC,SAAV,EAAqBonC,QAArB,EAA+B;AAC5C,UAAIz1E,OAAO,KAAKuxE,OAAL,CAAakE,QAAb,CAAX;AACA,UAAIC,WAAW,KAAKC,WAAL,CAAiBtnC,SAAjB,EAA4BonC,QAA5B,CAAf;AACA,UAAIG,eAAe51E,KAAKyyE,WAAL,CAAiBpkC,SAAjB,CAAnB;AACA,UAAIjxC,OAAO4C,KAAK61E,OAAL,CAAaxnC,SAAb,CAAX;AACA,UAAIynC,UAAU91E,KAAKm1E,cAAL,CAAoB9mC,SAApB,CAAd;AACA,UAAI50B,QAAQzZ,KAAK+1E,aAAL,CAAmB1nC,SAAnB,EAA8B,OAA9B,CAAZ;AACA,aAAO;AACLuB,uBAAe,KAAKV,QADf;AAEL8mC,0BAAkB,KAAK3kC,OAFlB;AAGLgyB,oBAAY,KAAKn0B,QAAL,KAAkB,QAAlB,GAA6B,KAAKmC,OAAlC,GAA4C,IAHnD;AAIL22B,qBAAa,KAAKA,WAJb;AAKLgB,kBAAU,KAAK5nD,EALV;AAML6iD,oBAAY,KAAK7mE,IANZ;AAOLA,cAAMA,IAPD;AAQLixC,mBAAWunC,YARN;AASL51E,cAAM81E,OATD;AAULL,kBAAUA,QAVL;AAWLn2E,eAAOo2E,QAXF;AAYLj8D,eAAOA,KAZF;AAaLw8D,gBAAQ7d,iBAAiB3+C,KAAjB,CAbH;AAcL;AACAw+C,eAAO,CAAC,YAAD,EAAe,MAAf,EAAuB,OAAvB;AAfF,OAAP;AAiBD,KA/BmB;;AAiCpB;;;;;;;;;AASA5M,uBAAmB,2BAAUhd,SAAV,EAAqB6nC,MAArB,EAA6BT,QAA7B,EAAuCpR,QAAvC,EAAiD8R,SAAjD,EAA4D;AAC7ED,eAASA,UAAU,QAAnB;AACA,UAAIl2E,OAAO,KAAKuxE,OAAL,CAAakE,QAAb,CAAX;AACA,UAAIW,YAAYp2E,KAAKq2E,YAAL,CAAkBhoC,SAAlB,CAAhB;AACA,UAAIj2B,SAAS,KAAKo9D,aAAL,CAAmBnnC,SAAnB,EAA8BonC,QAA9B,CAAb;;AAEA,UAAIpR,YAAY,IAAZ,IAAoBjsD,OAAO9Y,KAAP,YAAwB/C,KAAhD,EAAuD;AACrD6b,eAAO9Y,KAAP,GAAe8Y,OAAO9Y,KAAP,CAAa+kE,QAAb,CAAf;AACD;;AAED,UAAIiS,YAAYF,UAAUrzE,GAAV,CAAcmzE,WAAW,QAAX,GAAsB,CAACC,aAAa,OAAd,EAAuB,WAAvB,CAAtB,GAA4D,CAACD,MAAD,EAASC,aAAa,OAAtB,EAA+B,WAA/B,CAA1E,CAAhB;;AAEA,UAAI,OAAOG,SAAP,KAAqB,UAAzB,EAAqC;AACnCl+D,eAAO89D,MAAP,GAAgBA,MAAhB;AACA,eAAOI,UAAUl+D,MAAV,CAAP;AACD,OAHD,MAGO,IAAI,OAAOk+D,SAAP,KAAqB,QAAzB,EAAmC;AACxC,YAAIj0E,MAAMu1D,UAAU0e,SAAV,EAAqBl+D,MAArB,CAAV,CADwC,CACA;AACxC;;AAEA,eAAO/V,IAAIC,OAAJ,CAAYgzE,mBAAZ,EAAiC,UAAU/lE,MAAV,EAAkBszD,GAAlB,EAAuB;AAC7D,cAAI/kE,MAAM+kE,IAAI9kE,MAAd;;AAEA,cAAI8kE,IAAIhsD,MAAJ,CAAW,CAAX,MAAkB,GAAlB,IAAyBgsD,IAAIhsD,MAAJ,CAAW/Y,MAAM,CAAjB,MAAwB,GAArD,EAA0D;AACxD+kE,kBAAM,CAACA,IAAIhmE,KAAJ,CAAU,CAAV,EAAaiB,MAAM,CAAnB,CAAP,CADwD,CAC1B;AAC/B;;AAED,iBAAOo3E,iBAAiBl1E,IAAjB,EAAuBquC,SAAvB,EAAkCw0B,GAAlC,CAAP;AACD,SARM,CAAP;AASD;AACF,KAvEmB;;AAyEpB;;;;;;AAMA8S,iBAAa,qBAAU7wD,GAAV,EAAe2wD,QAAf,EAAyB;AACpC,aAAOP,iBAAiB,KAAK3D,OAAL,CAAakE,QAAb,CAAjB,EAAyC3wD,GAAzC,CAAP;AACD,KAjFmB;;AAmFpB;;;;;;;AAOAyxD,mBAAe,yBAAY,CAAC;AAC3B;AA3FmB,GAAtB;;AA8FA;;;;;;;;;;;;;;;;;;AAkBA;;;;;AAKA,WAASC,UAAT,CAAoB38E,MAApB,EAA4B;AAC1B,WAAO,IAAI48E,IAAJ,CAAS58E,MAAT,CAAP;AACD;AACD;;;;;;;;;AASA,WAAS48E,IAAT,CAAc58E,MAAd,EAAsB;AACpBA,aAASA,UAAU,EAAnB;AACA,SAAK68E,MAAL,GAAc78E,OAAO88E,KAArB;AACA,SAAKC,KAAL,GAAa/8E,OAAOg9E,IAApB;AACA,SAAKC,MAAL,GAAcj9E,OAAO6nB,KAArB;AACA,SAAKq1D,QAAL,GAAgBl9E,OAAOm9E,OAAvB;AACA,SAAKC,MAAL,GAAc,IAAd,CANoB,CAMA;AACpB;;AAEA,SAAK72E,OAAL;AACD;;AAED,MAAI82E,YAAYT,KAAKr6E,SAArB;AACA;;;;;;;;AAQA86E,YAAUC,OAAV,GAAoB,UAAUC,WAAV,EAAuB;AACzC,QAAIC,SAAS,KAAKC,SAAlB;AACA,QAAIC,OAAOH,eAAeA,YAAYG,IAAtC,CAFyC,CAEG;AAC5C;AACA;;AAEA,QAAI,KAAKN,MAAL,IAAeI,MAAnB,EAA2B;AACzB,UAAIj3E,UAAU,KAAKA,OAAnB;AACAA,cAAQJ,IAAR,GAAeI,QAAQo3E,UAAR,GAAqBH,OAAOj3E,OAAP,CAAeo3E,UAAnD;AACD;;AAED,QAAI,KAAKC,UAAT,EAAqB;AACnB,WAAKA,UAAL,CAAgBC,WAAhB,GAA8B,IAA9B;AACD;;AAED,QAAIC,UAAJ;;AAEA,QAAI,KAAKf,KAAL,IAAc,CAACW,IAAnB,EAAyB;AACvBI,mBAAa,KAAKf,KAAL,CAAW,KAAKx2E,OAAhB,CAAb;AACD,KAnBwC,CAmBvC;AACF;;;AAGA,QAAIw3E,YAAYC,eAAe,KAAKC,MAApB,CAAhB;AACA,QAAIC,mBAAmB,KAAKC,aAAL,IAAsB,CAA7C;AACA,QAAIC,QAAQJ,eAAeT,eAAeA,YAAYa,KAA1C,CAAZ;AACA,QAAIC,eAAed,eAAeA,YAAYc,YAA3B,IAA2C,CAA9D;;AAEA,QAAIN,cAAcK,KAAd,IAAuBF,qBAAqBG,YAAhD,EAA8D;AAC5DP,mBAAa,OAAb;AACD;;AAED,aAASE,cAAT,CAAwB91E,GAAxB,EAA6B;AAC3B,QAAEA,OAAO,CAAT,MAAgBA,MAAM,CAAtB,EAD2B,CACD;;AAE1B,aAAOA,GAAP;AACD;;AAED,QAAIo2E,kBAAJ;;AAEA,QAAI,KAAKlB,MAAL,IAAeU,eAAe,OAAlC,EAA2C;AACzC,WAAKV,MAAL,GAAc,KAAd;AACAkB,2BAAqBxB,MAAM,IAAN,EAAYY,IAAZ,CAArB;AACD;;AAED,SAAKO,MAAL,GAAcG,KAAd;AACA,SAAKD,aAAL,GAAqBE,YAArB;AACA,QAAInkE,OAAOqjE,eAAeA,YAAYrjE,IAAtC;;AAEA,QAAIsjE,MAAJ,EAAY;AACV,WAAKe,OAAL,GAAef,OAAOgB,aAAtB;AACD,KAFD,CAEE;AAFF,SAGK;AACD,aAAKD,OAAL,GAAe,KAAKtB,MAAL,GAAc,KAAKA,MAAL,CAAY,KAAK12E,OAAjB,CAAd,GAA0Cu1C,QAAzD;AACD,OAtDsC,CAsDrC;AACJ;;;AAGA,QAAI,KAAK2iC,SAAT,EAAoB;AAClB,UAAI75D,QAAQ,KAAK85D,SAAjB;AACA,UAAI5hC,MAAMhyC,KAAKoB,GAAL,CAASgO,QAAQ,IAAR,GAAe,KAAKwkE,SAAL,GAAiBxkE,IAAhC,GAAuC4hC,QAAhD,EAA0D,KAAKyiC,OAA/D,CAAV;;AAEA,UAAI,CAACb,IAAD,KAAUY,sBAAsB15D,QAAQk4B,GAAxC,CAAJ,EAAkD;AAChD,YAAI6hC,WAAW,KAAKF,SAApB;;AAEA,YAAI15E,QAAQ45E,QAAR,CAAJ,EAAuB;AACrB,eAAK,IAAI36E,IAAI,CAAb,EAAgBA,IAAI26E,SAASz6E,MAA7B,EAAqCF,GAArC,EAA0C;AACxC46E,uBAAW,IAAX,EAAiBD,SAAS36E,CAAT,CAAjB,EAA8B4gB,KAA9B,EAAqCk4B,GAArC,EAA0CshC,KAA1C,EAAiDC,YAAjD;AACD;AACF,SAJD,MAIO;AACLO,qBAAW,IAAX,EAAiBD,QAAjB,EAA2B/5D,KAA3B,EAAkCk4B,GAAlC,EAAuCshC,KAAvC,EAA8CC,YAA9C;AACD;AACF;;AAED,WAAKK,SAAL,GAAiB5hC,GAAjB,CAhBkB,CAgBI;AACtB;;AAEA,UAAI+hC,eAAe,KAAKC,gBAAL,IAAyB,IAAzB,GAAgC,KAAKA,gBAArC,GAAwDhiC,GAA3E;AACA,WAAK0hC,aAAL,GAAqBK,YAArB;AACD,KArBD,MAqBO;AACL;AACA;AACA;AACA,WAAKH,SAAL,GAAiB,KAAKF,aAAL,GAAqB,KAAKM,gBAAL,IAAyB,IAAzB,GAAgC,KAAKA,gBAArC,GAAwD,KAAKP,OAAnG;AACD;;AAED,WAAO,KAAKQ,UAAL,EAAP;AACD,GAvFD;;AAyFA,MAAIC,WAAW,YAAY;AACzB,QAAIliC,GAAJ;AACA,QAAImiC,OAAJ;AACA,QAAIb,KAAJ;AACA,QAAIC,YAAJ;AACA,QAAIa,QAAJ;AACA,QAAIC,KAAK;AACPrC,aAAO,eAAUxxE,CAAV,EAAaoB,CAAb,EAAgB0yE,KAAhB,EAAuBC,MAAvB,EAA+B;AACpCJ,kBAAU3zE,CAAV;AACAwxC,cAAMpwC,CAAN;AACA0xE,gBAAQgB,KAAR;AACAf,uBAAegB,MAAf;AACAH,mBAAWp0E,KAAKyV,IAAL,CAAU89D,eAAeD,KAAzB,CAAX;AACAe,WAAGxjE,IAAH,GAAUyiE,QAAQ,CAAR,IAAaC,eAAe,CAA5B,GAAgCiB,OAAhC,GAA0CC,cAApD;AACD;AARM,KAAT;AAUA,WAAOJ,EAAP;;AAEA,aAASI,cAAT,GAA0B;AACxB,aAAON,UAAUniC,GAAV,GAAgBmiC,SAAhB,GAA4B,IAAnC;AACD;;AAED,aAASK,OAAT,GAAmB;AACjB,UAAI9qC,YAAYyqC,UAAUC,QAAV,GAAqBd,KAArB,GAA6BtzE,KAAKyV,IAAL,CAAU0+D,UAAUC,QAApB,CAA7C;AACA,UAAIt7E,SAASq7E,WAAWniC,GAAX,GAAiB,IAAjB,GAAwBtI,YAAY6pC,YAAZ,GAA2B7pC,SAA3B,CAAqC;AAC1E;AADqC,QAEnCyqC,OAFF;AAGAA;AACA,aAAOr7E,MAAP;AACD;AACF,GA9Bc,EAAf;;AAgCAy5E,YAAU71D,KAAV,GAAkB,YAAY;AAC5B,SAAK41D,MAAL,GAAc,IAAd;AACA,SAAKF,QAAL,IAAiB,KAAKA,QAAL,CAAc,KAAK32E,OAAnB,CAAjB;AACD,GAHD;;AAKA,WAASq4E,UAAT,CAAoBY,OAApB,EAA6Bb,QAA7B,EAAuC/5D,KAAvC,EAA8Ck4B,GAA9C,EAAmDshC,KAAnD,EAA0DC,YAA1D,EAAwE;AACtEW,aAASlC,KAAT,CAAel4D,KAAf,EAAsBk4B,GAAtB,EAA2BshC,KAA3B,EAAkCC,YAAlC;AACAmB,YAAQC,gBAAR,GAA2Bd,QAA3B;;AAEAa,YAAQC,gBAAR,CAAyB;AACvB76D,aAAOA,KADgB;AAEvBk4B,WAAKA,GAFkB;AAGvBj1B,aAAOi1B,MAAMl4B,KAHU;AAIvBjJ,YAAMqjE,SAASrjE;AAJQ,KAAzB,EAKG6jE,QAAQj5E,OALX;AAMD;;AAED,WAASu2E,KAAT,CAAe0C,OAAf,EAAwB9B,IAAxB,EAA8B;AAC5B8B,YAAQd,SAAR,GAAoBc,QAAQhB,aAAR,GAAwBgB,QAAQjB,OAAR,GAAkB,CAA9D;AACAiB,YAAQV,gBAAR,GAA2B,IAA3B;AACA,QAAIH,QAAJ;AACA,QAAIL,kBAAJ;;AAEA,QAAI,CAACZ,IAAD,IAAS8B,QAAQ3C,MAArB,EAA6B;AAC3B8B,iBAAWa,QAAQ3C,MAAR,CAAe2C,QAAQj5E,OAAvB,CAAX;;AAEA,UAAIo4E,YAAYA,SAASA,QAAzB,EAAmC;AACjCL,6BAAqBK,SAASL,kBAA9B;AACAK,mBAAWA,SAASA,QAApB;AACD,OAN0B,CAMzB;;;AAGF,UAAI55E,QAAQ45E,QAAR,KAAqB,CAACA,SAASz6E,MAAnC,EAA2C;AACzCy6E,mBAAW,IAAX;AACD;AACF;;AAEDa,YAAQf,SAAR,GAAoBE,QAApB;AACAa,YAAQvB,MAAR,GAAiBuB,QAAQrB,aAAR,GAAwB,IAAzC;AACA,QAAIuB,aAAaF,QAAQG,WAAzB;AACAD,kBAAcA,WAAWl4D,KAAX,EAAd;AACA,WAAO82D,kBAAP;AACD;AACD;;;;AAKAjB,YAAU0B,UAAV,GAAuB,YAAY;AACjC,WAAO,KAAKN,SAAL,IAAkB,KAAKC,SAAL,GAAiB,KAAKH,OAA/C;AACD,GAFD;AAGA;;;;;AAMAlB,YAAUuC,IAAV,GAAiB,UAAUC,QAAV,EAAoB;AACnC;AACA,QAAI,KAAKF,WAAL,KAAqBE,QAArB,IAAiC,KAAKzC,MAA1C,EAAkD;AAChD,WAAKuC,WAAL,GAAmBE,QAAnB;AACAA,eAASpC,SAAT,GAAqB,IAArB;AACAoC,eAASr4D,KAAT;AACD;AACF,GAPD;;AASA61D,YAAUvtE,OAAV,GAAoB,YAAY;AAC9B,QAAI,KAAKgwE,SAAT,EAAoB;AAClB;AACD;;AAED,SAAKrC,SAAL,KAAmB,KAAKA,SAAL,CAAekC,WAAf,GAA6B,IAAhD;AACA,SAAKA,WAAL,KAAqB,KAAKA,WAAL,CAAiBlC,SAAjB,GAA6B,IAAlD;AACA,SAAKL,MAAL,GAAc,KAAd;AACA,SAAK0C,SAAL,GAAiB,IAAjB;AACD,GATD;;AAWAzC,YAAU0C,WAAV,GAAwB,YAAY;AAClC,WAAO,KAAKtC,SAAZ;AACD,GAFD;;AAIAJ,YAAU2C,aAAV,GAA0B,YAAY;AACpC,WAAO,KAAKL,WAAZ;AACD,GAFD;;AAIAtC,YAAU4C,YAAV,GAAyB,UAAUnjC,GAAV,EAAe;AACtC;AACA;AACA;AACA;AACA;AACA,SAAK0hC,aAAL,GAAqB,KAAKM,gBAAL,GAAwBhiC,GAA7C;AACD,GAPD,CAn0pB4B,CA00pBzB;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;;;;;;;;AAkBA,MAAIojC,UAAUvrC,WAAd;AACA,MAAIwrC,cAAcpe,eAAe58D,MAAf,CAAsB;AACtCiC,UAAM,iBADgC;;AAGtC;;;AAGA+mE,iBAAa,CANyB;AAOtC;AACAiS,sBAAkB,IARoB;;AAUtC;;;;AAIAne,mBAAe,IAduB;;AAgBtC;;;;AAIA;AACAoe,wBAAoB,IArBkB;;AAuBtC;;;AAGAC,2BAAuB,iBA1Be;;AA4BtC;;;;;;AAMAle,gBAAY,IAlC0B;AAmCtC9vB,UAAM,cAAUoB,MAAV,EAAkBsf,WAAlB,EAA+Bhe,OAA/B,EAAwCqtB,QAAxC,EAAkD;AACtD;;;;AAIA,WAAK8L,WAAL,GAAmB,KAAKnM,cAAxB;AACA,WAAKue,QAAL,GAAgB5D,WAAW;AACzB90D,eAAO24D,aADkB;AAEzB1D,eAAO2D;AAFkB,OAAX,CAAhB;AAIA,WAAKF,QAAL,CAAch6E,OAAd,GAAwB;AACtB8xC,eAAO;AADe,OAAxB;AAGA,WAAKiqB,oBAAL,CAA0B5uB,MAA1B,EAAkCsB,OAAlC;AACAkzB,oBAAc,IAAd;AACA,UAAI/hE,OAAO,KAAKu6E,cAAL,CAAoBhtC,MAApB,EAA4BsB,OAA5B,CAAX;AACA2rC,eAASx6E,IAAT,EAAe,IAAf;AACA,WAAKo6E,QAAL,CAAch6E,OAAd,CAAsBJ,IAAtB,GAA6BA,IAA7B;;AAEA;;;;AAIA+5E,cAAQ,IAAR,EAAcU,mBAAd,GAAoCz6E,IAApC,CAvBsD,CAuBZ;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA06E,qBAAe,IAAf;AACD,KAtEqC;;AAwEtC;;;;;AAKAve,0BAAsB,8BAAU5uB,MAAV,EAAkBsB,OAAlB,EAA2B;AAC/C,UAAIotB,aAAa,KAAKA,UAAtB;AACA,UAAIG,sBAAsBH,aAAaV,gBAAgBhuB,MAAhB,CAAb,GAAuC,EAAjE,CAF+C,CAEsB;AACrE;AACA;AACA;;AAEA,UAAIotC,eAAe,KAAKtpC,OAAxB;;AAEA,UAAIuqB,eAAenqB,QAAf,CAAwBkpC,YAAxB,CAAJ,EAA2C;AACzCA,wBAAgB,QAAhB;AACD;;AAEDr8E,YAAMivC,MAAN,EAAcsB,QAAQytB,QAAR,GAAmBv5D,GAAnB,CAAuB,KAAKsuC,OAA5B,CAAd;AACA/yC,YAAMivC,MAAN,EAAc,KAAKgvB,gBAAL,EAAd,EAd+C,CAcP;;AAExC9vB,sBAAgBc,MAAhB,EAAwB,OAAxB,EAAiC,CAAC,MAAD,CAAjC;AACA,WAAKqtC,iBAAL,CAAuBrtC,OAAOvtC,IAA9B;;AAEA,UAAIi8D,UAAJ,EAAgB;AACd1B,yBAAiBhtB,MAAjB,EAAyB6uB,mBAAzB,EAA8CH,UAA9C;AACD;AACF,KAnGqC;AAoGtC1L,iBAAa,qBAAUsqB,eAAV,EAA2BhsC,OAA3B,EAAoC;AAC/C;AACAgsC,wBAAkBv8E,MAAM,KAAKivC,MAAX,EAAmBstC,eAAnB,EAAoC,IAApC,CAAlB;AACA,WAAKD,iBAAL,CAAuBC,gBAAgB76E,IAAvC;AACA,UAAIi8D,aAAa,KAAKA,UAAtB;;AAEA,UAAIA,UAAJ,EAAgB;AACd1B,yBAAiB,KAAKhtB,MAAtB,EAA8BstC,eAA9B,EAA+C5e,UAA/C;AACD;;AAED8F,oBAAc,IAAd;AACA,UAAI/hE,OAAO,KAAKu6E,cAAL,CAAoBM,eAApB,EAAqChsC,OAArC,CAAX;AACA2rC,eAASx6E,IAAT,EAAe,IAAf;AACA,WAAKo6E,QAAL,CAAc/4D,KAAd;AACA,WAAK+4D,QAAL,CAAch6E,OAAd,CAAsBJ,IAAtB,GAA6BA,IAA7B;AACA+5E,cAAQ,IAAR,EAAcU,mBAAd,GAAoCz6E,IAApC;AACA06E,qBAAe,IAAf;AACD,KArHqC;AAsHtCE,uBAAmB,2BAAU56E,IAAV,EAAgB;AACjC;AACA;AACA;AACA,UAAIA,QAAQ,CAACkB,aAAalB,IAAb,CAAb,EAAiC;AAC/B,YAAIsf,QAAQ,CAAC,MAAD,CAAZ;;AAEA,aAAK,IAAIzhB,IAAI,CAAb,EAAgBA,IAAImC,KAAKjC,MAAzB,EAAiCF,GAAjC,EAAsC;AACpC,cAAImC,KAAKnC,CAAL,KAAWmC,KAAKnC,CAAL,EAAQi9E,KAAvB,EAA8B;AAC5BruC,4BAAgBzsC,KAAKnC,CAAL,CAAhB,EAAyB,OAAzB,EAAkCyhB,KAAlC;AACD;AACF;AACF;AACF,KAnIqC;;AAqItC;;;;AAIAi7D,oBAAgB,0BAAY,CAAE,CAzIQ;;AA2ItC;;;;;AAKA9G,gBAAY,oBAAUr7D,MAAV,EAAkB;AAC5B;AACA;AACA;AACA,UAAIpY,OAAO,KAAK+6E,UAAL,EAAX;AACA/6E,WAAKyzE,UAAL,CAAgBr7D,OAAOpY,IAAvB;AACD,KAtJqC;;AAwJtC;;;;;;;;AAQAuxE,aAAS,iBAAUkE,QAAV,EAAoB;AAC3B,UAAIuF,OAAOC,eAAe,IAAf,CAAX;;AAEA,UAAID,IAAJ,EAAU;AACR,YAAIh7E,OAAOg7E,KAAK56E,OAAL,CAAaJ,IAAxB;AACA,eAAOy1E,YAAY,IAAZ,GAAmBz1E,IAAnB,GAA0BA,KAAKk7E,aAAL,CAAmBzF,QAAnB,CAAjC;AACD,OAHD,MAGO;AACL;AACA;AACA;AACA;AACA,eAAOsE,QAAQ,IAAR,EAAc/5E,IAArB;AACD;AACF,KA7KqC;;AA+KtC;;;AAGAm7C,aAAS,iBAAUn7C,IAAV,EAAgB;AACvB,UAAIg7E,OAAOC,eAAe,IAAf,CAAX;;AAEA,UAAID,IAAJ,EAAU;AACR,YAAI56E,UAAU46E,KAAK56E,OAAnB,CADQ,CACoB;;AAE5B,YAAIA,QAAQJ,IAAR,KAAiBA,IAAjB,IAAyBg7E,KAAKG,eAAlC,EAAmD;AACjDH,eAAKlB,YAAL,CAAkB95E,KAAK0hB,KAAL,EAAlB;AACD;;AAEDthB,gBAAQo3E,UAAR,GAAqBx3E,IAArB,CAPQ,CAOmB;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,YAAIg7E,SAAS,KAAKZ,QAAlB,EAA4B;AAC1Bh6E,kBAAQJ,IAAR,GAAeA,IAAf;AACD;AACF;;AAED+5E,cAAQ,IAAR,EAAc/5E,IAAd,GAAqBA,IAArB;AACD,KA3MqC;;AA6MtC;;;;AAIA4hE,eAAW,qBAAY;AACrB,aAAOA,WAAU,IAAV,CAAP;AACD,KAnNqC;;AAqNtC;;;;AAIAmZ,gBAAY,sBAAY;AACtB,aAAOhB,QAAQ,IAAR,EAAcU,mBAArB;AACD,KA3NqC;;AA6NtC;;;;;;AAMAW,iBAAa,uBAAY;AACvB,UAAIpR,WAAW,KAAKiQ,gBAApB;AACA,aAAOjQ,YAAYA,SAASoR,WAArB,IAAoCpR,SAASoR,WAAT,EAA3C;AACD,KAtOqC;AAuOtC;;AAEA;;;;;;;AAOA7E,mBAAe,uBAAUloC,SAAV,EAAqBgtC,cAArB,EAAqC5F,QAArC,EAA+C;AAC5D,eAAS6F,gBAAT,CAA0Bh8E,KAA1B,EAAiC;AAC/B;AACA;AACA,YAAIi8E,YAAYt+E,OAAOqC,KAAP,EAAc,UAAUi8E,SAAV,EAAqBx5E,GAArB,EAA0B+iB,GAA1B,EAA+B;AAC3D,cAAI02D,UAAUx7E,KAAKq1E,gBAAL,CAAsBvwD,GAAtB,CAAd;AACA,iBAAOy2D,aAAaC,WAAWA,QAAQ/K,OAAR,KAAoB,KAA/B,IAAwC+K,QAAQzY,WAAR,IAAuB,IAAnF;AACD,SAHe,EAGb,CAHa,CAAhB;AAIA,YAAItlE,SAAS,EAAb;AACAg+E,oBAAY19E,MAAZ,GAAqBkC,OAAOw7E,WAAP,EAAoB,UAAU5Y,GAAV,EAAe;AACtD6Y,sBAAYxG,iBAAiBl1E,IAAjB,EAAuBquC,SAAvB,EAAkCw0B,GAAlC,CAAZ,EAAoDA,GAApD;AACD,SAFoB,CAArB,CAEG;AAFH,UAGE5iE,OAAOX,KAAP,EAAco8E,WAAd,CAHF;;AAKA,iBAASA,WAAT,CAAqB35E,GAArB,EAA0B8gE,GAA1B,EAA+B;AAC7B,cAAIiS,UAAU90E,KAAKq1E,gBAAL,CAAsBxS,GAAtB,CAAd,CAD6B,CACa;;AAE1C,cAAI,CAACiS,OAAD,IAAYA,QAAQ6G,SAAR,CAAkBlL,OAAlB,KAA8B,KAA9C,EAAqD;AACnD;AACD;;AAED,cAAIsE,UAAUD,QAAQ7zE,IAAtB;AACA,cAAI26E,UAAUxjB,iBAAiB;AAC7B3+C,mBAAOA,KADsB;AAE7BxY,kBAAM;AAFuB,WAAjB,CAAd;AAIA,cAAI46E,SAAS,CAACN,YAAYK,UAAUrkB,WAAWud,QAAQ/R,WAAR,IAAuB,GAAlC,CAAV,GAAmD,IAA/D,GAAsE,EAAvE,IAA6E;AAC1FxL,qBAAWwd,YAAY,SAAZ,GAAwBhzE,MAAM,EAA9B,GAAmCgzE,YAAY,MAAZ,GAAqBsG,iBAAiB,EAAjB,GAAsB9iB,WAAW,qBAAX,EAAkCx2D,GAAlC,CAA3C,GAAoFi1D,UAAUj1D,GAAV,CAAlI,CADA;AAEA85E,oBAAUp+E,OAAO4C,IAAP,CAAYw7E,MAAZ,CAAV;AACD;;AAED,eAAO,CAACN,YAAY,OAAZ,GAAsB,EAAvB,IAA6B99E,OAAOmf,IAAP,CAAY2+D,YAAY,OAAZ,GAAsB,IAAlC,CAApC;AACD;;AAED,eAASO,iBAAT,CAA2B/5E,GAA3B,EAAgC;AAC9B,eAAOw1D,WAAWP,UAAUj1D,GAAV,CAAX,CAAP;AACD;;AAED,UAAI/B,OAAO,KAAKuxE,OAAL,EAAX;AACA,UAAIkK,cAAcz7E,KAAK+7E,YAAL,CAAkB,kBAAlB,EAAsC,IAAtC,CAAlB;AACA,UAAIC,gBAAgBP,YAAY19E,MAAhC;AACA,UAAIuB,QAAQ,KAAKq2E,WAAL,CAAiBtnC,SAAjB,CAAZ;AACA,UAAI4tC,aAAar9E,QAAQU,KAAR,CAAjB;AACA,UAAIma,QAAQzZ,KAAK+1E,aAAL,CAAmB1nC,SAAnB,EAA8B,OAA9B,CAAZ;;AAEA,UAAI5vC,WAAWgb,KAAX,KAAqBA,MAAM8V,UAA/B,EAA2C;AACzC9V,gBAAQ,CAACA,MAAM8V,UAAN,CAAiB,CAAjB,KAAuB,EAAxB,EAA4B9V,KAApC;AACD;;AAEDA,cAAQA,SAAS,aAAjB,CAjD4D,CAiD5B;;AAEhC,UAAIyiE,iBAAiBF,gBAAgB,CAAhB,IAAqBC,cAAc,CAACD,aAApC,GAAoDV,iBAAiBh8E,KAAjB,CAApD,GAA8E08E,gBAAgBF,kBAAkB5G,iBAAiBl1E,IAAjB,EAAuBquC,SAAvB,EAAkCotC,YAAY,CAAZ,CAAlC,CAAlB,CAAhB,GAAuFK,kBAAkBG,aAAa38E,MAAM,CAAN,CAAb,GAAwBA,KAA1C,CAA1L;AACA,UAAI68E,UAAU/jB,iBAAiB3+C,KAAjB,CAAd;AACA,UAAIrc,OAAO4C,KAAK61E,OAAL,CAAaxnC,SAAb,CAAX;AACA,UAAI41B,aAAa,KAAK7mE,IAAtB;;AAEA,UAAI,CAAC4wC,gBAAgB,IAAhB,CAAL,EAA4B;AAC1Bi2B,qBAAa,EAAb;AACD;;AAEDA,mBAAaA,aAAa1M,WAAW0M,UAAX,KAA0B,CAACoX,cAAD,GAAkB,OAAlB,GAA4B,IAAtD,CAAb,GAA2E,EAAxF;AACA,aAAO,CAACA,cAAD,GAAkBpX,aAAakY,OAAb,IAAwB/+E,OAAOm6D,WAAWn6D,IAAX,IAAmB,IAAnB,GAA0B8+E,cAAjC,GAAkDA,cAA1E,CAAlB,GAA8GC,UAAUlY,UAAV,GAAuBiY,cAA5I;AACD,KA9SqC;;AAgTtC;;;AAGAxuB,wBAAoB,8BAAY;AAC9B,UAAIxyD,MAAMX,IAAV,EAAgB;AACd,eAAO,KAAP;AACD;;AAED,UAAIkzD,mBAAmB,KAAKpb,UAAL,CAAgB,WAAhB,CAAvB;;AAEA,UAAIob,gBAAJ,EAAsB;AACpB,YAAI,KAAK8jB,OAAL,GAAe7vD,KAAf,KAAyB,KAAK2wB,UAAL,CAAgB,oBAAhB,CAA7B,EAAoE;AAClEob,6BAAmB,KAAnB;AACD;AACF;;AAED,aAAOA,gBAAP;AACD,KAjUqC;AAkUtCqD,iBAAa,uBAAY;AACvB,WAAKspB,QAAL,CAAc/4D,KAAd;AACD,KApUqC;AAqUtCi9C,yBAAqB,6BAAUlhE,IAAV,EAAgBqjC,KAAhB,EAAuBu9B,eAAvB,EAAwC;AAC3D,UAAInvB,UAAU,KAAKA,OAAnB,CAD2D,CAC/B;;AAE5B,UAAIp1B,QAAQykD,kBAAkBI,mBAAlB,CAAsC3gE,IAAtC,CAA2C,IAA3C,EAAiDP,IAAjD,EAAuDqjC,KAAvD,EAA8Du9B,eAA9D,CAAZ;;AAEA,UAAI,CAACvkD,KAAL,EAAY;AACVA,gBAAQo1B,QAAQyvB,mBAAR,CAA4BlhE,IAA5B,EAAkCqjC,KAAlC,EAAyCu9B,eAAzC,CAAR;AACD;;AAED,aAAOvkD,KAAP;AACD,KA/UqC;;AAiVtC;;;;AAIA2iE,uBAAmB,2BAAUzY,QAAV,EAAoB;AACrC,aAAO,KAAKoX,UAAL,GAAkBgB,YAAlB,CAA+BpY,QAA/B,EAAyC,IAAzC,CAAP;AACD,KAvVqC;;AAyVtC;;;;AAIA0Y,oBAAgB,0BAAY;AAC1B,aAAO,KAAKt5E,GAAL,CAAS,aAAT,CAAP;AACD,KA/VqC;;AAiWtC;;;;AAIAu5E,6BAAyB,mCAAY;AACnC,aAAO,KAAKv5E,GAAL,CAAS,sBAAT,CAAP;AACD,KAvWqC;;AAyWtC;;;;;;;;AAQAw5E,wBAAoB,IAjXkB;;AAmXtC;;;;;;AAMAC,wBAAoB,IAzXkB;;AA2XtC;;;AAGAC,cAAU,IA9X4B;;AAgYtC;;;;;AAKAC,wBAAoB,IArYkB;;AAuYtC;;;;;AAKAC,qBAAiB;AA5YqB,GAAtB,CAAlB;AA8YA78E,QAAMk6E,WAAN,EAAmBzE,eAAnB;AACAz1E,QAAMk6E,WAAN,EAAmB9b,iBAAnB;AACA;;;;;;AAMA,WAASwc,cAAT,CAAwB9b,WAAxB,EAAqC;AACnC;AACA;AACA,QAAIxhE,OAAOwhE,YAAYxhE,IAAvB;;AAEA,QAAI,CAAC4wC,gBAAgB4wB,WAAhB,CAAL,EAAmC;AACjCA,kBAAYxhE,IAAZ,GAAmBw/E,kBAAkBhe,WAAlB,KAAkCxhE,IAArD;AACD;AACF;;AAED,WAASw/E,iBAAT,CAA2Bhe,WAA3B,EAAwC;AACtC,QAAI5+D,OAAO4+D,YAAYmc,UAAZ,EAAX;AACA,QAAI8B,WAAW78E,KAAK+7E,YAAL,CAAkB,YAAlB,EAAgC,IAAhC,CAAf;AACA,QAAIe,UAAU,EAAd;AACA78E,WAAO48E,QAAP,EAAiB,UAAUjZ,OAAV,EAAmB;AAClC,UAAIkR,UAAU90E,KAAKq1E,gBAAL,CAAsBzR,OAAtB,CAAd;AACAkR,cAAQ/R,WAAR,IAAuB+Z,QAAQz8E,IAAR,CAAay0E,QAAQ/R,WAArB,CAAvB;AACD,KAHD;AAIA,WAAO+Z,QAAQlgE,IAAR,CAAa,GAAb,CAAP;AACD;;AAED,WAASy9D,aAAT,CAAuBj6E,OAAvB,EAAgC;AAC9B,WAAOA,QAAQ8xC,KAAR,CAAc6oC,UAAd,GAA2Br5D,KAA3B,EAAP;AACD;;AAED,WAAS44D,aAAT,CAAuBl6E,OAAvB,EAAgC;AAC9B,QAAIw+D,cAAcx+D,QAAQ8xC,KAA1B;AACA0sB,gBAAYzjB,OAAZ,CAAoByjB,YAAYmc,UAAZ,GAAyBgC,YAAzB,EAApB;AACA,WAAOC,gBAAP;AACD;;AAED,WAASA,gBAAT,CAA0B/1E,KAA1B,EAAiC7G,OAAjC,EAA0C;AACxC;AACA,QAAI6G,MAAM0vC,GAAN,GAAYv2C,QAAQo3E,UAAR,CAAmB91D,KAAnB,EAAhB,EAA4C;AAC1CthB,cAAQ8xC,KAAR,CAAc6oC,UAAd,GAA2BgC,YAA3B,CAAwC38E,QAAQo3E,UAAhD;AACD;AACF,GAn0qB2B,CAm0qB1B;;;AAGF,WAASgD,QAAT,CAAkBx6E,IAAlB,EAAwB4+D,WAAxB,EAAqC;AACnC3+D,WAAOD,KAAKi9E,iBAAZ,EAA+B,UAAUrsC,UAAV,EAAsB;AACnD5wC,WAAKk9E,UAAL,CAAgBtsC,UAAhB,EAA4B9vC,MAAMq8E,gBAAN,EAAwBve,WAAxB,CAA5B;AACD,KAFD;AAGD;;AAED,WAASue,gBAAT,CAA0Bve,WAA1B,EAAuC;AACrC,QAAIoc,OAAOC,eAAerc,WAAf,CAAX;;AAEA,QAAIoc,IAAJ,EAAU;AACR;AACAA,WAAKlB,YAAL,CAAkB,KAAKp4D,KAAL,EAAlB;AACD;AACF;;AAED,WAASu5D,cAAT,CAAwBrc,WAAxB,EAAqC;AACnC,QAAIwe,YAAY,CAACxe,YAAY/vB,OAAZ,IAAuB,EAAxB,EAA4BuuC,SAA5C;AACA,QAAIC,WAAWD,aAAaA,UAAUE,WAAV,CAAsB1e,YAAY5C,GAAlC,CAA5B;;AAEA,QAAIqhB,QAAJ,EAAc;AACZ;AACA;AACA,UAAIrC,OAAOqC,SAAS3F,WAApB;;AAEA,UAAIsD,IAAJ,EAAU;AACR,YAAIuC,eAAevC,KAAKuC,YAAxB;;AAEA,YAAIA,YAAJ,EAAkB;AAChBvC,iBAAOuC,aAAax6E,GAAb,CAAiB67D,YAAY5C,GAA7B,CAAP;AACD;AACF;;AAED,aAAOgf,IAAP;AACD;AACF;;AAED;;;;;;;;;;;;;;;;;;AAkBA,MAAIwC,cAAc,SAAdA,WAAc,GAAY;AAC5B;;;;AAIA,SAAKrkB,KAAL,GAAa,IAAI30C,KAAJ,EAAb;AACA;;;;;AAKA,SAAKw3C,GAAL,GAAW5K,OAAO,eAAP,CAAX;AACD,GAZD;;AAcAosB,cAAYphF,SAAZ,GAAwB;AACtB6B,iBAAau/E,WADS;AAEtBrxC,UAAM,cAAU0C,OAAV,EAAmBg7B,GAAnB,EAAwB,CAAE,CAFV;AAGtB4T,YAAQ,gBAAUxvC,cAAV,EAA0BY,OAA1B,EAAmCg7B,GAAnC,EAAwC17B,OAAxC,EAAiD,CAAE,CAHrC;AAItBxkC,aAAS,mBAAY,CAAE;AAJD,GAAxB;AAMA,MAAI+zE,iBAAiBF,YAAYphF,SAAjC;;AAEAshF,iBAAeC,UAAf,GAA4BD,eAAeE,YAAf,GAA8BF,eAAeG,YAAf,GAA8B,UAAUjf,WAAV,EAAuB/vB,OAAvB,EAAgCg7B,GAAhC,EAAqC17B,OAArC,EAA8C,CAAC;AACtI,GADD,CAl5qB4B,CAm5qBzB;;;AAGH4B,oBAAkBytC,WAAlB,EAt5qB4B,CAs5qBI;;AAEhC3sC,wBAAsB2sC,WAAtB,EAAmC;AACjC1rC,wBAAoB;AADa,GAAnC;;AAIA;;;;;;;;;;;;;;;;;;AAkBA;;;;AAIA,MAAIgsC,sBAAsB,SAAtBA,mBAAsB,GAAY;AACpC,QAAIztB,QAAQ7hB,WAAZ;AACA,WAAO,UAAUowB,WAAV,EAAuB;AAC5B,UAAIjC,SAAStM,MAAMuO,WAAN,CAAb;AACA,UAAI+d,kBAAkB/d,YAAY+d,eAAlC;AACA,UAAIoB,gBAAgBphB,OAAOqhB,KAA3B;AACA,UAAIC,sBAAsBthB,OAAOuhB,iBAAjC;AACA,UAAIF,QAAQrhB,OAAOqhB,KAAP,GAAerB,gBAAgBqB,KAA3C;AACA,UAAIliD,cAAc6gC,OAAOuhB,iBAAP,GAA2BvB,gBAAgBuB,iBAA7D;AACA,aAAO,CAAC,EAAEH,gBAAgBC,KAAhB,IAAyBC,sBAAsBniD,WAAjD,CAAD,IAAkE,OAAzE;AACD,KARD;AASD,GAXD;;AAaA;;;;;;;;;;;;;;;;;;AAkBA,MAAIqiD,UAAU3vC,WAAd;AACA,MAAI4vC,gBAAgBN,qBAApB;;AAEA,WAASO,KAAT,GAAiB;AACf;;;;AAIA,SAAKllB,KAAL,GAAa,IAAI30C,KAAJ,EAAb;AACA;;;;;AAKA,SAAKw3C,GAAL,GAAW5K,OAAO,WAAP,CAAX;AACA,SAAKktB,UAAL,GAAkB9H,WAAW;AAC3BK,YAAM0H,cADqB;AAE3B5H,aAAO6H;AAFoB,KAAX,CAAlB;AAIA,SAAKF,UAAL,CAAgBl+E,OAAhB,GAA0B;AACxBq+E,YAAM;AADkB,KAA1B;AAGD;;AAEDJ,QAAMjiF,SAAN,GAAkB;AAChB6E,UAAM,OADU;;AAGhB;;;;;AAKAkrC,UAAM,cAAU0C,OAAV,EAAmBg7B,GAAnB,EAAwB,CAAE,CARhB;;AAUhB;;;;;;;AAOA4T,YAAQ,gBAAU7e,WAAV,EAAuB/vB,OAAvB,EAAgCg7B,GAAhC,EAAqC17B,OAArC,EAA8C,CAAE,CAjBxC;;AAmBhB;;;;;;;AAOAuwC,eAAW,mBAAU9f,WAAV,EAAuB/vB,OAAvB,EAAgCg7B,GAAhC,EAAqC17B,OAArC,EAA8C;AACvDwwC,sBAAgB/f,YAAY2S,OAAZ,EAAhB,EAAuCpjC,OAAvC,EAAgD,UAAhD;AACD,KA5Be;;AA8BhB;;;;;;;AAOAywC,cAAU,kBAAUhgB,WAAV,EAAuB/vB,OAAvB,EAAgCg7B,GAAhC,EAAqC17B,OAArC,EAA8C;AACtDwwC,sBAAgB/f,YAAY2S,OAAZ,EAAhB,EAAuCpjC,OAAvC,EAAgD,QAAhD;AACD,KAvCe;;AAyChB;;;;;AAKAz4B,YAAQ,gBAAUm5B,OAAV,EAAmBg7B,GAAnB,EAAwB;AAC9B,WAAK1Q,KAAL,CAAW1zC,SAAX;AACD,KAhDe;;AAkDhB;;;;;AAKA9b,aAAS,mBAAY,CAAE,CAvDP;;AAyDhB;;;;;;;AAOAk1E,8BAA0B,IAhEV;;AAkEhB;;;;;;;AAOAC,uBAAmB,IAzEH;;AA2EhB;;;;;;;;AAQAnvE,qBAAiB;AACjB;;;;;;AAMA;;AA1FgB,GAAlB;AA6FA,MAAIovE,aAAaV,MAAMjiF,SAAvB;;AAEA2iF,aAAWpB,UAAX,GAAwBoB,WAAWnB,YAAX,GAA0BmB,WAAWlB,YAAX,GAA0B,UAAUjf,WAAV,EAAuB/vB,OAAvB,EAAgCg7B,GAAhC,EAAqC17B,OAArC,EAA8C;AACxH,SAAKsvC,MAAL,CAAY7e,WAAZ,EAAyB/vB,OAAzB,EAAkCg7B,GAAlC,EAAuC17B,OAAvC;AACD,GAFD;AAGA;;;;;;AAOA,WAAS6wC,UAAT,CAAoBrzE,EAApB,EAAwBszE,KAAxB,EAA+B;AAC7B,QAAItzE,EAAJ,EAAQ;AACNA,SAAGpD,OAAH,CAAW02E,KAAX;;AAEA,UAAItzE,GAAG1K,IAAH,KAAY,OAAhB,EAAyB;AACvB,aAAK,IAAIpD,IAAI,CAAb,EAAgBA,IAAI8N,GAAGqZ,UAAH,EAApB,EAAqCnnB,GAArC,EAA0C;AACxCmhF,qBAAWrzE,GAAGkZ,OAAH,CAAWhnB,CAAX,CAAX,EAA0BohF,KAA1B;AACD;AACF;AACF;AACF;AACD;;;;;;AAOA,WAASN,eAAT,CAAyB3+E,IAAzB,EAA+BmuC,OAA/B,EAAwC8wC,KAAxC,EAA+C;AAC7C,QAAI5wC,YAAYH,eAAeluC,IAAf,EAAqBmuC,OAArB,CAAhB;;AAEA,QAAIE,aAAa,IAAjB,EAAuB;AACrBpuC,aAAOusC,iBAAiB6B,SAAjB,CAAP,EAAoC,UAAU6wC,OAAV,EAAmB;AACrDF,mBAAWh/E,KAAKm/E,gBAAL,CAAsBD,OAAtB,CAAX,EAA2CD,KAA3C;AACD,OAFD;AAGD,KAJD,MAIO;AACLj/E,WAAKo/E,iBAAL,CAAuB,UAAUzzE,EAAV,EAAc;AACnCqzE,mBAAWrzE,EAAX,EAAeszE,KAAf;AACD,OAFD;AAGD;AACF,GAhnrB2B,CAgnrB1B;;;AAGFlvC,oBAAkBsuC,KAAlB,EAAyB,CAAC,SAAD,CAAzB,EAnnrB4B,CAmnrBW;;AAEvCxtC,wBAAsBwtC,KAAtB,EAA6B;AAC3BvsC,wBAAoB;AADO,GAA7B;;AAIAusC,QAAMgB,gBAAN,GAAyB,UAAUlxC,OAAV,EAAmByC,UAAnB,EAA+B;AACtDutC,YAAQhwC,OAAR,EAAiBmxC,YAAjB,GAAgC1uC,UAAhC;AACD,GAFD;;AAIA,WAAS2tC,cAAT,CAAwBn+E,OAAxB,EAAiC;AAC/B,WAAOg+E,cAAch+E,QAAQ8xC,KAAtB,CAAP;AACD;;AAED,WAASssC,eAAT,CAAyBp+E,OAAzB,EAAkC;AAChC,QAAIw+D,cAAcx+D,QAAQ8xC,KAA1B;AACA,QAAIrD,UAAUzuC,QAAQyuC,OAAtB;AACA,QAAIg7B,MAAMzpE,QAAQypE,GAAlB;AACA,QAAI17B,UAAU/tC,QAAQ+tC,OAAtB,CAJgC,CAID;;AAE/B,QAAI+vC,oBAAoBtf,YAAY+d,eAAZ,CAA4BuB,iBAApD;AACA,QAAIO,OAAOr+E,QAAQq+E,IAAnB;AACA,QAAIa,eAAenxC,WAAWgwC,QAAQhwC,OAAR,EAAiBmxC,YAA/C;AACA,QAAI1uC,aAAastC,oBAAoB,0BAApB,GAAiDoB,gBAAgBb,KAAKa,YAAL,CAAhB,GAAqCA,YAArC,CAAkD;AACpH;AADkE,MAEhE,QAFF;;AAIA,QAAI1uC,eAAe,QAAnB,EAA6B;AAC3B6tC,WAAK7tC,UAAL,EAAiBguB,WAAjB,EAA8B/vB,OAA9B,EAAuCg7B,GAAvC,EAA4C17B,OAA5C;AACD;;AAED,WAAOoxC,kBAAkB3uC,UAAlB,CAAP;AACD;;AAED,MAAI2uC,oBAAoB;AACtBV,8BAA0B;AACxBrG,gBAAU,kBAAUpgE,MAAV,EAAkBhY,OAAlB,EAA2B;AACnCA,gBAAQq+E,IAAR,CAAaK,iBAAb,CAA+B1mE,MAA/B,EAAuChY,QAAQ8xC,KAA/C,EAAsD9xC,QAAQyuC,OAA9D,EAAuEzuC,QAAQypE,GAA/E,EAAoFzpE,QAAQ+tC,OAA5F;AACD;AAHuB,KADJ;AAMtBsvC,YAAQ;AACN;AACA;AACA;AACA;AACAtF,0BAAoB,IALd;AAMNK,gBAAU,kBAAUpgE,MAAV,EAAkBhY,OAAlB,EAA2B;AACnCA,gBAAQq+E,IAAR,CAAahB,MAAb,CAAoBr9E,QAAQ8xC,KAA5B,EAAmC9xC,QAAQyuC,OAA3C,EAAoDzuC,QAAQypE,GAA5D,EAAiEzpE,QAAQ+tC,OAAzE;AACD;AARK;AANc,GAAxB;;AAkBA;;;;;;;;;;;;;;;;;;AAkBA,MAAIqxC,gBAAgB,0BAApB;AACA,MAAIC,OAAO,kBAAX;AACA,MAAIC,gBAAgB,kBAApB;AACA;;;;;;;;;;AAUA,WAASC,QAAT,CAAkBtiF,EAAlB,EAAsBiW,KAAtB,EAA6BssE,QAA7B,EAAuC;AACrC,QAAIC,QAAJ;AACA,QAAIC,WAAW,CAAf;AACA,QAAIC,WAAW,CAAf;AACA,QAAIC,QAAQ,IAAZ;AACA,QAAI7nC,IAAJ;AACA,QAAI1X,KAAJ;AACA,QAAI//B,IAAJ;AACA,QAAIu/E,gBAAJ;AACA3sE,YAAQA,SAAS,CAAjB;;AAEA,aAAS4iB,IAAT,GAAgB;AACd6pD,iBAAW,IAAIx+C,IAAJ,GAAWwF,OAAX,EAAX;AACAi5C,cAAQ,IAAR;AACA3iF,SAAGuD,KAAH,CAAS6/B,KAAT,EAAgB//B,QAAQ,EAAxB;AACD;;AAED,QAAIP,KAAK,SAALA,EAAK,GAAY;AACnB0/E,iBAAW,IAAIt+C,IAAJ,GAAWwF,OAAX,EAAX;AACAtG,cAAQ,IAAR;AACA//B,aAAOC,SAAP;AACA,UAAIu/E,YAAYD,oBAAoB3sE,KAApC;AACA,UAAI6sE,eAAeF,oBAAoBL,QAAvC;AACAK,yBAAmB,IAAnB;AACA9nC,aAAO0nC,YAAYM,eAAeL,QAAf,GAA0BC,QAAtC,IAAkDG,SAAzD;AACA12C,mBAAaw2C,KAAb,EARmB,CAQE;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,UAAIG,YAAJ,EAAkB;AAChBH,gBAAQ1tD,WAAW4D,IAAX,EAAiBgqD,SAAjB,CAAR;AACD,OAFD,MAEO;AACL,YAAI/nC,QAAQ,CAAZ,EAAe;AACbjiB;AACD,SAFD,MAEO;AACL8pD,kBAAQ1tD,WAAW4D,IAAX,EAAiB,CAACiiB,IAAlB,CAAR;AACD;AACF;;AAED2nC,iBAAWD,QAAX;AACD,KA5BD;AA6BA;;;;;AAMA1/E,OAAGwV,KAAH,GAAW,YAAY;AACrB,UAAIqqE,KAAJ,EAAW;AACTx2C,qBAAaw2C,KAAb;AACAA,gBAAQ,IAAR;AACD;AACF,KALD;AAMA;;;;AAKA7/E,OAAG8/E,gBAAH,GAAsB,UAAUG,aAAV,EAAyB;AAC7CH,yBAAmBG,aAAnB;AACD,KAFD;;AAIA,WAAOjgF,EAAP;AACD;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4BA,WAASkgF,cAAT,CAAwBngF,GAAxB,EAA6BogF,MAA7B,EAAqCC,IAArC,EAA2CC,YAA3C,EAAyD;AACvD,QAAInjF,KAAK6C,IAAIogF,MAAJ,CAAT;;AAEA,QAAI,CAACjjF,EAAL,EAAS;AACP;AACD;;AAED,QAAIojF,WAAWpjF,GAAGmiF,aAAH,KAAqBniF,EAApC;AACA,QAAIqjF,mBAAmBrjF,GAAGqiF,aAAH,CAAvB;AACA,QAAIiB,WAAWtjF,GAAGoiF,IAAH,CAAf;;AAEA,QAAIkB,aAAaJ,IAAb,IAAqBG,qBAAqBF,YAA9C,EAA4D;AAC1D,UAAID,QAAQ,IAAR,IAAgB,CAACC,YAArB,EAAmC;AACjC,eAAOtgF,IAAIogF,MAAJ,IAAcG,QAArB;AACD;;AAEDpjF,WAAK6C,IAAIogF,MAAJ,IAAcX,SAASc,QAAT,EAAmBF,IAAnB,EAAyBC,iBAAiB,UAA1C,CAAnB;AACAnjF,SAAGmiF,aAAH,IAAoBiB,QAApB;AACApjF,SAAGqiF,aAAH,IAAoBc,YAApB;AACAnjF,SAAGoiF,IAAH,IAAWc,IAAX;AACD;;AAED,WAAOljF,EAAP;AACD;AACD;;;;;;;;AAQA;;;;;;;;;;;;;;;;;;AAkBA,MAAIujF,cAAc;AAChBC,uBAAmB,IADH;AAEhBC,sBAAkB,IAFF;AAGhBnK,WAAO,eAAU/X,WAAV,EAAuB/vB,OAAvB,EAAgC;AACrC,UAAI7uC,OAAO4+D,YAAY2S,OAAZ,EAAX;AACA,UAAIwP,kBAAkB,CAACniB,YAAYub,qBAAZ,IAAqC,iBAAtC,EAAyD9hE,KAAzD,CAA+D,GAA/D,CAAtB;AACA,UAAIoB,QAAQmlD,YAAY77D,GAAZ,CAAgBg+E,eAAhB,EAAiC;AAAjC,SACTniB,YAAYN,mBAAZ,EAAiC;AACpCM,kBAAYxhE,IADT,EACe,IADf,EACqByxC,QAAQs5B,cAAR,EADrB,CADH,CAHqC,CAKc;AACnD;;AAEAnoE,WAAKghF,SAAL,CAAe,OAAf,EAAwBvnE,KAAxB,EARqC,CAQL;;AAEhC,UAAI,CAACo1B,QAAQ45B,gBAAR,CAAyB7J,WAAzB,CAAL,EAA4C;AAC1C,YAAI,OAAOnlD,KAAP,KAAiB,UAAjB,IAA+B,EAAEA,iBAAiB4sC,QAAnB,CAAnC,EAAiE;AAC/DrmD,eAAK4C,IAAL,CAAU,UAAUkiB,GAAV,EAAe;AACvB9kB,iBAAKihF,aAAL,CAAmBn8D,GAAnB,EAAwB,OAAxB,EAAiCrL,MAAMmlD,YAAY4W,aAAZ,CAA0B1wD,GAA1B,CAAN,CAAjC;AACD,WAFD;AAGD,SALyC,CAKxC;;;AAGF,YAAIo8D,WAAW,SAAXA,QAAW,CAAUlhF,IAAV,EAAgB8kB,GAAhB,EAAqB;AAClC,cAAIsxD,YAAYp2E,KAAKq2E,YAAL,CAAkBvxD,GAAlB,CAAhB;AACA,cAAIrL,QAAQ28D,UAAUrzE,GAAV,CAAcg+E,eAAd,EAA+B,IAA/B,CAAZ;;AAEA,cAAItnE,SAAS,IAAb,EAAmB;AACjBzZ,iBAAKihF,aAAL,CAAmBn8D,GAAnB,EAAwB,OAAxB,EAAiCrL,KAAjC;AACD;AACF,SAPD;;AASA,eAAO;AACLynE,oBAAUlhF,KAAK60E,aAAL,GAAqBqM,QAArB,GAAgC;AADrC,SAAP;AAGD;AACF;AAlCe,GAAlB;;AAqCA;;;;;;;;;;;;;;;;;;AAkBA,MAAIC,OAAO;AACT9Q,aAAS;AACPn0C,aAAO;AACLklD,eAAO;AACL98D,gBAAM,MADD;AAEL+8D,mBAAS,IAFJ;AAGLC,iBAAO,MAHF;AAILC,iBAAO,MAJF;AAKLC,gBAAM,MALD;AAML7rE,iBAAO;AANF;AADF,OADA;AAWP8rE,gBAAU;AACRL,eAAO,MADC;AAERD,cAAM,CAAC,MAAD,EAAS,IAAT,EAAe,IAAf;AAFE,OAXH;AAePO,gBAAU;AACRN,eAAO;AACLO,gBAAM,MADD;AAELC,gBAAM;AAFD;AADC,OAfH;AAqBPC,iBAAW;AACTT,eAAO;AACLxqD,gBAAM,QADD;AAELkrD,eAAK,QAFA;AAGL5vB,iBAAO,OAHF;AAIL6vB,iBAAO;AAJF;AADE,OArBJ;AA6BP9vD,eAAS;AACPmvD,eAAO;AADA,OA7BF;AAgCPY,mBAAa;AACXZ,eAAO,OADI;AAEXD,cAAM,CAAC,SAAD;AAFK;AAhCN,KADA;AAsCTtZ,YAAQ;AACNoa,iBAAW;AACTC,aAAK,IADI;AAETJ,aAAK,KAFI;AAGTlrD,cAAM,KAHG;AAITurD,iBAAS,KAJA;AAKTC,uBAAe,OALN;AAMTpS,eAAO,KANE;AAOTqS,cAAM,IAPG;AAQTC,iBAAS,MARA;AASTC,iBAAS,KATA;AAUTC,qBAAa,KAVJ;AAWT3xE,WAAG,KAXM;AAYT4xE,iBAAS,KAZA;AAaT1lF,aAAK,IAbI;AAcTijE,kBAAU,OAdD;AAeTlqC,eAAO,IAfE;AAgBTm8B,eAAO,KAhBE;AAiBTywB,gBAAQ,KAjBC;AAkBTC,gBAAQ,KAlBC;AAmBTC,eAAO,MAnBE;AAoBTC,sBAAc,MApBL;AAqBTC,oBAAY,OArBH;AAsBTC,kBAAU;AAtBD;AADL,KAtCC;AAgETC,UAAM;AACJC,eAAS;AACPC,mBAAW,qBADJ;AAEPC,sBAAc;AAFP,OADL;AAKJtb,cAAQ;AACNub,gBAAQ;AACNC,kBAAQ,EADF;AAENC,oBAAU,mCAFJ;AAGNC,uBAAa;AAHP,SADF;AAMNC,kBAAU;AACRH,kBAAQ,yBADA;AAERC,oBAAU,+CAFF;AAGRC,uBAAa,gCAHL;AAIRE,qBAAW;AACT9qD,oBAAQ,GADC;AAETge,iBAAK;AAFI;AAJH;AANJ,OALJ;AAqBJ32C,YAAM;AACJ0jF,iBAAS,QADL;AAEJC,qBAAa,sBAFT;AAGJL,kBAAU,mBAHN;AAIJC,qBAAa,SAJT;AAKJE,mBAAW;AACT9qD,kBAAQ,GADC;AAETge,eAAK;AAFI;AALP;AArBF;AAhEG,GAAX;;AAkGA;;;;;;;;;;;;;;;;;;AAkBA,MAAIqsC,OAAO,SAAPA,IAAO,CAAUxyD,GAAV,EAAeqe,OAAf,EAAwB;AACjC,QAAI+0C,YAAY/0C,QAAQ4d,QAAR,CAAiB,MAAjB,CAAhB;;AAEA,QAAI,CAACm3B,UAAU7gF,GAAV,CAAc,MAAd,CAAL,EAA4B;AAC1B;AACD,KAFD,MAEO,IAAI6gF,UAAU7gF,GAAV,CAAc,aAAd,CAAJ,EAAkC;AACvCytB,UAAIF,YAAJ,CAAiB,YAAjB,EAA+BszD,UAAU7gF,GAAV,CAAc,aAAd,CAA/B;AACA;AACD;;AAED,QAAI8gF,YAAY,CAAhB;AACAh1C,YAAQu5B,UAAR,CAAmB,UAAUxJ,WAAV,EAAuB95C,GAAvB,EAA4B;AAC7C,QAAE++D,SAAF;AACD,KAFD,EAEG,IAFH;AAGA,QAAIC,aAAaF,UAAU7gF,GAAV,CAAc,eAAd,KAAkC,EAAnD;AACA,QAAIghF,eAAeH,UAAU7gF,GAAV,CAAc,iBAAd,KAAoC,EAAvD;AACA,QAAIihF,mBAAmBr/E,KAAKoB,GAAL,CAAS89E,SAAT,EAAoBE,YAApB,CAAvB;AACA,QAAIE,SAAJ;;AAEA,QAAIJ,YAAY,CAAhB,EAAmB;AACjB;AACA;AACD,KAHD,MAGO;AACL,UAAIzC,QAAQ8C,UAAZ;;AAEA,UAAI9C,KAAJ,EAAW;AACT6C,oBAAY3hF,QAAQ6hF,UAAU,mBAAV,CAAR,EAAwC;AAClD/C,iBAAOA;AAD2C,SAAxC,CAAZ;AAGD,OAJD,MAIO;AACL6C,oBAAYE,UAAU,sBAAV,CAAZ;AACD;;AAED,UAAIC,eAAe,EAAnB;AACA,UAAIf,SAASQ,YAAY,CAAZ,GAAgB,wBAAhB,GAA2C,sBAAxD;AACAI,mBAAa3hF,QAAQ6hF,UAAUd,MAAV,CAAR,EAA2B;AACtCgB,qBAAaR;AADyB,OAA3B,CAAb;AAGAh1C,cAAQu5B,UAAR,CAAmB,UAAUxJ,WAAV,EAAuB95C,GAAvB,EAA4B;AAC7C,YAAIA,MAAMk/D,gBAAV,EAA4B;AAC1B,cAAIM,WAAJ;AACA,cAAIrgB,aAAarF,YAAY77D,GAAZ,CAAgB,MAAhB,CAAjB;AACA,cAAIwhF,YAAY,aAAaV,YAAY,CAAZ,GAAgB,UAAhB,GAA6B,QAA1C,IAAsD,GAAtE;AACAS,wBAAcH,UAAUlgB,aAAasgB,YAAY,UAAzB,GAAsCA,YAAY,aAA5D,CAAd;AACAD,wBAAchiF,QAAQgiF,WAAR,EAAqB;AACjCtb,sBAAUpK,YAAYoJ,WADW;AAEjC/D,wBAAYrF,YAAY77D,GAAZ,CAAgB,MAAhB,CAFqB;AAGjCsgE,wBAAYmhB,kBAAkB5lB,YAAYvtB,OAA9B;AAHqB,WAArB,CAAd;AAKA,cAAIrxC,OAAO4+D,YAAY2S,OAAZ,EAAX;AACAz1E,iBAAOkE,IAAP,GAAcA,IAAd;;AAEA,cAAIA,KAAK0hB,KAAL,KAAeoiE,UAAnB,EAA+B;AAC7B;AACAQ,2BAAehiF,QAAQ6hF,UAAU,kBAAV,CAAR,EAAuC;AACpDM,0BAAYX;AADwC,aAAvC,CAAf;AAGD,WALD,MAKO;AACLQ,2BAAeH,UAAU,cAAV,CAAf;AACD;;AAED,cAAIO,aAAa,EAAjB;;AAEA,eAAK,IAAI7mF,IAAI,CAAb,EAAgBA,IAAImC,KAAK0hB,KAAL,EAApB,EAAkC7jB,GAAlC,EAAuC;AACrC,gBAAIA,IAAIimF,UAAR,EAAoB;AAClB,kBAAI1mF,OAAO4C,KAAK61E,OAAL,CAAah4E,CAAb,CAAX;AACA,kBAAIyB,QAAQ41E,iBAAiBl1E,IAAjB,EAAuBnC,CAAvB,CAAZ;AACA6mF,yBAAWrkF,IAAX,CAAgBiC,QAAQlF,OAAO+mF,UAAU,eAAV,CAAP,GAAoCA,UAAU,kBAAV,CAA5C,EAA2E;AACzF/mF,sBAAMA,IADmF;AAEzFkC,uBAAOA;AAFkF,eAA3E,CAAhB;AAID;AACF;;AAEDglF,yBAAeI,WAAW9nE,IAAX,CAAgBunE,UAAU,uBAAV,CAAhB,IAAsDA,UAAU,oBAAV,CAArE;AACAC,uBAAa/jF,IAAb,CAAkBikF,WAAlB;AACD;AACF,OAvCD;AAwCAL,mBAAaG,aAAaxnE,IAAb,CAAkBunE,UAAU,kCAAV,CAAlB,IAAmEA,UAAU,+BAAV,CAAhF;AACA3zD,UAAIF,YAAJ,CAAiB,YAAjB,EAA+B2zD,SAA/B;AACD;;AAED,aAAS3hF,OAAT,CAAiBD,GAAjB,EAAsBsiF,SAAtB,EAAiC;AAC/B,UAAI,OAAOtiF,GAAP,KAAe,QAAnB,EAA6B;AAC3B,eAAOA,GAAP;AACD;;AAED,UAAI5E,SAAS4E,GAAb;AACApC,aAAO0kF,SAAP,EAAkB,UAAUrlF,KAAV,EAAiBlB,GAAjB,EAAsB;AACtCX,iBAASA,OAAO6E,OAAP,CAAe,IAAI0/C,MAAJ,CAAW,YAAY5jD,GAAZ,GAAkB,SAA7B,EAAwC,GAAxC,CAAf,EAA6DkB,KAA7D,CAAT;AACD,OAFD;AAGA,aAAO7B,MAAP;AACD;;AAED,aAAS0mF,SAAT,CAAmBnjE,IAAnB,EAAyB;AACvB,UAAI4jE,aAAahB,UAAU7gF,GAAV,CAAcie,IAAd,CAAjB;;AAEA,UAAI4jE,cAAc,IAAlB,EAAwB;AACtB,YAAI1zB,UAAUlwC,KAAK3I,KAAL,CAAW,GAAX,CAAd;AACA,YAAI5a,SAAS0jF,KAAK6B,IAAlB;;AAEA,aAAK,IAAInlF,IAAI,CAAb,EAAgBA,IAAIqzD,QAAQnzD,MAA5B,EAAoC,EAAEF,CAAtC,EAAyC;AACvCJ,mBAASA,OAAOyzD,QAAQrzD,CAAR,CAAP,CAAT;AACD;;AAED,eAAOJ,MAAP;AACD,OATD,MASO;AACL,eAAOmnF,UAAP;AACD;AACF;;AAED,aAASV,QAAT,GAAoB;AAClB,UAAI9C,QAAQvyC,QAAQ4d,QAAR,CAAiB,OAAjB,EAA0Blf,MAAtC;;AAEA,UAAI6zC,SAASA,MAAMrjF,MAAnB,EAA2B;AACzBqjF,gBAAQA,MAAM,CAAN,CAAR;AACD;;AAED,aAAOA,SAASA,MAAMp1D,IAAtB;AACD;;AAED,aAASw4D,iBAAT,CAA2BvjF,IAA3B,EAAiC;AAC/B,aAAOkgF,KAAKtZ,MAAL,CAAYoa,SAAZ,CAAsBhhF,IAAtB,KAA+B,MAAtC;AACD;AACF,GA5HD;;AA8HA;;;;;;;;;;;;;;;;;;AAkBA,MAAI4jF,OAAOlgF,KAAKgN,EAAhB;AACA;;;;;;;;;AASA,MAAImzE,iBAAiB,SAAjBA,cAAiB,CAAUjb,GAAV,EAAez6D,IAAf,EAAqB;AACxCA,WAAOA,QAAQ,EAAf;AACAnQ,aAASmQ,IAAT,EAAe;AACb4c,YAAM,SADO;AAEbvS,aAAO,SAFM;AAGbsrE,iBAAW,MAHE;AAIbC,iBAAW,0BAJE;AAKb37D,cAAQ;AALK,KAAf;AAOA,QAAI47D,OAAO,IAAI3/B,IAAJ,CAAS;AAClB92B,aAAO;AACLlD,cAAMlc,KAAK41E;AADN,OADW;AAIlB37D,cAAQja,KAAKia,MAJK;AAKlBC,SAAG;AALe,KAAT,CAAX;AAOA,QAAIgP,MAAM,IAAI2tB,GAAJ,CAAQ;AAChBnuB,aAAO;AACLggB,oBAAY,CAAC+sC,IAAD,GAAQ,CADf;AAEL9sC,kBAAU,CAAC8sC,IAAD,GAAQ,CAAR,GAAY,GAFjB;AAGLztE,WAAG;AAHE,OADS;AAMhBoX,aAAO;AACLjD,gBAAQnc,KAAKqK,KADR;AAELyrE,iBAAS,OAFJ;AAGLp5D,mBAAW;AAHN,OANS;AAWhBzC,cAAQja,KAAKia,MAXG;AAYhBC,SAAG;AAZa,KAAR,CAAV;AAcA,QAAI67D,YAAY,IAAI7/B,IAAJ,CAAS;AACvB92B,aAAO;AACLlD,cAAM,MADD;AAELU,cAAM5c,KAAK4c,IAFN;AAGLc,sBAAc,OAHT;AAILK,sBAAc,EAJT;AAKLX,kBAAUpd,KAAK21E;AALV,OADgB;AAQvB17D,cAAQja,KAAKia,MARU;AASvBC,SAAG;AAToB,KAAT,CAAhB;AAWAgP,QAAI6nB,YAAJ,CAAiB,IAAjB,EAAuB9gC,IAAvB,CAA4B,IAA5B,EAAkC;AAChC04B,gBAAU8sC,OAAO,CAAP,GAAW;AADW,KAAlC,EAEGpmE,KAFH,CAES,eAFT;AAGA6Z,QAAI6nB,YAAJ,CAAiB,IAAjB,EAAuB9gC,IAAvB,CAA4B,IAA5B,EAAkC;AAChCy4B,kBAAY+sC,OAAO,CAAP,GAAW;AADS,KAAlC,EAEGvxE,KAFH,CAES,GAFT,EAEcmL,KAFd,CAEoB,eAFpB;AAGA,QAAI06C,QAAQ,IAAI30C,KAAJ,EAAZ;AACA20C,UAAM70D,GAAN,CAAUg0B,GAAV;AACA6gC,UAAM70D,GAAN,CAAU6gF,SAAV;AACAhsB,UAAM70D,GAAN,CAAU2gF,IAAV,EAlDwC,CAkDvB;;AAEjB9rB,UAAM9tD,MAAN,GAAe,YAAY;AACzB,UAAIsvC,KAAKkvB,IAAI35C,QAAJ,KAAiB,CAA1B;AACA,UAAI0qB,KAAKivB,IAAI15C,SAAJ,KAAkB,CAA3B;AACAmI,UAAI8nB,QAAJ,CAAa;AACXzF,YAAIA,EADO;AAEXC,YAAIA;AAFO,OAAb;AAIA,UAAIxjC,IAAIkhB,IAAIR,KAAJ,CAAU1gB,CAAlB;AACA+tE,gBAAU/kC,QAAV,CAAmB;AACjBp8C,WAAG22C,KAAKvjC,CADS;AAEjBnT,WAAG22C,KAAKxjC,CAFS;AAGjB8L,eAAO9L,IAAI,CAHM;AAIjB+L,gBAAQ/L,IAAI;AAJK,OAAnB;AAMA6tE,WAAK7kC,QAAL,CAAc;AACZp8C,WAAG,CADS;AAEZC,WAAG,CAFS;AAGZif,eAAO2mD,IAAI35C,QAAJ,EAHK;AAIZ/M,gBAAQ0mD,IAAI15C,SAAJ;AAJI,OAAd;AAMD,KApBD;;AAsBAgpC,UAAM9tD,MAAN;AACA,WAAO8tD,KAAP;AACD,GA5ED;;AA8EA;;;;;;;;;;;;;;;;;;;AAmBA;;;AAGA;;;;AAIA,WAASisB,SAAT,CAAmBC,UAAnB,EAA+Bxb,GAA/B,EAAoCyb,qBAApC,EAA2DC,cAA3D,EAA2E;AACzE,SAAKF,UAAL,GAAkBA,UAAlB;AACA,SAAKxb,GAAL,GAAWA,GAAX;AACA,SAAK+O,UAAL,CAHyE,CAGxD;AACjB;AACA;AACA;;AAEA,QAAI0M,wBAAwB,KAAKE,sBAAL,GAA8BF,sBAAsBzoF,KAAtB,EAA1D;AACA,QAAI0oF,iBAAiB,KAAKE,eAAL,GAAuBF,eAAe1oF,KAAf,EAA5C;AACA,SAAK6oF,YAAL,GAAoBJ,sBAAsBzkF,MAAtB,CAA6B0kF,cAA7B,CAApB;AACA;;;;;;;;;;;;AAYA,SAAKI,aAAL,GAAqB1iF,eAArB;AACD;;AAED,MAAIktC,QAAQi1C,UAAUhpF,SAAtB;AACA;;;;;AAKA+zC,QAAM2gB,WAAN,GAAoB,UAAUjiB,OAAV,EAAmBV,OAAnB,EAA4B;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAU,YAAQiiB,WAAR,CAAoB3iB,OAApB,EAjB8C,CAiBhB;AAC9B;AACA;AACA;AACA;AACA;AACA;;AAEA,SAAKw3C,aAAL,CAAmB/iF,IAAnB,CAAwB,UAAUgjF,UAAV,EAAsB;AAC5C,UAAIC,cAAcD,WAAWC,WAA7B;AACAA,qBAAeA,YAAYxkE,KAAZ,EAAf;AACD,KAHD;AAID,GA7BD,CAtysB4B,CAm0sBzB;;;AAGH8uB,QAAM21C,cAAN,GAAuB,UAAU9K,IAAV,EAAgBluB,OAAhB,EAAyB;AAC9C;AACA,QAAI,CAACkuB,KAAKvD,UAAV,EAAsB;AACpB;AACD;;AAED,QAAI4F,WAAW,KAAK0I,YAAL,CAAkBhjF,GAAlB,CAAsBi4E,KAAKvD,UAAL,CAAgBr2D,EAAtC,CAAf;;AAEA,QAAI4kE,OAAO3I,SAASj9E,OAApB;AACA,QAAIixB,cAAc,CAACy7B,OAAD,IAAYuwB,SAAS4I,kBAArB,KAA4C,CAACD,IAAD,IAASA,KAAK9H,iBAA1D,KAAgFlD,KAAKkL,eAAL,GAAuB7I,SAAS8I,UAAlI;AACA,QAAIpyE,OAAOsd,cAAcgsD,SAAStpE,IAAvB,GAA8B,IAAzC;AACA,QAAImkE,eAAe8N,QAAQA,KAAK9N,YAAhC;AACA,QAAID,QAAQC,gBAAgB,IAAhB,GAAuBvzE,KAAKyV,IAAL,CAAU89D,eAAenkE,IAAzB,CAAvB,GAAwD,IAApE;AACA,WAAO;AACLA,YAAMA,IADD;AAELkkE,aAAOA,KAFF;AAGLC,oBAAcA;AAHT,KAAP;AAKD,GAlBD;;AAoBA/nC,QAAMmtC,WAAN,GAAoB,UAAU8I,UAAV,EAAsB;AACxC,WAAO,KAAKL,YAAL,CAAkBhjF,GAAlB,CAAsBqjF,UAAtB,CAAP;AACD,GAFD;AAGA;;;;;;;;AASAj2C,QAAMk2C,iBAAN,GAA0B,UAAUznB,WAAV,EAAuB6f,IAAvB,EAA6B;AACrD,QAAIpB,WAAW,KAAK0I,YAAL,CAAkBhjF,GAAlB,CAAsB67D,YAAY5C,GAAlC,CAAf;;AAEA,QAAIh8D,OAAO4+D,YAAY2S,OAAZ,EAAX;AACA,QAAI+U,UAAUtmF,KAAK0hB,KAAL,EAAd,CAJqD,CAIzB;AAC5B;AACA;AACA;AACA;;AAEA,QAAIw8D,oBAAoBb,SAAS4I,kBAAT,IAA+BxH,KAAKI,wBAApC,IAAgEyH,WAAWjJ,SAASkJ,SAA5G;AACA,QAAIvI,QAAQpf,YAAY77D,GAAZ,CAAgB,OAAhB,KAA4BujF,WAAW1nB,YAAY77D,GAAZ,CAAgB,gBAAhB,CAAnD,CAXqD,CAWiC;AACtF;;AAEA,QAAIm1E,eAAetZ,YAAY77D,GAAZ,CAAgB,sBAAhB,MAA4C,KAA5C,GAAoDujF,OAApD,GAA8D,IAAjF;AACA1nB,gBAAY+d,eAAZ,GAA8BU,SAASj9E,OAAT,GAAmB;AAC/C89E,yBAAmBA,iBAD4B;AAE/ChG,oBAAcA,YAFiC;AAG/C8F,aAAOA;AAHwC,KAAjD;AAKD,GApBD;;AAsBA7tC,QAAMq2C,gBAAN,GAAyB,UAAU33C,OAAV,EAAmB;AAC1C,QAAIuuC,YAAY,IAAhB;AACA,QAAIqJ,cAAcrJ,UAAU2I,YAAV,GAAyB9iF,eAA3C;AACA4rC,YAAQu5B,UAAR,CAAmB,UAAUxJ,WAAV,EAAuB;AACxC,UAAI9iC,cAAc8iC,YAAYyd,cAAZ,EAAlB;AACA,UAAI+J,aAAaxnB,YAAY5C,GAA7B;AACAyqB,kBAAY3jF,GAAZ,CAAgBsjF,UAAhB,EAA4B;AAC1BhlE,YAAIglE,UADsB;AAE1BpxE,cAAM,IAFoB;AAG1BC,cAAM,IAHoB;AAI1BsxE,mBAAW3nB,YAAY0d,uBAAZ,EAJe;AAK1B2J,4BAAoBnqD,eAAe,EAAE8iC,YAAY8d,kBAAZ,IAAkC9d,YAAY8d,kBAAZ,EAApC,CALT;AAM1ByJ,oBAAY,CAAC,CANa;AAO1BpyE,cAAMpP,KAAK6R,KAAL,CAAWslB,eAAe,GAA1B,CAPoB;AAQ1Bpa,eAAO;AARmB,OAA5B;AAUA+3D,WAAK2D,SAAL,EAAgBxe,WAAhB,EAA6BA,YAAYwb,QAAzC;AACD,KAdD;AAeD,GAlBD;;AAoBAjqC,QAAMu2C,iBAAN,GAA0B,YAAY;AACpC,QAAIC,eAAe,KAAKhB,aAAxB;AACA,QAAI92C,UAAU,KAAKw2C,UAAL,CAAgB54B,QAAhB,EAAd;AACA,QAAIod,MAAM,KAAKA,GAAf;AACA5pE,WAAO,KAAKylF,YAAZ,EAA0B,UAAU39E,OAAV,EAAmB;AAC3C,UAAI6+E,SAASD,aAAa5jF,GAAb,CAAiBgF,QAAQi0D,GAAzB,KAAiC2qB,aAAa7jF,GAAb,CAAiBiF,QAAQi0D,GAAzB,EAA8B,EAA9B,CAA9C;AACAj0D,cAAQ4uE,KAAR,IAAiBkQ,sBAAsB,IAAtB,EAA4B9+E,OAA5B,EAAqC6+E,MAArC,EAA6C/3C,OAA7C,EAAsDg7B,GAAtD,CAAjB;AACA9hE,cAAQ++E,YAAR,IAAwBC,uBAAuB,IAAvB,EAA6Bh/E,OAA7B,EAAsC6+E,MAAtC,EAA8C/3C,OAA9C,EAAuDg7B,GAAvD,CAAxB;AACD,KAJD,EAIG,IAJH;AAKD,GATD;;AAWA15B,QAAM62C,WAAN,GAAoB,UAAUvI,IAAV,EAAgBvsC,KAAhB,EAAuBrD,OAAvB,EAAgCg7B,GAAhC,EAAqC;AACvD,QAAIyU,aAAaG,KAAKH,UAAtB;AACA,QAAIl+E,UAAUk+E,WAAWl+E,OAAzB;AACAA,YAAQ8xC,KAAR,GAAgBA,KAAhB;AACA9xC,YAAQyuC,OAAR,GAAkBA,OAAlB;AACAzuC,YAAQypE,GAAR,GAAcA,GAAd;AACAyU,eAAW2I,OAAX,GAAqB,CAACxI,KAAKI,wBAA3B;AACApF,SAAK,IAAL,EAAWvnC,KAAX,EAAkBosC,UAAlB;AACD,GARD;;AAUAnuC,QAAM+2C,yBAAN,GAAkC,UAAUr4C,OAAV,EAAmBV,OAAnB,EAA4B;AAC5D;AACAg5C,sBAAkB,IAAlB,EAAwB,KAAK3B,sBAA7B,EAAqD32C,OAArD,EAA8DV,OAA9D,EAAuE;AACrE5W,aAAO;AAD8D,KAAvE;AAGD,GALD,CAr6sB4B,CA06sBzB;AACH;AACA;;;AAGA4Y,QAAMi3C,kBAAN,GAA2B,UAAUv4C,OAAV,EAAmBV,OAAnB,EAA4BzB,GAA5B,EAAiC;AAC1Dy6C,sBAAkB,IAAlB,EAAwB,KAAK1B,eAA7B,EAA8C52C,OAA9C,EAAuDV,OAAvD,EAAgEzB,GAAhE;AACD,GAFD;;AAIA,WAASy6C,iBAAT,CAA2B/J,SAA3B,EAAsCiK,aAAtC,EAAqDx4C,OAArD,EAA8DV,OAA9D,EAAuEzB,GAAvE,EAA4E;AAC1EA,UAAMA,OAAO,EAAb;AACA,QAAIksC,UAAJ;AACA34E,WAAOonF,aAAP,EAAsB,UAAUC,YAAV,EAAwBxiE,GAAxB,EAA6B;AACjD,UAAI4nB,IAAI66C,UAAJ,IAAkB76C,IAAI66C,UAAJ,KAAmBD,aAAaC,UAAtD,EAAkE;AAChE;AACD;;AAED,UAAIC,qBAAqBpK,UAAUuI,aAAV,CAAwB5iF,GAAxB,CAA4BukF,aAAatrB,GAAzC,CAAzB;;AAEA,UAAIyrB,gBAAgBD,mBAAmBC,aAAvC;AACA,UAAI5B,cAAc2B,mBAAmB3B,WAArC;;AAEA,UAAIA,WAAJ,EAAiB;AACf,YAAI6B,gBAAJ;AACA,YAAInK,eAAesI,YAAYtI,YAA/B;AACAA,qBAAa36E,IAAb,CAAkB,UAAU+kF,IAAV,EAAgB;AAChC,cAAIC,aAAal7C,GAAb,EAAkBi7C,IAAlB,CAAJ,EAA6B;AAC3BA,iBAAKtmE,KAAL;AACAqmE,+BAAmB,IAAnB;AACD;AACF,SALD;AAMAA,4BAAoB7B,YAAYxkE,KAAZ,EAApB;AACAwmE,sBAAchC,WAAd,EAA2B13C,OAA3B;AACA,YAAIipC,cAAcgG,UAAU0I,cAAV,CAAyBD,WAAzB,EAAsCn5C,IAAInV,KAA1C,CAAlB,CAXe,CAWqD;AACpE;AACA;AACA;;AAEAgmD,qBAAa36E,IAAb,CAAkB,UAAU+kF,IAAV,EAAgB;AAChCA,eAAKxQ,OAAL,CAAaC,WAAb;AACD,SAFD;AAGAwB,sBAAciN,YAAY1O,OAAZ,CAAoBC,WAApB,CAAd;AACD,OApBD,MAoBO,IAAIqQ,aAAJ,EAAmB;AACxBA,sBAAc7kF,IAAd,CAAmB,UAAUo4E,IAAV,EAAgBoL,UAAhB,EAA4B;AAC7C,cAAIwB,aAAal7C,GAAb,EAAkBsuC,IAAlB,CAAJ,EAA6B;AAC3BA,iBAAK35D,KAAL;AACD;;AAED,cAAI+1D,cAAcgG,UAAU0I,cAAV,CAAyB9K,IAAzB,EAA+BtuC,IAAInV,KAAnC,CAAlB;AACA6/C,sBAAYG,IAAZ,GAAmB,CAAC+P,aAAaxG,gBAAd,IAAkCjyC,QAAQ45B,gBAAR,CAAyBuS,KAAK56E,OAAL,CAAa8xC,KAAtC,CAArD;AACA21C,wBAAc7M,IAAd,EAAoB7sC,OAApB;AACAyqC,wBAAcoC,KAAK7D,OAAL,CAAaC,WAAb,CAAd;AACD,SATD;AAUD;AACF,KA1CD;;AA4CA,aAASwQ,YAAT,CAAsBl7C,GAAtB,EAA2BsuC,IAA3B,EAAiC;AAC/B,aAAOtuC,IAAIo7C,QAAJ,KAAiB,CAACp7C,IAAIq7C,QAAL,IAAiBr7C,IAAIq7C,QAAJ,CAAahlF,GAAb,CAAiBi4E,KAAKvD,UAAL,CAAgBr2D,EAAjC,CAAlC,CAAP;AACD;;AAEDg8D,cAAUxE,UAAV,IAAwBA,UAAxB;AACD;;AAEDzoC,QAAM63C,kBAAN,GAA2B,UAAUn5C,OAAV,EAAmB;AAC5C,QAAI+pC,UAAJ;AACA/pC,YAAQu5B,UAAR,CAAmB,UAAUxJ,WAAV,EAAuB;AACxC;AACAga,oBAAcha,YAAYwb,QAAZ,CAAqBjD,OAArB,EAAd;AACD,KAHD;AAIA,SAAKyB,UAAL,IAAmBA,UAAnB;AACD,GAPD;;AASAzoC,QAAM0mC,IAAN,GAAa,YAAY;AACvB;AACA,SAAKkP,YAAL,CAAkBnjF,IAAlB,CAAuB,UAAUy6E,QAAV,EAAoB;AACzC,UAAIrC,OAAOqC,SAASpoE,IAApB;;AAEA,SAAG;AACD,YAAI+lE,KAAKiM,OAAT,EAAkB;AAChB5J,mBAAS8I,UAAT,GAAsBnL,KAAKkL,eAA3B;AACA;AACD;;AAEDlL,eAAOA,KAAKpB,WAAL,EAAP;AACD,OAPD,QAOSoB,IAPT;AAQD,KAXD;AAYD,GAdD;;AAgBA,MAAI6M,gBAAgB13C,MAAM03C,aAAN,GAAsB,UAAU7M,IAAV,EAAgB7sC,OAAhB,EAAyB;AACjEA,gBAAY,QAAZ,KAAyB6sC,KAAK56E,OAAL,CAAa+tC,OAAb,GAAuBA,OAAhD;AACD,GAFD;;AAIA,WAAS04C,qBAAT,CAA+BzJ,SAA/B,EAA0CkK,YAA1C,EAAwDE,kBAAxD,EAA4E34C,OAA5E,EAAqFg7B,GAArF,EAA0F;AACxF,QAAI4d,gBAAgBD,mBAAmBC,aAAnB,KAAqCD,mBAAmBC,aAAnB,GAAmCxkF,eAAxE,CAApB;AACA,QAAIogE,aAAaikB,aAAajkB,UAA9B;AACA,QAAI4kB,kBAAkBX,aAAaW,eAAnC,CAHwF,CAGpC;AACpD;AACA;;AAEA,QAAIX,aAAazG,iBAAjB,EAAoC;AAClChyC,cAAQy5B,aAAR,CAAsBvkE,MAAtB;AACD,KAFD,MAEO,IAAIs/D,UAAJ,EAAgB;AACrBx0B,cAAQ25B,mBAAR,CAA4BnF,UAA5B,EAAwCt/D,MAAxC;AACD,KAFM,MAEA,IAAIkkF,eAAJ,EAAqB;AAC1BA,sBAAgBp5C,OAAhB,EAAyBg7B,GAAzB,EAA8BjnE,IAA9B,CAAmCmB,MAAnC;AACD;;AAED,aAASA,MAAT,CAAgB66D,WAAhB,EAA6B;AAC3B,UAAIwnB,aAAaxnB,YAAY5C,GAA7B,CAD2B,CACO;AAClC;;AAEA,UAAIgf,OAAOyM,cAAc1kF,GAAd,CAAkBqjF,UAAlB,KAAiCqB,cAAc3kF,GAAd,CAAkBsjF,UAAlB,EAA8B5P,WAAW;AACnFK,cAAMqR,cAD6E;AAEnFvR,eAAOwR,eAF4E;AAGnFzmE,eAAO0mE;AAH4E,OAAX,CAA9B,CAA5C;AAKApN,WAAK56E,OAAL,GAAe;AACb8xC,eAAO0sB,WADM;AAEb/vB,iBAASA,OAFI;AAGbg7B,aAAKA,GAHQ;AAIbwe,wBAAgBf,aAAagB,QAAb,IAAyB,CAAChB,aAAaiB,QAJ1C;AAKb1R,cAAMyQ,aAAazQ,IALN;AAMbF,eAAO2Q,aAAa3Q,KANP;AAObyG,mBAAWA;AAPE,OAAf;AASA3D,WAAK2D,SAAL,EAAgBxe,WAAhB,EAA6Boc,IAA7B;AACD,KAlCuF,CAkCtF;;;AAGF,QAAIyL,cAAcrJ,UAAU2I,YAA5B;AACA0B,kBAAc7kF,IAAd,CAAmB,UAAUo4E,IAAV,EAAgBoL,UAAhB,EAA4B;AAC7C,UAAI,CAACK,YAAY1jF,GAAZ,CAAgBqjF,UAAhB,CAAL,EAAkC;AAChCpL,aAAKrxE,OAAL;AACA89E,sBAAczkF,SAAd,CAAwBojF,UAAxB;AACD;AACF,KALD;AAMD;;AAED,WAASW,sBAAT,CAAgC3J,SAAhC,EAA2CkK,YAA3C,EAAyDE,kBAAzD,EAA6E34C,OAA7E,EAAsFg7B,GAAtF,EAA2F;AACzF,QAAIgc,cAAc2B,mBAAmB3B,WAAnB,GAAiC2B,mBAAmB3B,WAAnB,CAA+B;AAA/B,OAChDrP,WAAW;AACZG,aAAO6R;AADK,KAAX,CADH;AAIA3C,gBAAYzlF,OAAZ,GAAsB;AACpByuC,eAASA,OADW;AAEpBg7B,WAAKA,GAFe;AAGpBid,oBAAcQ,aAAaR,YAHP;AAIpB1J,iBAAWA;AAJS,KAAtB,CALyF,CAUtF;;AAEH,QAAIG,eAAesI,YAAYtI,YAAZ,GAA2BsI,YAAYtI,YAAZ,IAA4Bt6E,eAA1E;AACA,QAAIogE,aAAaikB,aAAajkB,UAA9B;AACA,QAAI4kB,kBAAkBX,aAAaW,eAAnC;AACA,QAAIQ,kBAAkB,IAAtB;AACA,QAAItN,kBAAkBmM,aAAanM,eAAnC,CAhByF,CAgBrC;AACpD;AACA;AACA;;AAEA,QAAI9X,UAAJ,EAAgB;AACdx0B,cAAQ25B,mBAAR,CAA4BnF,UAA5B,EAAwCqlB,UAAxC;AACD,KAFD,MAEO,IAAIT,eAAJ,EAAqB;AAC1BA,sBAAgBp5C,OAAhB,EAAyBg7B,GAAzB,EAA8BjnE,IAA9B,CAAmC8lF,UAAnC;AACD,KAFM,CAEL;AACF;AACA;AACA;AALO,SAMF;AACDD,0BAAkB,KAAlB;AACAxoF,eAAO4uC,QAAQq5B,SAAR,EAAP,EAA4BwgB,UAA5B;AACD;;AAEH,aAASA,UAAT,CAAoB9pB,WAApB,EAAiC;AAC/B,UAAIwnB,aAAaxnB,YAAY5C,GAA7B;AACA,UAAI2rB,OAAOpK,aAAax6E,GAAb,CAAiBqjF,UAAjB,CAAX;;AAEA,UAAI,CAACuB,IAAL,EAAW;AACTA,eAAOpK,aAAaz6E,GAAb,CAAiBsjF,UAAjB,EAA6B5P,WAAW;AAC7CG,iBAAOgS,SADsC;AAE7C3R,mBAAS4R;AAFoC,SAAX,CAA7B,CAAP,CADS,CAIJ;AACL;;AAEA/C,oBAAYxkE,KAAZ;AACD;;AAEDsmE,WAAKvnF,OAAL,GAAe;AACb8xC,eAAO0sB,WADM;AAEb6pB,yBAAiBA,eAFJ;AAGbtN,yBAAiBA;AAHJ,OAAf;AAKAwM,WAAKkB,KAAL,GAAahD,WAAb;AACA8B,WAAKV,OAAL,GAAewB,eAAf;AACAhP,WAAK2D,SAAL,EAAgBxe,WAAhB,EAA6B+oB,IAA7B;AACD,KAxDwF,CAwDvF;;;AAGF,QAAIlB,cAAcrJ,UAAU2I,YAA5B;AACAxI,iBAAa36E,IAAb,CAAkB,UAAU+kF,IAAV,EAAgBvB,UAAhB,EAA4B;AAC5C,UAAI,CAACK,YAAY1jF,GAAZ,CAAgBqjF,UAAhB,CAAL,EAAkC;AAChCuB,aAAKh+E,OAAL,GADgC,CAChB;AAChB;;AAEAk8E,oBAAYxkE,KAAZ;AACAk8D,qBAAav6E,SAAb,CAAuBojF,UAAvB;AACD;AACF,KARD;AASD;;AAED,WAASoC,gBAAT,CAA0BpoF,OAA1B,EAAmC;AACjCA,YAAQ0mF,YAAR,CAAqB1mF,QAAQyuC,OAA7B,EAAsCzuC,QAAQypE,GAA9C,EAAmDzpE,QAAQ+tC,OAA3D;AACD;;AAED,WAASw6C,SAAT,CAAmBvoF,OAAnB,EAA4B0oF,eAA5B,EAA6C;AAC3C,WAAO1oF,QAAQqoF,eAAR,IAA2BM,YAAlC;AACD;;AAED,WAASA,YAAT,GAAwB;AACtB,SAAKF,KAAL,CAAWxnE,KAAX;AACA,SAAKw4D,aAAL,GAAqBx4D,KAArB;AACD;;AAED,WAASunE,WAAT,GAAuB;AACrB,SAAKC,KAAL,IAAc,KAAKA,KAAL,CAAWxnE,KAAX,EAAd;AACD;;AAED,WAAS6mE,cAAT,CAAwB9nF,OAAxB,EAAiC;AAC/B,WAAOA,QAAQy2E,IAAR,IAAgBz2E,QAAQy2E,IAAR,CAAaz2E,QAAQ8xC,KAArB,EAA4B9xC,QAAQyuC,OAApC,EAA6CzuC,QAAQypE,GAArD,EAA0DzpE,QAAQ+tC,OAAlE,CAAvB;AACD;;AAED,WAASg6C,eAAT,CAAyB/nF,OAAzB,EAAkC;AAChC,QAAIA,QAAQioF,cAAZ,EAA4B;AAC1BjoF,cAAQJ,IAAR,CAAagpF,cAAb;AACD;;AAED,QAAIC,eAAe7oF,QAAQ6oF,YAAR,GAAuBz8C,iBAAiBpsC,QAAQu2E,KAAR,CAAcv2E,QAAQ8xC,KAAtB,EAA6B9xC,QAAQyuC,OAArC,EAA8CzuC,QAAQypE,GAAtD,EAA2DzpE,QAAQ+tC,OAAnE,CAAjB,CAA1C;AACA,WAAO86C,aAAalrF,MAAb,GAAsB,CAAtB,GAA0BhB,IAAIksF,YAAJ,EAAkB,UAAU7kF,CAAV,EAAa0gB,GAAb,EAAkB;AACnE,aAAOokE,uBAAuBpkE,GAAvB,CAAP;AACD,KAFgC,CAA1B,GAEFqkE,wBAFL;AAGD;;AAED,MAAIA,2BAA2BD,uBAAuB,CAAvB,CAA/B;;AAEA,WAASA,sBAAT,CAAgCE,cAAhC,EAAgD;AAC9C,WAAO,UAAUhxE,MAAV,EAAkBhY,OAAlB,EAA2B;AAChC,UAAIJ,OAAOI,QAAQJ,IAAnB;AACA,UAAIqpF,cAAcjpF,QAAQ6oF,YAAR,CAAqBG,cAArB,CAAlB;;AAEA,UAAIC,eAAeA,YAAYnI,QAA/B,EAAyC;AACvC,aAAK,IAAIrjF,IAAIua,OAAOqG,KAApB,EAA2B5gB,IAAIua,OAAOu+B,GAAtC,EAA2C94C,GAA3C,EAAgD;AAC9CwrF,sBAAYnI,QAAZ,CAAqBlhF,IAArB,EAA2BnC,CAA3B;AACD;AACF,OAJD,MAIO,IAAIwrF,eAAeA,YAAY7Q,QAA/B,EAAyC;AAC9C6Q,oBAAY7Q,QAAZ,CAAqBpgE,MAArB,EAA6BpY,IAA7B;AACD;AACF,KAXD;AAYD;;AAED,WAASooF,eAAT,CAAyBhoF,OAAzB,EAAkC;AAChC,WAAOA,QAAQJ,IAAR,CAAa0hB,KAAb,EAAP;AACD;;AAED,WAAS+3D,IAAT,CAAc2D,SAAd,EAAyBxe,WAAzB,EAAsCoc,IAAtC,EAA4C;AAC1C,QAAIoL,aAAaxnB,YAAY5C,GAA7B;;AAEA,QAAIqhB,WAAWD,UAAU2I,YAAV,CAAuBhjF,GAAvB,CAA2BqjF,UAA3B,CAAf;;AAEA,KAAC/I,SAASroE,IAAV,KAAmBqoE,SAASroE,IAAT,GAAgBgmE,IAAnC;AACAqC,aAASpoE,IAAT,IAAiBooE,SAASpoE,IAAT,CAAcwkE,IAAd,CAAmBuB,IAAnB,CAAjB;AACAqC,aAASpoE,IAAT,GAAgB+lE,IAAhB;AACAA,SAAKkL,eAAL,GAAuB7I,SAAS37D,KAAT,EAAvB;AACAs5D,SAAKvD,UAAL,GAAkB4F,QAAlB;AACD;;AAED+H,YAAUkE,gBAAV,GAA6B,UAAUhC,YAAV,EAAwBC,UAAxB,EAAoC;AAC/D,QAAIxmF,aAAaumF,YAAb,CAAJ,EAAgC;AAC9BA,qBAAe;AACbR,sBAAcQ,YADD;AAEbjkB,oBAAYkmB,iBAAiBjC,YAAjB;AAFC,OAAf;AAID;;AAEDA,iBAAatrB,GAAb,GAAmB5K,OAAO,cAAP,CAAnB;AACAm2B,mBAAeD,aAAaC,UAAb,GAA0BA,UAAzC;AACA,WAAOD,YAAP;AACD,GAXD;AAYA;;;;;;;;AASA,WAASiC,gBAAT,CAA0BC,UAA1B,EAAsC;AACpCnmB,iBAAa,IAAb;;AAEA,QAAI;AACF;AACAmmB,iBAAWC,WAAX,EAAwBC,OAAxB;AACD,KAHD,CAGE,OAAOnjF,CAAP,EAAU,CAAE;;AAEd,WAAO88D,UAAP;AACD;;AAED,MAAIomB,cAAc,EAAlB;AACA,MAAIC,UAAU,EAAd;AACA,MAAIrmB,UAAJ;AACAsmB,cAAYF,WAAZ,EAAyB9kB,WAAzB;AACAglB,cAAYD,OAAZ,EAAqBlgB,YAArB;;AAEAigB,cAAYlhB,gBAAZ,GAA+BkhB,YAAYjhB,mBAAZ,GAAkC,UAAUvnE,IAAV,EAAgB;AAC/EoiE,iBAAapiE,IAAb;AACD,GAFD;;AAIAwoF,cAAYjiB,aAAZ,GAA4B,UAAUoiB,IAAV,EAAgB;AAC1C,QAAIA,KAAK16C,QAAL,KAAkB,QAAlB,IAA8B06C,KAAKv4C,OAAvC,EAAgD;AAC9CgyB,mBAAaumB,KAAKv4C,OAAlB;AACD;AACF,GAJD;;AAMA,WAASs4C,WAAT,CAAqBprF,MAArB,EAA6BkyC,GAA7B,EAAkC;AAChC,SAAK,IAAIrzC,IAAT,IAAiBqzC,IAAIr0C,SAArB,EAAgC;AAC9B;AACAmC,aAAOnB,IAAP,IAAemG,IAAf;AACD;AACF;;AAED;;;;;;;;;;;;;;;;;;AAkBA,MAAIsmF,WAAW,CAAC,SAAD,EAAY,SAAZ,EAAuB,SAAvB,EAAkC,SAAlC,EAA6C,SAA7C,EAAwD,SAAxD,EAAmE,SAAnE,EAA8E,SAA9E,EAAyF,SAAzF,EAAoG,SAApG,EAA+G,SAA/G,EAA0H,SAA1H,EAAqI,SAArI,CAAf;AACA,MAAIC,aAAa;AACfrwE,WAAOowE,QADQ;AAEf1gB,gBAAY,CAAC,CAAC,SAAD,EAAY,SAAZ,EAAuB,SAAvB,CAAD,EAAoC,CAAC,SAAD,EAAY,SAAZ,EAAuB,SAAvB,EAAkC,SAAlC,EAA6C,SAA7C,EAAwD,SAAxD,CAApC,EAAwG,CAAC,SAAD,EAAY,SAAZ,EAAuB,SAAvB,EAAkC,SAAlC,EAA6C,SAA7C,EAAwD,SAAxD,EAAmE,SAAnE,EAA8E,SAA9E,EAAyF,SAAzF,CAAxG,EAA6M0gB,QAA7M;AAFG,GAAjB;;AAKA;;;;;;;;;;;;;;;;;;AAkBA,MAAIE,gBAAgB,MAApB;;AAEA,MAAIC,aAAa,SAAbA,UAAa,GAAY;AAC3B,WAAO;AACLC,gBAAU;AACRC,mBAAW;AACTzwE,iBAAOswE;AADE;AADH,OADL;AAMLI,gBAAU;AACRD,mBAAW;AACTzwE,iBAAOswE;AADE;AADH,OANL;AAWLK,iBAAW;AACT1+B,mBAAW;AACTjyC,iBAAOswE;AADE;AADF,OAXN;AAgBLM,iBAAW;AACTH,mBAAW;AACTjpF,gBAAM,QADG;AAETwY,iBAAO;AAFE;AADF,OAhBN;AAsBL6wE,iBAAW;AACTC,mBAAW;AACT9wE,iBAAOswE;AADE;AADF;AAtBN,KAAP;AA4BD,GA7BD;;AA+BA,MAAIrrB,eAAe,CAAC,SAAD,EAAY,SAAZ,EAAuB,SAAvB,EAAkC,SAAlC,EAA6C,SAA7C,EAAwD,SAAxD,EAAmE,SAAnE,EAA8E,SAA9E,EAAyF,SAAzF,EAAoG,SAApG,EAA+G,SAA/G,CAAnB;AACA,MAAIkG,QAAQ;AACVnrD,WAAOilD,YADG;AAEV57B,qBAAiB,MAFP;AAGV2tC,aAAS;AACPd,mBAAa;AACXua,mBAAW;AACTzwE,iBAAOswE;AADE,SADA;AAIXS,oBAAY;AACV/wE,iBAAOswE;AADG;AAJD;AADN,KAHC;AAaVU,YAAQ;AACN/+B,iBAAW;AACTjyC,eAAOswE;AADE;AADL,KAbE;AAkBVr+B,eAAW;AACTjyC,aAAOswE;AADE,KAlBD;AAqBV3I,WAAO;AACL11B,iBAAW;AACTjyC,eAAOswE;AADE;AADN,KArBG;AA0BV1Z,aAAS;AACPqa,iBAAW;AACThd,gBAAQ;AACNid,uBAAaZ;AADP;AADC;AADJ,KA1BC;AAiCVrI,cAAU;AACRh2B,iBAAW;AACTjyC,eAAOswE;AADE;AADH,KAjCA;AAsCV7Y,eAAW;AACTxlB,iBAAW;AACTjyC,eAAOswE;AADE;AADF,KAtCD;AA2CV7d,cAAU;AACRge,iBAAW;AACTzwE,eAAOswE;AADE,OADH;AAIRvc,iBAAW;AACTE,gBAAQ;AACNj0D,iBAAOilD,aAAa,CAAb;AADD;AADC,OAJH;AASRoc,aAAO;AACLpN,gBAAQ;AACNhiB,qBAAW;AACTjyC,mBAAOswE;AADE;AADL;AADH,OATC;AAgBRa,oBAAc;AACZld,gBAAQ;AACNj0D,iBAAOswE,aADD;AAENY,uBAAaZ;AAFP;AADI;AAhBN,KA3CA;AAkEVc,cAAUb,YAlEA;AAmEVc,aAASd,YAnEC;AAoEVe,eAAWf,YApED;AAqEVgB,kBAAchB,YArEJ;AAsEVpzD,UAAM;AACJq0D,cAAQ;AADJ,KAtEI;AAyEVh5B,WAAO;AACLx4C,aAAOilD;AADF,KAzEG;AA4EVkkB,WAAO;AACLxB,aAAO;AACL11B,mBAAW;AACTjyC,iBAAOswE;AADE;AADN;AADF,KA5EG;AAmFVvH,iBAAa;AACXhV,iBAAW;AACTE,gBAAQ;AACNj0D,iBAAO,SADD;AAENyxE,kBAAQ,SAFF;AAGNP,uBAAa,SAHP;AAINQ,wBAAc;AAJR;AADC;AADA;AAnFH,GAAZ;AA8FAvmB,QAAMomB,YAAN,CAAmBX,SAAnB,CAA6B9nE,IAA7B,GAAoC,KAApC;;AAEA;;;;;;;;;;;;;;;;;;;AAmBA;;;;;;;;AAQAq5C,iBAAe58D,MAAf,CAAsB;AACpBiC,UAAM,SADc;;AAGpB;;;AAGA66D,mBAAe;AACb;AACAqF,sBAAgBL,uBAFH;AAGb;AACAmB,oBAAc,IAJD;AAKb9B,kBAAY,IALC;AAMb3iE,cAAQ;AANK,KANK;AAcpBg/D,mBAAe,yBAAY;AACzBkF,yBAAmB,IAAnB;AACD;AAhBmB,GAAtB;AAkBA8b,cAAYx+E,MAAZ,CAAmB;AACjBiC,UAAM;AADW,GAAnB;;AAIA;;;;;;;;;;;;;;;;;;AAkBA,MAAI2C,SAAS5B,QAAb;AACA,MAAIY,OAAO3C,MAAX;AACA,MAAIyD,aAAa3C,YAAjB;AACA,MAAI4C,WAAWlF,UAAf;AACA,MAAIozC,iBAAiB+pB,eAAe/pB,cAApC;AACA,MAAIn2C,UAAU,OAAd;AACA,MAAIuhE,eAAe;AACjB/wB,aAAS;AADQ,GAAnB;AAGA,MAAIk/C,yBAAyB,CAA7B;AACA,MAAIC,4BAA4B,IAAhC;AACA,MAAIC,+BAA+B,IAAnC;AACA,MAAIC,yBAAyB,IAA7B;AACA,MAAIC,yBAAyB,IAA7B;AACA,MAAIC,wBAAwB,IAA5B;AACA,MAAIC,4BAA4B,IAAhC,CAj/tB4B,CAi/tBU;AACtC;;AAEA,MAAIC,wBAAwB,IAA5B;AACA,MAAIC,WAAW;AACbC,eAAW;AACTC,cAAQT,yBADC;AAETU,iBAAWT;AAFF,KADE;AAKbU,YAAQ;AACNC,cAAQV,sBADF;AAENW,cAAQV,sBAFF;AAGNW,aAAOV,qBAHD;AAINW,iBAAWV,yBAJL;AAKNW,aAAOV;AALD;AALK,GAAf,CAr/tB4B,CAiguBzB;AACH;AACA;AACA;AACA;;AAEA,MAAIW,kBAAkB,qBAAtB;AACA,MAAIC,iBAAiB,iBAArB;AACA,MAAIC,aAAa,iBAAjB;;AAEA,WAASC,oCAAT,CAA8Cn9D,MAA9C,EAAsD;AACpD,WAAO,UAAU/jB,SAAV,EAAqBxD,OAArB,EAA8B3H,OAA9B,EAAuC;AAC5C;AACAmL,kBAAYA,aAAaA,UAAUuM,WAAV,EAAzB;AACAlQ,eAASxL,SAAT,CAAmBkzB,MAAnB,EAA2B3xB,IAA3B,CAAgC,IAAhC,EAAsC4N,SAAtC,EAAiDxD,OAAjD,EAA0D3H,OAA1D;AACD,KAJD;AAKD;AACD;;;;AAKA,WAASssF,aAAT,GAAyB;AACvB9kF,aAASjK,IAAT,CAAc,IAAd;AACD;;AAED+uF,gBAActwF,SAAd,CAAwB+J,EAAxB,GAA6BsmF,qCAAqC,IAArC,CAA7B;AACAC,gBAActwF,SAAd,CAAwBgM,GAAxB,GAA8BqkF,qCAAqC,KAArC,CAA9B;AACAC,gBAActwF,SAAd,CAAwB0L,GAAxB,GAA8B2kF,qCAAqC,KAArC,CAA9B;AACA3sF,QAAM4sF,aAAN,EAAqB9kF,QAArB;AACA;;;;AAIA,WAAS+kF,OAAT,CAAiBn8D,GAAjB,EAAsBo8D,QAAtB,EAAgCx9E,IAAhC,EAAsC;AACpCA,WAAOA,QAAQ,EAAf,CADoC,CACjB;;AAEnB,QAAI,OAAOw9E,QAAP,KAAoB,QAAxB,EAAkC;AAChCA,iBAAWC,aAAaD,QAAb,CAAX;AACD;AACD;;;;AAKA,SAAKxrE,EAAL;AACA;;;;;AAKA,SAAK+3C,KAAL;AACA;;;;;AAKA,SAAK2zB,IAAL,GAAYt8D,GAAZ;AACA,QAAIu8D,kBAAkB,QAAtB;;AAEA;;;;AAIA,QAAI7rE,KAAK,KAAK8rE,GAAL,GAAWniD,OAAOra,GAAP,EAAY;AAC9B4a,gBAAUh8B,KAAKg8B,QAAL,IAAiB2hD,eADG;AAE9BvsE,wBAAkBpR,KAAKoR,gBAFO;AAG9B0C,aAAO9T,KAAK8T,KAHkB;AAI9BC,cAAQ/T,KAAK+T;AAJiB,KAAZ,CAApB;AAMA;;;;;;AAMA,SAAK8pE,iBAAL,GAAyBtN,SAASn/E,KAAK0gB,GAAGqqB,KAAR,EAAerqB,EAAf,CAAT,EAA6B,EAA7B,CAAzB;AACA,QAAI0rE,WAAWrvF,OAAMqvF,QAAN,CAAf;AACAA,gBAAY9b,eAAe8b,QAAf,EAAyB,IAAzB,CAAZ;AACA;;;;;AAKA,SAAK9nB,MAAL,GAAc8nB,QAAd;AACA;;;;;AAKA,SAAKM,YAAL,GAAoB,EAApB;AACA;;;;;AAKA,SAAKC,UAAL,GAAkB,EAAlB;AACA;;;;;AAKA,SAAKC,gBAAL,GAAwB,EAAxB;AACA;;;;;AAKA,SAAKtnB,cAAL,GAAsB,EAAtB;AACA;;;;;AAKA,SAAKunB,YAAL,GAAoB,IAAI1jB,uBAAJ,EAApB;AACA;;;;;AAKA,QAAIE,MAAM,KAAKlE,IAAL,GAAY2nB,mBAAmB,IAAnB,CAAtB,CAtFoC,CAsFY;;AAEhD,aAASC,gBAAT,CAA0BpqF,CAA1B,EAA6BC,CAA7B,EAAgC;AAC9B,aAAOD,EAAEqqF,MAAF,GAAWpqF,EAAEoqF,MAApB;AACD;;AAEDxvE,SAAKyvE,WAAL,EAAkBF,gBAAlB;AACAvvE,SAAK0vE,kBAAL,EAAyBH,gBAAzB;AACA;;;;AAIA,SAAKI,UAAL,GAAkB,IAAIvI,SAAJ,CAAc,IAAd,EAAoBvb,GAApB,EAAyB6jB,kBAAzB,EAA6CD,WAA7C,CAAlB;AACA7lF,aAASjK,IAAT,CAAc,IAAd;AACA;;;;;AAKA,SAAKiwF,cAAL,GAAsB,IAAIlB,aAAJ,EAAtB,CAzGoC,CAyGO;;AAE3C,SAAKmB,WAAL,GA3GoC,CA2GhB;;;AAGpB,SAAKxiF,MAAL,GAAc7K,KAAK,KAAK6K,MAAV,EAAkB,IAAlB,CAAd,CA9GoC,CA8GG;;AAEvC,SAAKyiF,eAAL,GAAuB,EAAvB;AACA5sE,OAAGnB,SAAH,CAAa5Z,EAAb,CAAgB,OAAhB,EAAyB,KAAK4nF,QAA9B,EAAwC,IAAxC;AACAC,sBAAkB9sE,EAAlB,EAAsB,IAAtB,EAlHoC,CAkHP;;AAE7B1e,mBAAe,IAAf;AACD;;AAED,MAAIyrF,eAAetB,QAAQvwF,SAA3B;;AAEA6xF,eAAaF,QAAb,GAAwB,YAAY;AAClC,QAAI,KAAKpU,SAAT,EAAoB;AAClB;AACD;;AAED,QAAIyD,YAAY,KAAKuQ,UAArB,CALkC,CAKD;;AAEjC,QAAI,KAAKpB,cAAL,CAAJ,EAA0B;AACxB,UAAI3gF,SAAS,KAAK2gF,cAAL,EAAqB3gF,MAAlC;AACA,WAAK0gF,eAAL,IAAwB,IAAxB;AACA4B,cAAQ,IAAR;AACAC,oBAAcjsE,MAAd,CAAqBvkB,IAArB,CAA0B,IAA1B;AACA,WAAK2uF,eAAL,IAAwB,KAAxB;AACA,WAAKC,cAAL,IAAuB,KAAvB;AACA6B,0BAAoBzwF,IAApB,CAAyB,IAAzB,EAA+BiO,MAA/B;AACAyiF,0BAAoB1wF,IAApB,CAAyB,IAAzB,EAA+BiO,MAA/B;AACD,KATD,CASE;AATF,SAUK,IAAIwxE,UAAUxE,UAAd,EAA0B;AAC3B;AACA,YAAI0V,aAAalD,sBAAjB;AACA,YAAIv8C,UAAU,KAAK0/C,MAAnB;AACA,YAAI1kB,MAAM,KAAKlE,IAAf;AACAyX,kBAAUxE,UAAV,GAAuB,KAAvB;;AAEA,WAAG;AACD,cAAIn3C,YAAY,CAAC,IAAIF,IAAJ,EAAjB;AACA67C,oBAAU4K,kBAAV,CAA6Bn5C,OAA7B,EAFC,CAEsC;;AAEvCuuC,oBAAU8J,yBAAV,CAAoCr4C,OAApC;AACAw3C,4BAAkB,IAAlB,EAAwBx3C,OAAxB,EALC,CAKiC;AAClC;AACA;AACA;AACA;AACA;;AAEAuuC,oBAAUgK,kBAAV,CAA6Bv4C,OAA7B;AACA2/C,uBAAa,IAAb,EAAmB,KAAKD,MAAxB,EAAgC1kB,GAAhC,EAAqC,QAArC;AACAykB,wBAAc,CAAC,IAAI/sD,IAAJ,EAAD,GAAcE,SAA5B;AACD,SAfD,QAeS6sD,aAAa,CAAb,IAAkBlR,UAAUxE,UAfrC,EAP2B,CAsBuB;;;AAGlD,YAAI,CAACwE,UAAUxE,UAAf,EAA2B;AACzB,eAAKoU,GAAL,CAASzhD,KAAT;AACD,SA3B0B,CA2BzB;AACF;AAED;AACJ,GAhDD;AAiDA;;;;AAKA0iD,eAAaQ,MAAb,GAAsB,YAAY;AAChC,WAAO,KAAK3B,IAAZ;AACD,GAFD;AAGA;;;;AAKAmB,eAAaS,KAAb,GAAqB,YAAY;AAC/B,WAAO,KAAK1B,GAAZ;AACD,GAFD;AAGA;;;;;;;;;;;;;;;AAgBAiB,eAAajpB,SAAb,GAAyB,UAAUz3B,MAAV,EAAkBohD,QAAlB,EAA4BC,UAA5B,EAAwC;AAC/D,QAAIhjF,MAAJ;;AAEA,QAAIjI,SAASgrF,QAAT,CAAJ,EAAwB;AACtBC,mBAAaD,SAASC,UAAtB;AACAhjF,eAAS+iF,SAAS/iF,MAAlB;AACA+iF,iBAAWA,SAASA,QAApB;AACD;;AAED,SAAKrC,eAAL,IAAwB,IAAxB;;AAEA,QAAI,CAAC,KAAKiC,MAAN,IAAgBI,QAApB,EAA8B;AAC5B,UAAI9pB,gBAAgB,IAAI4F,aAAJ,CAAkB,KAAK9E,IAAvB,CAApB;AACA,UAAIinB,WAAW,KAAK9nB,MAApB;AACA,UAAIj2B,UAAU,KAAK0/C,MAAL,GAAc,IAAI5pB,WAAJ,CAAgB,IAAhB,EAAsB,IAAtB,EAA4BioB,QAA5B,EAAsC/nB,aAAtC,CAA5B;AACAh2B,cAAQuuC,SAAR,GAAoB,KAAKuQ,UAAzB;AACA9+C,cAAQ1C,IAAR,CAAa,IAAb,EAAmB,IAAnB,EAAyBygD,QAAzB,EAAmC/nB,aAAnC;AACD;;AAED,SAAK0pB,MAAL,CAAYvpB,SAAZ,CAAsBz3B,MAAtB,EAA8B03B,uBAA9B;;AAEA,QAAI2pB,UAAJ,EAAgB;AACd,WAAKrC,cAAL,IAAuB;AACrB3gF,gBAAQA;AADa,OAAvB;AAGA,WAAK0gF,eAAL,IAAwB,KAAxB;AACD,KALD,MAKO;AACL4B,cAAQ,IAAR;AACAC,oBAAcjsE,MAAd,CAAqBvkB,IAArB,CAA0B,IAA1B,EAFK,CAE4B;AACjC;;AAEA,WAAKqvF,GAAL,CAASzhD,KAAT;;AAEA,WAAKghD,cAAL,IAAuB,KAAvB;AACA,WAAKD,eAAL,IAAwB,KAAxB;AACA8B,0BAAoBzwF,IAApB,CAAyB,IAAzB,EAA+BiO,MAA/B;AACAyiF,0BAAoB1wF,IAApB,CAAyB,IAAzB,EAA+BiO,MAA/B;AACD;AACF,GAtCD;AAuCA;;;;AAKAqiF,eAAaY,QAAb,GAAwB,YAAY;AAClCluE,YAAQD,GAAR,CAAY,iDAAZ;AACD,GAFD;AAGA;;;;AAKAutE,eAAaxhC,QAAb,GAAwB,YAAY;AAClC,WAAO,KAAK8hC,MAAZ;AACD,GAFD;AAGA;;;;AAKAN,eAAaxnB,SAAb,GAAyB,YAAY;AACnC,WAAO,KAAK8nB,MAAL,IAAe,KAAKA,MAAL,CAAY9nB,SAAZ,EAAtB;AACD,GAFD;AAGA;;;;AAKAwnB,eAAa/9D,QAAb,GAAwB,YAAY;AAClC,WAAO,KAAK88D,GAAL,CAAS98D,QAAT,EAAP;AACD,GAFD;AAGA;;;;AAKA+9D,eAAa99D,SAAb,GAAyB,YAAY;AACnC,WAAO,KAAK68D,GAAL,CAAS78D,SAAT,EAAP;AACD,GAFD;AAGA;;;;AAKA89D,eAAaa,mBAAb,GAAmC,YAAY;AAC7C,WAAO,KAAK9B,GAAL,CAASjjF,OAAT,CAAiBiG,GAAjB,IAAwBlU,OAAO0kB,gBAA/B,IAAmD,CAA1D;AACD,GAFD;AAGA;;;;;;;AAQAytE,eAAa1qD,iBAAb,GAAiC,UAAUn0B,IAAV,EAAgB;AAC/C,QAAI,CAAClU,MAAMT,eAAX,EAA4B;AAC1B;AACD;;AAED2U,WAAOA,QAAQ,EAAf;AACAA,SAAKq0B,UAAL,GAAkBr0B,KAAKq0B,UAAL,IAAmB,CAArC;AACAr0B,SAAK0zB,eAAL,GAAuB1zB,KAAK0zB,eAAL,IAAwB,KAAKyrD,MAAL,CAAYxrF,GAAZ,CAAgB,iBAAhB,CAA/C;AACA,QAAIme,KAAK,KAAK8rE,GAAd,CAR+C,CAQ5B;AACnB;AACA;AACA;AACA;AACA;;AAEA,WAAO9rE,GAAGnX,OAAH,CAAWw5B,iBAAX,CAA6Bn0B,IAA7B,CAAP;AACD,GAhBD;AAiBA;;;;;AAMA6+E,eAAac,aAAb,GAA6B,YAAY;AACvC,QAAI,CAAC7zF,MAAMR,YAAX,EAAyB;AACvB;AACD;;AAED,QAAIwmB,KAAK,KAAK8rE,GAAd;AACA,QAAI7gF,OAAO+U,GAAGpX,OAAH,CAAWsC,cAAX,EAAX,CANuC,CAMC;;AAExCnM,WAAOkM,IAAP,EAAa,UAAUR,EAAV,EAAc;AACzBA,SAAG4V,aAAH,CAAiB,IAAjB;AACD,KAFD;AAGA,WAAOL,GAAGnX,OAAH,CAAWilF,aAAX,EAAP;AACD,GAZD;AAaA;;;;;;;;;AAUAf,eAAagB,UAAb,GAA0B,UAAU7/E,IAAV,EAAgB;AACxCA,WAAOA,QAAQ,EAAf;AACA,QAAI8/E,oBAAoB9/E,KAAK8/E,iBAA7B;AACA,QAAIrgD,UAAU,KAAK0/C,MAAnB;AACA,QAAIY,yBAAyB,EAA7B;AACA,QAAIt0F,OAAO,IAAX;AACA+H,SAAKssF,iBAAL,EAAwB,UAAUt/C,aAAV,EAAyB;AAC/Cf,cAAQ24B,aAAR,CAAsB;AACpBt4B,kBAAUU;AADU,OAAtB,EAEG,UAAU83B,SAAV,EAAqB;AACtB,YAAI+W,OAAO5jF,KAAKirE,cAAL,CAAoB4B,UAAU0nB,QAA9B,CAAX;;AAEA,YAAI,CAAC3Q,KAAKtlB,KAAL,CAAW7sD,MAAhB,EAAwB;AACtB6iF,iCAAuB9uF,IAAvB,CAA4Bo+E,IAA5B;AACAA,eAAKtlB,KAAL,CAAW7sD,MAAX,GAAoB,IAApB;AACD;AACF,OATD;AAUD,KAXD;AAYA,QAAI+iF,MAAM,KAAKrC,GAAL,CAASjjF,OAAT,CAAiBm1B,OAAjB,OAA+B,KAA/B,GAAuC,KAAK6vD,aAAL,EAAvC,GAA8D,KAAKxrD,iBAAL,CAAuBn0B,IAAvB,EAA6BkgF,SAA7B,CAAuC,YAAYlgF,QAAQA,KAAKnO,IAAb,IAAqB,KAAjC,CAAvC,CAAxE;AACA2B,SAAKusF,sBAAL,EAA6B,UAAU1Q,IAAV,EAAgB;AAC3CA,WAAKtlB,KAAL,CAAW7sD,MAAX,GAAoB,KAApB;AACD,KAFD;AAGA,WAAO+iF,GAAP;AACD,GAvBD;AAwBA;;;;;;;;AASApB,eAAasB,mBAAb,GAAmC,UAAUngF,IAAV,EAAgB;AACjD,QAAI,CAAClU,MAAMT,eAAX,EAA4B;AAC1B;AACD;;AAED,QAAI+0F,UAAU,KAAKr2B,KAAnB;AACA,QAAIp2C,UAAUpe,KAAKoB,GAAnB;AACA,QAAIid,UAAUre,KAAKqB,GAAnB;AACA,QAAIypF,aAAa95C,QAAjB;;AAEA,QAAI+5C,gBAAgBF,OAAhB,CAAJ,EAA8B;AAC5B,UAAI3oE,OAAO4oE,UAAX;AACA,UAAIp/D,MAAMo/D,UAAV;AACA,UAAI3oE,QAAQ,CAAC2oE,UAAb;AACA,UAAI/2D,SAAS,CAAC+2D,UAAd;AACA,UAAIE,aAAa,EAAjB;AACA,UAAI3/E,MAAMZ,QAAQA,KAAKq0B,UAAb,IAA2B,CAArC;AACAxjC,aAAO2vF,SAAP,EAAkB,UAAUC,KAAV,EAAiBzuE,EAAjB,EAAqB;AACrC,YAAIyuE,MAAM12B,KAAN,KAAgBq2B,OAApB,EAA6B;AAC3B,cAAIprD,SAASyrD,MAAMtsD,iBAAN,CAAwBhmC,OAAM6R,IAAN,CAAxB,CAAb;AACA,cAAIs4C,eAAemoC,MAAMpB,MAAN,GAAezpD,qBAAf,EAAnB;AACAne,iBAAO9D,QAAQ2kC,aAAa7gC,IAArB,EAA2BA,IAA3B,CAAP;AACAwJ,gBAAMtN,QAAQ2kC,aAAar3B,GAArB,EAA0BA,GAA1B,CAAN;AACAvJ,kBAAQ9D,QAAQ0kC,aAAa5gC,KAArB,EAA4BA,KAA5B,CAAR;AACA4R,mBAAS1V,QAAQ0kC,aAAahvB,MAArB,EAA6BA,MAA7B,CAAT;AACAi3D,qBAAWtvF,IAAX,CAAgB;AACdmwB,iBAAK4T,MADS;AAEdvd,kBAAM6gC,aAAa7gC,IAFL;AAGdwJ,iBAAKq3B,aAAar3B;AAHJ,WAAhB;AAKD;AACF,OAdD;AAeAxJ,cAAQ7W,GAAR;AACAqgB,aAAOrgB,GAAP;AACA8W,eAAS9W,GAAT;AACA0oB,gBAAU1oB,GAAV;AACA,UAAIkT,QAAQ4D,QAAQD,IAApB;AACA,UAAI1D,SAASuV,SAASrI,GAAtB;AACA,UAAIy/D,eAAe3wF,cAAnB;AACA2wF,mBAAa5sE,KAAb,GAAqBA,KAArB;AACA4sE,mBAAa3sE,MAAb,GAAsBA,MAAtB;AACA,UAAIjC,KAAK2pB,OAAOilD,YAAP,CAAT;AACAltF,WAAK+sF,UAAL,EAAiB,UAAU/hD,IAAV,EAAgB;AAC/B,YAAIma,MAAM,IAAIvrB,MAAJ,CAAW;AACnBhO,iBAAO;AACLxqB,eAAG4pC,KAAK/mB,IAAL,GAAY7W,GAAZ,GAAkB6W,IADhB;AAEL5iB,eAAG2pC,KAAKvd,GAAL,GAAWrgB,GAAX,GAAiBqgB,GAFf;AAGLV,mBAAOie,KAAKpd;AAHP;AADY,SAAX,CAAV;AAOAtP,WAAG5c,GAAH,CAAOyjD,GAAP;AACD,OATD;AAUA7mC,SAAG2qB,kBAAH;AACA,aAAOikD,aAAaR,SAAb,CAAuB,YAAYlgF,QAAQA,KAAKnO,IAAb,IAAqB,KAAjC,CAAvB,CAAP;AACD,KA5CD,MA4CO;AACL,aAAO,KAAKguF,UAAL,CAAgB7/E,IAAhB,CAAP;AACD;AACF,GAzDD;AA0DA;;;;;;;;;;;;;;;;;;;AAoBA6+E,eAAa8B,cAAb,GAA8BjvF,MAAMkvF,cAAN,EAAsB,gBAAtB,CAA9B;AACA;;;;;;;;;;;;;;;;;;;AAmBA/B,eAAagC,gBAAb,GAAgCnvF,MAAMkvF,cAAN,EAAsB,kBAAtB,CAAhC;;AAEA,WAASA,cAAT,CAAwBp/C,UAAxB,EAAoC9B,MAApC,EAA4CxvC,KAA5C,EAAmD;AACjD,QAAIuvC,UAAU,KAAK0/C,MAAnB;;AAEA,QAAI2B,eAAe,KAAK7C,YAAL,CAAkBpjB,oBAAlB,EAAnB;;AAEA,QAAIxsE,MAAJ;AACAqxC,aAASF,YAAYC,OAAZ,EAAqBC,MAArB,CAAT;;AAEA,SAAK,IAAIjxC,IAAI,CAAb,EAAgBA,IAAIqyF,aAAanyF,MAAjC,EAAyCF,GAAzC,EAA8C;AAC5C,UAAImsE,WAAWkmB,aAAaryF,CAAb,CAAf;;AAEA,UAAImsE,SAASp5B,UAAT,KAAwB,CAACnzC,SAASusE,SAASp5B,UAAT,EAAqB/B,OAArB,EAA8BC,MAA9B,EAAsCxvC,KAAtC,CAAV,KAA2D,IAAvF,EAA6F;AAC3F,eAAO7B,MAAP;AACD;AACF;AACF;AACD;;;;;;;;;;;;;;;;;;AAmBAwwF,eAAakC,YAAb,GAA4B,UAAUrhD,MAAV,EAAkBxvC,KAAlB,EAAyB;AACnD,QAAIuvC,UAAU,KAAK0/C,MAAnB;AACA,QAAI9wF,MAAJ;AACAqxC,aAASF,YAAYC,OAAZ,EAAqBC,MAArB,CAAT;AACA7uC,WAAO6uC,MAAP,EAAe,UAAUQ,MAAV,EAAkBlxC,GAAlB,EAAuB;AACpCA,UAAIgB,OAAJ,CAAY,QAAZ,KAAyB,CAAzB,IAA8Ba,OAAOqvC,MAAP,EAAe,UAAU4C,KAAV,EAAiB;AAC5D,YAAI83B,WAAW93B,MAAM+nC,gBAArB;;AAEA,YAAIjQ,YAAYA,SAASomB,YAAzB,EAAuC;AACrC3yF,oBAAU,CAAC,CAACusE,SAASomB,YAAT,CAAsB9wF,KAAtB,CAAZ;AACD,SAFD,MAEO,IAAIlB,QAAQ,cAAZ,EAA4B;AACjC,cAAIqgF,OAAO,KAAK0O,UAAL,CAAgBj7C,MAAMk9C,QAAtB,CAAX;;AAEA,cAAI3Q,QAAQA,KAAK2R,YAAjB,EAA+B;AAC7B3yF,sBAAUghF,KAAK2R,YAAL,CAAkB9wF,KAAlB,EAAyB4yC,KAAzB,CAAV;AACD,WAFD,MAEO,CAAE;AACV,SANM,MAMA,CAAE;AACV,OAZ6B,EAY3B,IAZ2B,CAA9B;AAaD,KAdD,EAcG,IAdH;AAeA,WAAO,CAAC,CAACz0C,MAAT;AACD,GApBD;AAqBA;;;;;;;;;;;;;;;;AAiBAwwF,eAAaoC,SAAb,GAAyB,UAAUvhD,MAAV,EAAkBy4C,UAAlB,EAA8B;AACrD,QAAI14C,UAAU,KAAK0/C,MAAnB;AACAz/C,aAASF,YAAYC,OAAZ,EAAqBC,MAArB,EAA6B;AACpCC,uBAAiB;AADmB,KAA7B,CAAT;AAGA,QAAI6vB,cAAc9vB,OAAO8vB,WAAzB;AACA,QAAI5+D,OAAO4+D,YAAY2S,OAAZ,EAAX;AACA,QAAInjC,kBAAkBU,OAAOzwC,cAAP,CAAsB,iBAAtB,IAA2CywC,OAAOV,eAAlD,GAAoEU,OAAOzwC,cAAP,CAAsB,WAAtB,IAAqC2B,KAAKsuC,eAAL,CAAqBQ,OAAOT,SAA5B,CAArC,GAA8E,IAAxK;AACA,WAAOD,mBAAmB,IAAnB,GAA0BpuC,KAAK+1E,aAAL,CAAmB3nC,eAAnB,EAAoCm5C,UAApC,CAA1B,GAA4EvnF,KAAKqwF,SAAL,CAAe9I,UAAf,CAAnF;AACD,GATD;AAUA;;;;;;AAOA0G,eAAaqC,uBAAb,GAAuC,UAAUriD,cAAV,EAA0B;AAC/D,WAAO,KAAK63B,cAAL,CAAoB73B,eAAemhD,QAAnC,CAAP;AACD,GAFD;AAGA;;;;;;AAOAnB,eAAasC,oBAAb,GAAoC,UAAU3xB,WAAV,EAAuB;AACzD,WAAO,KAAKuuB,UAAL,CAAgBvuB,YAAYwwB,QAA5B,CAAP;AACD,GAFD;;AAIA,MAAIjB,gBAAgB;AAClBqC,sBAAkB,0BAAUriD,OAAV,EAAmB;AACnC+/C,cAAQ,IAAR;AACAC,oBAAcjsE,MAAd,CAAqBvkB,IAArB,CAA0B,IAA1B,EAAgCwwC,OAAhC;AACD,KAJiB;;AAMlB;;;;AAIAjsB,YAAQ,gBAAUisB,OAAV,EAAmB;AACzB;AACA,UAAIU,UAAU,KAAK0/C,MAAnB;AACA,UAAI1kB,MAAM,KAAKlE,IAAf;AACA,UAAIzkD,KAAK,KAAK8rE,GAAd;AACA,UAAIyD,cAAc,KAAKpD,YAAvB;AACA,UAAIjQ,YAAY,KAAKuQ,UAArB,CANyB,CAMQ;;AAEjC,UAAI,CAAC9+C,OAAL,EAAc;AACZ;AACD;;AAEDuuC,gBAAUtsB,WAAV,CAAsBjiB,OAAtB,EAA+BV,OAA/B;AACAivC,gBAAU4K,kBAAV,CAA6Bn5C,OAA7B,EAbyB,CAac;AACvC;AACA;AACA;AACA;;AAEA4hD,kBAAY1sF,MAAZ,CAAmB8qC,OAAnB,EAA4Bg7B,GAA5B;AACAuT,gBAAU8J,yBAAV,CAAoCr4C,OAApC,EAA6CV,OAA7C,EApByB,CAoB8B;AACvD;AACA;;AAEAk4C,wBAAkB,IAAlB,EAAwBx3C,OAAxB,EAxByB,CAwBS;AAClC;AACA;AACA;;AAEA4hD,kBAAYvuE,MAAZ,CAAmB2sB,OAAnB,EAA4Bg7B,GAA5B;AACA1L,wBAAkBtvB,OAAlB;AACAuuC,gBAAUgK,kBAAV,CAA6Bv4C,OAA7B,EAAsCV,OAAtC;AACAsvC,aAAO,IAAP,EAAa5uC,OAAb,EAAsBg7B,GAAtB,EAA2B17B,OAA3B,EAhCyB,CAgCY;;AAErC,UAAIrL,kBAAkB+L,QAAQ9rC,GAAR,CAAY,iBAAZ,KAAkC,aAAxD,CAlCyB,CAkC8C;;AAEvE,UAAI,CAAC7H,MAAMT,eAAX,EAA4B;AAC1B,YAAIkf,WAAW/B,MAAMkrB,eAAN,CAAf;AACAA,0BAAkBlpB,UAAUD,QAAV,EAAoB,KAApB,CAAlB;;AAEA,YAAIA,SAAS,CAAT,MAAgB,CAApB,EAAuB;AACrBmpB,4BAAkB,aAAlB;AACD;AACF,OAPD,MAOO;AACL5hB,WAAG2hB,kBAAH,CAAsBC,eAAtB;AACD;;AAED4tD,6BAAuB7hD,OAAvB,EAAgCg7B,GAAhC,EA/CyB,CA+Ca;AACvC,KA1DiB;;AA4DlB;;;;AAIAl6D,qBAAiB,yBAAUw+B,OAAV,EAAmB;AAClC,UAAIU,UAAU,KAAK0/C,MAAnB;AACA,UAAIoC,QAAQ,IAAZ;AACA,UAAI9mB,MAAM,KAAKlE,IAAf,CAHkC,CAGb;;AAErB,UAAI,CAAC92B,OAAL,EAAc;AACZ;AACD,OAPiC,CAOhC;;;AAGF,UAAI+hD,qBAAqB,EAAzB;AACA/hD,cAAQ24B,aAAR,CAAsB,UAAU53B,aAAV,EAAyB3B,cAAzB,EAAyC;AAC7D,YAAI4iD,gBAAgBF,MAAML,uBAAN,CAA8BriD,cAA9B,CAApB;;AAEA,YAAI4iD,iBAAiBA,cAAcC,OAAnC,EAA4C;AAC1C,cAAID,cAAclhF,eAAlB,EAAmC;AACjC,gBAAIlS,SAASozF,cAAclhF,eAAd,CAA8Bs+B,cAA9B,EAA8CY,OAA9C,EAAuDg7B,GAAvD,EAA4D17B,OAA5D,CAAb;AACA1wC,sBAAUA,OAAOykB,MAAjB,IAA2B0uE,mBAAmBvwF,IAAnB,CAAwBwwF,aAAxB,CAA3B;AACD,WAHD,MAGO;AACLD,+BAAmBvwF,IAAnB,CAAwBwwF,aAAxB;AACD;AACF;AACF,OAXD;AAYA,UAAIE,iBAAiB9tF,eAArB;AACA4rC,cAAQu5B,UAAR,CAAmB,UAAUxJ,WAAV,EAAuB;AACxC,YAAIoyB,YAAYL,MAAMxD,UAAN,CAAiBvuB,YAAYwwB,QAA7B,CAAhB;;AAEA,YAAI4B,UAAUrhF,eAAd,EAA+B;AAC7B,cAAIlS,SAASuzF,UAAUrhF,eAAV,CAA0BivD,WAA1B,EAAuC/vB,OAAvC,EAAgDg7B,GAAhD,EAAqD17B,OAArD,CAAb;AACA1wC,oBAAUA,OAAOykB,MAAjB,IAA2B6uE,eAAejuF,GAAf,CAAmB87D,YAAY5C,GAA/B,EAAoC,CAApC,CAA3B;AACD,SAHD,MAGO;AACL+0B,yBAAejuF,GAAf,CAAmB87D,YAAY5C,GAA/B,EAAoC,CAApC;AACD;AACF,OATD;AAUAmC,wBAAkBtvB,OAAlB,EAlCkC,CAkCN;AAC5B;;AAEA,WAAK8+C,UAAL,CAAgBvG,kBAAhB,CAAmCv4C,OAAnC,EAA4CV,OAA5C,EAAqD;AACnD25C,kBAAU,IADyC;AAEnDC,kBAAUgJ;AAFyC,OAArD,EArCkC,CAwC9B;AACJ;;;AAGAvC,mBAAamC,KAAb,EAAoB9hD,OAApB,EAA6Bg7B,GAA7B,EAAkC17B,OAAlC,EAA2C4iD,cAA3C;AACAL,6BAAuB7hD,OAAvB,EAAgC,KAAK82B,IAArC;AACD,KA9GiB;;AAgHlB;;;;AAIAgY,gBAAY,oBAAUxvC,OAAV,EAAmB;AAC7B,UAAIU,UAAU,KAAK0/C,MAAnB,CAD6B,CACF;;AAE3B,UAAI,CAAC1/C,OAAL,EAAc;AACZ;AACD;;AAEDwvC,YAAMgB,gBAAN,CAAuBlxC,OAAvB,EAAgC,YAAhC;AACAgwB,wBAAkBtvB,OAAlB,EAR6B,CAQD;;AAE5B,WAAK8+C,UAAL,CAAgBvG,kBAAhB,CAAmCv4C,OAAnC,EAA4CV,OAA5C,EAAqD;AACnD25C,kBAAU;AADyC,OAArD;;AAIArK,aAAO,IAAP,EAAa,KAAK8Q,MAAlB,EAA0B,KAAK5oB,IAA/B,EAAqCx3B,OAArC;AACAuiD,6BAAuB7hD,OAAvB,EAAgC,KAAK82B,IAArC;AACD,KApIiB;;AAsIlB;;;;AAIAkY,kBAAc,sBAAU1vC,OAAV,EAAmB;AAC/BggD,oBAAcjsE,MAAd,CAAqBvkB,IAArB,CAA0B,IAA1B,EAAgCwwC,OAAhC,EAD+B,CACW;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACD,KAtJiB;;AAwJlB;;;;AAIAyvC,kBAAc,sBAAUzvC,OAAV,EAAmB;AAC/BggD,oBAAcjsE,MAAd,CAAqBvkB,IAArB,CAA0B,IAA1B,EAAgCwwC,OAAhC,EAD+B,CACW;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACD;AAxKiB,GAApB;;AA2KA,WAAS+/C,OAAT,CAAiByC,KAAjB,EAAwB;AACtB,QAAI9hD,UAAU8hD,MAAMpC,MAApB;AACA,QAAInR,YAAYuT,MAAMhD,UAAtB;AACAvQ,cAAUoJ,gBAAV,CAA2B33C,OAA3B;AACAuuC,cAAUsJ,iBAAV;AACAM,gBAAY2J,KAAZ,EAAmB,WAAnB,EAAgC9hD,OAAhC,EAAyCuuC,SAAzC;AACA4J,gBAAY2J,KAAZ,EAAmB,OAAnB,EAA4B9hD,OAA5B,EAAqCuuC,SAArC;AACAA,cAAUvG,IAAV;AACD;AACD;;;;AAKA,WAASoa,cAAT,CAAwBN,KAAxB,EAA+BrhE,MAA/B,EAAuC6e,OAAvC,EAAgDe,QAAhD,EAA0DmC,OAA1D,EAAmE;AACjE,QAAIxC,UAAU8hD,MAAMpC,MAApB,CADiE,CACrC;;AAE5B,QAAI,CAACr/C,QAAL,EAAe;AACb;AACA;AACA;AACAtsC,WAAK+tF,MAAMvD,gBAAN,CAAuBvsF,MAAvB,CAA8B8vF,MAAMzD,YAApC,CAAL,EAAwDgE,QAAxD;AACA;AACD;;AAED,QAAIlqB,QAAQ,EAAZ;AACAA,UAAM93B,WAAW,IAAjB,IAAyBf,QAAQe,WAAW,IAAnB,CAAzB;AACA83B,UAAM93B,WAAW,OAAjB,IAA4Bf,QAAQe,WAAW,OAAnB,CAA5B;AACA83B,UAAM93B,WAAW,MAAjB,IAA2Bf,QAAQe,WAAW,MAAnB,CAA3B;AACA,QAAIjtC,YAAY;AACditC,gBAAUA,QADI;AAEd83B,aAAOA;AAFO,KAAhB;AAIA31B,gBAAYpvC,UAAUovC,OAAV,GAAoBA,OAAhC,EAnBiE,CAmBvB;;AAE1C,QAAI8/C,kBAAkBhjD,QAAQgjD,eAA9B;;AAEA,QAAIA,mBAAmB,IAAvB,EAA6B;AAC3BA,wBAAkBluF,cAAcupC,iBAAiB2kD,eAAjB,CAAd,CAAlB;AACD,KAzBgE,CAyB/D;;;AAGFtiD,eAAWA,QAAQ24B,aAAR,CAAsBvlE,SAAtB,EAAiC,UAAUiwC,KAAV,EAAiB;AAC3D,UAAI,CAACi/C,eAAD,IAAoBA,gBAAgBpuF,GAAhB,CAAoBmvC,MAAM9wB,EAA1B,KAAiC,IAAzD,EAA+D;AAC7D8vE,iBAASP,MAAMzhD,aAAa,QAAb,GAAwB,YAAxB,GAAuC,gBAA7C,EAA+DgD,MAAMk9C,QAArE,CAAT;AACD;AACF,KAJU,EAIRuB,KAJQ,CAAX;;AAMA,aAASO,QAAT,CAAkBzS,IAAlB,EAAwB;AACtBA,cAAQA,KAAKqS,OAAb,IAAwBrS,KAAKnvD,MAAL,CAAxB,IAAwCmvD,KAAKnvD,MAAL,EAAamvD,KAAK2S,OAAlB,EAA2BviD,OAA3B,EAAoC8hD,MAAMhrB,IAA1C,EAAgDx3B,OAAhD,CAAxC;AACD;AACF;AACD;;;;;;;;AASA8/C,eAAa5iF,MAAb,GAAsB,UAAU+D,IAAV,EAAgB;AACpC,SAAK49E,GAAL,CAAS3hF,MAAT,CAAgB+D,IAAhB;;AAEA,QAAIy/B,UAAU,KAAK0/C,MAAnB,CAHoC,CAGT;;AAE3B,SAAK8C,UAAL,IAAmB,KAAKA,UAAL,CAAgBhmF,MAAhB,EAAnB;;AAEA,QAAI,CAACwjC,OAAL,EAAc;AACZ;AACD;;AAED,QAAIs2B,gBAAgBt2B,QAAQq2B,WAAR,CAAoB,OAApB,CAApB;AACA,QAAIt5D,SAASwD,QAAQA,KAAKxD,MAA1B;AACA,SAAK0gF,eAAL,IAAwB,IAAxB;AACAnnB,qBAAiB+oB,QAAQ,IAAR,CAAjB;AACAC,kBAAcjsE,MAAd,CAAqBvkB,IAArB,CAA0B,IAA1B;AACA,SAAK2uF,eAAL,IAAwB,KAAxB;AACA8B,wBAAoBzwF,IAApB,CAAyB,IAAzB,EAA+BiO,MAA/B;AACAyiF,wBAAoB1wF,IAApB,CAAyB,IAAzB,EAA+BiO,MAA/B;AACD,GAnBD;;AAqBA,WAASy6E,iBAAT,CAA2BsK,KAA3B,EAAkC9hD,OAAlC,EAA2C;AACzC,QAAIyiD,YAAYX,MAAMxD,UAAtB;AACA,QAAI/P,YAAYuT,MAAMhD,UAAtB;AACA9+C,YAAQu5B,UAAR,CAAmB,UAAUxJ,WAAV,EAAuB;AACxCwe,gBAAUiJ,iBAAV,CAA4BznB,WAA5B,EAAyC0yB,UAAU1yB,YAAYwwB,QAAtB,CAAzC;AACD,KAFD;AAGD;AACD;;;;;;AAOAnB,eAAasD,WAAb,GAA2B,UAAUn0F,IAAV,EAAgBo0F,GAAhB,EAAqB;AAC9C,QAAI7tF,SAASvG,IAAT,CAAJ,EAAoB;AAClBo0F,YAAMp0F,IAAN;AACAA,aAAO,EAAP;AACD;;AAEDA,WAAOA,QAAQ,SAAf;AACA,SAAKq0F,WAAL;;AAEA,QAAI,CAACC,eAAet0F,IAAf,CAAL,EAA2B;AACzB;AACD;;AAED,QAAIuO,KAAK+lF,eAAet0F,IAAf,EAAqB,KAAKuoE,IAA1B,EAAgC6rB,GAAhC,CAAT;AACA,QAAItwE,KAAK,KAAK8rE,GAAd;AACA,SAAKqE,UAAL,GAAkB1lF,EAAlB;AACAuV,OAAG5c,GAAH,CAAOqH,EAAP;AACD,GAjBD;AAkBA;;;;AAKAsiF,eAAawD,WAAb,GAA2B,YAAY;AACrC,SAAKJ,UAAL,IAAmB,KAAKrE,GAAL,CAASt3E,MAAT,CAAgB,KAAK27E,UAArB,CAAnB;AACA,SAAKA,UAAL,GAAkB,IAAlB;AACD,GAHD;AAIA;;;;;AAMApD,eAAa0D,mBAAb,GAAmC,UAAUC,QAAV,EAAoB;AACrD,QAAIzjD,UAAUnvC,OAAO,EAAP,EAAW4yF,QAAX,CAAd;AACAzjD,YAAQltC,IAAR,GAAe4wF,eAAeD,SAAS3wF,IAAxB,CAAf;AACA,WAAOktC,OAAP;AACD,GAJD;AAKA;;;;;;;;;;;;;AAcA8/C,eAAa6D,cAAb,GAA8B,UAAU3jD,OAAV,EAAmBzB,GAAnB,EAAwB;AACpD,QAAI,CAAC/oC,SAAS+oC,GAAT,CAAL,EAAoB;AAClBA,YAAM;AACJ9gC,gBAAQ,CAAC,CAAC8gC;AADN,OAAN;AAGD;;AAED,QAAI,CAACqlD,QAAQ5jD,QAAQltC,IAAhB,CAAL,EAA4B;AAC1B;AACD,KATmD,CASlD;;;AAGF,QAAI,CAAC,KAAKstF,MAAV,EAAkB;AAChB;AACD,KAdmD,CAclD;;;AAGF,QAAI,KAAKjC,eAAL,CAAJ,EAA2B;AACzB,WAAKwB,eAAL,CAAqBztF,IAArB,CAA0B8tC,OAA1B;;AAEA;AACD;;AAED6jD,qBAAiBr0F,IAAjB,CAAsB,IAAtB,EAA4BwwC,OAA5B,EAAqCzB,IAAI9gC,MAAzC;;AAEA,QAAI8gC,IAAInB,KAAR,EAAe;AACb,WAAKyhD,GAAL,CAASzhD,KAAT,CAAe,IAAf;AACD,KAFD,MAEO,IAAImB,IAAInB,KAAJ,KAAc,KAAd,IAAuBrwC,MAAMb,OAAN,CAAcmB,MAAzC,EAAiD;AACtD;AACA;AACA;AACA;AACA;AACA,WAAKyxF,iBAAL;AACD;;AAEDmB,wBAAoBzwF,IAApB,CAAyB,IAAzB,EAA+B+uC,IAAI9gC,MAAnC;AACAyiF,wBAAoB1wF,IAApB,CAAyB,IAAzB,EAA+B+uC,IAAI9gC,MAAnC;AACD,GAtCD;;AAwCA,WAASomF,gBAAT,CAA0B7jD,OAA1B,EAAmCviC,MAAnC,EAA2C;AACzC,QAAIqmF,cAAc9jD,QAAQltC,IAA1B;AACA,QAAIixF,gBAAgB/jD,QAAQ+jD,aAA5B;AACA,QAAIC,aAAaJ,QAAQE,WAAR,CAAjB;AACA,QAAIG,aAAaD,WAAWC,UAA5B;AACA,QAAIC,UAAU,CAACD,WAAWlwE,MAAX,IAAqB,QAAtB,EAAgC7J,KAAhC,CAAsC,GAAtC,CAAd;AACA,QAAIinE,eAAe+S,QAAQ95E,GAAR,EAAnB;AACA85E,cAAUA,QAAQ,CAAR,KAAc,IAAd,IAAsBxgD,eAAewgD,QAAQ,CAAR,CAAf,CAAhC;AACA,SAAK/F,eAAL,IAAwB,IAAxB;AACA,QAAIgG,WAAW,CAACnkD,OAAD,CAAf;AACA,QAAIokD,UAAU,KAAd,CAVyC,CAUpB;;AAErB,QAAIpkD,QAAQqkD,KAAZ,EAAmB;AACjBD,gBAAU,IAAV;AACAD,iBAAWv1F,IAAIoxC,QAAQqkD,KAAZ,EAAmB,UAAU5kD,IAAV,EAAgB;AAC5CA,eAAO3uC,SAASD,OAAO,EAAP,EAAW4uC,IAAX,CAAT,EAA2BO,OAA3B,CAAP;AACAP,aAAK4kD,KAAL,GAAa,IAAb;AACA,eAAO5kD,IAAP;AACD,OAJU,CAAX;AAKD;;AAED,QAAI6kD,gBAAgB,EAApB;AACA,QAAIb,QAAJ;AACA,QAAIc,aAAaT,gBAAgB,WAAhB,IAA+BA,gBAAgB,UAAhE;AACArvF,SAAK0vF,QAAL,EAAe,UAAUK,SAAV,EAAqB;AAClC;AACAf,iBAAWO,WAAWS,MAAX,CAAkBD,SAAlB,EAA6B,KAAKpE,MAAlC,EAA0C,KAAK5oB,IAA/C,CAAX,CAFkC,CAE+B;;AAEjEisB,iBAAWA,YAAY5yF,OAAO,EAAP,EAAW2zF,SAAX,CAAvB,CAJkC,CAIY;;AAE9Cf,eAAS3wF,IAAT,GAAgBmxF,WAAWlrF,KAAX,IAAoB0qF,SAAS3wF,IAA7C;AACAwxF,oBAAcpyF,IAAd,CAAmBuxF,QAAnB,EAPkC,CAOJ;;AAE9B,UAAIc,UAAJ,EAAgB;AACd;AACAzB,uBAAe,IAAf,EAAqB3R,YAArB,EAAmCqT,SAAnC,EAA8C,QAA9C;AACD,OAHD,MAGO,IAAIN,OAAJ,EAAa;AAClBpB,uBAAe,IAAf,EAAqB3R,YAArB,EAAmCqT,SAAnC,EAA8CN,QAAQxiD,IAAtD,EAA4DwiD,QAAQ3tF,GAApE;AACD;AACF,KAfD,EAeG,IAfH;;AAiBA,QAAI46E,iBAAiB,MAAjB,IAA2B,CAACoT,UAA5B,IAA0C,CAACL,OAA/C,EAAwD;AACtD;AACA,UAAI,KAAK9F,cAAL,CAAJ,EAA0B;AACxB;AACA2B,gBAAQ,IAAR;AACAC,sBAAcjsE,MAAd,CAAqBvkB,IAArB,CAA0B,IAA1B,EAAgCwwC,OAAhC;AACA,aAAKo+C,cAAL,IAAuB,KAAvB;AACD,OALD,MAKO;AACL4B,sBAAc7O,YAAd,EAA4B3hF,IAA5B,CAAiC,IAAjC,EAAuCwwC,OAAvC;AACD;AACF,KAnDwC,CAmDvC;;;AAGF,QAAIokD,OAAJ,EAAa;AACXX,iBAAW;AACT3wF,cAAMmxF,WAAWlrF,KAAX,IAAoB+qF,WADjB;AAETC,uBAAeA,aAFN;AAGTM,eAAOC;AAHE,OAAX;AAKD,KAND,MAMO;AACLb,iBAAWa,cAAc,CAAd,CAAX;AACD;;AAED,SAAKnG,eAAL,IAAwB,KAAxB;AACA,KAAC1gF,MAAD,IAAW,KAAKgiF,cAAL,CAAoBrlF,OAApB,CAA4BqpF,SAAS3wF,IAArC,EAA2C2wF,QAA3C,CAAX;AACD;;AAED,WAASxD,mBAAT,CAA6BxiF,MAA7B,EAAqC;AACnC,QAAIinF,iBAAiB,KAAK/E,eAA1B;;AAEA,WAAO+E,eAAe90F,MAAtB,EAA8B;AAC5B,UAAIowC,UAAU0kD,eAAexwC,KAAf,EAAd;AACA2vC,uBAAiBr0F,IAAjB,CAAsB,IAAtB,EAA4BwwC,OAA5B,EAAqCviC,MAArC;AACD;AACF;;AAED,WAASyiF,mBAAT,CAA6BziF,MAA7B,EAAqC;AACnC,KAACA,MAAD,IAAW,KAAKrD,OAAL,CAAa,SAAb,CAAX;AACD;AACD;;;;;;;;;;;;;AAcA,WAASylF,iBAAT,CAA2B9sE,EAA3B,EAA+ByvE,KAA/B,EAAsC;AACpCzvE,OAAG/a,EAAH,CAAM,UAAN,EAAkB,YAAY;AAC5BwqF,YAAMpoF,OAAN,CAAc,UAAd,EAD4B,CACD;AAC3B;AACA;AACA;;AAEA,WAAK;AACL;AACA;AACA2Y,SAAGnB,SAAH,CAAaonB,UAAb,MAA6B,CAACwpD,MAAMpE,cAAN,CAA9B,IAAuD,CAACoE,MAAMhD,UAAN,CAAiB/U,UAAzE,IAAuF,CAAC+X,MAAM7C,eAAN,CAAsB/vF,MAH9G,EAGsH;AACpH4yF,cAAMpoF,OAAN,CAAc,UAAd;AACD;AACF,KAZD;AAaD;AACD;;;;;;AAOA0lF,eAAaxa,UAAb,GAA0B,UAAUr7D,MAAV,EAAkB;AAC1C,QAAI4vD,cAAc5vD,OAAO4vD,WAAzB;AACA,QAAIn5B,UAAU,KAAK4d,QAAL,EAAd;AACA,QAAImS,cAAc/vB,QAAQk5B,gBAAR,CAAyBC,WAAzB,CAAlB;AACApJ,gBAAY6U,UAAZ,CAAuBr7D,MAAvB,EAJ0C,CAIV;AAChC;AACA;AACA;AACA;AACA;AACA;;AAEA,SAAKu1E,UAAL,CAAgB/U,UAAhB,GAA6B,IAA7B;AACD,GAbD;AAcA;;;;;AAMAqV,eAAa9nF,EAAb,GAAkBsmF,qCAAqC,IAArC,CAAlB;AACAwB,eAAa7lF,GAAb,GAAmBqkF,qCAAqC,KAArC,CAAnB;AACAwB,eAAanmF,GAAb,GAAmB2kF,qCAAqC,KAArC,CAAnB;AACA;;;;;;AAMA,WAASzF,WAAT,CAAqB2J,KAArB,EAA4B1vF,IAA5B,EAAkC4tC,OAAlC,EAA2CuuC,SAA3C,EAAsD;AACpD,QAAI0V,cAAc7xF,SAAS,WAA3B;AACA,QAAI8xF,WAAWD,cAAcnC,MAAMvD,gBAApB,GAAuCuD,MAAMzD,YAA5D;AACA,QAAI8F,UAAUF,cAAcnC,MAAM7qB,cAApB,GAAqC6qB,MAAMxD,UAAzD;AACA,QAAIjsE,KAAKyvE,MAAM3D,GAAf;AACA,QAAInjB,MAAM8mB,MAAMhrB,IAAhB;;AAEA,SAAK,IAAI9nE,IAAI,CAAb,EAAgBA,IAAIk1F,SAASh1F,MAA7B,EAAqCF,GAArC,EAA0C;AACxCk1F,eAASl1F,CAAT,EAAYizF,OAAZ,GAAsB,KAAtB;AACD;;AAEDgC,kBAAcjkD,QAAQ24B,aAAR,CAAsB,UAAU53B,aAAV,EAAyBsC,KAAzB,EAAgC;AAClEtC,wBAAkB,QAAlB,IAA8BqjD,UAAU/gD,KAAV,CAA9B;AACD,KAFa,CAAd,GAEKrD,QAAQu5B,UAAR,CAAmB6qB,SAAnB,CAFL;;AAIA,aAASA,SAAT,CAAmB/gD,KAAnB,EAA0B;AACxB;AACA,UAAIghD,SAAS,SAAShhD,MAAM9wB,EAAf,GAAoB,GAApB,GAA0B8wB,MAAMjxC,IAA7C;AACA,UAAIw9E,OAAOuU,QAAQE,MAAR,CAAX;;AAEA,UAAI,CAACzU,IAAL,EAAW;AACT,YAAI0U,YAAYthD,eAAeK,MAAMjxC,IAArB,CAAhB;AACA,YAAI+vC,QAAQ8hD,cAActV,YAAYrsC,QAAZ,CAAqBgiD,UAAUtjD,IAA/B,EAAqCsjD,UAAUzuF,GAA/C,CAAd,GAAoE25E,MAAMltC,QAAN,CAAegiD,UAAUzuF,GAAzB,CAAhF;AACA+5E,eAAO,IAAIztC,KAAJ,EAAP;AACAytC,aAAKtyC,IAAL,CAAU0C,OAAV,EAAmBg7B,GAAnB;AACAmpB,gBAAQE,MAAR,IAAkBzU,IAAlB;AACAsU,iBAAS1yF,IAAT,CAAco+E,IAAd;AACAv9D,WAAG5c,GAAH,CAAOm6E,KAAKtlB,KAAZ;AACD;;AAEDjnB,YAAMk9C,QAAN,GAAiB3Q,KAAK2U,IAAL,GAAYF,MAA7B;AACAzU,WAAKqS,OAAL,GAAe,IAAf;AACArS,WAAK2S,OAAL,GAAel/C,KAAf;AACAusC,WAAKtlB,KAAL,CAAWk6B,iBAAX,GAA+B;AAC7BnkD,kBAAUgD,MAAMhD,QADa;AAE7B9Y,eAAO8b,MAAM2pB;AAFgB,OAA/B;AAIA,OAACi3B,WAAD,IAAgB1V,UAAU4J,WAAV,CAAsBvI,IAAtB,EAA4BvsC,KAA5B,EAAmCrD,OAAnC,EAA4Cg7B,GAA5C,CAAhB;AACD;;AAED,SAAK,IAAIhsE,IAAI,CAAb,EAAgBA,IAAIk1F,SAASh1F,MAA7B,GAAsC;AACpC,UAAI0gF,OAAOsU,SAASl1F,CAAT,CAAX;;AAEA,UAAI,CAAC4gF,KAAKqS,OAAV,EAAmB;AACjB,SAACgC,WAAD,IAAgBrU,KAAKH,UAAL,CAAgB30E,OAAhB,EAAhB;AACAuX,WAAGxL,MAAH,CAAU+oE,KAAKtlB,KAAf;AACAslB,aAAK90E,OAAL,CAAaklC,OAAb,EAAsBg7B,GAAtB;AACAkpB,iBAAStqF,MAAT,CAAgB5K,CAAhB,EAAmB,CAAnB;AACA,eAAOm1F,QAAQvU,KAAK2U,IAAb,CAAP;AACA3U,aAAK2U,IAAL,GAAY3U,KAAKtlB,KAAL,CAAWk6B,iBAAX,GAA+B,IAA3C;AACD,OAPD,MAOO;AACLx1F;AACD;AACF;AACF,GArpwB2B,CAqpwB1B;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,WAASsgE,iBAAT,CAA2BtvB,OAA3B,EAAoC;AAClCA,YAAQsvB,iBAAR;AACAtvB,YAAQu5B,UAAR,CAAmB,UAAUxJ,WAAV,EAAuB;AACxCA,kBAAYT,iBAAZ;AACD,KAFD;AAGD;;AAED,WAASsf,MAAT,CAAgBkT,KAAhB,EAAuB9hD,OAAvB,EAAgCg7B,GAAhC,EAAqC17B,OAArC,EAA8C;AAC5CmlD,qBAAiB3C,KAAjB,EAAwB9hD,OAAxB,EAAiCg7B,GAAjC,EAAsC17B,OAAtC;AACAvrC,SAAK+tF,MAAMzD,YAAX,EAAyB,UAAU2C,KAAV,EAAiB;AACxCA,YAAMiB,OAAN,GAAgB,KAAhB;AACD,KAFD;AAGAtC,iBAAamC,KAAb,EAAoB9hD,OAApB,EAA6Bg7B,GAA7B,EAAkC17B,OAAlC,EAL4C,CAKA;;AAE5CvrC,SAAK+tF,MAAMzD,YAAX,EAAyB,UAAU2C,KAAV,EAAiB;AACxC,UAAI,CAACA,MAAMiB,OAAX,EAAoB;AAClBjB,cAAMn6E,MAAN,CAAam5B,OAAb,EAAsBg7B,GAAtB;AACD;AACF,KAJD;AAKD;;AAED,WAASypB,gBAAT,CAA0B3C,KAA1B,EAAiC9hD,OAAjC,EAA0Cg7B,GAA1C,EAA+C17B,OAA/C,EAAwDolD,SAAxD,EAAmE;AACjE3wF,SAAK2wF,aAAa5C,MAAMvD,gBAAxB,EAA0C,UAAUyD,aAAV,EAAyB;AACjE,UAAI5iD,iBAAiB4iD,cAAcO,OAAnC;AACAP,oBAAcpT,MAAd,CAAqBxvC,cAArB,EAAqCY,OAArC,EAA8Cg7B,GAA9C,EAAmD17B,OAAnD;AACAqlD,cAAQvlD,cAAR,EAAwB4iD,aAAxB;AACD,KAJD;AAKD;AACD;;;;;AAMA,WAASrC,YAAT,CAAsBmC,KAAtB,EAA6B9hD,OAA7B,EAAsCg7B,GAAtC,EAA2C17B,OAA3C,EAAoD45C,QAApD,EAA8D;AAC5D;AACA,QAAI3K,YAAYuT,MAAMhD,UAAtB;AACA,QAAI/U,UAAJ;AACA/pC,YAAQu5B,UAAR,CAAmB,UAAUxJ,WAAV,EAAuB;AACxC,UAAIoyB,YAAYL,MAAMxD,UAAN,CAAiBvuB,YAAYwwB,QAA7B,CAAhB;AACA4B,gBAAUF,OAAV,GAAoB,IAApB;AACA,UAAIxS,aAAa0S,UAAU1S,UAA3B;AACAlB,gBAAUyK,aAAV,CAAwBvJ,UAAxB,EAAoCnwC,OAApC;;AAEA,UAAI45C,YAAYA,SAAShlF,GAAT,CAAa67D,YAAY5C,GAAzB,CAAhB,EAA+C;AAC7CsiB,mBAAWj9D,KAAX;AACD;;AAEDu3D,oBAAc0F,WAAWnH,OAAX,CAAmBiG,UAAU0I,cAAV,CAAyBxH,UAAzB,CAAnB,CAAd;AACA0S,gBAAU73B,KAAV,CAAgBvtD,MAAhB,GAAyB,CAAC,CAACgzD,YAAY77D,GAAZ,CAAgB,QAAhB,CAA3B;AACAywF,cAAQ50B,WAAR,EAAqBoyB,SAArB;AACAyC,kBAAY70B,WAAZ,EAAyBoyB,SAAzB;AACD,KAdD;AAeA5T,cAAUxE,UAAV,IAAwBA,UAAxB,CAnB4D,CAmBxB;;AAEpC8a,2BAAuB/C,MAAM3D,GAA7B,EAAkCn+C,OAAlC,EArB4D,CAqBhB;;AAE5Cm0C,SAAK2N,MAAM3D,GAAN,CAAUx8D,GAAf,EAAoBqe,OAApB;AACD;;AAED,WAAS6hD,sBAAT,CAAgC7hD,OAAhC,EAAyCg7B,GAAzC,EAA8C;AAC5CjnE,SAAK+wF,eAAL,EAAsB,UAAUlzF,IAAV,EAAgB;AACpCA,WAAKouC,OAAL,EAAcg7B,GAAd;AACD,KAFD;AAGD;;AAED,MAAI+pB,oBAAoB,CAAC,OAAD,EAAU,UAAV,EAAsB,WAAtB,EAAmC,UAAnC,EAA+C,WAA/C,EAA4D,WAA5D,EAAyE,SAAzE,EAAoF,WAApF,EAAiG,aAAjG,CAAxB;AACA;;;;AAIA3F,eAAaJ,WAAb,GAA2B,YAAY;AACrCjrF,SAAKgxF,iBAAL,EAAwB,UAAUC,OAAV,EAAmB;AACzC,WAAK7G,GAAL,CAAS7mF,EAAT,CAAY0tF,OAAZ,EAAqB,UAAUttF,CAAV,EAAa;AAChC,YAAIsoC,UAAU,KAAK4d,QAAL,EAAd;AACA,YAAI9gD,KAAKpF,EAAEhI,MAAX;AACA,YAAI6Z,MAAJ,CAHgC,CAGpB;;AAEZ,YAAIy7E,YAAY,WAAhB,EAA6B;AAC3Bz7E,mBAAS,EAAT;AACD,SAFD,MAEO,IAAIzM,MAAMA,GAAG0iC,SAAH,IAAgB,IAA1B,EAAgC;AACrC,cAAIylD,YAAYnoF,GAAGmoF,SAAH,IAAgBjlD,QAAQk5B,gBAAR,CAAyBp8D,GAAGq8D,WAA5B,CAAhC;AACA5vD,mBAAS07E,aAAaA,UAAUte,aAAV,CAAwB7pE,GAAG0iC,SAA3B,EAAsC1iC,GAAG8pE,QAAzC,CAAb,IAAmE,EAA5E;AACD,SAHM,CAGL;AAHK,aAIF,IAAI9pE,MAAMA,GAAGooF,SAAb,EAAwB;AACzB37E,qBAASpZ,OAAO,EAAP,EAAW2M,GAAGooF,SAAd,CAAT;AACD;;AAEH,YAAI37E,MAAJ,EAAY;AACVA,iBAAOlR,KAAP,GAAeX,CAAf;AACA6R,iBAAOnX,IAAP,GAAc4yF,OAAd;AACA,eAAKtrF,OAAL,CAAasrF,OAAb,EAAsBz7E,MAAtB;AACD;AACF,OApBD,EAoBG,IApBH;AAqBD,KAtBD,EAsBG,IAtBH;AAuBAxV,SAAKivF,cAAL,EAAqB,UAAUmC,UAAV,EAAsBr/E,SAAtB,EAAiC;AACpD,WAAKi5E,cAAL,CAAoBznF,EAApB,CAAuBwO,SAAvB,EAAkC,UAAUzN,KAAV,EAAiB;AACjD,aAAKqB,OAAL,CAAaoM,SAAb,EAAwBzN,KAAxB;AACD,OAFD,EAEG,IAFH;AAGD,KAJD,EAIG,IAJH;AAKD,GA7BD;AA8BA;;;;AAKA+mF,eAAagG,UAAb,GAA0B,YAAY;AACpC,WAAO,KAAKta,SAAZ;AACD,GAFD;AAGA;;;;AAKAsU,eAAat4E,KAAb,GAAqB,YAAY;AAC/B,SAAKqvD,SAAL,CAAe;AACb6C,cAAQ;AADK,KAAf,EAEG,IAFH;AAGD,GAJD;AAKA;;;;AAKAomB,eAAatkF,OAAb,GAAuB,YAAY;AACjC,QAAI,KAAKgwE,SAAT,EAAoB;AAClB;AACD;;AAED,SAAKA,SAAL,GAAiB,IAAjB;AACArpD,iBAAa,KAAKm+D,MAAL,EAAb,EAA4ByF,iBAA5B,EAA+C,EAA/C;AACA,QAAIrqB,MAAM,KAAKlE,IAAf;AACA,QAAI92B,UAAU,KAAK0/C,MAAnB;AACA3rF,SAAK,KAAKwqF,gBAAV,EAA4B,UAAU1lB,SAAV,EAAqB;AAC/CA,gBAAU/9D,OAAV,CAAkBklC,OAAlB,EAA2Bg7B,GAA3B;AACD,KAFD;AAGAjnE,SAAK,KAAKsqF,YAAV,EAAwB,UAAU2C,KAAV,EAAiB;AACvCA,YAAMlmF,OAAN,CAAcklC,OAAd,EAAuBg7B,GAAvB;AACD,KAFD,EAZiC,CAc7B;;AAEJ,SAAKmjB,GAAL,CAASrjF,OAAT;;AAEA,WAAOimF,UAAU,KAAKxuE,EAAf,CAAP;AACD,GAnBD;;AAqBAthB,QAAM6sF,OAAN,EAAe/kF,QAAf;;AAEA,WAAS8rF,sBAAT,CAAgCxyE,EAAhC,EAAoC2tB,OAApC,EAA6C;AAC3C,QAAI/kC,UAAUoX,GAAGpX,OAAjB;AACA,QAAIqqF,UAAU,CAAd;AACArqF,YAAQqY,QAAR,CAAiB,UAAUxW,EAAV,EAAc;AAC7B,UAAI,CAACA,GAAGoW,OAAR,EAAiB;AACfoyE;AACD;AACF,KAJD;;AAMA,QAAIA,UAAUtlD,QAAQ9rC,GAAR,CAAY,qBAAZ,CAAV,IAAgD,CAAC7H,MAAMX,IAA3D,EAAiE;AAC/DuP,cAAQqY,QAAR,CAAiB,UAAUxW,EAAV,EAAc;AAC7B,YAAI,CAACA,GAAGoW,OAAR,EAAiB;AACf;AACApW,aAAG09C,aAAH,GAAmB,IAAnB;AACD;AACF,OALD;AAMD;AACF;AACD;;;;;;AAOA,WAASoqC,WAAT,CAAqB70B,WAArB,EAAkCoyB,SAAlC,EAA6C;AAC3C,QAAI1zB,YAAYsB,YAAY77D,GAAZ,CAAgB,WAAhB,KAAgC,IAAhD;AACAiuF,cAAU73B,KAAV,CAAgBh3C,QAAhB,CAAyB,UAAUxW,EAAV,EAAc;AACrC;AACA,UAAI,CAACA,GAAGoW,OAAR,EAAiB;AACf;AACA,YAAIpW,GAAG6iB,KAAH,CAASF,KAAT,KAAmBgvC,SAAvB,EAAkC;AAChC3xD,aAAG2wB,QAAH,CAAY,OAAZ,EAAqBghC,SAArB;AACD;AACF;;AAED,UAAI3xD,GAAGu7C,sBAAP,EAA+B;AAC7Bv7C,WAAGu7C,sBAAH,CAA0B,UAAUv6C,WAAV,EAAuB;AAC/CA,sBAAY2vB,QAAZ,CAAqB,OAArB,EAA8BghC,SAA9B;AACD,SAFD;AAGD;AACF,KAdD;AAeD;AACD;;;;;AAMA,WAASk2B,OAAT,CAAiBthD,KAAjB,EAAwBusC,IAAxB,EAA8B;AAC5B,QAAIn1D,IAAI4oB,MAAMnvC,GAAN,CAAU,GAAV,CAAR;AACA,QAAIsmB,SAAS6oB,MAAMnvC,GAAN,CAAU,QAAV,CAAb,CAF4B,CAEM;;AAElC07E,SAAKtlB,KAAL,CAAWh3C,QAAX,CAAoB,UAAUxW,EAAV,EAAc;AAChC,UAAIA,GAAG1K,IAAH,KAAY,OAAhB,EAAyB;AACvBqoB,aAAK,IAAL,KAAc3d,GAAG2d,CAAH,GAAOA,CAArB;AACAD,kBAAU,IAAV,KAAmB1d,GAAG0d,MAAH,GAAYA,MAA/B;AACD;AACF,KALD;AAMD;;AAED,WAASikE,kBAAT,CAA4BjI,UAA5B,EAAwC;AACtC,QAAIoL,cAAcpL,WAAWgI,YAA7B;AACA,WAAOruF,OAAO,IAAIwqE,YAAJ,CAAiB6b,UAAjB,CAAP,EAAqC;AAC1C;AACApb,4BAAsBzpE,KAAKiwF,YAAYxmB,oBAAjB,EAAuCwmB,WAAvC,CAFoB;AAG1C2D,6BAAuB,+BAAUzoF,EAAV,EAAc;AACnC,eAAOA,EAAP,EAAW;AACT,cAAI0oF,YAAY1oF,GAAG0nF,iBAAnB;;AAEA,cAAIgB,aAAa,IAAjB,EAAuB;AACrB,mBAAOhP,WAAWkJ,MAAX,CAAkBruB,YAAlB,CAA+Bm0B,UAAUnlD,QAAzC,EAAmDmlD,UAAUj+D,KAA7D,CAAP;AACD;;AAEDzqB,eAAKA,GAAGI,MAAR;AACD;AACF;AAbyC,KAArC,CAAP;AAeD;AACD;;;;;AAMA,MAAIgmF,UAAU,EAAd;AACA;;;;;AAKA,MAAIF,iBAAiB,EAArB;AACA;;;;;;AAMA,MAAInE,qBAAqB,EAAzB;AACA;;;;;AAKA,MAAIzoB,0BAA0B,EAA9B;AACA;;;;;AAKA,MAAI0uB,kBAAkB,EAAtB;AACA;;;;;AAKA,MAAIlG,cAAc,EAAlB;AACA;;;;;AAKA,MAAIZ,eAAe,EAAnB;AACA;;;;AAIA,MAAI6E,iBAAiB,EAArB;AACA,MAAI9B,YAAY,EAAhB;AACA,MAAIF,kBAAkB,EAAtB;AACA,MAAI4E,SAAS,IAAI/yD,IAAJ,KAAa,CAA1B;AACA,MAAIgzD,cAAc,IAAIhzD,IAAJ,KAAa,CAA/B;AACA,MAAI2yD,oBAAoB,oBAAxB;AACA,MAAIM,gBAAgB,EAApB;;AAEA,WAASC,aAAT,CAAuB5E,KAAvB,EAA8B;AAC5B,QAAI6E,iBAAiB,CAArB;AACA,QAAIC,kBAAkB,CAAtB;AACA,QAAIC,iBAAiB,CAArB;AACA,QAAIC,aAAa,uBAAjB;;AAEA,aAASC,2BAAT,CAAqCC,MAArC,EAA6C7e,MAA7C,EAAqD;AACnD,WAAK,IAAIr4E,IAAI,CAAb,EAAgBA,IAAIk3F,OAAOh3F,MAA3B,EAAmCF,GAAnC,EAAwC;AACtC,YAAIm3F,aAAaD,OAAOl3F,CAAP,CAAjB;AACAm3F,mBAAWH,UAAX,IAAyB3e,MAAzB;AACD;AACF;;AAEDtzE,SAAKivF,cAAL,EAAqB,UAAUmC,UAAV,EAAsBr/E,SAAtB,EAAiC;AACpDk7E,YAAMjC,cAAN,CAAqBznF,EAArB,CAAwBwO,SAAxB,EAAmC,UAAUzN,KAAV,EAAiB;AAClD,YAAIwoF,gBAAgBG,MAAM12B,KAAtB,KAAgC02B,MAAMgF,UAAN,MAAsBH,cAA1D,EAA0E;AACxE,cAAIxtF,SAASA,MAAMgrF,aAAnB,EAAkC;AAChC;AACD;;AAED,cAAIU,SAAS/C,MAAM8B,mBAAN,CAA0BzqF,KAA1B,CAAb;AACA,cAAI+tF,cAAc,EAAlB;AACAryF,eAAKgtF,SAAL,EAAgB,UAAUoF,UAAV,EAAsB;AACpC,gBAAIA,eAAenF,KAAf,IAAwBmF,WAAW77B,KAAX,KAAqB02B,MAAM12B,KAAvD,EAA8D;AAC5D87B,0BAAY50F,IAAZ,CAAiB20F,UAAjB;AACD;AACF,WAJD;AAKAF,sCAA4BG,WAA5B,EAAyCP,cAAzC;AACA9xF,eAAKqyF,WAAL,EAAkB,UAAUD,UAAV,EAAsB;AACtC,gBAAIA,WAAWH,UAAX,MAA2BF,eAA/B,EAAgD;AAC9CK,yBAAWlD,cAAX,CAA0Bc,MAA1B;AACD;AACF,WAJD;AAKAkC,sCAA4BG,WAA5B,EAAyCL,cAAzC;AACD;AACF,OArBD;AAsBD,KAvBD;AAwBD;AACD;;;;;;;;;;;;AAaA,WAASzoD,IAAT,CAAc3b,GAAd,EAAmBo8D,QAAnB,EAA6Bx9E,IAA7B,EAAmC;AACjC,QAAI8lF,gBAAgBC,iBAAiB3kE,GAAjB,CAApB;;AAEA,QAAI0kE,aAAJ,EAAmB;AACjB,aAAOA,aAAP;AACD;;AAED,QAAIrF,QAAQ,IAAIlD,OAAJ,CAAYn8D,GAAZ,EAAiBo8D,QAAjB,EAA2Bx9E,IAA3B,CAAZ;AACAygF,UAAMzuE,EAAN,GAAW,QAAQkzE,QAAnB;AACA1E,cAAUC,MAAMzuE,EAAhB,IAAsByuE,KAAtB;AACAv/D,iBAAaE,GAAb,EAAkB0jE,iBAAlB,EAAqCrE,MAAMzuE,EAA3C;AACAqzE,kBAAc5E,KAAd;AACA,WAAOA,KAAP;AACD;AACD;;;;AAIA,WAASuF,OAAT,CAAiB5F,OAAjB,EAA0B;AACxB;AACA,QAAI5wF,QAAQ4wF,OAAR,CAAJ,EAAsB;AACpB,UAAIuF,SAASvF,OAAb;AACAA,gBAAU,IAAV,CAFoB,CAEJ;;AAEhB5sF,WAAKmyF,MAAL,EAAa,UAAUlF,KAAV,EAAiB;AAC5B,YAAIA,MAAM12B,KAAN,IAAe,IAAnB,EAAyB;AACvBq2B,oBAAUK,MAAM12B,KAAhB;AACD;AACF,OAJD;AAKAq2B,gBAAUA,WAAW,OAAO+E,aAA5B;AACA3xF,WAAKmyF,MAAL,EAAa,UAAUlF,KAAV,EAAiB;AAC5BA,cAAM12B,KAAN,GAAcq2B,OAAd;AACD,OAFD;AAGD;;AAEDE,oBAAgBF,OAAhB,IAA2B,IAA3B;AACA,WAAOA,OAAP;AACD;AACD;;;;;AAKA,WAAS6F,UAAT,CAAoB7F,OAApB,EAA6B;AAC3BE,oBAAgBF,OAAhB,IAA2B,KAA3B;AACD;AACD;;;;AAIA,MAAI8F,aAAaD,UAAjB;AACA;;;;;AAKA,WAAS1rF,OAAT,CAAiBkmF,KAAjB,EAAwB;AACtB,QAAI,OAAOA,KAAP,KAAiB,QAArB,EAA+B;AAC7BA,cAAQD,UAAUC,KAAV,CAAR;AACD,KAFD,MAEO,IAAI,EAAEA,iBAAiBlD,OAAnB,CAAJ,EAAiC;AACtC;AACAkD,cAAQsF,iBAAiBtF,KAAjB,CAAR;AACD;;AAED,QAAIA,iBAAiBlD,OAAjB,IAA4B,CAACkD,MAAMoE,UAAN,EAAjC,EAAqD;AACnDpE,YAAMlmF,OAAN;AACD;AACF;AACD;;;;;AAKA,WAASwrF,gBAAT,CAA0B3kE,GAA1B,EAA+B;AAC7B,WAAOo/D,UAAUpgD,aAAahf,GAAb,EAAkB0jE,iBAAlB,CAAV,CAAP;AACD;AACD;;;;;AAKA,WAASqB,eAAT,CAAyBn3F,GAAzB,EAA8B;AAC5B,WAAOwxF,UAAUxxF,GAAV,CAAP;AACD;AACD;;;;AAIA,WAASo3F,aAAT,CAAuBp4F,IAAvB,EAA6BwvF,QAA7B,EAAuC;AACrCC,iBAAazvF,IAAb,IAAqBwvF,QAArB;AACD;AACD;;;;;AAKA,WAAS6I,oBAAT,CAA8BC,gBAA9B,EAAgD;AAC9CzwB,4BAAwB5kE,IAAxB,CAA6Bq1F,gBAA7B;AACD;AACD;;;;;AAKA,WAASC,iBAAT,CAA2BC,QAA3B,EAAqCC,SAArC,EAAgD;AAC9CC,sBAAkBpI,kBAAlB,EAAsCkI,QAAtC,EAAgDC,SAAhD,EAA2DxK,yBAA3D;AACD;AACD;;;;;AAKA,WAAS0K,kBAAT,CAA4BC,cAA5B,EAA4C;AAC1CrC,oBAAgBtzF,IAAhB,CAAqB21F,cAArB;AACD;AACD;;;;;;;;;;;;;;;;;AAiBA,WAASC,cAAT,CAAwB7D,UAAxB,EAAoC7mF,SAApC,EAA+CqnF,MAA/C,EAAuD;AACrD,QAAI,OAAOrnF,SAAP,KAAqB,UAAzB,EAAqC;AACnCqnF,eAASrnF,SAAT;AACAA,kBAAY,EAAZ;AACD;;AAED,QAAIyoF,aAAarwF,SAASyuF,UAAT,IAAuBA,WAAWnxF,IAAlC,GAAyC,CAACmxF,UAAD,EAAaA,aAAa;AAClFlrF,aAAOqE;AAD2E,KAA1B,EAEvD,CAFuD,CAA1D,CANqD,CAQ9C;;AAEP6mF,eAAWlrF,KAAX,GAAmB,CAACkrF,WAAWlrF,KAAX,IAAoB8sF,UAArB,EAAiCl8E,WAAjC,EAAnB;AACAvM,gBAAY6mF,WAAWlrF,KAAvB,CAXqD,CAWvB;;AAE9BtD,WAAO4oF,WAAW/wF,IAAX,CAAgBu4F,UAAhB,KAA+BxH,WAAW/wF,IAAX,CAAgB8P,SAAhB,CAAtC;;AAEA,QAAI,CAACwmF,QAAQiC,UAAR,CAAL,EAA0B;AACxBjC,cAAQiC,UAAR,IAAsB;AACpBpB,gBAAQA,MADY;AAEpBR,oBAAYA;AAFQ,OAAtB;AAID;;AAEDP,mBAAetmF,SAAf,IAA4ByoF,UAA5B;AACD;AACD;;;;;AAKA,WAASkC,wBAAT,CAAkCj1F,IAAlC,EAAwCk1F,mBAAxC,EAA6D;AAC3DxsB,4BAAwBO,QAAxB,CAAiCjpE,IAAjC,EAAuCk1F,mBAAvC;AACD;AACD;;;;;;AAMA,WAASC,6BAAT,CAAuCn1F,IAAvC,EAA6C;AAC3C,QAAIo1F,kBAAkB1sB,wBAAwB5mE,GAAxB,CAA4B9B,IAA5B,CAAtB;;AAEA,QAAIo1F,eAAJ,EAAqB;AACnB,aAAOA,gBAAgBC,iBAAhB,GAAoCD,gBAAgBC,iBAAhB,EAApC,GAA0ED,gBAAgBl2B,UAAhB,CAA2BtjE,KAA3B,EAAjF;AACD;AACF;AACD;;;;;;;;;AASA,WAAS05F,cAAT,CAAwBX,QAAxB,EAAkCY,UAAlC,EAA8C;AAC5CV,sBAAkBrI,WAAlB,EAA+BmI,QAA/B,EAAyCY,UAAzC,EAAqDjL,sBAArD,EAA6E,QAA7E;AACD;AACD;;;;;AAKA,WAASkL,cAAT,CAAwBb,QAAxB,EAAkCc,UAAlC,EAA8C;AAC5CZ,sBAAkBrI,WAAlB,EAA+BmI,QAA/B,EAAyCc,UAAzC,EAAqDjL,qBAArD,EAA4E,QAA5E;AACD;AACD;;;;AAIA,WAASqK,iBAAT,CAA2Ba,UAA3B,EAAuCf,QAAvC,EAAiDv4F,EAAjD,EAAqDu5F,eAArD,EAAsErP,UAAtE,EAAkF;AAChF,QAAI7jF,WAAWkyF,QAAX,KAAwBjyF,SAASiyF,QAAT,CAA5B,EAAgD;AAC9Cv4F,WAAKu4F,QAAL;AACAA,iBAAWgB,eAAX;AACD;;AAED,QAAItP,eAAelC,UAAUkE,gBAAV,CAA2BjsF,EAA3B,EAA+BkqF,UAA/B,CAAnB;AACAD,iBAAakG,MAAb,GAAsBoI,QAAtB;AACAtO,iBAAauP,KAAb,GAAqBx5F,EAArB;AACAs5F,eAAWt2F,IAAX,CAAgBinF,YAAhB;AACA,WAAOA,YAAP;AACD;AACD;;;;AAKA,WAASwP,eAAT,CAAyB15F,IAAzB,EAA+B25F,SAA/B,EAA0C;AACxCrF,mBAAet0F,IAAf,IAAuB25F,SAAvB;AACD;AACD;;;;;AAKA,WAASC,oBAAT,CAA8B5nF;AAC9B;AADA,IAEE;AACA;AACA;AACA;AACA;AACA;AACA,WAAOwsD,eAAe58D,MAAf,CAAsBoQ,IAAtB,CAAP;AACD;AACD;;;;;AAKA,WAAS6nF,mBAAT,CAA6B7nF;AAC7B;AADA,IAEE;AACA;AACA;AACA;AACA;AACA;AACA,WAAOouE,YAAYx+E,MAAZ,CAAmBoQ,IAAnB,CAAP;AACD;AACD;;;;;AAKA,WAAS8nF,iBAAT,CAA2B9nF;AAC3B;AADA,IAEE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAO4qE,YAAYh7E,MAAZ,CAAmBoQ,IAAnB,CAAP;AACD;AACD;;;;;AAKA,WAAS+nF,eAAT,CAAyB/nF;AACzB;AADA,IAEE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAOivE,MAAMr/E,MAAN,CAAaoQ,IAAb,CAAP;AACD;AACD;;;;;;;;;;;;;;;;;AAiBA,WAASgoF,gBAAT,CAA0BC,OAA1B,EAAmC;AACjCl6F,cAAU,cAAV,EAA0Bk6F,OAA1B;AACD;AACD;;;;;;;;;;;;;;;;AAgBA,WAASC,WAAT,CAAqBC,OAArB,EAA8BC,OAA9B,EAAuCC,YAAvC,EAAqD;AACnD,QAAID,QAAQA,OAAR,IAAmB,CAACA,QAAQE,QAAhC,EAA0C;AACxCD,qBAAeD,QAAQC,YAAvB;AACAD,gBAAUA,QAAQA,OAAlB;AACD;;AAED,QAAI,OAAOA,OAAP,KAAmB,QAAvB,EAAiC;AAC/BA,gBAAU,OAAOG,IAAP,KAAgB,WAAhB,IAA+BA,KAAK//E,KAApC,GAA4C+/E,KAAK//E,KAAL,CAAW4/E,OAAX,CAA5C,GAAkE,IAAI31F,QAAJ,CAAa,aAAa21F,OAAb,GAAuB,IAApC,GAA5E;AACD;;AAEDhD,kBAAc+C,OAAd,IAAyB;AACvBC,eAASA,OADc;AAEvBC,oBAAcA;AAFS,KAAzB;AAID;AACD;;;;;AAKA,WAASG,MAAT,CAAgBL,OAAhB,EAAyB;AACvB,WAAO/C,cAAc+C,OAAd,CAAP;AACD;AACDd,iBAAejL,sBAAf,EAAuC5K,WAAvC;AACA6U,uBAAqB3kB,cAArB;AACA6kB,oBAAkBrK,4BAAlB,EAAgDla,SAAhD;AACA0lB,kBAAgB,SAAhB,EAA2BhS,cAA3B,EAn1xB4B,CAm1xBgB;;AAE5CmR,iBAAe;AACbh1F,UAAM,WADO;AAEbiG,WAAO,WAFM;AAGbgb,YAAQ;AAHK,GAAf,EAIG3e,IAJH;AAKA0yF,iBAAe;AACbh1F,UAAM,UADO;AAEbiG,WAAO,UAFM;AAGbgb,YAAQ;AAHK,GAAf,EAIG3e,IAJH,EA11xB4B,CA81xBlB;;AAEViyF,gBAAc,OAAd,EAAuB1L,UAAvB;AACA0L,gBAAc,MAAd,EAAsB5wB,KAAtB,EAj2xB4B,CAi2xBE;AAC9B;;AAEA,MAAIizB,WAAW,EAAf;;AAEA;;;;;;;;;;;;;;;;;;AAkBA,WAASC,gBAAT,CAA0BlqD,IAA1B,EAAgC;AAC9B,WAAOA,IAAP;AACD;AACD;;;;;;;;AASA,WAASmqD,UAAT,CAAoBC,MAApB,EAA4BC,MAA5B,EAAoCC,YAApC,EAAkDC,YAAlD,EAAgE/3F,OAAhE,EAAyE;AACvE,SAAKg4F,IAAL,GAAYJ,MAAZ;AACA,SAAKK,IAAL,GAAYJ,MAAZ;AACA,SAAKK,aAAL,GAAqBJ,gBAAgBJ,gBAArC;AACA,SAAKS,aAAL,GAAqBJ,gBAAgBL,gBAArC;AACA,SAAK13F,OAAL,GAAeA,OAAf;AACD;;AAED23F,aAAW37F,SAAX,GAAuB;AACrB6B,iBAAa85F,UADQ;;AAGrB;;;AAGAzzF,SAAK,aAAU7D,IAAV,EAAgB;AACnB,WAAK+3F,IAAL,GAAY/3F,IAAZ;AACA,aAAO,IAAP;AACD,KAToB;;AAWrB;;;AAGAyhB,YAAQ,gBAAUzhB,IAAV,EAAgB;AACtB,WAAKqmC,OAAL,GAAermC,IAAf;AACA,aAAO,IAAP;AACD,KAjBoB;;AAmBrB;;;AAGAiV,YAAQ,gBAAUjV,IAAV,EAAgB;AACtB,WAAKg4F,OAAL,GAAeh4F,IAAf;AACA,aAAO,IAAP;AACD,KAzBoB;AA0BrBi4F,aAAS,mBAAY;AACnB,UAAIV,SAAS,KAAKI,IAAlB;AACA,UAAIH,SAAS,KAAKI,IAAlB;AACA,UAAIM,kBAAkB,EAAtB;AACA,UAAIC,kBAAkB,EAAtB;AACA,UAAIC,gBAAgB,EAApB;AACA,UAAIC,gBAAgB,EAApB;AACA,UAAIj7F,CAAJ;AACAk7F,mBAAaf,MAAb,EAAqBW,eAArB,EAAsCE,aAAtC,EAAqD,eAArD,EAAsE,IAAtE;AACAE,mBAAad,MAAb,EAAqBW,eAArB,EAAsCE,aAAtC,EAAqD,eAArD,EAAsE,IAAtE,EATmB,CAS0D;AAC7E;AACA;;AAEA,WAAKj7F,IAAI,CAAT,EAAYA,IAAIm6F,OAAOj6F,MAAvB,EAA+BF,GAA/B,EAAoC;AAClC,YAAIO,MAAMy6F,cAAch7F,CAAd,CAAV;AACA,YAAIinB,MAAM8zE,gBAAgBx6F,GAAhB,CAAV,CAFkC,CAEF;;AAEhC,YAAI0mB,OAAO,IAAX,EAAiB;AACf;AACA;AACA,cAAIhnB,MAAMgnB,IAAI/mB,MAAd;;AAEA,cAAID,GAAJ,EAAS;AACPA,oBAAQ,CAAR,KAAc86F,gBAAgBx6F,GAAhB,IAAuB,IAArC;AACA0mB,kBAAMA,IAAIo4C,OAAJ,EAAN;AACD,WAHD,MAGO;AACL07B,4BAAgBx6F,GAAhB,IAAuB,IAAvB;AACD;;AAED,eAAK0oC,OAAL,IAAgB,KAAKA,OAAL,CAAahiB,GAAb,EAAkBjnB,CAAlB,CAAhB;AACD,SAbD,MAaO;AACL,eAAK46F,OAAL,IAAgB,KAAKA,OAAL,CAAa56F,CAAb,CAAhB;AACD;AACF;;AAED,WAAK,IAAIA,IAAI,CAAb,EAAgBA,IAAIi7F,cAAc/6F,MAAlC,EAA0CF,GAA1C,EAA+C;AAC7C,YAAIO,MAAM06F,cAAcj7F,CAAd,CAAV;;AAEA,YAAI+6F,gBAAgBv6F,cAAhB,CAA+BD,GAA/B,CAAJ,EAAyC;AACvC,cAAI0mB,MAAM8zE,gBAAgBx6F,GAAhB,CAAV;;AAEA,cAAI0mB,OAAO,IAAX,EAAiB;AACf;AACD,WALsC,CAKrC;;;AAGF,cAAI,CAACA,IAAI/mB,MAAT,EAAiB;AACf,iBAAKy6F,IAAL,IAAa,KAAKA,IAAL,CAAU1zE,GAAV,CAAb;AACD,WAFD,MAEO;AACL,iBAAK,IAAIrJ,IAAI,CAAR,EAAW3d,MAAMgnB,IAAI/mB,MAA1B,EAAkC0d,IAAI3d,GAAtC,EAA2C2d,GAA3C,EAAgD;AAC9C,mBAAK+8E,IAAL,IAAa,KAAKA,IAAL,CAAU1zE,IAAIrJ,CAAJ,CAAV,CAAb;AACD;AACF;AACF;AACF;AACF;AAjFoB,GAAvB;;AAoFA,WAASs9E,YAAT,CAAsB92C,GAAtB,EAA2BllD,GAA3B,EAAgCi8F,MAAhC,EAAwCC,aAAxC,EAAuDC,UAAvD,EAAmE;AACjE,SAAK,IAAIr7F,IAAI,CAAb,EAAgBA,IAAIokD,IAAIlkD,MAAxB,EAAgCF,GAAhC,EAAqC;AACnC;AACA,UAAIO,MAAM,SAAS86F,WAAWD,aAAX,EAA0Bh3C,IAAIpkD,CAAJ,CAA1B,EAAkCA,CAAlC,CAAnB;AACA,UAAIs7F,YAAYp8F,IAAIqB,GAAJ,CAAhB;;AAEA,UAAI+6F,aAAa,IAAjB,EAAuB;AACrBH,eAAO34F,IAAP,CAAYjC,GAAZ;AACArB,YAAIqB,GAAJ,IAAWP,CAAX;AACD,OAHD,MAGO;AACL,YAAI,CAACs7F,UAAUp7F,MAAf,EAAuB;AACrBhB,cAAIqB,GAAJ,IAAW+6F,YAAY,CAACA,SAAD,CAAvB;AACD;;AAEDA,kBAAU94F,IAAV,CAAexC,CAAf;AACD;AACF;AACF;;AAED;;;;;;;;;;;;;;;;;;AAkBA,MAAIu7F,mBAAmBn2F,cAAc,CAAC,SAAD,EAAY,OAAZ,EAAqB,UAArB,EAAiC,QAAjC,EAA2C,YAA3C,CAAd,CAAvB;AACA,WAASo2F,mBAAT,CAA6Br5F,IAA7B,EAAmC;AACjC,QAAIs5F,UAAU,EAAd;AACA,QAAIvhC,SAASuhC,QAAQvhC,MAAR,GAAiB,EAA9B;AACA,QAAIwhC,sBAAsBt2F,eAA1B;AACA,QAAIu2F,iBAAiB,EAArB;AACA,QAAIC,mBAAmB,EAAvB;AACAx5F,WAAOD,KAAKmgE,UAAZ,EAAwB,UAAUmE,OAAV,EAAmB;AACzC,UAAIkX,UAAUx7E,KAAKq1E,gBAAL,CAAsB/Q,OAAtB,CAAd;AACA,UAAIX,WAAW6X,QAAQ7X,QAAvB;;AAEA,UAAIA,QAAJ,EAAc;AACZ,YAAI+1B,cAAc3hC,OAAO4L,QAAP,CAAlB;;AAEA,YAAI,CAAC5L,OAAO15D,cAAP,CAAsBslE,QAAtB,CAAL,EAAsC;AACpC+1B,wBAAc3hC,OAAO4L,QAAP,IAAmB,EAAjC;AACD;;AAED+1B,oBAAYle,QAAQme,aAApB,IAAqCr1B,OAArC;;AAEA,YAAI,CAACkX,QAAQoe,YAAb,EAA2B;AACzBL,8BAAoBz2F,GAApB,CAAwB6gE,QAAxB,EAAkC,CAAlC,EADyB,CACa;AACtC;AACA;AACA;;AAEA,cAAIk2B,gBAAgBre,QAAQv6E,IAAxB,CAAJ,EAAmC;AACjCu4F,2BAAe,CAAf,IAAoBl1B,OAApB;AACD;AACF;;AAED,YAAIkX,QAAQse,cAAZ,EAA4B;AAC1BL,2BAAiBp5F,IAAjB,CAAsBikE,OAAtB;AACD;AACF;;AAED80B,uBAAiBx2F,IAAjB,CAAsB,UAAUwB,CAAV,EAAa21F,QAAb,EAAuB;AAC3C,YAAIC,cAAcjiC,OAAOgiC,QAAP,CAAlB;;AAEA,YAAI,CAAChiC,OAAO15D,cAAP,CAAsB07F,QAAtB,CAAL,EAAsC;AACpCC,wBAAcjiC,OAAOgiC,QAAP,IAAmB,EAAjC;AACD;;AAED,YAAI11B,WAAWmX,QAAQG,SAAR,CAAkBoe,QAAlB,CAAf;;AAEA,YAAI11B,YAAY,IAAZ,IAAoBA,aAAa,KAArC,EAA4C;AAC1C21B,sBAAY31B,QAAZ,IAAwBmX,QAAQp+E,IAAhC;AACD;AACF,OAZD;AAaD,KA1CD;AA2CA,QAAI68F,kBAAkB,EAAtB;AACA,QAAIC,yBAAyB,EAA7B;AACAX,wBAAoB32F,IAApB,CAAyB,UAAUwB,CAAV,EAAau/D,QAAb,EAAuB;AAC9C,UAAIw2B,SAASpiC,OAAO4L,QAAP,CAAb,CAD8C,CACf;AAC/B;AACA;;AAEAu2B,6BAAuBv2B,QAAvB,IAAmCw2B,OAAO,CAAP,CAAnC,CAL8C,CAKA;AAC9C;;AAEAF,wBAAkBA,gBAAgBp5F,MAAhB,CAAuBs5F,MAAvB,CAAlB;AACD,KATD;AAUAb,YAAQW,eAAR,GAA0BA,eAA1B;AACAX,YAAQY,sBAAR,GAAiCA,sBAAjC;AACA,QAAIE,cAAcriC,OAAO+iB,KAAzB,CA/DiC,CA+DD;AAChC;;AAEA,QAAIsf,eAAeA,YAAYr8F,MAA/B,EAAuC;AACrCy7F,uBAAiBY,YAAYv9F,KAAZ,EAAjB;AACD;;AAED,QAAIw9F,gBAAgBtiC,OAAO0Y,OAA3B;;AAEA,QAAI4pB,iBAAiBA,cAAct8F,MAAnC,EAA2C;AACzC07F,yBAAmBY,cAAcx9F,KAAd,EAAnB;AACD,KAFD,MAEO,IAAI,CAAC48F,iBAAiB17F,MAAtB,EAA8B;AACnC07F,yBAAmBD,eAAe38F,KAAf,EAAnB;AACD;;AAEDk7D,WAAOyhC,cAAP,GAAwBA,cAAxB;AACAzhC,WAAO0hC,gBAAP,GAA0BA,gBAA1B;AACA,WAAOH,OAAP;AACD;AACD,WAASgB,sBAAT,CAAgCC,QAAhC,EAA0C;AACxC,WAAOA,aAAa,UAAb,GAA0B,SAA1B,GAAsCA,aAAa,MAAb,GAAsB,MAAtB,GAA+B,OAA5E;AACD;;AAED,WAASV,eAAT,CAAyB9kB,OAAzB,EAAkC;AAChC;AACA;AACA,WAAO,EAAEA,YAAY,SAAZ,IAAyBA,YAAY,MAAvC,CAAP;AACD,GAhmyB2B,CAgmyB1B;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;;;;;;;;;AAmBA;;;;AAIA,MAAIylB,aAAa/7F,UAAjB;AACA,MAAIg8F,YAAY,WAAhB,CAroyB4B,CAqoyBC;AAC7B;;AAEA,MAAIC,YAAY,OAAhB;AACA,MAAIC,YAAY;AACd,aAAS,QAAOC,YAAP,yCAAOA,YAAP,OAAwBH,SAAxB,GAAoCl+F,KAApC,GAA4Cq+F,YADvC;AAEd,WAAO,QAAOC,UAAP,yCAAOA,UAAP,OAAsBJ,SAAtB,GAAkCl+F,KAAlC,GAA0Cs+F,UAFnC;AAGd;AACA,eAAWt+F,KAJG;AAKd,cAAUA,KALI;AAMd,YAAQA;AANM,GAAhB,CAzoyB4B,CAgpyBzB;AACH;;AAEA,MAAIu+F,kBAAkB,QAAOC,WAAP,yCAAOA,WAAP,OAAuBN,SAAvB,GAAmCl+F,KAAnC,GAA2Cw+F,WAAjE;AACA,MAAIC,kBAAkB,QAAOC,WAAP,yCAAOA,WAAP,OAAuBR,SAAvB,GAAmCl+F,KAAnC,GAA2C0+F,WAAjE;;AAEA,WAASC,cAAT,CAAwB/uF,IAAxB,EAA8B;AAC5B;AACA,WAAOA,KAAKgvF,SAAL,GAAiB,KAAjB,GAAyBL,eAAzB,GAA2CE,eAAlD;AACD;;AAED,WAASI,UAAT,CAAoBC,aAApB,EAAmC;AACjC,QAAIr9F,OAAOq9F,cAAcp9F,WAAzB,CADiC,CACK;;AAEtC,WAAOD,SAASzB,KAAT,GAAiB8+F,cAAcx+F,KAAd,EAAjB,GAAyC,IAAImB,IAAJ,CAASq9F,aAAT,CAAhD;AACD;;AAED,MAAIC,0BAA0B,CAAC,eAAD,EAAkB,WAAlB,EAA+B,SAA/B,EAA0C,qBAA1C,EAAiE,UAAjE,EAA6E,YAA7E,EAA2F,aAA3F,EAA0G,iBAA1G,EAA6H,QAA7H,EAAuI,WAAvI,EAAoJ,aAApJ,EAAmK,WAAnK,CAA9B;AACA,MAAIC,mBAAmB,CAAC,SAAD,EAAY,oBAAZ,EAAkC,YAAlC,CAAvB;;AAEA,WAASC,kBAAT,CAA4Bj9F,MAA5B,EAAoCf,MAApC,EAA4C;AAC1CyC,WAAOq7F,wBAAwBz6F,MAAxB,CAA+BrD,OAAOi+F,gBAAP,IAA2B,EAA1D,CAAP,EAAsE,UAAUt+E,QAAV,EAAoB;AACxF,UAAI3f,OAAOa,cAAP,CAAsB8e,QAAtB,CAAJ,EAAqC;AACnC5e,eAAO4e,QAAP,IAAmB3f,OAAO2f,QAAP,CAAnB;AACD;AACF,KAJD;AAKA5e,WAAOk9F,gBAAP,GAA0Bj+F,OAAOi+F,gBAAjC;AACAx7F,WAAOs7F,gBAAP,EAAyB,UAAUp+E,QAAV,EAAoB;AAC3C5e,aAAO4e,QAAP,IAAmB5f,OAAMC,OAAO2f,QAAP,CAAN,CAAnB;AACD,KAFD;AAGA5e,WAAOm9F,gBAAP,GAA0B18F,OAAOxB,OAAOk+F,gBAAd,CAA1B;AACD;AACD;;;;;;;;;;;;;;AAeA,MAAIC,OAAO,SAAPA,IAAO,CAAUx7B,UAAV,EAAsB0S,SAAtB,EAAiC;AAC1C1S,iBAAaA,cAAc,CAAC,GAAD,EAAM,GAAN,CAA3B;AACA,QAAIy7B,iBAAiB,EAArB;AACA,QAAIC,iBAAiB,EAArB;AACA,QAAIC,qBAAqB,EAAzB;;AAEA,SAAK,IAAIj+F,IAAI,CAAb,EAAgBA,IAAIsiE,WAAWpiE,MAA/B,EAAuCF,GAAvC,EAA4C;AAC1C;AACA,UAAIk+F,gBAAgB57B,WAAWtiE,CAAX,CAApB;;AAEA,UAAImD,SAAS+6F,aAAT,CAAJ,EAA6B;AAC3BA,wBAAgB;AACd3+F,gBAAM2+F;AADQ,SAAhB;AAGD;;AAED,UAAIC,gBAAgBD,cAAc3+F,IAAlC;AACA2+F,oBAAc96F,IAAd,GAAqB86F,cAAc96F,IAAd,IAAsB,OAA3C;;AAEA,UAAI,CAAC86F,cAAcp4B,QAAnB,EAA6B;AAC3Bo4B,sBAAcp4B,QAAd,GAAyBq4B,aAAzB;AACAD,sBAAcpC,aAAd,GAA8B,CAA9B;AACD;;AAEDoC,oBAAcpgB,SAAd,GAA0BogB,cAAcpgB,SAAd,IAA2B,EAArD;AACAkgB,qBAAex7F,IAAf,CAAoB27F,aAApB;AACAJ,qBAAeI,aAAf,IAAgCD,aAAhC;AACAA,oBAAc3lE,KAAd,GAAsBv4B,CAAtB;;AAEA,UAAIk+F,cAAcE,qBAAlB,EAAyC;AACvCH,2BAAmBE,aAAnB,IAAoC,EAApC;AACD;AACF;AACD;;;;;AAMA,SAAK77B,UAAL,GAAkB07B,cAAlB;AACA;;;;;AAKA,SAAKlnB,eAAL,GAAuBinB,cAAvB;AACA;;;;AAIA,SAAK/oB,SAAL,GAAiBA,SAAjB;AACA;;;;AAIA,SAAK4C,QAAL;AACA;;;;;;;AAOA,SAAKymB,QAAL,GAAgB,IAAhB;AACA,SAAKplB,MAAL,GAAc,CAAd;AACA,SAAKqkB,SAAL,GAAiB,CAAjB;AACA;;;;;;AAMA,SAAKgB,QAAL,GAAgB,EAAhB;AACA;;;;AAIA,SAAKC,SAAL,GAAiB,EAAjB;AACA;;;;AAIA,SAAKC,OAAL,GAAe,EAAf;AACA;;;;;;AAMA,SAAKC,aAAL,GAAqB,EAArB;AACA;;;;;;AAMA,SAAKC,OAAL,GAAe,EAAf;AACA;;;;;;AAMA,SAAKC,OAAL,GAAe,EAAf;AACA;;;;;;AAMA,SAAKC,YAAL,GAAoB,EAApB;AACA;;;;;;AAMA,SAAKC,aAAL,GAAqB,EAArB;AACA;;;;;;AAMA,SAAKC,YAAL,GAAoB,EAApB;AACA;;;;;;AAMA,SAAKC,WAAL,GAAmB,EAAnB;AACA;;;;;;AAMA,SAAKC,UAAL,GAAkB,GAAlB;AACA;;;;;AAKA,SAAKC,WAAL,GAAmB,CAAnB;AACA;;;;;AAKA,SAAKloB,QAAL;AACA;;;;;;;;;AASA,SAAKmoB,UAAL,GAAkB,EAAlB;AACA;;;;;AAKA,SAAKC,OAAL,GAAe,EAAf;AACA;;;;;;;AAOA,SAAKC,kBAAL,GAA0B,EAA1B;AACA;;;;;;AAMA,SAAKC,kBAAL,GAA0B7D,oBAAoB,IAApB,CAA1B;AACA;;;;;AAKA,SAAK8D,mBAAL,GAA2BrB,kBAA3B;AACA;;;;;AAKA,SAAKJ,gBAAL,GAAwB,EAAxB;AACD,GAlMD;;AAoMA,MAAI0B,YAAYzB,KAAKv/F,SAArB;AACAghG,YAAUn8F,IAAV,GAAiB,MAAjB;AACA;;;;;AAKAm8F,YAAUvoB,aAAV,GAA0B,IAA1B;AACA;;;;;;;;AAQAuoB,YAAUC,YAAV,GAAyB,UAAUx6B,GAAV,EAAe;AACtC,QAAI,CAAC7mD,MAAM6mD,GAAN,CAAL,EAAiB;AACfA,YAAM,KAAK1C,UAAL,CAAgB0C,GAAhB,KAAwBA,GAA9B;AACD;;AAED,WAAOA,GAAP;AACD,GAND;AAOA;;;;;;;AAQAu6B,YAAU/nB,gBAAV,GAA6B,UAAUxS,GAAV,EAAe;AAC1C;AACA,WAAO,KAAK8R,eAAL,CAAqB,KAAK0oB,YAAL,CAAkBx6B,GAAlB,CAArB,CAAP;AACD,GAHD;AAIA;;;;AAKAu6B,YAAUE,oBAAV,GAAiC,YAAY;AAC3C,WAAO,KAAKJ,kBAAL,CAAwBjD,eAAxB,CAAwCp9F,KAAxC,EAAP;AACD,GAFD;AAGA;;;;;;;;;;AAWAugG,YAAUrhB,YAAV,GAAyB,UAAUpY,QAAV,EAAoB7+C,GAApB,EAAyB;AAChD,QAAIy4E,oBAAoB,KAAKL,kBAA7B;;AAEA,QAAIp4E,OAAO,IAAX,EAAiB;AACf,aAAOy4E,kBAAkBrD,sBAAlB,CAAyCv2B,QAAzC,CAAP;AACD;;AAED,QAAI0O,OAAOkrB,kBAAkBxlC,MAAlB,CAAyB4L,QAAzB,CAAX;AACA,WAAO7+C,QAAQ,IAAR,CAAa;AAAb,MACL,CAACutD,QAAQ,EAAT,EAAax1E,KAAb,EADK,GACkBw1E,QAAQA,KAAKvtD,GAAL,CADjC;AAED,GAVD;AAWA;;;;;;;;;;;AAYAs4E,YAAUI,QAAV,GAAqB,UAAUx9F,IAAV,EAAgBy9F,QAAhB,EAA0BC,cAA1B,EAA0C;AAC7D,QAAIC,cAAc38B,OAAOrwB,UAAP,CAAkB3wC,IAAlB,KAA2BD,YAAYC,IAAZ,CAA7C;;AAEA,QAAI29F,WAAJ,EAAiB;AACf39F,aAAO,IAAI8yE,mBAAJ,CAAwB9yE,IAAxB,EAA8B,KAAKmgE,UAAL,CAAgBpiE,MAA9C,CAAP;AACD;;AAED,SAAK62E,QAAL,GAAgB50E,IAAhB,CAP6D,CAOvC;;AAEtB,SAAKm8F,QAAL,GAAgB,EAAhB;AACA,SAAKD,QAAL,GAAgB,IAAhB;AACA,SAAKE,SAAL,GAAiBqB,YAAY,EAA7B;AACA,SAAKpB,OAAL,GAAe,EAAf;AACA,SAAKuB,gBAAL,GAAwB,EAAxB;;AAEA,QAAI,CAACF,cAAL,EAAqB;AACnB,WAAK7oB,aAAL,GAAqB,KAArB;AACD;AACD;;;;AAKA,SAAKgpB,qBAAL,GAA6BrpB,uBAAuB,KAAKI,QAAL,CAAchT,SAAd,GAA0BV,YAAjD,CAA7B,CAvB6D,CAuBgC;;AAE7F,SAAK48B,eAAL,GAAuBJ,iBAAiBA,kBAAkB,KAAKG,qBAA/D,CAzB6D,CAyByB;;AAEtF,SAAKd,UAAL,GAAkB,EAAlB;;AAEA,SAAKgB,qBAAL,CAA2B,CAA3B,EAA8B/9F,KAAK0hB,KAAL,EAA9B,EA7B6D,CA6BhB;;;AAG7C,QAAI1hB,KAAKszE,IAAT,EAAe;AACb,WAAKuB,aAAL,GAAqB,KAArB;AACD;AACF,GAnCD;;AAqCAuoB,YAAUhoB,WAAV,GAAwB,YAAY;AAClC,WAAO,KAAKR,QAAZ;AACD,GAFD;;AAIAwoB,YAAU3pB,UAAV,GAAuB,UAAUzzE,IAAV,EAAgB;AACrC,QAAIg+F,UAAU,KAAKppB,QAAnB;AACA,QAAIn2D,QAAQ,KAAKiD,KAAL,EAAZ;AACAs8E,YAAQvqB,UAAR,CAAmBzzE,IAAnB;AACA,QAAI22C,MAAMqnD,QAAQt8E,KAAR,EAAV;;AAEA,QAAI,CAACs8E,QAAQzqB,UAAb,EAAyB;AACvB58B,aAAOl4B,KAAP;AACD;;AAED,SAAKs/E,qBAAL,CAA2Bt/E,KAA3B,EAAkCk4B,GAAlC;AACD,GAXD;;AAaAymD,YAAUW,qBAAV,GAAkC,UAAUt/E,KAAV,EAAiBk4B,GAAjB,EAAsB;AACtD;AACA,QAAIl4B,SAASk4B,GAAb,EAAkB;AAChB;AACD;;AAED,QAAIsnD,YAAY,KAAKpB,UAArB;AACA,QAAImB,UAAU,KAAKppB,QAAnB;AACA,QAAI9qE,UAAU,KAAKqyF,QAAnB;AACA,QAAIh8B,aAAa,KAAKA,UAAtB;AACA,QAAI+9B,SAAS/9B,WAAWpiE,MAAxB;AACA,QAAIogG,mBAAmB,KAAKxpB,eAA5B;AACA,QAAI8oB,WAAW,KAAKrB,SAApB;AACA,QAAIgC,SAAS,KAAK/B,OAAlB;AACA,QAAIgC,YAAY,KAAKtB,UAArB;AACA,QAAIuB,kBAAkB,KAAKV,gBAAL,GAAwB,EAA9C;AACA,QAAIW,UAAJ;AACA,QAAIC,aAAa,KAAK1B,WAAtB;AACA,QAAI2B,iBAAiBD,aAAa,CAAlC;;AAEA,SAAK,IAAI3gG,IAAI,CAAb,EAAgBA,IAAIqgG,MAApB,EAA4BrgG,GAA5B,EAAiC;AAC/B,UAAIglE,MAAM1C,WAAWtiE,CAAX,CAAV;;AAEA,UAAI,CAACwgG,UAAUx7B,GAAV,CAAL,EAAqB;AACnBw7B,kBAAUx7B,GAAV,IAAiB67B,kBAAjB;AACD;;AAED,UAAI5pB,UAAUqpB,iBAAiBt7B,GAAjB,CAAd;;AAEA,UAAIiS,QAAQ6G,SAAR,CAAkB3X,QAAlB,KAA+B,CAAnC,EAAsC;AACpCu6B,qBAAa,KAAKI,WAAL,GAAmB9gG,CAAhC;AACD;;AAED,UAAIi3E,QAAQ6G,SAAR,CAAkBijB,MAAlB,KAA6B,CAAjC,EAAoC;AAClC,aAAKC,SAAL,GAAiBhhG,CAAjB;AACD;;AAED,UAAIihG,WAAWnE,UAAU7lB,QAAQ7zE,IAAlB,CAAf;;AAEA,UAAI,CAAC6I,QAAQ+4D,GAAR,CAAL,EAAmB;AACjB/4D,gBAAQ+4D,GAAR,IAAe,EAAf;AACD;;AAED,UAAIk8B,mBAAmBj1F,QAAQ+4D,GAAR,EAAa47B,cAAb,CAAvB;;AAEA,UAAIM,oBAAoBA,iBAAiBhhG,MAAjB,GAA0BkgG,SAAlD,EAA6D;AAC3D,YAAIe,WAAW,IAAIF,QAAJ,CAAan6F,KAAKoB,GAAL,CAAS4wC,MAAM8nD,iBAAiBR,SAAhC,EAA2CA,SAA3C,CAAb,CAAf,CAD2D,CACyB;AACpF;;AAEA,aAAK,IAAIxiF,IAAI,CAAb,EAAgBA,IAAIsjF,iBAAiBhhG,MAArC,EAA6C0d,GAA7C,EAAkD;AAChDujF,mBAASvjF,CAAT,IAAcsjF,iBAAiBtjF,CAAjB,CAAd;AACD;;AAED3R,gBAAQ+4D,GAAR,EAAa47B,cAAb,IAA+BO,QAA/B;AACD,OAlC8B,CAkC7B;;;AAGF,WAAK,IAAInuF,IAAI2tF,aAAaP,SAA1B,EAAqCptF,IAAI8lC,GAAzC,EAA8C9lC,KAAKotF,SAAnD,EAA8D;AAC5Dn0F,gBAAQ+4D,GAAR,EAAaxiE,IAAb,CAAkB,IAAIy+F,QAAJ,CAAan6F,KAAKoB,GAAL,CAAS4wC,MAAM9lC,CAAf,EAAkBotF,SAAlB,CAAb,CAAlB;AACD;;AAED,WAAKnB,WAAL,GAAmBhzF,QAAQ+4D,GAAR,EAAa9kE,MAAhC;AACD;;AAED,QAAIivC,WAAW,IAAIzwC,KAAJ,CAAU2hG,MAAV,CAAf;;AAEA,SAAK,IAAIp5E,MAAMrG,KAAf,EAAsBqG,MAAM6xB,GAA5B,EAAiC7xB,KAAjC,EAAwC;AACtC;AACAkoB,iBAAWgxD,QAAQxqB,OAAR,CAAgB1uD,GAAhB,EAAqBkoB,QAArB,CAAX,CAFsC,CAEK;AAC3C;AACA;AACA;AACA;AACA;;AAEA,UAAIiyD,aAAat6F,KAAKuV,KAAL,CAAW4K,MAAMm5E,SAAjB,CAAjB;AACA,UAAIiB,cAAcp6E,MAAMm5E,SAAxB,CAVsC,CAUH;;AAEnC,WAAK,IAAIptF,IAAI,CAAb,EAAgBA,IAAIqtF,MAApB,EAA4BrtF,GAA5B,EAAiC;AAC/B,YAAIgyD,MAAM1C,WAAWtvD,CAAX,CAAV;AACA,YAAIsuF,aAAar1F,QAAQ+4D,GAAR,EAAao8B,UAAb,CAAjB,CAF+B,CAEY;;AAE3C,YAAIl9F,MAAM,KAAK+7F,eAAL,CAAqB9wD,QAArB,EAA+B61B,GAA/B,EAAoC/9C,GAApC,EAAyCjU,CAAzC,CAAV;;AAEAsuF,mBAAWD,WAAX,IAA0Bn9F,GAA1B;AACA,YAAIq9F,eAAef,UAAUx7B,GAAV,CAAnB;;AAEA,YAAI9gE,MAAMq9F,aAAa,CAAb,CAAV,EAA2B;AACzBA,uBAAa,CAAb,IAAkBr9F,GAAlB;AACD;;AAED,YAAIA,MAAMq9F,aAAa,CAAb,CAAV,EAA2B;AACzBA,uBAAa,CAAb,IAAkBr9F,GAAlB;AACD;AACF,OA5BqC,CA4BpC;AACF;;;AAGA,UAAI,CAACi8F,QAAQ1qB,IAAb,EAAmB;AACjB,YAAIl2E,OAAOqgG,SAAS34E,GAAT,CAAX;;AAEA,YAAIkoB,YAAY5vC,QAAQ,IAAxB,EAA8B;AAC5B;AACA;AACA,cAAI4vC,SAAS5vC,IAAT,IAAiB,IAArB,EAA2B;AACzB;AACA;AACAqgG,qBAAS34E,GAAT,IAAgB1nB,OAAO4vC,SAAS5vC,IAAhC;AACD,WAJD,MAIO,IAAImhG,cAAc,IAAlB,EAAwB;AAC7B,gBAAIc,UAAUl/B,WAAWo+B,UAAX,CAAd;AACA,gBAAIe,eAAex1F,QAAQu1F,OAAR,EAAiBJ,UAAjB,CAAnB;;AAEA,gBAAIK,YAAJ,EAAkB;AAChBliG,qBAAOkiG,aAAaJ,WAAb,CAAP;AACA,kBAAIlqB,cAAcmpB,iBAAiBkB,OAAjB,EAA0BrqB,WAA5C;;AAEA,kBAAIA,eAAeA,YAAYlG,UAAZ,CAAuB/wE,MAA1C,EAAkD;AAChDX,uBAAO43E,YAAYlG,UAAZ,CAAuB1xE,IAAvB,CAAP;AACD;AACF;AACF;AACF,SAvBgB,CAuBf;AACF;;;AAGA,YAAIgkB,KAAK4rB,YAAY,IAAZ,GAAmB,IAAnB,GAA0BA,SAAS5rB,EAA5C;;AAEA,YAAIA,MAAM,IAAN,IAAchkB,QAAQ,IAA1B,EAAgC;AAC9B;AACAkhG,0BAAgBlhG,IAAhB,IAAwBkhG,gBAAgBlhG,IAAhB,KAAyB,CAAjD;AACAgkB,eAAKhkB,IAAL;;AAEA,cAAIkhG,gBAAgBlhG,IAAhB,IAAwB,CAA5B,EAA+B;AAC7BgkB,kBAAM,WAAWk9E,gBAAgBlhG,IAAhB,CAAjB;AACD;;AAEDkhG,0BAAgBlhG,IAAhB;AACD;;AAEDgkB,cAAM,IAAN,KAAeg9E,OAAOt5E,GAAP,IAAc1D,EAA7B;AACD;AACF;;AAED,QAAI,CAAC48E,QAAQzqB,UAAT,IAAuByqB,QAAQhqB,KAAnC,EAA0C;AACxC;AACAgqB,cAAQhqB,KAAR;AACD;;AAED,SAAKmnB,SAAL,GAAiB,KAAKrkB,MAAL,GAAcngC,GAA/B,CApJsD,CAoJlB;;AAEpC,SAAKqmD,OAAL,GAAe,EAAf;AACAuC,yBAAqB,IAArB;AACD,GAxJD;;AA0JA,WAASA,oBAAT,CAA8BpzF,IAA9B,EAAoC;AAClC,QAAI2vF,qBAAqB3vF,KAAKgxF,mBAA9B;AACAl9F,WAAO67F,kBAAP,EAA2B,UAAU0D,eAAV,EAA2B38B,GAA3B,EAAgC;AACzD,UAAIiS,UAAU3oE,KAAKwoE,eAAL,CAAqB9R,GAArB,CAAd,CADyD,CAChB;;AAEzC,UAAImS,cAAcF,QAAQE,WAA1B;;AAEA,UAAIA,WAAJ,EAAiB;AACfwqB,0BAAkB1D,mBAAmBj5B,GAAnB,IAA0B,IAAIi4B,eAAJ,CAAoB9lB,YAAYlG,UAAZ,CAAuB/wE,MAA3C,CAA5C,CADe,CACiF;AAChG;;AAEA,aAAK,IAAIF,IAAI,CAAb,EAAgBA,IAAI2hG,gBAAgBzhG,MAApC,EAA4CF,GAA5C,EAAiD;AAC/C2hG,0BAAgB3hG,CAAhB,IAAqBk2D,GAArB;AACD;;AAED,aAAK,IAAIl2D,IAAI,CAAb,EAAgBA,IAAIsO,KAAK2qE,MAAzB,EAAiCj5E,GAAjC,EAAsC;AACpC;AACA2hG,0BAAgBrzF,KAAKpJ,GAAL,CAAS8/D,GAAT,EAAchlE,CAAd,CAAhB,IAAoCA,CAApC;AACD;AACF;AACF,KAlBD;AAmBD;;AAED,WAAS4hG,oBAAT,CAA8BtzF,IAA9B,EAAoCk4D,QAApC,EAA8Cq7B,QAA9C,EAAwD;AACtD,QAAI39F,GAAJ;;AAEA,QAAIsiE,YAAY,IAAhB,EAAsB;AACpB,UAAI45B,YAAY9xF,KAAK0wF,UAArB;AACA,UAAIoC,aAAat6F,KAAKuV,KAAL,CAAWwlF,WAAWzB,SAAtB,CAAjB;AACA,UAAIiB,cAAcQ,WAAWzB,SAA7B;AACA,UAAIp7B,MAAM12D,KAAKg0D,UAAL,CAAgBkE,QAAhB,CAAV;AACA,UAAIs7B,QAAQxzF,KAAKgwF,QAAL,CAAct5B,GAAd,EAAmBo8B,UAAnB,CAAZ;;AAEA,UAAIU,KAAJ,EAAW;AACT59F,cAAM49F,MAAMT,WAAN,CAAN;AACA,YAAIlqB,cAAc7oE,KAAKwoE,eAAL,CAAqB9R,GAArB,EAA0BmS,WAA5C;;AAEA,YAAIA,eAAeA,YAAYlG,UAAZ,CAAuB/wE,MAA1C,EAAkD;AAChDgE,gBAAMizE,YAAYlG,UAAZ,CAAuB/sE,GAAvB,CAAN;AACD;AACF;AACF;;AAED,WAAOA,GAAP;AACD;AACD;;;;AAKAq7F,YAAU17E,KAAV,GAAkB,YAAY;AAC5B,WAAO,KAAKo1D,MAAZ;AACD,GAFD;;AAIAsmB,YAAUwC,UAAV,GAAuB,YAAY;AACjC,QAAIC,UAAJ;AACA,QAAIh0B,UAAU,KAAKqwB,QAAnB;;AAEA,QAAIrwB,OAAJ,EAAa;AACX,UAAI7tE,OAAO6tE,QAAQ5tE,WAAnB;AACA,UAAI6hG,YAAY,KAAKhpB,MAArB,CAFW,CAEkB;;AAE7B,UAAI94E,SAASzB,KAAb,EAAoB;AAClBsjG,qBAAa,IAAI7hG,IAAJ,CAAS8hG,SAAT,CAAb;;AAEA,aAAK,IAAIjiG,IAAI,CAAb,EAAgBA,IAAIiiG,SAApB,EAA+BjiG,GAA/B,EAAoC;AAClCgiG,qBAAWhiG,CAAX,IAAgBguE,QAAQhuE,CAAR,CAAhB;AACD;AACF,OAND,MAMO;AACLgiG,qBAAa,IAAI7hG,IAAJ,CAAS6tE,QAAQk0B,MAAjB,EAAyB,CAAzB,EAA4BD,SAA5B,CAAb;AACD;AACF,KAbD,MAaO;AACL,UAAI9hG,OAAOk9F,eAAe,IAAf,CAAX;AACA,UAAI2E,aAAa,IAAI7hG,IAAJ,CAAS,KAAK0jB,KAAL,EAAT,CAAjB;;AAEA,WAAK,IAAI7jB,IAAI,CAAb,EAAgBA,IAAIgiG,WAAW9hG,MAA/B,EAAuCF,GAAvC,EAA4C;AAC1CgiG,mBAAWhiG,CAAX,IAAgBA,CAAhB;AACD;AACF;;AAED,WAAOgiG,UAAP;AACD,GA3BD;AA4BA;;;;;;;;AASAzC,YAAUr6F,GAAV,GAAgB,UAAU8/D,GAAV,EAAe/9C;AAC/B;AADgB,IAEd;AACA,QAAI,EAAEA,OAAO,CAAP,IAAYA,MAAM,KAAKgyD,MAAzB,CAAJ,EAAsC;AACpC,aAAO/iB,GAAP;AACD;;AAED,QAAIjqD,UAAU,KAAKqyF,QAAnB;;AAEA,QAAI,CAACryF,QAAQ+4D,GAAR,CAAL,EAAmB;AACjB;AACA,aAAO9O,GAAP;AACD;;AAEDjvC,UAAM,KAAK2tD,WAAL,CAAiB3tD,GAAjB,CAAN;AACA,QAAIm6E,aAAat6F,KAAKuV,KAAL,CAAW4K,MAAM,KAAK+3E,UAAtB,CAAjB;AACA,QAAIqC,cAAcp6E,MAAM,KAAK+3E,UAA7B;AACA,QAAImD,aAAal2F,QAAQ+4D,GAAR,EAAao8B,UAAb,CAAjB;AACA,QAAI3/F,QAAQ0gG,WAAWd,WAAX,CAAZ,CAhBA,CAgBqC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,WAAO5/F,KAAP;AACD,GAtCD;AAuCA;;;;;;AAOA89F,YAAUxqB,aAAV,GAA0B,UAAU/P,GAAV,EAAeo9B,MAAf,EAAuB;AAC/C,QAAI,EAAEA,UAAU,CAAV,IAAeA,SAAS,KAAK9E,SAA/B,CAAJ,EAA+C;AAC7C,aAAOpnC,GAAP;AACD;;AAED,QAAImsC,WAAW,KAAK/D,QAAL,CAAct5B,GAAd,CAAf;;AAEA,QAAI,CAACq9B,QAAL,EAAe;AACb;AACA,aAAOnsC,GAAP;AACD;;AAED,QAAIkrC,aAAat6F,KAAKuV,KAAL,CAAW+lF,SAAS,KAAKpD,UAAzB,CAAjB;AACA,QAAIqC,cAAce,SAAS,KAAKpD,UAAhC;AACA,QAAImD,aAAaE,SAASjB,UAAT,CAAjB;AACA,WAAOe,WAAWd,WAAX,CAAP;AACD,GAhBD;AAiBA;;;;;;AAOA9B,YAAU+C,QAAV,GAAqB,UAAUt9B,GAAV,EAAeo9B,MAAf,EAAuB;AAC1C,QAAIhB,aAAat6F,KAAKuV,KAAL,CAAW+lF,SAAS,KAAKpD,UAAzB,CAAjB;AACA,QAAIqC,cAAce,SAAS,KAAKpD,UAAhC;AACA,QAAImD,aAAa,KAAK7D,QAAL,CAAct5B,GAAd,EAAmBo8B,UAAnB,CAAjB;AACA,WAAOe,WAAWd,WAAX,CAAP;AACD,GALD;AAMA;;;;;;;AAQA9B,YAAUgD,SAAV,GAAsB,UAAUjgC,UAAV,EAAsBr7C;AAC5C;AADsB,IAEpB;AACA,QAAIvjB,SAAS,EAAb;;AAEA,QAAI,CAAC3C,QAAQuhE,UAAR,CAAL,EAA0B;AACxB;AACAr7C,YAAMq7C,UAAN;AACAA,mBAAa,KAAKA,UAAlB;AACD;;AAED,SAAK,IAAItiE,IAAI,CAAR,EAAWC,MAAMqiE,WAAWpiE,MAAjC,EAAyCF,IAAIC,GAA7C,EAAkDD,GAAlD,EAAuD;AACrD0D,aAAOlB,IAAP,CAAY,KAAK0C,GAAL,CAASo9D,WAAWtiE,CAAX,CAAT,EAAwBinB;AACpC;AADY,OAAZ;AAGD;;AAED,WAAOvjB,MAAP;AACD,GAlBD;AAmBA;;;;;;;;AASA67F,YAAU9hC,QAAV,GAAqB,UAAUx2C,GAAV,EAAe;AAClC,QAAIm1E,kBAAkB,KAAKiD,kBAAL,CAAwBjD,eAA9C;AACA,QAAI2B,iBAAiB,KAAKjnB,eAA1B;;AAEA,SAAK,IAAI92E,IAAI,CAAR,EAAWC,MAAMm8F,gBAAgBl8F,MAAtC,EAA8CF,IAAIC,GAAlD,EAAuDD,GAAvD,EAA4D;AAC1D,WAAK;AACL+9F,qBAAe3B,gBAAgBp8F,CAAhB,CAAf,EAAmCoD,IAAnC,KAA4C,SAA5C,CAAsD;AAAtD,SACG+a,MAAM,KAAKjZ,GAAL,CAASk3F,gBAAgBp8F,CAAhB,CAAT,EAA6BinB,GAA7B,CAAN,CAFH,EAE6C;AAC3C,eAAO,KAAP;AACD;AACF;;AAED,WAAO,IAAP;AACD,GAbD;AAcA;;;;;;AAOAs4E,YAAUiD,aAAV,GAA0B,UAAUx9B;AACpC;AAD0B,IAExB;AACA;AACAA,UAAM,KAAKw6B,YAAL,CAAkBx6B,GAAlB,CAAN;AACA,QAAIy9B,UAAU,KAAKnE,QAAL,CAAct5B,GAAd,CAAd;AACA,QAAI09B,gBAAgB7B,kBAApB,CAJA,CAIwC;;AAExC,QAAI,CAAC4B,OAAL,EAAc;AACZ,aAAOC,aAAP;AACD,KARD,CAQE;;;AAGF,QAAIC,UAAU,KAAK9+E,KAAL,EAAd,CAXA,CAW4B;AAC5B;AACA;AACA;AACA;;AAEA,QAAI++E,SAAS,CAAC,KAAKvE,QAAnB,CAjBA,CAiB6B;;AAE7B,QAAIwE,SAAJ;;AAEA,QAAID,MAAJ,EAAY;AACV,aAAO,KAAK1D,UAAL,CAAgBl6B,GAAhB,EAAqBhmE,KAArB,EAAP;AACD;;AAED6jG,gBAAY,KAAK1D,OAAL,CAAan6B,GAAb,CAAZ;;AAEA,QAAI69B,SAAJ,EAAe;AACb,aAAOA,UAAU7jG,KAAV,EAAP;AACD;;AAED6jG,gBAAYH,aAAZ;AACA,QAAIx6F,MAAM26F,UAAU,CAAV,CAAV;AACA,QAAI16F,MAAM06F,UAAU,CAAV,CAAV;;AAEA,SAAK,IAAI7iG,IAAI,CAAb,EAAgBA,IAAI2iG,OAApB,EAA6B3iG,GAA7B,EAAkC;AAChC;AACA,UAAIyB,QAAQ,KAAK6gG,QAAL,CAAct9B,GAAd,EAAmB,KAAK4P,WAAL,CAAiB50E,CAAjB,CAAnB,CAAZ;;AAEAyB,cAAQyG,GAAR,KAAgBA,MAAMzG,KAAtB;AACAA,cAAQ0G,GAAR,KAAgBA,MAAM1G,KAAtB;AACD;;AAEDohG,gBAAY,CAAC36F,GAAD,EAAMC,GAAN,CAAZ;AACA,SAAKg3F,OAAL,CAAan6B,GAAb,IAAoB69B,SAApB;AACA,WAAOA,SAAP;AACD,GAhDD;AAiDA;;;;;;;AAQAtD,YAAUuD,oBAAV,GAAiC,UAAU99B;AAC3C;AADiC,IAE/B;AACAA,UAAM,KAAKw6B,YAAL,CAAkBx6B,GAAlB,CAAN;AACA,WAAO,KAAKo6B,kBAAL,CAAwBp6B,GAAxB,KAAgC,KAAKw9B,aAAL,CAAmBx9B;AAC1D;AADuC,KAAvC;AAGD,GAPD;;AASAu6B,YAAUwD,oBAAV,GAAiC,UAAUC,MAAV,EAAkBh+B;AACnD;AADiC,IAE/B;AACAA,UAAM,KAAKw6B,YAAL,CAAkBx6B,GAAlB,CAAN;AACA,SAAKo6B,kBAAL,CAAwBp6B,GAAxB,IAA+Bg+B,OAAOhkG,KAAP,EAA/B;AACD,GALD;AAMA;;;;;AAMAugG,YAAU1rB,kBAAV,GAA+B,UAAUtzE,GAAV,EAAe;AAC5C,WAAO,KAAKs9F,gBAAL,CAAsBt9F,GAAtB,CAAP;AACD,GAFD;AAGA;;;;;AAMAg/F,YAAUrrB,kBAAV,GAA+B,UAAU3zE,GAAV,EAAekB,KAAf,EAAsB;AACnDk7F,eAAWp8F,GAAX,IAAkBY,OAAO,KAAK08F,gBAAZ,EAA8Bt9F,GAA9B,CAAlB,GAAuD,KAAKs9F,gBAAL,CAAsBt9F,GAAtB,IAA6BkB,KAApF;AACD,GAFD;AAGA;;;;;AAMA89F,YAAU0D,MAAV,GAAmB,UAAUj+B;AAC7B;AADmB,IAEjB;AACA,QAAIy9B,UAAU,KAAKnE,QAAL,CAAct5B,GAAd,CAAd;AACA,QAAIhe,MAAM,CAAV;;AAEA,QAAIy7C,OAAJ,EAAa;AACX,WAAK,IAAIziG,IAAI,CAAR,EAAWC,MAAM,KAAK4jB,KAAL,EAAtB,EAAoC7jB,IAAIC,GAAxC,EAA6CD,GAA7C,EAAkD;AAChD,YAAIyB,QAAQ,KAAKyD,GAAL,CAAS8/D,GAAT,EAAchlE;AAC1B;AADY,SAAZ;;AAIA,YAAI,CAACme,MAAM1c,KAAN,CAAL,EAAmB;AACjBulD,iBAAOvlD,KAAP;AACD;AACF;AACF;;AAED,WAAOulD,GAAP;AACD,GAnBD;AAoBA;;;;;AAMAu4C,YAAU2D,SAAV,GAAsB,UAAUl+B;AAChC;AADsB,IAEpB;AACA,QAAIm+B,eAAe,EAAnB,CADA,CACuB;;AAEvB,SAAKp+F,IAAL,CAAUigE,GAAV,EAAe,UAAU9gE,GAAV,EAAe+iB,GAAf,EAAoB;AACjC,UAAI,CAAC9I,MAAMja,GAAN,CAAL,EAAiB;AACfi/F,qBAAa3gG,IAAb,CAAkB0B,GAAlB;AACD;AACF,KAJD,EAHA,CAOI;AACJ;AACA;;AAEA,QAAIk/F,qBAAqB,GAAGpgG,MAAH,CAAUmgG,YAAV,EAAwBhjF,IAAxB,CAA6B,UAAU7a,CAAV,EAAaC,CAAb,EAAgB;AACpE,aAAOD,IAAIC,CAAX;AACD,KAFwB,CAAzB;AAGA,QAAItF,MAAM,KAAK4jB,KAAL,EAAV,CAdA,CAcwB;;AAExB,WAAO5jB,QAAQ,CAAR,GAAY,CAAZ,GAAgBA,MAAM,CAAN,KAAY,CAAZ,GAAgBmjG,mBAAmB,CAACnjG,MAAM,CAAP,IAAY,CAA/B,CAAhB,GAAoD,CAACmjG,mBAAmBnjG,MAAM,CAAzB,IAA8BmjG,mBAAmBnjG,MAAM,CAAN,GAAU,CAA7B,CAA/B,IAAkE,CAA7I;AACD,GAnBD,CA1/zB4B,CA6g0BzB;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;AASAs/F,YAAUzqB,UAAV,GAAuB,UAAU9P,GAAV,EAAevjE,KAAf,EAAsB;AAC3C,QAAIkgG,kBAAkB38B,OAAO,KAAKs6B,mBAAL,CAAyBt6B,GAAzB,CAA7B;AACA,QAAI68B,WAAWF,gBAAgBlgG,KAAhB,CAAf;;AAEA,QAAIogG,YAAY,IAAZ,IAAoB1jF,MAAM0jF,QAAN,CAAxB,EAAyC;AACvC,aAAO,CAAC,CAAR;AACD;;AAED,WAAOA,QAAP;AACD,GATD;AAUA;;;;;;;AAQAtC,YAAU7uD,WAAV,GAAwB,UAAUnxC,IAAV,EAAgB;AACtC,SAAK,IAAIS,IAAI,CAAR,EAAWC,MAAM,KAAK4jB,KAAL,EAAtB,EAAoC7jB,IAAIC,GAAxC,EAA6CD,GAA7C,EAAkD;AAChD,UAAI,KAAKg4E,OAAL,CAAah4E,CAAb,MAAoBT,IAAxB,EAA8B;AAC5B,eAAOS,CAAP;AACD;AACF;;AAED,WAAO,CAAC,CAAR;AACD,GARD;AASA;;;;;;;AAQAu/F,YAAU9uD,eAAV,GAA4B,UAAUoxD,QAAV,EAAoB;AAC9C,QAAI,CAAC,KAAKxD,QAAV,EAAoB;AAClB,aAAOwD,QAAP;AACD;;AAED,QAAIA,YAAY,KAAKvE,SAAjB,IAA8BuE,WAAW,CAA7C,EAAgD;AAC9C,aAAO,CAAC,CAAR;AACD,KAP6C,CAO5C;;;AAGF,QAAI7zB,UAAU,KAAKqwB,QAAnB,CAV8C,CAUjB;;AAE7B,QAAItmB,eAAe/J,QAAQ6zB,QAAR,CAAnB;;AAEA,QAAI9pB,gBAAgB,IAAhB,IAAwBA,eAAe,KAAKkB,MAA5C,IAAsDlB,iBAAiB8pB,QAA3E,EAAqF;AACnF,aAAOA,QAAP;AACD;;AAED,QAAI74E,OAAO,CAAX;AACA,QAAIC,QAAQ,KAAKgwD,MAAL,GAAc,CAA1B;;AAEA,WAAOjwD,QAAQC,KAAf,EAAsB;AACpB,UAAIC,MAAM,CAACF,OAAOC,KAAR,IAAiB,CAAjB,GAAqB,CAA/B;;AAEA,UAAI+kD,QAAQ9kD,GAAR,IAAe24E,QAAnB,EAA6B;AAC3B74E,eAAOE,MAAM,CAAb;AACD,OAFD,MAEO,IAAI8kD,QAAQ9kD,GAAR,IAAe24E,QAAnB,EAA6B;AAClC54E,gBAAQC,MAAM,CAAd;AACD,OAFM,MAEA;AACL,eAAOA,GAAP;AACD;AACF;;AAED,WAAO,CAAC,CAAR;AACD,GAlCD;AAmCA;;;;;;;;AASAq2E,YAAU8D,gBAAV,GAA6B,UAAUr+B,GAAV,EAAevjE,KAAf,EAAsB6hG,WAAtB,EAAmC;AAC9D,QAAIr3F,UAAU,KAAKqyF,QAAnB;AACA,QAAImE,UAAUx2F,QAAQ+4D,GAAR,CAAd;AACA,QAAIu+B,iBAAiB,EAArB;;AAEA,QAAI,CAACd,OAAL,EAAc;AACZ,aAAOc,cAAP;AACD;;AAED,QAAID,eAAe,IAAnB,EAAyB;AACvBA,oBAAcxrD,QAAd;AACD;;AAED,QAAI0rD,UAAUnlD,OAAOC,SAArB;AACA,QAAImlD,UAAU,CAAC,CAAf;;AAEA,SAAK,IAAIzjG,IAAI,CAAR,EAAWC,MAAM,KAAK4jB,KAAL,EAAtB,EAAoC7jB,IAAIC,GAAxC,EAA6CD,GAA7C,EAAkD;AAChD,UAAIs6C,OAAO74C,QAAQ,KAAKyD,GAAL,CAAS8/D,GAAT,EAAchlE;AACjC;AADmB,OAAnB;AAGA,UAAI0H,OAAOZ,KAAKyzC,GAAL,CAASD,IAAT,CAAX;;AAEA,UAAIA,QAAQgpD,WAAR,IAAuB57F,QAAQ87F,OAAnC,EAA4C;AAC1C;AACA;AACA;AACA,YAAI97F,OAAO87F,OAAP,IAAkBlpD,QAAQ,CAAR,IAAampD,UAAU,CAA7C,EAAgD;AAC9CD,oBAAU97F,IAAV;AACA+7F,oBAAUnpD,IAAV;AACAipD,yBAAerjG,MAAf,GAAwB,CAAxB;AACD;;AAEDqjG,uBAAe/gG,IAAf,CAAoBxC,CAApB;AACD;AACF;;AAED,WAAOujG,cAAP;AACD,GArCD;AAsCA;;;;;;AAOAhE,YAAU3qB,WAAV,GAAwB8uB,yBAAxB;;AAEA,WAASA,yBAAT,CAAmCz8E,GAAnC,EAAwC;AACtC,WAAOA,GAAP;AACD;;AAED,WAAS08E,sBAAT,CAAgC18E,GAAhC,EAAqC;AACnC,QAAIA,MAAM,KAAKgyD,MAAX,IAAqBhyD,OAAO,CAAhC,EAAmC;AACjC,aAAO,KAAKo3E,QAAL,CAAcp3E,GAAd,CAAP;AACD;;AAED,WAAO,CAAC,CAAR;AACD;AACD;;;;;;AAOAs4E,YAAUjoB,cAAV,GAA2B,UAAUrwD,GAAV,EAAe;AACxC,QAAI,CAAC,KAAK8vD,QAAL,CAAcrB,UAAnB,EAA+B;AAC7B,UAAIxxE,MAAM,EAAV;;AAEA,WAAK,IAAIlE,IAAI,CAAb,EAAgBA,IAAI,KAAKsiE,UAAL,CAAgBpiE,MAApC,EAA4CF,GAA5C,EAAiD;AAC/C,YAAIglE,MAAM,KAAK1C,UAAL,CAAgBtiE,CAAhB,CAAV;AACAkE,YAAI1B,IAAJ,CAAS,KAAK0C,GAAL,CAAS8/D,GAAT,EAAc/9C,GAAd,CAAT;AACD;;AAED,aAAO/iB,GAAP;AACD,KATD,MASO;AACL,aAAO,KAAK6yE,QAAL,CAAcpB,OAAd,CAAsB,KAAKf,WAAL,CAAiB3tD,GAAjB,CAAtB,CAAP;AACD;AACF,GAbD;AAcA;;;;;;AAOAs4E,YAAUvnB,OAAV,GAAoB,UAAU/wD,GAAV,EAAe;AACjC,QAAI46E,WAAW,KAAKjtB,WAAL,CAAiB3tD,GAAjB,CAAf;AACA,WAAO,KAAKs3E,SAAL,CAAesD,QAAf,KAA4BD,qBAAqB,IAArB,EAA2B,KAAKd,WAAhC,EAA6Ce,QAA7C,CAA5B,IAAsF,EAA7F;AACD,GAHD;AAIA;;;;;;AAOAtC,YAAUzxD,KAAV,GAAkB,UAAU7mB,GAAV,EAAe;AAC/B,WAAO6mB,MAAM,IAAN,EAAY,KAAK8mC,WAAL,CAAiB3tD,GAAjB,CAAZ,CAAP;AACD,GAFD;;AAIA,WAAS6mB,KAAT,CAAex/B,IAAf,EAAqBuzF,QAArB,EAA+B;AAC7B,QAAIt+E,KAAKjV,KAAKkwF,OAAL,CAAaqD,QAAb,CAAT;;AAEA,QAAIt+E,MAAM,IAAV,EAAgB;AACdA,WAAKq+E,qBAAqBtzF,IAArB,EAA2BA,KAAK0yF,SAAhC,EAA2Ca,QAA3C,CAAL;AACD;;AAED,QAAIt+E,MAAM,IAAV,EAAgB;AACd;AACAA,WAAKs5E,YAAYgF,QAAjB;AACD;;AAED,WAAOt+E,EAAP;AACD;;AAED,WAASqgF,mBAAT,CAA6BthC,UAA7B,EAAyC;AACvC,QAAI,CAACvhE,QAAQuhE,UAAR,CAAL,EAA0B;AACxBA,mBAAa,CAACA,UAAD,CAAb;AACD;;AAED,WAAOA,UAAP;AACD;;AAED;;;;;;;;;;;;AAaAi9B,YAAUx6F,IAAV,GAAiB,UAAUyvE,IAAV,EAAgBlyE,EAAhB,EAAoBC,OAApB,EAA6BshG,aAA7B,EAA4C;AAC3D;;AAEA,QAAI,CAAC,KAAK5qB,MAAV,EAAkB;AAChB;AACD;;AAED,QAAI,OAAOzE,IAAP,KAAgB,UAApB,EAAgC;AAC9BqvB,sBAAgBthG,OAAhB;AACAA,gBAAUD,EAAV;AACAA,WAAKkyE,IAAL;AACAA,aAAO,EAAP;AACD,KAZ0D,CAYzD;;;AAGFjyE,cAAUA,WAAWshG,aAAX,IAA4B,IAAtC;AACArvB,WAAOt1E,IAAI0kG,oBAAoBpvB,IAApB,CAAJ,EAA+B,KAAKgrB,YAApC,EAAkD,IAAlD,CAAP;AACA,QAAItqB,UAAUV,KAAKt0E,MAAnB;;AAEA,SAAK,IAAIF,IAAI,CAAb,EAAgBA,IAAI,KAAK6jB,KAAL,EAApB,EAAkC7jB,GAAlC,EAAuC;AACrC;AACA,cAAQk1E,OAAR;AACE,aAAK,CAAL;AACE5yE,aAAGxC,IAAH,CAAQyC,OAAR,EAAiBvC,CAAjB;AACA;;AAEF,aAAK,CAAL;AACEsC,aAAGxC,IAAH,CAAQyC,OAAR,EAAiB,KAAK2C,GAAL,CAASsvE,KAAK,CAAL,CAAT,EAAkBx0E,CAAlB,CAAjB,EAAuCA,CAAvC;AACA;;AAEF,aAAK,CAAL;AACEsC,aAAGxC,IAAH,CAAQyC,OAAR,EAAiB,KAAK2C,GAAL,CAASsvE,KAAK,CAAL,CAAT,EAAkBx0E,CAAlB,CAAjB,EAAuC,KAAKkF,GAAL,CAASsvE,KAAK,CAAL,CAAT,EAAkBx0E,CAAlB,CAAvC,EAA6DA,CAA7D;AACA;;AAEF;AACE,cAAIgT,IAAI,CAAR;AACA,cAAIvR,QAAQ,EAAZ;;AAEA,iBAAOuR,IAAIkiE,OAAX,EAAoBliE,GAApB,EAAyB;AACvBvR,kBAAMuR,CAAN,IAAW,KAAK9N,GAAL,CAASsvE,KAAKxhE,CAAL,CAAT,EAAkBhT,CAAlB,CAAX;AACD,WANH,CAMI;;;AAGFyB,gBAAMuR,CAAN,IAAWhT,CAAX;AACAsC,aAAGS,KAAH,CAASR,OAAT,EAAkBd,KAAlB;AAvBJ;AAyBD;AACF,GA/CD;AAgDA;;;;;;;AAQA89F,YAAUuE,UAAV,GAAuB,UAAUxhC,UAAV,EAAsBhgE,EAAtB,EAA0BC,OAA1B,EAAmCshG,aAAnC,EAAkD;AACvE;;AAEA,QAAI,CAAC,KAAK5qB,MAAV,EAAkB;AAChB;AACD;;AAED,QAAI,OAAO3W,UAAP,KAAsB,UAA1B,EAAsC;AACpCuhC,sBAAgBthG,OAAhB;AACAA,gBAAUD,EAAV;AACAA,WAAKggE,UAAL;AACAA,mBAAa,EAAb;AACD,KAZsE,CAYrE;;;AAGF//D,cAAUA,WAAWshG,aAAX,IAA4B,IAAtC;AACAvhC,iBAAapjE,IAAI0kG,oBAAoBthC,UAApB,CAAJ,EAAqC,KAAKk9B,YAA1C,EAAwD,IAAxD,CAAb;AACA,QAAI37E,QAAQ,KAAKA,KAAL,EAAZ;AACA,QAAI1jB,OAAOk9F,eAAe,IAAf,CAAX;AACA,QAAI2E,aAAa,IAAI7hG,IAAJ,CAAS0jB,KAAT,CAAjB;AACA,QAAIpiB,QAAQ,EAAZ;AACA,QAAIyzE,UAAU5S,WAAWpiE,MAAzB;AACA,QAAIuF,SAAS,CAAb;AACA,QAAIs+F,OAAOzhC,WAAW,CAAX,CAAX;;AAEA,SAAK,IAAItiE,IAAI,CAAb,EAAgBA,IAAI6jB,KAApB,EAA2B7jB,GAA3B,EAAgC;AAC9B,UAAI2jF,IAAJ;AACA,UAAIye,SAAS,KAAKxtB,WAAL,CAAiB50E,CAAjB,CAAb,CAF8B,CAEI;;AAElC,UAAIk1E,YAAY,CAAhB,EAAmB;AACjByO,eAAOrhF,GAAGxC,IAAH,CAAQyC,OAAR,EAAiBvC,CAAjB,CAAP;AACD,OAFD,MAEO,IAAIk1E,YAAY,CAAhB,EAAmB;AACxB,YAAIhxE,MAAM,KAAKo+F,QAAL,CAAcyB,IAAd,EAAoB3B,MAApB,CAAV;;AAEAze,eAAOrhF,GAAGxC,IAAH,CAAQyC,OAAR,EAAiB2B,GAAjB,EAAsBlE,CAAtB,CAAP;AACD,OAJM,MAIA;AACL,aAAK,IAAIgT,IAAI,CAAb,EAAgBA,IAAIkiE,OAApB,EAA6BliE,GAA7B,EAAkC;AAChCvR,gBAAMuR,CAAN,IAAW,KAAKsvF,QAAL,CAAcyB,IAAd,EAAoB3B,MAApB,CAAX;AACD;;AAED3gG,cAAMuR,CAAN,IAAWhT,CAAX;AACA2jF,eAAOrhF,GAAGS,KAAH,CAASR,OAAT,EAAkBd,KAAlB,CAAP;AACD;;AAED,UAAIkiF,IAAJ,EAAU;AACRqe,mBAAWv8F,QAAX,IAAuB28F,MAAvB;AACD;AACF,KA/CsE,CA+CrE;;;AAGF,QAAI38F,SAASoe,KAAb,EAAoB;AAClB,WAAKw6E,QAAL,GAAgB2D,UAAhB;AACD;;AAED,SAAK/oB,MAAL,GAAcxzE,MAAd,CAtDuE,CAsDjD;;AAEtB,SAAK05F,OAAL,GAAe,EAAf;AACA,SAAKvqB,WAAL,GAAmB,KAAKypB,QAAL,GAAgBsF,sBAAhB,GAAyCD,yBAA5D;AACA,WAAO,IAAP;AACD,GA3DD;AA4DA;;;;;AAMAnE,YAAUyE,WAAV,GAAwB,UAAUjjF,KAAV,EAAiB;AACvC;;AAEA,QAAI,CAAC,KAAKk4D,MAAV,EAAkB;AAChB;AACD;;AAED,QAAI3W,aAAa,EAAjB;;AAEA,SAAK,IAAI0C,GAAT,IAAgBjkD,KAAhB,EAAuB;AACrB,UAAIA,MAAMvgB,cAAN,CAAqBwkE,GAArB,CAAJ,EAA+B;AAC7B1C,mBAAW9/D,IAAX,CAAgBwiE,GAAhB;AACD;AACF;;AAED,QAAIkQ,UAAU5S,WAAWpiE,MAAzB;;AAEA,QAAI,CAACg1E,OAAL,EAAc;AACZ;AACD;;AAED,QAAI+uB,gBAAgB,KAAKpgF,KAAL,EAApB;AACA,QAAI1jB,OAAOk9F,eAAe,IAAf,CAAX;AACA,QAAI2E,aAAa,IAAI7hG,IAAJ,CAAS8jG,aAAT,CAAjB;AACA,QAAIx+F,SAAS,CAAb;AACA,QAAIs+F,OAAOzhC,WAAW,CAAX,CAAX;AACA,QAAIp6D,MAAM6Y,MAAMgjF,IAAN,EAAY,CAAZ,CAAV;AACA,QAAI57F,MAAM4Y,MAAMgjF,IAAN,EAAY,CAAZ,CAAV;AACA,QAAIG,gBAAgB,KAApB;;AAEA,QAAI,CAAC,KAAK7F,QAAV,EAAoB;AAClB;AACA,UAAIp3E,MAAM,CAAV;;AAEA,UAAIiuD,YAAY,CAAhB,EAAmB;AACjB,YAAIosB,aAAa,KAAKhD,QAAL,CAAch8B,WAAW,CAAX,CAAd,CAAjB;;AAEA,aAAK,IAAItvD,IAAI,CAAb,EAAgBA,IAAI,KAAKisF,WAAzB,EAAsCjsF,GAAtC,EAA2C;AACzC,cAAImxF,eAAe7C,WAAWtuF,CAAX,CAAnB;AACA,cAAI/S,MAAM6G,KAAKoB,GAAL,CAAS,KAAK+wE,MAAL,GAAcjmE,IAAI,KAAKgsF,UAAhC,EAA4C,KAAKA,UAAjD,CAAV;;AAEA,eAAK,IAAIh/F,IAAI,CAAb,EAAgBA,IAAIC,GAApB,EAAyBD,GAAzB,EAA8B;AAC5B,gBAAIkE,MAAMigG,aAAankG,CAAb,CAAV,CAD4B,CACD;AAC3B;AACA;AACA;AACA;;AAEA,gBAAIkE,OAAOgE,GAAP,IAAchE,OAAOiE,GAArB,IAA4BgW,MAAMja,GAAN,CAAhC,EAA4C;AAC1C89F,yBAAWv8F,QAAX,IAAuBwhB,GAAvB;AACD;;AAEDA;AACD;AACF;;AAEDi9E,wBAAgB,IAAhB;AACD,OAvBD,MAuBO,IAAIhvB,YAAY,CAAhB,EAAmB;AACxB,YAAIosB,aAAa,KAAKhD,QAAL,CAAcyF,IAAd,CAAjB;AACA,YAAIK,cAAc,KAAK9F,QAAL,CAAch8B,WAAW,CAAX,CAAd,CAAlB;AACA,YAAIvnB,OAAOh6B,MAAMuhD,WAAW,CAAX,CAAN,EAAqB,CAArB,CAAX;AACA,YAAItnB,OAAOj6B,MAAMuhD,WAAW,CAAX,CAAN,EAAqB,CAArB,CAAX;;AAEA,aAAK,IAAItvD,IAAI,CAAb,EAAgBA,IAAI,KAAKisF,WAAzB,EAAsCjsF,GAAtC,EAA2C;AACzC,cAAImxF,eAAe7C,WAAWtuF,CAAX,CAAnB;AACA,cAAIqxF,gBAAgBD,YAAYpxF,CAAZ,CAApB;AACA,cAAI/S,MAAM6G,KAAKoB,GAAL,CAAS,KAAK+wE,MAAL,GAAcjmE,IAAI,KAAKgsF,UAAhC,EAA4C,KAAKA,UAAjD,CAAV;;AAEA,eAAK,IAAIh/F,IAAI,CAAb,EAAgBA,IAAIC,GAApB,EAAyBD,GAAzB,EAA8B;AAC5B,gBAAIkE,MAAMigG,aAAankG,CAAb,CAAV;AACA,gBAAIskG,OAAOD,cAAcrkG,CAAd,CAAX,CAF4B,CAEC;;AAE7B,gBAAI,CAACkE,OAAOgE,GAAP,IAAchE,OAAOiE,GAArB,IAA4BgW,MAAMja,GAAN,CAA7B,MAA6CogG,QAAQvpD,IAAR,IAAgBupD,QAAQtpD,IAAxB,IAAgC78B,MAAMmmF,IAAN,CAA7E,CAAJ,EAA+F;AAC7FtC,yBAAWv8F,QAAX,IAAuBwhB,GAAvB;AACD;;AAEDA;AACD;AACF;;AAEDi9E,wBAAgB,IAAhB;AACD;AACF;;AAED,QAAI,CAACA,aAAL,EAAoB;AAClB,UAAIhvB,YAAY,CAAhB,EAAmB;AACjB,aAAK,IAAIl1E,IAAI,CAAb,EAAgBA,IAAIikG,aAApB,EAAmCjkG,GAAnC,EAAwC;AACtC,cAAI6hG,WAAW,KAAKjtB,WAAL,CAAiB50E,CAAjB,CAAf;;AAEA,cAAIkE,MAAM,KAAKo+F,QAAL,CAAcyB,IAAd,EAAoBlC,QAApB,CAAV,CAHsC,CAGG;;;AAGzC,cAAI39F,OAAOgE,GAAP,IAAchE,OAAOiE,GAArB,IAA4BgW,MAAMja,GAAN,CAAhC,EAA4C;AAC1C89F,uBAAWv8F,QAAX,IAAuBo8F,QAAvB;AACD;AACF;AACF,OAXD,MAWO;AACL,aAAK,IAAI7hG,IAAI,CAAb,EAAgBA,IAAIikG,aAApB,EAAmCjkG,GAAnC,EAAwC;AACtC,cAAI2jF,OAAO,IAAX;AACA,cAAIke,WAAW,KAAKjtB,WAAL,CAAiB50E,CAAjB,CAAf;;AAEA,eAAK,IAAIgT,IAAI,CAAb,EAAgBA,IAAIkiE,OAApB,EAA6BliE,GAA7B,EAAkC;AAChC,gBAAIuxF,OAAOjiC,WAAWtvD,CAAX,CAAX;;AAEA,gBAAI9O,MAAM,KAAKo+F,QAAL,CAAct9B,GAAd,EAAmB68B,QAAnB,CAAV,CAHgC,CAGQ;;;AAGxC,gBAAI39F,MAAM6c,MAAMwjF,IAAN,EAAY,CAAZ,CAAN,IAAwBrgG,MAAM6c,MAAMwjF,IAAN,EAAY,CAAZ,CAAlC,EAAkD;AAChD5gB,qBAAO,KAAP;AACD;AACF;;AAED,cAAIA,IAAJ,EAAU;AACRqe,uBAAWv8F,QAAX,IAAuB,KAAKmvE,WAAL,CAAiB50E,CAAjB,CAAvB;AACD;AACF;AACF;AACF,KArHsC,CAqHrC;;;AAGF,QAAIyF,SAASw+F,aAAb,EAA4B;AAC1B,WAAK5F,QAAL,GAAgB2D,UAAhB;AACD;;AAED,SAAK/oB,MAAL,GAAcxzE,MAAd,CA5HuC,CA4HjB;;AAEtB,SAAK05F,OAAL,GAAe,EAAf;AACA,SAAKvqB,WAAL,GAAmB,KAAKypB,QAAL,GAAgBsF,sBAAhB,GAAyCD,yBAA5D;AACA,WAAO,IAAP;AACD,GAjID;AAkIA;;;;;;;;AASAnE,YAAUiF,QAAV,GAAqB,UAAUliC,UAAV,EAAsBhgE,EAAtB,EAA0BC,OAA1B,EAAmCshG,aAAnC,EAAkD;AACrE;;AAEA,QAAI,OAAOvhC,UAAP,KAAsB,UAA1B,EAAsC;AACpCuhC,sBAAgBthG,OAAhB;AACAA,gBAAUD,EAAV;AACAA,WAAKggE,UAAL;AACAA,mBAAa,EAAb;AACD,KARoE,CAQnE;;;AAGF//D,cAAUA,WAAWshG,aAAX,IAA4B,IAAtC;AACA,QAAIjkG,SAAS,EAAb;AACA,SAAKmF,IAAL,CAAUu9D,UAAV,EAAsB,YAAY;AAChC1iE,aAAO4C,IAAP,CAAYF,MAAMA,GAAGS,KAAH,CAAS,IAAT,EAAeD,SAAf,CAAlB;AACD,KAFD,EAEGP,OAFH;AAGA,WAAO3C,MAAP;AACD,GAjBD,CA5g1B4B,CA6h1BzB;;;AAGH,WAAS6kG,wBAAT,CAAkChuB,QAAlC,EAA4CiuB,iBAA5C,EAA+D;AAC7D,QAAIC,gBAAgBluB,SAASnU,UAA7B;AACA,QAAIh0D,OAAO,IAAIwvF,IAAJ,CAAS5+F,IAAIylG,aAAJ,EAAmBluB,SAASe,gBAA5B,EAA8Cf,QAA9C,CAAT,EAAkEA,SAASzB,SAA3E,CAAX,CAF6D,CAEqC;;AAElG2oB,uBAAmBrvF,IAAnB,EAAyBmoE,QAAzB;AACA,QAAIxqE,UAAUqC,KAAKgwF,QAAL,GAAgB,EAA9B;AACA,QAAIsG,kBAAkBnuB,SAAS6nB,QAA/B,CAN6D,CAMpB;;AAEzC,SAAK,IAAIt+F,IAAI,CAAb,EAAgBA,IAAI2kG,cAAczkG,MAAlC,EAA0CF,GAA1C,EAA+C;AAC7C,UAAIglE,MAAM2/B,cAAc3kG,CAAd,CAAV;;AAEA,UAAI4kG,gBAAgB5/B,GAAhB,CAAJ,EAA0B;AACxB;AACA;AACA,YAAIzjE,QAAQmjG,iBAAR,EAA2B1/B,GAA3B,KAAmC,CAAvC,EAA0C;AACxC/4D,kBAAQ+4D,GAAR,IAAe6/B,cAAcD,gBAAgB5/B,GAAhB,CAAd,CAAf;AACA12D,eAAK4wF,UAAL,CAAgBl6B,GAAhB,IAAuB67B,kBAAvB;AACAvyF,eAAK6wF,OAAL,CAAan6B,GAAb,IAAoB,IAApB;AACD,SAJD,MAIO;AACL;AACA/4D,kBAAQ+4D,GAAR,IAAe4/B,gBAAgB5/B,GAAhB,CAAf;AACD;AACF;AACF;;AAED,WAAO12D,IAAP;AACD;;AAED,WAASu2F,aAAT,CAAuBC,gBAAvB,EAAyC;AACvC,QAAIC,cAAc,IAAIrmG,KAAJ,CAAUomG,iBAAiB5kG,MAA3B,CAAlB;;AAEA,SAAK,IAAI0d,IAAI,CAAb,EAAgBA,IAAIknF,iBAAiB5kG,MAArC,EAA6C0d,GAA7C,EAAkD;AAChDmnF,kBAAYnnF,CAAZ,IAAiB2/E,WAAWuH,iBAAiBlnF,CAAjB,CAAX,CAAjB;AACD;;AAED,WAAOmnF,WAAP;AACD;;AAED,WAASlE,gBAAT,GAA4B;AAC1B,WAAO,CAAC/oD,QAAD,EAAW,CAACA,QAAZ,CAAP;AACD;AACD;;;;;;;;AASAynD,YAAUrgG,GAAV,GAAgB,UAAUojE,UAAV,EAAsBhgE,EAAtB,EAA0BC,OAA1B,EAAmCshG,aAAnC,EAAkD;AAChE,iBADgE,CAClD;;AAEdthG,cAAUA,WAAWshG,aAAX,IAA4B,IAAtC;AACAvhC,iBAAapjE,IAAI0kG,oBAAoBthC,UAApB,CAAJ,EAAqC,KAAKk9B,YAA1C,EAAwD,IAAxD,CAAb;AACA,QAAIlxF,OAAOm2F,yBAAyB,IAAzB,EAA+BniC,UAA/B,CAAX,CALgE,CAKT;AACvD;;AAEAh0D,SAAK+vF,QAAL,GAAgB,KAAKA,QAArB;AACA/vF,SAAKsmE,WAAL,GAAmBtmE,KAAK+vF,QAAL,GAAgBsF,sBAAhB,GAAyCD,yBAA5D;AACA,QAAIz3F,UAAUqC,KAAKgwF,QAAnB;AACA,QAAI0G,cAAc,EAAlB;AACA,QAAI5E,YAAY,KAAKpB,UAArB;AACA,QAAI9pB,UAAU5S,WAAWpiE,MAAzB;AACA,QAAI+kG,YAAY,KAAKphF,KAAL,EAAhB;AACA,QAAIngB,SAAS,EAAb;AACA,QAAI88F,YAAYlyF,KAAK4wF,UAArB;;AAEA,SAAK,IAAI1uD,YAAY,CAArB,EAAwBA,YAAYy0D,SAApC,EAA+Cz0D,WAA/C,EAA4D;AAC1D,WAAK,IAAIg2B,WAAW,CAApB,EAAuBA,WAAW0O,OAAlC,EAA2C1O,UAA3C,EAAuD;AACrD9iE,eAAO8iE,QAAP,IAAmB,KAAKthE,GAAL,CAASo9D,WAAWkE,QAAX,CAAT,EAA+Bh2B;AAClD;AADmB,SAAnB;AAGD;;AAED9sC,aAAOwxE,OAAP,IAAkB1kC,SAAlB;AACA,UAAI00D,WAAW5iG,MAAMA,GAAGS,KAAH,CAASR,OAAT,EAAkBmB,MAAlB,CAArB;;AAEA,UAAIwhG,YAAY,IAAhB,EAAsB;AACpB;AACA,YAAI,QAAOA,QAAP,yCAAOA,QAAP,OAAoB,QAAxB,EAAkC;AAChCF,sBAAY,CAAZ,IAAiBE,QAAjB;AACAA,qBAAWF,WAAX;AACD;;AAED,YAAInD,WAAW,KAAKjtB,WAAL,CAAiBpkC,SAAjB,CAAf;AACA,YAAI4wD,aAAat6F,KAAKuV,KAAL,CAAWwlF,WAAWzB,SAAtB,CAAjB;AACA,YAAIiB,cAAcQ,WAAWzB,SAA7B;;AAEA,aAAK,IAAIpgG,IAAI,CAAb,EAAgBA,IAAIklG,SAAShlG,MAA7B,EAAqCF,GAArC,EAA0C;AACxC,cAAIglE,MAAM1C,WAAWtiE,CAAX,CAAV;AACA,cAAIkE,MAAMghG,SAASllG,CAAT,CAAV;AACA,cAAImlG,iBAAiB3E,UAAUx7B,GAAV,CAArB;AACA,cAAIq9B,WAAWp2F,QAAQ+4D,GAAR,CAAf;;AAEA,cAAIq9B,QAAJ,EAAc;AACZA,qBAASjB,UAAT,EAAqBC,WAArB,IAAoCn9F,GAApC;AACD;;AAED,cAAIA,MAAMihG,eAAe,CAAf,CAAV,EAA6B;AAC3BA,2BAAe,CAAf,IAAoBjhG,GAApB;AACD;;AAED,cAAIA,MAAMihG,eAAe,CAAf,CAAV,EAA6B;AAC3BA,2BAAe,CAAf,IAAoBjhG,GAApB;AACD;AACF;AACF;AACF;;AAED,WAAOoK,IAAP;AACD,GA7DD;AA8DA;;;;;;;;AASAixF,YAAU6F,UAAV,GAAuB,UAAUC,SAAV,EAAqB3iB,IAArB,EAA2B4iB,WAA3B,EAAwCC,WAAxC,EAAqD;AAC1E,QAAIj3F,OAAOm2F,yBAAyB,IAAzB,EAA+B,CAACY,SAAD,CAA/B,CAAX;AACA,QAAIG,gBAAgBl3F,KAAKgwF,QAAzB;AACA,QAAImH,cAAc,EAAlB;AACA,QAAIC,YAAY5+F,KAAKuV,KAAL,CAAW,IAAIqmE,IAAf,CAAhB;AACA,QAAI2f,WAAWmD,cAAcH,SAAd,CAAf;AACA,QAAIplG,MAAM,KAAK4jB,KAAL,EAAV;AACA,QAAIu8E,YAAY,KAAKpB,UAArB;AACA,QAAImG,iBAAiB72F,KAAK4wF,UAAL,CAAgBmG,SAAhB,CAArB;AACA,QAAIrD,aAAa,KAAK3E,eAAe,IAAf,CAAL,EAA2Bp9F,GAA3B,CAAjB;AACA,QAAIwF,SAAS,CAAb;;AAEA,SAAK,IAAIzF,IAAI,CAAb,EAAgBA,IAAIC,GAApB,EAAyBD,KAAK0lG,SAA9B,EAAyC;AACvC;AACA,UAAIA,YAAYzlG,MAAMD,CAAtB,EAAyB;AACvB0lG,oBAAYzlG,MAAMD,CAAlB;AACAylG,oBAAYvlG,MAAZ,GAAqBwlG,SAArB;AACD;;AAED,WAAK,IAAI1yF,IAAI,CAAb,EAAgBA,IAAI0yF,SAApB,EAA+B1yF,GAA/B,EAAoC;AAClC,YAAIquE,UAAU,KAAKzM,WAAL,CAAiB50E,IAAIgT,CAArB,CAAd;AACA,YAAI2yF,qBAAqB7+F,KAAKuV,KAAL,CAAWglE,UAAU+e,SAArB,CAAzB;AACA,YAAIwF,sBAAsBvkB,UAAU+e,SAApC;AACAqF,oBAAYzyF,CAAZ,IAAiBqvF,SAASsD,kBAAT,EAA6BC,mBAA7B,CAAjB;AACD;;AAED,UAAInkG,QAAQ6jG,YAAYG,WAAZ,CAAZ;AACA,UAAII,iBAAiB,KAAKjxB,WAAL,CAAiB9tE,KAAKoB,GAAL,CAASlI,IAAIulG,YAAYE,WAAZ,EAAyBhkG,KAAzB,CAAJ,IAAuC,CAAhD,EAAmDxB,MAAM,CAAzD,CAAjB,CAArB;AACA,UAAI6lG,mBAAmBh/F,KAAKuV,KAAL,CAAWwpF,iBAAiBzF,SAA5B,CAAvB;AACA,UAAI2F,oBAAoBF,iBAAiBzF,SAAzC,CAjBuC,CAiBa;;AAEpDiC,eAASyD,gBAAT,EAA2BC,iBAA3B,IAAgDtkG,KAAhD;;AAEA,UAAIA,QAAQ0jG,eAAe,CAAf,CAAZ,EAA+B;AAC7BA,uBAAe,CAAf,IAAoB1jG,KAApB;AACD;;AAED,UAAIA,QAAQ0jG,eAAe,CAAf,CAAZ,EAA+B;AAC7BA,uBAAe,CAAf,IAAoB1jG,KAApB;AACD;;AAEDugG,iBAAWv8F,QAAX,IAAuBogG,cAAvB;AACD;;AAEDv3F,SAAK2qE,MAAL,GAAcxzE,MAAd;AACA6I,SAAK+vF,QAAL,GAAgB2D,UAAhB;AACA1zF,SAAKsmE,WAAL,GAAmB+uB,sBAAnB;AACA,WAAOr1F,IAAP;AACD,GAhDD;AAiDA;;;;;AAKA;;;AAGAixF,YAAU/mB,YAAV,GAAyB,UAAUvxD,GAAV,EAAe;AACtC,QAAI+tD,YAAY,KAAKA,SAArB;AACA,WAAO,IAAIviB,KAAJ,CAAU,KAAK6kB,cAAL,CAAoBrwD,GAApB,CAAV,EAAoC+tD,SAApC,EAA+CA,aAAaA,UAAUhkC,OAAtE,CAAP;AACD,GAHD;AAIA;;;;;;AAOAuuD,YAAUjlD,IAAV,GAAiB,UAAU0rD,SAAV,EAAqB;AACpC,QAAIC,WAAW,IAAf;AACA,WAAO,IAAI/L,UAAJ,CAAe8L,YAAYA,UAAUjE,UAAV,EAAZ,GAAqC,EAApD,EAAwD,KAAKA,UAAL,EAAxD,EAA2E,UAAU96E,GAAV,EAAe;AAC/F,aAAO6mB,MAAMk4D,SAAN,EAAiB/+E,GAAjB,CAAP;AACD,KAFM,EAEJ,UAAUA,GAAV,EAAe;AAChB,aAAO6mB,MAAMm4D,QAAN,EAAgBh/E,GAAhB,CAAP;AACD,KAJM,CAAP;AAKD,GAPD;AAQA;;;;;AAMAs4E,YAAU/M,SAAV,GAAsB,UAAUjyF,GAAV,EAAe;AACnC,QAAI2lG,SAAS,KAAKxH,OAAlB;AACA,WAAOwH,UAAUA,OAAO3lG,GAAP,CAAjB;AACD,GAHD;AAIA;;;;;;;;;;;;AAaAg/F,YAAUpc,SAAV,GAAsB,UAAU5iF,GAAV,EAAe2D,GAAf,EAAoB;AACxC,QAAIy4F,WAAWp8F,GAAX,CAAJ,EAAqB;AACnB,WAAK,IAAIhB,IAAT,IAAiBgB,GAAjB,EAAsB;AACpB,YAAIA,IAAIC,cAAJ,CAAmBjB,IAAnB,CAAJ,EAA8B;AAC5B,eAAK4jF,SAAL,CAAe5jF,IAAf,EAAqBgB,IAAIhB,IAAJ,CAArB;AACD;AACF;;AAED;AACD;;AAED,SAAKm/F,OAAL,GAAe,KAAKA,OAAL,IAAgB,EAA/B;AACA,SAAKA,OAAL,CAAan+F,GAAb,IAAoB2D,GAApB;AACD,GAbD;AAcA;;;;;;AAOAq7F,YAAU4G,SAAV,GAAsB,UAAU5lG,GAAV,EAAe2D,GAAf,EAAoB;AACxC,QAAIy4F,WAAWp8F,GAAX,CAAJ,EAAqB;AACnB,WAAK,IAAIhB,IAAT,IAAiBgB,GAAjB,EAAsB;AACpB,YAAIA,IAAIC,cAAJ,CAAmBjB,IAAnB,CAAJ,EAA8B;AAC5B,eAAK4mG,SAAL,CAAe5mG,IAAf,EAAqBgB,IAAIhB,IAAJ,CAArB;AACD;AACF;;AAED;AACD;;AAED,SAAKo/F,OAAL,CAAap+F,GAAb,IAAoB2D,GAApB;AACD,GAZD;AAaA;;;;;;AAOAq7F,YAAU6G,SAAV,GAAsB,UAAU7lG,GAAV,EAAe;AACnC,WAAO,KAAKo+F,OAAL,CAAap+F,GAAb,CAAP;AACD,GAFD;AAGA;;;;;AAMAg/F,YAAU8G,aAAV,GAA0B,UAAUp/E,GAAV,EAAe;AACvC,WAAO,KAAK63E,YAAL,CAAkB73E,GAAlB,CAAP;AACD,GAFD;AAGA;;;;;;;AAQAs4E,YAAU+G,aAAV,GAA0B,UAAUr/E,GAAV,EAAe2iC,MAAf,EAAuBmT,QAAvB,EAAiC;AACzD,SAAK+hC,YAAL,CAAkB73E,GAAlB,IAAyB81C,WAAW57D,OAAO,KAAK29F,YAAL,CAAkB73E,GAAlB,KAA0B,EAAjC,EAAqC2iC,MAArC,CAAX,GAA0DA,MAAnF;AACD,GAFD;AAGA;;;;AAKA21C,YAAUgH,gBAAV,GAA6B,YAAY;AACvC,SAAKzH,YAAL,CAAkB5+F,MAAlB,GAA2B,CAA3B;AACD,GAFD;AAGA;;;;;;;AAQAq/F,YAAUrnB,aAAV,GAA0B,UAAUjxD,GAAV,EAAe1mB,GAAf,EAAoBoyD,YAApB,EAAkC;AAC1D,QAAI6zC,aAAa,KAAK5H,YAAL,CAAkB33E,GAAlB,CAAjB;AACA,QAAI/iB,MAAMsiG,cAAcA,WAAWjmG,GAAX,CAAxB;;AAEA,QAAI2D,OAAO,IAAP,IAAe,CAACyuD,YAApB,EAAkC;AAChC;AACA,aAAO,KAAK6/B,SAAL,CAAejyF,GAAf,CAAP;AACD;;AAED,WAAO2D,GAAP;AACD,GAVD;AAWA;;;;;;;;;;;;;;AAeAq7F,YAAUnc,aAAV,GAA0B,UAAUn8D,GAAV,EAAe1mB,GAAf,EAAoBkB,KAApB,EAA2B;AACnD,QAAI+kG,aAAa,KAAK5H,YAAL,CAAkB33E,GAAlB,KAA0B,EAA3C;AACA,QAAI43E,gBAAgB,KAAKA,aAAzB;AACA,SAAKD,YAAL,CAAkB33E,GAAlB,IAAyBu/E,UAAzB;;AAEA,QAAI7J,WAAWp8F,GAAX,CAAJ,EAAqB;AACnB,WAAK,IAAIhB,IAAT,IAAiBgB,GAAjB,EAAsB;AACpB,YAAIA,IAAIC,cAAJ,CAAmBjB,IAAnB,CAAJ,EAA8B;AAC5BinG,qBAAWjnG,IAAX,IAAmBgB,IAAIhB,IAAJ,CAAnB;AACAs/F,wBAAct/F,IAAd,IAAsB,IAAtB;AACD;AACF;;AAED;AACD;;AAEDinG,eAAWjmG,GAAX,IAAkBkB,KAAlB;AACAo9F,kBAAct+F,GAAd,IAAqB,IAArB;AACD,GAlBD;AAmBA;;;;AAKAg/F,YAAUpU,cAAV,GAA2B,YAAY;AACrC,SAAKuT,OAAL,GAAe,EAAf;AACA,SAAKE,YAAL,GAAoB,EAApB;AACA,SAAKC,aAAL,GAAqB,EAArB;AACD,GAJD;;AAMA,MAAI4H,4BAA4B,SAA5BA,yBAA4B,CAAUr/E,KAAV,EAAiB;AAC/CA,UAAM+iD,WAAN,GAAoB,KAAKA,WAAzB;AACA/iD,UAAMopB,SAAN,GAAkB,KAAKA,SAAvB;AACAppB,UAAMwwD,QAAN,GAAiB,KAAKA,QAAtB;AACD,GAJD;AAKA;;;;;;AAOA2nB,YAAUmH,gBAAV,GAA6B,UAAUz/E,GAAV,EAAenZ,EAAf,EAAmB;AAC9C,QAAIknE,YAAY,KAAKA,SAArB;;AAEA,QAAIlnE,EAAJ,EAAQ;AACN;AACA;AACAA,SAAG0iC,SAAH,GAAevpB,GAAf;AACAnZ,SAAG8pE,QAAH,GAAc,KAAKA,QAAnB;AACA9pE,SAAGq8D,WAAH,GAAiB6K,aAAaA,UAAU7K,WAAxC;;AAEA,UAAIr8D,GAAG1K,IAAH,KAAY,OAAhB,EAAyB;AACvB0K,WAAGwW,QAAH,CAAYmiF,yBAAZ,EAAuC34F,EAAvC;AACD;AACF;;AAED,SAAKixF,WAAL,CAAiB93E,GAAjB,IAAwBnZ,EAAxB;AACD,GAhBD;AAiBA;;;;;AAMAyxF,YAAUje,gBAAV,GAA6B,UAAUr6D,GAAV,EAAe;AAC1C,WAAO,KAAK83E,WAAL,CAAiB93E,GAAjB,CAAP;AACD,GAFD;AAGA;;;;;AAMAs4E,YAAUhe,iBAAV,GAA8B,UAAUj/E,EAAV,EAAcC,OAAd,EAAuB;AACnDH,WAAO,KAAK28F,WAAZ,EAAyB,UAAUjxF,EAAV,EAAcmZ,GAAd,EAAmB;AAC1C,UAAInZ,EAAJ,EAAQ;AACNxL,cAAMA,GAAGxC,IAAH,CAAQyC,OAAR,EAAiBuL,EAAjB,EAAqBmZ,GAArB,CAAN;AACD;AACF,KAJD;AAKD,GAND;AAOA;;;;;AAMAs4E,YAAUrgB,YAAV,GAAyB,UAAU5wE,IAAV,EAAgB;AACvC,QAAI,CAACA,IAAL,EAAW;AACT,UAAIq4F,oBAAoBznG,IAAI,KAAKojE,UAAT,EAAqB,KAAKkV,gBAA1B,EAA4C,IAA5C,CAAxB;AACAlpE,aAAO,IAAIwvF,IAAJ,CAAS6I,iBAAT,EAA4B,KAAK3xB,SAAjC,CAAP;AACD,KAJsC,CAIrC;;;AAGF1mE,SAAKgwF,QAAL,GAAgB,KAAKA,QAArB;AACAX,uBAAmBrvF,IAAnB,EAAyB,IAAzB,EARuC,CAQP;;AAEhC,QAAI,KAAK+vF,QAAT,EAAmB;AACjB,UAAIl+F,OAAO,KAAKk+F,QAAL,CAAcj+F,WAAzB;AACAkO,WAAK+vF,QAAL,GAAgB,IAAIl+F,IAAJ,CAAS,KAAKk+F,QAAd,CAAhB;AACD,KAHD,MAGO;AACL/vF,WAAK+vF,QAAL,GAAgB,IAAhB;AACD;;AAED/vF,SAAKsmE,WAAL,GAAmBtmE,KAAK+vF,QAAL,GAAgBsF,sBAAhB,GAAyCD,yBAA5D;AACA,WAAOp1F,IAAP;AACD,GAnBD;AAoBA;;;;;;AAOAixF,YAAUlgB,UAAV,GAAuB,UAAUtsC,UAAV,EAAsB6zD,cAAtB,EAAsC;AAC3D,QAAIC,iBAAiB,KAAK9zD,UAAL,CAArB;;AAEA,QAAI,OAAO8zD,cAAP,KAA0B,UAA9B,EAA0C;AACxC;AACD;;AAED,SAAKjJ,gBAAL,GAAwB,KAAKA,gBAAL,IAAyB,EAAjD;;AAEA,SAAKA,gBAAL,CAAsBp7F,IAAtB,CAA2BuwC,UAA3B;;AAEA,SAAKA,UAAL,IAAmB,YAAY;AAC7B,UAAIxV,MAAMspE,eAAe9jG,KAAf,CAAqB,IAArB,EAA2BD,SAA3B,CAAV;AACA,aAAO8jG,eAAe7jG,KAAf,CAAqB,IAArB,EAA2B,CAACw6B,GAAD,EAAMv6B,MAAN,CAAahE,MAAM8D,SAAN,CAAb,CAA3B,CAAP;AACD,KAHD;AAID,GAfD,CAx91B4B,CAu+1BzB;AACH;;;AAGAy8F,YAAUuH,oBAAV,GAAiC,CAAC,cAAD,EAAiB,YAAjB,EAA+B,KAA/B,CAAjC,CA3+1B4B,CA2+1B4C;;AAExEvH,YAAUngB,iBAAV,GAA8B,CAAC,YAAD,EAAe,aAAf,CAA9B;;AAEA;;;;;;;;;;;;;;;;;;;AAmBA;;;;AAIA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgDA,WAAS2nB,kBAAT,CAA4BC,OAA5B,EAAqCrnG,MAArC,EAA6CkvC,GAA7C,EAAkD;AAChD,QAAI,CAACs0B,OAAOrwB,UAAP,CAAkBnzC,MAAlB,CAAL,EAAgC;AAC9BA,eAASwjE,OAAOQ,kBAAP,CAA0BhkE,MAA1B,CAAT;AACD;;AAEDkvC,UAAMA,OAAO,EAAb;AACAm4D,cAAU,CAACA,WAAW,EAAZ,EAAgBhoG,KAAhB,EAAV;AACA,QAAIioG,UAAU,CAACp4D,IAAIo4D,OAAJ,IAAe,EAAhB,EAAoBjoG,KAApB,EAAd;AACA,QAAIkoG,YAAY9hG,cAAcypC,IAAIq4D,SAAlB,CAAhB;AACA,QAAIC,iBAAiB/hG,eAArB;AACA,QAAIgiG,kBAAkBhiG,eAAtB,CAVgD,CAUT;;AAEvC,QAAIxF,SAAS,EAAb;AACA,QAAIynG,WAAWC,YAAY3nG,MAAZ,EAAoBqnG,OAApB,EAA6BC,OAA7B,EAAsCp4D,IAAIw4D,QAA1C,CAAf,CAbgD,CAaoB;;AAEpE,SAAK,IAAIrnG,IAAI,CAAb,EAAgBA,IAAIqnG,QAApB,EAA8BrnG,GAA9B,EAAmC;AACjC,UAAIunG,aAAaN,QAAQjnG,CAAR,IAAamB,OAAO,EAAP,EAAWP,WAAWqmG,QAAQjnG,CAAR,CAAX,IAAyBinG,QAAQjnG,CAAR,CAAzB,GAAsC;AAC7ET,cAAM0nG,QAAQjnG,CAAR;AADuE,OAAjD,CAA9B;AAGA,UAAIwnG,cAAcD,WAAWhoG,IAA7B;AACA,UAAIgpE,aAAa3oE,OAAOI,CAAP,IAAY;AAC3B89E,mBAAW;AADgB,OAA7B,CALiC,CAO9B;;AAEH,UAAI0pB,eAAe,IAAf,IAAuBL,eAAejiG,GAAf,CAAmBsiG,WAAnB,KAAmC,IAA9D,EAAoE;AAClE;AACA;AACA;AACAj/B,mBAAWhpE,IAAX,GAAkBgpE,WAAWrD,WAAX,GAAyBsiC,WAA3C;AACAL,uBAAeliG,GAAf,CAAmBuiG,WAAnB,EAAgCxnG,CAAhC;AACD;;AAEDunG,iBAAWnkG,IAAX,IAAmB,IAAnB,KAA4BmlE,WAAWnlE,IAAX,GAAkBmkG,WAAWnkG,IAAzD;AACAmkG,iBAAWriC,WAAX,IAA0B,IAA1B,KAAmCqD,WAAWrD,WAAX,GAAyBqiC,WAAWriC,WAAvE;AACD,KAlC+C,CAkC9C;;;AAGFgiC,cAAUniG,IAAV,CAAe,UAAUi6E,QAAV,EAAoBlZ,QAApB,EAA8B;AAC3CkZ,iBAAWrwC,iBAAiBqwC,QAAjB,EAA2BhgF,KAA3B,EAAX;AACA,UAAIyoG,gBAAgBP,UAAUjiG,GAAV,CAAc6gE,QAAd,EAAwB,EAAxB,CAApB;AACA1jE,aAAO48E,QAAP,EAAiB,UAAU0oB,YAAV,EAAwBzgF,GAAxB,EAA6B;AAC5C;AACA9jB,iBAASukG,YAAT,MAA2BA,eAAeP,eAAejiG,GAAf,CAAmBwiG,YAAnB,CAA1C;;AAEA,YAAIA,gBAAgB,IAAhB,IAAwBA,eAAeL,QAA3C,EAAqD;AACnDI,wBAAcxgF,GAAd,IAAqBygF,YAArB;AACAC,mBAAS/nG,OAAO8nG,YAAP,CAAT,EAA+B5hC,QAA/B,EAAyC7+C,GAAzC;AACD;AACF,OARD;AASD,KAZD,EArCgD,CAiD5C;;AAEJ,QAAI2gF,cAAc,CAAlB;AACAxlG,WAAO4kG,OAAP,EAAgB,UAAUa,UAAV,EAAsBC,WAAtB,EAAmC;AACjD,UAAIhiC,QAAJ;AACA,UAAI+hC,UAAJ;AACA,UAAIE,iBAAJ;AACA,UAAIC,mBAAJ;;AAEA,UAAI7kG,SAAS0kG,UAAT,CAAJ,EAA0B;AACxB/hC,mBAAW+hC,UAAX;AACAA,qBAAa,EAAb;AACD,OAHD,MAGO;AACL/hC,mBAAW+hC,WAAWtoG,IAAtB;AACA,YAAI43E,cAAc0wB,WAAW1wB,WAA7B;AACA0wB,mBAAW1wB,WAAX,GAAyB,IAAzB;AACA0wB,qBAAanoG,OAAMmoG,UAAN,CAAb;AACAA,mBAAW1wB,WAAX,GAAyBA,WAAzB,CALK,CAKiC;;AAEtC4wB,4BAAoBF,WAAWZ,OAA/B;AACAe,8BAAsBH,WAAW/pB,SAAjC;AACA+pB,mBAAWtoG,IAAX,GAAkBsoG,WAAW/hC,QAAX,GAAsB+hC,WAAW/L,aAAX,GAA2B+L,WAAWZ,OAAX,GAAqBY,WAAW/pB,SAAX,GAAuB,IAA/G;AACD;;AAED,UAAIkB,WAAWrwC,iBAAiBu4D,UAAUhiG,GAAV,CAAc4gE,QAAd,CAAjB,CAAf,CArBiD,CAqBS;;AAE1D,UAAI,CAACkZ,SAAS9+E,MAAd,EAAsB;AACpB,aAAK,IAAIF,IAAI,CAAb,EAAgBA,KAAK+nG,qBAAqBA,kBAAkB7nG,MAAvC,IAAiD,CAAtD,CAAhB,EAA0EF,GAA1E,EAA+E;AAC7E,iBAAO4nG,cAAchoG,OAAOM,MAArB,IAA+BN,OAAOgoG,WAAP,EAAoB9hC,QAApB,IAAgC,IAAtE,EAA4E;AAC1E8hC;AACD;;AAEDA,wBAAchoG,OAAOM,MAArB,IAA+B8+E,SAASx8E,IAAT,CAAcolG,aAAd,CAA/B;AACD;AACF,OA/BgD,CA+B/C;;;AAGFxlG,aAAO48E,QAAP,EAAiB,UAAU0oB,YAAV,EAAwB5L,aAAxB,EAAuC;AACtD,YAAIvzB,aAAa3oE,OAAO8nG,YAAP,CAAjB;AACAC,iBAASvmG,SAASmnE,UAAT,EAAqBs/B,UAArB,CAAT,EAA2C/hC,QAA3C,EAAqDg2B,aAArD;;AAEA,YAAIvzB,WAAWhpE,IAAX,IAAmB,IAAnB,IAA2BwoG,iBAA/B,EAAkD;AAChD,cAAIE,wBAAwBF,kBAAkBjM,aAAlB,CAA5B;AACA,WAACl7F,WAAWqnG,qBAAX,CAAD,KAAuCA,wBAAwB;AAC7D1oG,kBAAM0oG;AADuD,WAA/D;AAGA1/B,qBAAWhpE,IAAX,GAAkBgpE,WAAWrD,WAAX,GAAyB+iC,sBAAsB1oG,IAAjE;AACAgpE,qBAAW0zB,cAAX,GAA4BgM,sBAAsBhM,cAAlD;AACD,SAXqD,CAWpD;;;AAGF+L,+BAAuB5mG,SAASmnE,WAAWuV,SAApB,EAA+BkqB,mBAA/B,CAAvB;AACD,OAfD;AAgBD,KAlDD;;AAoDA,aAASL,QAAT,CAAkBp/B,UAAlB,EAA8BzC,QAA9B,EAAwCg2B,aAAxC,EAAuD;AACrD,UAAIP,iBAAiBr2F,GAAjB,CAAqB4gE,QAArB,KAAkC,IAAtC,EAA4C;AAC1CyC,mBAAWuV,SAAX,CAAqBhY,QAArB,IAAiCg2B,aAAjC;AACD,OAFD,MAEO;AACLvzB,mBAAWzC,QAAX,GAAsBA,QAAtB;AACAyC,mBAAWuzB,aAAX,GAA2BA,aAA3B;AACAsL,wBAAgBniG,GAAhB,CAAoB6gE,QAApB,EAA8B,IAA9B;AACD;AACF,KAhH+C,CAgH9C;;;AAGF,QAAIoiC,gBAAgBr5D,IAAIq5D,aAAxB;AACA,QAAIC,qBAAqBt5D,IAAIs5D,kBAA7B;AACA,QAAIC,WAAWD,sBAAsB,IAArC;AACAA,yBAAqBD,gBAAgBC,sBAAsB,CAAtC,GAA0C,CAA/D;AACA,QAAIE,QAAQH,iBAAiB,OAA7B,CAvHgD,CAuHV;;AAEtC,SAAK,IAAIR,eAAe,CAAxB,EAA2BA,eAAeL,QAA1C,EAAoDK,cAApD,EAAoE;AAClE,UAAIn/B,aAAa3oE,OAAO8nG,YAAP,IAAuB9nG,OAAO8nG,YAAP,KAAwB,EAAhE;AACA,UAAI5hC,WAAWyC,WAAWzC,QAA1B;;AAEA,UAAIA,YAAY,IAAhB,EAAsB;AACpByC,mBAAWzC,QAAX,GAAsBwiC,QAAQD,KAAR,EAAejB,eAAf,EAAgCgB,QAAhC,CAAtB;AACA7/B,mBAAWuzB,aAAX,GAA2B,CAA3B;;AAEA,YAAI,CAACoM,aAAD,IAAkBC,sBAAsB,CAA5C,EAA+C;AAC7C5/B,qBAAWwzB,YAAX,GAA0B,IAA1B;AACD;;AAEDoM;AACD;;AAED5/B,iBAAWhpE,IAAX,IAAmB,IAAnB,KAA4BgpE,WAAWhpE,IAAX,GAAkB+oG,QAAQ//B,WAAWzC,QAAnB,EAA6BqhC,cAA7B,CAA9C;;AAEA,UAAI5+B,WAAWnlE,IAAX,IAAmB,IAAnB,IAA2BmjE,aAAa5mE,MAAb,EAAqB+nG,YAArB,EAAmCn/B,WAAWhpE,IAA9C,CAA/B,EAAoF;AAClFgpE,mBAAWnlE,IAAX,GAAkB,SAAlB;AACD;AACF;;AAED,WAAOxD,MAAP;AACD,GAts2B2B,CAss2B1B;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,WAAS0nG,WAAT,CAAqB3nG,MAArB,EAA6BqnG,OAA7B,EAAsCC,OAAtC,EAA+CsB,WAA/C,EAA4D;AAC1D;AACA;AACA,QAAIlB,WAAWvgG,KAAKqB,GAAL,CAASxI,OAAO+jE,qBAAP,IAAgC,CAAzC,EAA4CsjC,QAAQ9mG,MAApD,EAA4D+mG,QAAQ/mG,MAApE,EAA4EqoG,eAAe,CAA3F,CAAf;AACAnmG,WAAO4kG,OAAP,EAAgB,UAAUa,UAAV,EAAsB;AACpC,UAAIE,oBAAoBF,WAAWZ,OAAnC;AACAc,4BAAsBV,WAAWvgG,KAAKqB,GAAL,CAASk/F,QAAT,EAAmBU,kBAAkB7nG,MAArC,CAAjC;AACD,KAHD;AAIA,WAAOmnG,QAAP;AACD;;AAED,WAASiB,OAAT,CAAiB/oG,IAAjB,EAAuBipG,MAAvB,EAA+BJ,QAA/B,EAAyC;AACvC,QAAIA,YAAYI,OAAOtjG,GAAP,CAAW3F,IAAX,KAAoB,IAApC,EAA0C;AACxC,UAAIS,IAAI,CAAR;;AAEA,aAAOwoG,OAAOtjG,GAAP,CAAW3F,OAAOS,CAAlB,KAAwB,IAA/B,EAAqC;AACnCA;AACD;;AAEDT,cAAQS,CAAR;AACD;;AAEDwoG,WAAOvjG,GAAP,CAAW1F,IAAX,EAAiB,IAAjB;AACA,WAAOA,IAAP;AACD;;AAED;;;;;;;;;;;;;;;;;;;AAmBA;;;;AAIA;;;;;;;;;;;;AAYA,MAAIkpG,mBAAmB,SAAnBA,gBAAmB,CAAU9oG,MAAV,EAAkBkvC,GAAlB,EAAuB;AAC5CA,UAAMA,OAAO,EAAb;AACA,WAAOk4D,mBAAmBl4D,IAAI65D,eAAJ,IAAuB,EAA1C,EAA8C/oG,MAA9C,EAAsD;AAC3DsnG,eAASp4D,IAAI00B,gBAAJ,IAAwB5jE,OAAO4jE,gBADmB;AAE3D2jC,iBAAWr4D,IAAI20B,YAAJ,IAAoB7jE,OAAO6jE,YAFqB;AAG3D6jC,gBAAUx4D,IAAI85D,eAH6C;AAI3DT,qBAAer5D,IAAIq5D,aAJwC;AAK3DC,0BAAoBt5D,IAAIs5D;AALmC,KAAtD,CAAP;AAOD,GATD;;AAWA;;;;;;;;;;;;;;;;;;AAkBA;;;;;;;;;;;;;;;;;;;;;AAqBA,WAASS,eAAT,CAAyB7nC,WAAzB,EAAsC4lC,iBAAtC,EAAyD93D,GAAzD,EAA8D;AAC5DA,UAAMA,OAAO,EAAb;AACA,QAAIg6D,UAAUh6D,IAAIg6D,OAAlB;AACA,QAAIC,wBAAwBj6D,IAAIi6D,qBAAhC,CAH4D,CAGL;;AAEvD,QAAIC,WAAW,CAAC,EAAEhoC,eAAeA,YAAY77D,GAAZ,CAAgB,OAAhB,CAAjB,CAAhB;AACA,QAAI8jG,gBAAJ;AACA,QAAIC,cAAJ;AACA,QAAIr1B,oBAAJ;AACA,QAAIE,oBAAJ;AACA1xE,WAAOukG,iBAAP,EAA0B,UAAUzI,aAAV,EAAyB3lE,KAAzB,EAAgC;AACxD,UAAIp1B,SAAS+6F,aAAT,CAAJ,EAA6B;AAC3ByI,0BAAkBpuE,KAAlB,IAA2B2lE,gBAAgB;AACzC3+F,gBAAM2+F;AADmC,SAA3C;AAGD;;AAED,UAAI6K,YAAY,CAAC7K,cAAcnC,YAA/B,EAA6C;AAC3C;AACA,YAAI,CAAC8M,OAAD,IAAY,CAACG,gBAAb,IAAiC9K,cAAc/mB,WAAnD,EAAgE;AAC9D6xB,6BAAmB9K,aAAnB;AACD,SAJ0C,CAIzC;;;AAGF,YAAI,CAAC+K,cAAD,IAAmB/K,cAAc96F,IAAd,KAAuB,SAA1C,IAAuD86F,cAAc96F,IAAd,KAAuB,MAA9E,KAAyF,CAAC0lG,qBAAD,IAA0BA,0BAA0B5K,cAAcp4B,QAA3J,CAAJ,EAA0K;AACxKmjC,2BAAiB/K,aAAjB;AACD;AACF;AACF,KAlBD;;AAoBA,QAAI+K,kBAAkB,CAACJ,OAAnB,IAA8B,CAACG,gBAAnC,EAAqD;AACnD;AACA;AACAH,gBAAU,IAAV;AACD,KAlC2D,CAkC1D;AACF;AACA;;;AAGA,QAAII,cAAJ,EAAoB;AAClB;AACAr1B,6BAAuB,mBAAvB;AACAE,6BAAuB,mBAAvB,CAHkB,CAG0B;;AAE5C,UAAIk1B,gBAAJ,EAAsB;AACpBA,yBAAiB5K,qBAAjB,GAAyC,IAAzC;AACD;;AAED,UAAI8K,qBAAqBD,eAAenjC,QAAxC;AACA,UAAIqjC,iBAAiBF,eAAe7lG,IAApC;AACA,UAAIgmG,uBAAuB,CAA3B;AACAhnG,aAAOukG,iBAAP,EAA0B,UAAUzI,aAAV,EAAyB;AACjD,YAAIA,cAAcp4B,QAAd,KAA2BojC,kBAA/B,EAAmD;AACjDE;AACD;AACF,OAJD;AAKAzC,wBAAkBnkG,IAAlB,CAAuB;AACrBjD,cAAMq0E,oBADe;AAErB9N,kBAAUojC,kBAFW;AAGrBpN,uBAAesN,oBAHM;AAIrBhmG,cAAM+lG,cAJe;AAKrBpN,sBAAc,IALO;AAMrBsN,4BAAoB;AANC,OAAvB;AAQAD;AACAzC,wBAAkBnkG,IAAlB,CAAuB;AACrBjD,cAAMu0E,oBADe;AAErB;AACA;AACAhO,kBAAUgO,oBAJW;AAKrBgoB,uBAAesN,oBALM;AAMrBhmG,cAAM+lG,cANe;AAOrBpN,sBAAc,IAPO;AAQrBsN,4BAAoB;AARC,OAAvB;AAUD;;AAED,WAAO;AACLt1B,wBAAkBk1B,kBAAkBA,eAAe1pG,IAD9C;AAELy0E,0BAAoBg1B,oBAAoBA,iBAAiBzpG,IAFpD;AAGL00E,wBAAkB40B,OAHb;AAIL/0B,4BAAsBA,oBAJjB;AAKLF,4BAAsBA;AALjB,KAAP;AAOD;AACD;;;;;AAKA,WAAS01B,kBAAT,CAA4BnnG,IAA5B,EAAkConG;AAClC;AADA,IAEE;AACA;AACA;AACA,WAAO,CAAC,CAACA,UAAF,IAAgBA,eAAepnG,KAAK0xE,kBAAL,CAAwB,kBAAxB,CAAtC,CAHA,CAGmF;AACnF;AACA;AACA;AACA;AACD;AACD;;;;;;;;AAQA,WAAS21B,mBAAT,CAA6BrnG,IAA7B,EAAmCsnG,SAAnC,EAA8C;AAC5C,WAAOH,mBAAmBnnG,IAAnB,EAAyBsnG,SAAzB,IAAsCtnG,KAAK0xE,kBAAL,CAAwB,sBAAxB,CAAtC,GAAwF41B,SAA/F;AACD;;AAED;;;;;;;;;;;;;;;;;;AAkBA;;;;;;;AAOA,WAASC,mBAAT,CAA6B/pG,MAA7B,EAAqCohE,WAArC,EAAkDlyB,GAAlD,EAAuD;AACrDA,UAAMA,OAAO,EAAb;;AAEA,QAAI,CAACs0B,OAAOrwB,UAAP,CAAkBnzC,MAAlB,CAAL,EAAgC;AAC9BA,eAASwjE,OAAOQ,kBAAP,CAA0BhkE,MAA1B,CAAT;AACD;;AAED,QAAIqhE,eAAeD,YAAY77D,GAAZ,CAAgB,kBAAhB,CAAnB;AACA,QAAIykG,qBAAqB79B,wBAAwB5mE,GAAxB,CAA4B87D,YAA5B,CAAzB;AACA,QAAIqE,iBAAiBvE,0BAA0BC,WAA1B,CAArB;AACA,QAAI6oC,eAAJ;;AAEA,QAAIvkC,cAAJ,EAAoB;AAClBukC,wBAAkB1qG,IAAImmE,eAAepE,YAAnB,EAAiC,UAAU+D,GAAV,EAAe;AAChE,YAAIiS,UAAU;AACZ13E,gBAAMylE;AADM,SAAd;AAGA,YAAIvC,YAAY4C,eAAenE,OAAf,CAAuBh8D,GAAvB,CAA2B8/D,GAA3B,CAAhB;;AAEA,YAAIvC,SAAJ,EAAe;AACb,cAAIi6B,WAAWj6B,UAAUv9D,GAAV,CAAc,MAAd,CAAf;AACA+xE,kBAAQ7zE,IAAR,GAAeq5F,uBAAuBC,QAAvB,CAAf,CAFa,CAEoC;AAClD;;AAED,eAAOzlB,OAAP;AACD,OAZiB,CAAlB;AAaD;;AAED,QAAI,CAAC2yB,eAAL,EAAsB;AACpB;AACAA,wBAAkBD,uBAAuBA,mBAAmBlR,iBAAnB,GAAuCkR,mBAAmBlR,iBAAnB,EAAvC,GAAgFkR,mBAAmBrnC,UAAnB,CAA8BtjE,KAA9B,EAAvG,KAAiJ,CAAC,GAAD,EAAM,GAAN,CAAnK;AACD;;AAED,QAAI6qG,cAAcpB,iBAAiB9oG,MAAjB,EAAyB;AACzC+oG,uBAAiBkB,eADwB;AAEzC1B,qBAAer5D,IAAIq5D;AAFsB,KAAzB,CAAlB;AAIA,QAAIxmC,qBAAJ;AACA,QAAIooC,aAAJ;AACAzkC,sBAAkBjjE,OAAOynG,WAAP,EAAoB,UAAU5yB,OAAV,EAAmBzQ,QAAnB,EAA6B;AACjE,UAAIV,WAAWmR,QAAQnR,QAAvB;AACA,UAAIikC,oBAAoB1kC,eAAelE,eAAf,CAA+Bj8D,GAA/B,CAAmC4gE,QAAnC,CAAxB;;AAEA,UAAIikC,iBAAJ,EAAuB;AACrB,YAAIroC,yBAAyB,IAA7B,EAAmC;AACjCA,kCAAwB8E,QAAxB;AACD;;AAEDyQ,gBAAQE,WAAR,GAAsB4yB,kBAAkBC,cAAlB,EAAtB;AACD;;AAED,UAAI/yB,QAAQ6G,SAAR,CAAkB3X,QAAlB,IAA8B,IAAlC,EAAwC;AACtC2jC,wBAAgB,IAAhB;AACD;AACF,KAfiB,CAAlB;;AAiBA,QAAI,CAACA,aAAD,IAAkBpoC,yBAAyB,IAA/C,EAAqD;AACnDmoC,kBAAYnoC,qBAAZ,EAAmCoc,SAAnC,CAA6C3X,QAA7C,GAAwD,CAAxD;AACD;;AAED,QAAI8jC,uBAAuBrB,gBAAgB7nC,WAAhB,EAA6B8oC,WAA7B,CAA3B;AACA,QAAIv7F,OAAO,IAAIwvF,IAAJ,CAAS+L,WAAT,EAAsB9oC,WAAtB,CAAX;AACAzyD,SAAK4lE,kBAAL,CAAwB+1B,oBAAxB;AACA,QAAIpK,iBAAiBn+B,yBAAyB,IAAzB,IAAiCwoC,0BAA0BvqG,MAA1B,CAAjC,GAAqE,UAAUs4E,OAAV,EAAmBxR,OAAnB,EAA4Bj2B,SAA5B,EAAuCg2B,QAAvC,EAAiD;AACzI;AACA,aAAOA,aAAa9E,qBAAb,GAAqClxB,SAArC,GAAiD,KAAKwvD,qBAAL,CAA2B/nB,OAA3B,EAAoCxR,OAApC,EAA6Cj2B,SAA7C,EAAwDg2B,QAAxD,CAAxD;AACD,KAHoB,GAGjB,IAHJ;AAIAl4D,SAAK0oE,aAAL,GAAqB,KAArB;AACA1oE,SAAKqxF,QAAL,CAAchgG,MAAd,EAAsB,IAAtB,EAA4BkgG,cAA5B;AACA,WAAOvxF,IAAP;AACD;;AAED,WAAS47F,yBAAT,CAAmCvqG,MAAnC,EAA2C;AACzC,QAAIA,OAAO0jE,YAAP,KAAwBV,sBAA5B,EAAoD;AAClD,UAAIwnC,aAAaC,iBAAiBzqG,OAAOwC,IAAP,IAAe,EAAhC,CAAjB;AACA,aAAOgoG,cAAc,IAAd,IAAsB,CAACppG,QAAQmuC,iBAAiBi7D,UAAjB,CAAR,CAA9B;AACD;AACF;;AAED,WAASC,gBAAT,CAA0BjoG,IAA1B,EAAgC;AAC9B,QAAInC,IAAI,CAAR;;AAEA,WAAOA,IAAImC,KAAKjC,MAAT,IAAmBiC,KAAKnC,CAAL,KAAW,IAArC,EAA2C;AACzCA;AACD;;AAED,WAAOmC,KAAKnC,CAAL,CAAP;AACD;;AAED;;;;;;;;;;;;;;;;;;;AAmBA;;;;AAIA;;;;AAIA,WAASqqG,KAAT,CAAeC,OAAf,EAAwB;AACtB,SAAKC,QAAL,GAAgBD,WAAW,EAA3B;AACA;;;;;;AAMA,SAAKnL,OAAL,GAAe,CAACrnD,QAAD,EAAW,CAACA,QAAZ,CAAf;AACA;;;;;;AAMA,SAAK0yD,SAAL,GAAiB,CAAjB;AACA,SAAKl8D,IAAL,IAAa,KAAKA,IAAL,CAAUvrC,KAAV,CAAgB,IAAhB,EAAsBD,SAAtB,CAAb;AACD;AACD;;;;;;AAOAunG,QAAM9rG,SAAN,CAAgBwb,KAAhB,GAAwB,UAAU7V,GAAV,EAAe;AACrC;AACA;AACA;AACA;AACA,WAAOA,GAAP;AACD,GAND;;AAQAmmG,QAAM9rG,SAAN,CAAgBksG,UAAhB,GAA6B,UAAUlrG,IAAV,EAAgB;AAC3C,WAAO,KAAKgrG,QAAL,CAAchrG,IAAd,CAAP;AACD,GAFD;;AAIA8qG,QAAM9rG,SAAN,CAAgB0Q,OAAhB,GAA0B,UAAU/K,GAAV,EAAe;AACvC,QAAI8+F,SAAS,KAAK7D,OAAlB;AACA,WAAOj7F,OAAO8+F,OAAO,CAAP,CAAP,IAAoB9+F,OAAO8+F,OAAO,CAAP,CAAlC;AACD,GAHD;AAIA;;;;;;AAOAqH,QAAM9rG,SAAN,CAAgBgJ,SAAhB,GAA4B,UAAUrD,GAAV,EAAe;AACzC,QAAI8+F,SAAS,KAAK7D,OAAlB;;AAEA,QAAI6D,OAAO,CAAP,MAAcA,OAAO,CAAP,CAAlB,EAA6B;AAC3B,aAAO,GAAP;AACD;;AAED,WAAO,CAAC9+F,MAAM8+F,OAAO,CAAP,CAAP,KAAqBA,OAAO,CAAP,IAAYA,OAAO,CAAP,CAAjC,CAAP;AACD,GARD;AASA;;;;;;AAOAqH,QAAM9rG,SAAN,CAAgB8I,KAAhB,GAAwB,UAAUnD,GAAV,EAAe;AACrC,QAAI8+F,SAAS,KAAK7D,OAAlB;AACA,WAAOj7F,OAAO8+F,OAAO,CAAP,IAAYA,OAAO,CAAP,CAAnB,IAAgCA,OAAO,CAAP,CAAvC;AACD,GAHD;AAIA;;;;;AAMAqH,QAAM9rG,SAAN,CAAgBmsG,WAAhB,GAA8B,UAAUllF,KAAV,EAAiB;AAC7C,QAAIw9E,SAAS,KAAK7D,OAAlB;AACA35E,UAAM,CAAN,IAAWw9E,OAAO,CAAP,CAAX,KAAyBA,OAAO,CAAP,IAAYx9E,MAAM,CAAN,CAArC;AACAA,UAAM,CAAN,IAAWw9E,OAAO,CAAP,CAAX,KAAyBA,OAAO,CAAP,IAAYx9E,MAAM,CAAN,CAArC,EAH6C,CAGG;AAChD;AACD,GALD;AAMA;;;;;;AAOA6kF,QAAM9rG,SAAN,CAAgBosG,mBAAhB,GAAsC,UAAUxoG,IAAV,EAAgB6iE,GAAhB,EAAqB;AACzD,SAAK0lC,WAAL,CAAiBvoG,KAAK2gG,oBAAL,CAA0B99B,GAA1B,CAAjB;AACD,GAFD;AAGA;;;;;AAMAqlC,QAAM9rG,SAAN,CAAgBqsG,SAAhB,GAA4B,YAAY;AACtC,WAAO,KAAKzL,OAAL,CAAangG,KAAb,EAAP;AACD,GAFD;AAGA;;;;;;AAOAqrG,QAAM9rG,SAAN,CAAgBssG,SAAhB,GAA4B,UAAUjqF,KAAV,EAAiBk4B,GAAjB,EAAsB;AAChD,QAAIgyD,aAAa,KAAK3L,OAAtB;;AAEA,QAAI,CAAChhF,MAAMyC,KAAN,CAAL,EAAmB;AACjBkqF,iBAAW,CAAX,IAAgBlqF,KAAhB;AACD;;AAED,QAAI,CAACzC,MAAM26B,GAAN,CAAL,EAAiB;AACfgyD,iBAAW,CAAX,IAAgBhyD,GAAhB;AACD;AACF,GAVD;AAWA;;;;;AAMAuxD,QAAM9rG,SAAN,CAAgBwsG,OAAhB,GAA0B,YAAY;AACpC,WAAO,KAAKC,QAAZ;AACD,GAFD;AAGA;;;;AAIAX,QAAM9rG,SAAN,CAAgB0sG,QAAhB,GAA2B,UAAUF,OAAV,EAAmB;AAC5C,SAAKC,QAAL,GAAgBD,OAAhB;AACD,GATD;AAUA;;;;;;AAMAV,QAAM9rG,SAAN,CAAgB2sG,QAAhB,GAA2B,IAA3B;AACAh5D,oBAAkBm4D,KAAlB;AACAr3D,wBAAsBq3D,KAAtB,EAA6B;AAC3Bp2D,wBAAoB;AADO,GAA7B;;AAIA;;;;;;;;;;;;;;;;;;AAkBA;;;;;;;;AAQA,WAASk3D,WAAT,CAAqBt8D,GAArB,EAA0B;AACxB;;;;AAIA,SAAKoiC,UAAL,GAAkBpiC,IAAIoiC,UAAJ,IAAkB,EAApC;AACA;;;;;AAKA,SAAKm6B,YAAL,GAAoBv8D,IAAIw8D,WAAxB;AACA;;;;;AAKA,SAAKC,cAAL,GAAsBz8D,IAAI08D,aAA1B;AACA;;;;;AAKA,SAAKrzF,IAAL;AACD;AACD;;;;;AAMAizF,cAAYK,iBAAZ,GAAgC,UAAU/oC,SAAV,EAAqB;AACnD,QAAI/yB,SAAS+yB,UAAU/yB,MAAvB;AACA,QAAIvtC,OAAOutC,OAAOvtC,IAAlB;AACA,QAAI8uE,aAAa9uE,QAAQjD,IAAIiD,IAAJ,EAAU61E,OAAV,CAAzB;AACA,WAAO,IAAImzB,WAAJ,CAAgB;AACrBl6B,kBAAYA,UADS;AAErBo6B,mBAAa,CAACp6B,UAFO;AAGrB;AACAs6B,qBAAe77D,OAAO+7D,YAAP,KAAwB;AAJlB,KAAhB,CAAP;AAMD,GAVD;;AAYA,MAAIC,UAAUP,YAAY5sG,SAA1B;AACA;;;;;AAKAmtG,UAAQC,UAAR,GAAqB,UAAUC,QAAV,EAAoB;AACvC,WAAOC,eAAe,IAAf,EAAqB3mG,GAArB,CAAyB0mG,QAAzB,CAAP;AACD,GAFD;AAGA;;;;;AAMAF,UAAQt0B,eAAR,GAA0B,UAAUw0B,QAAV,EAAoB;AAC5C,QAAIrzE,KAAJ;AACA,QAAI8yE,cAAc,KAAKD,YAAvB,CAF4C,CAEP;AACrC;AACA;AACA;AACA;;AAEA,QAAI,OAAOQ,QAAP,KAAoB,QAApB,IAAgC,CAACP,WAArC,EAAkD;AAChD,aAAOO,QAAP;AACD,KAV2C,CAU1C;AACF;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,QAAIP,eAAe,CAAC,KAAKC,cAAzB,EAAyC;AACvC/yE,cAAQ,KAAK04C,UAAL,CAAgB/wE,MAAxB;AACA,WAAK+wE,UAAL,CAAgB14C,KAAhB,IAAyBqzE,QAAzB;AACA,aAAOrzE,KAAP;AACD;;AAED,QAAIiwE,SAASqD,eAAe,IAAf,CAAb;AACAtzE,YAAQiwE,OAAOtjG,GAAP,CAAW0mG,QAAX,CAAR;;AAEA,QAAIrzE,SAAS,IAAb,EAAmB;AACjB,UAAI8yE,WAAJ,EAAiB;AACf9yE,gBAAQ,KAAK04C,UAAL,CAAgB/wE,MAAxB;AACA,aAAK+wE,UAAL,CAAgB14C,KAAhB,IAAyBqzE,QAAzB;AACApD,eAAOvjG,GAAP,CAAW2mG,QAAX,EAAqBrzE,KAArB;AACD,OAJD,MAIO;AACLA,gBAAQ29B,GAAR;AACD;AACF;;AAED,WAAO39B,KAAP;AACD,GAxCD,CApy3B4B,CA403BzB;;;AAGH,WAASszE,cAAT,CAAwB10B,WAAxB,EAAqC;AACnC,WAAOA,YAAYj/D,IAAZ,KAAqBi/D,YAAYj/D,IAAZ,GAAmB9S,cAAc+xE,YAAYlG,UAA1B,CAAxC,CAAP;AACD;;AAED,WAAS+G,OAAT,CAAiB31E,GAAjB,EAAsB;AACpB,QAAIzB,WAAWyB,GAAX,KAAmBA,IAAIZ,KAAJ,IAAa,IAApC,EAA0C;AACxC,aAAOY,IAAIZ,KAAX;AACD,KAFD,MAEO;AACL,aAAOY,MAAM,EAAb;AACD;AACF;;AAED;;;;;;;;;;;;;;;;;;;AAmBA;;;;;;AAMA;AACA,MAAIypG,aAAazB,MAAM9rG,SAAvB;AACA,MAAIwtG,eAAe1B,MAAMlpG,MAAN,CAAa;AAC9BiC,UAAM,SADwB;;AAG9B;;;AAGAkrC,UAAM,cAAU6oC,WAAV,EAAuB6rB,MAAvB,EAA+B;AACnC;AACA;AACA,UAAI,CAAC7rB,WAAD,IAAgBp2E,QAAQo2E,WAAR,CAApB,EAA0C;AACxCA,sBAAc,IAAIg0B,WAAJ,CAAgB;AAC5Bl6B,sBAAYkG;AADgB,SAAhB,CAAd;AAGD;;AAED,WAAK60B,YAAL,GAAoB70B,WAApB;AACA,WAAKgoB,OAAL,GAAe6D,UAAU,CAAC,CAAD,EAAI7rB,YAAYlG,UAAZ,CAAuB/wE,MAAvB,GAAgC,CAApC,CAAzB;AACD,KAjB6B;AAkB9B6Z,WAAO,eAAU7V,GAAV,EAAe;AACpB,aAAO,OAAOA,GAAP,KAAe,QAAf,GAA0B,KAAK8nG,YAAL,CAAkBL,UAAlB,CAA6BznG,GAA7B,CAA1B,CAA4D;AAA5D,QACL4C,KAAK6R,KAAL,CAAWzU,GAAX,CADF;AAED,KArB6B;AAsB9B+K,aAAS,iBAAUg9F,IAAV,EAAgB;AACvBA,aAAO,KAAKlyF,KAAL,CAAWkyF,IAAX,CAAP;AACA,aAAOH,WAAW78F,OAAX,CAAmBnP,IAAnB,CAAwB,IAAxB,EAA8BmsG,IAA9B,KAAuC,KAAKD,YAAL,CAAkB/6B,UAAlB,CAA6Bg7B,IAA7B,KAAsC,IAApF;AACD,KAzB6B;;AA2B9B;;;;;AAKA1kG,eAAW,mBAAUrD,GAAV,EAAe;AACxB,aAAO4nG,WAAWvkG,SAAX,CAAqBzH,IAArB,CAA0B,IAA1B,EAAgC,KAAKia,KAAL,CAAW7V,GAAX,CAAhC,CAAP;AACD,KAlC6B;AAmC9BmD,WAAO,eAAUnD,GAAV,EAAe;AACpB,aAAO4C,KAAK6R,KAAL,CAAWmzF,WAAWzkG,KAAX,CAAiBvH,IAAjB,CAAsB,IAAtB,EAA4BoE,GAA5B,CAAX,CAAP;AACD,KArC6B;;AAuC9B;;;AAGAgoG,cAAU,oBAAY;AACpB,UAAIC,QAAQ,EAAZ;AACA,UAAInJ,SAAS,KAAK7D,OAAlB;AACA,UAAI8M,OAAOjJ,OAAO,CAAP,CAAX;;AAEA,aAAOiJ,QAAQjJ,OAAO,CAAP,CAAf,EAA0B;AACxBmJ,cAAM3pG,IAAN,CAAWypG,IAAX;AACAA;AACD;;AAED,aAAOE,KAAP;AACD,KArD6B;;AAuD9B;;;;;AAKAjB,cAAU,kBAAU3iF,CAAV,EAAa;AACrB,UAAI,CAAC,KAAKwiF,OAAL,EAAL,EAAqB;AACnB;AACA,eAAO,KAAKiB,YAAL,CAAkB/6B,UAAlB,CAA6B1oD,CAA7B,CAAP;AACD;AACF,KAjE6B;;AAmE9B;;;AAGA1E,WAAO,iBAAY;AACjB,aAAO,KAAKs7E,OAAL,CAAa,CAAb,IAAkB,KAAKA,OAAL,CAAa,CAAb,CAAlB,GAAoC,CAA3C;AACD,KAxE6B;;AA0E9B;;;AAGAwL,yBAAqB,6BAAUxoG,IAAV,EAAgB6iE,GAAhB,EAAqB;AACxC,WAAK0lC,WAAL,CAAiBvoG,KAAK2gG,oBAAL,CAA0B99B,GAA1B,CAAjB;AACD,KA/E6B;AAgF9BglC,oBAAgB,0BAAY;AAC1B,aAAO,KAAKgC,YAAZ;AACD,KAlF6B;AAmF9BI,eAAW1mG,IAnFmB;AAoF9B2mG,gBAAY3mG;AApFkB,GAAb,CAAnB;AAsFA;;;;AAIAqmG,eAAa7lG,MAAb,GAAsB,YAAY;AAChC,WAAO,IAAI6lG,YAAJ,EAAP;AACD,GAFD;;AAIA;;;;;;;;;;;;;;;;;;;AAmBA;;;AAGA,MAAIO,gBAAgBn2C,OAApB;AACA;;;;;;;;;AASA,WAASo2C,sBAAT,CAAgCvJ,MAAhC,EAAwCwJ,WAAxC,EAAqDC,WAArD,EAAkEC,WAAlE,EAA+E;AAC7E,QAAI9sG,SAAS,EAAb;AACA,QAAI+sG,OAAO3J,OAAO,CAAP,IAAYA,OAAO,CAAP,CAAvB;AACA,QAAInrD,WAAWj4C,OAAOi4C,QAAP,GAAkB0gB,KAAKo0C,OAAOH,WAAZ,EAAyB,IAAzB,CAAjC;;AAEA,QAAIC,eAAe,IAAf,IAAuB50D,WAAW40D,WAAtC,EAAmD;AACjD50D,iBAAWj4C,OAAOi4C,QAAP,GAAkB40D,WAA7B;AACD;;AAED,QAAIC,eAAe,IAAf,IAAuB70D,WAAW60D,WAAtC,EAAmD;AACjD70D,iBAAWj4C,OAAOi4C,QAAP,GAAkB60D,WAA7B;AACD,KAX4E,CAW3E;;;AAGF,QAAIt2C,YAAYx2D,OAAOgtG,iBAAP,GAA2BC,qBAAqBh1D,QAArB,CAA3C,CAd6E,CAcF;;AAE3E,QAAIi1D,iBAAiBltG,OAAOktG,cAAP,GAAwB,CAACR,cAAcxlG,KAAKyV,IAAL,CAAUymF,OAAO,CAAP,IAAYnrD,QAAtB,IAAkCA,QAAhD,EAA0Due,SAA1D,CAAD,EAAuEk2C,cAAcxlG,KAAKuV,KAAL,CAAW2mF,OAAO,CAAP,IAAYnrD,QAAvB,IAAmCA,QAAjD,EAA2Due,SAA3D,CAAvE,CAA7C;AACA22C,cAAUD,cAAV,EAA0B9J,MAA1B;AACA,WAAOpjG,MAAP;AACD;AACD;;;;;AAKA,WAASitG,oBAAT,CAA8Bh1D,QAA9B,EAAwC;AACtC;AACA,WAAO2e,iBAAiB3e,QAAjB,IAA6B,CAApC;AACD;;AAED,WAASge,KAAT,CAAei3C,cAAf,EAA+B7lF,GAA/B,EAAoC+7E,MAApC,EAA4C;AAC1C8J,mBAAe7lF,GAAf,IAAsBngB,KAAKqB,GAAL,CAASrB,KAAKoB,GAAL,CAAS4kG,eAAe7lF,GAAf,CAAT,EAA8B+7E,OAAO,CAAP,CAA9B,CAAT,EAAmDA,OAAO,CAAP,CAAnD,CAAtB;AACD,GAph4B2B,CAoh4B1B;;;AAGF,WAAS+J,SAAT,CAAmBD,cAAnB,EAAmC9J,MAAnC,EAA2C;AACzC,KAACx4D,SAASsiE,eAAe,CAAf,CAAT,CAAD,KAAiCA,eAAe,CAAf,IAAoB9J,OAAO,CAAP,CAArD;AACA,KAACx4D,SAASsiE,eAAe,CAAf,CAAT,CAAD,KAAiCA,eAAe,CAAf,IAAoB9J,OAAO,CAAP,CAArD;AACAntC,UAAMi3C,cAAN,EAAsB,CAAtB,EAAyB9J,MAAzB;AACAntC,UAAMi3C,cAAN,EAAsB,CAAtB,EAAyB9J,MAAzB;;AAEA,QAAI8J,eAAe,CAAf,IAAoBA,eAAe,CAAf,CAAxB,EAA2C;AACzCA,qBAAe,CAAf,IAAoBA,eAAe,CAAf,CAApB;AACD;AACF;AACD,WAASE,qBAAT,CAA+Bn1D,QAA/B,EAAyCmrD,MAAzC,EAAiD8J,cAAjD,EAAiEF,iBAAjE,EAAoF;AAClF,QAAIT,QAAQ,EAAZ,CADkF,CAClE;;AAEhB,QAAI,CAACt0D,QAAL,EAAe;AACb,aAAOs0D,KAAP;AACD,KALiF,CAKhF;;;AAGF,QAAIc,YAAY,KAAhB;;AAEA,QAAIjK,OAAO,CAAP,IAAY8J,eAAe,CAAf,CAAhB,EAAmC;AACjCX,YAAM3pG,IAAN,CAAWwgG,OAAO,CAAP,CAAX;AACD;;AAED,QAAIkK,OAAOJ,eAAe,CAAf,CAAX;;AAEA,WAAOI,QAAQJ,eAAe,CAAf,CAAf,EAAkC;AAChCX,YAAM3pG,IAAN,CAAW0qG,IAAX,EADgC,CACd;;AAElBA,aAAOZ,cAAcY,OAAOr1D,QAArB,EAA+B+0D,iBAA/B,CAAP;;AAEA,UAAIM,SAASf,MAAMA,MAAMjsG,MAAN,GAAe,CAArB,CAAb,EAAsC;AACpC;AACA;AACA;AACD;;AAED,UAAIisG,MAAMjsG,MAAN,GAAe+sG,SAAnB,EAA8B;AAC5B,eAAO,EAAP;AACD;AACF,KA9BiF,CA8BhF;AACF;;;AAGA,QAAIjK,OAAO,CAAP,KAAamJ,MAAMjsG,MAAN,GAAeisG,MAAMA,MAAMjsG,MAAN,GAAe,CAArB,CAAf,GAAyC4sG,eAAe,CAAf,CAAtD,CAAJ,EAA8E;AAC5EX,YAAM3pG,IAAN,CAAWwgG,OAAO,CAAP,CAAX;AACD;;AAED,WAAOmJ,KAAP;AACD;;AAED;;;;;;;;;;;;;;;;;;;AAmBA;;;;AAIA,MAAIgB,cAAch3C,OAAlB;AACA;;;;;AAKA,MAAIi3C,gBAAgB/C,MAAMlpG,MAAN,CAAa;AAC/BiC,UAAM,UADyB;AAE/BonG,eAAW,CAFoB;AAG/B6C,wBAAoB,CAHW;AAI/BxC,eAAW,mBAAUjqF,KAAV,EAAiBk4B,GAAjB,EAAsB;AAC/B,UAAIgyD,aAAa,KAAK3L,OAAtB,CAD+B,CACA;;AAE/B,UAAI,CAAChhF,MAAMyC,KAAN,CAAL,EAAmB;AACjBkqF,mBAAW,CAAX,IAAgB7xF,WAAW2H,KAAX,CAAhB;AACD;;AAED,UAAI,CAACzC,MAAM26B,GAAN,CAAL,EAAiB;AACfgyD,mBAAW,CAAX,IAAgB7xF,WAAW6/B,GAAX,CAAhB;AACD;AACF,KAd8B;AAe/B4xD,iBAAa,qBAAUllF,KAAV,EAAiB;AAC5B,UAAIw9E,SAAS,KAAK7D,OAAlB;AACA35E,YAAM,CAAN,IAAWw9E,OAAO,CAAP,CAAX,KAAyBA,OAAO,CAAP,IAAYx9E,MAAM,CAAN,CAArC;AACAA,YAAM,CAAN,IAAWw9E,OAAO,CAAP,CAAX,KAAyBA,OAAO,CAAP,IAAYx9E,MAAM,CAAN,CAArC,EAH4B,CAGoB;;AAEhD4nF,oBAAc7uG,SAAd,CAAwBssG,SAAxB,CAAkC/qG,IAAlC,CAAuC,IAAvC,EAA6CkjG,OAAO,CAAP,CAA7C,EAAwDA,OAAO,CAAP,CAAxD;AACD,KArB8B;;AAuB/B;;;AAGAsK,iBAAa,uBAAY;AACvB,aAAO,KAAK9C,SAAZ;AACD,KA5B8B;;AA8B/B;;;AAGA+C,iBAAa,qBAAU11D,QAAV,EAAoB;AAC/B,WAAK2yD,SAAL,GAAiB3yD,QAAjB,CAD+B,CACJ;AAC3B;;AAEA,WAAK21D,WAAL,GAAmB,KAAKrO,OAAL,CAAangG,KAAb,EAAnB;AACA,WAAKquG,kBAAL,GAA0BR,qBAAqBh1D,QAArB,CAA1B;AACD,KAvC8B;;AAyC/B;;;AAGAq0D,cAAU,oBAAY;AACpB,aAAOc,sBAAsB,KAAKxC,SAA3B,EAAsC,KAAKrL,OAA3C,EAAoD,KAAKqO,WAAzD,EAAsE,KAAKH,kBAA3E,CAAP;AACD,KA9C8B;;AAgD/B;;;;;;;AAOAnC,cAAU,kBAAU/oG,IAAV,EAAgB0sC,GAAhB,EAAqB;AAC7B,UAAI1sC,QAAQ,IAAZ,EAAkB;AAChB,eAAO,EAAP;AACD;;AAED,UAAIi0D,YAAYvnB,OAAOA,IAAIunB,SAA3B;;AAEA,UAAIA,aAAa,IAAjB,EAAuB;AACrBA,oBAAYI,iBAAiBr0D,IAAjB,KAA0B,CAAtC;AACD,OAFD,MAEO,IAAIi0D,cAAc,MAAlB,EAA0B;AAC/B;AACAA,oBAAY,KAAKi3C,kBAAjB;AACD,OAZ4B,CAY3B;AACF;;;AAGAlrG,aAAOgrG,YAAYhrG,IAAZ,EAAkBi0D,SAAlB,EAA6B,IAA7B,CAAP;AACA,aAAO+C,UAAUh3D,IAAV,CAAP;AACD,KAzE8B;;AA2E/B;;;;;;;AAOAiqG,eAAW,mBAAUI,WAAV,EAAuBC,WAAvB,EAAoCC,WAApC,EAAiD;AAC1DF,oBAAcA,eAAe,CAA7B;AACA,UAAIxJ,SAAS,KAAK7D,OAAlB;AACA,UAAIwN,OAAO3J,OAAO,CAAP,IAAYA,OAAO,CAAP,CAAvB;;AAEA,UAAI,CAACx4D,SAASmiE,IAAT,CAAL,EAAqB;AACnB;AACD,OAPyD,CAOxD;AACF;;;AAGA,UAAIA,OAAO,CAAX,EAAc;AACZA,eAAO,CAACA,IAAR;AACA3J,eAAOyK,OAAP;AACD;;AAED,UAAI7tG,SAAS2sG,uBAAuBvJ,MAAvB,EAA+BwJ,WAA/B,EAA4CC,WAA5C,EAAyDC,WAAzD,CAAb;AACA,WAAKW,kBAAL,GAA0BztG,OAAOgtG,iBAAjC;AACA,WAAKpC,SAAL,GAAiB5qG,OAAOi4C,QAAxB;AACA,WAAK21D,WAAL,GAAmB5tG,OAAOktG,cAA1B;AACD,KAtG8B;;AAwG/B;;;;;;;;;AASAT,gBAAY,oBAAUx9D,GAAV,EAAe;AACzB,UAAIm0D,SAAS,KAAK7D,OAAlB,CADyB,CACE;;AAE3B,UAAI6D,OAAO,CAAP,MAAcA,OAAO,CAAP,CAAlB,EAA6B;AAC3B,YAAIA,OAAO,CAAP,MAAc,CAAlB,EAAqB;AACnB;AACA,cAAI0K,aAAa1K,OAAO,CAAP,CAAjB,CAFmB,CAES;AAC5B;AACA;AACA;AACA;;AAEA,cAAI,CAACn0D,IAAI8+D,MAAT,EAAiB;AACf3K,mBAAO,CAAP,KAAa0K,aAAa,CAA1B;AACA1K,mBAAO,CAAP,KAAa0K,aAAa,CAA1B;AACD,WAHD,MAGO;AACL1K,mBAAO,CAAP,KAAa0K,aAAa,CAA1B;AACD;AACF,SAdD,MAcO;AACL1K,iBAAO,CAAP,IAAY,CAAZ;AACD;AACF;;AAED,UAAI2J,OAAO3J,OAAO,CAAP,IAAYA,OAAO,CAAP,CAAvB,CAvByB,CAuBS;;AAElC,UAAI,CAACx4D,SAASmiE,IAAT,CAAL,EAAqB;AACnB3J,eAAO,CAAP,IAAY,CAAZ;AACAA,eAAO,CAAP,IAAY,CAAZ;AACD;;AAED,WAAKoJ,SAAL,CAAev9D,IAAI29D,WAAnB,EAAgC39D,IAAI49D,WAApC,EAAiD59D,IAAI69D,WAArD,EA9ByB,CA8B0C;;AAEnE,UAAI70D,WAAW,KAAK2yD,SAApB;;AAEA,UAAI,CAAC37D,IAAI++D,MAAT,EAAiB;AACf5K,eAAO,CAAP,IAAYmK,YAAYrmG,KAAKuV,KAAL,CAAW2mF,OAAO,CAAP,IAAYnrD,QAAvB,IAAmCA,QAA/C,CAAZ;AACD;;AAED,UAAI,CAAChJ,IAAI8+D,MAAT,EAAiB;AACf3K,eAAO,CAAP,IAAYmK,YAAYrmG,KAAKyV,IAAL,CAAUymF,OAAO,CAAP,IAAYnrD,QAAtB,IAAkCA,QAA9C,CAAZ;AACD;AACF;AA1J8B,GAAb,CAApB;AA4JA;;;;AAIAu1D,gBAAclnG,MAAd,GAAuB,YAAY;AACjC,WAAO,IAAIknG,aAAJ,EAAP;AACD,GAFD;;AAIA;;;;;;;;;;;;;;;;;;AAkBA,MAAIS,eAAe,aAAnB;AACA,MAAIC,sBAAsB,GAA1B;AACA,MAAIC,WAAW,OAAO9nG,YAAP,KAAwB,WAAxB,GAAsCA,YAAtC,GAAqDvH,KAApE;;AAEA,WAASsvG,gBAAT,CAA0BjtC,WAA1B,EAAuC;AACrC,WAAOA,YAAY77D,GAAZ,CAAgB,OAAhB,KAA4B2oG,eAAe9sC,YAAYoJ,WAA9D;AACD;;AAED,WAAS8jC,UAAT,CAAoBC,IAApB,EAA0B;AACxB,WAAOA,KAAKlpC,GAAL,GAAWkpC,KAAK31E,KAAvB;AACD;AACD;;;;;;;;;;;AAaA,WAAS41E,sBAAT,CAAgC3oC,UAAhC,EAA4Cx0B,OAA5C,EAAqD;AACnD,QAAIy6B,eAAe,EAAnB;AACAz6B,YAAQ05B,gBAAR,CAAyBlF,UAAzB,EAAqC,UAAUzE,WAAV,EAAuB;AAC1D;AACA,UAAIqtC,cAAcrtC,WAAd,KAA8B,CAACstC,cAActtC,WAAd,CAAnC,EAA+D;AAC7D0K,qBAAajpE,IAAb,CAAkBu+D,WAAlB;AACD;AACF,KALD;AAMA,WAAO0K,YAAP;AACD;AACD,WAAS6iC,gBAAT,CAA0BC,SAA1B,EAAqC;AACnC,QAAIC,iBAAiB,EAArB;AACApsG,WAAOmsG,SAAP,EAAkB,UAAUxtC,WAAV,EAAuB;AACvC,UAAI5+D,OAAO4+D,YAAY2S,OAAZ,EAAX;AACA,UAAI+6B,YAAY1tC,YAAYqb,gBAA5B;AACA,UAAIsyB,WAAWD,UAAUlxB,WAAV,EAAf;AACA,UAAIoxB,aAAaD,SAAS9D,SAAT,EAAjB;AACA,UAAIgE,YAAYF,SAAStrG,IAAT,KAAkB,UAAlB,GAA+BsrG,SAASG,YAAT,EAA/B,GAAyD/nG,KAAKyzC,GAAL,CAASo0D,WAAW,CAAX,IAAgBA,WAAW,CAAX,CAAzB,IAA0CxsG,KAAK0hB,KAAL,EAAnH;AACA,UAAIirF,WAAW94C,eAAe+K,YAAY77D,GAAZ,CAAgB,UAAhB,CAAf,EAA4C0pG,SAA5C,CAAf;AACA,UAAIG,cAAc/4C,eAAe+K,YAAY77D,GAAZ,CAAgB,aAAhB,CAAf,EAA+C0pG,SAA/C,CAAlB;AACA,UAAII,SAASjuC,YAAY77D,GAAZ,CAAgB,QAAhB,CAAb;AACA,UAAI+pG,iBAAiBluC,YAAY77D,GAAZ,CAAgB,gBAAhB,CAArB;AACAspG,qBAAehsG,IAAf,CAAoB;AAClBosG,mBAAWA,SADO;AAElBE,kBAAUA,QAFQ;AAGlBC,qBAAaA,WAHK;AAIlBC,gBAAQA,MAJU;AAKlBC,wBAAgBA,cALE;AAMlBC,iBAASjB,WAAWS,QAAX,CANS;AAOlBS,iBAASnB,iBAAiBjtC,WAAjB;AAPS,OAApB;AASD,KAnBD;AAoBA,WAAOquC,uBAAuBZ,cAAvB,CAAP;AACD;;AAED,WAASY,sBAAT,CAAgCZ,cAAhC,EAAgD;AAC9C;AACA,QAAIa,aAAa,EAAjB;AACAjtG,WAAOosG,cAAP,EAAuB,UAAUc,UAAV,EAAsBroF,GAAtB,EAA2B;AAChD,UAAIioF,UAAUI,WAAWJ,OAAzB;AACA,UAAIN,YAAYU,WAAWV,SAA3B;AACA,UAAIW,gBAAgBF,WAAWH,OAAX,KAAuB;AACzCN,mBAAWA,SAD8B;AAEzCY,uBAAeZ,SAF0B;AAGzCa,wBAAgB,CAHyB;AAIzCC,qBAAa,KAJ4B;AAKzC95F,aAAK,KALoC;AAMzC+5F,gBAAQ;AANiC,OAA3C;AAQA,UAAIA,SAASJ,cAAcI,MAA3B;AACAN,iBAAWH,OAAX,IAAsBK,aAAtB;AACA,UAAIJ,UAAUG,WAAWH,OAAzB;;AAEA,UAAI,CAACQ,OAAOR,OAAP,CAAL,EAAsB;AACpBI,sBAAcE,cAAd;AACD;;AAEDE,aAAOR,OAAP,IAAkBQ,OAAOR,OAAP,KAAmB;AACnC9pF,eAAO,CAD4B;AAEnCk2C,kBAAU;AAFyB,OAArC,CAnBgD,CAsB7C;AACH;AACA;AACA;AACA;;AAEA,UAAIuzC,WAAWQ,WAAWR,QAA1B;;AAEA,UAAIA,YAAY,CAACa,OAAOR,OAAP,EAAgB9pF,KAAjC,EAAwC;AACtC;AACAsqF,eAAOR,OAAP,EAAgB9pF,KAAhB,GAAwBypF,QAAxB;AACAA,mBAAWhoG,KAAKoB,GAAL,CAASqnG,cAAcC,aAAvB,EAAsCV,QAAtC,CAAX;AACAS,sBAAcC,aAAd,IAA+BV,QAA/B;AACD;;AAED,UAAIC,cAAcO,WAAWP,WAA7B;AACAA,sBAAgBY,OAAOR,OAAP,EAAgB5zC,QAAhB,GAA2BwzC,WAA3C;AACA,UAAIC,SAASM,WAAWN,MAAxB;AACAA,gBAAU,IAAV,KAAmBO,cAAc35F,GAAd,GAAoBo5F,MAAvC;AACA,UAAIC,iBAAiBK,WAAWL,cAAhC;AACAA,wBAAkB,IAAlB,KAA2BM,cAAcG,WAAd,GAA4BT,cAAvD;AACD,KA3CD;AA4CA,QAAIrvG,SAAS,EAAb;AACAwC,WAAOitG,UAAP,EAAmB,UAAUE,aAAV,EAAyBvuC,YAAzB,EAAuC;AACxDphE,aAAOohE,YAAP,IAAuB,EAAvB;AACA,UAAI2uC,SAASJ,cAAcI,MAA3B;AACA,UAAIf,YAAYW,cAAcX,SAA9B;AACA,UAAIc,cAAc15C,eAAeu5C,cAAcG,WAA7B,EAA0Cd,SAA1C,CAAlB;AACA,UAAIgB,gBAAgB55C,eAAeu5C,cAAc35F,GAA7B,EAAkC,CAAlC,CAApB;AACA,UAAI45F,gBAAgBD,cAAcC,aAAlC;AACA,UAAIC,iBAAiBF,cAAcE,cAAnC;AACA,UAAII,YAAY,CAACL,gBAAgBE,WAAjB,KAAiCD,iBAAiB,CAACA,iBAAiB,CAAlB,IAAuBG,aAAzE,CAAhB;AACAC,kBAAY/oG,KAAKqB,GAAL,CAAS0nG,SAAT,EAAoB,CAApB,CAAZ,CATwD,CASpB;;AAEpCztG,aAAOutG,MAAP,EAAe,UAAUG,MAAV,EAAkBz7C,KAAlB,EAAyB;AACtC,YAAIkH,WAAWu0C,OAAOv0C,QAAtB;;AAEA,YAAIA,YAAYA,WAAWs0C,SAA3B,EAAsC;AACpCt0C,qBAAWz0D,KAAKoB,GAAL,CAASqzD,QAAT,EAAmBi0C,aAAnB,CAAX;;AAEA,cAAIM,OAAOzqF,KAAX,EAAkB;AAChBk2C,uBAAWz0D,KAAKoB,GAAL,CAASqzD,QAAT,EAAmBu0C,OAAOzqF,KAA1B,CAAX;AACD;;AAEDmqF,2BAAiBj0C,QAAjB;AACAu0C,iBAAOzqF,KAAP,GAAek2C,QAAf;AACAk0C;AACD;AACF,OAdD,EAXwD,CAyBpD;;AAEJI,kBAAY,CAACL,gBAAgBE,WAAjB,KAAiCD,iBAAiB,CAACA,iBAAiB,CAAlB,IAAuBG,aAAzE,CAAZ;AACAC,kBAAY/oG,KAAKqB,GAAL,CAAS0nG,SAAT,EAAoB,CAApB,CAAZ;AACA,UAAIE,WAAW,CAAf;AACA,UAAIC,UAAJ;AACA5tG,aAAOutG,MAAP,EAAe,UAAUG,MAAV,EAAkB7oF,GAAlB,EAAuB;AACpC,YAAI,CAAC6oF,OAAOzqF,KAAZ,EAAmB;AACjByqF,iBAAOzqF,KAAP,GAAewqF,SAAf;AACD;;AAEDG,qBAAaF,MAAb;AACAC,oBAAYD,OAAOzqF,KAAP,IAAgB,IAAIuqF,aAApB,CAAZ;AACD,OAPD;;AASA,UAAII,UAAJ,EAAgB;AACdD,oBAAYC,WAAW3qF,KAAX,GAAmBuqF,aAA/B;AACD;;AAED,UAAInqG,SAAS,CAACsqG,QAAD,GAAY,CAAzB;AACA3tG,aAAOutG,MAAP,EAAe,UAAUG,MAAV,EAAkBX,OAAlB,EAA2B;AACxCvvG,eAAOohE,YAAP,EAAqBmuC,OAArB,IAAgCvvG,OAAOohE,YAAP,EAAqBmuC,OAArB,KAAiC;AAC/D1pG,kBAAQA,MADuD;AAE/D4f,iBAAOyqF,OAAOzqF;AAFiD,SAAjE;AAIA5f,kBAAUqqG,OAAOzqF,KAAP,IAAgB,IAAIuqF,aAApB,CAAV;AACD,OAND;AAOD,KApDD;AAqDA,WAAOhwG,MAAP;AACD;AACD;;;;;;;AAQA,WAASqwG,oBAAT,CAA8BC,iBAA9B,EAAiDhC,IAAjD,EAAuDntC,WAAvD,EAAoE;AAClE,QAAImvC,qBAAqBhC,IAAzB,EAA+B;AAC7B,UAAItuG,SAASswG,kBAAkBjC,WAAWC,IAAX,CAAlB,CAAb;;AAEA,UAAItuG,UAAU,IAAV,IAAkBmhE,eAAe,IAArC,EAA2C;AACzCnhE,iBAASA,OAAOouG,iBAAiBjtC,WAAjB,CAAP,CAAT;AACD;;AAED,aAAOnhE,MAAP;AACD;AACF;AACD;;;;;AAKA,WAASgqD,MAAT,CAAgB4b,UAAhB,EAA4Bx0B,OAA5B,EAAqC;AACnC,QAAIy6B,eAAe0iC,uBAAuB3oC,UAAvB,EAAmCx0B,OAAnC,CAAnB;AACA,QAAIk/D,oBAAoB5B,iBAAiB7iC,YAAjB,CAAxB;AACA,QAAI0kC,kBAAkB,EAAtB;AACA/tG,WAAOqpE,YAAP,EAAqB,UAAU1K,WAAV,EAAuB;AAC1C,UAAI5+D,OAAO4+D,YAAY2S,OAAZ,EAAX;AACA,UAAI+6B,YAAY1tC,YAAYqb,gBAA5B;AACA,UAAIsyB,WAAWD,UAAUlxB,WAAV,EAAf;AACA,UAAI4xB,UAAUnB,iBAAiBjtC,WAAjB,CAAd;AACA,UAAIqvC,mBAAmBF,kBAAkBjC,WAAWS,QAAX,CAAlB,EAAwCS,OAAxC,CAAvB;AACA,UAAIkB,eAAeD,iBAAiB3qG,MAApC;AACA,UAAI6qG,cAAcF,iBAAiB/qF,KAAnC;AACA,UAAI6nE,YAAYuhB,UAAU8B,YAAV,CAAuB7B,QAAvB,CAAhB;AACA,UAAI8B,eAAezvC,YAAY77D,GAAZ,CAAgB,cAAhB,KAAmC,CAAtD;AACAirG,sBAAgBhB,OAAhB,IAA2BgB,gBAAgBhB,OAAhB,KAA4B,EAAvD;AACAhtG,WAAKgkG,SAAL,CAAe;AACb1gG,gBAAQ4qG,YADK;AAEbI,cAAMH;AAFO,OAAf;AAIA,UAAII,WAAWvuG,KAAK+7E,YAAL,CAAkBgP,UAAUloB,GAA5B,CAAf;AACA,UAAI2rC,UAAUxuG,KAAK+7E,YAAL,CAAkBwwB,SAAS1pC,GAA3B,CAAd;AACA,UAAI4rC,UAAUtH,mBAAmBnnG,IAAnB,EAAyBuuG;AACvC;AADc,OAAd;AAGA,UAAIG,eAAe3jB,UAAU4jB,YAAV,EAAnB;AACA,UAAIC,iBAAiBC,kBAAkBtC,QAAlB,EAA4BxhB,SAA5B,EAAuC0jB,OAAvC,CAArB;;AAEA,WAAK,IAAI3pF,MAAM,CAAV,EAAahnB,MAAMkC,KAAK0hB,KAAL,EAAxB,EAAsCoD,MAAMhnB,GAA5C,EAAiDgnB,KAAjD,EAAwD;AACtD,YAAIxlB,QAAQU,KAAK+C,GAAL,CAASwrG,QAAT,EAAmBzpF,GAAnB,CAAZ;AACA,YAAIgqF,YAAY9uG,KAAK+C,GAAL,CAASyrG,OAAT,EAAkB1pF,GAAlB,CAAhB;;AAEA,YAAI9I,MAAM1c,KAAN,CAAJ,EAAkB;AAChB;AACD;;AAED,YAAIyvG,OAAOzvG,SAAS,CAAT,GAAa,GAAb,GAAmB,GAA9B;AACA,YAAI0vG,YAAYJ,cAAhB,CATsD,CAStB;AAChC;;AAEA,YAAIH,OAAJ,EAAa;AACX;AACA,cAAI,CAACT,gBAAgBhB,OAAhB,EAAyB8B,SAAzB,CAAL,EAA0C;AACxCd,4BAAgBhB,OAAhB,EAAyB8B,SAAzB,IAAsC;AACpCx8F,iBAAGs8F,cADiC;AAEpC;AACAxoF,iBAAGwoF,cAHiC,CAGlB;;AAHkB,aAAtC;AAMD,WATU,CAST;;;AAGFI,sBAAYhB,gBAAgBhB,OAAhB,EAAyB8B,SAAzB,EAAoCC,IAApC,CAAZ;AACD;;AAED,YAAI/qG,CAAJ;AACA,YAAIC,CAAJ;AACA,YAAIif,KAAJ;AACA,YAAIC,MAAJ;;AAEA,YAAIurF,YAAJ,EAAkB;AAChB,cAAItyE,QAAQkwE,UAAU2C,WAAV,CAAsB,CAAC3vG,KAAD,EAAQwvG,SAAR,CAAtB,CAAZ;AACA9qG,cAAIgrG,SAAJ;AACA/qG,cAAIm4B,MAAM,CAAN,IAAW8xE,YAAf;AACAhrF,kBAAQkZ,MAAM,CAAN,IAAWwyE,cAAnB;AACAzrF,mBAASgrF,WAAT;;AAEA,cAAIxpG,KAAKyzC,GAAL,CAASl1B,KAAT,IAAkBmrF,YAAtB,EAAoC;AAClCnrF,oBAAQ,CAACA,QAAQ,CAAR,GAAY,CAAC,CAAb,GAAiB,CAAlB,IAAuBmrF,YAA/B;AACD;;AAEDI,sBAAYT,gBAAgBhB,OAAhB,EAAyB8B,SAAzB,EAAoCC,IAApC,KAA6C7rF,KAAzD;AACD,SAZD,MAYO;AACL,cAAIkZ,QAAQkwE,UAAU2C,WAAV,CAAsB,CAACH,SAAD,EAAYxvG,KAAZ,CAAtB,CAAZ;AACA0E,cAAIo4B,MAAM,CAAN,IAAW8xE,YAAf;AACAjqG,cAAI+qG,SAAJ;AACA9rF,kBAAQirF,WAAR;AACAhrF,mBAASiZ,MAAM,CAAN,IAAWwyE,cAApB;;AAEA,cAAIjqG,KAAKyzC,GAAL,CAASj1B,MAAT,IAAmBkrF,YAAvB,EAAqC;AACnC;AACAlrF,qBAAS,CAACA,UAAU,CAAV,GAAc,CAAC,CAAf,GAAmB,CAApB,IAAyBkrF,YAAlC;AACD;;AAEDI,sBAAYT,gBAAgBhB,OAAhB,EAAyB8B,SAAzB,EAAoCC,IAApC,KAA6C5rF,MAAzD;AACD;;AAEDnjB,aAAKmkG,aAAL,CAAmBr/E,GAAnB,EAAwB;AACtB9gB,aAAGA,CADmB;AAEtBC,aAAGA,CAFmB;AAGtBif,iBAAOA,KAHe;AAItBC,kBAAQA;AAJc,SAAxB;AAMD;AACF,KAzFD,EAyFG,IAzFH;AA0FD,GArj5B2B,CAqj5B1B;;AAEF,MAAI+rF,cAAc;AAChB7rC,gBAAY,KADI;AAEhBwT,UAAMiH,qBAFU;AAGhBnH,WAAO,eAAU/X,WAAV,EAAuB;AAC5B,UAAI,CAACqtC,cAAcrtC,WAAd,CAAD,IAA+B,CAACstC,cAActtC,WAAd,CAApC,EAAgE;AAC9D;AACD;;AAED,UAAI5+D,OAAO4+D,YAAY2S,OAAZ,EAAX;AACA,UAAI+6B,YAAY1tC,YAAYqb,gBAA5B;AACA,UAAIsyB,WAAWD,UAAUlxB,WAAV,EAAf;AACA,UAAI2P,YAAYuhB,UAAU8B,YAAV,CAAuB7B,QAAvB,CAAhB;AACA,UAAIgC,WAAWvuG,KAAK+7E,YAAL,CAAkBgP,UAAUloB,GAA5B,CAAf;AACA,UAAI2rC,UAAUxuG,KAAK+7E,YAAL,CAAkBwwB,SAAS1pC,GAA3B,CAAd;AACA,UAAIssC,sBAAsBpkB,UAAU4jB,YAAV,EAA1B;AACA,UAAIS,cAAcD,sBAAsB,CAAtB,GAA0B,CAA5C;AACA,UAAIxC,WAAWmB,qBAAqB3B,iBAAiB,CAACvtC,WAAD,CAAjB,CAArB,EAAsD2tC,QAAtD,EAAgE3tC,WAAhE,EAA6E17C,KAA5F;;AAEA,UAAI,EAAEypF,WAAWhB,mBAAb,CAAJ,EAAuC;AACrC;AACAgB,mBAAWhB,mBAAX;AACD;;AAED,aAAO;AACLnzB,kBAAUA;AADL,OAAP;;AAIA,eAASA,QAAT,CAAkBpgE,MAAlB,EAA0BpY,IAA1B,EAAgC;AAC9B,YAAIqvG,cAAc,IAAIzD,QAAJ,CAAaxzF,OAAOsJ,KAAP,GAAe,CAA5B,CAAlB;AACA,YAAI2sB,SAAJ;AACA,YAAIjS,QAAQ,EAAZ;AACA,YAAIkzE,YAAY,EAAhB;AACA,YAAIhsG,SAAS,CAAb;;AAEA,eAAO,CAAC+qC,YAAYj2B,OAAO5C,IAAP,EAAb,KAA+B,IAAtC,EAA4C;AAC1C85F,oBAAUF,WAAV,IAAyBpvG,KAAK+C,GAAL,CAASwrG,QAAT,EAAmBlgE,SAAnB,CAAzB;AACAihE,oBAAU,IAAIF,WAAd,IAA6BpvG,KAAK+C,GAAL,CAASyrG,OAAT,EAAkBngE,SAAlB,CAA7B;AACAjS,kBAAQkwE,UAAU2C,WAAV,CAAsBK,SAAtB,EAAiC,IAAjC,EAAuClzE,KAAvC,CAAR;AACAizE,sBAAY/rG,QAAZ,IAAwB84B,MAAM,CAAN,CAAxB;AACAizE,sBAAY/rG,QAAZ,IAAwB84B,MAAM,CAAN,CAAxB;AACD;;AAEDp8B,aAAKgkG,SAAL,CAAe;AACbqL,uBAAaA,WADA;AAEb1C,oBAAUA,QAFG;AAGbiC,0BAAgBC,kBAAkBtC,QAAlB,EAA4BxhB,SAA5B,EAAuC,KAAvC,CAHH;AAIbokB,+BAAqBA;AAJR,SAAf;AAMD;AACF;AAjDe,GAAlB;;AAoDA,WAASlD,aAAT,CAAuBrtC,WAAvB,EAAoC;AAClC,WAAOA,YAAYqb,gBAAZ,IAAgCrb,YAAYqb,gBAAZ,CAA6Bh5E,IAA7B,KAAsC,aAA7E;AACD;;AAED,WAASirG,aAAT,CAAuBttC,WAAvB,EAAoC;AAClC,WAAOA,YAAY+d,eAAZ,IAA+B/d,YAAY+d,eAAZ,CAA4BqB,KAAlE;AACD;;AAED,WAAS6wB,iBAAT,CAA2BtC,QAA3B,EAAqCxhB,SAArC,EAAgD0jB,OAAhD,EAAyD;AACvD,WAAOrvG,QAAQmtG,SAASgD,eAAT,EAAR,EAAoCxkB,SAApC,KAAkD,CAAlD,IAAuD0jB,OAAvD,GAAiE1jB,UAAUykB,aAAV,CAAwBzkB,UAAU0kB,WAAV,CAAsB,CAAtB,CAAxB,CAAjE,GAAqH1kB,UAAU2kB,eAAV,GAA4B,CAA5B,CAA5H;AACD;;AAED;;;;;;;;;;;;;;;;;;;AAmBA;;;;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAIC,qBAAqB1E,cAAc7uG,SAAvC;AACA,MAAIwzG,WAAWjrG,KAAKyV,IAApB;AACA,MAAIy1F,YAAYlrG,KAAKuV,KAArB;AACA,MAAI41F,aAAa,IAAjB;AACA,MAAIC,aAAaD,aAAa,EAA9B;AACA,MAAIE,WAAWD,aAAa,EAA5B;AACA,MAAIE,UAAUD,WAAW,EAAzB,CA9p5B4B,CA8p5BC;;AAE7B,MAAIE,SAAS,SAATA,MAAS,CAAU/sG,CAAV,EAAaa,CAAb,EAAgBsiB,EAAhB,EAAoBC,EAApB,EAAwB;AACnC,WAAOD,KAAKC,EAAZ,EAAgB;AACd,UAAIQ,MAAMT,KAAKC,EAAL,KAAY,CAAtB;;AAEA,UAAIpjB,EAAE4jB,GAAF,EAAO,CAAP,IAAY/iB,CAAhB,EAAmB;AACjBsiB,aAAKS,MAAM,CAAX;AACD,OAFD,MAEO;AACLR,aAAKQ,GAAL;AACD;AACF;;AAED,WAAOT,EAAP;AACD,GAZD;AAaA;;;;;AAMA,MAAI6pF,YAAYlF,cAAcjsG,MAAd,CAAqB;AACnCiC,UAAM,MAD6B;;AAGnC;;;AAGA8nG,cAAU,kBAAUhnG,GAAV,EAAe;AACvB,UAAIquG,UAAU,KAAKC,QAAnB;AACA,UAAI53C,OAAO,IAAIl3B,IAAJ,CAASx/B,GAAT,CAAX;AACA,aAAOw2D,WAAW63C,QAAQ,CAAR,CAAX,EAAuB33C,IAAvB,EAA6B,KAAK6vC,UAAL,CAAgB,QAAhB,CAA7B,CAAP;AACD,KAVkC;;AAYnC;;;AAGA4B,gBAAY,oBAAUx9D,GAAV,EAAe;AACzB,UAAIm0D,SAAS,KAAK7D,OAAlB,CADyB,CACE;;AAE3B,UAAI6D,OAAO,CAAP,MAAcA,OAAO,CAAP,CAAlB,EAA6B;AAC3B;AACAA,eAAO,CAAP,KAAaoP,OAAb;AACApP,eAAO,CAAP,KAAaoP,OAAb;AACD,OAPwB,CAOvB;;;AAGF,UAAIpP,OAAO,CAAP,MAAc,CAAClrD,QAAf,IAA2BkrD,OAAO,CAAP,MAAclrD,QAA7C,EAAuD;AACrD,YAAItwC,IAAI,IAAIk8B,IAAJ,EAAR;AACAs/D,eAAO,CAAP,IAAY,CAAC,IAAIt/D,IAAJ,CAASl8B,EAAEirG,WAAF,EAAT,EAA0BjrG,EAAEkrG,QAAF,EAA1B,EAAwClrG,EAAEmrG,OAAF,EAAxC,CAAb;AACA3P,eAAO,CAAP,IAAYA,OAAO,CAAP,IAAYoP,OAAxB;AACD;;AAED,WAAKhG,SAAL,CAAev9D,IAAI29D,WAAnB,EAAgC39D,IAAI49D,WAApC,EAAiD59D,IAAI69D,WAArD,EAhByB,CAgB0C;;AAEnE,UAAI70D,WAAW,KAAK2yD,SAApB;;AAEA,UAAI,CAAC37D,IAAI++D,MAAT,EAAiB;AACf5K,eAAO,CAAP,IAAY7sC,QAAQ67C,UAAUhP,OAAO,CAAP,IAAYnrD,QAAtB,IAAkCA,QAA1C,CAAZ;AACD;;AAED,UAAI,CAAChJ,IAAI8+D,MAAT,EAAiB;AACf3K,eAAO,CAAP,IAAY7sC,QAAQ47C,SAAS/O,OAAO,CAAP,IAAYnrD,QAArB,IAAiCA,QAAzC,CAAZ;AACD;AACF,KA1CkC;;AA4CnC;;;AAGAu0D,eAAW,mBAAUwG,aAAV,EAAyBnG,WAAzB,EAAsCC,WAAtC,EAAmD;AAC5DkG,sBAAgBA,iBAAiB,EAAjC;AACA,UAAI5P,SAAS,KAAK7D,OAAlB;AACA,UAAIwN,OAAO3J,OAAO,CAAP,IAAYA,OAAO,CAAP,CAAvB;AACA,UAAI6P,iBAAiBlG,OAAOiG,aAA5B;;AAEA,UAAInG,eAAe,IAAf,IAAuBoG,iBAAiBpG,WAA5C,EAAyD;AACvDoG,yBAAiBpG,WAAjB;AACD;;AAED,UAAIC,eAAe,IAAf,IAAuBmG,iBAAiBnG,WAA5C,EAAyD;AACvDmG,yBAAiBnG,WAAjB;AACD;;AAED,UAAIoG,iBAAiBC,YAAY7yG,MAAjC;AACA,UAAI+mB,MAAMorF,OAAOU,WAAP,EAAoBF,cAApB,EAAoC,CAApC,EAAuCC,cAAvC,CAAV;AACA,UAAIj3F,QAAQk3F,YAAYjsG,KAAKoB,GAAL,CAAS+e,GAAT,EAAc6rF,iBAAiB,CAA/B,CAAZ,CAAZ;AACA,UAAIj7D,WAAWh8B,MAAM,CAAN,CAAf,CAjB4D,CAiBnC;;AAEzB,UAAIA,MAAM,CAAN,MAAa,MAAjB,EAAyB;AACvB,YAAIm3F,WAAWrG,OAAO90D,QAAtB,CADuB,CACS;AAChC;;AAEA,YAAIo7D,WAAW16C,KAAKy6C,WAAWJ,aAAhB,EAA+B,IAA/B,CAAf;AACA/6D,oBAAYo7D,QAAZ;AACD;;AAED,UAAIC,iBAAiB,KAAKzI,UAAL,CAAgB,QAAhB,IAA4B,CAA5B,GAAgC,IAAI/mE,IAAJ,CAAS,CAACs/D,OAAO,CAAP,CAAD,IAAc,CAACA,OAAO,CAAP,CAAxB,EAAmCmQ,iBAAnC,KAAyD,EAAzD,GAA8D,IAAnH;AACA,UAAI9G,aAAa,CAACvlG,KAAK6R,KAAL,CAAWo5F,SAAS,CAAC/O,OAAO,CAAP,IAAYkQ,cAAb,IAA+Br7D,QAAxC,IAAoDA,QAApD,GAA+Dq7D,cAA1E,CAAD,EAA4FpsG,KAAK6R,KAAL,CAAWq5F,UAAU,CAAChP,OAAO,CAAP,IAAYkQ,cAAb,IAA+Br7D,QAAzC,IAAqDA,QAArD,GAAgEq7D,cAA3E,CAA5F,CAAjB;AACAnG,gBAAUV,UAAV,EAAsBrJ,MAAtB;AACA,WAAKwP,QAAL,GAAgB32F,KAAhB,CA9B4D,CA8BrC;;AAEvB,WAAK2uF,SAAL,GAAiB3yD,QAAjB;AACA,WAAK21D,WAAL,GAAmBnB,UAAnB;AACD,KAjFkC;AAkFnCtyF,WAAO,eAAU7V,GAAV,EAAe;AACpB;AACA,aAAO,CAACg0D,UAAUh0D,GAAV,CAAR;AACD;AArFkC,GAArB,CAAhB;AAuFA9B,SAAO,CAAC,SAAD,EAAY,WAAZ,CAAP,EAAiC,UAAU2wC,UAAV,EAAsB;AACrDu/D,cAAU/zG,SAAV,CAAoBw0C,UAApB,IAAkC,UAAU7uC,GAAV,EAAe;AAC/C,aAAO4tG,mBAAmB/+D,UAAnB,EAA+BjzC,IAA/B,CAAoC,IAApC,EAA0C,KAAKia,KAAL,CAAW7V,GAAX,CAA1C,CAAP;AACD,KAFD;AAGD,GAJD,EA1w5B4B,CA8w5BxB;;AAEJ,MAAI6uG,cAAc,CAAC;AACnB,GAAC,UAAD,EAAad,UAAb,CADkB,EACQ;AAC1B,GAAC,UAAD,EAAaA,aAAa,CAA1B,CAFkB,EAEY;AAC9B,GAAC,UAAD,EAAaA,aAAa,EAA1B,CAHkB,EAGa;AAC/B,GAAC,UAAD,EAAaA,aAAa,EAA1B,CAJkB,EAIa;AAC/B,GAAC,UAAD,EAAaA,aAAa,EAA1B,CALkB,EAKa;AAC/B,GAAC,cAAD,EAAiBC,UAAjB,CANkB,EAMY;AAC9B,GAAC,cAAD,EAAiBA,aAAa,CAA9B,CAPkB,EAOgB;AAClC,GAAC,cAAD,EAAiBA,aAAa,EAA9B,CARkB,EAQiB;AACnC,GAAC,cAAD,EAAiBA,aAAa,EAA9B,CATkB,EASiB;AACnC,GAAC,cAAD,EAAiBA,aAAa,EAA9B,CAVkB,EAUiB;AACnC,GAAC,cAAD,EAAiBC,QAAjB,CAXkB,EAWU;AAC5B,GAAC,cAAD,EAAiBA,WAAW,CAA5B,CAZkB,EAYc;AAChC,GAAC,cAAD,EAAiBA,WAAW,CAA5B,CAbkB,EAac;AAChC,GAAC,cAAD,EAAiBA,WAAW,EAA5B,CAdkB,EAce;AACjC,GAAC,aAAD,EAAgBC,OAAhB,CAfkB,EAeQ;AAC1B,GAAC,aAAD,EAAgBA,UAAU,CAA1B,CAhBkB,EAgBY;AAC9B,GAAC,aAAD,EAAgBA,UAAU,CAA1B,CAjBkB,EAiBY;AAC9B,GAAC,aAAD,EAAgBA,UAAU,CAA1B,CAlBkB,EAkBY;AAC9B,GAAC,aAAD,EAAgBA,UAAU,CAA1B,CAnBkB,EAmBY;AAC9B,GAAC,aAAD,EAAgBA,UAAU,CAA1B,CApBkB,EAoBY;AAC9B,GAAC,MAAD,EAASA,UAAU,CAAnB,CArBkB,EAqBK;AACvB,GAAC,aAAD,EAAgBA,UAAU,EAA1B,CAtBkB,EAsBa;AAC/B,GAAC,MAAD,EAASA,UAAU,EAAnB,CAvBkB,EAuBM;AACxB,GAAC,MAAD,EAASA,UAAU,EAAnB,CAxBkB,EAwBM;AACxB,GAAC,OAAD,EAAUA,UAAU,EAApB,CAzBkB,EAyBO;AACzB,GAAC,MAAD,EAASA,UAAU,EAAnB,CA1BkB,EA0BM;AACxB,GAAC,OAAD,EAAUA,UAAU,EAApB,CA3BkB,EA2BO;AACzB,GAAC,MAAD,EAASA,UAAU,EAAnB,CA5BkB,EA4BM;AACxB,GAAC,SAAD,EAAYA,UAAU,GAAV,GAAgB,CAA5B,CA7BkB,EA6Bc;AAChC,GAAC,OAAD,EAAUA,UAAU,EAAV,GAAe,CAAzB,CA9BkB,EA8BW;AAC7B,GAAC,OAAD,EAAUA,UAAU,EAAV,GAAe,CAAzB,CA/BkB,EA+BW;AAC7B,GAAC,WAAD,EAAcA,UAAU,GAAV,GAAgB,CAA9B,CAhCkB,EAgCgB;AAClC,GAAC,OAAD,EAAUA,UAAU,EAAV,GAAe,CAAzB,CAjCkB,EAiCW;AAC7B,GAAC,OAAD,EAAUA,UAAU,EAAV,GAAe,EAAzB,CAlCkB,EAkCY;AAC9B,GAAC,MAAD,EAASA,UAAU,GAAnB,CAnCkB,CAmCM;AAnCN,GAAlB;AAqCA;;;;;AAKAE,YAAUpsG,MAAV,GAAmB,UAAUmuC,KAAV,EAAiB;AAClC,WAAO,IAAIi+D,SAAJ,CAAc;AACnBtyC,cAAQ3rB,MAAMrD,OAAN,CAAc9rC,GAAd,CAAkB,QAAlB;AADW,KAAd,CAAP;AAGD,GAJD;;AAMA;;;;;;;;;;;;;;;;;;;AAmBA;;;;AAIA,MAAIkuG,eAAe/I,MAAM9rG,SAAzB;AACA,MAAI80G,uBAAuBjG,cAAc7uG,SAAzC;AACA,MAAI+0G,qBAAqB98C,gBAAzB;AACA,MAAI+8C,mBAAmBp9C,OAAvB;AACA,MAAIq9C,cAAc1sG,KAAKuV,KAAvB;AACA,MAAIo3F,aAAa3sG,KAAKyV,IAAtB;AACA,MAAIm3F,YAAY5sG,KAAKoN,GAArB;AACA,MAAIy/F,UAAU7sG,KAAK+b,GAAnB;AACA,MAAI+wF,WAAWvJ,MAAMlpG,MAAN,CAAa;AAC1BiC,UAAM,KADoB;AAE1BkwD,UAAM,EAFoB;AAG1BjhB,kBAAc,wBAAY;AACxBg4D,YAAMtnG,KAAN,CAAY,IAAZ,EAAkBD,SAAlB;AACA,WAAK+wG,cAAL,GAAsB,IAAIzG,aAAJ,EAAtB;AACD,KANyB;;AAQ1B;;;AAGAlB,cAAU,oBAAY;AACpB,UAAI4H,gBAAgB,KAAKD,cAAzB;AACA,UAAI7Q,SAAS,KAAK7D,OAAlB;AACA,UAAI4U,iBAAiBD,cAAclJ,SAAd,EAArB;AACA,aAAO1rG,IAAIm0G,qBAAqBnH,QAArB,CAA8BpsG,IAA9B,CAAmC,IAAnC,CAAJ,EAA8C,UAAUoE,GAAV,EAAe;AAClE,YAAI8vG,SAAS79C,QAAQu9C,UAAU,KAAKpgD,IAAf,EAAqBpvD,GAArB,CAAR,CAAb,CADkE,CACjB;;AAEjD8vG,iBAAS9vG,QAAQ8+F,OAAO,CAAP,CAAR,IAAqB8Q,cAAcG,QAAnC,GAA8CC,iBAAiBF,MAAjB,EAAyBD,eAAe,CAAf,CAAzB,CAA9C,GAA4FC,MAArG;AACAA,iBAAS9vG,QAAQ8+F,OAAO,CAAP,CAAR,IAAqB8Q,cAAcK,QAAnC,GAA8CD,iBAAiBF,MAAjB,EAAyBD,eAAe,CAAf,CAAzB,CAA9C,GAA4FC,MAArG;AACA,eAAOA,MAAP;AACD,OANM,EAMJ,IANI,CAAP;AAOD,KAtByB;;AAwB1B;;;;AAIA9I,cAAUmI,qBAAqBnI,QA5BL;;AA8B1B;;;;AAIA7jG,WAAO,eAAUnD,GAAV,EAAe;AACpBA,YAAMkvG,aAAa/rG,KAAb,CAAmBvH,IAAnB,CAAwB,IAAxB,EAA8BoE,GAA9B,CAAN;AACA,aAAOwvG,UAAU,KAAKpgD,IAAf,EAAqBpvD,GAArB,CAAP;AACD,KArCyB;;AAuC1B;;;;AAIA2mG,eAAW,mBAAUjqF,KAAV,EAAiBk4B,GAAjB,EAAsB;AAC/B,UAAIwa,OAAO,KAAKA,IAAhB;AACA1yC,cAAQ+yF,QAAQ/yF,KAAR,IAAiB+yF,QAAQrgD,IAAR,CAAzB;AACAxa,YAAM66D,QAAQ76D,GAAR,IAAe66D,QAAQrgD,IAAR,CAArB;AACA+/C,2BAAqBxI,SAArB,CAA+B/qG,IAA/B,CAAoC,IAApC,EAA0C8gB,KAA1C,EAAiDk4B,GAAjD;AACD,KAhDyB;;AAkD1B;;;AAGA8xD,eAAW,qBAAY;AACrB,UAAIt3C,OAAO,KAAKA,IAAhB;AACA,UAAI0vC,SAASoQ,aAAaxI,SAAb,CAAuB9qG,IAAvB,CAA4B,IAA5B,CAAb;AACAkjG,aAAO,CAAP,IAAY0Q,UAAUpgD,IAAV,EAAgB0vC,OAAO,CAAP,CAAhB,CAAZ;AACAA,aAAO,CAAP,IAAY0Q,UAAUpgD,IAAV,EAAgB0vC,OAAO,CAAP,CAAhB,CAAZ,CAJqB,CAImB;;AAExC,UAAI8Q,gBAAgB,KAAKD,cAAzB;AACA,UAAIE,iBAAiBD,cAAclJ,SAAd,EAArB;AACAkJ,oBAAcG,QAAd,KAA2BjR,OAAO,CAAP,IAAYkR,iBAAiBlR,OAAO,CAAP,CAAjB,EAA4B+Q,eAAe,CAAf,CAA5B,CAAvC;AACAD,oBAAcK,QAAd,KAA2BnR,OAAO,CAAP,IAAYkR,iBAAiBlR,OAAO,CAAP,CAAjB,EAA4B+Q,eAAe,CAAf,CAA5B,CAAvC;AACA,aAAO/Q,MAAP;AACD,KAhEyB;;AAkE1B;;;AAGA0H,iBAAa,qBAAU1H,MAAV,EAAkB;AAC7B,WAAK6Q,cAAL,CAAoBnJ,WAApB,CAAgC1H,MAAhC;;AAEA,UAAI1vC,OAAO,KAAKA,IAAhB;AACA0vC,aAAO,CAAP,IAAY2Q,QAAQ3Q,OAAO,CAAP,CAAR,IAAqB2Q,QAAQrgD,IAAR,CAAjC;AACA0vC,aAAO,CAAP,IAAY2Q,QAAQ3Q,OAAO,CAAP,CAAR,IAAqB2Q,QAAQrgD,IAAR,CAAjC;AACA8/C,mBAAa1I,WAAb,CAAyB5qG,IAAzB,CAA8B,IAA9B,EAAoCkjG,MAApC;AACD,KA5EyB;;AA8E1B;;;AAGA2H,yBAAqB,6BAAUxoG,IAAV,EAAgB6iE,GAAhB,EAAqB;AACxC;AACA;AACA,WAAK0lC,WAAL,CAAiBvoG,KAAK2gG,oBAAL,CAA0B99B,GAA1B,CAAjB;AACD,KArFyB;;AAuF1B;;;;AAIAonC,eAAW,mBAAUwG,aAAV,EAAyB;AAClCA,sBAAgBA,iBAAiB,EAAjC;AACA,UAAI5P,SAAS,KAAK7D,OAAlB;AACA,UAAIwN,OAAO3J,OAAO,CAAP,IAAYA,OAAO,CAAP,CAAvB;;AAEA,UAAI2J,SAAS70D,QAAT,IAAqB60D,QAAQ,CAAjC,EAAoC;AAClC;AACD;;AAED,UAAI90D,WAAWwgB,SAASs0C,IAAT,CAAf;AACA,UAAIyH,MAAMxB,gBAAgBjG,IAAhB,GAAuB90D,QAAjC,CAVkC,CAUS;;AAE3C,UAAIu8D,OAAO,GAAX,EAAgB;AACdv8D,oBAAY,EAAZ;AACD,OAdiC,CAchC;;;AAGF,aAAO,CAAC15B,MAAM05B,QAAN,CAAD,IAAoB/wC,KAAKyzC,GAAL,CAAS1C,QAAT,IAAqB,CAAzC,IAA8C/wC,KAAKyzC,GAAL,CAAS1C,QAAT,IAAqB,CAA1E,EAA6E;AAC3EA,oBAAY,EAAZ;AACD;;AAED,UAAIw0D,aAAa,CAACl2C,QAAQs9C,WAAWzQ,OAAO,CAAP,IAAYnrD,QAAvB,IAAmCA,QAA3C,CAAD,EAAuDse,QAAQq9C,YAAYxQ,OAAO,CAAP,IAAYnrD,QAAxB,IAAoCA,QAA5C,CAAvD,CAAjB;AACA,WAAK2yD,SAAL,GAAiB3yD,QAAjB;AACA,WAAK21D,WAAL,GAAmBnB,UAAnB;AACD,KAnHyB;;AAqH1B;;;;AAIAA,gBAAY,oBAAUx9D,GAAV,EAAe;AACzBwkE,2BAAqBhH,UAArB,CAAgCvsG,IAAhC,CAAqC,IAArC,EAA2C+uC,GAA3C;AACA,UAAIilE,gBAAgB,KAAKD,cAAzB;AACAC,oBAAcG,QAAd,GAAyBplE,IAAI++D,MAA7B;AACAkG,oBAAcK,QAAd,GAAyBtlE,IAAI8+D,MAA7B;AACD;AA9HyB,GAAb,CAAf;AAgIAvrG,SAAO,CAAC,SAAD,EAAY,WAAZ,CAAP,EAAiC,UAAU2wC,UAAV,EAAsB;AACrD6gE,aAASr1G,SAAT,CAAmBw0C,UAAnB,IAAiC,UAAU7uC,GAAV,EAAe;AAC9CA,YAAMyvG,QAAQzvG,GAAR,IAAeyvG,QAAQ,KAAKrgD,IAAb,CAArB;AACA,aAAO8/C,aAAargE,UAAb,EAAyBjzC,IAAzB,CAA8B,IAA9B,EAAoCoE,GAApC,CAAP;AACD,KAHD;AAID,GALD;;AAOA0vG,WAAS1tG,MAAT,GAAkB,YAAY;AAC5B,WAAO,IAAI0tG,QAAJ,EAAP;AACD,GAFD;;AAIA,WAASM,gBAAT,CAA0BhwG,GAA1B,EAA+BmwG,WAA/B,EAA4C;AAC1C,WAAOd,iBAAiBrvG,GAAjB,EAAsBovG,mBAAmBe,WAAnB,CAAtB,CAAP;AACD;;AAED;;;;;;;;;;;;;;;;;;AAkBA;;;;;AAKA,WAASC,cAAT,CAAwBjtG,KAAxB,EAA+BgtC,KAA/B,EAAsC;AACpC,QAAIkgE,YAAYltG,MAAMjE,IAAtB;AACA,QAAI8E,MAAMmsC,MAAMmgE,MAAN,EAAV;AACA,QAAIrsG,MAAMksC,MAAMogE,MAAN,EAAV;AACA,QAAI7G,SAAS1lG,OAAO,IAApB;AACA,QAAIylG,SAASxlG,OAAO,IAApB;AACA,QAAI4rG,iBAAiB1sG,MAAMujG,SAAN,EAArB;AACA,QAAI8J,WAAJ;AACA,QAAIC,WAAJ;AACA,QAAIhI,IAAJ;;AAEA,QAAI4H,cAAc,SAAlB,EAA6B;AAC3BG,oBAAcrgE,MAAMugE,aAAN,GAAsB10G,MAApC;AACD,KAFD,MAEO;AACLy0G,oBAActgE,MAAMnvC,GAAN,CAAU,aAAV,CAAd;;AAEA,UAAI,CAACnE,QAAQ4zG,WAAR,CAAL,EAA2B;AACzBA,sBAAc,CAACA,eAAe,CAAhB,EAAmBA,eAAe,CAAlC,CAAd;AACD;;AAED,UAAI,OAAOA,YAAY,CAAZ,CAAP,KAA0B,SAA9B,EAAyC;AACvCA,sBAAc,CAAC,CAAD,EAAI,CAAJ,CAAd;AACD;;AAEDA,kBAAY,CAAZ,IAAiB3+C,eAAe2+C,YAAY,CAAZ,CAAf,EAA+B,CAA/B,CAAjB;AACAA,kBAAY,CAAZ,IAAiB3+C,eAAe2+C,YAAY,CAAZ,CAAf,EAA+B,CAA/B,CAAjB;AACAhI,aAAOoH,eAAe,CAAf,IAAoBA,eAAe,CAAf,CAApB,IAAyCjtG,KAAKyzC,GAAL,CAASw5D,eAAe,CAAf,CAAT,CAAhD;AACD,KA3BmC,CA2BlC;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,QAAI7rG,OAAO,IAAX,EAAiB;AACfA,YAAMqsG,cAAc,SAAd,GAA0BG,cAAc,CAAd,GAAkBx+C,GAA5C,GAAkD69C,eAAe,CAAf,IAAoBY,YAAY,CAAZ,IAAiBhI,IAA7F;AACD;;AAED,QAAIxkG,OAAO,IAAX,EAAiB;AACfA,YAAMosG,cAAc,SAAd,GAA0BG,cAAcA,cAAc,CAA5B,GAAgCx+C,GAA1D,GAAgE69C,eAAe,CAAf,IAAoBY,YAAY,CAAZ,IAAiBhI,IAA3G;AACD;;AAED,QAAIzkG,QAAQ,SAAZ,EAAuB;AACrBA,YAAM6rG,eAAe,CAAf,CAAN;AACD,KAFD,MAEO,IAAI,OAAO7rG,GAAP,KAAe,UAAnB,EAA+B;AACpCA,YAAMA,IAAI;AACRA,aAAK6rG,eAAe,CAAf,CADG;AAER5rG,aAAK4rG,eAAe,CAAf;AAFG,OAAJ,CAAN;AAID;;AAED,QAAI5rG,QAAQ,SAAZ,EAAuB;AACrBA,YAAM4rG,eAAe,CAAf,CAAN;AACD,KAFD,MAEO,IAAI,OAAO5rG,GAAP,KAAe,UAAnB,EAA+B;AACpCA,YAAMA,IAAI;AACRD,aAAK6rG,eAAe,CAAf,CADG;AAER5rG,aAAK4rG,eAAe,CAAf;AAFG,OAAJ,CAAN;AAID;;AAED,KAAC7rG,OAAO,IAAP,IAAe,CAACsiC,SAAStiC,GAAT,CAAjB,MAAoCA,MAAMguD,GAA1C;AACA,KAAC/tD,OAAO,IAAP,IAAe,CAACqiC,SAASriC,GAAT,CAAjB,MAAoCA,MAAM+tD,GAA1C;AACA7uD,UAAM4jG,QAAN,CAAeznG,MAAM0E,GAAN,KAAc1E,MAAM2E,GAAN,CAAd,IAA4BosG,cAAc,SAAd,IAA2B,CAACltG,MAAM2iG,cAAN,GAAuB/4B,UAAvB,CAAkC/wE,MAAzG,EAtEoC,CAsE8E;;AAElH,QAAIm0C,MAAMwgE,gBAAN,EAAJ,EAA8B;AAC5B;AACA,UAAI3sG,MAAM,CAAN,IAAWC,MAAM,CAAjB,IAAsB,CAACylG,MAA3B,EAAmC;AACjC1lG,cAAM,CAAN;AACD,OAJ2B,CAI1B;;;AAGF,UAAIA,MAAM,CAAN,IAAWC,MAAM,CAAjB,IAAsB,CAACwlG,MAA3B,EAAmC;AACjCxlG,cAAM,CAAN;AACD;AACF,KAlFmC,CAkFlC;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,QAAI6oC,UAAUqD,MAAMrD,OAApB;;AAEA,QAAIA,WAAWujE,cAAc;AAC7B;AADA,MAEE;AACA,YAAIO,kBAAkB3G,uBAAuB,KAAvB,EAA8Bn9D,OAA9B,CAAtB;AACA,YAAI+jE,yBAAJ;AACA3yG,eAAO0yG,eAAP,EAAwB,UAAU/zC,WAAV,EAAuB;AAC7Cg0C,uCAA6Bh0C,YAAYwc,WAAZ,OAA8BlpC,MAAM65D,IAAjE;AACD,SAFD;;AAIA,YAAI6G,yBAAJ,EAA+B;AAC7B;AACA,cAAI7E,oBAAoB5B,iBAAiBwG,eAAjB,CAAxB,CAF6B,CAE8B;;AAE3D,cAAIE,gBAAgBC,uBAAuB/sG,GAAvB,EAA4BC,GAA5B,EAAiCksC,KAAjC,EAAwC67D,iBAAxC,CAApB;AACAhoG,gBAAM8sG,cAAc9sG,GAApB;AACAC,gBAAM6sG,cAAc7sG,GAApB;AACD;AACF;;AAED,WAAO,CAACD,GAAD,EAAMC,GAAN,CAAP;AACD;;AAED,WAAS8sG,sBAAT,CAAgC/sG,GAAhC,EAAqCC,GAArC,EAA0CksC,KAA1C,EAAiD67D,iBAAjD,EAAoE;AAClE;AACA,QAAIvB,aAAat6D,MAAM65D,IAAN,CAAWtD,SAAX,EAAjB;AACA,QAAIsK,aAAavG,WAAW,CAAX,IAAgBA,WAAW,CAAX,CAAjC,CAHkE,CAGlB;;AAEhD,QAAIwG,oBAAoBlF,qBAAqBC,iBAArB,EAAwC77D,MAAM65D,IAA9C,CAAxB;;AAEA,QAAIiH,sBAAsBhtE,SAA1B,EAAqC;AACnC,aAAO;AACLjgC,aAAKA,GADA;AAELC,aAAKA;AAFA,OAAP;AAID;;AAED,QAAIitG,cAAct9D,QAAlB;AACA11C,WAAO+yG,iBAAP,EAA0B,UAAUplE,IAAV,EAAgB;AACxCqlE,oBAActuG,KAAKoB,GAAL,CAAS6nC,KAAKtqC,MAAd,EAAsB2vG,WAAtB,CAAd;AACD,KAFD;AAGA,QAAIC,cAAc,CAACv9D,QAAnB;AACA11C,WAAO+yG,iBAAP,EAA0B,UAAUplE,IAAV,EAAgB;AACxCslE,oBAAcvuG,KAAKqB,GAAL,CAAS4nC,KAAKtqC,MAAL,GAAcsqC,KAAK1qB,KAA5B,EAAmCgwF,WAAnC,CAAd;AACD,KAFD;AAGAD,kBAActuG,KAAKyzC,GAAL,CAAS66D,WAAT,CAAd;AACAC,kBAAcvuG,KAAKyzC,GAAL,CAAS86D,WAAT,CAAd;AACA,QAAIC,gBAAgBF,cAAcC,WAAlC,CAxBkE,CAwBnB;;AAE/C,QAAIE,WAAWptG,MAAMD,GAArB;AACA,QAAIstG,uBAAuB,IAAI,CAACJ,cAAcC,WAAf,IAA8BH,UAA7D;AACA,QAAIO,iBAAiBF,WAAWC,oBAAX,GAAkCD,QAAvD;AACAptG,WAAOstG,kBAAkBJ,cAAcC,aAAhC,CAAP;AACAptG,WAAOutG,kBAAkBL,cAAcE,aAAhC,CAAP;AACA,WAAO;AACLptG,WAAKA,GADA;AAELC,WAAKA;AAFA,KAAP;AAID;;AAED,WAASutG,eAAT,CAAyBruG,KAAzB,EAAgCgtC,KAAhC,EAAuC;AACrC,QAAI2uD,SAASsR,eAAejtG,KAAf,EAAsBgtC,KAAtB,CAAb;AACA,QAAIu5D,SAASv5D,MAAMmgE,MAAN,MAAkB,IAA/B;AACA,QAAI7G,SAASt5D,MAAMogE,MAAN,MAAkB,IAA/B;AACA,QAAIjI,cAAcn4D,MAAMnvC,GAAN,CAAU,aAAV,CAAlB;;AAEA,QAAImC,MAAMjE,IAAN,KAAe,KAAnB,EAA0B;AACxBiE,YAAMisD,IAAN,GAAajf,MAAMnvC,GAAN,CAAU,SAAV,CAAb;AACD;;AAED,QAAIqvG,YAAYltG,MAAMjE,IAAtB;AACAiE,UAAMwjG,SAAN,CAAgB7H,OAAO,CAAP,CAAhB,EAA2BA,OAAO,CAAP,CAA3B;AACA37F,UAAMglG,UAAN,CAAiB;AACfG,mBAAaA,WADE;AAEfoB,cAAQA,MAFO;AAGfD,cAAQA,MAHO;AAIflB,mBAAa8H,cAAc,UAAd,IAA4BA,cAAc,MAA1C,GAAmDlgE,MAAMnvC,GAAN,CAAU,aAAV,CAAnD,GAA8E,IAJ5E;AAKfwnG,mBAAa6H,cAAc,UAAd,IAA4BA,cAAc,MAA1C,GAAmDlgE,MAAMnvC,GAAN,CAAU,aAAV,CAAnD,GAA8E;AAL5E,KAAjB,EAZqC,CAkBjC;AACJ;AACA;AACA;AACA;;AAEA,QAAI2yC,WAAWxD,MAAMnvC,GAAN,CAAU,UAAV,CAAf;;AAEA,QAAI2yC,YAAY,IAAhB,EAAsB;AACpBxwC,YAAMkmG,WAAN,IAAqBlmG,MAAMkmG,WAAN,CAAkB11D,QAAlB,CAArB;AACD;AACF;AACD;;;;;;AAMA,WAAS89D,kBAAT,CAA4BthE,KAA5B,EAAmCqoD,QAAnC,EAA6C;AAC3CA,eAAWA,YAAYroD,MAAMnvC,GAAN,CAAU,MAAV,CAAvB;;AAEA,QAAIw3F,QAAJ,EAAc;AACZ,cAAQA,QAAR;AACE;AACA,aAAK,UAAL;AACE,iBAAO,IAAIqP,YAAJ,CAAiB13D,MAAM21D,cAAN,GAAuB31D,MAAM21D,cAAN,EAAvB,GAAgD31D,MAAMugE,aAAN,EAAjE,EAAwF,CAAC98D,QAAD,EAAW,CAACA,QAAZ,CAAxF,CAAP;;AAEF,aAAK,OAAL;AACE,iBAAO,IAAIs1D,aAAJ,EAAP;AACF;;AAEA;AACE,iBAAO,CAAC/C,MAAM/2D,QAAN,CAAeopD,QAAf,KAA4B0Q,aAA7B,EAA4ClnG,MAA5C,CAAmDmuC,KAAnD,CAAP;AAVJ;AAYD;AACF;AACD;;;;AAIA,WAASuhE,eAAT,CAAyB1H,IAAzB,EAA+B;AAC7B,QAAIt3C,aAAas3C,KAAK7mG,KAAL,CAAWujG,SAAX,EAAjB;AACA,QAAI1iG,MAAM0uD,WAAW,CAAX,CAAV;AACA,QAAIzuD,MAAMyuD,WAAW,CAAX,CAAV;AACA,WAAO,EAAE1uD,MAAM,CAAN,IAAWC,MAAM,CAAjB,IAAsBD,MAAM,CAAN,IAAWC,MAAM,CAAzC,CAAP;AACD;AACD;;;;;;;;;AASA,WAAS0tG,kBAAT,CAA4B3H,IAA5B,EAAkC;AAChC,QAAI4H,iBAAiB5H,KAAK6H,aAAL,GAAqB7wG,GAArB,CAAyB,WAAzB,CAArB;AACA,QAAI8wG,oBAAoB9H,KAAK9qG,IAAL,KAAc,UAAd,GAA2B8qG,KAAK7mG,KAAL,CAAWujG,SAAX,GAAuB,CAAvB,CAA3B,GAAuD,IAA/E;;AAEA,QAAI,OAAOkL,cAAP,KAA0B,QAA9B,EAAwC;AACtCA,uBAAiB,UAAU97C,GAAV,EAAe;AAC9B,eAAO,UAAU91D,GAAV,EAAe;AACpB,iBAAO81D,IAAIv1D,OAAJ,CAAY,SAAZ,EAAuBP,OAAO,IAAP,GAAcA,GAAd,GAAoB,EAA3C,CAAP;AACD,SAFD;AAGD,OAJgB,CAIf4xG,cAJe,CAAjB,CADsC,CAKnB;;;AAGnB,aAAOA,cAAP;AACD,KATD,MASO,IAAI,OAAOA,cAAP,KAA0B,UAA9B,EAA0C;AAC/C,aAAO,UAAUG,SAAV,EAAqBhvF,GAArB,EAA0B;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA,YAAI+uF,qBAAqB,IAAzB,EAA+B;AAC7B/uF,gBAAMgvF,YAAYD,iBAAlB;AACD;;AAED,eAAOF,eAAeI,gBAAgBhI,IAAhB,EAAsB+H,SAAtB,CAAf,EAAiDhvF,GAAjD,CAAP;AACD,OAZD;AAaD,KAdM,MAcA;AACL,aAAO,UAAUimF,IAAV,EAAgB;AACrB,eAAOgB,KAAK7mG,KAAL,CAAW6jG,QAAX,CAAoBgC,IAApB,CAAP;AACD,OAFD;AAGD;AACF;AACD,WAASgJ,eAAT,CAAyBhI,IAAzB,EAA+BzsG,KAA/B,EAAsC;AACpC;AACA;AACA;AACA,WAAOysG,KAAK9qG,IAAL,KAAc,UAAd,GAA2B8qG,KAAK7mG,KAAL,CAAW6jG,QAAX,CAAoBzpG,KAApB,CAA3B,GAAwDA,KAA/D;AACD;AACD;;;;;AAKA,WAAS00G,sBAAT,CAAgCjI,IAAhC,EAAsC;AACpC,QAAIzrC,YAAYyrC,KAAK75D,KAArB;AACA,QAAIhtC,QAAQ6mG,KAAK7mG,KAAjB;;AAEA,QAAI,CAACo7D,UAAUv9D,GAAV,CAAc,gBAAd,CAAD,IAAoCmC,MAAM0jG,OAAN,EAAxC,EAAyD;AACvD;AACD;;AAED,QAAItpC,aAAaysC,KAAK9qG,IAAL,KAAc,UAA/B;AACA,QAAIgzG,oBAAJ;AACA,QAAIC,SAAJ;AACA,QAAIC,sBAAsBjvG,MAAMujG,SAAN,EAA1B,CAXoC,CAWS;;AAE7C,QAAInpC,UAAJ,EAAgB;AACd40C,kBAAYhvG,MAAMwc,KAAN,EAAZ;AACD,KAFD,MAEO;AACLuyF,6BAAuB/uG,MAAM6kG,QAAN,EAAvB;AACAmK,kBAAYD,qBAAqBl2G,MAAjC;AACD;;AAED,QAAIq2G,iBAAiBrI,KAAK6H,aAAL,EAArB;AACA,QAAID,iBAAiBD,mBAAmB3H,IAAnB,CAArB;AACA,QAAIznF,IAAJ;AACA,QAAIvQ,OAAO,CAAX,CAvBoC,CAuBtB;;AAEd,QAAImgG,YAAY,EAAhB,EAAoB;AAClBngG,aAAOpP,KAAKyV,IAAL,CAAU85F,YAAY,EAAtB,CAAP;AACD;;AAED,SAAK,IAAIr2G,IAAI,CAAb,EAAgBA,IAAIq2G,SAApB,EAA+Br2G,KAAKkW,IAApC,EAA0C;AACxC,UAAI+/F,YAAYG,uBAAuBA,qBAAqBp2G,CAArB,CAAvB,GAAiDs2G,oBAAoB,CAApB,IAAyBt2G,CAA1F;AACA,UAAIi9E,QAAQ64B,eAAeG,SAAf,CAAZ;AACA,UAAIO,sBAAsBD,eAAepkD,WAAf,CAA2B8qB,KAA3B,CAA1B;AACA,UAAIw5B,aAAaC,eAAeF,mBAAf,EAAoCD,eAAerxG,GAAf,CAAmB,QAAnB,KAAgC,CAApE,CAAjB;AACAuhB,aAAOA,KAAKlB,KAAL,CAAWkxF,UAAX,CAAP,GAAgChwF,OAAOgwF,UAAvC;AACD;;AAED,WAAOhwF,IAAP;AACD;;AAED,WAASiwF,cAAT,CAAwBxnF,QAAxB,EAAkClf,MAAlC,EAA0C;AACxC,QAAI2mG,gBAAgB3mG,SAASlJ,KAAKgN,EAAd,GAAmB,GAAvC;AACA,QAAI8iG,cAAc1nF,SAASxI,KAAT,EAAlB;AACA,QAAImwF,cAAcD,YAAYvxF,KAA9B;AACA,QAAIyxF,eAAeF,YAAYtxF,MAA/B;AACA,QAAIyxF,aAAaF,cAAc/vG,KAAK6J,GAAL,CAASgmG,aAAT,CAAd,GAAwCG,eAAehwG,KAAK2J,GAAL,CAASkmG,aAAT,CAAxE;AACA,QAAIK,cAAcH,cAAc/vG,KAAK2J,GAAL,CAASkmG,aAAT,CAAd,GAAwCG,eAAehwG,KAAK6J,GAAL,CAASgmG,aAAT,CAAzE;AACA,QAAIM,cAAc,IAAI7xF,YAAJ,CAAiBwxF,YAAYzwG,CAA7B,EAAgCywG,YAAYxwG,CAA5C,EAA+C2wG,UAA/C,EAA2DC,WAA3D,CAAlB;AACA,WAAOC,WAAP;AACD;;AAED;;;;;;;;;;;;;;;;;;AAkBA,MAAIC,uBAAuB;AACzB;;;;AAIA1C,YAAQ,gBAAU9iG,MAAV,EAAkB;AACxB,UAAIg+B,SAAS,KAAKA,MAAlB;AACA,UAAIxnC,MAAM,CAACwJ,MAAD,IAAWg+B,OAAOynE,UAAP,IAAqB,IAAhC,GAAuCznE,OAAOynE,UAA9C,GAA2DznE,OAAOxnC,GAA5E;;AAEA,UAAI,KAAKgmG,IAAL,IAAahmG,OAAO,IAApB,IAA4BA,QAAQ,SAApC,IAAiD,OAAOA,GAAP,KAAe,UAAhE,IAA8E,CAAC1E,MAAM0E,GAAN,CAAnF,EAA+F;AAC7FA,cAAM,KAAKgmG,IAAL,CAAU7mG,KAAV,CAAgB0S,KAAhB,CAAsB7R,GAAtB,CAAN;AACD;;AAED,aAAOA,GAAP;AACD,KAdwB;;AAgBzB;;;;AAIAusG,YAAQ,gBAAU/iG,MAAV,EAAkB;AACxB,UAAIg+B,SAAS,KAAKA,MAAlB;AACA,UAAIvnC,MAAM,CAACuJ,MAAD,IAAWg+B,OAAO0nE,QAAP,IAAmB,IAA9B,GAAqC1nE,OAAO0nE,QAA5C,GAAuD1nE,OAAOvnC,GAAxE;;AAEA,UAAI,KAAK+lG,IAAL,IAAa/lG,OAAO,IAApB,IAA4BA,QAAQ,SAApC,IAAiD,OAAOA,GAAP,KAAe,UAAhE,IAA8E,CAAC3E,MAAM2E,GAAN,CAAnF,EAA+F;AAC7FA,cAAM,KAAK+lG,IAAL,CAAU7mG,KAAV,CAAgB0S,KAAhB,CAAsB5R,GAAtB,CAAN;AACD;;AAED,aAAOA,GAAP;AACD,KA7BwB;;AA+BzB;;;AAGA0sG,sBAAkB,4BAAY;AAC5B,UAAInlE,SAAS,KAAKA,MAAlB;AACA,aAAOA,OAAOynE,UAAP,IAAqB,IAArB,IAA6BznE,OAAO0nE,QAAP,IAAmB,IAAhD,GAAuD,KAAvD,GAA+D,CAAC1nE,OAAOroC,KAA9E;AACD,KArCwB;;AAuCzB;;;;AAIAgwG,sBAAkB3xG,IA3CO;;AA6CzB;;;;AAIA4xG,cAAU,kBAAUH,UAAV,EAAsBC,QAAtB,EAAgC;AACxC,WAAK1nE,MAAL,CAAYynE,UAAZ,GAAyBA,UAAzB;AACA,WAAKznE,MAAL,CAAY0nE,QAAZ,GAAuBA,QAAvB;AACD,KApDwB;;AAsDzB;;;AAGAG,gBAAY,sBAAY;AACtB;AACA,WAAK7nE,MAAL,CAAYynE,UAAZ,GAAyB,KAAKznE,MAAL,CAAY0nE,QAAZ,GAAuB,IAAhD;AACD;AA5DwB,GAA3B;;AA+DA;;;;;;;;;;;;;;;;;;AAkBA;AACA;;;;;AAKA,MAAII,WAAW/tD,YAAY;AACzBrmD,UAAM,UADmB;AAEzB62B,WAAO;AACL6iB,UAAI,CADC;AAELC,UAAI,CAFC;AAGL13B,aAAO,CAHF;AAILC,cAAQ;AAJH,KAFkB;AAQzB0U,eAAW,mBAAU7W,IAAV,EAAgB8W,KAAhB,EAAuB;AAChC,UAAI6iB,KAAK7iB,MAAM6iB,EAAf;AACA,UAAIC,KAAK9iB,MAAM8iB,EAAf;AACA,UAAI13B,QAAQ4U,MAAM5U,KAAN,GAAc,CAA1B;AACA,UAAIC,SAAS2U,MAAM3U,MAAN,GAAe,CAA5B;AACAnC,WAAKoX,MAAL,CAAYuiB,EAAZ,EAAgBC,KAAKz3B,MAArB;AACAnC,WAAKqX,MAAL,CAAYsiB,KAAKz3B,KAAjB,EAAwB03B,KAAKz3B,MAA7B;AACAnC,WAAKqX,MAAL,CAAYsiB,KAAKz3B,KAAjB,EAAwB03B,KAAKz3B,MAA7B;AACAnC,WAAKga,SAAL;AACD;AAjBwB,GAAZ,CAAf;AAmBA;;;;;AAKA,MAAIs6E,UAAUhuD,YAAY;AACxBrmD,UAAM,SADkB;AAExB62B,WAAO;AACL6iB,UAAI,CADC;AAELC,UAAI,CAFC;AAGL13B,aAAO,CAHF;AAILC,cAAQ;AAJH,KAFiB;AAQxB0U,eAAW,mBAAU7W,IAAV,EAAgB8W,KAAhB,EAAuB;AAChC,UAAI6iB,KAAK7iB,MAAM6iB,EAAf;AACA,UAAIC,KAAK9iB,MAAM8iB,EAAf;AACA,UAAI13B,QAAQ4U,MAAM5U,KAAN,GAAc,CAA1B;AACA,UAAIC,SAAS2U,MAAM3U,MAAN,GAAe,CAA5B;AACAnC,WAAKoX,MAAL,CAAYuiB,EAAZ,EAAgBC,KAAKz3B,MAArB;AACAnC,WAAKqX,MAAL,CAAYsiB,KAAKz3B,KAAjB,EAAwB03B,EAAxB;AACA55B,WAAKqX,MAAL,CAAYsiB,EAAZ,EAAgBC,KAAKz3B,MAArB;AACAnC,WAAKqX,MAAL,CAAYsiB,KAAKz3B,KAAjB,EAAwB03B,EAAxB;AACA55B,WAAKga,SAAL;AACD;AAlBuB,GAAZ,CAAd;AAoBA;;;;;AAKA,MAAIu6E,MAAMjuD,YAAY;AACpBrmD,UAAM,KADc;AAEpB62B,WAAO;AACL;AACA9zB,SAAG,CAFE;AAGLC,SAAG,CAHE;AAILif,aAAO,CAJF;AAKLC,cAAQ;AALH,KAFa;AASpB0U,eAAW,mBAAU7W,IAAV,EAAgB8W,KAAhB,EAAuB;AAChC,UAAI9zB,IAAI8zB,MAAM9zB,CAAd;AACA,UAAIC,IAAI6zB,MAAM7zB,CAAd;AACA,UAAIya,IAAIoZ,MAAM5U,KAAN,GAAc,CAAd,GAAkB,CAA1B,CAHgC,CAGH;;AAE7B,UAAIjb,IAAItD,KAAKqB,GAAL,CAAS0Y,CAAT,EAAYoZ,MAAM3U,MAAlB,CAAR;AACA,UAAI/L,IAAIsH,IAAI,CAAZ,CANgC,CAMjB;;AAEf,UAAItX,KAAKgQ,IAAIA,CAAJ,IAASnP,IAAImP,CAAb,CAAT;AACA,UAAIwjC,KAAK32C,IAAIgE,CAAJ,GAAQmP,CAAR,GAAYhQ,EAArB;AACA,UAAIixC,QAAQ1zC,KAAK4N,IAAL,CAAUnL,KAAKgQ,CAAf,CAAZ,CAVgC,CAUD;;AAE/B,UAAIjQ,KAAKxC,KAAK6J,GAAL,CAAS6pC,KAAT,IAAkBjhC,CAA3B;AACA,UAAIo+F,OAAO7wG,KAAK2J,GAAL,CAAS+pC,KAAT,CAAX;AACA,UAAIo9D,OAAO9wG,KAAK6J,GAAL,CAAS6pC,KAAT,CAAX;AACA,UAAIq9D,QAAQt+F,IAAI,GAAhB;AACA,UAAIu+F,SAASv+F,IAAI,GAAjB;AACA4J,WAAKoX,MAAL,CAAYp0B,IAAImD,EAAhB,EAAoByzC,KAAKxzC,EAAzB;AACA4Z,WAAKsX,GAAL,CAASt0B,CAAT,EAAY42C,EAAZ,EAAgBxjC,CAAhB,EAAmBzS,KAAKgN,EAAL,GAAU0mC,KAA7B,EAAoC1zC,KAAKgN,EAAL,GAAU,CAAV,GAAc0mC,KAAlD;AACAr3B,WAAKu5B,aAAL,CAAmBv2C,IAAImD,EAAJ,GAASquG,OAAOE,KAAnC,EAA0C96D,KAAKxzC,EAAL,GAAUquG,OAAOC,KAA3D,EAAkE1xG,CAAlE,EAAqEC,IAAI0xG,MAAzE,EAAiF3xG,CAAjF,EAAoFC,CAApF;AACA+c,WAAKu5B,aAAL,CAAmBv2C,CAAnB,EAAsBC,IAAI0xG,MAA1B,EAAkC3xG,IAAImD,EAAJ,GAASquG,OAAOE,KAAlD,EAAyD96D,KAAKxzC,EAAL,GAAUquG,OAAOC,KAA1E,EAAiF1xG,IAAImD,EAArF,EAAyFyzC,KAAKxzC,EAA9F;AACA4Z,WAAKga,SAAL;AACD;AA/BmB,GAAZ,CAAV;AAiCA;;;;;AAKA,MAAI46E,QAAQtuD,YAAY;AACtBrmD,UAAM,OADgB;AAEtB62B,WAAO;AACL9zB,SAAG,CADE;AAELC,SAAG,CAFE;AAGLif,aAAO,CAHF;AAILC,cAAQ;AAJH,KAFe;AAQtB0U,eAAW,mBAAU3vB,GAAV,EAAe4vB,KAAf,EAAsB;AAC/B,UAAI3U,SAAS2U,MAAM3U,MAAnB;AACA,UAAID,QAAQ4U,MAAM5U,KAAlB;AACA,UAAIlf,IAAI8zB,MAAM9zB,CAAd;AACA,UAAIC,IAAI6zB,MAAM7zB,CAAd;AACA,UAAIkD,KAAK+b,QAAQ,CAAR,GAAY,CAArB;AACAhb,UAAIkwB,MAAJ,CAAWp0B,CAAX,EAAcC,CAAd;AACAiE,UAAImwB,MAAJ,CAAWr0B,IAAImD,EAAf,EAAmBlD,IAAIkf,MAAvB;AACAjb,UAAImwB,MAAJ,CAAWr0B,CAAX,EAAcC,IAAIkf,SAAS,CAAT,GAAa,CAA/B;AACAjb,UAAImwB,MAAJ,CAAWr0B,IAAImD,EAAf,EAAmBlD,IAAIkf,MAAvB;AACAjb,UAAImwB,MAAJ,CAAWr0B,CAAX,EAAcC,CAAd;AACAiE,UAAI8yB,SAAJ;AACD;AApBqB,GAAZ,CAAZ;AAsBA;;;;;AAKA,MAAI66E,cAAc;AAChBj/E,UAAM2uB,IADU;AAEhBjhC,UAAMghC,IAFU;AAGhBwwD,eAAWxwD,IAHK;AAIhBywD,YAAQzwD,IAJQ;AAKhB0wD,YAAQ7yD,MALQ;AAMhB8yD,aAASX,OANO;AAOhBY,SAAKX,GAPW;AAQhBY,WAAOP,KARS;AAShBQ,cAAUf;AATM,GAAlB;AAWA,MAAIgB,oBAAoB;AACtBz/E,UAAM,cAAU5yB,CAAV,EAAaC,CAAb,EAAgBya,CAAhB,EAAmBzW,CAAnB,EAAsB6vB,KAAtB,EAA6B;AACjC;AACAA,YAAMwd,EAAN,GAAWtxC,CAAX;AACA8zB,YAAMyd,EAAN,GAAWtxC,IAAIgE,IAAI,CAAnB;AACA6vB,YAAM5M,EAAN,GAAWlnB,IAAI0a,CAAf;AACAoZ,YAAM3M,EAAN,GAAWlnB,IAAIgE,IAAI,CAAnB;AACD,KAPqB;AAQtBqc,UAAM,cAAUtgB,CAAV,EAAaC,CAAb,EAAgBya,CAAhB,EAAmBzW,CAAnB,EAAsB6vB,KAAtB,EAA6B;AACjCA,YAAM9zB,CAAN,GAAUA,CAAV;AACA8zB,YAAM7zB,CAAN,GAAUA,CAAV;AACA6zB,YAAM5U,KAAN,GAAcxE,CAAd;AACAoZ,YAAM3U,MAAN,GAAelb,CAAf;AACD,KAbqB;AActB6tG,eAAW,mBAAU9xG,CAAV,EAAaC,CAAb,EAAgBya,CAAhB,EAAmBzW,CAAnB,EAAsB6vB,KAAtB,EAA6B;AACtCA,YAAM9zB,CAAN,GAAUA,CAAV;AACA8zB,YAAM7zB,CAAN,GAAUA,CAAV;AACA6zB,YAAM5U,KAAN,GAAcxE,CAAd;AACAoZ,YAAM3U,MAAN,GAAelb,CAAf;AACA6vB,YAAM1gB,CAAN,GAAUzS,KAAKoB,GAAL,CAAS2Y,CAAT,EAAYzW,CAAZ,IAAiB,CAA3B;AACD,KApBqB;AAqBtB8tG,YAAQ,gBAAU/xG,CAAV,EAAaC,CAAb,EAAgBya,CAAhB,EAAmBzW,CAAnB,EAAsB6vB,KAAtB,EAA6B;AACnC,UAAIw2E,OAAO3pG,KAAKoB,GAAL,CAAS2Y,CAAT,EAAYzW,CAAZ,CAAX;AACA6vB,YAAM9zB,CAAN,GAAUA,CAAV;AACA8zB,YAAM7zB,CAAN,GAAUA,CAAV;AACA6zB,YAAM5U,KAAN,GAAcorF,IAAd;AACAx2E,YAAM3U,MAAN,GAAemrF,IAAf;AACD,KA3BqB;AA4BtB0H,YAAQ,gBAAUhyG,CAAV,EAAaC,CAAb,EAAgBya,CAAhB,EAAmBzW,CAAnB,EAAsB6vB,KAAtB,EAA6B;AACnC;AACAA,YAAM6iB,EAAN,GAAW32C,IAAI0a,IAAI,CAAnB;AACAoZ,YAAM8iB,EAAN,GAAW32C,IAAIgE,IAAI,CAAnB;AACA6vB,YAAM1gB,CAAN,GAAUzS,KAAKoB,GAAL,CAAS2Y,CAAT,EAAYzW,CAAZ,IAAiB,CAA3B;AACD,KAjCqB;AAkCtBguG,aAAS,iBAAUjyG,CAAV,EAAaC,CAAb,EAAgBya,CAAhB,EAAmBzW,CAAnB,EAAsB6vB,KAAtB,EAA6B;AACpCA,YAAM6iB,EAAN,GAAW32C,IAAI0a,IAAI,CAAnB;AACAoZ,YAAM8iB,EAAN,GAAW32C,IAAIgE,IAAI,CAAnB;AACA6vB,YAAM5U,KAAN,GAAcxE,CAAd;AACAoZ,YAAM3U,MAAN,GAAelb,CAAf;AACD,KAvCqB;AAwCtBiuG,SAAK,aAAUlyG,CAAV,EAAaC,CAAb,EAAgBya,CAAhB,EAAmBzW,CAAnB,EAAsB6vB,KAAtB,EAA6B;AAChCA,YAAM9zB,CAAN,GAAUA,IAAI0a,IAAI,CAAlB;AACAoZ,YAAM7zB,CAAN,GAAUA,IAAIgE,IAAI,CAAlB;AACA6vB,YAAM5U,KAAN,GAAcxE,CAAd;AACAoZ,YAAM3U,MAAN,GAAelb,CAAf;AACD,KA7CqB;AA8CtBkuG,WAAO,eAAUnyG,CAAV,EAAaC,CAAb,EAAgBya,CAAhB,EAAmBzW,CAAnB,EAAsB6vB,KAAtB,EAA6B;AAClCA,YAAM9zB,CAAN,GAAUA,IAAI0a,IAAI,CAAlB;AACAoZ,YAAM7zB,CAAN,GAAUA,IAAIgE,IAAI,CAAlB;AACA6vB,YAAM5U,KAAN,GAAcxE,CAAd;AACAoZ,YAAM3U,MAAN,GAAelb,CAAf;AACD,KAnDqB;AAoDtBmuG,cAAU,kBAAUpyG,CAAV,EAAaC,CAAb,EAAgBya,CAAhB,EAAmBzW,CAAnB,EAAsB6vB,KAAtB,EAA6B;AACrCA,YAAM6iB,EAAN,GAAW32C,IAAI0a,IAAI,CAAnB;AACAoZ,YAAM8iB,EAAN,GAAW32C,IAAIgE,IAAI,CAAnB;AACA6vB,YAAM5U,KAAN,GAAcxE,CAAd;AACAoZ,YAAM3U,MAAN,GAAelb,CAAf;AACD;AAzDqB,GAAxB;AA2DA,MAAIquG,qBAAqB,EAAzB;AACAr2G,SAAO41G,WAAP,EAAoB,UAAU73G,IAAV,EAAgBZ,IAAhB,EAAsB;AACxCk5G,uBAAmBl5G,IAAnB,IAA2B,IAAIY,IAAJ,EAA3B;AACD,GAFD;AAGA,MAAIu4G,YAAYjvD,YAAY;AAC1BrmD,UAAM,QADoB;AAE1B62B,WAAO;AACL0+E,kBAAY,EADP;AAELxyG,SAAG,CAFE;AAGLC,SAAG,CAHE;AAILif,aAAO,CAJF;AAKLC,cAAQ;AALH,KAFmB;AAS1B6Y,iBAAa,uBAAY;AACvB,UAAIxN,QAAQ,KAAKA,KAAjB;AACA,UAAIsJ,QAAQ,KAAKA,KAAjB,CAFuB,CAEC;;AAExB,UAAIA,MAAM0+E,UAAN,KAAqB,KAArB,IAA8BhoF,MAAM1B,YAAN,KAAuB,QAAzD,EAAmE;AACjE0B,cAAM1B,YAAN,GAAqB,CAAC,KAAD,EAAQ,KAAR,CAArB;AACA0B,cAAMvB,SAAN,GAAkB,QAAlB;AACAuB,cAAMtB,iBAAN,GAA0B,QAA1B;AACD;AACF,KAlByB;AAmB1B2K,eAAW,mBAAU3vB,GAAV,EAAe4vB,KAAf,EAAsB6nB,QAAtB,EAAgC;AACzC,UAAI62D,aAAa1+E,MAAM0+E,UAAvB;AACA,UAAIC,cAAcH,mBAAmBE,UAAnB,CAAlB;;AAEA,UAAI1+E,MAAM0+E,UAAN,KAAqB,MAAzB,EAAiC;AAC/B,YAAI,CAACC,WAAL,EAAkB;AAChB;AACAD,uBAAa,MAAb;AACAC,wBAAcH,mBAAmBE,UAAnB,CAAd;AACD;;AAEDH,0BAAkBG,UAAlB,EAA8B1+E,MAAM9zB,CAApC,EAAuC8zB,MAAM7zB,CAA7C,EAAgD6zB,MAAM5U,KAAtD,EAA6D4U,MAAM3U,MAAnE,EAA2EszF,YAAY3+E,KAAvF;AACA2+E,oBAAY5+E,SAAZ,CAAsB3vB,GAAtB,EAA2BuuG,YAAY3+E,KAAvC,EAA8C6nB,QAA9C;AACD;AACF;AAjCyB,GAAZ,CAAhB,CA5m7B4B,CA8o7BxB;;AAEJ,WAAS+2D,kBAAT,CAA4Bj9F,KAA5B,EAAmCk9F,UAAnC,EAA+C;AAC7C,QAAI,KAAK11G,IAAL,KAAc,OAAlB,EAA2B;AACzB,UAAI21G,cAAc,KAAKpoF,KAAvB;AACA,UAAIqoF,cAAc,KAAK/+E,KAAvB;;AAEA,UAAI++E,eAAeA,YAAYL,UAAZ,KAA2B,MAA9C,EAAsD;AACpDI,oBAAYrrF,MAAZ,GAAqB9R,KAArB;AACD,OAFD,MAEO,IAAI,KAAKq9F,cAAT,EAAyB;AAC9BF,oBAAYrrF,MAAZ,GAAqB9R,KAArB;AACAm9F,oBAAYtrF,IAAZ,GAAmBqrF,cAAc,MAAjC;AACD,OAHM,MAGA;AACL;AACAC,oBAAYtrF,IAAZ,KAAqBsrF,YAAYtrF,IAAZ,GAAmB7R,KAAxC;AACAm9F,oBAAYrrF,MAAZ,KAAuBqrF,YAAYrrF,MAAZ,GAAqB9R,KAA5C;AACD;;AAED,WAAK4H,KAAL,CAAW,KAAX;AACD;AACF;AACD;;;;;;;;;;;;AAaA,WAAS01F,YAAT,CAAsBP,UAAtB,EAAkCxyG,CAAlC,EAAqCC,CAArC,EAAwCya,CAAxC,EAA2CzW,CAA3C,EAA8CwR,KAA9C,EAAqDu9F,UAArD,EAAiE;AAC/D;AACA,QAAInmD,UAAU2lD,WAAWp3G,OAAX,CAAmB,OAAnB,MAAgC,CAA9C;;AAEA,QAAIyxD,OAAJ,EAAa;AACX2lD,mBAAaA,WAAWx+F,MAAX,CAAkB,CAAlB,EAAqB,CAArB,EAAwBF,WAAxB,KAAwC0+F,WAAWx+F,MAAX,CAAkB,CAAlB,CAArD;AACD;;AAED,QAAIi/F,UAAJ;;AAEA,QAAIT,WAAWp3G,OAAX,CAAmB,UAAnB,MAAmC,CAAvC,EAA0C;AACxC63G,mBAAapvD,UAAU2uD,WAAW35G,KAAX,CAAiB,CAAjB,CAAV,EAA+B,IAAIomB,YAAJ,CAAiBjf,CAAjB,EAAoBC,CAApB,EAAuBya,CAAvB,EAA0BzW,CAA1B,CAA/B,EAA6D+uG,aAAa,QAAb,GAAwB,OAArF,CAAb;AACD,KAFD,MAEO,IAAIR,WAAWp3G,OAAX,CAAmB,SAAnB,MAAkC,CAAtC,EAAyC;AAC9C63G,mBAAazvD,SAASgvD,WAAW35G,KAAX,CAAiB,CAAjB,CAAT,EAA8B,EAA9B,EAAkC,IAAIomB,YAAJ,CAAiBjf,CAAjB,EAAoBC,CAApB,EAAuBya,CAAvB,EAA0BzW,CAA1B,CAAlC,EAAgE+uG,aAAa,QAAb,GAAwB,OAAxF,CAAb;AACD,KAFM,MAEA;AACLC,mBAAa,IAAIV,SAAJ,CAAc;AACzBz+E,eAAO;AACL0+E,sBAAYA,UADP;AAELxyG,aAAGA,CAFE;AAGLC,aAAGA,CAHE;AAILif,iBAAOxE,CAJF;AAKLyE,kBAAQlb;AALH;AADkB,OAAd,CAAb;AASD;;AAEDgvG,eAAWH,cAAX,GAA4BjmD,OAA5B;AACAomD,eAAWC,QAAX,GAAsBR,kBAAtB;AACAO,eAAWC,QAAX,CAAoBz9F,KAApB;AACA,WAAOw9F,UAAP;AACD;;AAED;;;;;;;;;;;;;;;;;;AAkBA;;;;;;AAMA,WAASE,UAAT,CAAoBv4C,WAApB,EAAiC;AAC/B,WAAO2oC,oBAAoB3oC,YAAYgD,SAAZ,EAApB,EAA6ChD,WAA7C,CAAP;AACD,GA1u7B2B,CA0u7B1B;AACF,MAAIw4C,cAAc;AAChBjQ,wBAAoBA,kBADJ;AAEhBV,qBAAiBA,eAFD;AAGhBY,yBAAqBA;AAHL,GAAlB;AAKA;;;;;;AAMA,WAASgQ,WAAT,CAAqB5iD,UAArB,EAAiClnB,MAAjC,EAAyC;AACvC,QAAI+yB,YAAY/yB,MAAhB;;AAEA,QAAI,CAAC+iB,MAAM3f,UAAN,CAAiBpD,MAAjB,CAAL,EAA+B;AAC7B+yB,kBAAY,IAAIhQ,KAAJ,CAAU/iB,MAAV,CAAZ;AACAztC,YAAMwgE,SAAN,EAAiBy0C,oBAAjB;AACD;;AAED,QAAI7vG,QAAQsuG,mBAAmBlzC,SAAnB,CAAZ;AACAp7D,UAAMwjG,SAAN,CAAgBj0C,WAAW,CAAX,CAAhB,EAA+BA,WAAW,CAAX,CAA/B;AACA8+C,oBAAgBruG,KAAhB,EAAuBo7D,SAAvB;AACA,WAAOp7D,KAAP;AACD;AACD;;;;;;;;;;;;;AAaA,WAASoyG,2BAAT,CAAqCC,QAArC,EAA+C;AAC7Cz3G,UAAMy3G,QAAN,EAAgBxC,oBAAhB;AACD;;AAED,MAAIyC,SAAS,CAACr7G,OAAOsH,MAAP,IAAiBtH,MAAlB,EAA0B;AACtCg7G,gBAAYA,UAD0B;AAEtCn9C,mBAAeA,aAFuB;AAGtCoX,eAAWgmC,WAH2B;AAItCC,iBAAaA,WAJyB;AAKtCC,iCAA6BA,2BALS;AAMtC1S,wBAAoBA,kBANkB;AAOtC0B,sBAAkBA,gBAPoB;AAQtCyQ,kBAAcA;AARwB,GAA1B,CAAb;;AAWA,MAAIU,YAAY,IAAhB;;AAEA,WAASC,eAAT,CAAyBv0G,CAAzB,EAA4BC,CAA5B,EAA+B;AAC7B,WAAOuB,KAAKyzC,GAAL,CAASj1C,IAAIC,CAAb,IAAkBq0G,SAAzB;AACD;;AAED,WAASE,SAAT,CAAmBhwE,MAAnB,EAA2B3jC,CAA3B,EAA8BC,CAA9B,EAAiC;AAC/B,QAAIya,IAAI,CAAR;AACA,QAAIpM,IAAIq1B,OAAO,CAAP,CAAR;;AAEA,QAAI,CAACr1B,CAAL,EAAQ;AACN,aAAO,KAAP;AACD;;AAED,SAAK,IAAIzU,IAAI,CAAb,EAAgBA,IAAI8pC,OAAO5pC,MAA3B,EAAmCF,GAAnC,EAAwC;AACtC,UAAIse,KAAKwrB,OAAO9pC,CAAP,CAAT;AACA6gB,WAAKg/B,YAAYprC,EAAE,CAAF,CAAZ,EAAkBA,EAAE,CAAF,CAAlB,EAAwB6J,GAAG,CAAH,CAAxB,EAA+BA,GAAG,CAAH,CAA/B,EAAsCnY,CAAtC,EAAyCC,CAAzC,CAAL;AACAqO,UAAI6J,EAAJ;AACD,KAZ8B,CAY7B;;;AAGF,QAAIhB,KAAKwsB,OAAO,CAAP,CAAT;;AAEA,QAAI,CAAC+vE,gBAAgBplG,EAAE,CAAF,CAAhB,EAAsB6I,GAAG,CAAH,CAAtB,CAAD,IAAiC,CAACu8F,gBAAgBplG,EAAE,CAAF,CAAhB,EAAsB6I,GAAG,CAAH,CAAtB,CAAtC,EAAoE;AAClEuD,WAAKg/B,YAAYprC,EAAE,CAAF,CAAZ,EAAkBA,EAAE,CAAF,CAAlB,EAAwB6I,GAAG,CAAH,CAAxB,EAA+BA,GAAG,CAAH,CAA/B,EAAsCnX,CAAtC,EAAyCC,CAAzC,CAAL;AACD;;AAED,WAAOya,MAAM,CAAb;AACD;;AAED;;;;;;;;;;;;;;;;;;;AAmBA;;;AAGA;;;;;;AAMA,WAASk5F,MAAT,CAAgBx6G,IAAhB,EAAsBy6G,UAAtB,EAAkCC,EAAlC,EAAsC;AACpC;;;;AAIA,SAAK16G,IAAL,GAAYA,IAAZ;AACA;;;;;AAKA,SAAKy6G,UAAL,GAAkBA,UAAlB;;AAEA,QAAI,CAACC,EAAL,EAAS;AACP,UAAIxzF,OAAO,KAAKqB,eAAL,EAAX;AACAmyF,WAAK,CAACxzF,KAAKtgB,CAAL,GAASsgB,KAAKpB,KAAL,GAAa,CAAvB,EAA0BoB,KAAKrgB,CAAL,GAASqgB,KAAKnB,MAAL,GAAc,CAAjD,CAAL;AACD,KAHD,MAGO;AACL20F,WAAK,CAACA,GAAG,CAAH,CAAD,EAAQA,GAAG,CAAH,CAAR,CAAL;AACD;AACD;;;;AAKA,SAAKt/E,MAAL,GAAcs/E,EAAd;AACD;;AAEDF,SAAOx7G,SAAP,GAAmB;AACjB6B,iBAAa25G,MADI;AAEjB3lE,gBAAY,IAFK;;AAIjB;;;AAGAtsB,qBAAiB,2BAAY;AAC3B,UAAIrB,OAAO,KAAKsX,KAAhB;;AAEA,UAAItX,IAAJ,EAAU;AACR,eAAOA,IAAP;AACD;;AAED,UAAImrE,aAAavzC,OAAOC,SAAxB;AACA,UAAIrF,SAAS,CAAC24C,UAAD,EAAaA,UAAb,CAAb;AACA,UAAI14C,SAAS,CAAC,CAAC04C,UAAF,EAAc,CAACA,UAAf,CAAb;AACA,UAAI72C,OAAO,EAAX;AACA,UAAIC,OAAO,EAAX;AACA,UAAIg/D,aAAa,KAAKA,UAAtB;;AAEA,WAAK,IAAIh6G,IAAI,CAAb,EAAgBA,IAAIg6G,WAAW95G,MAA/B,EAAuCF,GAAvC,EAA4C;AAC1C;AACA,YAAIg6G,WAAWh6G,CAAX,EAAcoD,IAAd,KAAuB,SAA3B,EAAsC;AACpC;AACD,SAJyC,CAIxC;;;AAGF,YAAI82G,WAAWF,WAAWh6G,CAAX,EAAck6G,QAA7B;AACAlhE,mBAAWkhE,QAAX,EAAqBn/D,IAArB,EAA2BC,IAA3B;AACA9yC,YAAI+wC,MAAJ,EAAYA,MAAZ,EAAoB8B,IAApB;AACA5yC,YAAI+wC,MAAJ,EAAYA,MAAZ,EAAoB8B,IAApB;AACD,OAzB0B,CAyBzB;;;AAGF,UAAIh7C,MAAM,CAAV,EAAa;AACXi5C,eAAO,CAAP,IAAYA,OAAO,CAAP,IAAYC,OAAO,CAAP,IAAYA,OAAO,CAAP,IAAY,CAAhD;AACD;;AAED,aAAO,KAAKnb,KAAL,GAAa,IAAI3Y,YAAJ,CAAiB6zB,OAAO,CAAP,CAAjB,EAA4BA,OAAO,CAAP,CAA5B,EAAuCC,OAAO,CAAP,IAAYD,OAAO,CAAP,CAAnD,EAA8DC,OAAO,CAAP,IAAYD,OAAO,CAAP,CAA1E,CAApB;AACD,KAxCgB;;AA0CjB;;;;AAIAhqC,aAAS,iBAAUsvB,KAAV,EAAiB;AACxB,UAAI9X,OAAO,KAAKqB,eAAL,EAAX;AACA,UAAIkyF,aAAa,KAAKA,UAAtB;;AAEA,UAAI,CAACvzF,KAAKxX,OAAL,CAAasvB,MAAM,CAAN,CAAb,EAAuBA,MAAM,CAAN,CAAvB,CAAL,EAAuC;AACrC,eAAO,KAAP;AACD;;AAED47E,eAAS,KAAK,IAAIn6G,IAAI,CAAR,EAAWu9C,SAASy8D,WAAW95G,MAApC,EAA4CF,IAAIu9C,MAAhD,EAAwDv9C,GAAxD,EAA6D;AACpE;AACA,YAAIg6G,WAAWh6G,CAAX,EAAcoD,IAAd,KAAuB,SAA3B,EAAsC;AACpC;AACD;;AAED,YAAI82G,WAAWF,WAAWh6G,CAAX,EAAck6G,QAA7B;AACA,YAAIE,YAAYJ,WAAWh6G,CAAX,EAAco6G,SAA9B;;AAEA,YAAIN,UAAUI,QAAV,EAAoB37E,MAAM,CAAN,CAApB,EAA8BA,MAAM,CAAN,CAA9B,CAAJ,EAA6C;AAC3C;AACA,eAAK,IAAIvrB,IAAI,CAAb,EAAgBA,KAAKonG,YAAYA,UAAUl6G,MAAtB,GAA+B,CAApC,CAAhB,EAAwD8S,GAAxD,EAA6D;AAC3D,gBAAI8mG,UAAUM,UAAUpnG,CAAV,CAAV,CAAJ,EAA6B;AAC3B,uBAASmnG,OAAT;AACD;AACF;;AAED,iBAAO,IAAP;AACD;AACF;;AAED,aAAO,KAAP;AACD,KA5EgB;AA6EjBE,iBAAa,qBAAUl0G,CAAV,EAAaC,CAAb,EAAgBif,KAAhB,EAAuBC,MAAvB,EAA+B;AAC1C,UAAImB,OAAO,KAAKqB,eAAL,EAAX;AACA,UAAI+W,SAASpY,KAAKpB,KAAL,GAAaoB,KAAKnB,MAA/B;;AAEA,UAAI,CAACD,KAAL,EAAY;AACVA,gBAAQwZ,SAASvZ,MAAjB;AACD,OAFD,MAEO,IAAI,CAACA,MAAL,EAAa;AAClBA,iBAASD,QAAQwZ,MAAjB;AACD;;AAED,UAAIn+B,SAAS,IAAI0kB,YAAJ,CAAiBjf,CAAjB,EAAoBC,CAApB,EAAuBif,KAAvB,EAA8BC,MAA9B,CAAb;AACA,UAAI1T,YAAY6U,KAAKV,kBAAL,CAAwBrlB,MAAxB,CAAhB;AACA,UAAIs5G,aAAa,KAAKA,UAAtB;;AAEA,WAAK,IAAIh6G,IAAI,CAAb,EAAgBA,IAAIg6G,WAAW95G,MAA/B,EAAuCF,GAAvC,EAA4C;AAC1C;AACA,YAAIg6G,WAAWh6G,CAAX,EAAcoD,IAAd,KAAuB,SAA3B,EAAsC;AACpC;AACD;;AAED,YAAI82G,WAAWF,WAAWh6G,CAAX,EAAck6G,QAA7B;AACA,YAAIE,YAAYJ,WAAWh6G,CAAX,EAAco6G,SAA9B;;AAEA,aAAK,IAAI3lG,IAAI,CAAb,EAAgBA,IAAIylG,SAASh6G,MAA7B,EAAqCuU,GAArC,EAA0C;AACxCzM,yBAAekyG,SAASzlG,CAAT,CAAf,EAA4BylG,SAASzlG,CAAT,CAA5B,EAAyC7C,SAAzC;AACD;;AAED,aAAK,IAAIxH,IAAI,CAAb,EAAgBA,KAAKgwG,YAAYA,UAAUl6G,MAAtB,GAA+B,CAApC,CAAhB,EAAwDkK,GAAxD,EAA6D;AAC3D,eAAK,IAAIqK,IAAI,CAAb,EAAgBA,IAAI2lG,UAAUhwG,CAAV,EAAalK,MAAjC,EAAyCuU,GAAzC,EAA8C;AAC5CzM,2BAAeoyG,UAAUhwG,CAAV,EAAaqK,CAAb,CAAf,EAAgC2lG,UAAUhwG,CAAV,EAAaqK,CAAb,CAAhC,EAAiD7C,SAAjD;AACD;AACF;AACF;;AAED6U,aAAO,KAAKsX,KAAZ;AACAtX,WAAKngB,IAAL,CAAU5F,MAAV,EAnC0C,CAmCvB;;AAEnB,WAAKi6B,MAAL,GAAc,CAAClU,KAAKtgB,CAAL,GAASsgB,KAAKpB,KAAL,GAAa,CAAvB,EAA0BoB,KAAKrgB,CAAL,GAASqgB,KAAKnB,MAAL,GAAc,CAAjD,CAAd;AACD;AAnHgB,GAAnB;;AAsHA;;;;;;;;;;;;;;;;;;;AAmBA;;;;AAIA,WAASg1F,MAAT,CAAgBC,IAAhB,EAAsB;AACpB,QAAI,CAACA,KAAKC,YAAV,EAAwB;AACtB,aAAOD,IAAP;AACD;;AAED,QAAIE,cAAcF,KAAKG,SAAvB;;AAEA,QAAID,eAAe,IAAnB,EAAyB;AACvBA,oBAAc,IAAd;AACD;;AAED,QAAI5gB,WAAW0gB,KAAK1gB,QAApB;;AAEA,SAAK,IAAI/gF,IAAI,CAAb,EAAgBA,IAAI+gF,SAAS35F,MAA7B,EAAqC4Y,GAArC,EAA0C;AACxC,UAAI45D,UAAUmnB,SAAS/gF,CAAT,CAAd;AACA,UAAI6hG,WAAWjoC,QAAQioC,QAAvB;AACA,UAAIC,cAAcD,SAASC,WAA3B;AACA,UAAIC,gBAAgBF,SAASE,aAA7B;;AAEA,WAAK,IAAI7kE,IAAI,CAAb,EAAgBA,IAAI4kE,YAAY16G,MAAhC,EAAwC81C,GAAxC,EAA6C;AAC3C,YAAI8kE,aAAaF,YAAY5kE,CAAZ,CAAjB;;AAEA,YAAI2kE,SAASv3G,IAAT,KAAkB,SAAtB,EAAiC;AAC/Bw3G,sBAAY5kE,CAAZ,IAAiB+kE,cAAcD,UAAd,EAA0BD,cAAc7kE,CAAd,CAA1B,EAA4CykE,WAA5C,CAAjB;AACD,SAFD,MAEO,IAAIE,SAASv3G,IAAT,KAAkB,cAAtB,EAAsC;AAC3C,eAAK,IAAI43G,KAAK,CAAd,EAAiBA,KAAKF,WAAW56G,MAAjC,EAAyC86G,IAAzC,EAA+C;AAC7C,gBAAIx3B,UAAUs3B,WAAWE,EAAX,CAAd;AACAF,uBAAWE,EAAX,IAAiBD,cAAcv3B,OAAd,EAAuBq3B,cAAc7kE,CAAd,EAAiBglE,EAAjB,CAAvB,EAA6CP,WAA7C,CAAjB;AACD;AACF;AACF;AACF,KA/BmB,CA+BlB;;;AAGFF,SAAKC,YAAL,GAAoB,KAApB;AACA,WAAOD,IAAP;AACD;;AAED,WAASQ,aAAT,CAAuBD,UAAvB,EAAmCD,aAAnC,EAAkDJ,WAAlD,EAA+D;AAC7D,QAAI76G,SAAS,EAAb;AACA,QAAIq7G,QAAQJ,cAAc,CAAd,CAAZ;AACA,QAAIK,QAAQL,cAAc,CAAd,CAAZ;;AAEA,SAAK,IAAI76G,IAAI,CAAb,EAAgBA,IAAI86G,WAAW56G,MAA/B,EAAuCF,KAAK,CAA5C,EAA+C;AAC7C,UAAImG,IAAI20G,WAAWhjF,UAAX,CAAsB93B,CAAtB,IAA2B,EAAnC;AACA,UAAIoG,IAAI00G,WAAWhjF,UAAX,CAAsB93B,IAAI,CAA1B,IAA+B,EAAvC,CAF6C,CAEF;;AAE3CmG,UAAIA,KAAK,CAAL,GAAS,EAAEA,IAAI,CAAN,CAAb;AACAC,UAAIA,KAAK,CAAL,GAAS,EAAEA,IAAI,CAAN,CAAb,CAL6C,CAKtB;;AAEvBD,WAAK80G,KAAL;AACA70G,WAAK80G,KAAL;AACAD,cAAQ90G,CAAR;AACA+0G,cAAQ90G,CAAR,CAV6C,CAUlC;;AAEXxG,aAAO4C,IAAP,CAAY,CAAC2D,IAAIs0G,WAAL,EAAkBr0G,IAAIq0G,WAAtB,CAAZ;AACD;;AAED,WAAO76G,MAAP;AACD;AACD;;;;;;AAOA,MAAIu7G,eAAe,SAAfA,YAAe,CAAUxhB,OAAV,EAAmB;AACpC2gB,WAAO3gB,OAAP;AACA,WAAOz6F,IAAIJ,OAAO66F,QAAQE,QAAf,EAAyB,UAAUuhB,UAAV,EAAsB;AACxD;AACA,aAAOA,WAAWT,QAAX,IAAuBS,WAAWhnE,UAAlC,IAAgDgnE,WAAWT,QAAX,CAAoBC,WAApB,CAAgC16G,MAAhC,GAAyC,CAAhG;AACD,KAHU,CAAJ,EAGH,UAAUk7G,UAAV,EAAsB;AACxB,UAAIhnE,aAAagnE,WAAWhnE,UAA5B;AACA,UAAI8tB,MAAMk5C,WAAWT,QAArB;AACA,UAAIC,cAAc14C,IAAI04C,WAAtB;AACA,UAAIZ,aAAa,EAAjB;;AAEA,UAAI93C,IAAI9+D,IAAJ,KAAa,SAAjB,EAA4B;AAC1B42G,mBAAWx3G,IAAX,CAAgB;AACdY,gBAAM,SADQ;AAEd;AACA;AACA82G,oBAAUU,YAAY,CAAZ,CAJI;AAKdR,qBAAWQ,YAAY57G,KAAZ,CAAkB,CAAlB;AALG,SAAhB;AAOD;;AAED,UAAIkjE,IAAI9+D,IAAJ,KAAa,cAAjB,EAAiC;AAC/BhB,eAAOw4G,WAAP,EAAoB,UAAU7qE,IAAV,EAAgB;AAClC,cAAIA,KAAK,CAAL,CAAJ,EAAa;AACXiqE,uBAAWx3G,IAAX,CAAgB;AACdY,oBAAM,SADQ;AAEd82G,wBAAUnqE,KAAK,CAAL,CAFI;AAGdqqE,yBAAWrqE,KAAK/wC,KAAL,CAAW,CAAX;AAHG,aAAhB;AAKD;AACF,SARD;AASD;;AAED,UAAIq8G,SAAS,IAAItB,MAAJ,CAAW3lE,WAAW70C,IAAtB,EAA4By6G,UAA5B,EAAwC5lE,WAAW6lE,EAAnD,CAAb;AACAoB,aAAOjnE,UAAP,GAAoBA,UAApB;AACA,aAAOinE,MAAP;AACD,KAlCM,CAAP;AAmCD,GArCD;;AAuCA;;;;;;;;;;;;;;;;;;AAkBA,MAAIC,UAAU3qE,WAAd;AACA;;;;;;;;;;;;AAYA,WAAS4qE,gBAAT,CAA0BrN,IAA1B,EAAgC;AAC9B;AACA,WAAOA,KAAK9qG,IAAL,KAAc,UAAd,GAA2Bo4G,mBAAmBtN,IAAnB,CAA3B,GAAsDuN,qBAAqBvN,IAArB,CAA7D;AACD;AACD;;;;;;;;;AASA,WAASwN,eAAT,CAAyBxN,IAAzB,EAA+ByN,SAA/B,EAA0C;AACxC;AACA,WAAOzN,KAAK9qG,IAAL,KAAc,UAAd,GAA2Bw4G,kBAAkB1N,IAAlB,EAAwByN,SAAxB,CAA3B,GAAgE;AACrExP,aAAO+B,KAAK7mG,KAAL,CAAW6kG,QAAX;AAD8D,KAAvE;AAGD;;AAED,WAASsP,kBAAT,CAA4BtN,IAA5B,EAAkC;AAChC,QAAI//C,aAAa+/C,KAAK6H,aAAL,EAAjB;AACA,QAAIn2G,SAASi8G,2BAA2B3N,IAA3B,EAAiC//C,UAAjC,CAAb;AACA,WAAO,CAACA,WAAWjpD,GAAX,CAAe,MAAf,CAAD,IAA2BgpG,KAAK7mG,KAAL,CAAW0jG,OAAX,EAA3B,GAAkD;AACvD+Q,cAAQ,EAD+C;AAEvDC,6BAAuBn8G,OAAOm8G;AAFyB,KAAlD,GAGHn8G,MAHJ;AAID;;AAED,WAASi8G,0BAAT,CAAoC3N,IAApC,EAA0C//C,UAA1C,EAAsD;AACpD,QAAI6tD,cAAcC,aAAa/N,IAAb,EAAmB,QAAnB,CAAlB;AACA,QAAIgO,sBAAsBC,0BAA0BhuD,UAA1B,CAA1B;AACA,QAAIvuD,SAASw8G,aAAaJ,WAAb,EAA0BE,mBAA1B,CAAb;;AAEA,QAAIt8G,MAAJ,EAAY;AACV,aAAOA,MAAP;AACD;;AAED,QAAIk8G,MAAJ;AACA,QAAIO,oBAAJ;;AAEA,QAAIn5G,aAAag5G,mBAAb,CAAJ,EAAuC;AACrCJ,eAASQ,uCAAuCpO,IAAvC,EAA6CgO,mBAA7C,CAAT;AACD,KAFD,MAEO;AACLG,6BAAuBH,wBAAwB,MAAxB,GAAiCK,yBAAyBrO,IAAzB,CAAjC,GAAkEgO,mBAAzF;AACAJ,eAASU,oCAAoCtO,IAApC,EAA0CmO,oBAA1C,CAAT;AACD,KAjBmD,CAiBlD;;;AAGF,WAAOI,aAAaT,WAAb,EAA0BE,mBAA1B,EAA+C;AACpDJ,cAAQA,MAD4C;AAEpDC,6BAAuBM;AAF6B,KAA/C,CAAP;AAID;;AAED,WAAST,iBAAT,CAA2B1N,IAA3B,EAAiCyN,SAAjC,EAA4C;AAC1C,QAAIe,aAAaT,aAAa/N,IAAb,EAAmB,OAAnB,CAAjB;AACA,QAAIyO,qBAAqBR,0BAA0BR,SAA1B,CAAzB;AACA,QAAI/7G,SAASw8G,aAAaM,UAAb,EAAyBC,kBAAzB,CAAb;;AAEA,QAAI/8G,MAAJ,EAAY;AACV,aAAOA,MAAP;AACD;;AAED,QAAIusG,KAAJ;AACA,QAAIyQ,oBAAJ,CAV0C,CAUhB;AAC1B;;AAEA,QAAI,CAACjB,UAAUz2G,GAAV,CAAc,MAAd,CAAD,IAA0BgpG,KAAK7mG,KAAL,CAAW0jG,OAAX,EAA9B,EAAoD;AAClDoB,cAAQ,EAAR;AACD;;AAED,QAAIjpG,aAAay5G,kBAAb,CAAJ,EAAsC;AACpCxQ,cAAQmQ,uCAAuCpO,IAAvC,EAA6CyO,kBAA7C,EAAiE,IAAjE,CAAR;AACD,KAFD,CAEE;AACF;AACA;AAJA,SAKK,IAAIA,uBAAuB,MAA3B,EAAmC;AACpC,YAAIE,eAAehB,2BAA2B3N,IAA3B,EAAiCA,KAAK6H,aAAL,EAAjC,CAAnB;AACA6G,+BAAuBC,aAAad,qBAApC;AACA5P,gBAAQjtG,IAAI29G,aAAaf,MAAjB,EAAyB,UAAUgB,SAAV,EAAqB;AACpD,iBAAOA,UAAU7G,SAAjB;AACD,SAFO,CAAR;AAGD,OANE,MAMI;AACL2G,+BAAuBD,kBAAvB;AACAxQ,gBAAQqQ,oCAAoCtO,IAApC,EAA0C0O,oBAA1C,EAAgE,IAAhE,CAAR;AACD,OA/BuC,CA+BtC;;;AAGJ,WAAOH,aAAaC,UAAb,EAAyBC,kBAAzB,EAA6C;AAClDxQ,aAAOA,KAD2C;AAElDyQ,4BAAsBA;AAF4B,KAA7C,CAAP;AAID;;AAED,WAASnB,oBAAT,CAA8BvN,IAA9B,EAAoC;AAClC,QAAI/B,QAAQ+B,KAAK7mG,KAAL,CAAW6kG,QAAX,EAAZ;AACA,QAAI4J,iBAAiBD,mBAAmB3H,IAAnB,CAArB;AACA,WAAO;AACL4N,cAAQ58G,IAAIitG,KAAJ,EAAW,UAAU8J,SAAV,EAAqBhvF,GAArB,EAA0B;AAC3C,eAAO;AACL81F,0BAAgBjH,eAAeG,SAAf,EAA0BhvF,GAA1B,CADX;AAEL+1F,oBAAU9O,KAAK7mG,KAAL,CAAW6jG,QAAX,CAAoB+K,SAApB,CAFL;AAGLA,qBAAWA;AAHN,SAAP;AAKD,OANO;AADH,KAAP;AASD,GArv8B2B,CAqv8B1B;AACF;AACA;;;AAGA,WAASgG,YAAT,CAAsB/N,IAAtB,EAA4BnsG,IAA5B,EAAkC;AAChC;AACA,WAAOu5G,QAAQpN,IAAR,EAAcnsG,IAAd,MAAwBu5G,QAAQpN,IAAR,EAAcnsG,IAAd,IAAsB,EAA9C,CAAP;AACD;;AAED,WAASq6G,YAAT,CAAsBa,KAAtB,EAA6B18G,GAA7B,EAAkC;AAChC,SAAK,IAAIP,IAAI,CAAb,EAAgBA,IAAIi9G,MAAM/8G,MAA1B,EAAkCF,GAAlC,EAAuC;AACrC,UAAIi9G,MAAMj9G,CAAN,EAASO,GAAT,KAAiBA,GAArB,EAA0B;AACxB,eAAO08G,MAAMj9G,CAAN,EAASyB,KAAhB;AACD;AACF;AACF;;AAED,WAASg7G,YAAT,CAAsBQ,KAAtB,EAA6B18G,GAA7B,EAAkCkB,KAAlC,EAAyC;AACvCw7G,UAAMz6G,IAAN,CAAW;AACTjC,WAAKA,GADI;AAETkB,aAAOA;AAFE,KAAX;AAIA,WAAOA,KAAP;AACD;;AAED,WAAS86G,wBAAT,CAAkCrO,IAAlC,EAAwC;AACtC,QAAItuG,SAAS07G,QAAQpN,IAAR,EAAcgP,YAA3B;AACA,WAAOt9G,UAAU,IAAV,GAAiBA,MAAjB,GAA0B07G,QAAQpN,IAAR,EAAcgP,YAAd,GAA6BhP,KAAKiP,yBAAL,EAA9D;AACD;AACD;;;;;;AAOA,WAASA,0BAAT,CAAmCjP,IAAnC,EAAyC;AACvC,QAAI3zF,SAAS6iG,2CAA2ClP,IAA3C,CAAb;AACA,QAAI4H,iBAAiBD,mBAAmB3H,IAAnB,CAArB;AACA,QAAIz8F,WAAW,CAAC8I,OAAO8iG,UAAP,GAAoB9iG,OAAO+zC,WAA5B,IAA2C,GAA3C,GAAiDxnD,KAAKgN,EAArE;AACA,QAAIwpG,eAAepP,KAAK7mG,KAAxB;AACA,QAAIk2G,gBAAgBD,aAAa1S,SAAb,EAApB,CALuC,CAKO;AAC9C;AACA;;AAEA,QAAIyL,YAAYiH,aAAaz5F,KAAb,EAAhB;;AAEA,QAAI05F,cAAc,CAAd,IAAmBA,cAAc,CAAd,CAAnB,GAAsC,CAA1C,EAA6C;AAC3C,aAAO,CAAP;AACD;;AAED,QAAIrnG,OAAO,CAAX,CAfuC,CAezB;;AAEd,QAAImgG,YAAY,EAAhB,EAAoB;AAClBngG,aAAOpP,KAAKqB,GAAL,CAAS,CAAT,EAAYrB,KAAKuV,KAAL,CAAWg6F,YAAY,EAAvB,CAAZ,CAAP;AACD;;AAED,QAAIJ,YAAYsH,cAAc,CAAd,CAAhB;AACA,QAAIC,WAAWtP,KAAK0D,WAAL,CAAiBqE,YAAY,CAA7B,IAAkC/H,KAAK0D,WAAL,CAAiBqE,SAAjB,CAAjD;AACA,QAAIwH,QAAQ32G,KAAKyzC,GAAL,CAASijE,WAAW12G,KAAK6J,GAAL,CAASc,QAAT,CAApB,CAAZ;AACA,QAAIisG,QAAQ52G,KAAKyzC,GAAL,CAASijE,WAAW12G,KAAK2J,GAAL,CAASgB,QAAT,CAApB,CAAZ;AACA,QAAIksG,OAAO,CAAX;AACA,QAAIC,OAAO,CAAX,CA1BuC,CA0BzB;AACd;;AAEA,WAAO3H,aAAasH,cAAc,CAAd,CAApB,EAAsCtH,aAAa//F,IAAnD,EAAyD;AACvD,UAAImP,QAAQ,CAAZ;AACA,UAAIC,SAAS,CAAb,CAFuD,CAEvC;AAChB;AACA;;AAEA,UAAImB,OAAOqB,iBAAgBguF,eAAeG,SAAf,CAAhB,EAA2C17F,OAAO6T,IAAlD,EAAwD,QAAxD,EAAkE,KAAlE,CAAX,CANuD,CAM8B;;AAErF/I,cAAQoB,KAAKpB,KAAL,GAAa,GAArB;AACAC,eAASmB,KAAKnB,MAAL,GAAc,GAAvB,CATuD,CAS3B;;AAE5Bq4F,aAAO72G,KAAKqB,GAAL,CAASw1G,IAAT,EAAet4F,KAAf,EAAsB,CAAtB,CAAP;AACAu4F,aAAO92G,KAAKqB,GAAL,CAASy1G,IAAT,EAAet4F,MAAf,EAAuB,CAAvB,CAAP;AACD;;AAED,QAAIu4F,KAAKF,OAAOF,KAAhB;AACA,QAAIK,KAAKF,OAAOF,KAAhB,CA7CuC,CA6ChB;;AAEvBv/F,UAAM0/F,EAAN,MAAcA,KAAK/lE,QAAnB;AACA35B,UAAM2/F,EAAN,MAAcA,KAAKhmE,QAAnB;AACA,QAAID,WAAW/wC,KAAKqB,GAAL,CAAS,CAAT,EAAYrB,KAAKuV,KAAL,CAAWvV,KAAKoB,GAAL,CAAS21G,EAAT,EAAaC,EAAb,CAAX,CAAZ,CAAf;AACA,QAAIb,QAAQ3B,QAAQpN,KAAK75D,KAAb,CAAZ;AACA,QAAI0pE,mBAAmBd,MAAMc,gBAA7B;AACA,QAAIC,gBAAgBf,MAAMe,aAA1B,CApDuC,CAoDE;AACzC;AACA;;AAEA,QAAID,oBAAoB,IAApB,IAA4BC,iBAAiB,IAA7C,IAAqDl3G,KAAKyzC,GAAL,CAASwjE,mBAAmBlmE,QAA5B,KAAyC,CAA9F,IAAmG/wC,KAAKyzC,GAAL,CAASyjE,gBAAgB3H,SAAzB,KAAuC,CAA1I,CAA4I;AAChJ;AADI,OAED0H,mBAAmBlmE,QAFtB,EAEgC;AAC9BA,iBAAWkmE,gBAAX;AACD,KAJD,CAIE;AACF;AALA,SAMK;AACDd,cAAMe,aAAN,GAAsB3H,SAAtB;AACA4G,cAAMc,gBAAN,GAAyBlmE,QAAzB;AACD;;AAEH,WAAOA,QAAP;AACD;;AAED,WAASulE,0CAAT,CAAoDlP,IAApD,EAA0D;AACxD,QAAI//C,aAAa+/C,KAAK6H,aAAL,EAAjB;AACA,WAAO;AACLsH,kBAAYnP,KAAK+P,SAAL,GAAiB/P,KAAK+P,SAAL,EAAjB,GAAoC/P,KAAK4C,YAAL,IAAqB,CAAC5C,KAAK4C,YAAL,EAAtB,GAA4C,EAA5C,GAAiD,CAD5F;AAELxiD,mBAAaH,WAAWjpD,GAAX,CAAe,QAAf,KAA4B,CAFpC;AAGLkpB,YAAM+/B,WAAWoB,OAAX;AAHD,KAAP;AAKD;;AAED,WAASitD,mCAAT,CAA6CtO,IAA7C,EAAmDgQ,gBAAnD,EAAqEC,QAArE,EAA+E;AAC7E,QAAIrI,iBAAiBD,mBAAmB3H,IAAnB,CAArB;AACA,QAAIoP,eAAepP,KAAK7mG,KAAxB;AACA,QAAIk2G,gBAAgBD,aAAa1S,SAAb,EAApB;AACA,QAAIz8C,aAAa+/C,KAAK6H,aAAL,EAAjB;AACA,QAAIn2G,SAAS,EAAb,CAL6E,CAK5D;;AAEjB,QAAIsW,OAAOpP,KAAKqB,GAAL,CAAS,CAAC+1G,oBAAoB,CAArB,IAA0B,CAAnC,EAAsC,CAAtC,CAAX;AACA,QAAIE,YAAYb,cAAc,CAAd,CAAhB;AACA,QAAIlH,YAAYiH,aAAaz5F,KAAb,EAAhB,CAT6E,CASvC;AACtC;AACA;AACA;;AAEA,QAAIu6F,cAAc,CAAd,IAAmBloG,OAAO,CAA1B,IAA+BmgG,YAAYngG,IAAZ,GAAmB,CAAtD,EAAyD;AACvDkoG,kBAAYt3G,KAAK6R,KAAL,CAAW7R,KAAKyV,IAAL,CAAU6hG,YAAYloG,IAAtB,IAA8BA,IAAzC,CAAZ;AACD,KAhB4E,CAgB3E;AACF;AACA;AACA;AACA;;;AAGA,QAAImoG,aAAa;AACfn2G,WAAKimD,WAAWjpD,GAAX,CAAe,cAAf,CADU;AAEfiD,WAAKgmD,WAAWjpD,GAAX,CAAe,cAAf;AAFU,KAAjB;;AAKA,QAAIm5G,WAAWn2G,GAAX,IAAkBk2G,cAAcb,cAAc,CAAd,CAApC,EAAsD;AACpDe,cAAQf,cAAc,CAAd,CAAR;AACD,KA9B4E,CA8B3E;;;AAGF,QAAItH,YAAYmI,SAAhB;;AAEA,WAAOnI,aAAasH,cAAc,CAAd,CAApB,EAAsCtH,aAAa//F,IAAnD,EAAyD;AACvDooG,cAAQrI,SAAR;AACD;;AAED,QAAIoI,WAAWl2G,GAAX,IAAkB8tG,cAAcsH,cAAc,CAAd,CAApC,EAAsD;AACpDe,cAAQf,cAAc,CAAd,CAAR;AACD;;AAED,aAASe,OAAT,CAAiBC,IAAjB,EAAuB;AACrB3+G,aAAO4C,IAAP,CAAY27G,WAAWI,IAAX,GAAkB;AAC5BxB,wBAAgBjH,eAAeyI,IAAf,CADY;AAE5BvB,kBAAUM,aAAapS,QAAb,CAAsBqT,IAAtB,CAFkB;AAG5BtI,mBAAWsI;AAHiB,OAA9B;AAKD;;AAED,WAAO3+G,MAAP;AACD,GA758B2B,CA658B1B;AACF;;;AAGA,WAAS08G,sCAAT,CAAgDpO,IAAhD,EAAsDgQ,gBAAtD,EAAwEC,QAAxE,EAAkF;AAChF,QAAIb,eAAepP,KAAK7mG,KAAxB;AACA,QAAIyuG,iBAAiBD,mBAAmB3H,IAAnB,CAArB;AACA,QAAItuG,SAAS,EAAb;AACAwC,WAAOk7G,aAAapR,QAAb,EAAP,EAAgC,UAAU+J,SAAV,EAAqB;AACnD,UAAI+G,WAAWM,aAAapS,QAAb,CAAsB+K,SAAtB,CAAf;;AAEA,UAAIiI,iBAAiBjI,SAAjB,EAA4B+G,QAA5B,CAAJ,EAA2C;AACzCp9G,eAAO4C,IAAP,CAAY27G,WAAWlI,SAAX,GAAuB;AACjC8G,0BAAgBjH,eAAeG,SAAf,CADiB;AAEjC+G,oBAAUA,QAFuB;AAGjC/G,qBAAWA;AAHsB,SAAnC;AAKD;AACF,KAVD;AAWA,WAAOr2G,MAAP;AACD,GAj78B2B,CAi78B1B;;;AAGF,WAASu8G,yBAAT,CAAmC9nE,KAAnC,EAA0C;AACxC,QAAIwD,WAAWxD,MAAMnvC,GAAN,CAAU,UAAV,CAAf;AACA,WAAO2yC,YAAY,IAAZ,GAAmB,MAAnB,GAA4BA,QAAnC;AACD;;AAED;;;;;;;;;;;;;;;;;;AAkBA,MAAI2mE,oBAAoB,CAAC,CAAD,EAAI,CAAJ,CAAxB;AACA;;;;;AAKA,MAAIC,OAAO,SAAPA,IAAO,CAAUz5C,GAAV,EAAe39D,KAAf,EAAsB27F,MAAtB,EAA8B;AACvC;;;;AAIA,SAAKh+B,GAAL,GAAWA,GAAX;AACA;;;;;AAKA,SAAK39D,KAAL,GAAaA,KAAb;AACA;;;;;AAKA,SAAK83F,OAAL,GAAe6D,UAAU,CAAC,CAAD,EAAI,CAAJ,CAAzB;AACA;;;;AAIA,SAAK0b,OAAL,GAAe,KAAf;AACA;;;;;AAKA,SAAKC,MAAL,GAAc,KAAd;AACD,GA7BD;;AA+BAF,OAAKlgH,SAAL,GAAiB;AACf6B,iBAAaq+G,IADE;;AAGf;;;;;AAKAxvG,aAAS,iBAAUsvB,KAAV,EAAiB;AACxB,UAAIykE,SAAS,KAAK7D,OAAlB;AACA,UAAIj3F,MAAMpB,KAAKoB,GAAL,CAAS86F,OAAO,CAAP,CAAT,EAAoBA,OAAO,CAAP,CAApB,CAAV;AACA,UAAI76F,MAAMrB,KAAKqB,GAAL,CAAS66F,OAAO,CAAP,CAAT,EAAoBA,OAAO,CAAP,CAApB,CAAV;AACA,aAAOzkE,SAASr2B,GAAT,IAAgBq2B,SAASp2B,GAAhC;AACD,KAbc;;AAef;;;;;AAKAy2G,iBAAa,qBAAUz8G,IAAV,EAAgB;AAC3B,aAAO,KAAK8M,OAAL,CAAa,KAAK2iG,WAAL,CAAiBzvG,IAAjB,CAAb,CAAP;AACD,KAtBc;;AAwBf;;;;AAIAyoG,eAAW,qBAAY;AACrB,aAAO,KAAKzL,OAAL,CAAangG,KAAb,EAAP;AACD,KA9Bc;;AAgCf;;;;;AAKA23D,uBAAmB,2BAAUC,UAAV,EAAsB;AACvC,aAAOD,mBAAkBC,cAAc,KAAKvvD,KAAL,CAAWujG,SAAX,EAAhC,EAAwD,KAAKzL,OAA7D,CAAP;AACD,KAvCc;;AAyCf;;;;;AAKA0L,eAAW,mBAAUjqF,KAAV,EAAiBk4B,GAAjB,EAAsB;AAC/B,UAAIkqD,SAAS,KAAK7D,OAAlB;AACA6D,aAAO,CAAP,IAAYpiF,KAAZ;AACAoiF,aAAO,CAAP,IAAYlqD,GAAZ;AACD,KAlDc;;AAoDf;;;;;;AAMA84D,iBAAa,qBAAUzvG,IAAV,EAAgB0zD,KAAhB,EAAuB;AAClC,UAAImtC,SAAS,KAAK7D,OAAlB;AACA,UAAI93F,QAAQ,KAAKA,KAAjB;AACAlF,aAAOkF,MAAME,SAAN,CAAgBpF,IAAhB,CAAP;;AAEA,UAAI,KAAKw8G,MAAL,IAAet3G,MAAMjE,IAAN,KAAe,SAAlC,EAA6C;AAC3C4/F,iBAASA,OAAOhkG,KAAP,EAAT;AACA6/G,2BAAmB7b,MAAnB,EAA2B37F,MAAMwc,KAAN,EAA3B;AACD;;AAED,aAAO8xC,UAAUxzD,IAAV,EAAgBq8G,iBAAhB,EAAmCxb,MAAnC,EAA2CntC,KAA3C,CAAP;AACD,KArEc;;AAuEf;;;;;;AAMAipD,iBAAa,qBAAUvgF,KAAV,EAAiBs3B,KAAjB,EAAwB;AACnC,UAAImtC,SAAS,KAAK7D,OAAlB;AACA,UAAI93F,QAAQ,KAAKA,KAAjB;;AAEA,UAAI,KAAKs3G,MAAL,IAAet3G,MAAMjE,IAAN,KAAe,SAAlC,EAA6C;AAC3C4/F,iBAASA,OAAOhkG,KAAP,EAAT;AACA6/G,2BAAmB7b,MAAnB,EAA2B37F,MAAMwc,KAAN,EAA3B;AACD;;AAED,UAAI9b,IAAI4tD,UAAUp3B,KAAV,EAAiBykE,MAAjB,EAAyBwb,iBAAzB,EAA4C3oD,KAA5C,CAAR;AACA,aAAO,KAAKxuD,KAAL,CAAWA,KAAX,CAAiBU,CAAjB,CAAP;AACD,KAxFc;;AA0Ff;;;;;;AAMAg3G,iBAAa,qBAAUj4D,KAAV,EAAiB+O,KAAjB,EAAwB,CAAC;AACrC,KAjGc;;AAmGf;;;;;;;;;;;;;;AAcAmpD,oBAAgB,wBAAUnwE,GAAV,EAAe;AAC7BA,YAAMA,OAAO,EAAb;AACA,UAAI8sE,YAAY9sE,IAAI8sE,SAAJ,IAAiB,KAAKsD,YAAL,EAAjC;AACA,UAAIr/G,SAAS87G,gBAAgB,IAAhB,EAAsBC,SAAtB,CAAb;AACA,UAAIxP,QAAQvsG,OAAOusG,KAAnB;AACA,UAAI+S,cAAchgH,IAAIitG,KAAJ,EAAW,UAAU8J,SAAV,EAAqB;AAChD,eAAO;AACL13E,iBAAO,KAAKqzE,WAAL,CAAiBqE,SAAjB,CADF;AAELA,qBAAWA;AAFN,SAAP;AAID,OALiB,EAKf,IALe,CAAlB;AAMA,UAAIkJ,iBAAiBxD,UAAUz2G,GAAV,CAAc,gBAAd,CAArB;AACAk6G,2BAAqB,IAArB,EAA2BF,WAA3B,EAAwCt/G,OAAOg9G,oBAA/C,EAAqEuC,cAArE,EAAqFtwE,IAAIgnB,KAAzF;AACA,aAAOqpD,WAAP;AACD,KA/Hc;;AAiIf;;;;;;;AAOAG,mBAAe,yBAAY;AACzB,aAAO9D,iBAAiB,IAAjB,EAAuBO,MAA9B;AACD,KA1Ic;;AA4If;;;AAGA/F,mBAAe,yBAAY;AACzB,aAAO,KAAK1hE,KAAL,CAAWua,QAAX,CAAoB,WAApB,CAAP;AACD,KAjJc;;AAmJf;;;;;;;;AAQAqwD,kBAAc,wBAAY;AACxB,aAAO,KAAK5qE,KAAL,CAAWua,QAAX,CAAoB,UAApB,CAAP;AACD,KA7Jc;;AA+Jf;;;;AAIAigD,kBAAc,wBAAY;AACxB,UAAIF,aAAa,KAAKxP,OAAtB;AACA,UAAIvoC,aAAa,KAAKvvD,KAAL,CAAWujG,SAAX,EAAjB;AACA,UAAI3qG,MAAM22D,WAAW,CAAX,IAAgBA,WAAW,CAAX,CAAhB,IAAiC,KAAK+nD,MAAL,GAAc,CAAd,GAAkB,CAAnD,CAAV,CAHwB,CAGyC;;AAEjE1+G,cAAQ,CAAR,KAAcA,MAAM,CAApB;AACA,UAAIwwG,OAAO3pG,KAAKyzC,GAAL,CAASo0D,WAAW,CAAX,IAAgBA,WAAW,CAAX,CAAzB,CAAX;AACA,aAAO7nG,KAAKyzC,GAAL,CAASk2D,IAAT,IAAiBxwG,GAAxB;AACD,KA3Kc;;AA6Kf;;;;AAIA6wG,kBAAc,IAjLC;;AAmLf;;;;AAIAmN,eAAW,IAvLI;;AAyLf;;;;;AAKAd,+BAA2B,qCAAY;AACrC,aAAOA,2BAA0B,IAA1B,CAAP;AACD;AAhMc,GAAjB;;AAmMA,WAAS0B,kBAAT,CAA4B7b,MAA5B,EAAoCsc,KAApC,EAA2C;AACzC,QAAI7O,OAAOzN,OAAO,CAAP,IAAYA,OAAO,CAAP,CAAvB;AACA,QAAI/iG,MAAMq/G,KAAV;AACA,QAAIhjD,SAASm0C,OAAOxwG,GAAP,GAAa,CAA1B;AACA+iG,WAAO,CAAP,KAAa1mC,MAAb;AACA0mC,WAAO,CAAP,KAAa1mC,MAAb;AACD,GAzr9B2B,CAyr9B1B;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,WAAS8iD,oBAAT,CAA8BlR,IAA9B,EAAoCgR,WAApC,EAAiDtC,oBAAjD,EAAuEuC,cAAvE,EAAuFtpD,KAAvF,EAA8F;AAC5F,QAAI0pD,WAAWL,YAAYh/G,MAA3B;;AAEA,QAAI,CAACguG,KAAKyQ,MAAN,IAAgBQ,cAAhB,IAAkC,CAACI,QAAvC,EAAiD;AAC/C;AACD;;AAED,QAAI5Q,aAAaT,KAAKtD,SAAL,EAAjB;AACA,QAAI4U,IAAJ;;AAEA,QAAID,aAAa,CAAjB,EAAoB;AAClBL,kBAAY,CAAZ,EAAe3gF,KAAf,GAAuBowE,WAAW,CAAX,CAAvB;AACA6Q,aAAON,YAAY,CAAZ,IAAiB;AACtB3gF,eAAOowE,WAAW,CAAX;AADe,OAAxB;AAGD,KALD,MAKO;AACL,UAAInqD,QAAQ06D,YAAY,CAAZ,EAAe3gF,KAAf,GAAuB2gF,YAAY,CAAZ,EAAe3gF,KAAlD;AACAn8B,aAAO88G,WAAP,EAAoB,UAAUO,SAAV,EAAqB;AACvCA,kBAAUlhF,KAAV,IAAmBimB,QAAQ,CAA3B;AACA,YAAIo4D,uBAAuBA,wBAAwB,CAAnD,CAFuC,CAEe;;AAEtD,YAAIA,uBAAuB,CAAvB,GAA2B,CAA/B,EAAkC;AAChC6C,oBAAUlhF,KAAV,IAAmBimB,SAAS,CAACo4D,uBAAuB,CAAxB,IAA6B,CAAtC,CAAnB;AACD;AACF,OAPD;AAQA4C,aAAO;AACLjhF,eAAO2gF,YAAYK,WAAW,CAAvB,EAA0BhhF,KAA1B,GAAkCimB;AADpC,OAAP;AAGA06D,kBAAY18G,IAAZ,CAAiBg9G,IAAjB;AACD;;AAED,QAAId,UAAU/P,WAAW,CAAX,IAAgBA,WAAW,CAAX,CAA9B;;AAEA,QAAI/1C,WAAWsmD,YAAY,CAAZ,EAAe3gF,KAA1B,EAAiCowE,WAAW,CAAX,CAAjC,CAAJ,EAAqD;AACnD94C,cAAQqpD,YAAY,CAAZ,EAAe3gF,KAAf,GAAuBowE,WAAW,CAAX,CAA/B,GAA+CuQ,YAAY16D,KAAZ,EAA/C;AACD;;AAED,QAAIqR,SAAS+C,WAAW+1C,WAAW,CAAX,CAAX,EAA0BuQ,YAAY,CAAZ,EAAe3gF,KAAzC,CAAb,EAA8D;AAC5D2gF,kBAAY7/C,OAAZ,CAAoB;AAClB9gC,eAAOowE,WAAW,CAAX;AADW,OAApB;AAGD;;AAED,QAAI/1C,WAAW+1C,WAAW,CAAX,CAAX,EAA0B6Q,KAAKjhF,KAA/B,CAAJ,EAA2C;AACzCs3B,cAAQ2pD,KAAKjhF,KAAL,GAAaowE,WAAW,CAAX,CAArB,GAAqCuQ,YAAYxkG,GAAZ,EAArC;AACD;;AAED,QAAIm7C,SAAS+C,WAAW4mD,KAAKjhF,KAAhB,EAAuBowE,WAAW,CAAX,CAAvB,CAAb,EAAoD;AAClDuQ,kBAAY18G,IAAZ,CAAiB;AACf+7B,eAAOowE,WAAW,CAAX;AADQ,OAAjB;AAGD;;AAED,aAAS/1C,UAAT,CAAoBtzD,CAApB,EAAuBC,CAAvB,EAA0B;AACxB,aAAOm5G,UAAUp5G,IAAIC,CAAd,GAAkBD,IAAIC,CAA7B;AACD;AACF;;AAED;;;;;;;;;;;;;;;;;;;AAmBA;;;AAGA,MAAIm6G,eAAevE,YAAnB;AACA,MAAIwE,SAAS,EAAb;AACAv9G,SAAO,CAAC,KAAD,EAAQ,MAAR,EAAgB,QAAhB,EAA0B,SAA1B,EAAqC,UAArC,EAAiD,QAAjD,EAA2D,QAA3D,EAAqE,MAArE,EAA6E,OAA7E,EAAsF,SAAtF,EAAiG,UAAjG,EAA6G,UAA7G,EAAyH,YAAzH,EAAuI,QAAvI,EAAiJ,UAAjJ,EAA6J,OAA7J,EAAsK,OAAtK,CAAP,EAAuL,UAAU7C,IAAV,EAAgB;AACrMogH,WAAOpgH,IAAP,IAAeoG,OAAOpG,IAAP,CAAf;AACD,GAFD;;AAIA;;;;;;;;;;;;;;;;;;;AAmBA;;;;;AAKA,WAASqgH,aAAT,CAAuB56C,GAAvB,EAA4B;AAC1B,WAAO,KAAK66C,KAAL,CAAW76C,GAAX,CAAP;AACD;AACD;;;;;AAMA,MAAI86C,YAAY,SAAZA,SAAY,CAAUvgH,IAAV,EAAgB;AAC9B,SAAKsgH,KAAL,GAAa,EAAb;AACA,SAAKE,QAAL,GAAgB,EAAhB;AACA;;;;AAIA,SAAKxgH,IAAL,GAAYA,QAAQ,EAApB;AACD,GARD;;AAUAugH,YAAUvhH,SAAV,GAAsB;AACpB6B,iBAAa0/G,SADO;AAEpB18G,UAAM,WAFc;;AAIpB;;;;;AAKA48G,aAAS,iBAAUh7C,GAAV,EAAe;AACtB,aAAO,KAAK66C,KAAL,CAAW76C,GAAX,CAAP;AACD,KAXmB;;AAapB;;;;AAIAi7C,aAAS,mBAAY;AACnB,aAAO/gH,IAAI,KAAK6gH,QAAT,EAAmBH,aAAnB,EAAkC,IAAlC,CAAP;AACD,KAnBmB;;AAqBpB;;;AAGAM,oBAAgB,wBAAU3L,SAAV,EAAqB;AACnCA,kBAAYA,UAAUt6F,WAAV,EAAZ;AACA,aAAOnb,OAAO,KAAKmhH,OAAL,EAAP,EAAuB,UAAU/R,IAAV,EAAgB;AAC5C,eAAOA,KAAK7mG,KAAL,CAAWjE,IAAX,KAAoBmxG,SAA3B;AACD,OAFM,CAAP;AAGD,KA7BmB;;AA+BpB;;;;AAIA4L,aAAS,iBAAUjS,IAAV,EAAgB;AACvB,UAAIlpC,MAAMkpC,KAAKlpC,GAAf;AACA,WAAK66C,KAAL,CAAW76C,GAAX,IAAkBkpC,IAAlB;;AAEA,WAAK6R,QAAL,CAAcv9G,IAAd,CAAmBwiE,GAAnB;AACD,KAxCmB;;AA0CpB;;;;;AAKA4sC,iBAAa,qBAAU1tG,GAAV,EAAe;AAC1B,aAAO,KAAKk8G,iBAAL,CAAuBl8G,GAAvB,EAA4B,aAA5B,CAAP;AACD,KAjDmB;;AAmDpB;;;;;AAKA46G,iBAAa,qBAAU56G,GAAV,EAAe;AAC1B,aAAO,KAAKk8G,iBAAL,CAAuBl8G,GAAvB,EAA4B,aAA5B,CAAP;AACD,KA1DmB;AA2DpBk8G,uBAAmB,2BAAUC,KAAV,EAAiB5uF,MAAjB,EAAyB;AAC1C,UAAI6uF,UAAU,KAAKP,QAAnB;AACA,UAAIQ,SAASF,iBAAiB3hH,KAAjB,GAAyB,EAAzB,GAA8B,EAA3C;;AAEA,WAAK,IAAIsB,IAAI,CAAb,EAAgBA,IAAIsgH,QAAQpgH,MAA5B,EAAoCF,GAApC,EAAyC;AACvC,YAAIglE,MAAMs7C,QAAQtgH,CAAR,CAAV;AACA,YAAIkuG,OAAO,KAAK2R,KAAL,CAAW76C,GAAX,CAAX;AACAu7C,eAAOv7C,GAAP,IAAckpC,KAAKz8E,MAAL,EAAa4uF,MAAMr7C,GAAN,CAAb,CAAd;AACD;;AAED,aAAOu7C,MAAP;AACD;AAtEmB,GAAtB;;AAyEA;;;;;;;;;;;;;;;;;;AAkBA,WAASC,WAAT,CAAqBjhH,IAArB,EAA2B;AACzBugH,cAAUhgH,IAAV,CAAe,IAAf,EAAqBP,IAArB;AACD;;AAEDihH,cAAYjiH,SAAZ,GAAwB;AACtB6B,iBAAaogH,WADS;AAEtBp9G,UAAM,aAFgB;;AAItB;;;;AAIAk/D,gBAAY,CAAC,GAAD,EAAM,GAAN,CARU;;AAUtB;;;;;AAKAib,iBAAa,uBAAY;AACvB,aAAO,KAAK2iC,cAAL,CAAoB,SAApB,EAA+B,CAA/B,KAAqC,KAAKA,cAAL,CAAoB,MAApB,EAA4B,CAA5B,CAArC,IAAuE,KAAKF,OAAL,CAAa,GAAb,CAA9E;AACD,KAjBqB;;AAmBtB;;;;;AAKAztB,kBAAc,sBAAUzrC,KAAV,EAAiB;AAC7B,UAAI25D,QAAQ,KAAKT,OAAL,CAAa,GAAb,CAAZ;AACA,UAAIU,QAAQ,KAAKV,OAAL,CAAa,GAAb,CAAZ;AACA,aAAOS,MAAMxxG,OAAN,CAAcwxG,MAAME,YAAN,CAAmB75D,MAAM,CAAN,CAAnB,CAAd,KAA+C45D,MAAMzxG,OAAN,CAAcyxG,MAAMC,YAAN,CAAmB75D,MAAM,CAAN,CAAnB,CAAd,CAAtD;AACD,KA5BqB;;AA8BtB;;;;;AAKA83D,iBAAa,qBAAUz8G,IAAV,EAAgB;AAC3B,aAAO,KAAK69G,OAAL,CAAa,GAAb,EAAkBpB,WAAlB,CAA8Bz8G,KAAK,CAAL,CAA9B,KAA0C,KAAK69G,OAAL,CAAa,GAAb,EAAkBpB,WAAlB,CAA8Bz8G,KAAK,CAAL,CAA9B,CAAjD;AACD,KArCqB;;AAuCtB;;;;;AAKAivG,iBAAa,qBAAUjvG,IAAV,EAAgBy+G,QAAhB,EAA0Bv6G,GAA1B,EAA+B;AAC1C,UAAIw6G,QAAQ,KAAKb,OAAL,CAAa,GAAb,CAAZ;AACA,UAAIc,QAAQ,KAAKd,OAAL,CAAa,GAAb,CAAZ;AACA35G,YAAMA,OAAO,EAAb;AACAA,UAAI,CAAJ,IAASw6G,MAAMlP,aAAN,CAAoBkP,MAAMjP,WAAN,CAAkBzvG,KAAK,CAAL,CAAlB,CAApB,CAAT;AACAkE,UAAI,CAAJ,IAASy6G,MAAMnP,aAAN,CAAoBmP,MAAMlP,WAAN,CAAkBzvG,KAAK,CAAL,CAAlB,CAApB,CAAT;AACA,aAAOkE,GAAP;AACD,KAnDqB;;AAqDtB;;;;;AAKA06G,eAAW,mBAAU5+G,IAAV,EAAgBkE,GAAhB,EAAqB;AAC9B,UAAI26G,SAAS,KAAKhB,OAAL,CAAa,GAAb,EAAkB34G,KAA/B;AACA,UAAI45G,SAAS,KAAKjB,OAAL,CAAa,GAAb,EAAkB34G,KAA/B;AACA,UAAI65G,cAAcF,OAAOpW,SAAP,EAAlB;AACA,UAAIuW,cAAcF,OAAOrW,SAAP,EAAlB;AACA,UAAIzkG,IAAI66G,OAAOjnG,KAAP,CAAa5X,KAAK,CAAL,CAAb,CAAR;AACA,UAAIiE,IAAI66G,OAAOlnG,KAAP,CAAa5X,KAAK,CAAL,CAAb,CAAR;AACAkE,YAAMA,OAAO,EAAb;AACAA,UAAI,CAAJ,IAASS,KAAKoB,GAAL,CAASpB,KAAKqB,GAAL,CAASrB,KAAKoB,GAAL,CAASg5G,YAAY,CAAZ,CAAT,EAAyBA,YAAY,CAAZ,CAAzB,CAAT,EAAmD/6G,CAAnD,CAAT,EAAgEW,KAAKqB,GAAL,CAAS+4G,YAAY,CAAZ,CAAT,EAAyBA,YAAY,CAAZ,CAAzB,CAAhE,CAAT;AACA76G,UAAI,CAAJ,IAASS,KAAKoB,GAAL,CAASpB,KAAKqB,GAAL,CAASrB,KAAKoB,GAAL,CAASi5G,YAAY,CAAZ,CAAT,EAAyBA,YAAY,CAAZ,CAAzB,CAAT,EAAmD/6G,CAAnD,CAAT,EAAgEU,KAAKqB,GAAL,CAASg5G,YAAY,CAAZ,CAAT,EAAyBA,YAAY,CAAZ,CAAzB,CAAhE,CAAT;AACA,aAAO96G,GAAP;AACD,KArEqB;;AAuEtB;;;;;AAKA04G,iBAAa,qBAAUj4D,KAAV,EAAiBzgD,GAAjB,EAAsB;AACjC,UAAIw6G,QAAQ,KAAKb,OAAL,CAAa,GAAb,CAAZ;AACA,UAAIc,QAAQ,KAAKd,OAAL,CAAa,GAAb,CAAZ;AACA35G,YAAMA,OAAO,EAAb;AACAA,UAAI,CAAJ,IAASw6G,MAAM/B,WAAN,CAAkB+B,MAAMF,YAAN,CAAmB75D,MAAM,CAAN,CAAnB,CAAlB,CAAT;AACAzgD,UAAI,CAAJ,IAASy6G,MAAMhC,WAAN,CAAkBgC,MAAMH,YAAN,CAAmB75D,MAAM,CAAN,CAAnB,CAAlB,CAAT;AACA,aAAOzgD,GAAP;AACD,KAnFqB;;AAqFtB;;;;AAIAkqG,kBAAc,sBAAUrC,IAAV,EAAgB;AAC5B,aAAO,KAAK8R,OAAL,CAAa9R,KAAKlpC,GAAL,KAAa,GAAb,GAAmB,GAAnB,GAAyB,GAAtC,CAAP;AACD;AA3FqB,GAAxB;AA6FAtjE,WAAS8+G,WAAT,EAAsBV,SAAtB;;AAEA;;;;;;;;;;;;;;;;;;AAkBA;;;;;;;;;;;AAWA,MAAIsB,SAAS,SAATA,MAAS,CAAUp8C,GAAV,EAAe39D,KAAf,EAAsBg6G,WAAtB,EAAmC3kB,QAAnC,EAA6ClrF,QAA7C,EAAuD;AAClEitG,SAAK3+G,IAAL,CAAU,IAAV,EAAgBklE,GAAhB,EAAqB39D,KAArB,EAA4Bg6G,WAA5B;AACA;;;;;;;;;AASA,SAAKj+G,IAAL,GAAYs5F,YAAY,OAAxB;AACA;;;;;;;;AAQA,SAAKlrF,QAAL,GAAgBA,YAAY,QAA5B;AACD,GArBD;;AAuBA4vG,SAAO7iH,SAAP,GAAmB;AACjB6B,iBAAaghH,MADI;;AAGjB;;;AAGA7oF,WAAO,CANU;;AAQjB;;;;;;AAMAm5E,qBAAiB,IAdA;;AAgBjB;;;;AAIAr9D,WAAO,IApBU;AAqBjBy8D,kBAAc,wBAAY;AACxB,UAAIt/F,WAAW,KAAKA,QAApB;AACA,aAAOA,aAAa,KAAb,IAAsBA,aAAa,QAA1C;AACD,KAxBgB;;AA0BjB;;;;;;;;AAQAqgG,qBAAiB,yBAAUv7C,GAAV,EAAe;AAC9B,UAAIz3C,MAAM,KAAK+rF,SAAL,EAAV;AACA/rF,UAAI,CAAJ,IAAS,KAAK8yF,aAAL,CAAmB9yF,IAAI,CAAJ,CAAnB,CAAT;AACAA,UAAI,CAAJ,IAAS,KAAK8yF,aAAL,CAAmB9yF,IAAI,CAAJ,CAAnB,CAAT;AACAy3C,aAAOz3C,IAAI,CAAJ,IAASA,IAAI,CAAJ,CAAhB,IAA0BA,IAAI4uF,OAAJ,EAA1B;AACA,aAAO5uF,GAAP;AACD,KAxCgB;AAyCjB0xF,kBAAc,wBAAY;AACxB,WAAK+Q,IAAL,CAAU/Q,YAAV;AACD,KA3CgB;;AA6CjB;;;AAGAwO,iBAAa,qBAAUj4D,KAAV,EAAiB+O,KAAjB,EAAwB;AACnC,aAAO,KAAKipD,WAAL,CAAiB,KAAK6B,YAAL,CAAkB75D,MAAM,KAAKke,GAAL,KAAa,GAAb,GAAmB,CAAnB,GAAuB,CAA7B,CAAlB,CAAjB,EAAqEnP,KAArE,CAAP;AACD,KAlDgB;;AAoDjB;;;;;;AAMA8qD,kBAAc,IA1DG;;AA4DjB;;;;;;AAMAhP,mBAAe;AAlEE,GAAnB;AAoEAjwG,WAAS0/G,MAAT,EAAiB3C,IAAjB;;AAEA;;;;;;;;;;;;;;;;;;AAkBA,MAAIxgD,gBAAgB;AAClBv5C,UAAM,IADY;AAElB8G,YAAQ,CAFU;AAGlBC,OAAG,CAHe;AAIlB;AACAizF,aAAS,KALS;AAMlB;AACAn/G,UAAM,EAPY;AAQlB;AACAgiH,kBAAc,KATI;AAUlB;AACAC,gBAAY,IAXM;AAYlBC,kBAAc;AACZlmD,gBAAU,IADE;AAEZvkC,gBAAU,KAFE;AAGZO,mBAAa;AAHD,KAZI;AAiBlB;AACAmqF,mBAAe,EAlBG;AAmBlB;AACAC,aAAS,EApBS;AAqBlB;AACA5zG,YAAQ,KAtBU;AAuBlB;AACA6zG,kBAAc,KAxBI;AAyBlBhvC,aAAS;AACPluD,YAAM;AADC,KAzBS;AA4BlBotD,iBAAa,EA5BK;AA6BlBsa,cAAU;AACR1nE,YAAM,IADE;AAERm9F,cAAQ,IAFA;AAGRC,uBAAiB,IAHT;AAIRz1B,iBAAW;AACTzwE,eAAO,MADE;AAETyJ,eAAO,CAFE;AAGTjiB,cAAM;AAHG,OAJH;AASR;AACAgqF,cAAQ,CAAC,MAAD,EAAS,MAAT,CAVA;AAWR20B,kBAAY,CAAC,EAAD,EAAK,EAAL;AAXJ,KA7BQ;AA0ClBz1B,cAAU;AACR5nE,YAAM,IADE;AAER;AACAs9F,cAAQ,KAHA;AAIR;AACA9hH,cAAQ,CALA;AAMRmsF,iBAAW;AACThnE,eAAO;AADE;AANH,KA1CQ;AAoDlBknE,eAAW;AACT7nE,YAAM,IADG;AAET;AACAs9F,cAAQ,KAHC;AAIThyG,cAAQ,CAJC;AAKT;AACAiyG,oBAAc,IANL;AAOT;AACAC,oBAAc,IARL;AAST5lD,cAAQ,CATC;AAUT;AACA9tC,gBAAU;AAXD,KApDO;AAiElBg+D,eAAW;AACT9nE,YAAM,IADG;AAET2nE,iBAAW;AACTzwE,eAAO,CAAC,MAAD,CADE;AAETyJ,eAAO,CAFE;AAGTjiB,cAAM;AAHG;AAFF,KAjEO;AAyElBqpF,eAAW;AACT/nE,YAAM,KADG;AAETgoE,iBAAW;AACT9wE,eAAO,CAAC,uBAAD,EAA0B,uBAA1B;AADE;AAFF;AAzEO,GAApB;AAgFA,MAAIumG,cAAc,EAAlB;AACAA,cAAYh1B,YAAZ,GAA2B1sF,MAAM;AAC/B;AACAk0G,iBAAa,IAFkB;AAG/B;AACA;AACA;AACA;AACA;AACA;AACA;AACApJ,mBAAe,IAVgB;AAW/B;AACA;AACA;AACA/e,eAAW;AACT9nE,YAAM;AADG,KAdoB;AAiB/B4nE,cAAU;AACR;AACA6yB,sBAAgB,KAFR;AAGRtnE,gBAAU;AAHF,KAjBqB;AAsB/B00C,eAAW;AACT10C,gBAAU;AADD;AAtBoB,GAAN,EAyBxBomB,aAzBwB,CAA3B;AA0BAkkD,cAAYj1B,SAAZ,GAAwBzsF,MAAM;AAC5B;AACA;AACAk0G,iBAAa,CAAC,CAAD,EAAI,CAAJ,CAHe;AAI5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAnI,iBAAa,CAzBe,CAyBb;AACf;AACA;AACA;AACA;AACA;;AA9B4B,GAAN,EAgCrBvuC,aAhCqB,CAAxB;AAiCAkkD,cAAYn1B,QAAZ,GAAuB5rF,SAAS;AAC9BiG,WAAO,IADuB;AAE9Ba,SAAK,SAFyB;AAG9BC,SAAK;AAHyB,GAAT,EAIpBg6G,YAAYj1B,SAJQ,CAAvB;AAKAi1B,cAAYl1B,OAAZ,GAAsB7rF,SAAS;AAC7BiG,WAAO,IADsB;AAE7B+6G,aAAS;AAFoB,GAAT,EAGnBD,YAAYj1B,SAHO,CAAtB;;AAKA;;;;;;;;;;;;;;;;;;AAkBA,MAAIm1B,aAAa,CAAC,OAAD,EAAU,UAAV,EAAsB,MAAtB,EAA8B,KAA9B,CAAjB;AACA;;;;;;;;AAQA,MAAIC,mBAAmB,SAAnBA,gBAAmB,CAAU1wC,QAAV,EAAoB2wC,kBAApB,EAAwCC,iBAAxC,EAA2DC,kBAA3D,EAA+E;AACpGrgH,WAAOigH,UAAP,EAAmB,UAAU3lB,QAAV,EAAoB;AACrC6lB,yBAAmBphH,MAAnB,CAA0B;AACxB;;;AAGAiC,cAAMwuE,WAAW,OAAX,GAAqB8qB,QAJH;AAKxBp+B,8BAAsB,8BAAU5uB,MAAV,EAAkBsB,OAAlB,EAA2B;AAC/C,cAAIotB,aAAa,KAAKA,UAAtB;AACA,cAAIG,sBAAsBH,aAAaV,gBAAgBhuB,MAAhB,CAAb,GAAuC,EAAjE;AACA,cAAI8uB,aAAaxtB,QAAQytB,QAAR,EAAjB;AACAh+D,gBAAMivC,MAAN,EAAc8uB,WAAWt5D,GAAX,CAAew3F,WAAW,MAA1B,CAAd;AACAj8F,gBAAMivC,MAAN,EAAc,KAAKgvB,gBAAL,EAAd;AACAhvB,iBAAOtsC,IAAP,GAAco/G,kBAAkB5wC,QAAlB,EAA4BliC,MAA5B,CAAd;;AAEA,cAAI0uB,UAAJ,EAAgB;AACd1B,6BAAiBhtB,MAAjB,EAAyB6uB,mBAAzB,EAA8CH,UAA9C;AACD;AACF,SAhBuB;;AAkBxB;;;AAGAO,uBAAe,yBAAY;AACzB,cAAI+jD,aAAa,KAAKhzE,MAAtB;;AAEA,cAAIgzE,WAAWt/G,IAAX,KAAoB,UAAxB,EAAoC;AAClC,iBAAKu/G,aAAL,GAAqBxX,YAAYK,iBAAZ,CAA8B,IAA9B,CAArB;AACD;AACF,SA3BuB;;AA6BxB;;;;AAIAoJ,uBAAe,uBAAUzU,OAAV,EAAmB;AAChC,cAAIzwD,SAAS,KAAKA,MAAlB,CADgC,CACN;AAC1B;;AAEA,cAAIA,OAAOtsC,IAAP,KAAgB,UAApB,EAAgC;AAC9B,gBAAI+8F,OAAJ,EAAa;AACX,qBAAOzwD,OAAOvtC,IAAd;AACD;;AAED,mBAAO,KAAKwgH,aAAL,CAAmB1xC,UAA1B;AACD;AACF,SA5CuB;AA6CxB+4B,wBAAgB,0BAAY;AAC1B,iBAAO,KAAK2Y,aAAZ;AACD,SA/CuB;AAgDxB1kD,uBAAeh9D,SAAS,CAAC,EAAD,EAAKkhH,YAAYzlB,WAAW,MAAvB,CAAL,EAAqC+lB,kBAArC,CAAT,EAAmE,IAAnE;AAhDS,OAA1B;AAkDD,KAnDD;AAoDA1kD,mBAAerK,wBAAf,CAAwCke,WAAW,MAAnD,EAA2D3uE,MAAMu/G,iBAAN,EAAyB5wC,QAAzB,CAA3D;AACD,GAtDD;;AAwDA;;;;;;;;;;;;;;;;;;AAkBA,MAAIgxC,YAAY7kD,eAAe58D,MAAf,CAAsB;AACpCiC,UAAM,iBAD8B;;AAGpC;;;AAGA8qG,UAAM,IAN8B;;AAQpC;;;AAGA5/D,UAAM,gBAAY;AAChBs0E,gBAAUnwE,UAAV,CAAqB,IAArB,EAA2B,MAA3B,EAAmC3vC,SAAnC;AACA,WAAKy0G,UAAL;AACD,KAdmC;;AAgBpC;;;AAGA7kD,iBAAa,uBAAY;AACvBkwD,gBAAUnwE,UAAV,CAAqB,IAArB,EAA2B,aAA3B,EAA0C3vC,SAA1C;AACA,WAAKy0G,UAAL;AACD,KAtBmC;;AAwBpC;;;AAGAtkD,iBAAa,uBAAY;AACvB2vD,gBAAUnwE,UAAV,CAAqB,IAArB,EAA2B,aAA3B,EAA0C3vC,SAA1C;AACA,WAAKy0G,UAAL;AACD,KA9BmC;;AAgCpC;;;;AAIAF,sBAAkB,4BAAY;AAC5B,aAAO,KAAKrmE,OAAL,CAAaU,eAAb,CAA6B;AAClCL,kBAAU,MADwB;AAElC9Y,eAAO,KAAKmX,MAAL,CAAYmzE,SAFe;AAGlCt/F,YAAI,KAAKmsB,MAAL,CAAYozE;AAHkB,OAA7B,EAIJ,CAJI,CAAP;AAKD;AA1CmC,GAAtB,CAAhB;;AA6CA,WAASC,WAAT,CAAqBrgD,OAArB,EAA8BhzB,MAA9B,EAAsC;AACpC;AACA,WAAOA,OAAOtsC,IAAP,KAAgBssC,OAAOvtC,IAAP,GAAc,UAAd,GAA2B,OAA3C,CAAP;AACD;;AAED1B,QAAMmiH,UAAUrkH,SAAhB,EAA2B24G,oBAA3B;AACA,MAAI8L,cAAc;AAChB;AACA;AACA;AACAv9G,YAAQ;AAJQ,GAAlB;AAMA68G,mBAAiB,GAAjB,EAAsBM,SAAtB,EAAiCG,WAAjC,EAA8CC,WAA9C;AACAV,mBAAiB,GAAjB,EAAsBM,SAAtB,EAAiCG,WAAjC,EAA8CC,WAA9C;;AAEA;;;;;;;;;;;;;;;;;;AAkBA;AACA;AACAjlD,iBAAe58D,MAAf,CAAsB;AACpBiC,UAAM,MADc;AAEpBg8D,kBAAc,CAAC,OAAD,EAAU,OAAV,CAFM;AAGpBhB,gBAAY,KAHQ;;AAKpB;;;AAGAge,sBAAkB,IARE;AASpBne,mBAAe;AACbv5C,YAAM,KADO;AAEb8G,cAAQ,CAFK;AAGbC,SAAG,CAHU;AAIbzC,YAAM,KAJO;AAKbwJ,WAAK,EALQ;AAMbvJ,aAAO,KANM;AAOb4R,cAAQ,EAPK;AAQb;AACAooF,oBAAc,KATD;AAUb;AACA;AACAh+E,uBAAiB,eAZJ;AAabi+E,mBAAa,CAbA;AAcbp2B,mBAAa;AAdA;AATK,GAAtB;;AA2BA;;;;;;;;;;;;;;;;;;;AAmBA;;;;;AAKA;;;;;AAKA,WAASq2B,mBAAT,CAA6B1gD,SAA7B,EAAwC2gD,SAAxC,EAAmDpyE,OAAnD,EAA4D;AAC1D,WAAOyxB,UAAU40C,gBAAV,OAAiC+L,SAAxC;AACD;;AAED,WAASC,IAAT,CAAcD,SAAd,EAAyBpyE,OAAzB,EAAkCg7B,GAAlC,EAAuC;AACrC;;;;AAIA,SAAKs3C,UAAL,GAAkB,EAAlB;AACA;;;;;AAKA,SAAKC,WAAL,GAAmB,EAAnB;AACA;;;;;AAKA,SAAKC,QAAL,GAAgB,EAAhB;AACA;;;;;AAKA,SAAKC,SAAL,GAAiB,EAAjB;;AAEA,SAAKC,cAAL,CAAoBN,SAApB,EAA+BpyE,OAA/B,EAAwCg7B,GAAxC;;AAEA,SAAK33B,KAAL,GAAa+uE,SAAb;AACD;;AAED,MAAIO,YAAYN,KAAK9kH,SAArB;AACAolH,YAAUvgH,IAAV,GAAiB,MAAjB;AACAugH,YAAUC,kBAAV,GAA+B,IAA/B;;AAEAD,YAAUE,OAAV,GAAoB,YAAY;AAC9B,WAAO,KAAK9lF,KAAZ;AACD,GAFD;;AAIA4lF,YAAUt/F,MAAV,GAAmB,UAAU2sB,OAAV,EAAmBg7B,GAAnB,EAAwB;AACzC,QAAI83C,UAAU,KAAKN,QAAnB;;AAEA,SAAKO,YAAL,CAAkB/yE,OAAlB,EAA2B,KAAKqD,KAAhC;;AAEAjyC,WAAO0hH,QAAQ39G,CAAf,EAAkB,UAAU06G,KAAV,EAAiB;AACjCnL,sBAAgBmL,MAAMx5G,KAAtB,EAA6Bw5G,MAAMxsE,KAAnC;AACD,KAFD;AAGAjyC,WAAO0hH,QAAQ19G,CAAf,EAAkB,UAAU06G,KAAV,EAAiB;AACjCpL,sBAAgBoL,MAAMz5G,KAAtB,EAA6By5G,MAAMzsE,KAAnC;AACD,KAFD;AAGAjyC,WAAO0hH,QAAQ39G,CAAf,EAAkB,UAAU06G,KAAV,EAAiB;AACjCmD,oBAAcF,OAAd,EAAuB,GAAvB,EAA4BjD,KAA5B;AACD,KAFD;AAGAz+G,WAAO0hH,QAAQ19G,CAAf,EAAkB,UAAU06G,KAAV,EAAiB;AACjCkD,oBAAcF,OAAd,EAAuB,GAAvB,EAA4BhD,KAA5B;AACD,KAFD,EAdyC,CAgBrC;AACJ;;AAEA,SAAKtzG,MAAL,CAAY,KAAK6mC,KAAjB,EAAwB23B,GAAxB;AACD,GApBD;;AAsBA,WAASg4C,aAAT,CAAuBF,OAAvB,EAAgCG,YAAhC,EAA8C/V,IAA9C,EAAoD;AAClDA,SAAKwD,eAAL,GAAuB,YAAY;AACjC;AACA,aAAOwS,YAAY,CAACA,SAAD,CAAZ,GAA0B,EAAjC;AACD,KAHD,CADkD,CAI/C;AACH;AACA;;;AAGA,QAAIC,YAAYL,QAAQG,YAAR,CAAhB;AACA,QAAIC,SAAJ;AACA,QAAIzhD,YAAYyrC,KAAK75D,KAArB;AACA,QAAIwtE,SAASp/C,UAAUv9D,GAAV,CAAc,iBAAd,CAAb;AACA,QAAI48G,kBAAkBr/C,UAAUv9D,GAAV,CAAc,0BAAd,CAAtB;;AAEA,QAAI,CAAC28G,MAAL,EAAa;AACX;AACD,KAjBiD,CAiBhD;;;AAGF,QAAIC,mBAAmB,IAAvB,EAA6B;AAC3B,UAAIsC,gBAAgBD,UAAUrC,eAAV,CAAhB,CAAJ,EAAiD;AAC/CoC,oBAAYC,UAAUrC,eAAV,CAAZ;AACD;;AAED;AACD,KA1BiD,CA0BhD;;;AAGF,SAAK,IAAI76F,GAAT,IAAgBk9F,SAAhB,EAA2B;AACzB,UAAIA,UAAU3jH,cAAV,CAAyBymB,GAAzB,KAAiCm9F,gBAAgBD,UAAUl9F,GAAV,CAAhB,CAArC,EAAsE;AACpEi9F,oBAAYC,UAAUl9F,GAAV,CAAZ;AACA;AACD;AACF;AACF;;AAED,WAASm9F,eAAT,CAAyBlW,IAAzB,EAA+B;AAC7B,WAAOA,QAAQA,KAAK9qG,IAAL,KAAc,UAAtB,IAAoC8qG,KAAK9qG,IAAL,KAAc,MAAlD,IAA4DwyG,gBAAgB1H,IAAhB,CAAnE;AACD;AACD;;;;;;AAOAyV,YAAUn2G,MAAV,GAAmB,UAAU41G,SAAV,EAAqBp3C,GAArB,EAA0Bq4C,kBAA1B,EAA8C;AAC/D,QAAIC,WAAWnoD,cAAcinD,UAAUvlD,kBAAV,EAAd,EAA8C;AAC3Dx4C,aAAO2mD,IAAI35C,QAAJ,EADoD;AAE3D/M,cAAQ0mD,IAAI15C,SAAJ;AAFmD,KAA9C,CAAf;AAIA,SAAKyL,KAAL,GAAaumF,QAAb;AACA,QAAIC,WAAW,KAAKd,SAApB;AACAe,iBAP+D,CAOjD;;AAEd,QAAI,CAACH,kBAAD,IAAuBjB,UAAUl+G,GAAV,CAAc,cAAd,CAA3B,EAA0D;AACxD9C,aAAOmiH,QAAP,EAAiB,UAAUrW,IAAV,EAAgB;AAC/B,YAAI,CAACA,KAAK75D,KAAL,CAAWnvC,GAAX,CAAe,kBAAf,CAAL,EAAyC;AACvC,cAAIu/G,iBAAiBtO,uBAAuBjI,IAAvB,CAArB;;AAEA,cAAIuW,cAAJ,EAAoB;AAClB,gBAAIz/C,MAAMkpC,KAAK4C,YAAL,KAAsB,QAAtB,GAAiC,OAA3C;AACA,gBAAIx0C,SAAS4xC,KAAK75D,KAAL,CAAWnvC,GAAX,CAAe,kBAAf,CAAb;AACAo/G,qBAASt/C,GAAT,KAAiBy/C,eAAez/C,GAAf,IAAsB1I,MAAvC;;AAEA,gBAAI4xC,KAAK18F,QAAL,KAAkB,KAAtB,EAA6B;AAC3B8yG,uBAASl+G,CAAT,IAAcq+G,eAAen/F,MAAf,GAAwBg3C,MAAtC;AACD,aAFD,MAEO,IAAI4xC,KAAK18F,QAAL,KAAkB,MAAtB,EAA8B;AACnC8yG,uBAASn+G,CAAT,IAAcs+G,eAAep/F,KAAf,GAAuBi3C,MAArC;AACD;AACF;AACF;AACF,OAhBD;AAiBAkoD;AACD;;AAED,aAASA,UAAT,GAAsB;AACpBpiH,aAAOmiH,QAAP,EAAiB,UAAUrW,IAAV,EAAgB;AAC/B,YAAI4C,eAAe5C,KAAK4C,YAAL,EAAnB;AACA,YAAI9N,SAAS8N,eAAe,CAAC,CAAD,EAAIwT,SAASj/F,KAAb,CAAf,GAAqC,CAAC,CAAD,EAAIi/F,SAASh/F,MAAb,CAAlD;AACA,YAAI2B,MAAMinF,KAAKwQ,OAAL,GAAe,CAAf,GAAmB,CAA7B;AACAxQ,aAAKrD,SAAL,CAAe7H,OAAO/7E,GAAP,CAAf,EAA4B+7E,OAAO,IAAI/7E,GAAX,CAA5B;AACAy9F,4BAAoBxW,IAApB,EAA0B4C,eAAewT,SAASn+G,CAAxB,GAA4Bm+G,SAASl+G,CAA/D;AACD,OAND;AAOD;AACF,GAvCD;AAwCA;;;;;AAMAu9G,YAAU3D,OAAV,GAAoB,UAAUtjB,QAAV,EAAoBl6B,SAApB,EAA+B;AACjD,QAAImiD,eAAe,KAAKnB,QAAL,CAAc9mB,QAAd,CAAnB;;AAEA,QAAIioB,gBAAgB,IAApB,EAA0B;AACxB,UAAIniD,aAAa,IAAjB,EAAuB;AACrB;AACA,aAAK,IAAIjjE,IAAT,IAAiBolH,YAAjB,EAA+B;AAC7B,cAAIA,aAAankH,cAAb,CAA4BjB,IAA5B,CAAJ,EAAuC;AACrC,mBAAOolH,aAAaplH,IAAb,CAAP;AACD;AACF;AACF;;AAED,aAAOolH,aAAaniD,SAAb,CAAP;AACD;AACF,GAfD;AAgBA;;;;AAKAmhD,YAAU1D,OAAV,GAAoB,YAAY;AAC9B,WAAO,KAAKwD,SAAL,CAAezkH,KAAf,EAAP;AACD,GAFD;AAGA;;;;;;;;;;;AAYA2kH,YAAUiB,YAAV,GAAyB,UAAUC,UAAV,EAAsBC,UAAtB,EAAkC;AACzD,QAAID,cAAc,IAAd,IAAsBC,cAAc,IAAxC,EAA8C;AAC5C,UAAIvkH,MAAM,MAAMskH,UAAN,GAAmB,GAAnB,GAAyBC,UAAnC;AACA,aAAO,KAAKxB,UAAL,CAAgB/iH,GAAhB,CAAP;AACD;;AAED,QAAIK,WAAWikH,UAAX,CAAJ,EAA4B;AAC1BC,mBAAaD,WAAWC,UAAxB;AACAD,mBAAaA,WAAWA,UAAxB;AACD,KATwD,CASvD;;;AAGF,SAAK,IAAI7kH,IAAI,CAAR,EAAW+kH,YAAY,KAAKxB,WAAjC,EAA8CvjH,IAAI+kH,UAAU7kH,MAA5D,EAAoEF,GAApE,EAAyE;AACvE,UAAI+kH,UAAU/kH,CAAV,EAAaggH,OAAb,CAAqB,GAArB,EAA0BznF,KAA1B,KAAoCssF,UAApC,IAAkDE,UAAU/kH,CAAV,EAAaggH,OAAb,CAAqB,GAArB,EAA0BznF,KAA1B,KAAoCusF,UAA1F,EAAsG;AACpG,eAAOC,UAAU/kH,CAAV,CAAP;AACD;AACF;AACF,GAjBD;;AAmBA2jH,YAAUqB,aAAV,GAA0B,YAAY;AACpC,WAAO,KAAKzB,WAAL,CAAiBvkH,KAAjB,EAAP;AACD,GAFD;AAGA;;;;;AAMA2kH,YAAUzxB,cAAV,GAA2B,UAAUlhD,OAAV,EAAmBC,MAAnB,EAA2BxvC,KAA3B,EAAkC;AAC3D,QAAIf,SAAS,KAAKukH,kBAAL,CAAwBj0E,OAAxB,EAAiCC,MAAjC,CAAb;;AAEA,WAAOvwC,OAAO+tG,SAAP,GAAmB/tG,OAAO+tG,SAAP,CAAiB2C,WAAjB,CAA6B3vG,KAA7B,CAAnB,GAAyDf,OAAOwtG,IAAP,GAAcxtG,OAAOwtG,IAAP,CAAYyD,aAAZ,CAA0BjxG,OAAOwtG,IAAP,CAAY0D,WAAZ,CAAwBnwG,KAAxB,CAA1B,CAAd,GAA0E,IAA1I;AACD,GAJD;AAKA;;;;;AAMAkiH,YAAUvxB,gBAAV,GAA6B,UAAUphD,OAAV,EAAmBC,MAAnB,EAA2BxvC,KAA3B,EAAkC;AAC7D,QAAIf,SAAS,KAAKukH,kBAAL,CAAwBj0E,OAAxB,EAAiCC,MAAjC,CAAb;;AAEA,WAAOvwC,OAAO+tG,SAAP,GAAmB/tG,OAAO+tG,SAAP,CAAiBsQ,WAAjB,CAA6Bt9G,KAA7B,CAAnB,GAAyDf,OAAOwtG,IAAP,GAAcxtG,OAAOwtG,IAAP,CAAY4Q,WAAZ,CAAwBp+G,OAAOwtG,IAAP,CAAYyS,YAAZ,CAAyBl/G,KAAzB,CAAxB,CAAd,GAAyE,IAAzI;AACD,GAJD;AAKA;;;;AAKAkiH,YAAUsB,kBAAV,GAA+B,UAAUj0E,OAAV,EAAmBC,MAAnB,EAA2B;AACxD,QAAI8vB,cAAc9vB,OAAO8vB,WAAzB;AACA,QAAIQ,aAAatwB,OAAOswB,UAAP,IAAqBR,eAAeA,YAAY9B,sBAAZ,CAAmC,OAAnC,EAA4C,CAA5C,CAArD;AACA,QAAIuC,aAAavwB,OAAOuwB,UAAP,IAAqBT,eAAeA,YAAY9B,sBAAZ,CAAmC,OAAnC,EAA4C,CAA5C,CAArD;AACA,QAAImkD,YAAYnyE,OAAOmyE,SAAvB;AACA,QAAI8B,aAAa,KAAK3B,WAAtB;AACA,QAAI9U,SAAJ;AACA,QAAIP,IAAJ;;AAEA,QAAIntC,WAAJ,EAAiB;AACf0tC,kBAAY1tC,YAAYqb,gBAAxB;AACA76E,cAAQ2jH,UAAR,EAAoBzW,SAApB,IAAiC,CAAjC,KAAuCA,YAAY,IAAnD;AACD,KAHD,MAGO,IAAIltC,cAAcC,UAAlB,EAA8B;AACnCitC,kBAAY,KAAKmW,YAAL,CAAkBrjD,WAAWvD,cAA7B,EAA6CwD,WAAWxD,cAAxD,CAAZ;AACD,KAFM,MAEA,IAAIuD,UAAJ,EAAgB;AACrB2sC,aAAO,KAAK8R,OAAL,CAAa,GAAb,EAAkBz+C,WAAWvD,cAA7B,CAAP;AACD,KAFM,MAEA,IAAIwD,UAAJ,EAAgB;AACrB0sC,aAAO,KAAK8R,OAAL,CAAa,GAAb,EAAkBx+C,WAAWxD,cAA7B,CAAP;AACD,KAFM,CAEL;AAFK,SAGF,IAAIolD,SAAJ,EAAe;AAChB,YAAI9B,OAAO8B,UAAUhnC,gBAArB;;AAEA,YAAIklC,SAAS,IAAb,EAAmB;AACjB7S,sBAAY,KAAK8U,WAAL,CAAiB,CAAjB,CAAZ;AACD;AACF;;AAEH,WAAO;AACL9U,iBAAWA,SADN;AAELP,YAAMA;AAFD,KAAP;AAID,GA/BD;AAgCA;;;;;AAMAyV,YAAUpxB,YAAV,GAAyB,UAAUzrC,KAAV,EAAiB;AACxC,QAAIvoB,QAAQ,KAAKglF,WAAL,CAAiB,CAAjB,CAAZ;;AAEA,QAAIhlF,KAAJ,EAAW;AACT,aAAOA,MAAMg0D,YAAN,CAAmBzrC,KAAnB,CAAP;AACD;AACF,GAND;AAOA;;;;;AAMA68D,YAAUD,cAAV,GAA2B,UAAUN,SAAV,EAAqBpyE,OAArB,EAA8Bg7B,GAA9B,EAAmC;AAC5D,QAAIm5C,mBAAmB;AACrBn8F,YAAM,KADe;AAErBC,aAAO,KAFc;AAGrBuJ,WAAK,KAHgB;AAIrBqI,cAAQ;AAJa,KAAvB;AAMA,QAAIipF,UAAU;AACZ39G,SAAG,EADS;AAEZC,SAAG;AAFS,KAAd;AAIA,QAAIg/G,YAAY;AACdj/G,SAAG,CADW;AAEdC,SAAG;AAFW,KAAhB,CAX4D,CAczD;;AAEH4qC,YAAQ24B,aAAR,CAAsB,OAAtB,EAA+B07C,kBAAkB,GAAlB,CAA/B,EAAuD,IAAvD;AACAr0E,YAAQ24B,aAAR,CAAsB,OAAtB,EAA+B07C,kBAAkB,GAAlB,CAA/B,EAAuD,IAAvD;;AAEA,QAAI,CAACD,UAAUj/G,CAAX,IAAgB,CAACi/G,UAAUh/G,CAA/B,EAAkC;AAChC;AACA,WAAKo9G,QAAL,GAAgB,EAAhB;AACA,WAAKC,SAAL,GAAiB,EAAjB;AACA;AACD;;AAED,SAAKD,QAAL,GAAgBM,OAAhB,CA1B4D,CA0BnC;;AAEzB1hH,WAAO0hH,QAAQ39G,CAAf,EAAkB,UAAU06G,KAAV,EAAiBgE,UAAjB,EAA6B;AAC7CziH,aAAO0hH,QAAQ19G,CAAf,EAAkB,UAAU06G,KAAV,EAAiBgE,UAAjB,EAA6B;AAC7C,YAAIvkH,MAAM,MAAMskH,UAAN,GAAmB,GAAnB,GAAyBC,UAAnC;AACA,YAAIrW,YAAY,IAAI+R,WAAJ,CAAgBjgH,GAAhB,CAAhB;AACAkuG,kBAAU6S,IAAV,GAAiB,IAAjB;AACA7S,kBAAUp6D,KAAV,GAAkB+uE,SAAlB;AACA,aAAKE,UAAL,CAAgB/iH,GAAhB,IAAuBkuG,SAAvB;;AAEA,aAAK8U,WAAL,CAAiB/gH,IAAjB,CAAsBisG,SAAtB;;AAEAA,kBAAU0R,OAAV,CAAkBU,KAAlB;AACApS,kBAAU0R,OAAV,CAAkBW,KAAlB;AACD,OAXD,EAWG,IAXH;AAYD,KAbD,EAaG,IAbH;;AAeA,aAASuE,iBAAT,CAA2B3oB,QAA3B,EAAqC;AACnC,aAAO,UAAUj6B,SAAV,EAAqBx7C,GAArB,EAA0B;AAC/B,YAAI,CAACk8F,oBAAoB1gD,SAApB,EAA+B2gD,SAA/B,EAA0CpyE,OAA1C,CAAL,EAAyD;AACvD;AACD;;AAED,YAAIs0E,eAAe7iD,UAAUv9D,GAAV,CAAc,UAAd,CAAnB;;AAEA,YAAIw3F,aAAa,GAAjB,EAAsB;AACpB;AACA,cAAI4oB,iBAAiB,KAAjB,IAA0BA,iBAAiB,QAA/C,EAAyD;AACvD;AACAA,2BAAe,QAAf;;AAEA,gBAAIH,iBAAiBG,YAAjB,CAAJ,EAAoC;AAClCA,6BAAeA,iBAAiB,KAAjB,GAAyB,QAAzB,GAAoC,KAAnD;AACD;AACF;AACF,SAVD,MAUO;AACL;AACA,cAAIA,iBAAiB,MAAjB,IAA2BA,iBAAiB,OAAhD,EAAyD;AACvD;AACAA,2BAAe,MAAf;;AAEA,gBAAIH,iBAAiBG,YAAjB,CAAJ,EAAoC;AAClCA,6BAAeA,iBAAiB,MAAjB,GAA0B,OAA1B,GAAoC,MAAnD;AACD;AACF;AACF;;AAEDH,yBAAiBG,YAAjB,IAAiC,IAAjC;AACA,YAAIpX,OAAO,IAAIkT,MAAJ,CAAW1kB,QAAX,EAAqBiZ,mBAAmBlzC,SAAnB,CAArB,EAAoD,CAAC,CAAD,EAAI,CAAJ,CAApD,EAA4DA,UAAUv9D,GAAV,CAAc,MAAd,CAA5D,EAAmFogH,YAAnF,CAAX;AACA,YAAI7jD,aAAaysC,KAAK9qG,IAAL,KAAc,UAA/B;AACA8qG,aAAKyQ,MAAL,GAAcl9C,cAAcgB,UAAUv9D,GAAV,CAAc,aAAd,CAA5B;AACAgpG,aAAKwQ,OAAL,GAAej8C,UAAUv9D,GAAV,CAAc,SAAd,CAAf,CAjC+B,CAiCU;;AAEzCu9D,kBAAUyrC,IAAV,GAAiBA,IAAjB,CAnC+B,CAmCR;;AAEvBA,aAAK75D,KAAL,GAAaouB,SAAb,CArC+B,CAqCP;;AAExByrC,aAAKoT,IAAL,GAAY,IAAZ,CAvC+B,CAuCb;;AAElBpT,aAAK31E,KAAL,GAAatR,GAAb;;AAEA,aAAKw8F,SAAL,CAAejhH,IAAf,CAAoB0rG,IAApB;;AAEA4V,gBAAQpnB,QAAR,EAAkBz1E,GAAlB,IAAyBinF,IAAzB;AACAkX,kBAAU1oB,QAAV;AACD,OA/CD;AAgDD;AACF,GA7FD;AA8FA;;;;;;AAOAinB,YAAUI,YAAV,GAAyB,UAAU/yE,OAAV,EAAmBoyE,SAAnB,EAA8B;AACrD;AACAhhH,WAAO,KAAKqhH,SAAZ,EAAuB,UAAUvV,IAAV,EAAgB;AACrCA,WAAK7mG,KAAL,CAAWwjG,SAAX,CAAqB/yD,QAArB,EAA+B,CAACA,QAAhC;AACD,KAFD;AAGA9G,YAAQu5B,UAAR,CAAmB,UAAUxJ,WAAV,EAAuB;AACxC,UAAIwkD,cAAcxkD,WAAd,CAAJ,EAAgC;AAC9B,YAAIykD,aAAaC,eAAe1kD,WAAf,EAA4B/vB,OAA5B,CAAjB;AACA,YAAIuwB,aAAaikD,WAAW,CAAX,CAAjB;AACA,YAAIhkD,aAAagkD,WAAW,CAAX,CAAjB;;AAEA,YAAI,CAACrC,oBAAoB5hD,UAApB,EAAgC6hD,SAAhC,EAA2CpyE,OAA3C,CAAD,IAAwD,CAACmyE,oBAAoB3hD,UAApB,EAAgC4hD,SAAhC,EAA2CpyE,OAA3C,CAA7D,EAAkH;AAChH;AACD;;AAED,YAAIy9D,YAAY,KAAKmW,YAAL,CAAkBrjD,WAAWvD,cAA7B,EAA6CwD,WAAWxD,cAAxD,CAAhB;AACA,YAAI77D,OAAO4+D,YAAY2S,OAAZ,EAAX;AACA,YAAImtC,QAAQpS,UAAUuR,OAAV,CAAkB,GAAlB,CAAZ;AACA,YAAIc,QAAQrS,UAAUuR,OAAV,CAAkB,GAAlB,CAAZ;;AAEA,YAAI79G,KAAKiB,IAAL,KAAc,MAAlB,EAA0B;AACxBsnG,sBAAYvoG,IAAZ,EAAkB0+G,KAAlB,EAAyB9/C,WAAzB;AACA2pC,sBAAYvoG,IAAZ,EAAkB2+G,KAAlB,EAAyB//C,WAAzB;AACD;AACF;AACF,KApBD,EAoBG,IApBH;;AAsBA,aAAS2pC,WAAT,CAAqBvoG,IAArB,EAA2B+rG,IAA3B,EAAiCntC,WAAjC,EAA8C;AAC5C3+D,aAAOD,KAAK+7E,YAAL,CAAkBgwB,KAAKlpC,GAAvB,EAA4B,IAA5B,CAAP,EAA0C,UAAUA,GAAV,EAAe;AACvDkpC,aAAK7mG,KAAL,CAAWsjG,mBAAX,EAAgC;AAChC;AACA;AACAxoG,YAHA,EAGMqnG,oBAAoBrnG,IAApB,EAA0B6iE,GAA1B,CAHN;AAID,OALD;AAMD;AACF,GAnCD;AAoCA;;;;;AAMA2+C,YAAU+B,cAAV,GAA2B,UAAU1gD,GAAV,EAAe;AACxC,QAAI2gD,WAAW,EAAf;AACA,QAAIxB,YAAY,EAAhB;AACA/hH,WAAO,KAAK4iH,aAAL,EAAP,EAA6B,UAAUvW,SAAV,EAAqB;AAChD,UAAIC,WAAW1pC,OAAO,IAAP,IAAeA,QAAQ,MAAvB,GAAgCypC,UAAUuR,OAAV,CAAkBh7C,GAAlB,CAAhC,GAAyDypC,UAAUlxB,WAAV,EAAxE;AACA,UAAI2mC,YAAYzV,UAAU8B,YAAV,CAAuB7B,QAAvB,CAAhB;AACAntG,cAAQokH,QAAR,EAAkBjX,QAAlB,IAA8B,CAA9B,IAAmCiX,SAASnjH,IAAT,CAAcksG,QAAd,CAAnC;AACAntG,cAAQ4iH,SAAR,EAAmBD,SAAnB,IAAgC,CAAhC,IAAqCC,UAAU3hH,IAAV,CAAe0hH,SAAf,CAArC;AACD,KALD;AAMA,WAAO;AACLyB,gBAAUA,QADL;AAELxB,iBAAWA;AAFN,KAAP;AAID,GAbD;AAcA;;;;AAKA,WAASO,mBAAT,CAA6BxW,IAA7B,EAAmC0X,SAAnC,EAA8C;AAC5C,QAAIjX,aAAaT,KAAKtD,SAAL,EAAjB;AACA,QAAIib,gBAAgBlX,WAAW,CAAX,IAAgBA,WAAW,CAAX,CAApC,CAF4C,CAEO;;AAEnDT,SAAKyD,aAAL,GAAqBzD,KAAKlpC,GAAL,KAAa,GAAb,GAAmB,UAAUzmC,KAAV,EAAiB;AACvD,aAAOA,QAAQqnF,SAAf;AACD,KAFoB,GAEjB,UAAUrnF,KAAV,EAAiB;AACnB,aAAOsnF,gBAAgBtnF,KAAhB,GAAwBqnF,SAA/B;AACD,KAJD;AAKA1X,SAAKyS,YAAL,GAAoBzS,KAAKlpC,GAAL,KAAa,GAAb,GAAmB,UAAUzmC,KAAV,EAAiB;AACtD,aAAOA,QAAQqnF,SAAf;AACD,KAFmB,GAEhB,UAAUrnF,KAAV,EAAiB;AACnB,aAAOsnF,gBAAgBtnF,KAAhB,GAAwBqnF,SAA/B;AACD,KAJD;AAKD;;AAED,MAAIE,YAAY,CAAC,OAAD,EAAU,OAAV,CAAhB;AACA;;;;AAIA,WAASL,cAAT,CAAwB1kD,WAAxB,EAAqC/vB,OAArC,EAA8C;AAC5C,WAAO9xC,IAAI4mH,SAAJ,EAAe,UAAUppB,QAAV,EAAoB;AACxC,UAAIj6B,YAAY1B,YAAY9B,sBAAZ,CAAmCy9B,QAAnC,EAA6C,CAA7C,CAAhB;AACA,aAAOj6B,SAAP;AACD,KAHM,CAAP;AAID;AACD;;;;AAKA,WAAS8iD,aAAT,CAAuBxkD,WAAvB,EAAoC;AAClC,WAAOA,YAAY77D,GAAZ,CAAgB,kBAAhB,MAAwC,aAA/C;AACD;;AAEDm+G,OAAKn9G,MAAL,GAAc,UAAU8qC,OAAV,EAAmBg7B,GAAnB,EAAwB;AACpC,QAAI+5C,QAAQ,EAAZ;AACA/0E,YAAQ24B,aAAR,CAAsB,MAAtB,EAA8B,UAAUy5C,SAAV,EAAqBn8F,GAArB,EAA0B;AACtD,UAAIq6F,OAAO,IAAI+B,IAAJ,CAASD,SAAT,EAAoBpyE,OAApB,EAA6Bg7B,GAA7B,CAAX;AACAs1C,WAAK/hH,IAAL,GAAY,UAAU0nB,GAAtB,CAFsD,CAE3B;AAC3B;;AAEAq6F,WAAK9zG,MAAL,CAAY41G,SAAZ,EAAuBp3C,GAAvB,EAA4B,IAA5B;AACAo3C,gBAAUhnC,gBAAV,GAA6BklC,IAA7B;AACAyE,YAAMvjH,IAAN,CAAW8+G,IAAX;AACD,KARD,EAFoC,CAUhC;;AAEJtwE,YAAQu5B,UAAR,CAAmB,UAAUxJ,WAAV,EAAuB;AACxC,UAAI,CAACwkD,cAAcxkD,WAAd,CAAL,EAAiC;AAC/B;AACD;;AAED,UAAIykD,aAAaC,eAAe1kD,WAAf,EAA4B/vB,OAA5B,CAAjB;AACA,UAAIuwB,aAAaikD,WAAW,CAAX,CAAjB;AACA,UAAIhkD,aAAagkD,WAAW,CAAX,CAAjB;AACA,UAAIpC,YAAY7hD,WAAW81C,gBAAX,EAAhB;AACA,UAAIiK,OAAO8B,UAAUhnC,gBAArB;AACArb,kBAAYqb,gBAAZ,GAA+BklC,KAAKsD,YAAL,CAAkBrjD,WAAWvD,cAA7B,EAA6CwD,WAAWxD,cAAxD,CAA/B;AACD,KAXD;AAYA,WAAO+nD,KAAP;AACD,GAzBD,CA7//B4B,CAshgCzB;;;AAGH1C,OAAK/gD,UAAL,GAAkB+gD,KAAK9kH,SAAL,CAAe+jE,UAAf,GAA4Bk+C,YAAYjiH,SAAZ,CAAsB+jE,UAApE;AACAwJ,0BAAwBO,QAAxB,CAAiC,aAAjC,EAAgDg3C,IAAhD;;AAEA;;;;;;;;;;;;;;;;;;AAkBA,MAAI2C,gBAAgB7pC,YAAYh7E,MAAZ,CAAmB;AACrCiC,UAAM,qBAD+B;AAErCs5E,oBAAgB,wBAAUhtC,MAAV,EAAkBsB,OAAlB,EAA2B;AACzC,aAAO04D,oBAAoB,KAAK3lC,SAAL,EAApB,EAAsC,IAAtC,CAAP;AACD,KAJoC;AAKrCkiD,uBAAmB,2BAAUxkH,KAAV,EAAiB;AAClC,UAAI0qE,WAAW,KAAKiQ,gBAApB;;AAEA,UAAIjQ,QAAJ,EAAc;AACZ;AACA,YAAI+5C,KAAK/5C,SAASilC,WAAT,CAAqBjlC,SAAS40C,SAAT,CAAmBt/G,KAAnB,CAArB,CAAT;AACA,YAAIU,OAAO,KAAKuxE,OAAL,EAAX;AACA,YAAIjuE,SAAStD,KAAKikG,SAAL,CAAe,QAAf,CAAb;AACA,YAAIqK,OAAOtuG,KAAKikG,SAAL,CAAe,MAAf,CAAX;AACA,YAAI+f,cAAch6C,SAASoR,WAAT,GAAuBuzB,YAAvB,KAAwC,CAAxC,GAA4C,CAA9D;AACAoV,WAAGC,WAAH,KAAmB1gH,SAASgrG,OAAO,CAAnC;AACA,eAAOyV,EAAP;AACD;;AAED,aAAO,CAAChwD,GAAD,EAAMA,GAAN,CAAP;AACD,KApBoC;AAqBrC+H,mBAAe;AACbzyC,cAAQ,CADK;AAEb;AACAC,SAAG,CAHU;AAIb;AACA2wD,wBAAkB,aALL;AAMbgqC,uBAAiB,IANJ;AAOb;AACA;AACA;AACA;AACA;AACA5V,oBAAc,CAZD;AAab;AACA6V,mBAAa,CAdA;AAeb;AACAlmC,aAAO,KAhBM;AAiBbmmC,sBAAgB,GAjBH;AAkBbroF,mBAAa,GAlBA;AAmBbsoF,4BAAsB,KAnBT;AAoBb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA52C,iBAAW,EA9BE;AA+Bb5gC,gBAAU;AA/BG;AArBsB,GAAnB,CAApB;;AAwDA;;;;;;;;;;;;;;;;;;AAkBAi3E,gBAAc7kH,MAAd,CAAqB;AACnBiC,UAAM,YADa;AAEnBg8D,kBAAc,CAAC,MAAD,EAAS,OAAT,CAFK;AAGnBonD,mBAAe,MAHI;;AAKnB;;;AAGAhoC,oBAAgB,0BAAY;AAC1B;AACA,aAAO,KAAKt5E,GAAL,CAAS,OAAT,IAAoB,KAAKA,GAAL,CAAS,aAAT,CAApB,GAA8C,KAArD;AACD,KAXkB;;AAanB;;;AAGAu5E,6BAAyB,mCAAY;AACnC;AACA,UAAI3e,uBAAuB,KAAK56D,GAAL,CAAS,sBAAT,CAA3B;AACA,UAAIohH,iBAAiB,KAAKphH,GAAL,CAAS,gBAAT,CAArB;;AAEA,UAAIohH,iBAAiBxmD,oBAArB,EAA2C;AACzCA,+BAAuBwmD,cAAvB;AACD;;AAED,aAAOxmD,oBAAP;AACD;AA1BkB,GAArB;;AA6BA;;;;;;;;;;;;;;;;;;AAkBA;;;;;;AAMA,WAAS2mD,eAAT,CAAyBtkH,IAAzB,EAA+BquC,SAA/B,EAA0C;AACxC,QAAIk2E,YAAYvkH,KAAK+7E,YAAL,CAAkB,gBAAlB,EAAoC,IAApC,CAAhB;AACA,QAAIj+E,MAAMymH,UAAUxmH,MAApB,CAFwC,CAEZ;;AAE5B,QAAID,QAAQ,CAAZ,EAAe;AACb,aAAOo3E,iBAAiBl1E,IAAjB,EAAuBquC,SAAvB,EAAkCk2E,UAAU,CAAV,CAAlC,CAAP;AACD,KAFD,MAEO,IAAIzmH,GAAJ,EAAS;AACd,UAAI0mH,OAAO,EAAX;;AAEA,WAAK,IAAI3mH,IAAI,CAAb,EAAgBA,IAAI0mH,UAAUxmH,MAA9B,EAAsCF,GAAtC,EAA2C;AACzC,YAAIkE,MAAMmzE,iBAAiBl1E,IAAjB,EAAuBquC,SAAvB,EAAkCk2E,UAAU1mH,CAAV,CAAlC,CAAV;AACA2mH,aAAKnkH,IAAL,CAAU0B,GAAV;AACD;;AAED,aAAOyiH,KAAK5nG,IAAL,CAAU,GAAV,CAAP;AACD;AACF;;AAED;;;;;;;;;;;;;;;;;;AAkBA,WAAS6nG,QAAT,CAAkBx7D,WAAlB,EAA+BjpB,UAA/B,EAA2Co2C,SAA3C,EAAsD38D,KAAtD,EAA6DmlD,WAA7D,EAA0EvwB,SAA1E,EAAqFq2E,oBAArF,EAA2G;AACzG,QAAI14D,aAAaoqB,UAAU3pB,QAAV,CAAmB,OAAnB,CAAjB;AACA,QAAIk4D,kBAAkBvuC,UAAU3pB,QAAV,CAAmB,gBAAnB,CAAtB;AACAhC,kBAAcxB,WAAd,EAA2BjpB,UAA3B,EAAuCgsB,UAAvC,EAAmD24D,eAAnD,EAAoE;AAClE55D,oBAAc6T,WADoD;AAElE5T,sBAAgB3c,SAFkD;AAGlEid,mBAAag5D,gBAAgB1lD,YAAY2S,OAAZ,EAAhB,EAAuCljC,SAAvC,CAHqD;AAIlE6d,kBAAY,IAJsD;AAKlExC,iBAAWjwC;AALuD,KAApE;AAOAmrG,gBAAY37D,WAAZ;AACA27D,gBAAY5kF,UAAZ;AACD;;AAED,WAAS4kF,WAAT,CAAqBp2F,KAArB,EAA4Bk2F,oBAA5B,EAAkD;AAChD,QAAIl2F,MAAM1B,YAAN,KAAuB,SAA3B,EAAsC;AACpC0B,YAAM1B,YAAN,GAAqB43F,oBAArB;AACD;AACF;;AAED;;;;;;;;;;;;;;;;;;AAkBA,MAAIG,mBAAkB7yE,gBAAgB,CAAC,CAAC,MAAD,EAAS,OAAT,CAAD,EAAoB,CAAC,QAAD,EAAW,aAAX,CAApB,EAA+C,CAAC,WAAD,EAAc,aAAd,CAA/C,EAA6E;AACnH,GAAC,QAAD,EAAW,gBAAX,CADsC,EACR,CAAC,WAAD,EAAc,gBAAd,CADQ,EACyB,CAAC,SAAD,CADzB,EACsC,CAAC,YAAD,CADtC,EACsD,CAAC,eAAD,CADtD,EACyE,CAAC,eAAD,CADzE,EAC4F,CAAC,aAAD,CAD5F,CAAhB,CAAtB;AAEA,MAAI8yE,eAAe;AACjBD,qBAAiB,yBAAU1yE,QAAV,EAAoB;AACnC,UAAI3jB,QAAQq2F,iBAAgB,IAAhB,EAAsB1yE,QAAtB,CAAZ;;AAEA,UAAI,KAAKge,iBAAT,EAA4B;AAC1B,YAAI1kC,WAAW,KAAK0kC,iBAAL,EAAf;AACA1kC,qBAAa+C,MAAM/C,QAAN,GAAiBA,QAA9B;AACD;;AAED,aAAO+C,KAAP;AACD;AAVgB,GAAnB;;AAaA;;;;;;;;;;;;;;;;;;AAkBA,MAAIu2F,yBAAyB,CAAC,WAAD,EAAc,gBAAd,CAA7B,CAxxgC4B,CAwxgCkC;AAC9D;;AAEA/lH,SAAOsxD,MAAMl0D,SAAb,EAAwB0oH,YAAxB;AACA3tB,kBAAgB;AACdl2F,UAAM,KADQ;AAEdw8E,YAAQ,gBAAU7e,WAAV,EAAuB/vB,OAAvB,EAAgCg7B,GAAhC,EAAqC;AAC3C,WAAKm7C,eAAL,CAAqBpmD,WAArB;;AAEA,UAAIqmD,uBAAuBrmD,YAAY77D,GAAZ,CAAgB,kBAAhB,CAA3B;;AAEA,UAAIkiH,yBAAyB,aAAzB,IAA0CA,yBAAyB,OAAvE,EAAgF;AAC9E,aAAKC,YAAL,GAAoB,KAAKC,YAAL,CAAkBvmD,WAAlB,EAA+B/vB,OAA/B,EAAwCg7B,GAAxC,CAApB,GAAmE,KAAKu7C,aAAL,CAAmBxmD,WAAnB,EAAgC/vB,OAAhC,EAAyCg7B,GAAzC,CAAnE;AACD,OAFD,MAEO,CAAE;;AAET,aAAO,KAAK1Q,KAAZ;AACD,KAZa;AAad0lB,8BAA0B,kCAAUjgB,WAAV,EAAuB/vB,OAAvB,EAAgCg7B,GAAhC,EAAqC;AAC7D,WAAKw7C,MAAL;;AAEA,WAAKL,eAAL,CAAqBpmD,WAArB;AACD,KAjBa;AAkBdkgB,uBAAmB,2BAAU1mE,MAAV,EAAkBwmD,WAAlB,EAA+B/vB,OAA/B,EAAwCg7B,GAAxC,EAA6C;AAC9D;AACA,WAAKy7C,uBAAL,CAA6BltG,MAA7B,EAAqCwmD,WAArC;AACD,KArBa;AAsBdomD,qBAAiB,yBAAUpmD,WAAV,EAAuB;AACtC,UAAI2mD,cAAc3mD,YAAY+d,eAAZ,CAA4BqB,KAA9C;;AAEA,UAAI,KAAKknC,YAAL,IAAqB,IAArB,IAA6BK,cAAc,KAAKL,YAApD,EAAkE;AAChE,aAAKA,YAAL,GAAoBK,WAApB;;AAEA,aAAKF,MAAL;AACD;AACF,KA9Ba;AA+BdD,mBAAe,uBAAUxmD,WAAV,EAAuB/vB,OAAvB,EAAgCg7B,GAAhC,EAAqC;AAClD,UAAI1Q,QAAQ,KAAKA,KAAjB;AACA,UAAIn5D,OAAO4+D,YAAY2S,OAAZ,EAAX;AACA,UAAIi0C,UAAU,KAAKvyC,KAAnB;AACA,UAAI72C,QAAQwiC,YAAYqb,gBAAxB;AACA,UAAIsyB,WAAWnwE,MAAMg/C,WAAN,EAAf;AACA,UAAIqqC,oBAAJ;;AAEA,UAAIrpF,MAAMn7B,IAAN,KAAe,aAAnB,EAAkC;AAChCwkH,+BAAuBlZ,SAASoC,YAAT,EAAvB;AACD,OAFD,MAEO,IAAIvyE,MAAMn7B,IAAN,KAAe,OAAnB,EAA4B;AACjCwkH,+BAAuBlZ,SAAS1pC,GAAT,KAAiB,OAAxC;AACD;;AAED,UAAI6iD,iBAAiB9mD,YAAYlR,kBAAZ,KAAmCkR,WAAnC,GAAiD,IAAtE;AACA5+D,WAAKm4C,IAAL,CAAUqtE,OAAV,EAAmBlhH,GAAnB,CAAuB,UAAU+pC,SAAV,EAAqB;AAC1C,YAAI,CAACruC,KAAKs7D,QAAL,CAAcjtB,SAAd,CAAL,EAA+B;AAC7B;AACD;;AAED,YAAI+nC,YAAYp2E,KAAKq2E,YAAL,CAAkBhoC,SAAlB,CAAhB;AACA,YAAIoZ,SAASw8C,UAAU7nE,MAAMn7B,IAAhB,EAAsBjB,IAAtB,EAA4BquC,SAA5B,EAAuC+nC,SAAvC,CAAb;AACA,YAAIzqE,KAAKg6G,eAAevpF,MAAMn7B,IAArB,EAA2BjB,IAA3B,EAAiCquC,SAAjC,EAA4C+nC,SAA5C,EAAuD3uB,MAAvD,EAA+Dg+D,oBAA/D,EAAqFC,cAArF,CAAT;AACA1lH,aAAKukG,gBAAL,CAAsBl2D,SAAtB,EAAiC1iC,EAAjC;AACAwtD,cAAM70D,GAAN,CAAUqH,EAAV;AACAi6G,oBAAYj6G,EAAZ,EAAgB3L,IAAhB,EAAsBquC,SAAtB,EAAiC+nC,SAAjC,EAA4C3uB,MAA5C,EAAoDmX,WAApD,EAAiE6mD,oBAAjE,EAAuFrpF,MAAMn7B,IAAN,KAAe,OAAtG;AACD,OAXD,EAWGihB,MAXH,CAWU,UAAU2jG,QAAV,EAAoBC,QAApB,EAA8B;AACtC,YAAIn6G,KAAK65G,QAAQrmC,gBAAR,CAAyB2mC,QAAzB,CAAT;;AAEA,YAAI,CAAC9lH,KAAKs7D,QAAL,CAAcuqD,QAAd,CAAL,EAA8B;AAC5B1sD,gBAAMzjD,MAAN,CAAa/J,EAAb;AACA;AACD;;AAED,YAAIyqE,YAAYp2E,KAAKq2E,YAAL,CAAkBwvC,QAAlB,CAAhB;AACA,YAAIp+D,SAASw8C,UAAU7nE,MAAMn7B,IAAhB,EAAsBjB,IAAtB,EAA4B6lH,QAA5B,EAAsCzvC,SAAtC,CAAb;;AAEA,YAAIzqE,EAAJ,EAAQ;AACNqiD,sBAAYriD,EAAZ,EAAgB;AACdmsB,mBAAO2vB;AADO,WAAhB,EAEGi+D,cAFH,EAEmBG,QAFnB;AAGD,SAJD,MAIO;AACLl6G,eAAKg6G,eAAevpF,MAAMn7B,IAArB,EAA2BjB,IAA3B,EAAiC6lH,QAAjC,EAA2CzvC,SAA3C,EAAsD3uB,MAAtD,EAA8Dg+D,oBAA9D,EAAoFC,cAApF,EAAoG,IAApG,CAAL;AACD;;AAED1lH,aAAKukG,gBAAL,CAAsBshB,QAAtB,EAAgCl6G,EAAhC,EAnBsC,CAmBD;;AAErCwtD,cAAM70D,GAAN,CAAUqH,EAAV;AACAi6G,oBAAYj6G,EAAZ,EAAgB3L,IAAhB,EAAsB6lH,QAAtB,EAAgCzvC,SAAhC,EAA2C3uB,MAA3C,EAAmDmX,WAAnD,EAAgE6mD,oBAAhE,EAAsFrpF,MAAMn7B,IAAN,KAAe,OAArG;AACD,OAlCD,EAkCGyU,MAlCH,CAkCU,UAAU24B,SAAV,EAAqB;AAC7B,YAAI1iC,KAAK65G,QAAQrmC,gBAAR,CAAyB9wC,SAAzB,CAAT;;AAEA,YAAIjS,MAAMn7B,IAAN,KAAe,aAAnB,EAAkC;AAChC0K,gBAAMo6G,WAAW13E,SAAX,EAAsBq3E,cAAtB,EAAsC/5G,EAAtC,CAAN;AACD,SAFD,MAEO;AACLA,gBAAMq6G,aAAa33E,SAAb,EAAwBq3E,cAAxB,EAAwC/5G,EAAxC,CAAN;AACD;AACF,OA1CD,EA0CG+sF,OA1CH;AA2CA,WAAKzlB,KAAL,GAAajzE,IAAb;AACD,KA1Fa;AA2FdmlH,kBAAc,sBAAUvmD,WAAV,EAAuB/vB,OAAvB,EAAgCg7B,GAAhC,EAAqC;AACjD,WAAKw7C,MAAL;;AAEAY,kBAAYrnD,WAAZ,EAAyB,KAAKzF,KAA9B;AACD,KA/Fa;AAgGdmsD,6BAAyB,iCAAUltG,MAAV,EAAkBwmD,WAAlB,EAA+B;AACtDqnD,kBAAYrnD,WAAZ,EAAyB,KAAKzF,KAA9B,EAAqC,IAArC;AACD,KAlGa;AAmGdxvD,aAASpG,IAnGK;AAoGdmS,YAAQ,gBAAUm5B,OAAV,EAAmB;AACzB,WAAKw2E,MAAL,CAAYx2E,OAAZ;AACD,KAtGa;AAuGdw2E,YAAQ,gBAAUx2E,OAAV,EAAmB;AACzB,UAAIsqB,QAAQ,KAAKA,KAAjB;AACA,UAAIn5D,OAAO,KAAKizE,KAAhB;;AAEA,UAAIpkC,WAAWA,QAAQ9rC,GAAR,CAAY,WAAZ,CAAX,IAAuC/C,IAAvC,IAA+C,CAAC,KAAKklH,YAAzD,EAAuE;AACrEllH,aAAKo/E,iBAAL,CAAuB,UAAUzzE,EAAV,EAAc;AACnC,cAAIA,GAAG1K,IAAH,KAAY,QAAhB,EAA0B;AACxB+kH,yBAAar6G,GAAG0iC,SAAhB,EAA2BQ,OAA3B,EAAoCljC,EAApC;AACD,WAFD,MAEO;AACLo6G,uBAAWp6G,GAAG0iC,SAAd,EAAyBQ,OAAzB,EAAkCljC,EAAlC;AACD;AACF,SAND;AAOD,OARD,MAQO;AACLwtD,cAAM1zC,SAAN;AACD;;AAED,WAAKwtD,KAAL,GAAa,IAAb;AACD;AAxHa,GAAhB;AA0HA,MAAI0yC,iBAAiB;AACnBxmD,iBAAa,qBAAUn/D,IAAV,EAAgBquC,SAAhB,EAA2B+nC,SAA3B,EAAsC3uB,MAAtC,EAA8CknD,YAA9C,EAA4D+W,cAA5D,EAA4En4D,QAA5E,EAAsF;AACjG,UAAIjpC,OAAO,IAAIghC,IAAJ,CAAS;AAClBxtB,eAAO94B,OAAO,EAAP,EAAWyoD,MAAX;AADW,OAAT,CAAX,CADiG,CAG7F;;AAEJ,UAAIi+D,cAAJ,EAAoB;AAClB,YAAIQ,YAAY5hG,KAAKwT,KAArB;AACA,YAAIquF,kBAAkBxX,eAAe,QAAf,GAA0B,OAAhD;AACA,YAAIyX,gBAAgB,EAApB;AACAF,kBAAUC,eAAV,IAA6B,CAA7B;AACAC,sBAAcD,eAAd,IAAiC1+D,OAAO0+D,eAAP,CAAjC;AACAx2D,gBAAQpC,WAAW,aAAX,GAA2B,WAAnC,EAAgDjpC,IAAhD,EAAsD;AACpDwT,iBAAOsuF;AAD6C,SAAtD,EAEGV,cAFH,EAEmBr3E,SAFnB;AAGD;;AAED,aAAO/pB,IAAP;AACD,KAlBkB;AAmBnBo7C,WAAO,eAAU1/D,IAAV,EAAgBquC,SAAhB,EAA2B+nC,SAA3B,EAAsC3uB,MAAtC,EAA8C4+D,QAA9C,EAAwDX,cAAxD,EAAwEn4D,QAAxE,EAAkF;AACvF;AACA;AACA;AACA;AACA,UAAI7J,YAAY+D,OAAO3P,UAAP,GAAoB2P,OAAO1P,QAA3C;AACA,UAAIuuE,SAAS,IAAI9iE,MAAJ,CAAW;AACtB1rB,eAAO74B,SAAS;AACdykD,qBAAWA;AADG,SAAT,EAEJ+D,MAFI;AADe,OAAX,CAAb,CANuF,CAUnF;;AAEJ,UAAIi+D,cAAJ,EAAoB;AAClB,YAAIa,cAAcD,OAAOxuF,KAAzB;AACA,YAAIquF,kBAAkBE,WAAW,GAAX,GAAiB,UAAvC;AACA,YAAID,gBAAgB,EAApB;AACAG,oBAAYJ,eAAZ,IAA+BE,WAAW,CAAX,GAAe5+D,OAAO3P,UAArD;AACAsuE,sBAAcD,eAAd,IAAiC1+D,OAAO0+D,eAAP,CAAjC;AACAx2D,gBAAQpC,WAAW,aAAX,GAA2B,WAAnC,EAAgD+4D,MAAhD,EAAwD;AACtDxuF,iBAAOsuF;AAD+C,SAAxD,EAEGV,cAFH,EAEmBr3E,SAFnB;AAGD;;AAED,aAAOi4E,MAAP;AACD;AA3CkB,GAArB;;AA8CA,WAASP,UAAT,CAAoB13E,SAApB,EAA+Bq3E,cAA/B,EAA+C/5G,EAA/C,EAAmD;AACjD;AACAA,OAAG6iB,KAAH,CAASxC,IAAT,GAAgB,IAAhB;AACAgiC,gBAAYriD,EAAZ,EAAgB;AACdmsB,aAAO;AACL5U,eAAO;AADF;AADO,KAAhB,EAIGwiG,cAJH,EAImBr3E,SAJnB,EAI8B,YAAY;AACxC1iC,SAAGI,MAAH,IAAaJ,GAAGI,MAAH,CAAU2J,MAAV,CAAiB/J,EAAjB,CAAb;AACD,KAND;AAOD;;AAED,WAASq6G,YAAT,CAAsB33E,SAAtB,EAAiCq3E,cAAjC,EAAiD/5G,EAAjD,EAAqD;AACnD;AACAA,OAAG6iB,KAAH,CAASxC,IAAT,GAAgB,IAAhB;AACAgiC,gBAAYriD,EAAZ,EAAgB;AACdmsB,aAAO;AACL1gB,WAAGzL,GAAGmsB,KAAH,CAAS2rB;AADP;AADO,KAAhB,EAIGiiE,cAJH,EAImBr3E,SAJnB,EAI8B,YAAY;AACxC1iC,SAAGI,MAAH,IAAaJ,GAAGI,MAAH,CAAU2J,MAAV,CAAiB/J,EAAjB,CAAb;AACD,KAND;AAOD;;AAED,MAAIs4F,YAAY;AACd9kC,iBAAa,qBAAUn/D,IAAV,EAAgBquC,SAAhB,EAA2B+nC,SAA3B,EAAsC;AACjD,UAAI3uB,SAASznD,KAAKkkG,aAAL,CAAmB71D,SAAnB,CAAb;AACA,UAAIm4E,iBAAiBC,aAAarwC,SAAb,EAAwB3uB,MAAxB,CAArB,CAFiD,CAEK;;AAEtD,UAAIi/D,QAAQj/D,OAAOvkC,KAAP,GAAe,CAAf,GAAmB,CAAnB,GAAuB,CAAC,CAApC;AACA,UAAIyjG,QAAQl/D,OAAOtkC,MAAP,GAAgB,CAAhB,GAAoB,CAApB,GAAwB,CAAC,CAArC;AACA,aAAO;AACLnf,WAAGyjD,OAAOzjD,CAAP,GAAW0iH,QAAQF,cAAR,GAAyB,CADlC;AAELviH,WAAGwjD,OAAOxjD,CAAP,GAAW0iH,QAAQH,cAAR,GAAyB,CAFlC;AAGLtjG,eAAOukC,OAAOvkC,KAAP,GAAewjG,QAAQF,cAHzB;AAILrjG,gBAAQskC,OAAOtkC,MAAP,GAAgBwjG,QAAQH;AAJ3B,OAAP;AAMD,KAba;AAcd9mD,WAAO,eAAU1/D,IAAV,EAAgBquC,SAAhB,EAA2B+nC,SAA3B,EAAsC;AAC3C,UAAI3uB,SAASznD,KAAKkkG,aAAL,CAAmB71D,SAAnB,CAAb;AACA,aAAO;AACLsM,YAAI8M,OAAO9M,EADN;AAELC,YAAI6M,OAAO7M,EAFN;AAGL6I,YAAIgE,OAAOhE,EAHN;AAILrsC,WAAGqwC,OAAOrwC,CAJL;AAKL0gC,oBAAY2P,OAAO3P,UALd;AAMLC,kBAAU0P,OAAO1P;AANZ,OAAP;AAQD;AAxBa,GAAhB;;AA2BA,WAAS6tE,WAAT,CAAqBj6G,EAArB,EAAyB3L,IAAzB,EAA+BquC,SAA/B,EAA0C+nC,SAA1C,EAAqD3uB,MAArD,EAA6DmX,WAA7D,EAA0E+vC,YAA1E,EAAwFiY,OAAxF,EAAiG;AAC/F,QAAIntG,QAAQzZ,KAAK+1E,aAAL,CAAmB1nC,SAAnB,EAA8B,OAA9B,CAAZ;AACA,QAAI7iB,UAAUxrB,KAAK+1E,aAAL,CAAmB1nC,SAAnB,EAA8B,SAA9B,CAAd;AACA,QAAIw4E,iBAAiBzwC,UAAU3pB,QAAV,CAAmB,WAAnB,CAArB;AACA,QAAIzsB,aAAao2C,UAAU3pB,QAAV,CAAmB,oBAAnB,EAAyCo4D,eAAzC,EAAjB;;AAEA,QAAI,CAAC+B,OAAL,EAAc;AACZj7G,SAAGy0C,QAAH,CAAY,GAAZ,EAAiBymE,eAAe9jH,GAAf,CAAmB,iBAAnB,KAAyC,CAA1D;AACD;;AAED4I,OAAG4wB,QAAH,CAAYt9B,SAAS;AACnBqsB,YAAM7R,KADa;AAEnB+R,eAASA;AAFU,KAAT,EAGTq7F,eAAehC,eAAf,EAHS,CAAZ;AAIA,QAAIn5G,cAAc0qE,UAAU/jC,UAAV,CAAqB,QAArB,CAAlB;AACA3mC,mBAAeC,GAAGkW,IAAH,CAAQ,QAAR,EAAkBnW,WAAlB,CAAf;AACA,QAAIg5G,uBAAuB/V,eAAelnD,OAAOtkC,MAAP,GAAgB,CAAhB,GAAoB,QAApB,GAA+B,KAA9C,GAAsDskC,OAAOvkC,KAAP,GAAe,CAAf,GAAmB,MAAnB,GAA4B,OAA7G;;AAEA,QAAI,CAAC0jG,OAAL,EAAc;AACZnC,eAAS94G,GAAG6iB,KAAZ,EAAmBwR,UAAnB,EAA+Bo2C,SAA/B,EAA0C38D,KAA1C,EAAiDmlD,WAAjD,EAA8DvwB,SAA9D,EAAyEq2E,oBAAzE;AACD;;AAEDn6D,kBAAc5+C,EAAd,EAAkBq0B,UAAlB;AACD,GA9ghC2B,CA8ghC1B;;;AAGF,WAASymF,YAAT,CAAsBrwC,SAAtB,EAAiC0wC,SAAjC,EAA4C;AAC1C,QAAIh7F,YAAYsqD,UAAUrzE,GAAV,CAAcgiH,sBAAd,KAAyC,CAAzD;AACA,WAAOpgH,KAAKoB,GAAL,CAAS+lB,SAAT,EAAoBnnB,KAAKyzC,GAAL,CAAS0uE,UAAU5jG,KAAnB,CAApB,EAA+Cve,KAAKyzC,GAAL,CAAS0uE,UAAU3jG,MAAnB,CAA/C,CAAP;AACD;;AAED,MAAI4jG,YAAY/nE,KAAKhgD,MAAL,CAAY;AAC1BiC,UAAM,UADoB;AAE1B62B,WAAO;AACL6P,cAAQ;AADH,KAFmB;AAK1B9P,eAAW,mBAAU3vB,GAAV,EAAe4vB,KAAf,EAAsB;AAC/B;AACA;AACA,UAAI6P,SAAS7P,MAAM6P,MAAnB;AACA,UAAIq/E,aAAa,KAAKC,YAAtB;AACA,UAAIC,WAAW,KAAKC,UAApB;;AAEA,WAAK,IAAItpH,IAAI,CAAb,EAAgBA,IAAI8pC,OAAO5pC,MAA3B,EAAmCF,KAAK,CAAxC,EAA2C;AACzCmpH,mBAAW,KAAKG,UAAhB,IAA8Bx/E,OAAO9pC,IAAIqpH,QAAX,CAA9B;AACAh/G,YAAIkwB,MAAJ,CAAW4uF,WAAW,CAAX,CAAX,EAA0BA,WAAW,CAAX,CAA1B;AACA9+G,YAAImwB,MAAJ,CAAWsP,OAAO9pC,CAAP,CAAX,EAAsB8pC,OAAO9pC,IAAI,CAAX,CAAtB;AACD;AACF;AAjByB,GAAZ,CAAhB;;AAoBA,WAASooH,WAAT,CAAqBrnD,WAArB,EAAkCzF,KAAlC,EAAyC9nC,WAAzC,EAAsD;AACpD;AACA,QAAIrxB,OAAO4+D,YAAY2S,OAAZ,EAAX;AACA,QAAIy1C,aAAa,EAAjB;AACA,QAAIE,WAAWlnH,KAAKikG,SAAL,CAAe,qBAAf,IAAwC,CAAxC,GAA4C,CAA3D;AACA+iB,eAAW,IAAIE,QAAf,IAA2BlnH,KAAKikG,SAAL,CAAe,gBAAf,CAA3B;AACA,QAAIt4F,KAAK,IAAIo7G,SAAJ,CAAc;AACrBjvF,aAAO;AACL6P,gBAAQ3nC,KAAKikG,SAAL,CAAe,aAAf;AADH,OADc;AAIrB5yE,mBAAa,CAAC,CAACA,WAJM;AAKrB41F,oBAAcD,UALO;AAMrBG,kBAAYD;AANS,KAAd,CAAT;AAQA/tD,UAAM70D,GAAN,CAAUqH,EAAV;AACAy7G,kBAAcz7G,EAAd,EAAkBizD,WAAlB,EAA+B5+D,IAA/B;AACD;;AAED,WAASonH,aAAT,CAAuBz7G,EAAvB,EAA2BizD,WAA3B,EAAwC5+D,IAAxC,EAA8C;AAC5C,QAAI2qF,cAAc3qF,KAAKqwF,SAAL,CAAe,aAAf,KAAiCrwF,KAAKqwF,SAAL,CAAe,OAAf,CAAnD;AACA,QAAI7iB,YAAY5O,YAAYnS,QAAZ,CAAqB,WAArB,EAAkCwD,YAAlC,CAA+C,CAAC,OAAD,EAAU,aAAV,CAA/C,CAAhB;AACAtkD,OAAG4wB,QAAH,CAAYixC,SAAZ;AACA7hE,OAAG6iB,KAAH,CAASlD,IAAT,GAAgB,IAAhB;AACA3f,OAAG6iB,KAAH,CAASjD,MAAT,GAAkBo/D,WAAlB;AACAh/E,OAAG6iB,KAAH,CAAS1C,SAAT,GAAqB9rB,KAAKikG,SAAL,CAAe,UAAf,CAArB;AACD;;AAED;;;;;;;;;;;;;;;;;;AAkBA,MAAIojB,OAAO1iH,KAAKgN,EAAhB;;AAEA,WAAS21G,qBAAT,CAA+BhnD,SAA/B,EAA0C;AACxC,QAAIyzB,YAAY;AACdnkD,qBAAe0wB,UAAUpxB;AADX,KAAhB;AAGA6kD,cAAUzzB,UAAUpxB,QAAV,GAAqB,OAA/B,IAA0CoxB,UAAUzE,cAApD;AACA,WAAOk4B,SAAP;AACD;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwCA,MAAIwzB,cAAc,SAAdA,WAAc,CAAUjnD,SAAV,EAAqB5zB,GAArB,EAA0B;AAC1C;;;AAGA,SAAKA,GAAL,GAAWA,GAAX;AACA;;;;AAIA,SAAK4zB,SAAL,GAAiBA,SAAjB,CAT0C,CASd;;AAE5BrhE,aAASytC,GAAT,EAAc;AACZ86E,mBAAa,CADD;AAEZC,qBAAe,CAFH;AAGZC,qBAAe,CAHH;AAIZC,sBAAgB,CAJJ;AAKZ/7G,cAAQ;AALI,KAAd;AAOA;;;;AAIA,SAAKutD,KAAL,GAAa,IAAI30C,KAAJ,EAAb,CAtB0C,CAsBhB;;AAE1B,QAAIojG,YAAY,IAAIpjG,KAAJ,CAAU;AACxBnV,gBAAUq9B,IAAIr9B,QAAJ,CAAaxS,KAAb,EADc;AAExByS,gBAAUo9B,IAAIp9B;AAFU,KAAV,CAAhB,CAxB0C,CA2BtC;AACJ;;AAEAs4G,cAAUj4G,eAAV;AACA,SAAKk4G,UAAL,GAAkBD,UAAUn4G,SAA5B;AACA,SAAKq4G,UAAL,GAAkBF,SAAlB;AACD,GAjCD;;AAmCAL,cAAYnrH,SAAZ,GAAwB;AACtB6B,iBAAaspH,WADS;AAEtBQ,gBAAY,oBAAU3qH,IAAV,EAAgB;AAC1B,aAAO,CAAC,CAAC4qH,SAAS5qH,IAAT,CAAT;AACD,KAJqB;AAKtBkH,SAAK,aAAUlH,IAAV,EAAgB;AACnB4qH,eAAS5qH,IAAT,EAAeO,IAAf,CAAoB,IAApB;AACD,KAPqB;AAQtBsqH,cAAU,oBAAY;AACpB,aAAO,KAAK9uD,KAAZ;AACD;AAVqB,GAAxB;AAYA,MAAI6uD,WAAW;AACb;;;AAGA/9B,cAAU,oBAAY;AACpB,UAAIv9C,MAAM,KAAKA,GAAf;AACA,UAAI4zB,YAAY,KAAKA,SAArB;;AAEA,UAAI,CAACA,UAAUv9D,GAAV,CAAc,eAAd,CAAL,EAAqC;AACnC;AACD;;AAED,UAAI89F,SAAS,KAAKvgC,SAAL,CAAeyrC,IAAf,CAAoBtD,SAApB,EAAb;AACA,UAAI15F,SAAS,KAAK84G,UAAlB;AACA,UAAIK,MAAM,CAACrnB,OAAO,CAAP,CAAD,EAAY,CAAZ,CAAV;AACA,UAAIsnB,MAAM,CAACtnB,OAAO,CAAP,CAAD,EAAY,CAAZ,CAAV;;AAEA,UAAI9xF,MAAJ,EAAY;AACVlJ,uBAAeqiH,GAAf,EAAoBA,GAApB,EAAyBn5G,MAAzB;AACAlJ,uBAAesiH,GAAf,EAAoBA,GAApB,EAAyBp5G,MAAzB;AACD;;AAED,UAAIm7E,YAAYlrF,OAAO;AACrBkmF,iBAAS;AADY,OAAP,EAEb5kB,UAAU7T,QAAV,CAAmB,oBAAnB,EAAyCna,YAAzC,EAFa,CAAhB;AAGA,WAAK6mB,KAAL,CAAW70D,GAAX,CAAe,IAAIihD,IAAJ,CAAS2C,qBAAqB;AAC3C;AACA+G,cAAM,MAFqC;AAG3Cn3B,eAAO;AACLwd,cAAI4yE,IAAI,CAAJ,CADC;AAEL3yE,cAAI2yE,IAAI,CAAJ,CAFC;AAGLh9F,cAAIi9F,IAAI,CAAJ,CAHC;AAILh9F,cAAIg9F,IAAI,CAAJ;AAJC,SAHoC;AAS3C35F,eAAO07D,SAToC;AAU3ChrC,gCAAwBxS,IAAIwS,sBAAJ,IAA8B,CAVX;AAW3CtzC,gBAAQ,IAXmC;AAY3C2d,YAAI;AAZuC,OAArB,CAAT,CAAf;AAcA,UAAI6+F,SAAS9nD,UAAUv9D,GAAV,CAAc,iBAAd,CAAb;AACA,UAAIslH,YAAY/nD,UAAUv9D,GAAV,CAAc,qBAAd,CAAhB;AACA,UAAIulH,cAAchoD,UAAUv9D,GAAV,CAAc,uBAAd,KAA0C,CAA5D;;AAEA,UAAI,OAAOulH,WAAP,KAAuB,QAA3B,EAAqC;AACnCA,sBAAc,CAACA,WAAD,EAAcA,WAAd,CAAd;AACD;;AAED,UAAIF,UAAU,IAAd,EAAoB;AAClB,YAAI,OAAOA,MAAP,KAAkB,QAAtB,EAAgC;AAC9B;AACAA,mBAAS,CAACA,MAAD,EAASA,MAAT,CAAT;AACD;;AAED,YAAI,OAAOC,SAAP,KAAqB,QAArB,IAAiC,OAAOA,SAAP,KAAqB,QAA1D,EAAoE;AAClE;AACAA,sBAAY,CAACA,SAAD,EAAYA,SAAZ,CAAZ;AACD;;AAED,YAAIE,cAAcF,UAAU,CAAV,CAAlB;AACA,YAAIG,eAAeH,UAAU,CAAV,CAAnB;AACApoH,eAAO,CAAC;AACN4N,kBAAQ6+B,IAAIp9B,QAAJ,GAAe3K,KAAKgN,EAAL,GAAU,CAD3B;AAENrO,kBAAQglH,YAAY,CAAZ,CAFF;AAGNlxG,aAAG;AAHG,SAAD,EAIJ;AACDvJ,kBAAQ6+B,IAAIp9B,QAAJ,GAAe3K,KAAKgN,EAAL,GAAU,CADhC;AAEDrO,kBAAQglH,YAAY,CAAZ,CAFP;AAGDlxG,aAAGzS,KAAKC,IAAL,CAAU,CAACsjH,IAAI,CAAJ,IAASC,IAAI,CAAJ,CAAV,KAAqBD,IAAI,CAAJ,IAASC,IAAI,CAAJ,CAA9B,IAAwC,CAACD,IAAI,CAAJ,IAASC,IAAI,CAAJ,CAAV,KAAqBD,IAAI,CAAJ,IAASC,IAAI,CAAJ,CAA9B,CAAlD;AAHF,SAJI,CAAP,EAQI,UAAUxjE,KAAV,EAAiBvuB,KAAjB,EAAwB;AAC1B,cAAIgyF,OAAOhyF,KAAP,MAAkB,MAAlB,IAA4BgyF,OAAOhyF,KAAP,KAAiB,IAAjD,EAAuD;AACrD,gBAAI60D,SAAS8rB,aAAaqR,OAAOhyF,KAAP,CAAb,EAA4B,CAACmyF,WAAD,GAAe,CAA3C,EAA8C,CAACC,YAAD,GAAgB,CAA9D,EAAiED,WAAjE,EAA8EC,YAA9E,EAA4Ft+B,UAAU3+D,MAAtG,EAA8G,IAA9G,CAAb,CADqD,CAC6E;;AAElI,gBAAInU,IAAIutC,MAAMvtC,CAAN,GAAUutC,MAAMrhD,MAAxB;AACA,gBAAIskC,MAAM,CAACsgF,IAAI,CAAJ,IAAS9wG,IAAIzS,KAAK6J,GAAL,CAASk+B,IAAIp9B,QAAb,CAAd,EAAsC44G,IAAI,CAAJ,IAAS9wG,IAAIzS,KAAK2J,GAAL,CAASo+B,IAAIp9B,QAAb,CAAnD,CAAV;AACA27E,mBAAOppE,IAAP,CAAY;AACVvS,wBAAUq1C,MAAM92C,MADN;AAEVwB,wBAAUu4B,GAFA;AAGVh8B,sBAAQ;AAHE,aAAZ;AAKA,iBAAKutD,KAAL,CAAW70D,GAAX,CAAe2mF,MAAf;AACD;AACF,SArBD,EAqBG,IArBH;AAsBD;AACF,KAnFY;;AAqFb;;;AAGAw9B,mBAAe,yBAAY;AACzB,UAAInoD,YAAY,KAAKA,SAArB;AACA,UAAI5zB,MAAM,KAAKA,GAAf;AACA,UAAIg8E,UAAUC,cAAc,IAAd,EAAoBroD,SAApB,EAA+B5zB,GAA/B,CAAd;AACA,UAAIk8E,WAAWC,eAAe,IAAf,EAAqBvoD,SAArB,EAAgC5zB,GAAhC,CAAf;AACAo8E,yBAAmBxoD,SAAnB,EAA8BsoD,QAA9B,EAAwCF,OAAxC;AACD,KA9FY;;AAgGb;;;AAGAj5C,cAAU,oBAAY;AACpB,UAAI/iC,MAAM,KAAKA,GAAf;AACA,UAAI4zB,YAAY,KAAKA,SAArB;AACA,UAAIljE,OAAOkE,SAASorC,IAAI+iC,QAAb,EAAuBnP,UAAUv9D,GAAV,CAAc,MAAd,CAAvB,CAAX;;AAEA,UAAI,CAAC3F,IAAL,EAAW;AACT;AACD;;AAED,UAAIgiH,eAAe9+C,UAAUv9D,GAAV,CAAc,cAAd,CAAnB;AACA,UAAI0kH,gBAAgB/6E,IAAI+6E,aAAxB;AACA,UAAI97D,iBAAiB2U,UAAU7T,QAAV,CAAmB,eAAnB,CAArB;AACA,UAAIh5C,MAAM6sD,UAAUv9D,GAAV,CAAc,SAAd,KAA4B,CAAtC;AACA,UAAI89F,SAAS,KAAKvgC,SAAL,CAAeyrC,IAAf,CAAoBtD,SAApB,EAAb;AACA,UAAIsgB,YAAYloB,OAAO,CAAP,IAAYA,OAAO,CAAP,CAAZ,GAAwB,CAAC,CAAzB,GAA6B,CAA7C;AACA,UAAIj5D,MAAM,CAACw3E,iBAAiB,OAAjB,GAA2Bve,OAAO,CAAP,IAAYkoB,YAAYt1G,GAAnD,GAAyD2rG,iBAAiB,KAAjB,GAAyBve,OAAO,CAAP,IAAYkoB,YAAYt1G,GAAjD,GAAuD,CAACotF,OAAO,CAAP,IAAYA,OAAO,CAAP,CAAb,IAA0B,CAA3I,EAA8I;AACxJ;AACAmoB,2BAAqB5J,YAArB,IAAqC1yE,IAAI86E,WAAJ,GAAkBC,gBAAgBh0G,GAAvE,GAA6E,CAFnE,CAAV;AAGA,UAAIw1G,WAAJ;AACA,UAAIC,eAAe5oD,UAAUv9D,GAAV,CAAc,YAAd,CAAnB;;AAEA,UAAImmH,gBAAgB,IAApB,EAA0B;AACxBA,uBAAeA,eAAe7B,IAAf,GAAsB,GAArC,CADwB,CACkB;AAC3C;;AAED,UAAI8B,sBAAJ;;AAEA,UAAIH,qBAAqB5J,YAArB,CAAJ,EAAwC;AACtC6J,sBAAcG,gBAAgB18E,IAAIp9B,QAApB,EAA8B45G,gBAAgB,IAAhB,GAAuBA,YAAvB,GAAsCx8E,IAAIp9B,QAAxE,EAAkF;AAChGm4G,qBADc,CAAd;AAED,OAHD,MAGO;AACLwB,sBAAcI,cAAc38E,GAAd,EAAmB0yE,YAAnB,EAAiC8J,gBAAgB,CAAjD,EAAoDroB,MAApD,CAAd;AACAsoB,iCAAyBz8E,IAAIy8E,sBAA7B;;AAEA,YAAIA,0BAA0B,IAA9B,EAAoC;AAClCA,mCAAyBxkH,KAAKyzC,GAAL,CAAS+wE,yBAAyBxkH,KAAK2J,GAAL,CAAS26G,YAAY35G,QAArB,CAAlC,CAAzB;AACA,WAAC+4B,SAAS8gF,sBAAT,CAAD,KAAsCA,yBAAyB,IAA/D;AACD;AACF;;AAED,UAAIj9F,WAAWy/B,eAAeyB,OAAf,EAAf;AACA,UAAIk8D,cAAchpD,UAAUv9D,GAAV,CAAc,cAAd,EAA8B,IAA9B,KAAuC,EAAzD;AACA,UAAI8xB,WAAWy0F,YAAYz0F,QAA3B;AACA,UAAIukC,WAAW93D,SAASorC,IAAI68E,oBAAb,EAAmCD,YAAYlwD,QAA/C,EAAyD+vD,sBAAzD,CAAf,CA3CoB,CA2C6E;AACjG;;AAEA,UAAIK,gBAAgB30F,YAAY,IAAZ,IAAoBukC,YAAY,IAAhC,GAAuCR,eAAex7D,IAAf,EAAqBg8D,QAArB,EAA+BltC,QAA/B,EAAyC2I,QAAzC,EAAmD;AAC5GI,iBAAS,CADmG;AAE5GG,qBAAak0F,YAAYl0F;AAFmF,OAAnD,CAAvC,GAGfh4B,IAHL;AAIA,UAAIqsH,aAAanpD,UAAUv9D,GAAV,CAAc,SAAd,EAAyB,IAAzB,CAAjB;AACA,UAAImsC,WAAWoxB,UAAUpxB,QAAzB;AACA,UAAIw6E,kBAAkB;AACpB95E,uBAAeV,QADK;AAEpB9xC,cAAMA,IAFc;AAGpB66D,eAAO,CAAC,MAAD;AAHa,OAAtB;AAKAyxD,sBAAgBx6E,WAAW,OAA3B,IAAsCoxB,UAAUzE,cAAhD;AACA,UAAI8tD,SAAS,IAAI1mE,IAAJ,CAAS;AACpB;AACAgM,cAAM,MAFc;AAGpB26D,oBAAYxsH,IAHQ;AAIpBysH,yBAAiBL,aAJG;AAKpBn6G,kBAAUu4B,GALU;AAMpBt4B,kBAAU25G,YAAY35G,QANF;AAOpB1D,gBAAQzD,SAASm4D,SAAT,CAPY;AAQpB/2C,YAAI,CARgB;AASpBknD,iBAASg5C,cAAcA,WAAWlnG,IAAzB,GAAgCvjB,OAAO;AAC9C8qH,mBAAS1sH,IADqC;AAE9Ck5E,qBAAW,qBAAY;AACrB,mBAAOl5E,IAAP;AACD,WAJ6C;AAK9CssH,2BAAiBA;AAL6B,SAAP,EAMtCD,UANsC,CAAhC,GAMQ;AAfG,OAAT,CAAb;AAiBAh+D,mBAAak+D,OAAOn7F,KAApB,EAA2Bm9B,cAA3B,EAA2C;AACzC3/B,cAAMw9F,aADmC;AAEzCt9F,kBAAUA,QAF+B;AAGzCM,kBAAUm/B,eAAeoE,YAAf,MAAiCuQ,UAAUv9D,GAAV,CAAc,0BAAd,CAHF;AAIzCkqB,mBAAWg8F,YAAYh8F,SAJkB;AAKzCC,2BAAmB+7F,YAAY/7F;AALU,OAA3C;;AAQA,UAAIozC,UAAUv9D,GAAV,CAAc,cAAd,CAAJ,EAAmC;AACjC4mH,eAAO51B,SAAP,GAAmBuzB,sBAAsBhnD,SAAtB,CAAnB;AACAqpD,eAAO51B,SAAP,CAAiBg2B,UAAjB,GAA8B,UAA9B;AACAJ,eAAO51B,SAAP,CAAiB32F,IAAjB,GAAwBA,IAAxB;AACD,OAvFmB,CAuFlB;;;AAGF,WAAK0qH,UAAL,CAAgBxjH,GAAhB,CAAoBqlH,MAApB;;AAEAA,aAAOh6G,eAAP;AACA,WAAKwpD,KAAL,CAAW70D,GAAX,CAAeqlH,MAAf;AACAA,aAAOx5G,kBAAP;AACD;AAlMY,GAAf;AAoMA;;;;;;;;;;;;;;AAcA,MAAIi5G,kBAAkB7B,YAAY6B,eAAZ,GAA8B,UAAUY,YAAV,EAAwBn8F,YAAxB,EAAsC2gC,SAAtC,EAAiD;AACnG,QAAIy7D,eAAev0D,UAAU7nC,eAAem8F,YAAzB,CAAnB;AACA,QAAI/8F,SAAJ;AACA,QAAIC,iBAAJ;;AAEA,QAAI2oC,mBAAmBo0D,YAAnB,CAAJ,EAAsC;AACpC;AACA/8F,0BAAoBshC,YAAY,CAAZ,GAAgB,KAAhB,GAAwB,QAA5C;AACAvhC,kBAAY,QAAZ;AACD,KAJD,MAIO,IAAI4oC,mBAAmBo0D,eAAe5C,IAAlC,CAAJ,EAA6C;AAClD;AACAn6F,0BAAoBshC,YAAY,CAAZ,GAAgB,QAAhB,GAA2B,KAA/C;AACAvhC,kBAAY,QAAZ;AACD,KAJM,MAIA;AACLC,0BAAoB,QAApB;;AAEA,UAAI+8F,eAAe,CAAf,IAAoBA,eAAe5C,IAAvC,EAA6C;AAC3Cp6F,oBAAYuhC,YAAY,CAAZ,GAAgB,OAAhB,GAA0B,MAAtC;AACD,OAFD,MAEO;AACLvhC,oBAAYuhC,YAAY,CAAZ,GAAgB,MAAhB,GAAyB,OAArC;AACD;AACF;;AAED,WAAO;AACLl/C,gBAAU26G,YADL;AAELh9F,iBAAWA,SAFN;AAGLC,yBAAmBA;AAHd,KAAP;AAKD,GA5BD;;AA8BA,WAASm8F,aAAT,CAAuB38E,GAAvB,EAA4B5f,YAA5B,EAA0Co9F,UAA1C,EAAsDrpB,MAAtD,EAA8D;AAC5D,QAAIopB,eAAev0D,UAAUw0D,aAAax9E,IAAIp9B,QAA3B,CAAnB;AACA,QAAI2d,SAAJ;AACA,QAAIC,iBAAJ;AACA,QAAIqvF,UAAU1b,OAAO,CAAP,IAAYA,OAAO,CAAP,CAA1B;AACA,QAAIspB,SAASr9F,iBAAiB,OAAjB,IAA4B,CAACyvF,OAA7B,IAAwCzvF,iBAAiB,OAAjB,IAA4ByvF,OAAjF;;AAEA,QAAI1mD,mBAAmBo0D,eAAe5C,OAAO,CAAzC,CAAJ,EAAiD;AAC/Cn6F,0BAAoBi9F,SAAS,QAAT,GAAoB,KAAxC;AACAl9F,kBAAY,QAAZ;AACD,KAHD,MAGO,IAAI4oC,mBAAmBo0D,eAAe5C,OAAO,GAAzC,CAAJ,EAAmD;AACxDn6F,0BAAoBi9F,SAAS,KAAT,GAAiB,QAArC;AACAl9F,kBAAY,QAAZ;AACD,KAHM,MAGA;AACLC,0BAAoB,QAApB;;AAEA,UAAI+8F,eAAe5C,OAAO,GAAtB,IAA6B4C,eAAe5C,OAAO,CAAvD,EAA0D;AACxDp6F,oBAAYk9F,SAAS,MAAT,GAAkB,OAA9B;AACD,OAFD,MAEO;AACLl9F,oBAAYk9F,SAAS,OAAT,GAAmB,MAA/B;AACD;AACF;;AAED,WAAO;AACL76G,gBAAU26G,YADL;AAELh9F,iBAAWA,SAFN;AAGLC,yBAAmBA;AAHd,KAAP;AAKD;;AAED,WAAS/kB,QAAT,CAAkBm4D,SAAlB,EAA6B;AAC3B,QAAImpD,aAAanpD,UAAUv9D,GAAV,CAAc,SAAd,CAAjB;AACA,WAAOu9D,UAAUv9D,GAAV,CAAc,QAAd,EAAwB;AAAxB,OACJ,EAAEu9D,UAAUv9D,GAAV,CAAc,cAAd,KAAiC0mH,cAAcA,WAAWlnG,IAA5D,CADH;AAED;;AAED,WAASumG,kBAAT,CAA4BxoD,SAA5B,EAAuCsoD,QAAvC,EAAiDF,OAAjD,EAA0D;AACxD;AACA;AACA;AACA,QAAI5I,eAAex/C,UAAUv9D,GAAV,CAAc,wBAAd,CAAnB;AACA,QAAIg9G,eAAez/C,UAAUv9D,GAAV,CAAc,wBAAd,CAAnB,CALwD,CAKI;AAC5D;;AAEA6lH,eAAWA,YAAY,EAAvB;AACAF,cAAUA,WAAW,EAArB;AACA,QAAI0B,aAAaxB,SAAS,CAAT,CAAjB;AACA,QAAIyB,YAAYzB,SAAS,CAAT,CAAhB;AACA,QAAI0B,YAAY1B,SAASA,SAAS7qH,MAAT,GAAkB,CAA3B,CAAhB;AACA,QAAIwsH,YAAY3B,SAASA,SAAS7qH,MAAT,GAAkB,CAA3B,CAAhB;AACA,QAAIysH,YAAY9B,QAAQ,CAAR,CAAhB;AACA,QAAI+B,WAAW/B,QAAQ,CAAR,CAAf;AACA,QAAIgC,WAAWhC,QAAQA,QAAQ3qH,MAAR,GAAiB,CAAzB,CAAf;AACA,QAAI4sH,WAAWjC,QAAQA,QAAQ3qH,MAAR,GAAiB,CAAzB,CAAf;;AAEA,QAAI+hH,iBAAiB,KAArB,EAA4B;AAC1B8K,eAASR,UAAT;AACAQ,eAASJ,SAAT;AACD,KAHD,MAGO,IAAIK,qBAAqBT,UAArB,EAAiCC,SAAjC,CAAJ,EAAiD;AACtD,UAAIvK,YAAJ,EAAkB;AAChB8K,iBAASP,SAAT;AACAO,iBAASH,QAAT;AACD,OAHD,MAGO;AACLG,iBAASR,UAAT;AACAQ,iBAASJ,SAAT;AACD;AACF;;AAED,QAAIzK,iBAAiB,KAArB,EAA4B;AAC1B6K,eAASN,SAAT;AACAM,eAASF,QAAT;AACD,KAHD,MAGO,IAAIG,qBAAqBN,SAArB,EAAgCD,SAAhC,CAAJ,EAAgD;AACrD,UAAIvK,YAAJ,EAAkB;AAChB6K,iBAASL,SAAT;AACAK,iBAASD,QAAT;AACD,OAHD,MAGO;AACLC,iBAASN,SAAT;AACAM,iBAASF,QAAT;AACD;AACF;AACF;;AAED,WAASE,QAAT,CAAkBj/G,EAAlB,EAAsB;AACpBA,WAAOA,GAAGW,MAAH,GAAY,IAAnB;AACD;;AAED,WAASu+G,oBAAT,CAA8B/xC,OAA9B,EAAuCtjE,IAAvC,EAA6CyzG,WAA7C,EAA0D;AACxD;AACA,QAAI6B,YAAYhyC,WAAWA,QAAQnzD,eAAR,GAA0BpoB,KAA1B,EAA3B;AACA,QAAIwtH,WAAWv1G,QAAQA,KAAKmQ,eAAL,GAAuBpoB,KAAvB,EAAvB;;AAEA,QAAI,CAACutH,SAAD,IAAc,CAACC,QAAnB,EAA6B;AAC3B;AACD,KAPuD,CAOtD;AACF;;;AAGA,QAAIC,gBAAgB/9G,SAAS,EAAT,CAApB;AACAY,WAAOm9G,aAAP,EAAsBA,aAAtB,EAAqC,CAAClyC,QAAQxpE,QAA9C;AACAw7G,cAAUjlH,cAAV,CAAyBsH,MAAM,EAAN,EAAU69G,aAAV,EAAyBlyC,QAAQjpE,iBAAR,EAAzB,CAAzB;AACAk7G,aAASllH,cAAT,CAAwBsH,MAAM,EAAN,EAAU69G,aAAV,EAAyBx1G,KAAK3F,iBAAL,EAAzB,CAAxB;AACA,WAAOi7G,UAAUjnG,SAAV,CAAoBknG,QAApB,CAAP;AACD;;AAED,WAAS/B,oBAAT,CAA8B5J,YAA9B,EAA4C;AAC1C,WAAOA,iBAAiB,QAAjB,IAA6BA,iBAAiB,QAArD;AACD;;AAED,WAASuJ,aAAT,CAAuBsC,WAAvB,EAAoC3qD,SAApC,EAA+C5zB,GAA/C,EAAoD;AAClD,QAAIq/D,OAAOzrC,UAAUyrC,IAArB;;AAEA,QAAI,CAACzrC,UAAUv9D,GAAV,CAAc,eAAd,CAAD,IAAmCgpG,KAAK7mG,KAAL,CAAW0jG,OAAX,EAAvC,EAA6D;AAC3D;AACD;;AAED,QAAI4Q,YAAYl5C,UAAU7T,QAAV,CAAmB,UAAnB,CAAhB;AACA,QAAIy+D,iBAAiB1R,UAAU/sD,QAAV,CAAmB,WAAnB,CAArB;AACA,QAAI0+D,UAAU3R,UAAUz2G,GAAV,CAAc,QAAd,CAAd;AACA,QAAIg6G,cAAchR,KAAK8Q,cAAL,EAAlB;AACA,QAAIqL,MAAM,EAAV;AACA,QAAIC,MAAM,EAAV;AACA,QAAIp5G,SAASk8G,YAAYpD,UAAzB;AACA,QAAIa,UAAU,EAAd;;AAEA,SAAK,IAAI7qH,IAAI,CAAb,EAAgBA,IAAIk/G,YAAYh/G,MAAhC,EAAwCF,GAAxC,EAA6C;AAC3C,UAAIutH,YAAYrO,YAAYl/G,CAAZ,EAAeu+B,KAA/B;AACA8rF,UAAI,CAAJ,IAASkD,SAAT;AACAlD,UAAI,CAAJ,IAAS,CAAT;AACAC,UAAI,CAAJ,IAASiD,SAAT;AACAjD,UAAI,CAAJ,IAASz7E,IAAIg7E,aAAJ,GAAoByD,OAA7B;;AAEA,UAAIp8G,MAAJ,EAAY;AACVlJ,uBAAeqiH,GAAf,EAAoBA,GAApB,EAAyBn5G,MAAzB;AACAlJ,uBAAesiH,GAAf,EAAoBA,GAApB,EAAyBp5G,MAAzB;AACD,OAV0C,CAUzC;;;AAGF,UAAIs8G,SAAS,IAAI9lE,IAAJ,CAAS2C,qBAAqB;AACzC;AACA+G,cAAM,UAAU8tD,YAAYl/G,CAAZ,EAAei2G,SAFU;AAGzCh8E,eAAO;AACLwd,cAAI4yE,IAAI,CAAJ,CADC;AAEL3yE,cAAI2yE,IAAI,CAAJ,CAFC;AAGLh9F,cAAIi9F,IAAI,CAAJ,CAHC;AAILh9F,cAAIg9F,IAAI,CAAJ;AAJC,SAHkC;AASzC35F,eAAOvvB,SAASisH,eAAe54E,YAAf,EAAT,EAAwC;AAC7C/mB,kBAAQ+0C,UAAUv9D,GAAV,CAAc,0BAAd;AADqC,SAAxC,CATkC;AAYzCwmB,YAAI,CAZqC;AAazC3d,gBAAQ;AAbiC,OAArB,CAAT,CAAb;AAeAq/G,kBAAY9xD,KAAZ,CAAkB70D,GAAlB,CAAsB+mH,MAAtB;AACA3C,cAAQroH,IAAR,CAAagrH,MAAb;AACD;;AAED,WAAO3C,OAAP;AACD;;AAED,WAASG,cAAT,CAAwBoC,WAAxB,EAAqC3qD,SAArC,EAAgD5zB,GAAhD,EAAqD;AACnD,QAAIq/D,OAAOzrC,UAAUyrC,IAArB;AACA,QAAIxpF,OAAOjhB,SAASorC,IAAI4+E,aAAb,EAA4BhrD,UAAUv9D,GAAV,CAAc,gBAAd,CAA5B,CAAX;;AAEA,QAAI,CAACwf,IAAD,IAASwpF,KAAK7mG,KAAL,CAAW0jG,OAAX,EAAb,EAAmC;AACjC;AACD;;AAED,QAAI58C,aAAasU,UAAU7T,QAAV,CAAmB,WAAnB,CAAjB;AACA,QAAI8+D,cAAcv/D,WAAWjpD,GAAX,CAAe,QAAf,CAAlB;AACA,QAAI42G,SAAS5N,KAAKmR,aAAL,EAAb,CAVmD,CAUhB;;AAEnC,QAAIsO,gBAAgB,CAAClqH,SAASorC,IAAIyf,WAAb,EAA0BH,WAAWjpD,GAAX,CAAe,QAAf,CAA1B,KAAuD,CAAxD,IAA6DskH,IAA7D,GAAoE,GAAxF;AACA,QAAI4B,cAAcG,gBAAgB18E,IAAIp9B,QAApB,EAA8Bk8G,aAA9B,EAA6C9+E,IAAIi7E,cAAjD,CAAlB;AACA,QAAI8D,kBAAkBnrD,UAAUmyC,aAAV,CAAwB,IAAxB,CAAtB;AACA,QAAImW,WAAW,EAAf;AACA,QAAIh9G,SAASzD,SAASm4D,SAAT,CAAb;AACA,QAAIm/C,eAAen/C,UAAUv9D,GAAV,CAAc,cAAd,CAAnB;AACA9C,WAAO05G,MAAP,EAAe,UAAUgB,SAAV,EAAqBvkF,KAArB,EAA4B;AACzC,UAAI09E,YAAY6G,UAAU7G,SAA1B;AACA,UAAI8G,iBAAiBD,UAAUC,cAA/B;AACA,UAAIC,WAAWF,UAAUE,QAAzB;AACA,UAAI6Q,iBAAiB1/D,UAArB;;AAEA,UAAIy/D,mBAAmBA,gBAAgB3X,SAAhB,CAAnB,IAAiD2X,gBAAgB3X,SAAhB,EAA2BpoD,SAAhF,EAA2F;AACzFggE,yBAAiB,IAAIp7D,KAAJ,CAAUm7D,gBAAgB3X,SAAhB,EAA2BpoD,SAArC,EAAgDM,UAAhD,EAA4DsU,UAAUzxB,OAAtE,CAAjB;AACD;;AAED,UAAIk2C,YAAY2mC,eAAe37D,YAAf,MAAiCuQ,UAAUv9D,GAAV,CAAc,0BAAd,CAAjD;AACA,UAAIqoH,YAAYrf,KAAK0D,WAAL,CAAiBqE,SAAjB,CAAhB;AACA,UAAIlsE,MAAM,CAACwjF,SAAD,EAAY1+E,IAAI86E,WAAJ,GAAkB96E,IAAIi7E,cAAJ,GAAqB4D,WAAnD,CAAV;AACA,UAAI5B,SAAS,IAAI1mE,IAAJ,CAAS;AACpB;AACAgM,cAAM,WAAW6kD,SAFG;AAGpBzkG,kBAAUu4B,GAHU;AAIpBt4B,kBAAU25G,YAAY35G,QAJF;AAKpB1D,gBAAQA,MALY;AAMpB2d,YAAI;AANgB,OAAT,CAAb;AAQAkiC,mBAAak+D,OAAOn7F,KAApB,EAA2Bk9F,cAA3B,EAA2C;AACzC1/F,cAAM4uF,cADmC;AAEzC3tF,mBAAWy+F,eAAer5E,UAAf,CAA0B,OAA1B,EAAmC,IAAnC,KAA4C42E,YAAYh8F,SAF1B;AAGzCC,2BAAmBw+F,eAAer5E,UAAf,CAA0B,eAA1B,EAA2C,IAA3C,KAAoDq5E,eAAer5E,UAAf,CAA0B,UAA1B,EAAsC,IAAtC,CAApD,IAAmG42E,YAAY/7F,iBAHzF;AAIzCV,kBAAU,OAAOu4D,SAAP,KAAqB,UAArB,GAAkCA,WAAW;AACvD;AACA;AACA;AACA;AACA;AACA;AACAgnB,aAAK9qG,IAAL,KAAc,UAAd,GAA2B45G,QAA3B,GAAsC9O,KAAK9qG,IAAL,KAAc,OAAd,GAAwB6yG,YAAY,EAApC,GAAyCA,SAPnC,EAO8C19E,KAP9C,CAAlC,GAOyF2uD;AAX1D,OAA3C,EArByC,CAiCrC;;AAEJ,UAAI06B,YAAJ,EAAkB;AAChBkK,eAAO51B,SAAP,GAAmBuzB,sBAAsBhnD,SAAtB,CAAnB;AACAqpD,eAAO51B,SAAP,CAAiBg2B,UAAjB,GAA8B,WAA9B;AACAJ,eAAO51B,SAAP,CAAiBz0F,KAAjB,GAAyBu7G,QAAzB;AACD,OAvCwC,CAuCvC;;;AAGFoQ,kBAAYnD,UAAZ,CAAuBxjH,GAAvB,CAA2BqlH,MAA3B;;AAEAA,aAAOh6G,eAAP;AACAi5G,eAASvoH,IAAT,CAAcspH,MAAd;AACAsB,kBAAY9xD,KAAZ,CAAkB70D,GAAlB,CAAsBqlH,MAAtB;AACAA,aAAOx5G,kBAAP;AACD,KAhDD;AAiDA,WAAOy4G,QAAP;AACD;;AAED;;;;;;;;;;;;;;;;;;AAkBA,MAAI+C,SAAS1rH,MAAb;AACA,MAAI2rH,UAAU9qH,KAAd,CA/piC4B,CA+piCP;AACrB;;AAEA,WAAS+qH,OAAT,CAAiBh9E,OAAjB,EAA0Bg7B,GAA1B,EAA+B;AAC7B,QAAIpsE,SAAS;AACX;;;;;;;;;;;;;AAaAquH,gBAAU,EAdC;AAeXC,sBAAgB,KAfL;;AAiBX;;;;AAIAC,wBAAkB,EArBP;AAsBXC,mBAAa;AAtBF,KAAb;AAwBAC,oBAAgBzuH,MAAhB,EAAwBoxC,OAAxB,EAAiCg7B,GAAjC,EAzB6B,CAyBU;;AAEvCpsE,WAAOsuH,cAAP,IAAyBI,kBAAkB1uH,MAAlB,EAA0BoxC,OAA1B,CAAzB;AACA,WAAOpxC,MAAP;AACD;;AAED,WAASyuH,eAAT,CAAyBzuH,MAAzB,EAAiCoxC,OAAjC,EAA0Cg7B,GAA1C,EAA+C;AAC7C,QAAIuiD,qBAAqBv9E,QAAQqxB,YAAR,CAAqB,SAArB,CAAzB;AACA,QAAImsD,yBAAyBx9E,QAAQqxB,YAAR,CAAqB,aAArB,CAA7B,CAF6C,CAEqB;;AAElE,QAAIosD,cAAcD,uBAAuBtpH,GAAvB,CAA2B,MAA3B,EAAmC,IAAnC,KAA4C,EAA9D;AACA,QAAIwpH,aAAa,EAAjB,CAL6C,CAKxB;;AAErBZ,WAAO9hD,IAAII,oBAAJ,EAAP,EAAmC,UAAUD,QAAV,EAAoB;AACrD;AACA,UAAI,CAACA,SAASy3C,kBAAd,EAAkC;AAChC;AACD;;AAED,UAAI+K,cAAcC,QAAQziD,SAAS93B,KAAjB,CAAlB;AACA,UAAIw6E,qBAAqBjvH,OAAOuuH,gBAAP,CAAwBQ,WAAxB,IAAuC,EAAhE;AACA/uH,aAAOwuH,WAAP,CAAmBO,WAAnB,IAAkCxiD,QAAlC,CARqD,CAQT;AAC5C;;AAEA,UAAI2iD,gBAAgB3iD,SAAS93B,KAA7B;AACA,UAAI06E,mBAAmBD,cAAclgE,QAAd,CAAuB,SAAvB,EAAkC2/D,kBAAlC,CAAvB;AACAT,aAAO3hD,SAAS8zC,OAAT,EAAP,EAA2B8N,QAAQiB,mBAAR,EAA6B,KAA7B,EAAoC,IAApC,CAA3B,EAbqD,CAakB;AACvE;;AAEA,UAAI7iD,SAASu5C,cAAT,IAA2B6I,kBAA3B,CAA8C;AAClD;AADI,SAEDQ,iBAAiB7pH,GAAjB,CAAqB,MAArB,CAFH,EAEiC;AAC/B;AACA;AACA,YAAI+pH,cAAcF,iBAAiB7pH,GAAjB,CAAqB,SAArB,MAAoC,MAAtD;AACA,YAAIgqH,QAAQH,iBAAiB7pH,GAAjB,CAAqB,kBAArB,MAA6C,OAAzD;AACA,YAAIiqH,cAAchjD,SAASu5C,cAAT,CAAwBqJ,iBAAiB7pH,GAAjB,CAAqB,kBAArB,CAAxB,CAAlB;;AAEA,YAAI+pH,eAAeC,KAAnB,EAA0B;AACxBpB,iBAAOqB,YAAYxJ,QAAnB,EAA6BoI,QAAQiB,mBAAR,EAA6BE,QAAQ,OAAR,GAAkB,IAA/C,EAAqDD,WAArD,CAA7B;AACD;;AAED,YAAIC,KAAJ,EAAW;AACTpB,iBAAOqB,YAAYhL,SAAnB,EAA8B4J,QAAQiB,mBAAR,EAA6B,OAA7B,EAAsC,KAAtC,CAA9B;AACD;AACF,OAhCoD,CAgCnD;AACF;;;AAGA,eAASA,mBAAT,CAA6BI,WAA7B,EAA0CC,cAA1C,EAA0DnhB,IAA1D,EAAgE;AAC9D,YAAIohB,mBAAmBphB,KAAK75D,KAAL,CAAWua,QAAX,CAAoB,aAApB,EAAmC4/D,sBAAnC,CAAvB;AACA,YAAIe,kBAAkBD,iBAAiBpqH,GAAjB,CAAqB,MAArB,CAAtB;;AAEA,YAAI,CAACqqH,eAAD,IAAoBA,oBAAoB,MAApB,IAA8B,CAACH,WAA/B,IAA8C,CAACI,gBAAgBF,gBAAhB,CAAvE,EAA0G;AACxG;AACD;;AAED,YAAID,kBAAkB,IAAtB,EAA4B;AAC1BA,2BAAiBC,iBAAiBpqH,GAAjB,CAAqB,gBAArB,CAAjB;AACD;;AAEDoqH,2BAAmBF,cAAcK,qBAAqBvhB,IAArB,EAA2B6gB,gBAA3B,EAA6CP,sBAA7C,EAAqEx9E,OAArE,EAA8Eo+E,WAA9E,EAA2FC,cAA3F,CAAd,GAA2HC,gBAA9I;AACA,YAAII,OAAOJ,iBAAiBpqH,GAAjB,CAAqB,MAArB,CAAX;AACA,YAAI3E,MAAMquH,QAAQ1gB,KAAK75D,KAAb,CAAV;AACA,YAAIs7E,gBAAgBN,kBAAkBK,IAAlB,IAA0BxhB,KAAK9qG,IAAL,KAAc,UAA5D,CAf8D,CAeU;;AAExE,YAAIwsH,WAAWhwH,OAAOquH,QAAP,CAAgB1tH,GAAhB,IAAuB;AACpCA,eAAKA,GAD+B;AAEpC2tG,gBAAMA,IAF8B;AAGpC/hC,oBAAUA,QAH0B;AAIpCmjD,4BAAkBA,gBAJkB;AAKpCD,0BAAgBA,cALoB;AAMpCM,yBAAeA,aANqB;AAOpCD,gBAAMA,IAP8B;AAQpCG,qBAAWL,gBAAgBF,gBAAhB,CARyB;AASpC7jD,wBAAc;AATsB,SAAtC;AAWAojD,2BAAmBtuH,GAAnB,IAA0BqvH,QAA1B;AACAhwH,eAAOsuH,cAAP,IAAyByB,aAAzB;AACA,YAAIG,aAAaC,kBAAkBtB,WAAlB,EAA+BvgB,IAA/B,CAAjB;;AAEA,YAAI4hB,cAAc,IAAlB,EAAwB;AACtB,cAAIE,YAAYtB,WAAWoB,UAAX,MAA2BpB,WAAWoB,UAAX,IAAyB;AAClE7B,sBAAU;AADwD,WAApD,CAAhB;AAGA+B,oBAAU/B,QAAV,CAAmB1tH,GAAnB,IAA0BqvH,QAA1B;AACAI,oBAAUC,MAAV,GAAmBxB,YAAYqB,UAAZ,EAAwBG,MAA3C;AACAL,mBAASI,SAAT,GAAqBA,SAArB;AACD;AACF;AACF,KA7ED;AA8ED;;AAED,WAASP,oBAAT,CAA8BvhB,IAA9B,EAAoC6gB,gBAApC,EAAsDP,sBAAtD,EAA8Ex9E,OAA9E,EAAuFo+E,WAAvF,EAAoGC,cAApG,EAAoH;AAClH,QAAIa,0BAA0BnB,iBAAiBngE,QAAjB,CAA0B,aAA1B,CAA9B;AACA,QAAIuhE,iBAAiB,EAArB;AACArC,WAAO,CAAC,MAAD,EAAS,MAAT,EAAiB,WAAjB,EAA8B,aAA9B,EAA6C,OAA7C,EAAsD,WAAtD,EAAmE,yBAAnE,EAA8F,uBAA9F,EAAuH,GAAvH,CAAP,EAAoI,UAAUsC,KAAV,EAAiB;AACnJD,qBAAeC,KAAf,IAAwB1wH,OAAMwwH,wBAAwBhrH,GAAxB,CAA4BkrH,KAA5B,CAAN,CAAxB;AACD,KAFD,EAHkH,CAK9G;AACJ;AACA;;AAEAD,mBAAeT,IAAf,GAAsBxhB,KAAK9qG,IAAL,KAAc,UAAd,IAA4B,CAAC,CAACisH,cAApD,CATkH,CAS9C;AACpE;;AAEA,QAAIa,wBAAwBhrH,GAAxB,CAA4B,MAA5B,MAAwC,OAA5C,EAAqD;AACnDirH,qBAAe/sH,IAAf,GAAsB,MAAtB;AACD;;AAED,QAAIitH,cAAcF,eAAelzC,KAAf,KAAyBkzC,eAAelzC,KAAf,GAAuB,EAAhD,CAAlB,CAhBkH,CAgB3C;;AAEvEozC,gBAAY3rG,IAAZ,IAAoB,IAApB,KAA6B2rG,YAAY3rG,IAAZ,GAAmB,KAAhD;;AAEA,QAAI0qG,gBAAgB,OAApB,EAA6B;AAC3B;AACA,UAAIkB,8BAA8BJ,wBAAwBhrH,GAAxB,CAA4B,YAA5B,CAAlC;AACAmrH,kBAAY3rG,IAAZ,GAAmB4rG,+BAA+B,IAA/B,GAAsCA,2BAAtC,GAAoE,IAAvF,CAH2B,CAGkE;AAC7F;;AAEA,UAAI,CAACjB,cAAL,EAAqB;AACnB,YAAI1iC,aAAawjC,eAAe9jC,SAAf,GAA2B6jC,wBAAwBhrH,GAAxB,CAA4B,YAA5B,CAA5C;AACAynF,sBAAcvrF,SAASivH,WAAT,EAAsB1jC,WAAW9+B,SAAjC,CAAd;AACD;AACF;;AAED,WAAOqgD,KAAK75D,KAAL,CAAWua,QAAX,CAAoB,aAApB,EAAmC,IAAI6D,KAAJ,CAAU09D,cAAV,EAA0B3B,sBAA1B,EAAkDx9E,OAAlD,CAAnC,CAAP;AACD;;AAED,WAASs9E,iBAAT,CAA2B1uH,MAA3B,EAAmCoxC,OAAnC,EAA4C;AAC1C;AACAA,YAAQu5B,UAAR,CAAmB,UAAUxJ,WAAV,EAAuB;AACxC;AACA,UAAIoL,WAAWpL,YAAYqb,gBAA3B;AACA,UAAIm0C,uBAAuBxvD,YAAY77D,GAAZ,CAAgB,iBAAhB,EAAmC,IAAnC,CAA3B;AACA,UAAIsrH,oBAAoBzvD,YAAY77D,GAAZ,CAAgB,cAAhB,EAAgC,IAAhC,CAAxB;;AAEA,UAAI,CAACinE,QAAD,IAAaokD,yBAAyB,MAAtC,IAAgDA,yBAAyB,KAAzE,IAAkFA,yBAAyB,MAA3G,IAAqHC,sBAAsB,KAA3I,IAAoJzvD,YAAY77D,GAAZ,CAAgB,kBAAhB,EAAoC,IAApC,MAA8C,KAAtM,EAA6M;AAC3M;AACD;;AAED4oH,aAAOluH,OAAOuuH,gBAAP,CAAwBS,QAAQziD,SAAS93B,KAAjB,CAAxB,CAAP,EAAyD,UAAUu7E,QAAV,EAAoB;AAC3E,YAAI1hB,OAAO0hB,SAAS1hB,IAApB;;AAEA,YAAI/hC,SAAS6zC,OAAT,CAAiB9R,KAAKlpC,GAAtB,MAA+BkpC,IAAnC,EAAyC;AACvC0hB,mBAASnkD,YAAT,CAAsBjpE,IAAtB,CAA2Bu+D,WAA3B;AACA6uD,mBAASa,eAAT,IAA4B,IAA5B,KAAqCb,SAASa,eAAT,GAA2B,CAAhE;AACAb,mBAASa,eAAT,IAA4B1vD,YAAY2S,OAAZ,GAAsB7vD,KAAtB,EAA5B;AACD;AACF,OARD;AASD,KAnBD,EAmBG,IAnBH;AAoBD;AACD;;;;;;;;;;;;;;;AAgBA,WAASksG,iBAAT,CAA2BtB,WAA3B,EAAwCvgB,IAAxC,EAA8C;AAC5C,QAAIzrC,YAAYyrC,KAAK75D,KAArB;AACA,QAAI2wB,MAAMkpC,KAAKlpC,GAAf;;AAEA,SAAK,IAAIhlE,IAAI,CAAb,EAAgBA,IAAIyuH,YAAYvuH,MAAhC,EAAwCF,GAAxC,EAA6C;AAC3C,UAAI0wH,aAAajC,YAAYzuH,CAAZ,KAAkB,EAAnC;;AAEA,UAAI2wH,gBAAgBD,WAAW1rD,MAAM,QAAjB,CAAhB,EAA4CvC,UAAUl/C,EAAtD,KAA6DotG,gBAAgBD,WAAW1rD,MAAM,WAAjB,CAAhB,EAA+CvC,UAAUzE,cAAzD,CAA7D,IAAyI2yD,gBAAgBD,WAAW1rD,MAAM,UAAjB,CAAhB,EAA8CvC,UAAUljE,IAAxD,CAA7I,EAA4M;AAC1M,eAAOS,CAAP;AACD;AACF;AACF;;AAED,WAAS2wH,eAAT,CAAyBC,aAAzB,EAAwCC,aAAxC,EAAuD;AACrD,WAAOD,kBAAkB,KAAlB,IAA2B7vH,QAAQ6vH,aAAR,KAA0BrvH,QAAQqvH,aAAR,EAAuBC,aAAvB,KAAyC,CAA9F,IAAmGD,kBAAkBC,aAA5H;AACD;;AAED,WAASC,QAAT,CAAkBruD,SAAlB,EAA6B;AAC3B,QAAImtD,WAAWmB,YAAYtuD,SAAZ,CAAf;;AAEA,QAAI,CAACmtD,QAAL,EAAe;AACb;AACD;;AAED,QAAIN,mBAAmBM,SAASN,gBAAhC;AACA,QAAIjoH,QAAQuoH,SAAS1hB,IAAT,CAAc7mG,KAA1B;AACA,QAAIqoC,SAAS4/E,iBAAiB5/E,MAA9B;AACA,QAAI2oC,SAASi3C,iBAAiBpqH,GAAjB,CAAqB,QAArB,CAAb;AACA,QAAIzD,QAAQ6tH,iBAAiBpqH,GAAjB,CAAqB,OAArB,CAAZ,CAX2B,CAWgB;;AAE3C,QAAIzD,SAAS,IAAb,EAAmB;AACjBA,cAAQ4F,MAAM0S,KAAN,CAAYtY,KAAZ,CAAR;AACD;;AAED,QAAIouH,YAAYL,gBAAgBF,gBAAhB,CAAhB,CAjB2B,CAiBwB;AACnD;;AAEA,QAAIj3C,UAAU,IAAd,EAAoB;AAClB3oC,aAAO2oC,MAAP,GAAgBw3C,YAAY,MAAZ,GAAqB,MAArC;AACD;;AAED,QAAI7sB,SAAS37F,MAAMujG,SAAN,GAAkB5rG,KAAlB,EAAb;AACAgkG,WAAO,CAAP,IAAYA,OAAO,CAAP,CAAZ,IAAyBA,OAAOyK,OAAP,EAAzB;;AAEA,SAAK;AACLhsG,aAAS,IAAT,CAAc;AACd;AADA,OAEGA,QAAQuhG,OAAO,CAAP,CAHX,EAGsB;AACpB;AACAvhG,cAAQuhG,OAAO,CAAP,CAAR;AACD;;AAED,QAAIvhG,QAAQuhG,OAAO,CAAP,CAAZ,EAAuB;AACrBvhG,cAAQuhG,OAAO,CAAP,CAAR;AACD;;AAEDtzD,WAAOjuC,KAAP,GAAeA,KAAf;;AAEA,QAAIouH,SAAJ,EAAe;AACbngF,aAAO2oC,MAAP,GAAgBu3C,SAAS1hB,IAAT,CAAc7mG,KAAd,CAAoB0jG,OAApB,KAAgC,MAAhC,GAAyC,MAAzD;AACD;AACF;AACD,WAASgmB,WAAT,CAAqBtuD,SAArB,EAAgC;AAC9B,QAAI0rD,mBAAmB,CAAC1rD,UAAUzxB,OAAV,CAAkBqxB,YAAlB,CAA+B,aAA/B,KAAiD,EAAlD,EAAsD8rD,gBAA7E;AACA,WAAOA,oBAAoBA,iBAAiBF,QAAjB,CAA0BW,QAAQnsD,SAAR,CAA1B,CAA3B;AACD;AACD,WAASuuD,mBAAT,CAA6BvuD,SAA7B,EAAwC;AACtC,QAAImtD,WAAWmB,YAAYtuD,SAAZ,CAAf;AACA,WAAOmtD,YAAYA,SAASN,gBAA5B;AACD;;AAED,WAASE,eAAT,CAAyBF,gBAAzB,EAA2C;AACzC,WAAO,CAAC,CAACA,iBAAiBpqH,GAAjB,CAAqB,aAArB,CAAT;AACD;AACD;;;;;AAMA,WAAS0pH,OAAT,CAAiBv6E,KAAjB,EAAwB;AACtB,WAAOA,MAAMjxC,IAAN,GAAa,IAAb,GAAoBixC,MAAM9wB,EAAjC;AACD;;AAED;;;;;;;;;;;;;;;;;;AAkBA;;;;AAIA,MAAI0tG,WAAW73B,oBAAoB;AACjCh2F,UAAM,MAD2B;;AAGjC;;;AAGA8tH,kBAAc,IANmB;;AAQjC;;;;AAIAC,sBAAkB,IAZe;;AAcjC;;;AAGAvxC,YAAQ,gBAAUnd,SAAV,EAAqBzxB,OAArB,EAA8Bg7B,GAA9B,EAAmC17B,OAAnC,EAA4C;AAClD;AACA;AACA;AACA;AACA;AACA,WAAK6gF,gBAAL,IAAyBL,SAASruD,SAAT,CAAzB;AACAwuD,eAASx+E,UAAT,CAAoB,IAApB,EAA0B,QAA1B,EAAoC3vC,SAApC;AACAsuH,yBAAkB,IAAlB,EAAwB3uD,SAAxB,EAAmCzxB,OAAnC,EAA4Cg7B,GAA5C,EAAiD17B,OAAjD,EAA0D,IAA1D;AACD,KA1BgC;;AA4BjC;;;;;;;;AAQA8gF,uBAAmB,2BAAU3uD,SAAV,EAAqBzxB,OAArB,EAA8Bg7B,GAA9B,EAAmC17B,OAAnC,EAA4ChlB,KAA5C,EAAmD;AACpE8lG,yBAAkB,IAAlB,EAAwB3uD,SAAxB,EAAmCzxB,OAAnC,EAA4Cg7B,GAA5C,EAAiD17B,OAAjD,EAA0D,KAA1D;AACD,KAtCgC;;AAwCjC;;;AAGAz4B,YAAQ,gBAAUm5B,OAAV,EAAmBg7B,GAAnB,EAAwB;AAC9B,UAAI8F,cAAc,KAAKo/C,YAAvB;AACAp/C,qBAAeA,YAAYj6D,MAAZ,CAAmBm0D,GAAnB,CAAf;AACAilD,eAASx+E,UAAT,CAAoB,IAApB,EAA0B,QAA1B,EAAoC3vC,SAApC;AACD,KA/CgC;;AAiDjC;;;AAGAgJ,aAAS,iBAAUklC,OAAV,EAAmBg7B,GAAnB,EAAwB;AAC/BqlD,yBAAmB,IAAnB,EAAyBrlD,GAAzB;AACAilD,eAASx+E,UAAT,CAAoB,IAApB,EAA0B,SAA1B,EAAqC3vC,SAArC;AACD;AAvDgC,GAApB,CAAf;;AA0DA,WAASsuH,kBAAT,CAA2BE,QAA3B,EAAqC7uD,SAArC,EAAgDzxB,OAAhD,EAAyDg7B,GAAzD,EAA8D17B,OAA9D,EAAuEihF,WAAvE,EAAoF;AAClF,QAAIp+E,QAAQ89E,SAASO,mBAAT,CAA6BF,SAASH,gBAAtC,CAAZ;;AAEA,QAAI,CAACh+E,KAAL,EAAY;AACV;AACD;;AAED,QAAIm8E,mBAAmB0B,oBAAoBvuD,SAApB,CAAvB;AACA6sD,uBAAmB,CAACgC,SAASJ,YAAT,KAA0BI,SAASJ,YAAT,GAAwB,IAAI/9E,KAAJ,EAAlD,CAAD,EAAiEysC,MAAjE,CAAwEnd,SAAxE,EAAmF6sD,gBAAnF,EAAqGtjD,GAArG,EAA0GulD,WAA1G,CAAnB,GAA4IF,mBAAmBC,QAAnB,EAA6BtlD,GAA7B,CAA5I;AACD;;AAED,WAASqlD,kBAAT,CAA4BC,QAA5B,EAAsCtgF,OAAtC,EAA+Cg7B,GAA/C,EAAoD;AAClD,QAAI8F,cAAcw/C,SAASJ,YAA3B;AACAp/C,mBAAeA,YAAYhmE,OAAZ,CAAoBklC,OAApB,EAA6Bg7B,GAA7B,CAAf;AACAslD,aAASJ,YAAT,GAAwB,IAAxB;AACD;;AAED,MAAIO,mBAAmB,EAAvB;;AAEAR,WAASS,wBAAT,GAAoC,UAAUtuH,IAAV,EAAgBzB,KAAhB,EAAuB;AACzD8vH,qBAAiBruH,IAAjB,IAAyBzB,KAAzB;AACD,GAFD;;AAIAsvH,WAASO,mBAAT,GAA+B,UAAUpuH,IAAV,EAAgB;AAC7C,WAAOA,QAAQquH,iBAAiBruH,IAAjB,CAAf;AACD,GAFD;;AAIA;;;;;;;;;;;;;;;;;;AAkBA;;;;;;;;;;;AAWA,WAASuuH,QAAT,CAAkBvO,SAAlB,EAA6B3gD,SAA7B,EAAwC5zB,GAAxC,EAA6C;AAC3CA,UAAMA,OAAO,EAAb;AACA,QAAIyyE,OAAO8B,UAAUhnC,gBAArB;AACA,QAAI8xB,OAAOzrC,UAAUyrC,IAArB;AACA,QAAItkD,SAAS,EAAb;AACA,QAAIgoE,oBAAoB1jB,KAAKwD,eAAL,GAAuB,CAAvB,CAAxB;AACA,QAAImgB,kBAAkB3jB,KAAK18F,QAA3B;AACA,QAAI8zG,eAAesM,oBAAoB,QAApB,GAA+BC,eAAlD;AACA,QAAInvD,UAAUwrC,KAAKlpC,GAAnB;AACA,QAAIv+C,OAAO66F,KAAKuC,OAAL,EAAX;AACA,QAAIiO,YAAY,CAACrrG,KAAKtgB,CAAN,EAASsgB,KAAKtgB,CAAL,GAASsgB,KAAKpB,KAAvB,EAA8BoB,KAAKrgB,CAAnC,EAAsCqgB,KAAKrgB,CAAL,GAASqgB,KAAKnB,MAApD,CAAhB;AACA,QAAI2B,MAAM;AACR+B,YAAM,CADE;AAERC,aAAO,CAFC;AAGRuJ,WAAK,CAHG;AAIRqI,cAAQ,CAJA;AAKRgnF,cAAQ;AALA,KAAV;AAOA,QAAIkQ,aAAatvD,UAAUv9D,GAAV,CAAc,QAAd,KAA2B,CAA5C;AACA,QAAI8sH,WAAWtvD,YAAY,GAAZ,GAAkB,CAACovD,UAAU,CAAV,IAAeC,UAAhB,EAA4BD,UAAU,CAAV,IAAeC,UAA3C,CAAlB,GAA2E,CAACD,UAAU,CAAV,IAAeC,UAAhB,EAA4BD,UAAU,CAAV,IAAeC,UAA3C,CAA1F;;AAEA,QAAIH,iBAAJ,EAAuB;AACrB,UAAIK,cAAcL,kBAAkBjgB,aAAlB,CAAgCigB,kBAAkBhgB,WAAlB,CAA8B,CAA9B,CAAhC,CAAlB;AACAogB,eAAS/qG,IAAI,QAAJ,CAAT,IAA0BngB,KAAKqB,GAAL,CAASrB,KAAKoB,GAAL,CAAS+pH,WAAT,EAAsBD,SAAS,CAAT,CAAtB,CAAT,EAA6CA,SAAS,CAAT,CAA7C,CAA1B;AACD,KAxB0C,CAwBzC;;;AAGFpoE,WAAOp4C,QAAP,GAAkB,CAACkxD,YAAY,GAAZ,GAAkBsvD,SAAS/qG,IAAIq+F,YAAJ,CAAT,CAAlB,GAAgDwM,UAAU,CAAV,CAAjD,EAA+DpvD,YAAY,GAAZ,GAAkBsvD,SAAS/qG,IAAIq+F,YAAJ,CAAT,CAAlB,GAAgDwM,UAAU,CAAV,CAA/G,CAAlB,CA3B2C,CA2BqG;;AAEhJloE,WAAOn4C,QAAP,GAAkB3K,KAAKgN,EAAL,GAAU,CAAV,IAAe4uD,YAAY,GAAZ,GAAkB,CAAlB,GAAsB,CAArC,CAAlB,CA7B2C,CA6BgB;;AAE3D,QAAIwvD,SAAS;AACX1/F,WAAK,CAAC,CADK;AAEXqI,cAAQ,CAFG;AAGX7R,YAAM,CAAC,CAHI;AAIXC,aAAO;AAJI,KAAb;AAMA2gC,WAAOkgE,cAAP,GAAwBlgE,OAAOigE,aAAP,GAAuBjgE,OAAOggE,aAAP,GAAuBsI,OAAOL,eAAP,CAAtE;AACAjoE,WAAO+/D,WAAP,GAAqBiI,oBAAoBI,SAAS/qG,IAAI4qG,eAAJ,CAAT,IAAiCG,SAAS/qG,IAAI,QAAJ,CAAT,CAArD,GAA+E,CAApG;;AAEA,QAAIw7C,UAAUv9D,GAAV,CAAc,iBAAd,CAAJ,EAAsC;AACpC0kD,aAAOigE,aAAP,GAAuB,CAACjgE,OAAOigE,aAA/B;AACD;;AAED,QAAIpmH,SAASorC,IAAIsjF,WAAb,EAA0B1vD,UAAUv9D,GAAV,CAAc,kBAAd,CAA1B,CAAJ,EAAkE;AAChE0kD,aAAOkgE,cAAP,GAAwB,CAAClgE,OAAOkgE,cAAhC;AACD,KA9C0C,CA8CzC;;;AAGF,QAAIx7D,cAAcmU,UAAUv9D,GAAV,CAAc,kBAAd,CAAlB;AACA0kD,WAAO0E,WAAP,GAAqBg3D,iBAAiB,KAAjB,GAAyB,CAACh3D,WAA1B,GAAwCA,WAA7D,CAlD2C,CAkD+B;;AAE1E1E,WAAOl+B,EAAP,GAAY,CAAZ;AACA,WAAOk+B,MAAP;AACD;;AAED;;;;;;;;;;;;;;;;;;AAkBA,MAAIwoE,mBAAmB,CAAC,UAAD,EAAa,eAAb,EAA8B,UAA9B,CAAvB;AACA,MAAIC,mBAAmB,CAAC,WAAD,EAAc,WAAd,CAAvB,CAzojC4B,CAyojCuB;AACnD;AACA;AACA;AACA;AACA;AACA;;AAEA,MAAIC,oBAAoBrB,SAAS9vH,MAAT,CAAgB;AACtCiC,UAAM,eADgC;AAEtC+tH,sBAAkB,sBAFoB;;AAItC;;;AAGAvxC,YAAQ,gBAAUnd,SAAV,EAAqBzxB,OAArB,EAA8Bg7B,GAA9B,EAAmC17B,OAAnC,EAA4C;AAClD,WAAKgrB,KAAL,CAAW1zC,SAAX;AACA,UAAI2qG,eAAe,KAAKC,UAAxB;AACA,WAAKA,UAAL,GAAkB,IAAI7rG,KAAJ,EAAlB;AACA,WAAK20C,KAAL,CAAW70D,GAAX,CAAe,KAAK+rH,UAApB;;AAEA,UAAI,CAAC/vD,UAAUv9D,GAAV,CAAc,MAAd,CAAL,EAA4B;AAC1B;AACD;;AAED,UAAIk+G,YAAY3gD,UAAU40C,gBAAV,EAAhB;AACA,UAAIztD,SAAS+nE,SAASvO,SAAT,EAAoB3gD,SAApB,CAAb;AACA,UAAI2qD,cAAc,IAAI1D,WAAJ,CAAgBjnD,SAAhB,EAA2B7Y,MAA3B,CAAlB;AACAxnD,aAAOgwH,gBAAP,EAAyBhF,YAAY3mH,GAArC,EAA0C2mH,WAA1C;;AAEA,WAAKoF,UAAL,CAAgB/rH,GAAhB,CAAoB2mH,YAAYhD,QAAZ,EAApB;;AAEAhoH,aAAOiwH,gBAAP,EAAyB,UAAU9yH,IAAV,EAAgB;AACvC,YAAIkjE,UAAUv9D,GAAV,CAAc3F,OAAO,OAArB,CAAJ,EAAmC;AACjC,eAAK,MAAMA,IAAX,EAAiBkjE,SAAjB,EAA4B2gD,SAA5B;AACD;AACF,OAJD,EAIG,IAJH;AAKAryD,sBAAgBwhE,YAAhB,EAA8B,KAAKC,UAAnC,EAA+C/vD,SAA/C;AACA6vD,wBAAkB9/E,SAAlB,CAA4B,IAA5B,EAAkC,QAAlC,EAA4CiwB,SAA5C,EAAuDzxB,OAAvD,EAAgEg7B,GAAhE,EAAqE17B,OAArE;AACD,KA/BqC;AAgCtCz4B,YAAQ,kBAAY;AAClB,WAAK46G,gBAAL,GAAwB,IAAxB;AACD,KAlCqC;;AAoCtC;;;;;AAKAC,gBAAY,oBAAUjwD,SAAV,EAAqB2gD,SAArB,EAAgC;AAC1C,UAAIlV,OAAOzrC,UAAUyrC,IAArB;;AAEA,UAAIA,KAAK7mG,KAAL,CAAW0jG,OAAX,EAAJ,EAA0B;AACxB;AACD;;AAED,UAAI4nB,iBAAiBlwD,UAAU7T,QAAV,CAAmB,WAAnB,CAArB;AACA,UAAIy+D,iBAAiBsF,eAAe/jE,QAAf,CAAwB,WAAxB,CAArB;AACA,UAAIgkE,aAAavF,eAAenoH,GAAf,CAAmB,OAAnB,CAAjB;AACA0tH,mBAAa7xH,QAAQ6xH,UAAR,IAAsBA,UAAtB,GAAmC,CAACA,UAAD,CAAhD;AACA,UAAItO,WAAWlB,UAAUhnC,gBAAV,CAA2BynC,OAA3B,EAAf;AACA,UAAI/S,eAAe5C,KAAK4C,YAAL,EAAnB;AACA,UAAI+hB,YAAY,CAAhB;AACA,UAAI3T,cAAchR,KAAK8Q,cAAL,CAAoB;AACpCrD,mBAAWgX;AADyB,OAApB,CAAlB;AAGA,UAAIp1G,KAAK,EAAT;AACA,UAAIe,KAAK,EAAT,CAlB0C,CAkB7B;AACb;;AAEA,UAAI+tE,YAAYghC,eAAe54E,YAAf,EAAhB;;AAEA,WAAK,IAAIz0C,IAAI,CAAb,EAAgBA,IAAIk/G,YAAYh/G,MAAhC,EAAwCF,GAAxC,EAA6C;AAC3C,YAAIutH,YAAYrf,KAAKyD,aAAL,CAAmBuN,YAAYl/G,CAAZ,EAAeu+B,KAAlC,CAAhB;;AAEA,YAAIuyE,YAAJ,EAAkB;AAChBvzF,aAAG,CAAH,IAAQgwG,SAAR;AACAhwG,aAAG,CAAH,IAAQ+mG,SAASl+G,CAAjB;AACAkY,aAAG,CAAH,IAAQivG,SAAR;AACAjvG,aAAG,CAAH,IAAQgmG,SAASl+G,CAAT,GAAak+G,SAASh/F,MAA9B;AACD,SALD,MAKO;AACL/H,aAAG,CAAH,IAAQ+mG,SAASn+G,CAAjB;AACAoX,aAAG,CAAH,IAAQgwG,SAAR;AACAjvG,aAAG,CAAH,IAAQgmG,SAASn+G,CAAT,GAAam+G,SAASj/F,KAA9B;AACA/G,aAAG,CAAH,IAAQivG,SAAR;AACD;;AAED,YAAIuF,aAAaD,cAAcD,WAAW1yH,MAA1C;AACA,YAAI+1G,YAAYiJ,YAAYl/G,CAAZ,EAAei2G,SAA/B;;AAEA,aAAKuc,UAAL,CAAgB/rH,GAAhB,CAAoB,IAAIihD,IAAJ,CAAS2C,qBAAqB;AAChD+G,gBAAM6kD,aAAa,IAAb,GAAoB,UAAUiJ,YAAYl/G,CAAZ,EAAei2G,SAA7C,GAAyD,IADf;AAEhDh8E,iBAAO;AACLwd,gBAAIl6B,GAAG,CAAH,CADC;AAELm6B,gBAAIn6B,GAAG,CAAH,CAFC;AAGL8P,gBAAI/O,GAAG,CAAH,CAHC;AAILgP,gBAAIhP,GAAG,CAAH;AAJC,WAFyC;AAQhDqS,iBAAOvvB,SAAS;AACdssB,oBAAQklG,WAAWE,UAAX;AADM,WAAT,EAEJzmC,SAFI,CARyC;AAWhDt+E,kBAAQ;AAXwC,SAArB,CAAT,CAApB;AAaD;AACF,KAhGqC;;AAkGtC;;;;;AAKAglH,gBAAY,oBAAUtwD,SAAV,EAAqB2gD,SAArB,EAAgC;AAC1C,UAAIlV,OAAOzrC,UAAUyrC,IAArB;;AAEA,UAAIA,KAAK7mG,KAAL,CAAW0jG,OAAX,EAAJ,EAA0B;AACxB;AACD;;AAED,UAAIioB,iBAAiBvwD,UAAU7T,QAAV,CAAmB,WAAnB,CAArB;AACA,UAAIqkE,iBAAiBD,eAAepkE,QAAf,CAAwB,WAAxB,CAArB;AACA,UAAIskE,aAAaD,eAAe/tH,GAAf,CAAmB,OAAnB,CAAjB;AACA,UAAIo/G,WAAWlB,UAAUhnC,gBAAV,CAA2BynC,OAA3B,EAAf;AACA,UAAI3E,cAAchR,KAAK8Q,cAAL,CAAoB;AACpCrD,mBAAWqX,cADyB;AAEpCn9D,eAAO;AAF6B,OAApB,CAAlB;;AAKA,UAAI,CAACqpD,YAAYh/G,MAAjB,EAAyB;AACvB;AACD,OAlByC,CAkBxC;AACF;;;AAGA,UAAIizH,gBAAgBD,WAAWhzH,MAA/B;AACA,UAAIkzH,sBAAsB,KAAKX,gBAA/B;AACA,UAAIY,qBAAqBjuH,eAAzB;AACA,UAAI0tH,aAAa,CAAjB;;AAEA,UAAIM,mBAAJ,EAAyB;AACvB,aAAK,IAAIpzH,IAAI,CAAb,EAAgBA,IAAIk/G,YAAYh/G,MAAhC,EAAwCF,GAAxC,EAA6C;AAC3C,cAAIszH,SAASF,oBAAoBluH,GAApB,CAAwBg6G,YAAYl/G,CAAZ,EAAei2G,SAAvC,CAAb;;AAEA,cAAIqd,UAAU,IAAd,EAAoB;AAClBR,yBAAa,CAACQ,SAAS,CAACH,gBAAgB,CAAjB,IAAsBnzH,CAAhC,IAAqCmzH,aAAlD;AACA;AACD;AACF;AACF;;AAED,UAAIv7G,OAAOs2F,KAAKyD,aAAL,CAAmBuN,YAAY,CAAZ,EAAe3gF,KAAlC,CAAX;AACA,UAAImuD,YAAYumC,eAAel+E,YAAf,EAAhB;AACAm+E,mBAAanyH,QAAQmyH,UAAR,IAAsBA,UAAtB,GAAmC,CAACA,UAAD,CAAhD;;AAEA,WAAK,IAAIlzH,IAAI,CAAb,EAAgBA,IAAIk/G,YAAYh/G,MAAhC,EAAwCF,GAAxC,EAA6C;AAC3C,YAAIutH,YAAYrf,KAAKyD,aAAL,CAAmBuN,YAAYl/G,CAAZ,EAAeu+B,KAAlC,CAAhB;AACA,YAAIp4B,CAAJ;AACA,YAAIC,CAAJ;AACA,YAAIif,KAAJ;AACA,YAAIC,MAAJ;;AAEA,YAAI4oF,KAAK4C,YAAL,EAAJ,EAAyB;AACvB3qG,cAAIyR,IAAJ;AACAxR,cAAIk+G,SAASl+G,CAAb;AACAif,kBAAQkoG,YAAYpnH,CAApB;AACAmf,mBAASg/F,SAASh/F,MAAlB;AACA1N,iBAAOzR,IAAIkf,KAAX;AACD,SAND,MAMO;AACLlf,cAAIm+G,SAASn+G,CAAb;AACAC,cAAIwR,IAAJ;AACAyN,kBAAQi/F,SAASj/F,KAAjB;AACAC,mBAASioG,YAAYnnH,CAArB;AACAwR,iBAAOxR,IAAIkf,MAAX;AACD;;AAED,YAAI2wF,YAAYiJ,YAAYl/G,IAAI,CAAhB,EAAmBi2G,SAAnC;AACAA,qBAAa,IAAb,IAAqBod,mBAAmBpuH,GAAnB,CAAuBgxG,SAAvB,EAAkC6c,UAAlC,CAArB;;AAEA,aAAKN,UAAL,CAAgB/rH,GAAhB,CAAoB,IAAIghD,IAAJ,CAAS;AAC3B2J,gBAAM6kD,aAAa,IAAb,GAAoB,UAAUA,SAA9B,GAA0C,IADrB;AAE3Bh8E,iBAAO;AACL9zB,eAAGA,CADE;AAELC,eAAGA,CAFE;AAGLif,mBAAOA,KAHF;AAILC,oBAAQA;AAJH,WAFoB;AAQ3BqL,iBAAOvvB,SAAS;AACdqsB,kBAAMylG,WAAWJ,UAAX;AADQ,WAAT,EAEJpmC,SAFI,CARoB;AAW3B3+E,kBAAQ;AAXmB,SAAT,CAApB;;AAcA+kH,qBAAa,CAACA,aAAa,CAAd,IAAmBK,aAAhC;AACD;;AAED,WAAKV,gBAAL,GAAwBY,kBAAxB;AACD;AA3LqC,GAAhB,CAAxB;AA6LAf,oBAAkBnxH,MAAlB,CAAyB;AACvBiC,UAAM;AADiB,GAAzB;AAGAkvH,oBAAkBnxH,MAAlB,CAAyB;AACvBiC,UAAM;AADiB,GAAzB;;AAIA;;;;;;;;;;;;;;;;;;;AAmBA;;;;;;;;;;;;;;;;;;AAkBAg2F,sBAAoB;AAClBh2F,UAAM,MADY;AAElBw8E,YAAQ,gBAAUwjC,SAAV,EAAqBpyE,OAArB,EAA8B;AACpC,WAAKsqB,KAAL,CAAW1zC,SAAX;;AAEA,UAAIw7F,UAAUl+G,GAAV,CAAc,MAAd,CAAJ,EAA2B;AACzB,aAAKo2D,KAAL,CAAW70D,GAAX,CAAe,IAAIghD,IAAJ,CAAS;AACtBxtB,iBAAOmpF,UAAUhnC,gBAAV,CAA2BynC,OAA3B,EADe;AAEtBlzF,iBAAOvvB,SAAS;AACdqsB,kBAAM21F,UAAUl+G,GAAV,CAAc,iBAAd;AADQ,WAAT,EAEJk+G,UAAUhxD,YAAV,EAFI,CAFe;AAKtBrkD,kBAAQ,IALc;AAMtB2d,cAAI,CAAC;AANiB,SAAT,CAAf;AAQD;AACF;AAfiB,GAApB;AAiBAksE,uBAAqB,UAAUloD,MAAV,EAAkB;AACrC;AACA,QAAIA,OAAOmxE,KAAP,IAAgBnxE,OAAOoxE,KAAvB,IAAgC,CAACpxE,OAAO4xE,IAA5C,EAAkD;AAChD5xE,aAAO4xE,IAAP,GAAc,EAAd;AACD;AACF,GALD;;AAOA;;;;;;;;;;;;;;;;;;AAkBA5oB,iBAAez1F,MAAM2mD,MAAN,EAAc,KAAd,CAAf,EAp6jC4B,CAo6jCU;;AAEtC8uC,iBAAe2Y,WAAf;AACAzY,iBAAe;AACbpzB,gBAAY,KADC;AAEbsT,WAAO,eAAU/X,WAAV,EAAuB;AAC5B;AACAA,kBAAY2S,OAAZ,GAAsByP,SAAtB,CAAgC,cAAhC,EAAgD,WAAhD;AACD;AALY,GAAf;;AAQA;;;;;;;;;;;;;;;;;;AAkBAgW,uBAAqB;AACnB/1F,UAAM,OADa;AAEnBg7D,gBAAY;AACVh7D,YAAM,KADI;AAEVy5D,kBAAY;AAFF,KAFO;AAMnBoB,mBAAe;AACb;AACAzyC,cAAQ,CAFK;AAGb;AACAC,SAAG,CAJU;AAKb/G,YAAM,IALO;AAMbyJ,YAAM,EANO;AAOb;AACA;AACA;AACAztB,cAAQ,OAVK;AAWb6yH,eAAS,EAXI;AAYb;AACA;AACA;AACAC,iBAAW,OAfE;AAgBb;AACA;AACAxqG,YAAM,CAlBO;AAmBb;AACA;AACAwJ,WAAK,CArBQ;AAsBb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAyS,uBAAiB,eA/BJ;AAgCb;AACA6nD,mBAAa,MAjCA;AAkCb;AACAo2B,mBAAa,CAnCA;AAoCb;AACA;AACAlrF,eAAS,CAtCI;AAuCb;AACAy7F,eAAS,EAxCI;AAyCb5lE,iBAAW;AACTr/B,kBAAU,EADD;AAETD,oBAAY,QAFH;AAGT3S,eAAO;AAHE,OAzCE;AA8Cb83G,oBAAc;AACZ93G,eAAO;AADK;AA9CD;AANI,GAArB,EAj8jC4B,CAy/jCxB;;AAEJw9E,sBAAoB;AAClBh2F,UAAM,OADY;AAElBw8E,YAAQ,gBAAU+zC,UAAV,EAAsB3iF,OAAtB,EAA+Bg7B,GAA/B,EAAoC;AAC1C,WAAK1Q,KAAL,CAAW1zC,SAAX;;AAEA,UAAI,CAAC+rG,WAAWzuH,GAAX,CAAe,MAAf,CAAL,EAA6B;AAC3B;AACD;;AAED,UAAIo2D,QAAQ,KAAKA,KAAjB;AACA,UAAIxN,iBAAiB6lE,WAAW/kE,QAAX,CAAoB,WAApB,CAArB;AACA,UAAIglE,oBAAoBD,WAAW/kE,QAAX,CAAoB,cAApB,CAAxB;AACA,UAAIx/B,YAAYukG,WAAWzuH,GAAX,CAAe,WAAf,CAAhB;AACA,UAAI+1B,eAAe04F,WAAWzuH,GAAX,CAAe,cAAf,CAAnB;AACA,UAAI4mH,SAAS,IAAI1mE,IAAJ,CAAS;AACpBz0B,eAAOi9B,aAAa,EAAb,EAAiBE,cAAjB,EAAiC;AACtC3/B,gBAAMwlG,WAAWzuH,GAAX,CAAe,MAAf,CADgC;AAEtCypB,oBAAUm/B,eAAeoE,YAAf;AAF4B,SAAjC,EAGJ;AACD7C,sBAAY;AADX,SAHI,CADa;AAOpB3jC,YAAI;AAPgB,OAAT,CAAb;AASA,UAAIwD,WAAW48F,OAAOhkG,eAAP,EAAf;AACA,UAAI+rG,UAAUF,WAAWzuH,GAAX,CAAe,SAAf,CAAd;AACA,UAAI4uH,YAAY,IAAI1uE,IAAJ,CAAS;AACvBz0B,eAAOi9B,aAAa,EAAb,EAAiBgmE,iBAAjB,EAAoC;AACzCzlG,gBAAM0lG,OADmC;AAEzCllG,oBAAUilG,kBAAkB1hE,YAAlB,EAF+B;AAGzC9rD,aAAG8oB,SAAS5J,MAAT,GAAkBquG,WAAWzuH,GAAX,CAAe,SAAf,CAHoB;AAIzCmqB,6BAAmB;AAJsB,SAApC,EAKJ;AACDggC,sBAAY;AADX,SALI,CADgB;AASvB3jC,YAAI;AATmB,OAAT,CAAhB;AAWA,UAAIqoG,OAAOJ,WAAWzuH,GAAX,CAAe,MAAf,CAAX;AACA,UAAI8uH,UAAUL,WAAWzuH,GAAX,CAAe,SAAf,CAAd;AACA4mH,aAAO/9G,MAAP,GAAgB,CAACgmH,IAAjB;AACAD,gBAAU/lH,MAAV,GAAmB,CAACimH,OAApB;;AAEA,UAAID,IAAJ,EAAU;AACRjI,eAAOxjH,EAAP,CAAU,OAAV,EAAmB,YAAY;AAC7BrK,iBAAOg2H,IAAP,CAAYF,IAAZ,EAAkB,MAAMJ,WAAWzuH,GAAX,CAAe,QAAf,CAAxB;AACD,SAFD;AAGD;;AAED,UAAI8uH,OAAJ,EAAa;AACXF,kBAAUxrH,EAAV,CAAa,OAAb,EAAsB,YAAY;AAChCrK,iBAAOg2H,IAAP,CAAYD,OAAZ,EAAqB,MAAML,WAAWzuH,GAAX,CAAe,WAAf,CAA3B;AACD,SAFD;AAGD;;AAEDo2D,YAAM70D,GAAN,CAAUqlH,MAAV;AACA+H,iBAAWv4D,MAAM70D,GAAN,CAAUqtH,SAAV,CAAX,CApD0C,CAoDT;;AAEjC,UAAII,YAAY54D,MAAMxzC,eAAN,EAAhB;AACA,UAAIqsG,eAAeR,WAAW91D,kBAAX,EAAnB;AACAs2D,mBAAa9uG,KAAb,GAAqB6uG,UAAU7uG,KAA/B;AACA8uG,mBAAa7uG,MAAb,GAAsB4uG,UAAU5uG,MAAhC;AACA,UAAI8uG,aAAaj4D,cAAcg4D,YAAd,EAA4B;AAC3C9uG,eAAO2mD,IAAI35C,QAAJ,EADoC;AAE3C/M,gBAAQ0mD,IAAI15C,SAAJ;AAFmC,OAA5B,EAGdqhG,WAAWzuH,GAAX,CAAe,SAAf,CAHc,CAAjB,CA1D0C,CA6DX;;AAE/B,UAAI,CAACkqB,SAAL,EAAgB;AACd;AACAA,oBAAYukG,WAAWzuH,GAAX,CAAe,MAAf,KAA0ByuH,WAAWzuH,GAAX,CAAe,OAAf,CAAtC;;AAEA,YAAIkqB,cAAc,QAAlB,EAA4B;AAC1BA,sBAAY,QAAZ;AACD,SANa,CAMZ;;;AAGF,YAAIA,cAAc,OAAlB,EAA2B;AACzBglG,qBAAWjuH,CAAX,IAAgBiuH,WAAW/uG,KAA3B;AACD,SAFD,MAEO,IAAI+J,cAAc,QAAlB,EAA4B;AACjCglG,qBAAWjuH,CAAX,IAAgBiuH,WAAW/uG,KAAX,GAAmB,CAAnC;AACD;AACF;;AAED,UAAI,CAAC4V,YAAL,EAAmB;AACjBA,uBAAe04F,WAAWzuH,GAAX,CAAe,KAAf,KAAyByuH,WAAWzuH,GAAX,CAAe,QAAf,CAAxC;;AAEA,YAAI+1B,iBAAiB,QAArB,EAA+B;AAC7BA,yBAAe,QAAf;AACD;;AAED,YAAIA,iBAAiB,QAArB,EAA+B;AAC7Bm5F,qBAAWhuH,CAAX,IAAgBguH,WAAW9uG,MAA3B;AACD,SAFD,MAEO,IAAI2V,iBAAiB,QAArB,EAA+B;AACpCm5F,qBAAWhuH,CAAX,IAAgBguH,WAAW9uG,MAAX,GAAoB,CAApC;AACD;;AAED2V,uBAAeA,gBAAgB,KAA/B;AACD;;AAEDqgC,YAAMt3C,IAAN,CAAW,UAAX,EAAuB,CAACowG,WAAWjuH,CAAZ,EAAeiuH,WAAWhuH,CAA1B,CAAvB;AACA,UAAIiuH,aAAa;AACfjlG,mBAAWA,SADI;AAEfC,2BAAmB4L;AAFJ,OAAjB;AAIA6wF,aAAOrtF,QAAP,CAAgB41F,UAAhB;AACAP,gBAAUr1F,QAAV,CAAmB41F,UAAnB,EArG0C,CAqGV;AAChC;;AAEAH,kBAAY54D,MAAMxzC,eAAN,EAAZ;AACA,UAAIkQ,UAAUo8F,WAAW93D,MAAzB;AACA,UAAI3rC,QAAQgjG,WAAWvhE,YAAX,CAAwB,CAAC,OAAD,EAAU,SAAV,CAAxB,CAAZ;AACAzhC,YAAMlD,IAAN,GAAakmG,WAAWzuH,GAAX,CAAe,iBAAf,CAAb;AACA,UAAIuhB,OAAO,IAAIghC,IAAJ,CAAS;AAClBxtB,eAAO;AACL9zB,aAAG+tH,UAAU/tH,CAAV,GAAc6xB,QAAQ,CAAR,CADZ;AAEL5xB,aAAG8tH,UAAU9tH,CAAV,GAAc4xB,QAAQ,CAAR,CAFZ;AAGL3S,iBAAO6uG,UAAU7uG,KAAV,GAAkB2S,QAAQ,CAAR,CAAlB,GAA+BA,QAAQ,CAAR,CAHjC;AAIL1S,kBAAQ4uG,UAAU5uG,MAAV,GAAmB0S,QAAQ,CAAR,CAAnB,GAAgCA,QAAQ,CAAR,CAJnC;AAKLze,aAAGo6G,WAAWzuH,GAAX,CAAe,cAAf;AALE,SADW;AAQlByrB,eAAOA,KARW;AASlB5iB,gBAAQ;AATU,OAAT,CAAX;AAWAw8C,2BAAqB9jC,IAArB;AACA60C,YAAM70D,GAAN,CAAUggB,IAAV;AACD;AA3HiB,GAApB;;AA8HA;;;;;;;;;;;;;;;;;;AAkBA,MAAI6tG,cAAcn7B,qBAAqB;AACrC/1F,UAAM,cAD+B;AAErCg8D,kBAAc,CAAC,QAAD,CAFuB;AAGrChB,gBAAY;AACVh7D,YAAM,KADI;AAEV;AACA;AACA;AACA;AACA;AACA;AACA;AACAy5D,kBAAY;AATF,KAHyB;AAcrCvuB,UAAM,cAAUoB,MAAV,EAAkBsf,WAAlB,EAA+Bhe,OAA/B,EAAwC;AAC5C,WAAKstB,oBAAL,CAA0B5uB,MAA1B,EAAkCsB,OAAlC;AACAtB,aAAO6kF,QAAP,GAAkB7kF,OAAO6kF,QAAP,IAAmB,EAArC;AACD,KAjBoC;AAkBrC7hE,iBAAa,qBAAUhjB,MAAV,EAAkB;AAC7B4kF,kBAAY9hF,SAAZ,CAAsB,IAAtB,EAA4B,aAA5B,EAA2C9C,MAA3C;AACD,KApBoC;AAqBrCivB,mBAAe,yBAAY;AACzB,WAAK61D,WAAL,CAAiB,KAAKxjF,OAAtB;;AAEA,UAAIyjF,aAAa,KAAKr/C,KAAtB,CAHyB,CAGI;;AAE7B,UAAIq/C,WAAW,CAAX,KAAiB,KAAKvvH,GAAL,CAAS,cAAT,MAA6B,QAAlD,EAA4D;AAC1D,YAAIwvH,cAAc,KAAlB,CAD0D,CACjC;;AAEzB,aAAK,IAAI10H,IAAI,CAAb,EAAgBA,IAAIy0H,WAAWv0H,MAA/B,EAAuCF,GAAvC,EAA4C;AAC1C,cAAIT,OAAOk1H,WAAWz0H,CAAX,EAAckF,GAAd,CAAkB,MAAlB,CAAX;;AAEA,cAAI,KAAKyvH,UAAL,CAAgBp1H,IAAhB,CAAJ,EAA2B;AACzB;AACA,iBAAKq1H,MAAL,CAAYr1H,IAAZ;AACAm1H,0BAAc,IAAd;AACA;AACD;AACF,SAZyD,CAYxD;;;AAGF,SAACA,WAAD,IAAgB,KAAKE,MAAL,CAAYH,WAAW,CAAX,EAAcvvH,GAAd,CAAkB,MAAlB,CAAZ,CAAhB;AACD;AACF,KA3CoC;AA4CrCsvH,iBAAa,qBAAUxjF,OAAV,EAAmB;AAC9B,UAAI6jF,gBAAgB,EAApB;AACA,UAAIC,iBAAiB,EAArB;AACA9jF,cAAQy5B,aAAR,CAAsB,UAAU1J,WAAV,EAAuB;AAC3C,YAAIqF,aAAarF,YAAYxhE,IAA7B;AACAu1H,uBAAetyH,IAAf,CAAoB4jE,UAApB;AACA,YAAI2uD,WAAJ;;AAEA,YAAIh0D,YAAYsb,kBAAhB,EAAoC;AAClC,cAAIl6E,OAAO4+D,YAAYsb,kBAAZ,EAAX;AACA,cAAIpf,QAAQ96D,KAAKqiG,QAAL,CAAcriG,KAAK61E,OAAnB,CAAZ;;AAEA,cAAI,CAAChnC,QAAQ45B,gBAAR,CAAyB7J,WAAzB,CAAL,EAA4C;AAC1C+zD,6BAAiBA,eAAe9xH,MAAf,CAAsBi6D,KAAtB,CAAjB;AACD;;AAED,cAAIA,MAAM/8D,MAAV,EAAkB;AAChB20H,4BAAgBA,cAAc7xH,MAAd,CAAqBi6D,KAArB,CAAhB;AACD,WAFD,MAEO;AACL83D,0BAAc,IAAd;AACD;AACF,SAbD,MAaO;AACLA,wBAAc,IAAd;AACD;;AAED,YAAIA,eAAe5kF,gBAAgB4wB,WAAhB,CAAnB,EAAiD;AAC/C8zD,wBAAcryH,IAAd,CAAmBu+D,YAAYxhE,IAA/B;AACD;AACF,OAzBD;AA0BA;;;;;AAKA,WAAKy1H,eAAL,GAAuBF,cAAvB,CAlC8B,CAkCS;AACvC;;AAEA,UAAI30B,UAAU,KAAKj7F,GAAL,CAAS,MAAT,KAAoB2vH,aAAlC;AACA,UAAIJ,aAAav1H,IAAIihG,OAAJ,EAAa,UAAUhxD,QAAV,EAAoB;AAChD;AACA,YAAI,OAAOA,QAAP,KAAoB,QAApB,IAAgC,OAAOA,QAAP,KAAoB,QAAxD,EAAkE;AAChEA,qBAAW;AACT5vC,kBAAM4vC;AADG,WAAX;AAGD;;AAED,eAAO,IAAIsjB,KAAJ,CAAUtjB,QAAV,EAAoB,IAApB,EAA0B,KAAK6B,OAA/B,CAAP;AACD,OATgB,EASd,IATc,CAAjB;AAUA;;;;;AAKA,WAAKokC,KAAL,GAAaq/C,UAAb;AACD,KAlGoC;;AAoGrC;;;AAGA/gD,aAAS,mBAAY;AACnB,aAAO,KAAK0B,KAAZ;AACD,KAzGoC;;AA2GrC;;;AAGAw/C,YAAQ,gBAAUr1H,IAAV,EAAgB;AACtB,UAAIg1H,WAAW,KAAK7kF,MAAL,CAAY6kF,QAA3B;AACA,UAAIU,eAAe,KAAK/vH,GAAL,CAAS,cAAT,CAAnB;;AAEA,UAAI+vH,iBAAiB,QAArB,EAA+B;AAC7B,YAAI9yH,OAAO,KAAKizE,KAAhB;AACAhzE,eAAOD,IAAP,EAAa,UAAUgtC,QAAV,EAAoB;AAC/BolF,mBAASplF,SAASjqC,GAAT,CAAa,MAAb,CAAT,IAAiC,KAAjC;AACD,SAFD;AAGD;;AAEDqvH,eAASh1H,IAAT,IAAiB,IAAjB;AACD,KA1HoC;;AA4HrC;;;AAGA21H,cAAU,kBAAU31H,IAAV,EAAgB;AACxB,UAAI,KAAK2F,GAAL,CAAS,cAAT,MAA6B,QAAjC,EAA2C;AACzC,aAAKwqC,MAAL,CAAY6kF,QAAZ,CAAqBh1H,IAArB,IAA6B,KAA7B;AACD;AACF,KAnIoC;;AAqIrC;;;AAGA41H,oBAAgB,wBAAU51H,IAAV,EAAgB;AAC9B,UAAIg1H,WAAW,KAAK7kF,MAAL,CAAY6kF,QAA3B,CAD8B,CACO;;AAErC,UAAI,CAACA,SAAS/zH,cAAT,CAAwBjB,IAAxB,CAAL,EAAoC;AAClCg1H,iBAASh1H,IAAT,IAAiB,IAAjB;AACD;;AAED,WAAKg1H,SAASh1H,IAAT,IAAiB,UAAjB,GAA8B,QAAnC,EAA6CA,IAA7C;AACD,KAhJoC;;AAkJrC;;;AAGAo1H,gBAAY,oBAAUp1H,IAAV,EAAgB;AAC1B,UAAIg1H,WAAW,KAAK7kF,MAAL,CAAY6kF,QAA3B;AACA,aAAO,EAAEA,SAAS/zH,cAAT,CAAwBjB,IAAxB,KAAiC,CAACg1H,SAASh1H,IAAT,CAApC,KAAuDgC,QAAQ,KAAKyzH,eAAb,EAA8Bz1H,IAA9B,KAAuC,CAArG;AACD,KAxJoC;AAyJrC0+D,mBAAe;AACb;AACAzyC,cAAQ,CAFK;AAGb;AACAC,SAAG,CAJU;AAKb/G,YAAM,IALO;AAMb;AACA;AACA22C,cAAQ,YARK;AASbryC,YAAM,QATO;AAUb;AACAwJ,WAAK,CAXQ;AAYb;AACA;AACA;AACA;AACA4iG,aAAO,MAhBM;AAiBbnwF,uBAAiB,eAjBJ;AAkBb;AACA6nD,mBAAa,MAnBA;AAoBbuoC,oBAAc,CApBD;AAqBb;AACAnS,mBAAa,CAtBA;AAuBb;AACA;AACAlrF,eAAS,CAzBI;AA0Bb;AACA;AACAy7F,eAAS,EA5BI;AA6Bb;AACA6B,iBAAW,EA9BE;AA+Bb;AACAC,kBAAY,EAhCC;AAiCb;AACAC,qBAAe,MAlCF;AAmCb3nE,iBAAW;AACT;AACAjyC,eAAO;AAFE,OAnCE;AAuCb;AACA;AACAq5G,oBAAc,IAzCD;AA0Cb;AACA;AACA;AACA;AACA;AACAriD,eAAS;AACPluD,cAAM;AADC;AA/CI;AAzJsB,GAArB,CAAlB;;AA8MA;;;;;;;;;;;;;;;;;;AAkBA,WAAS+wG,yBAAT,CAAmC1iF,UAAnC,EAA+CzC,OAA/C,EAAwDU,OAAxD,EAAiE;AAC/D,QAAI0kF,cAAc,EAAlB;AACA,QAAIC,iBAAiB5iF,eAAe,gBAApC;AACA,QAAI4hF,UAAJ,CAH+D,CAG/C;;AAEhB3jF,YAAQ24B,aAAR,CAAsB,QAAtB,EAAgC,UAAUisD,WAAV,EAAuB;AACrD,UAAID,kBAAkBhB,cAAc,IAApC,EAA0C;AACxC;AACA;AACA;AACA;AACAiB,oBAAYjB,aAAa,QAAb,GAAwB,UAApC,EAAgDrkF,QAAQ/wC,IAAxD;AACD,OAND,MAMO;AACLq2H,oBAAY7iF,UAAZ,EAAwBzC,QAAQ/wC,IAAhC;AACAo1H,qBAAaiB,YAAYjB,UAAZ,CAAuBrkF,QAAQ/wC,IAA/B,CAAb;AACD;;AAED,UAAIk1H,aAAamB,YAAYliD,OAAZ,EAAjB;AACAtxE,aAAOqyH,UAAP,EAAmB,UAAUpgF,KAAV,EAAiB;AAClC,YAAI90C,OAAO80C,MAAMnvC,GAAN,CAAU,MAAV,CAAX,CADkC,CACJ;;AAE9B,YAAI3F,SAAS,IAAT,IAAiBA,SAAS,EAA9B,EAAkC;AAChC;AACD;;AAED,YAAIs2H,iBAAiBD,YAAYjB,UAAZ,CAAuBp1H,IAAvB,CAArB;;AAEA,YAAIm2H,YAAYl1H,cAAZ,CAA2BjB,IAA3B,CAAJ,EAAsC;AACpC;AACAm2H,sBAAYn2H,IAAZ,IAAoBm2H,YAAYn2H,IAAZ,KAAqBs2H,cAAzC;AACD,SAHD,MAGO;AACLH,sBAAYn2H,IAAZ,IAAoBs2H,cAApB;AACD;AACF,OAfD;AAgBD,KA7BD,EAL+D,CAkC3D;;AAEJ,WAAO;AACLt2H,YAAM+wC,QAAQ/wC,IADT;AAELg1H,gBAAUmB;AAFL,KAAP;AAID;AACD;;;;;;;;AASAt9B,iBAAe,oBAAf,EAAqC,qBAArC,EAA4Dn1F,MAAMwyH,yBAAN,EAAiC,gBAAjC,CAA5D;AACA;;;;;;;AAOAr9B,iBAAe,cAAf,EAA+B,gBAA/B,EAAiDn1F,MAAMwyH,yBAAN,EAAiC,QAAjC,CAAjD;AACA;;;;;;;AAOAr9B,iBAAe,gBAAf,EAAiC,kBAAjC,EAAqDn1F,MAAMwyH,yBAAN,EAAiC,UAAjC,CAArD;;AAEA;;;;;;;;;;;;;;;;;;AAkBA;;;;;;;;AASA,WAASK,cAAT,CAAwBrvG,IAAxB,EAA8B2pB,cAA9B,EAA8C;AAC5C,QAAIpY,UAAUuhC,oBAAoBnpB,eAAelrC,GAAf,CAAmB,SAAnB,CAApB,CAAd;AACA,QAAIyrB,QAAQyf,eAAegiB,YAAf,CAA4B,CAAC,OAAD,EAAU,SAAV,CAA5B,CAAZ;AACAzhC,UAAMlD,IAAN,GAAa2iB,eAAelrC,GAAf,CAAmB,iBAAnB,CAAb;AACA,QAAIuhB,OAAO,IAAIghC,IAAJ,CAAS;AAClBxtB,aAAO;AACL9zB,WAAGsgB,KAAKtgB,CAAL,GAAS6xB,QAAQ,CAAR,CADP;AAEL5xB,WAAGqgB,KAAKrgB,CAAL,GAAS4xB,QAAQ,CAAR,CAFP;AAGL3S,eAAOoB,KAAKpB,KAAL,GAAa2S,QAAQ,CAAR,CAAb,GAA0BA,QAAQ,CAAR,CAH5B;AAIL1S,gBAAQmB,KAAKnB,MAAL,GAAc0S,QAAQ,CAAR,CAAd,GAA2BA,QAAQ,CAAR,CAJ9B;AAKLze,WAAG62B,eAAelrC,GAAf,CAAmB,cAAnB;AALE,OADW;AAQlByrB,aAAOA,KARW;AASlB5iB,cAAQ,IATU;AAUlB2d,UAAI,CAAC;AAVa,KAAT,CAAX,CAJ4C,CAexC;AACJ;AACA;AACA;;AAEA,WAAOjF,IAAP;AACD;;AAED;;;;;;;;;;;;;;;;;;AAkBA,MAAIsvG,UAAU9yH,KAAd;AACA,MAAI+yH,SAAS5zH,MAAb;AACA,MAAI6zH,UAAUtvG,KAAd;AACA,MAAIuvG,aAAa98B,oBAAoB;AACnCh2F,UAAM,cAD6B;AAEnC+yH,qBAAiB,KAFkB;;AAInC;;;AAGA7nF,UAAM,gBAAY;AAChB;;;;AAIA,WAAKgtB,KAAL,CAAW70D,GAAX,CAAe,KAAK2vH,aAAL,GAAqB,IAAIH,OAAJ,EAApC;AACA;;;;;AAKA,WAAKI,aAAL;AACD,KAnBkC;;AAqBnC;;;AAGAC,qBAAiB,2BAAY;AAC3B,aAAO,KAAKF,aAAZ;AACD,KA1BkC;;AA4BnC;;;AAGAx2C,YAAQ,gBAAUg2C,WAAV,EAAuB5kF,OAAvB,EAAgCg7B,GAAhC,EAAqC;AAC3C,WAAKuqD,UAAL;;AAEA,UAAI,CAACX,YAAY1wH,GAAZ,CAAgB,MAAhB,EAAwB,IAAxB,CAAL,EAAoC;AAClC;AACD;;AAED,UAAIsxH,YAAYZ,YAAY1wH,GAAZ,CAAgB,OAAhB,CAAhB;;AAEA,UAAI,CAACsxH,SAAD,IAAcA,cAAc,MAAhC,EAAwC;AACtCA,oBAAYZ,YAAY1wH,GAAZ,CAAgB,MAAhB,MAA4B,OAA5B,IAAuC0wH,YAAY1wH,GAAZ,CAAgB,QAAhB,MAA8B,UAArE,GAAkF,OAAlF,GAA4F,MAAxG;AACD;;AAED,WAAKuxH,WAAL,CAAiBD,SAAjB,EAA4BZ,WAA5B,EAAyC5kF,OAAzC,EAAkDg7B,GAAlD,EAb2C,CAaa;;AAExD,UAAI5P,eAAew5D,YAAY/3D,kBAAZ,EAAnB;AACA,UAAI64D,eAAe;AACjBrxG,eAAO2mD,IAAI35C,QAAJ,EADU;AAEjB/M,gBAAQ0mD,IAAI15C,SAAJ;AAFS,OAAnB;AAIA,UAAI0F,UAAU49F,YAAY1wH,GAAZ,CAAgB,SAAhB,CAAd;AACA,UAAI8S,UAAUmkD,cAAcC,YAAd,EAA4Bs6D,YAA5B,EAA0C1+F,OAA1C,CAAd;AACA,UAAI2+F,WAAW,KAAKC,WAAL,CAAiBhB,WAAjB,EAA8BY,SAA9B,EAAyCx+G,OAAzC,CAAf,CAtB2C,CAsBuB;;AAElE,UAAIo8G,aAAaj4D,cAAc/6D,SAAS;AACtCikB,eAAOsxG,SAAStxG,KADsB;AAEtCC,gBAAQqxG,SAASrxG;AAFqB,OAAT,EAG5B82C,YAH4B,CAAd,EAGCs6D,YAHD,EAGe1+F,OAHf,CAAjB;AAIA,WAAKsjC,KAAL,CAAWt3C,IAAX,CAAgB,UAAhB,EAA4B,CAACowG,WAAWjuH,CAAX,GAAewwH,SAASxwH,CAAzB,EAA4BiuH,WAAWhuH,CAAX,GAAeuwH,SAASvwH,CAApD,CAA5B,EA5B2C,CA4B0C;;AAErF,WAAKk1D,KAAL,CAAW70D,GAAX,CAAe,KAAK4vH,aAAL,GAAqBP,eAAea,QAAf,EAAyBf,WAAzB,CAApC;AACD,KA9DkC;;AAgEnC;;;AAGAW,gBAAY,sBAAY;AACtB,WAAKD,eAAL,GAAuB1uG,SAAvB;AACA,WAAKyuG,aAAL,IAAsB,KAAK/6D,KAAL,CAAWzjD,MAAX,CAAkB,KAAKw+G,aAAvB,CAAtB;AACD,KAtEkC;;AAwEnC;;;AAGAI,iBAAa,qBAAUD,SAAV,EAAqBZ,WAArB,EAAkC5kF,OAAlC,EAA2Cg7B,GAA3C,EAAgD;AAC3D,UAAI6qD,eAAe,KAAKP,eAAL,EAAnB;AACA,UAAIQ,iBAAiB1xH,eAArB;AACA,UAAI2xH,aAAanB,YAAY1wH,GAAZ,CAAgB,cAAhB,CAAjB;AACA,UAAIouF,kBAAkB,EAAtB;AACAtiD,cAAQy5B,aAAR,CAAsB,UAAU1J,WAAV,EAAuB;AAC3C,SAACA,YAAY77D,GAAZ,CAAgB,iBAAhB,CAAD,IAAuCouF,gBAAgB9wF,IAAhB,CAAqBu+D,YAAYx9C,EAAjC,CAAvC;AACD,OAFD;AAGAyyG,aAAOJ,YAAYliD,OAAZ,EAAP,EAA8B,UAAU6E,SAAV,EAAqB/nC,SAArB,EAAgC;AAC5D,YAAIjxC,OAAOg5E,UAAUrzE,GAAV,CAAc,MAAd,CAAX,CAD4D,CAC1B;;AAElC,YAAI,CAAC,KAAKixH,eAAN,KAA0B52H,SAAS,EAAT,IAAeA,SAAS,IAAlD,CAAJ,EAA6D;AAC3Ds3H,uBAAapwH,GAAb,CAAiB,IAAIwvH,OAAJ,CAAY;AAC3Bl6D,qBAAS;AADkB,WAAZ,CAAjB;AAGA;AACD,SAR2D,CAQ1D;;;AAGF,YAAIgF,cAAc/vB,QAAQ+4B,eAAR,CAAwBxqE,IAAxB,EAA8B,CAA9B,CAAlB;;AAEA,YAAIu3H,eAAe5xH,GAAf,CAAmB3F,IAAnB,CAAJ,EAA8B;AAC5B;AACA;AACD,SAhB2D,CAgB1D;;;AAGF,YAAIwhE,WAAJ,EAAiB;AACf,cAAI5+D,OAAO4+D,YAAY2S,OAAZ,EAAX;AACA,cAAI93D,QAAQzZ,KAAKqwF,SAAL,CAAe,OAAf,CAAZ,CAFe,CAEsB;;AAErC,cAAI,OAAO52E,KAAP,KAAiB,UAArB,EAAiC;AAC/B;AACAA,oBAAQA,MAAMmlD,YAAY4W,aAAZ,CAA0B,CAA1B,CAAN,CAAR;AACD,WAPc,CAOb;;;AAGF,cAAIq/C,mBAAmB70H,KAAKqwF,SAAL,CAAe,cAAf,KAAkC,WAAzD;AACA,cAAImmB,aAAax2G,KAAKqwF,SAAL,CAAe,QAAf,CAAjB;;AAEA,cAAIykC,YAAY,KAAKC,WAAL,CAAiB33H,IAAjB,EAAuBixC,SAAvB,EAAkC+nC,SAAlC,EAA6Cq9C,WAA7C,EAA0DoB,gBAA1D,EAA4Ere,UAA5E,EAAwF6d,SAAxF,EAAmG56G,KAAnG,EAA0Gm7G,UAA1G,CAAhB;;AAEAE,oBAAU3uH,EAAV,CAAa,OAAb,EAAsBytH,QAAQoB,oBAAR,EAA8B53H,IAA9B,EAAoCysE,GAApC,CAAtB,EAAgE1jE,EAAhE,CAAmE,WAAnE,EAAgFytH,QAAQqB,uBAAR,EAAiCr2D,WAAjC,EAA8C,IAA9C,EAAoDiL,GAApD,EAAyDsnB,eAAzD,CAAhF,EAA2JhrF,EAA3J,CAA8J,UAA9J,EAA0KytH,QAAQsB,sBAAR,EAAgCt2D,WAAhC,EAA6C,IAA7C,EAAmDiL,GAAnD,EAAwDsnB,eAAxD,CAA1K;AACAwjC,yBAAe7xH,GAAf,CAAmB1F,IAAnB,EAAyB,IAAzB;AACD,SAjBD,MAiBO;AACL;AACAyxC,kBAAQy5B,aAAR,CAAsB,UAAU1J,WAAV,EAAuB;AAC3C;AACA,gBAAI+1D,eAAe5xH,GAAf,CAAmB3F,IAAnB,CAAJ,EAA8B;AAC5B;AACD;;AAED,gBAAIwhE,YAAYsb,kBAAhB,EAAoC;AAClC,kBAAIl6E,OAAO4+D,YAAYsb,kBAAZ,EAAX;AACA,kBAAIp1D,MAAM9kB,KAAKuuC,WAAL,CAAiBnxC,IAAjB,CAAV;;AAEA,kBAAI0nB,MAAM,CAAV,EAAa;AACX;AACD;;AAED,kBAAIrL,QAAQzZ,KAAK+1E,aAAL,CAAmBjxD,GAAnB,EAAwB,OAAxB,CAAZ;AACA,kBAAI+vG,mBAAmB,WAAvB;;AAEA,kBAAIC,YAAY,KAAKC,WAAL,CAAiB33H,IAAjB,EAAuBixC,SAAvB,EAAkC+nC,SAAlC,EAA6Cq9C,WAA7C,EAA0DoB,gBAA1D,EAA4E,IAA5E,EAAkFR,SAAlF,EAA6F56G,KAA7F,EAAoGm7G,UAApG,CAAhB,CAXkC,CAW+F;;;AAGjIE,wBAAU3uH,EAAV,CAAa,OAAb,EAAsBytH,QAAQoB,oBAAR,EAA8B53H,IAA9B,EAAoCysE,GAApC,CAAtB,EAAgE;AAAhE,eACC1jE,EADD,CACI,WADJ,EACiBytH,QAAQqB,uBAAR,EAAiCr2D,WAAjC,EAA8CxhE,IAA9C,EAAoDysE,GAApD,EAAyDsnB,eAAzD,CADjB,EAC4FhrF,EAD5F,CAC+F,UAD/F,EAC2GytH,QAAQsB,sBAAR,EAAgCt2D,WAAhC,EAA6CxhE,IAA7C,EAAmDysE,GAAnD,EAAwDsnB,eAAxD,CAD3G;AAEAwjC,6BAAe7xH,GAAf,CAAmB1F,IAAnB,EAAyB,IAAzB;AACD;AACF,WAxBD,EAwBG,IAxBH;AAyBD;AACF,OAhED,EAgEG,IAhEH;AAiED,KApJkC;AAqJnC23H,iBAAa,qBAAU33H,IAAV,EAAgBixC,SAAhB,EAA2B+nC,SAA3B,EAAsCq9C,WAAtC,EAAmDoB,gBAAnD,EAAqEre,UAArE,EAAiF6d,SAAjF,EAA4F56G,KAA5F,EAAmGm7G,UAAnG,EAA+G;AAC1H,UAAIzB,YAAYM,YAAY1wH,GAAZ,CAAgB,WAAhB,CAAhB;AACA,UAAIqwH,aAAaK,YAAY1wH,GAAZ,CAAgB,YAAhB,CAAjB;AACA,UAAIswH,gBAAgBI,YAAY1wH,GAAZ,CAAgB,eAAhB,CAApB;AACA,UAAIoyH,mBAAmB1B,YAAY1wH,GAAZ,CAAgB,kBAAhB,CAAvB;AACA,UAAIyvH,aAAaiB,YAAYjB,UAAZ,CAAuBp1H,IAAvB,CAAjB;AACA,UAAI03H,YAAY,IAAIhB,OAAJ,EAAhB;AACA,UAAInoE,iBAAiByqB,UAAU3pB,QAAV,CAAmB,WAAnB,CAArB;AACA,UAAI2oE,WAAWh/C,UAAUrzE,GAAV,CAAc,MAAd,CAAf;AACA,UAAIsyH,eAAej/C,UAAU3pB,QAAV,CAAmB,SAAnB,CAAnB;AACA,UAAI6oE,2BAA2BD,aAAaxoE,WAA5C,CAV0H,CAUjE;;AAEzDgoE,yBAAmBO,YAAYP,gBAA/B;AACAC,gBAAUxwH,GAAV,CAAcyyG,aAAa8d,gBAAb,EAA+B,CAA/B,EAAkC,CAAlC,EAAqC1B,SAArC,EAAgDC,UAAhD,EAA4DZ,aAAa/4G,KAAb,GAAqB45G,aAAjF,EAAgG;AAC9G8B,0BAAoB,IAApB,GAA2B,IAA3B,GAAkCA,gBADpB,CAAd,EAb0H,CAcpE;AACtD;;AAEA,UAAI,CAACC,QAAD,IAAa5e,UAAb,CAAwB;AAAxB,UACAA,eAAeqe,gBAAf,IAAmCre,cAAc,MADjD,CAAJ,EAC8D;AAC5D,YAAIlI,OAAO8kB,aAAa,GAAxB;;AAEA,YAAI5c,eAAe,MAAnB,EAA2B;AACzBA,uBAAa,QAAb;AACD,SAL2D,CAK1D;;;AAGFse,kBAAUxwH,GAAV,CAAcyyG,aAAaP,UAAb,EAAyB,CAAC2c,YAAY7kB,IAAb,IAAqB,CAA9C,EAAiD,CAAC8kB,aAAa9kB,IAAd,IAAsB,CAAvE,EAA0EA,IAA1E,EAAgFA,IAAhF,EAAsFkkB,aAAa/4G,KAAb,GAAqB45G,aAA3G,EAA0H;AACxI8B,4BAAoB,IAApB,GAA2B,IAA3B,GAAkCA,gBADpB,CAAd;AAED;;AAED,UAAIz7F,QAAQ26F,cAAc,MAAd,GAAuBlB,YAAY,CAAnC,GAAuC,CAAC,CAApD;AACA,UAAIlmG,YAAYonG,SAAhB;AACA,UAAI/9C,YAAYm9C,YAAY1wH,GAAZ,CAAgB,WAAhB,CAAhB;AACA,UAAI+mH,UAAU1sH,IAAd;;AAEA,UAAI,OAAOk5E,SAAP,KAAqB,QAArB,IAAiCA,SAArC,EAAgD;AAC9CwzC,kBAAUxzC,UAAUh0E,OAAV,CAAkB,QAAlB,EAA4BlF,QAAQ,IAAR,GAAeA,IAAf,GAAsB,EAAlD,CAAV;AACD,OAFD,MAEO,IAAI,OAAOk5E,SAAP,KAAqB,UAAzB,EAAqC;AAC1CwzC,kBAAUxzC,UAAUl5E,IAAV,CAAV;AACD;;AAED03H,gBAAUxwH,GAAV,CAAc,IAAI2+C,IAAJ,CAAS;AACrBz0B,eAAOi9B,aAAa,EAAb,EAAiBE,cAAjB,EAAiC;AACtC3/B,gBAAM89F,OADgC;AAEtC9lH,aAAG01B,KAFmC;AAGtCz1B,aAAGmvH,aAAa,CAHsB;AAItC5mG,oBAAUgmG,aAAa7mE,eAAeoE,YAAf,EAAb,GAA6CsjE,aAJjB;AAKtCpmG,qBAAWA,SAL2B;AAMtCC,6BAAmB;AANmB,SAAjC;AADc,OAAT,CAAd,EAzC0H,CAkDrH;;AAEL,UAAIqoG,UAAU,IAAIjwE,IAAJ,CAAS;AACrBxtB,eAAOg9F,UAAUnvG,eAAV,EADc;AAErBI,mBAAW,IAFU;AAGrB0qD,iBAAS4kD,aAAatyH,GAAb,CAAiB,MAAjB,IAA2B/D,OAAO;AACzC8qH,mBAAS1sH,IADgC;AAEzC;AACAk5E,qBAAWg/C,yBAAyBvyH,GAAzB,CAA6B,WAA7B,EAA0C,IAA1C,KAAmD,YAAY;AACxE,mBAAO3F,IAAP;AACD,WALwC;AAMzCssH,2BAAiB;AACf95E,2BAAe,QADA;AAEf4lF,yBAAa/B,YAAY53D,cAFV;AAGfz+D,kBAAMA,IAHS;AAIf66D,mBAAO,CAAC,MAAD;AAJQ;AANwB,SAAP,EAYjCo9D,aAAa9nF,MAZoB,CAA3B,GAYiB;AAfL,OAAT,CAAd;AAiBAunF,gBAAUxwH,GAAV,CAAcixH,OAAd;AACAT,gBAAUpvG,SAAV,CAAoB,UAAUT,KAAV,EAAiB;AACnCA,cAAMrZ,MAAN,GAAe,IAAf;AACD,OAFD;AAGA2pH,cAAQ3pH,MAAR,GAAiB,CAACgpH,UAAlB;AACA,WAAKT,eAAL,GAAuB7vH,GAAvB,CAA2BwwH,SAA3B;AACAvqE,oBAAcuqE,SAAd;AACAA,gBAAUW,iBAAV,GAA8BpnF,SAA9B;AACA,aAAOymF,SAAP;AACD,KAnOkC;;AAqOnC;;;AAGAL,iBAAa,qBAAUhB,WAAV,EAAuBY,SAAvB,EAAkCx+G,OAAlC,EAA2C;AACtD,UAAI6+G,eAAe,KAAKP,eAAL,EAAnB,CADsD,CACX;;AAE3C7uF,UAAImuF,YAAY1wH,GAAZ,CAAgB,QAAhB,CAAJ,EAA+B2xH,YAA/B,EAA6CjB,YAAY1wH,GAAZ,CAAgB,SAAhB,CAA7C,EAAyE8S,QAAQqN,KAAjF,EAAwFrN,QAAQsN,MAAhG;AACA,UAAIuyG,cAAchB,aAAa/uG,eAAb,EAAlB;AACA+uG,mBAAa7yG,IAAb,CAAkB,UAAlB,EAA8B,CAAC,CAAC6zG,YAAY1xH,CAAd,EAAiB,CAAC0xH,YAAYzxH,CAA9B,CAA9B;AACA,aAAO,KAAKk1D,KAAL,CAAWxzC,eAAX,EAAP;AACD;AA/OkC,GAApB,CAAjB;;AAkPA,WAASqvG,oBAAT,CAA8B53H,IAA9B,EAAoCysE,GAApC,EAAyC;AACvCA,QAAIioB,cAAJ,CAAmB;AACjB7wF,YAAM,oBADW;AAEjB7D,YAAMA;AAFW,KAAnB;AAID;;AAED,WAAS63H,uBAAT,CAAiCr2D,WAAjC,EAA8C+2D,QAA9C,EAAwD9rD,GAAxD,EAA6DsnB,eAA7D,EAA8E;AAC5E;AACA,QAAIxlF,KAAKk+D,IAAI6kB,KAAJ,GAAY5kF,OAAZ,CAAoBsC,cAApB,GAAqC,CAArC,CAAT;;AAEA,QAAI,EAAET,MAAMA,GAAG09C,aAAX,CAAJ,EAA+B;AAC7BwgB,UAAIioB,cAAJ,CAAmB;AACjB7wF,cAAM,WADW;AAEjBgjE,oBAAYrF,YAAYxhE,IAFP;AAGjBA,cAAMu4H,QAHW;AAIjBxkC,yBAAiBA;AAJA,OAAnB;AAMD;AACF;;AAED,WAAS+jC,sBAAT,CAAgCt2D,WAAhC,EAA6C+2D,QAA7C,EAAuD9rD,GAAvD,EAA4DsnB,eAA5D,EAA6E;AAC3E;AACA,QAAIxlF,KAAKk+D,IAAI6kB,KAAJ,GAAY5kF,OAAZ,CAAoBsC,cAApB,GAAqC,CAArC,CAAT;;AAEA,QAAI,EAAET,MAAMA,GAAG09C,aAAX,CAAJ,EAA+B;AAC7BwgB,UAAIioB,cAAJ,CAAmB;AACjB7wF,cAAM,UADW;AAEjBgjE,oBAAYrF,YAAYxhE,IAFP;AAGjBA,cAAMu4H,QAHW;AAIjBxkC,yBAAiBA;AAJA,OAAnB;AAMD;AACF;;AAED;;;;;;;;;;;;;;;;;;AAkBA,MAAIykC,eAAe,SAAfA,YAAe,CAAU/mF,OAAV,EAAmB;AACpC,QAAIgnF,eAAehnF,QAAQk4B,cAAR,CAAuB;AACxC73B,gBAAU;AAD8B,KAAvB,CAAnB;;AAIA,QAAI2mF,gBAAgBA,aAAa93H,MAAjC,EAAyC;AACvC8wC,cAAQ85B,YAAR,CAAqB,UAAUd,MAAV,EAAkB;AACrC;AACA;AACA,aAAK,IAAIhqE,IAAI,CAAb,EAAgBA,IAAIg4H,aAAa93H,MAAjC,EAAyCF,GAAzC,EAA8C;AAC5C,cAAI,CAACg4H,aAAah4H,CAAb,EAAgB20H,UAAhB,CAA2B3qD,OAAOzqE,IAAlC,CAAL,EAA8C;AAC5C,mBAAO,KAAP;AACD;AACF;;AAED,eAAO,IAAP;AACD,OAVD;AAWD;AACF,GAlBD;;AAoBA;;;;;;;;;;;;;;;;;;AAkBA;AACAu4F,oBAAkBigC,YAAlB;AACAh6D,iBAAerK,wBAAf,CAAwC,QAAxC,EAAkD,YAAY;AAC5D;AACA,WAAO,OAAP;AACD,GAHD;;AAKA;;;;;;;;;;;;;;;;;;AAkBA,MAAIukE,wBAAwB3D,YAAYnzH,MAAZ,CAAmB;AAC7CiC,UAAM,eADuC;;AAG7C;;;AAGA80H,wBAAoB,4BAAUC,eAAV,EAA2B;AAC7C,WAAKzoF,MAAL,CAAYyoF,eAAZ,GAA8BA,eAA9B;AACD,KAR4C;AAS7Cl6D,mBAAe;AACbk6D,uBAAiB,CADJ;AAEbC,yBAAmB,CAFN;AAGbC,qBAAe,IAHF;AAIbC,0BAAoB,KAJP;AAKb;AACAC,qBAAe,mBANF;AAOb;AACAC,iBAAW;AACTC,oBAAY,CAAC,oBAAD,EAAuB,sBAAvB,CADH;AAETC,kBAAU,CAAC,mBAAD,EAAsB,kBAAtB;AAFD,OARE;AAYbC,qBAAe,SAZF;AAabC,6BAAuB,MAbV;AAcbC,oBAAc,EAdD;AAeb;AACAC,qBAAe;AACbl9G,eAAO;AADM,OAhBF;AAmBb+jD,+BAAyB;AAnBZ,KAT8B;;AA+B7C;;;AAGArxB,UAAM,cAAUoB,MAAV,EAAkBsf,WAAlB,EAA+Bhe,OAA/B,EAAwCqtB,QAAxC,EAAkD;AACtD,UAAIE,sBAAsBb,gBAAgBhuB,MAAhB,CAA1B;AACAuoF,4BAAsBzlF,SAAtB,CAAgC,IAAhC,EAAsC,MAAtC,EAA8C9C,MAA9C,EAAsDsf,WAAtD,EAAmEhe,OAAnE,EAA4EqtB,QAA5E;AACA06D,oCAA8B,IAA9B,EAAoCrpF,MAApC,EAA4C6uB,mBAA5C;AACD,KAtC4C;;AAwC7C;;;AAGA7L,iBAAa,qBAAUhjB,MAAV,EAAkB2uB,QAAlB,EAA4B;AACvC45D,4BAAsBzlF,SAAtB,CAAgC,IAAhC,EAAsC,aAAtC,EAAqD9C,MAArD,EAA6D2uB,QAA7D;AACA06D,oCAA8B,IAA9B,EAAoC,KAAKrpF,MAAzC,EAAiDA,MAAjD;AACD,KA9C4C;AA+C7CspF,eAAW,qBAAY;AACrB,aAAO,KAAK9zH,GAAL,CAAS,QAAT,MAAuB,UAAvB,GAAoC;AACzCqzB,eAAO,CADkC;AAEzCh5B,cAAM;AAFmC,OAApC,GAGH;AACFg5B,eAAO,CADL;AAEFh5B,cAAM;AAFJ,OAHJ;AAOD;AAvD4C,GAAnB,CAA5B,CA51lC4B,CAo5lCxB;;AAEJ,WAASw5H,6BAAT,CAAuCnD,WAAvC,EAAoDl1H,MAApD,EAA4Du4H,GAA5D,EAAiE;AAC/D,QAAI59D,SAASu6D,YAAYoD,SAAZ,EAAb;AACA,QAAIn8D,aAAa,CAAC,CAAD,EAAI,CAAJ,CAAjB;AACAA,eAAWxB,OAAO9iC,KAAlB,IAA2B,CAA3B;AACAmkC,qBAAiBh8D,MAAjB,EAAyBu4H,GAAzB,EAA8B;AAC5B71H,YAAM,KADsB;AAE5By5D,kBAAYA;AAFgB,KAA9B;AAID;;AAED;;;;;;;;;;;;;;;;;;;AAmBA;;;AAGA,MAAIq8D,UAAUvyG,KAAd;AACA,MAAIwyG,KAAK,CAAC,OAAD,EAAU,QAAV,CAAT;AACA,MAAIC,KAAK,CAAC,GAAD,EAAM,GAAN,CAAT;AACA,MAAIC,uBAAuBnD,WAAW/0H,MAAX,CAAkB;AAC3CiC,UAAM,eADqC;AAE3C+yH,qBAAiB,IAF0B;AAG3C7nF,UAAM,gBAAY;AAChB+qF,2BAAqB7mF,SAArB,CAA+B,IAA/B,EAAqC,MAArC;AACA;;;;;AAKA,WAAK8mF,aAAL,GAAqB,CAArB;AACA;;;;;AAKA,WAAKh+D,KAAL,CAAW70D,GAAX,CAAe,KAAK8yH,eAAL,GAAuB,IAAIL,OAAJ,EAAtC;;AAEA,WAAKK,eAAL,CAAqB9yH,GAArB,CAAyB,KAAK6vH,eAAL,EAAzB;AACA;;;;;AAMA,WAAKh7D,KAAL,CAAW70D,GAAX,CAAe,KAAK+yH,gBAAL,GAAwB,IAAIN,OAAJ,EAAvC;AACA;;;;;AAKA,WAAKO,eAAL;AACD,KAhC0C;;AAkC3C;;;AAGAlD,gBAAY,sBAAY;AACtB8C,2BAAqB7mF,SAArB,CAA+B,IAA/B,EAAqC,YAArC;;AAEA,WAAKgnF,gBAAL,CAAsB5xG,SAAtB;;AAEA,WAAK2xG,eAAL,CAAqB10G,cAArB;;AAEA,WAAK00G,eAAL,CAAqBG,UAArB,GAAkC,IAAlC;AACD,KA7C0C;;AA+C3C;;;AAGAjD,iBAAa,qBAAUD,SAAV,EAAqBZ,WAArB,EAAkC5kF,OAAlC,EAA2Cg7B,GAA3C,EAAgD;AAC3D,UAAI2tD,KAAK,IAAT,CAD2D,CAC5C;;AAEfN,2BAAqB7mF,SAArB,CAA+B,IAA/B,EAAqC,aAArC,EAAoDgkF,SAApD,EAA+DZ,WAA/D,EAA4E5kF,OAA5E,EAAqFg7B,GAArF;AACA,UAAI4tD,kBAAkB,KAAKJ,gBAA3B;AACA,UAAIX,eAAejD,YAAY1wH,GAAZ,CAAgB,cAAhB,EAAgC,IAAhC,CAAnB;;AAEA,UAAI,CAACnE,QAAQ83H,YAAR,CAAL,EAA4B;AAC1BA,uBAAe,CAACA,YAAD,EAAeA,YAAf,CAAf;AACD;;AAEDgB,uBAAiB,UAAjB,EAA6B,CAA7B;AACA,UAAIC,qBAAqBlE,YAAYhnE,QAAZ,CAAqB,eAArB,CAAzB;AACAgrE,sBAAgBnzH,GAAhB,CAAoB,IAAI2+C,IAAJ,CAAS;AAC3B7lD,cAAM,UADqB;AAE3BoxB,eAAO;AACLhC,oBAAUmrG,mBAAmB5nE,YAAnB,EADL;AAEL9jC,gBAAM0rG,mBAAmBvqE,OAAnB,EAFD;AAGLlgC,6BAAmB,QAHd;AAILD,qBAAW;AAJN,SAFoB;AAQ3BrhB,gBAAQ;AARmB,OAAT,CAApB;AAUA8rH,uBAAiB,UAAjB,EAA6B,CAA7B;;AAEA,eAASA,gBAAT,CAA0Bt6H,IAA1B,EAAgCw6H,OAAhC,EAAyC;AACvC,YAAIC,oBAAoBz6H,OAAO,WAA/B;AACA,YAAI06H,OAAOroE,WAAWgkE,YAAY1wH,GAAZ,CAAgB,WAAhB,EAA6B,IAA7B,EAAmC0wH,YAAYoD,SAAZ,GAAwBz5H,IAA3D,EAAiEw6H,OAAjE,CAAX,EAAsF;AAC/F;AACA;AACAG,mBAASv3H,KAAKg3H,GAAGQ,OAAR,EAAiBR,EAAjB,EAAqBK,iBAArB,EAAwCpE,WAAxC,EAAqD5pD,GAArD;AAHsF,SAAtF,EAIR;AACD7lE,aAAG,CAAC0yH,aAAa,CAAb,CAAD,GAAmB,CADrB;AAEDzyH,aAAG,CAACyyH,aAAa,CAAb,CAAD,GAAmB,CAFrB;AAGDxzG,iBAAOwzG,aAAa,CAAb,CAHN;AAIDvzG,kBAAQuzG,aAAa,CAAb;AAJP,SAJQ,CAAX;AAUAoB,aAAK16H,IAAL,GAAYA,IAAZ;AACAq6H,wBAAgBnzH,GAAhB,CAAoBwzH,IAApB;AACD;AACF,KA1F0C;;AA4F3C;;;AAGArD,iBAAa,qBAAUhB,WAAV,EAAuBY,SAAvB,EAAkCx+G,OAAlC,EAA2C;AACtD,UAAI6+G,eAAe,KAAKP,eAAL,EAAnB;AACA,UAAI8D,iBAAiB,KAAKb,eAA1B;AACA,UAAIK,kBAAkB,KAAKJ,gBAA3B;AACA,UAAIa,YAAYzE,YAAYoD,SAAZ,GAAwBzgG,KAAxC;AACA,UAAIwN,KAAKozF,GAAGkB,SAAH,CAAT;AACA,UAAIC,KAAKnB,GAAG,IAAIkB,SAAP,CAAT;AACA,UAAIE,KAAKnB,GAAG,IAAIiB,SAAP,CAAT,CAPsD,CAO1B;;AAE5B5yF,UAAImuF,YAAY1wH,GAAZ,CAAgB,QAAhB,CAAJ,EAA+B2xH,YAA/B,EAA6CjB,YAAY1wH,GAAZ,CAAgB,SAAhB,CAA7C,EAAyE,CAACm1H,SAAD,GAAa,IAAb,GAAoBriH,QAAQqN,KAArG,EAA4Gg1G,YAAY,IAAZ,GAAmBriH,QAAQsN,MAAvI;AACAmiB,WAAK;AACL,kBADA,EACcmyF,eADd,EAC+BhE,YAAY1wH,GAAZ,CAAgB,mBAAhB,EAAqC,IAArC,CAD/B;AAEA,UAAI2yH,cAAchB,aAAa/uG,eAAb,EAAlB;AACA,UAAI0yG,iBAAiBZ,gBAAgB9xG,eAAhB,EAArB;AACA,UAAI2yG,iBAAiB,KAAKhB,eAAL,GAAuB5B,YAAY9xF,EAAZ,IAAkB/tB,QAAQ+tB,EAAR,CAA9D;AACA,UAAI20F,aAAa,CAAC,CAAC7C,YAAY1xH,CAAd,EAAiB,CAAC0xH,YAAYzxH,CAA9B,CAAjB,CAfsD,CAeH;;AAEnDs0H,iBAAWL,SAAX,IAAwBxD,aAAarlH,QAAb,CAAsB6oH,SAAtB,CAAxB,CAjBsD,CAiBI;;AAE1D,UAAIM,eAAe,CAAC,CAAD,EAAI,CAAJ,CAAnB;AACA,UAAIC,gBAAgB,CAAC,CAACJ,eAAer0H,CAAjB,EAAoB,CAACq0H,eAAep0H,CAApC,CAApB;AACA,UAAIiyH,gBAAgB10H,UAAUiyH,YAAY1wH,GAAZ,CAAgB,eAAhB,EAAiC,IAAjC,CAAV,EAAkD0wH,YAAY1wH,GAAZ,CAAgB,SAAhB,EAA2B,IAA3B,CAAlD,CAApB,CArBsD,CAqBmD;;AAEzG,UAAIu1H,cAAJ,EAAoB;AAClB,YAAInC,qBAAqB1C,YAAY1wH,GAAZ,CAAgB,oBAAhB,EAAsC,IAAtC,CAAzB,CADkB,CACoD;;AAEtE,YAAIozH,uBAAuB,KAA3B,EAAkC;AAChCsC,wBAAcP,SAAd,KAA4BriH,QAAQ+tB,EAAR,IAAcy0F,eAAez0F,EAAf,CAA1C;AACD,SAFD,CAEE;AAFF,aAGK;AACD40F,yBAAaN,SAAb,KAA2BG,eAAez0F,EAAf,IAAqBsyF,aAAhD;AACD;AACJ,OAhCqD,CAgCpD;;;AAGFuC,oBAAc,IAAIP,SAAlB,KAAgCxC,YAAYyC,EAAZ,IAAkB,CAAlB,GAAsBE,eAAeF,EAAf,IAAqB,CAA3E;AACAzD,mBAAa7yG,IAAb,CAAkB,UAAlB,EAA8B02G,UAA9B;AACAN,qBAAep2G,IAAf,CAAoB,UAApB,EAAgC22G,YAAhC;AACAf,sBAAgB51G,IAAhB,CAAqB,UAArB,EAAiC42G,aAAjC,EAtCsD,CAsCL;AACjD;AACA;;AAEA,UAAIjE,WAAW,KAAKr7D,KAAL,CAAWxzC,eAAX,EAAf;AACA,UAAI6uG,WAAW;AACbxwH,WAAG,CADU;AAEbC,WAAG;AAFU,OAAf,CA3CsD,CA8CnD;;AAEHuwH,eAAS5wF,EAAT,IAAe00F,iBAAiBziH,QAAQ+tB,EAAR,CAAjB,GAA+B8xF,YAAY9xF,EAAZ,CAA9C;AACA4wF,eAAS2D,EAAT,IAAexzH,KAAKqB,GAAL,CAAS0vH,YAAYyC,EAAZ,CAAT,EAA0BE,eAAeF,EAAf,CAA1B,CAAf,CAjDsD,CAiDQ;;AAE9D3D,eAAS4D,EAAT,IAAezzH,KAAKoB,GAAL,CAAS,CAAT,EAAYsyH,eAAeD,EAAf,IAAqBK,cAAc,IAAIP,SAAlB,CAAjC,CAAf;AACAD,qBAAeV,UAAf,GAA4B1hH,QAAQ+tB,EAAR,CAA5B;;AAEA,UAAI00F,cAAJ,EAAoB;AAClB,YAAII,YAAY;AACd10H,aAAG,CADW;AAEdC,aAAG;AAFW,SAAhB;AAIAy0H,kBAAU90F,EAAV,IAAgBj/B,KAAKqB,GAAL,CAAS6P,QAAQ+tB,EAAR,IAAcy0F,eAAez0F,EAAf,CAAd,GAAmCsyF,aAA5C,EAA2D,CAA3D,CAAhB;AACAwC,kBAAUP,EAAV,IAAgB3D,SAAS2D,EAAT,CAAhB;AACAF,uBAAez1G,WAAf,CAA2B,IAAI8iC,IAAJ,CAAS;AAClCxtB,iBAAO4gG;AAD2B,SAAT,CAA3B,EAPkB,CASb;AACL;;AAEAT,uBAAeV,UAAf,GAA4BmB,UAAU90F,EAAV,CAA5B;AACD,OAbD,MAaO;AACL;AACA6zF,wBAAgB/xG,SAAhB,CAA0B,UAAUT,KAAV,EAAiB;AACzCA,gBAAMpD,IAAN,CAAW;AACTkE,uBAAW,IADF;AAETna,oBAAQ;AAFC,WAAX;AAID,SALD;AAMD,OA3EqD,CA2EpD;;;AAGF,UAAI+sH,WAAW,KAAKC,YAAL,CAAkBnF,WAAlB,CAAf;;AAEAkF,eAASE,SAAT,IAAsB,IAAtB,IAA8B7qE,YAAY0mE,YAAZ,EAA0B;AACtDrlH,kBAAUspH,SAASG;AADmC,OAA1B,EAE3B;AACH;AACAR,uBAAiB7E,WAAjB,GAA+B,KAJD,CAA9B;;AAMA,WAAKsF,mBAAL,CAAyBtF,WAAzB,EAAsCkF,QAAtC;;AAEA,aAAOnE,QAAP;AACD,KAxL0C;AAyL3CwD,aAAS,iBAAUgB,EAAV,EAAcvF,WAAd,EAA2B5pD,GAA3B,EAAgC;AACvC,UAAImsD,kBAAkB,KAAK4C,YAAL,CAAkBnF,WAAlB,EAA+BuF,EAA/B,CAAtB;;AAEAhD,yBAAmB,IAAnB,IAA2BnsD,IAAIioB,cAAJ,CAAmB;AAC5C7wF,cAAM,cADsC;AAE5C+0H,yBAAiBA,eAF2B;AAG5CiD,kBAAUxF,YAAYryG;AAHsB,OAAnB,CAA3B;AAKD,KAjM0C;AAkM3C23G,yBAAqB,6BAAUtF,WAAV,EAAuBkF,QAAvB,EAAiC;AACpD,UAAIlB,kBAAkB,KAAKJ,gBAA3B;AACAp3H,aAAO,CAAC,UAAD,EAAa,UAAb,CAAP,EAAiC,UAAU7C,IAAV,EAAgB;AAC/C,YAAI87H,UAAUP,SAASv7H,OAAO,WAAhB,KAAgC,IAA9C;AACA,YAAI06H,OAAOL,gBAAgB1yG,WAAhB,CAA4B3nB,IAA5B,CAAX;;AAEA,YAAI06H,IAAJ,EAAU;AACRA,eAAKx7F,QAAL,CAAc,MAAd,EAAsB48F,UAAUzF,YAAY1wH,GAAZ,CAAgB,eAAhB,EAAiC,IAAjC,CAAV,GAAmD0wH,YAAY1wH,GAAZ,CAAgB,uBAAhB,EAAyC,IAAzC,CAAzE;AACA+0H,eAAKhtH,MAAL,GAAcouH,UAAU,SAAV,GAAsB,SAApC;AACD;AACF,OARD;AASA,UAAIC,WAAW1B,gBAAgB1yG,WAAhB,CAA4B,UAA5B,CAAf;AACA,UAAIqxG,gBAAgB3C,YAAY1wH,GAAZ,CAAgB,eAAhB,CAApB;AACA,UAAI81H,YAAYF,SAASE,SAAzB;AACA,UAAI//C,UAAU+/C,aAAa,IAAb,GAAoBA,YAAY,CAAhC,GAAoC,CAAlD;AACA,UAAI1gG,QAAQwgG,SAASS,SAArB;AACAD,kBAAY/C,aAAZ,IAA6B+C,SAAS78F,QAAT,CAAkB,MAAlB,EAA0Bt7B,SAASo1H,aAAT,IAA0BA,cAAc9zH,OAAd,CAAsB,WAAtB,EAAmCw2E,OAAnC,EAA4Cx2E,OAA5C,CAAoD,SAApD,EAA+D61B,KAA/D,CAA1B,GAAkGi+F,cAAc;AACrKt9C,iBAASA,OAD4J;AAErK3gD,eAAOA;AAF8J,OAAd,CAA5H,CAA7B;AAID,KAtN0C;;AAwN3C;;;;;;;;;;AAUAygG,kBAAc,sBAAUnF,WAAV,EAAuB;AACnC;AACA,UAAI4F,gBAAgB5F,YAAY1wH,GAAZ,CAAgB,iBAAhB,EAAmC,IAAnC,CAApB;AACA,UAAI2xH,eAAe,KAAKP,eAAL,EAAnB;AACA,UAAIuB,cAAchB,aAAa/uG,eAAb,EAAlB;AACA,UAAI2zG,oBAAoB,KAAKlC,eAAL,CAAqBG,UAA7C;AACA,UAAIW,YAAYzE,YAAYoD,SAAZ,GAAwBzgG,KAAxC;AACA,UAAIwN,KAAKozF,GAAGkB,SAAH,CAAT;AACA,UAAIC,KAAKnB,GAAG,IAAIkB,SAAP,CAAT;AACA,UAAIqB,KAAKtC,GAAGiB,SAAH,CAAT;AACA,UAAIK,aAAa7D,aAAarlH,QAAb,CAAsBxS,KAAtB,EAAjB;AACA,UAAIg8H,SAAJ;AACA,UAAIW,iBAAJ;AACA,UAAIC,iBAAJ;AACA,UAAIC,eAAJ;;AAEA,UAAI,KAAKpC,eAAT,EAA0B;AACxB5C,qBAAahvG,SAAb,CAAuB,UAAUT,KAAV,EAAiB;AACtC,cAAIA,MAAMwwG,iBAAN,KAA4B4D,aAAhC,EAA+C;AAC7CK,8BAAkBz0G,KAAlB;AACD;AACF,SAJD;AAKD,OAND,MAMO;AACLy0G,0BAAkBhF,aAAa7vG,OAAb,CAAqB,CAArB,CAAlB;AACD;;AAED,UAAIu0G,YAAYE,oBAAoB30H,KAAKyV,IAAL,CAAUs7G,YAAY9xF,EAAZ,IAAkB01F,iBAA5B,CAApB,GAAqE,CAArF;;AAEA,UAAII,eAAJ,EAAqB;AACnB,YAAIC,WAAWD,gBAAgB/zG,eAAhB,EAAf;AACA,YAAIi0G,UAAUF,gBAAgBrqH,QAAhB,CAAyB6oH,SAAzB,IAAsCyB,SAASJ,EAAT,CAApD;AACAhB,mBAAWL,SAAX,IAAwB,CAAC0B,OAAD,GAAWlE,YAAY6D,EAAZ,CAAnC;AACAV,oBAAYl0H,KAAKuV,KAAL,CAAWk/G,aAAaQ,UAAUD,SAASJ,EAAT,CAAV,GAAyBD,oBAAoB,CAA1D,IAA+D5D,YAAY9xF,EAAZ,CAA1E,CAAZ;AACAi1F,oBAAYnD,YAAY9xF,EAAZ,KAAmBw1F,SAAnB,GAA+Bz0H,KAAKqB,GAAL,CAAS,CAAT,EAAYrB,KAAKoB,GAAL,CAASqzH,YAAY,CAArB,EAAwBP,SAAxB,CAAZ,CAA/B,GAAiF,CAAC,CAA9F;AACA,YAAIgB,UAAU;AACZ71H,aAAG,CADS;AAEZC,aAAG;AAFS,SAAd;AAIA41H,gBAAQj2F,EAAR,IAAc01F,iBAAd;AACAO,gBAAQ1B,EAAR,IAAczC,YAAYyC,EAAZ,CAAd;AACA0B,gBAAQN,EAAR,IAAc,CAAChB,WAAWL,SAAX,CAAD,GAAyBxC,YAAY6D,EAAZ,CAAvC;AACA,YAAIO,QAAJ;AACA,YAAIl1G,WAAW8vG,aAAa9vG,QAAb,EAAf;AACA8vG,qBAAahvG,SAAb,CAAuB,UAAUT,KAAV,EAAiBmR,KAAjB,EAAwB;AAC7C,cAAIujG,WAAWI,YAAY90G,KAAZ,CAAf;;AAEA,cAAI00G,SAAS91G,SAAT,CAAmBg2G,OAAnB,CAAJ,EAAiC;AAC/BC,wBAAY,IAAZ,KAAqBA,WAAW1jG,KAAhC,EAD+B,CACS;AACxC;;AAEAqjG,gCAAoBx0G,MAAMwwG,iBAA1B;AACD,WAR4C,CAQ3C;;;AAGF,cAAIr/F,UAAUxR,SAAS7mB,MAAT,GAAkB,CAA5B,IAAiC47H,SAASJ,EAAT,IAAeI,SAAS/1F,EAAT,CAAf,IAA+Bi2F,QAAQN,EAAR,IAAcM,QAAQj2F,EAAR,CAAlF,EAA+F;AAC7F61F,gCAAoB,IAApB;AACD;AACF,SAdD,EAfmB,CA6Bf;AACJ;;AAEA,YAAIK,YAAY,IAAhB,EAAsB;AACpB,cAAIE,YAAYp1G,SAASk1G,QAAT,CAAhB;AACA,cAAIG,YAAYF,YAAYC,SAAZ,CAAhB;AACAH,kBAAQN,EAAR,IAAcU,UAAUV,EAAV,IAAgBU,UAAUr2F,EAAV,CAAhB,GAAgCi2F,QAAQj2F,EAAR,CAA9C,CAHoB,CAGuC;;AAE3D,cAAIk2F,YAAY,CAAZ,IAAiBG,UAAUV,EAAV,KAAiBM,QAAQN,EAAR,CAAtC,EAAmD;AACjDC,gCAAoB,IAApB;AACD,WAFD,MAEO;AACL,mBAAOM,WAAW,CAAX,IAAgBC,YAAYn1G,SAASk1G,WAAW,CAApB,CAAZ,EAAoCj2G,SAApC,CAA8Cg2G,OAA9C,CAAvB,EAA+E;AAC7EC;AACD;;AAEDN,gCAAoB50G,SAASk1G,QAAT,EAAmBrE,iBAAvC;AACD;AACF;AACF;;AAED,aAAO;AACLqD,yBAAiBP,UADZ;AAELM,mBAAWA,SAFN;AAGLO,mBAAWA,SAHN;AAILI,2BAAmBA,iBAJd;AAKLC,2BAAmBA;AALd,OAAP;;AAQA,eAASM,WAAT,CAAqBpuH,EAArB,EAAyB;AACvB,YAAIguH,WAAWhuH,GAAGga,eAAH,GAAqBpoB,KAArB,EAAf;AACAo8H,iBAASJ,EAAT,KAAgB5tH,GAAG0D,QAAH,CAAY6oH,SAAZ,CAAhB;AACA,eAAOyB,QAAP;AACD;AACF;AA5T0C,GAAlB,CAA3B;;AA+TA;;;;;;;;;;;;;;;;;;AAkBA;;;;;;;AAOA1jC,iBAAe,cAAf,EAA+B,cAA/B,EAA+C,UAAU9nD,OAAV,EAAmBU,OAAnB,EAA4B;AACzE,QAAImnF,kBAAkB7nF,QAAQ6nF,eAA9B;AACAA,uBAAmB,IAAnB,IAA2BnnF,QAAQ24B,aAAR,CAAsB;AAC/Ct4B,gBAAU,QADqC;AAE/CmC,eAAS,QAFsC;AAG/C21B,aAAO74B;AAHwC,KAAtB,EAIxB,UAAUslF,WAAV,EAAuB;AACxBA,kBAAYsC,kBAAZ,CAA+BC,eAA/B;AACD,KAN0B,CAA3B;AAOD,GATD;;AAWA;;;;;;;;;;;;;;;;;;;AAmBA;;;;AAIA;;;;;;;;;;;;;;;;;;AAkBA;;;;;;AAMA,MAAIkE,sBAAsB,SAAtBA,mBAAsB,CAAUprF,MAAV,EAAkBD,OAAlB,EAA2B;AACnD,QAAI8V,QAAQ,EAAZ;AACA,QAAIqjB,cAAcl5B,OAAOk5B,WAAzB;AACA,QAAIpJ,WAAJ;;AAEA,QAAIoJ,eAAe,IAAf,IAAuB,EAAEpJ,cAAc/vB,QAAQk5B,gBAAR,CAAyBC,WAAzB,CAAhB,CAA3B,EAAmF;AACjF,aAAO;AACLrjB,eAAO;AADF,OAAP;AAGD;;AAED,QAAI3kD,OAAO4+D,YAAY2S,OAAZ,EAAX;AACA,QAAIljC,YAAYH,eAAeluC,IAAf,EAAqB8uC,MAArB,CAAhB;;AAEA,QAAIT,aAAa,IAAb,IAAqBA,YAAY,CAAjC,IAAsCzvC,QAAQyvC,SAAR,CAA1C,EAA8D;AAC5D,aAAO;AACLsW,eAAO;AADF,OAAP;AAGD;;AAED,QAAIh5C,KAAK3L,KAAKm/E,gBAAL,CAAsB9wC,SAAtB,CAAT;AACA,QAAI27B,WAAWpL,YAAYqb,gBAA3B;;AAEA,QAAIrb,YAAY4d,kBAAhB,EAAoC;AAClC73B,cAAQia,YAAY4d,kBAAZ,CAA+BnuC,SAA/B,KAA6C,EAArD;AACD,KAFD,MAEO,IAAI27B,YAAYA,SAASilC,WAAzB,EAAsC;AAC3CtqD,cAAQqlB,SAASilC,WAAT,CAAqBjvG,KAAKogG,SAAL,CAAerjG,IAAIitE,SAAS7J,UAAb,EAAyB,UAAU0C,GAAV,EAAe;AAClF,eAAO7iE,KAAK+7E,YAAL,CAAkBlZ,GAAlB,CAAP;AACD,OAF2C,CAAf,EAEzBx0B,SAFyB,EAEd,IAFc,CAArB,KAEiB,EAFzB;AAGD,KAJM,MAIA,IAAI1iC,EAAJ,EAAQ;AACb;AACA,UAAI2Y,OAAO3Y,GAAGga,eAAH,GAAqBpoB,KAArB,EAAX;AACA+mB,WAAKze,cAAL,CAAoB8F,GAAG8D,SAAvB;AACAk1C,cAAQ,CAACrgC,KAAKtgB,CAAL,GAASsgB,KAAKpB,KAAL,GAAa,CAAvB,EAA0BoB,KAAKrgB,CAAL,GAASqgB,KAAKnB,MAAL,GAAc,CAAjD,CAAR;AACD;;AAED,WAAO;AACLwhC,aAAOA,KADF;AAELh5C,UAAIA;AAFC,KAAP;AAID,GAxCD;;AA0CA;;;;;;;;;;;;;;;;;;AAkBA,MAAIwuH,SAASl6H,MAAb;AACA,MAAIm6H,UAAUt5H,KAAd;AACA,MAAIu5H,UAAU7rF,WAAd;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4BA,MAAI8rF,cAAc,SAAdA,WAAc,CAAUnsF,OAAV,EAAmBU,OAAnB,EAA4Bg7B,GAA5B,EAAiC;AACjD,QAAI0wD,cAAcpsF,QAAQosF,WAA1B;AACA,QAAI51E,QAAQ,CAACxW,QAAQnqC,CAAT,EAAYmqC,QAAQlqC,CAApB,CAAZ;AACA,QAAI6qC,SAASX,OAAb;AACA,QAAI2jD,iBAAiB3jD,QAAQ2jD,cAAR,IAA0BtxF,KAAKqpE,IAAIioB,cAAT,EAAyBjoB,GAAzB,CAA/C;AACA,QAAImiD,mBAAmBn9E,QAAQqxB,YAAR,CAAqB,aAArB,EAAoC8rD,gBAA3D,CALiD,CAK4B;AAC7E;;AAEA,QAAI,CAACA,gBAAL,EAAuB;AACrB;AACD;;AAED,QAAIwO,aAAa71E,KAAb,CAAJ,EAAyB;AACvB;AACA;AACAA,cAAQu1E,oBAAoB;AAC1BlyD,qBAAal5B,OAAOk5B,WADM;AAE1B;AACA;AACA35B,mBAAWS,OAAOT;AAJQ,OAApB,EAKLQ,OALK,EAKI8V,KALZ;AAMD;;AAED,QAAI81E,iBAAiBD,aAAa71E,KAAb,CAArB,CAvBiD,CAuBP;AAC1C;AACA;AACA;;AAEA,QAAI+1E,gBAAgB5rF,OAAOg9E,QAA3B;AACA,QAAIA,WAAWE,iBAAiBF,QAAhC;AACA,QAAI6O,aAAaJ,gBAAgB,OAAhB,IAA2BC,aAAa71E,KAAb,CAA5C;AACA,QAAIi2E,eAAe,EAAnB;AACA,QAAIC,eAAe,EAAnB;AACA,QAAIC,iBAAiB;AACnB3uH,YAAM,EADa;AAEnBpP,WAAK;AAFc,KAArB;AAIA,QAAIg+H,WAAW;AACbC,mBAAaZ,QAAQY,WAAR,EAAqBH,YAArB,CADA;AAEbI,mBAAab,QAAQa,WAAR,EAAqBH,cAArB;AAFA,KAAf,CArCiD,CAwC9C;;AAEHX,WAAOnO,iBAAiBC,WAAxB,EAAqC,UAAUjiD,QAAV,EAAoBwiD,WAApB,EAAiC;AACpE;AACA,UAAI0O,wBAAwBT,kBAAkBzwD,SAASomB,YAAT,CAAsBzrC,KAAtB,CAA9C;AACAw1E,aAAOnO,iBAAiBA,gBAAjB,CAAkCQ,WAAlC,CAAP,EAAuD,UAAUiB,QAAV,EAAoBrvH,GAApB,EAAyB;AAC9E,YAAI2tG,OAAO0hB,SAAS1hB,IAApB;AACA,YAAIovB,gBAAgBC,kBAAkBV,aAAlB,EAAiCjN,QAAjC,CAApB,CAF8E,CAEd;;AAEhE,YAAI,CAACkN,UAAD,IAAeO,qBAAf,KAAyC,CAACR,aAAD,IAAkBS,aAA3D,CAAJ,EAA+E;AAC7E,cAAIp5H,MAAMo5H,iBAAiBA,cAAc77H,KAAzC;;AAEA,cAAIyC,OAAO,IAAP,IAAe,CAAC04H,cAApB,EAAoC;AAClC14H,kBAAMgqG,KAAK6Q,WAAL,CAAiBj4D,KAAjB,CAAN;AACD;;AAED5iD,iBAAO,IAAP,IAAes5H,cAAc5N,QAAd,EAAwB1rH,GAAxB,EAA6Bg5H,QAA7B,EAAuC,KAAvC,EAA8CH,YAA9C,CAAf;AACD;AACF,OAbD;AAcD,KAjBD,EA1CiD,CA2D7C;;AAEJ,QAAIU,eAAe,EAAnB;AACAnB,WAAOrO,QAAP,EAAiB,UAAUyP,WAAV,EAAuBC,MAAvB,EAA+B;AAC9C,UAAI3N,YAAY0N,YAAY1N,SAA5B,CAD8C,CACP;;AAEvC,UAAIA,aAAa,CAACgN,aAAaW,MAAb,CAAlB,EAAwC;AACtCrB,eAAOtM,UAAU/B,QAAjB,EAA2B,UAAU2P,WAAV,EAAuBC,MAAvB,EAA+B;AACxD,cAAIC,aAAad,aAAaa,MAAb,CAAjB,CADwD,CACjB;;AAEvC,cAAID,gBAAgBF,WAAhB,IAA+BI,UAAnC,EAA+C;AAC7C,gBAAI55H,MAAM45H,WAAWr8H,KAArB;AACAuuH,sBAAUC,MAAV,KAAqB/rH,MAAMw5H,YAAYxvB,IAAZ,CAAiB7mG,KAAjB,CAAuB0S,KAAvB,CAA6Bi2G,UAAUC,MAAV,CAAiB/rH,GAAjB,EAAsB65H,gBAAgBH,WAAhB,CAAtB,EAAoDG,gBAAgBL,WAAhB,CAApD,CAA7B,CAA3B;AACAD,yBAAaC,YAAYn9H,GAAzB,IAAgC2D,GAAhC;AACD;AACF,SARD;AASD;AACF,KAdD;AAeAo4H,WAAOmB,YAAP,EAAqB,UAAUv5H,GAAV,EAAey5H,MAAf,EAAuB;AAC1CH,oBAAcvP,SAAS0P,MAAT,CAAd,EAAgCz5H,GAAhC,EAAqCg5H,QAArC,EAA+C,IAA/C,EAAqDH,YAArD;AACD,KAFD;AAGAiB,wBAAoBhB,YAApB,EAAkC/O,QAAlC,EAA4C8O,YAA5C;AACAkB,4BAAwBhB,cAAxB,EAAwCn2E,KAAxC,EAA+CxW,OAA/C,EAAwD2jD,cAAxD;AACAiqC,6BAAyBjQ,QAAzB,EAAmCh6B,cAAnC,EAAmDjoB,GAAnD;AACA,WAAO+wD,YAAP;AACD,GApFD;;AAsFA,WAASS,aAAT,CAAuB5N,QAAvB,EAAiCuO,QAAjC,EAA2CjB,QAA3C,EAAqDkB,QAArD,EAA+DrB,YAA/D,EAA6E;AAC3E,QAAI7uB,OAAO0hB,SAAS1hB,IAApB;;AAEA,QAAIA,KAAK7mG,KAAL,CAAW0jG,OAAX,MAAwB,CAACmD,KAAK0Q,WAAL,CAAiBuf,QAAjB,CAA7B,EAAyD;AACvD;AACD;;AAED,QAAI,CAACvO,SAASD,aAAd,EAA6B;AAC3BuN,eAASC,WAAT,CAAqBvN,QAArB,EAA+BuO,QAA/B;AACA;AACD,KAV0E,CAUzE;;;AAGF,QAAIE,cAAcC,sBAAsBH,QAAtB,EAAgCvO,QAAhC,CAAlB;AACA,QAAI2O,eAAeF,YAAYE,YAA/B;AACA,QAAIC,cAAcH,YAAYG,WAA9B,CAf2E,CAehC;AAC3C;;AAEA,QAAID,aAAa,CAAb,KAAmBxB,aAAa5yD,WAAb,IAA4B,IAAnD,EAAyD;AACvDhpE,aAAO47H,YAAP,EAAqBwB,aAAa,CAAb,CAArB;AACD,KApB0E,CAoBzE;AACF;;;AAGA,QAAI,CAACH,QAAD,IAAaxO,SAASF,IAA1B,EAAgC;AAC9B,UAAIxhB,KAAK0Q,WAAL,CAAiB4f,WAAjB,KAAiCA,eAAe,IAApD,EAA0D;AACxDL,mBAAWK,WAAX;AACD;AACF;;AAEDtB,aAASC,WAAT,CAAqBvN,QAArB,EAA+BuO,QAA/B,EAAyCI,YAAzC,EAAuDxB,YAAvD,EA9B2E,CA8BL;AACtE;;AAEAG,aAASE,WAAT,CAAqBxN,QAArB,EAA+ByO,WAA/B,EAA4CG,WAA5C;AACD;;AAED,WAASF,qBAAT,CAA+B78H,KAA/B,EAAsCmuH,QAAtC,EAAgD;AAC9C,QAAI1hB,OAAO0hB,SAAS1hB,IAApB;AACA,QAAIlpC,MAAMkpC,KAAKlpC,GAAf;AACA,QAAIw5D,cAAc/8H,KAAlB;AACA,QAAI88H,eAAe,EAAnB;AACA,QAAI/6B,UAAUnlD,OAAOC,SAArB;AACA,QAAImlD,UAAU,CAAC,CAAf;AACA64B,WAAO1M,SAASnkD,YAAhB,EAA8B,UAAUzB,MAAV,EAAkB/iD,GAAlB,EAAuB;AACnD,UAAI8+C,UAAUiE,OAAO0J,OAAP,GAAiBwK,YAAjB,CAA8BlZ,GAA9B,EAAmC,IAAnC,CAAd;AACA,UAAIy5D,kBAAJ;AACA,UAAIC,WAAJ;;AAEA,UAAI10D,OAAO0U,kBAAX,EAA+B;AAC7B,YAAI9+E,SAASoqE,OAAO0U,kBAAP,CAA0B3Y,OAA1B,EAAmCtkE,KAAnC,EAA0CysG,IAA1C,CAAb;AACAwwB,sBAAc9+H,OAAO8+H,WAArB;AACAD,6BAAqB7+H,OAAO++H,YAA5B;AACD,OAJD,MAIO;AACLD,sBAAc10D,OAAO0J,OAAP,GAAiB2vB,gBAAjB,CAAkCt9B,QAAQ,CAAR,CAAlC,EAA8CtkE,KAA9C,EAAqD;AACnE;AACA;AACAysG,aAAK9qG,IAAL,KAAc,UAAd,GAA2B,GAA3B,GAAiC,IAHnB,CAAd;;AAKA,YAAI,CAACs7H,YAAYx+H,MAAjB,EAAyB;AACvB;AACD;;AAEDu+H,6BAAqBz0D,OAAO0J,OAAP,GAAiBxuE,GAAjB,CAAqB6gE,QAAQ,CAAR,CAArB,EAAiC24D,YAAY,CAAZ,CAAjC,CAArB;AACD;;AAED,UAAID,sBAAsB,IAAtB,IAA8B,CAACj0F,SAASi0F,kBAAT,CAAnC,EAAiE;AAC/D;AACD;;AAED,UAAInkF,OAAO74C,QAAQg9H,kBAAnB;AACA,UAAI/2H,OAAOZ,KAAKyzC,GAAL,CAASD,IAAT,CAAX,CA3BmD,CA2BxB;;AAE3B,UAAI5yC,QAAQ87F,OAAZ,EAAqB;AACnB,YAAI97F,OAAO87F,OAAP,IAAkBlpD,QAAQ,CAAR,IAAampD,UAAU,CAA7C,EAAgD;AAC9CD,oBAAU97F,IAAV;AACA+7F,oBAAUnpD,IAAV;AACAkkF,wBAAcC,kBAAd;AACAF,uBAAar+H,MAAb,GAAsB,CAAtB;AACD;;AAEDo8H,eAAOoC,WAAP,EAAoB,UAAUluF,SAAV,EAAqB;AACvC+tF,uBAAa/7H,IAAb,CAAkB;AAChB2nE,yBAAaH,OAAOG,WADJ;AAEhB55B,6BAAiBC,SAFD;AAGhBA,uBAAWw5B,OAAO0J,OAAP,GAAiBkB,WAAjB,CAA6BpkC,SAA7B;AAHK,WAAlB;AAKD,SAND;AAOD;AACF,KA7CD;AA8CA,WAAO;AACL+tF,oBAAcA,YADT;AAELC,mBAAaA;AAFR,KAAP;AAID;;AAED,WAASrB,WAAT,CAAqBH,YAArB,EAAmCpN,QAAnC,EAA6CnuH,KAA7C,EAAoD88H,YAApD,EAAkE;AAChEvB,iBAAapN,SAASrvH,GAAtB,IAA6B;AAC3BkB,aAAOA,KADoB;AAE3B88H,oBAAcA;AAFa,KAA7B;AAID;;AAED,WAASnB,WAAT,CAAqBH,cAArB,EAAqCrN,QAArC,EAA+CyO,WAA/C,EAA4D58H,KAA5D,EAAmE;AACjE,QAAI88H,eAAeF,YAAYE,YAA/B;AACA,QAAIrwB,OAAO0hB,SAAS1hB,IAApB;AACA,QAAIzrC,YAAYyrC,KAAK75D,KAArB;AACA,QAAIi7E,mBAAmBM,SAASN,gBAAhC,CAJiE,CAIf;AAClD;;AAEA,QAAI,CAACM,SAASP,cAAV,IAA4B,CAACkP,aAAar+H,MAA9C,EAAsD;AACpD;AACD;;AAED,QAAI4uH,gBAAgBc,SAASzjD,QAAT,CAAkB93B,KAAtC;AACA,QAAIs6E,cAAcC,QAAQE,aAAR,CAAlB;AACA,QAAI8P,eAAe3B,eAAe/9H,GAAf,CAAmByvH,WAAnB,CAAnB;;AAEA,QAAI,CAACiQ,YAAL,EAAmB;AACjBA,qBAAe3B,eAAe/9H,GAAf,CAAmByvH,WAAnB,IAAkC;AAC/CkQ,oBAAY/P,cAAcvrG,EADqB;AAE/Cu7G,uBAAehQ,cAAc9wD,cAFkB;AAG/C+gE,sBAAcjQ,cAAc1rH,IAHmB;AAI/C47H,0BAAkBlQ,cAAcz9E,QAJe;AAK/C4tF,oBAAY;AALmC,OAAjD;AAOAhC,qBAAe3uH,IAAf,CAAoB9L,IAApB,CAAyBo8H,YAAzB;AACD;;AAEDA,iBAAaK,UAAb,CAAwBz8H,IAAxB,CAA6B;AAC3BkgE,eAASwrC,KAAKlpC,GADa;AAE3BxC,iBAAWC,UAAUzE,cAFM;AAG3B0+B,gBAAUj6B,UAAUr/D,IAHO;AAI3B87H,cAAQz8D,UAAUl/C,EAJS;AAK3B9hB,aAAOA,KALoB;AAM3B;AACA;AACA;AACA;AACA09H,qBAAe;AACb/oE,mBAAWk5D,iBAAiBpqH,GAAjB,CAAqB,iBAArB,CADE;AAEbuzE,mBAAW62C,iBAAiBpqH,GAAjB,CAAqB,iBAArB;AAFE,OAVY;AAc3Bk6H,yBAAmBb,aAAav/H,KAAb;AAdQ,KAA7B;AAgBD;;AAED,WAASg/H,mBAAT,CAA6BhB,YAA7B,EAA2C/O,QAA3C,EAAqD8O,YAArD,EAAmE;AACjE,QAAIsC,iBAAiBtC,aAAa9O,QAAb,GAAwB,EAA7C,CADiE,CAChB;;AAEjDqO,WAAOrO,QAAP,EAAiB,UAAU2B,QAAV,EAAoBrvH,GAApB,EAAyB;AACxC,UAAImvC,SAASkgF,SAASN,gBAAT,CAA0B5/E,MAAvC;AACA,UAAI4vF,UAAUtC,aAAaz8H,GAAb,CAAd;;AAEA,UAAI++H,OAAJ,EAAa;AACX,SAAC1P,SAASC,SAAV,KAAwBngF,OAAO2oC,MAAP,GAAgB,MAAxC;AACA3oC,eAAOjuC,KAAP,GAAe69H,QAAQ79H,KAAvB,CAFW,CAEmB;;AAE9BiuC,eAAO0vF,iBAAP,GAA2B,CAACE,QAAQf,YAAR,IAAwB,EAAzB,EAA6Bv/H,KAA7B,EAA3B;AACD,OALD,CAKE;AACF;AANA,WAOK;AACD;AACA;AACA,WAAC4wH,SAASC,SAAV,KAAwBngF,OAAO2oC,MAAP,GAAgB,MAAxC;AACD,SAfqC,CAepC;;;AAGJ3oC,aAAO2oC,MAAP,KAAkB,MAAlB,IAA4BgnD,eAAe78H,IAAf,CAAoB;AAC9CkgE,iBAASktD,SAAS1hB,IAAT,CAAclpC,GADuB;AAE9CxC,mBAAWotD,SAAS1hB,IAAT,CAAc75D,KAAd,CAAoB2pB,cAFe;AAG9Cv8D,eAAOiuC,OAAOjuC;AAHgC,OAApB,CAA5B;AAKD,KAvBD;AAwBD;;AAED,WAASw8H,uBAAT,CAAiChB,cAAjC,EAAiDn2E,KAAjD,EAAwDxW,OAAxD,EAAiE2jD,cAAjE,EAAiF;AAC/E;AACA,QAAI0oC,aAAa71E,KAAb,KAAuB,CAACm2E,eAAe3uH,IAAf,CAAoBpO,MAAhD,EAAwD;AACtD+zF,qBAAe;AACb7wF,cAAM;AADO,OAAf;AAGA;AACD,KAP8E,CAO7E;AACF;AACA;AACA;;;AAGA,QAAI+mG,aAAa,CAAC,CAAC8yB,eAAe3uH,IAAf,CAAoB,CAApB,EAAuB2wH,UAAvB,CAAkC,CAAlC,KAAwC,EAAzC,EAA6CG,iBAA7C,IAAkE,EAAnE,EAAuE,CAAvE,KAA6E,EAA9F;AACAnrC,mBAAe;AACb7wF,YAAM,SADO;AAEbixF,qBAAe,IAFF;AAGbluF,SAAG2gD,MAAM,CAAN,CAHU;AAIb1gD,SAAG0gD,MAAM,CAAN,CAJU;AAKby4E,qBAAejvF,QAAQivF,aALV;AAMb/tH,gBAAU8+B,QAAQ9+B,QANL;AAOb++B,uBAAiB45D,WAAW55D,eAPf;AAQbC,iBAAW25D,WAAW35D,SART;AASb25B,mBAAaggC,WAAWhgC,WATX;AAUb8yD,sBAAgBA,eAAe3uH;AAVlB,KAAf;AAYD;;AAED,WAAS4vH,wBAAT,CAAkCjQ,QAAlC,EAA4Ch6B,cAA5C,EAA4DjoB,GAA5D,EAAiE;AAC/D;AACA;AACA;AACA,QAAI3oD,KAAK2oD,IAAI6kB,KAAJ,EAAT;AACA,QAAI2uC,cAAc,2BAAlB;AACA,QAAIC,iBAAiBjD,QAAQn5G,EAAR,EAAYm8G,WAAZ,KAA4B,EAAjD;AACA,QAAIE,gBAAgBlD,QAAQn5G,EAAR,EAAYm8G,WAAZ,IAA2B,EAA/C,CAP+D,CAOZ;AACnD;;AAEAlD,WAAOrO,QAAP,EAAiB,UAAU2B,QAAV,EAAoBrvH,GAApB,EAAyB;AACxC,UAAImvC,SAASkgF,SAASN,gBAAT,CAA0B5/E,MAAvC;AACAA,aAAO2oC,MAAP,KAAkB,MAAlB,IAA4BikD,OAAO5sF,OAAO0vF,iBAAd,EAAiC,UAAUtqC,SAAV,EAAqB;AAChF,YAAIv0F,MAAMu0F,UAAU3qB,WAAV,GAAwB,KAAxB,GAAgC2qB,UAAUtkD,SAApD;AACAkvF,sBAAcn/H,GAAd,IAAqBu0F,SAArB;AACD,OAH2B,CAA5B;AAID,KAND,EAV+D,CAgB3D;;AAEJ,QAAI6qC,cAAc,EAAlB;AACA,QAAIC,aAAa,EAAjB;AACAx9H,WAAOq9H,cAAP,EAAuB,UAAU3qC,SAAV,EAAqBv0F,GAArB,EAA0B;AAC/C,OAACm/H,cAAcn/H,GAAd,CAAD,IAAuBq/H,WAAWp9H,IAAX,CAAgBsyF,SAAhB,CAAvB;AACD,KAFD;AAGA1yF,WAAOs9H,aAAP,EAAsB,UAAU5qC,SAAV,EAAqBv0F,GAArB,EAA0B;AAC9C,OAACk/H,eAAel/H,GAAf,CAAD,IAAwBo/H,YAAYn9H,IAAZ,CAAiBsyF,SAAjB,CAAxB;AACD,KAFD;AAGA8qC,eAAW1/H,MAAX,IAAqB8rE,IAAIioB,cAAJ,CAAmB;AACtC7wF,YAAM,UADgC;AAEtCixF,qBAAe,IAFuB;AAGtCM,aAAOirC;AAH+B,KAAnB,CAArB;AAKAD,gBAAYz/H,MAAZ,IAAsB8rE,IAAIioB,cAAJ,CAAmB;AACvC7wF,YAAM,WADiC;AAEvCixF,qBAAe,IAFwB;AAGvCM,aAAOgrC;AAHgC,KAAnB,CAAtB;AAKD;;AAED,WAASpC,iBAAT,CAA2BV,aAA3B,EAA0CjN,QAA1C,EAAoD;AAClD,SAAK,IAAI5vH,IAAI,CAAb,EAAgBA,IAAI,CAAC68H,iBAAiB,EAAlB,EAAsB38H,MAA1C,EAAkDF,GAAlD,EAAuD;AACrD,UAAIs9H,gBAAgBT,cAAc78H,CAAd,CAApB;;AAEA,UAAI4vH,SAAS1hB,IAAT,CAAclpC,GAAd,KAAsBs4D,cAAc56D,OAApC,IAA+CktD,SAAS1hB,IAAT,CAAc75D,KAAd,CAAoB2pB,cAApB,KAAuCs/D,cAAc96D,SAAxG,EAAmH;AACjH,eAAO86D,aAAP;AACD;AACF;AACF;;AAED,WAASS,eAAT,CAAyBnO,QAAzB,EAAmC;AACjC,QAAIntD,YAAYmtD,SAAS1hB,IAAT,CAAc75D,KAA9B;AACA,QAAItE,OAAO,EAAX;AACA,QAAIi1B,MAAMj1B,KAAK2yB,OAAL,GAAektD,SAAS1hB,IAAT,CAAclpC,GAAvC;AACAj1B,SAAKyyB,SAAL,GAAiBzyB,KAAKi1B,MAAM,WAAX,IAA0BvC,UAAUzE,cAArD;AACAjuB,SAAK6hC,QAAL,GAAgB7hC,KAAKi1B,MAAM,UAAX,IAAyBvC,UAAUljE,IAAnD;AACAwwC,SAAKmvF,MAAL,GAAcnvF,KAAKi1B,MAAM,QAAX,IAAuBvC,UAAUl/C,EAA/C;AACA,WAAOwsB,IAAP;AACD;;AAED,WAAS4sF,YAAT,CAAsB71E,KAAtB,EAA6B;AAC3B,WAAO,CAACA,KAAD,IAAUA,MAAM,CAAN,KAAY,IAAtB,IAA8B3oC,MAAM2oC,MAAM,CAAN,CAAN,CAA9B,IAAiDA,MAAM,CAAN,KAAY,IAA7D,IAAqE3oC,MAAM2oC,MAAM,CAAN,CAAN,CAA5E;AACD;;AAED;;;;;;;;;;;;;;;;;;AAkBA,MAAI+4E,mBAAmB1mC,qBAAqB;AAC1C/1F,UAAM,aADoC;AAE1C+qH,sBAAkB,IAFwB;AAG1ClwD,mBAAe;AACb;AACAv5C,YAAM,MAFO;AAGb;AACAo7G,iBAAW,IAJE;AAKb;AACAt0G,cAAQ,CANK;AAObC,SAAG,EAPU;AAQbroB,YAAM,MARO;AASb;AACA;AACAssH,YAAM,KAXO;AAYbL,sBAAgB,IAZH;AAab5tH,aAAO,IAbM;AAcb42E,cAAQ,IAdK;AAeb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA07C,YAAM,EA3BO;AA4Bb;AACA;AACA7xG,iBAAW,IA9BE;AA+Bby9C,+BAAyB,GA/BZ;AAgCb0sB,iBAAW;AACTzwE,eAAO,MADE;AAETyJ,eAAO,CAFE;AAGTjiB,cAAM;AAHG,OAhCE;AAqCb28H,mBAAa;AACXnkH,eAAO;AADI,OArCA;AAwCbqhE,aAAO;AACLv4D,cAAM,IADD;AAEL+zD,mBAAW,IAFN;AAGL;AACAriB,mBAAW,MAJN;AAKL;AACAkG,gBAAQ,CANH;AAOL1gD,eAAO,MAPF;AAQLoc,iBAAS,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,CARJ;AASLiN,yBAAiB,MATZ;AAUL;AACA6nD,qBAAa,IAXR;AAYLo2B,qBAAa,CAZR;AAaLp1F,oBAAY,CAbP;AAcLu3B,qBAAa,MAdR,CAce;AACpB;AACA;AACA;;AAjBK,OAxCM;AA4Db26E,cAAQ;AACNt7G,cAAM,KADA;AAENu1G,cAAM,0MAFA;AAGN;AACAxpB,cAAM,EAJA;AAKN;AACAn0C,gBAAQ,EANF;AAON;AACA;AACA1gD,eAAO,MATD;AAUNkS,oBAAY,CAVN;AAWNu3B,qBAAa,MAXP;AAYNt3B,uBAAe,CAZT;AAaNC,uBAAe,CAbT;AAcN;AACA8zD,kBAAU;AAfJ;AA5DK;AAH2B,GAArB,CAAvB;;AAmFA;;;;;;;;;;;;;;;;;;AAkBA,MAAIm+C,UAAUtvF,WAAd;AACA,MAAIuvF,SAAS99H,MAAb;AACA;;;;;;;;AAQA,WAASiqE,QAAT,CAAkB9rE,GAAlB,EAAuByrE,GAAvB,EAA4B9hE,OAA5B,EAAqC;AACnC,QAAI7M,MAAMX,IAAV,EAAgB;AACd;AACD;;AAED,QAAI2mB,KAAK2oD,IAAI6kB,KAAJ,EAAT;AACAovC,YAAQ58G,EAAR,EAAY88G,OAAZ,KAAwBF,QAAQ58G,EAAR,EAAY88G,OAAZ,GAAsB,EAA9C;AACAC,wBAAoB/8G,EAApB,EAAwB2oD,GAAxB;AACA,QAAI+c,SAASk3C,QAAQ58G,EAAR,EAAY88G,OAAZ,CAAoB5/H,GAApB,MAA6B0/H,QAAQ58G,EAAR,EAAY88G,OAAZ,CAAoB5/H,GAApB,IAA2B,EAAxD,CAAb;AACAwoF,WAAO7+E,OAAP,GAAiBA,OAAjB;AACD;;AAED,WAASk2H,mBAAT,CAA6B/8G,EAA7B,EAAiC2oD,GAAjC,EAAsC;AACpC,QAAIi0D,QAAQ58G,EAAR,EAAYg9G,WAAhB,EAA6B;AAC3B;AACD;;AAEDJ,YAAQ58G,EAAR,EAAYg9G,WAAZ,GAA0B,IAA1B;AACAC,eAAW,OAAX,EAAoBr9H,MAAMs9H,OAAN,EAAe,OAAf,CAApB;AACAD,eAAW,WAAX,EAAwBr9H,MAAMs9H,OAAN,EAAe,WAAf,CAAxB,EAPoC,CAOkB;;AAEtDD,eAAW,WAAX,EAAwBE,OAAxB;;AAEA,aAASF,UAAT,CAAoBxpH,SAApB,EAA+BxU,EAA/B,EAAmC;AACjC+gB,SAAG/a,EAAH,CAAMwO,SAAN,EAAiB,UAAUpO,CAAV,EAAa;AAC5B,YAAI+3H,MAAMC,mBAAmB10D,GAAnB,CAAV;AACAk0D,eAAOD,QAAQ58G,EAAR,EAAY88G,OAAnB,EAA4B,UAAUp3C,MAAV,EAAkB;AAC5CA,oBAAUzmF,GAAGymF,MAAH,EAAWrgF,CAAX,EAAc+3H,IAAIxsC,cAAlB,CAAV;AACD,SAFD;AAGA0sC,+BAAuBF,IAAIG,QAA3B,EAAqC50D,GAArC;AACD,OAND;AAOD;AACF;;AAED,WAAS20D,sBAAT,CAAgCC,QAAhC,EAA0C50D,GAA1C,EAA+C;AAC7C,QAAI60D,UAAUD,SAASE,OAAT,CAAiB5gI,MAA/B;AACA,QAAI6gI,UAAUH,SAASI,OAAT,CAAiB9gI,MAA/B;AACA,QAAI+gI,eAAJ;;AAEA,QAAIJ,OAAJ,EAAa;AACXI,wBAAkBL,SAASE,OAAT,CAAiBD,UAAU,CAA3B,CAAlB;AACD,KAFD,MAEO,IAAIE,OAAJ,EAAa;AAClBE,wBAAkBL,SAASI,OAAT,CAAiBD,UAAU,CAA3B,CAAlB;AACD;;AAED,QAAIE,eAAJ,EAAqB;AACnBA,sBAAgBhtC,cAAhB,GAAiC,IAAjC;AACAjoB,UAAIioB,cAAJ,CAAmBgtC,eAAnB;AACD;AACF;;AAED,WAAST,OAAT,CAAiBz3C,MAAjB,EAAyBrgF,CAAzB,EAA4BurF,cAA5B,EAA4C;AAC1ClL,WAAO7+E,OAAP,CAAe,OAAf,EAAwB,IAAxB,EAA8B+pF,cAA9B;AACD;;AAED,WAASssC,OAAT,CAAiB7D,WAAjB,EAA8B3zC,MAA9B,EAAsCrgF,CAAtC,EAAyCurF,cAAzC,EAAyD;AACvDlL,WAAO7+E,OAAP,CAAewyH,WAAf,EAA4Bh0H,CAA5B,EAA+BurF,cAA/B;AACD;;AAED,WAASysC,kBAAT,CAA4B10D,GAA5B,EAAiC;AAC/B,QAAI40D,WAAW;AACbE,eAAS,EADI;AAEbE,eAAS;AAFI,KAAf,CAD+B,CAI5B;AACH;AACA;AACA;AACA;;AAEA,QAAI/sC,iBAAiB,SAAjBA,cAAiB,CAAU3jD,OAAV,EAAmB;AACtC,UAAI3X,cAAcioG,SAAStwF,QAAQltC,IAAjB,CAAlB;;AAEA,UAAIu1B,WAAJ,EAAiB;AACfA,oBAAYn2B,IAAZ,CAAiB8tC,OAAjB;AACD,OAFD,MAEO;AACLA,gBAAQ2jD,cAAR,GAAyBA,cAAzB;AACAjoB,YAAIioB,cAAJ,CAAmB3jD,OAAnB;AACD;AACF,KATD;;AAWA,WAAO;AACL2jD,sBAAgBA,cADX;AAEL2sC,gBAAUA;AAFL,KAAP;AAID;AACD;;;;;AAMA,WAASM,UAAT,CAAoB3gI,GAApB,EAAyByrE,GAAzB,EAA8B;AAC5B,QAAI3uE,MAAMX,IAAV,EAAgB;AACd;AACD;;AAED,QAAI2mB,KAAK2oD,IAAI6kB,KAAJ,EAAT;AACA,QAAI9H,SAAS,CAACk3C,QAAQ58G,EAAR,EAAY88G,OAAZ,IAAuB,EAAxB,EAA4B5/H,GAA5B,CAAb;;AAEA,QAAIwoF,MAAJ,EAAY;AACVk3C,cAAQ58G,EAAR,EAAY88G,OAAZ,CAAoB5/H,GAApB,IAA2B,IAA3B;AACD;AACF;;AAED;;;;;;;;;;;;;;;;;;AAkBA,MAAI4gI,kBAAkB/nC,oBAAoB;AACxCh2F,UAAM,aADkC;AAExCw8E,YAAQ,gBAAU4uC,sBAAV,EAAkCx9E,OAAlC,EAA2Cg7B,GAA3C,EAAgD;AACtD,UAAIuiD,qBAAqBv9E,QAAQqxB,YAAR,CAAqB,SAArB,CAAzB;AACA,UAAIy9D,YAAYtR,uBAAuBtpH,GAAvB,CAA2B,WAA3B,KAA2CqpH,sBAAsBA,mBAAmBrpH,GAAnB,CAAuB,WAAvB,CAAjE,IAAwG,iBAAxH,CAFsD,CAEqF;AAC3I;;AAEAmnE,eAAS,aAAT,EAAwBL,GAAxB,EAA6B,UAAU0wD,WAAV,EAAuBh0H,CAAvB,EAA0BurF,cAA1B,EAA0C;AACrE;AACA,YAAI6rC,cAAc,MAAd,KAAyBpD,gBAAgB,OAAhB,IAA2BoD,UAAUv+H,OAAV,CAAkBm7H,WAAlB,KAAkC,CAAtF,CAAJ,EAA8F;AAC5FzoC,yBAAe;AACb7wF,kBAAM,mBADO;AAEbs5H,yBAAaA,WAFA;AAGbv2H,eAAGuC,KAAKA,EAAEM,OAHG;AAIb5C,eAAGsC,KAAKA,EAAEQ;AAJG,WAAf;AAMD;AACF,OAVD;AAWD,KAlBuC;;AAoBxC;;;AAGA2O,YAAQ,gBAAUm5B,OAAV,EAAmBg7B,GAAnB,EAAwB;AAC9Bk1D,iBAAWl1D,IAAI6kB,KAAJ,EAAX,EAAwB,aAAxB;AACAswC,sBAAgB1uF,UAAhB,CAA2B,KAAKi+C,MAAhC,EAAwC,QAAxC,EAAkD5tF,SAAlD;AACD,KA1BuC;;AA4BxC;;;AAGAgJ,aAAS,iBAAUklC,OAAV,EAAmBg7B,GAAnB,EAAwB;AAC/Bk1D,iBAAW,aAAX,EAA0Bl1D,GAA1B;AACAm1D,sBAAgB1uF,UAAhB,CAA2B,KAAKi+C,MAAhC,EAAwC,SAAxC,EAAmD5tF,SAAnD;AACD;AAlCuC,GAApB,CAAtB;;AAqCA;;;;;;;;;;;;;;;;;;AAkBA,MAAIs+H,UAAUzwF,WAAd;AACA,MAAI0wF,UAAU3hI,MAAd;AACA,MAAI4hI,SAAS3+H,IAAb;AACA;;;;;AAKA,WAAS4+H,eAAT,GAA2B,CAAE;;AAE7BA,kBAAgBhjI,SAAhB,GAA4B;AAC1B;;;AAGAijI,YAAQ,IAJkB;;AAM1B;;;AAGAC,qBAAiB,IATS;;AAW1B;;;AAGAC,aAAS,IAdiB;;AAgB1B;;;AAGAC,eAAW,KAnBe;;AAqB1B;;;AAGAC,gBAAY,IAxBc;;AA0B1B;;;AAGAC,iBAAa,IA7Ba;;AA+B1B;;;AAGAC,kBAAc,IAlCY;;AAoC1B;;;;;AAKAjiE,wBAAoB,EAzCM;;AA2C1B;;;AAGA+f,YAAQ,gBAAUnd,SAAV,EAAqB6sD,gBAArB,EAAuCtjD,GAAvC,EAA4CulD,WAA5C,EAAyD;AAC/D,UAAI9vH,QAAQ6tH,iBAAiBpqH,GAAjB,CAAqB,OAArB,CAAZ;AACA,UAAImzE,SAASi3C,iBAAiBpqH,GAAjB,CAAqB,QAArB,CAAb,CAF+D,CAElB;AAC7C;;AAEA,WAAK68H,UAAL,GAAkBt/D,SAAlB;AACA,WAAKu/D,iBAAL,GAAyB1S,gBAAzB;AACA,WAAKxnD,IAAL,GAAYkE,GAAZ,CAP+D,CAO9C;AACjB;AACA;;AAEA,UAAI,CAACulD,WAAD,IAAgB,KAAKqQ,UAAL,KAAoBngI,KAApC,IAA6C,KAAKogI,WAAL,KAAqBxpD,MAAtE,EAA8E;AAC5E;AACD;;AAED,WAAKupD,UAAL,GAAkBngI,KAAlB;AACA,WAAKogI,WAAL,GAAmBxpD,MAAnB;AACA,UAAI/c,QAAQ,KAAKkmE,MAAjB;AACA,UAAIxB,SAAS,KAAK0B,OAAlB;;AAEA,UAAI,CAACrpD,MAAD,IAAWA,WAAW,MAA1B,EAAkC;AAChC;AACA/c,iBAASA,MAAM92C,IAAN,EAAT;AACAw7G,kBAAUA,OAAOx7G,IAAP,EAAV;AACA;AACD;;AAED82C,eAASA,MAAM52C,IAAN,EAAT;AACAs7G,gBAAUA,OAAOt7G,IAAP,EAAV,CA5B+D,CA4BtC;;AAEzB,UAAIu9G,WAAW,EAAf;AACA,WAAKC,YAAL,CAAkBD,QAAlB,EAA4BxgI,KAA5B,EAAmCghE,SAAnC,EAA8C6sD,gBAA9C,EAAgEtjD,GAAhE,EA/B+D,CA+BO;;AAEtE,UAAIm2D,aAAaF,SAASE,UAA1B;;AAEA,UAAIA,eAAe,KAAKV,eAAxB,EAAyC;AACvC,aAAK3pH,KAAL,CAAWk0D,GAAX;AACD;;AAED,WAAKy1D,eAAL,GAAuBU,UAAvB;AACA,UAAIC,gBAAgB,KAAKC,cAAL,GAAsB,KAAKC,kBAAL,CAAwB7/D,SAAxB,EAAmC6sD,gBAAnC,CAA1C;;AAEA,UAAI,CAACh0D,KAAL,EAAY;AACVA,gBAAQ,KAAKkmE,MAAL,GAAc,IAAI76G,KAAJ,EAAtB;AACA,aAAK47G,eAAL,CAAqBjnE,KAArB,EAA4B2mE,QAA5B,EAAsCx/D,SAAtC,EAAiD6sD,gBAAjD;AACA,aAAKkT,aAAL,CAAmBlnE,KAAnB,EAA0B2mE,QAA1B,EAAoCx/D,SAApC,EAA+C6sD,gBAA/C;AACAtjD,YAAI6kB,KAAJ,GAAYpqF,GAAZ,CAAgB60D,KAAhB;AACD,OALD,MAKO;AACL,YAAImnE,gBAAgBx/H,MAAMy/H,aAAN,EAAqBpT,gBAArB,EAAuC8S,aAAvC,CAApB;AACA,aAAKO,eAAL,CAAqBrnE,KAArB,EAA4B2mE,QAA5B,EAAsCQ,aAAtC,EAAqDnT,gBAArD;AACA,aAAKsT,aAAL,CAAmBtnE,KAAnB,EAA0B2mE,QAA1B,EAAoCQ,aAApC,EAAmDnT,gBAAnD;AACD;;AAEDuT,2BAAqBvnE,KAArB,EAA4Bg0D,gBAA5B,EAA8C,IAA9C;;AAEA,WAAKwT,aAAL,CAAmBrhI,KAAnB;AACD,KAtGyB;;AAwG1B;;;AAGAoW,YAAQ,gBAAUm0D,GAAV,EAAe;AACrB,WAAKl0D,KAAL,CAAWk0D,GAAX;AACD,KA7GyB;;AA+G1B;;;AAGAlgE,aAAS,iBAAUkgE,GAAV,EAAe;AACtB,WAAKl0D,KAAL,CAAWk0D,GAAX;AACD,KApHyB;;AAsH1B;;;AAGAs2D,wBAAoB,4BAAU7/D,SAAV,EAAqB6sD,gBAArB,EAAuC;AACzD,UAAIptG,YAAYotG,iBAAiBpqH,GAAjB,CAAqB,WAArB,CAAhB;AACA,UAAIgpG,OAAOzrC,UAAUyrC,IAArB;AACA,UAAI60B,iBAAiB70B,KAAK9qG,IAAL,KAAc,UAAnC;AACA,UAAI4/H,UAAU1T,iBAAiBpqH,GAAjB,CAAqB,MAArB,CAAd,CAJyD,CAIb;;AAE5C,UAAI,CAAC89H,OAAD,IAAY,CAACD,cAAjB,EAAiC;AAC/B,eAAO,KAAP;AACD;;AAED,UAAI7gH,cAAc,MAAd,IAAwBA,aAAa,IAAzC,EAA+C;AAC7C,YAAI29C,qBAAqB,KAAKA,kBAA9B;;AAEA,YAAIkjE,kBAAkB70B,KAAKW,YAAL,KAAsBhvC,kBAA5C,EAAgE;AAC9D,iBAAO,IAAP;AACD,SAL4C,CAK3C;AACF;AACA;;;AAGA,YAAImjE,OAAJ,EAAa;AACX,cAAIvS,kBAAkBM,YAAYtuD,SAAZ,EAAuBguD,eAA7C;AACA,cAAI9hB,aAAaT,KAAKtD,SAAL,EAAjB,CAFW,CAEwB;;AAEnC,iBAAO9jG,KAAKyzC,GAAL,CAASo0D,WAAW,CAAX,IAAgBA,WAAW,CAAX,CAAzB,IAA0C8hB,eAA1C,GAA4D5wD,kBAAnE;AACD;;AAED,eAAO,KAAP;AACD;;AAED,aAAO39C,cAAc,IAArB;AACD,KAxJyB;;AA0J1B;;;;AAIAggH,kBAAc,sBAAUD,QAAV,EAAoBxgI,KAApB,EAA2BghE,SAA3B,EAAsC6sD,gBAAtC,EAAwDtjD,GAAxD,EAA6D,CAAC;AAC3E,KA/JyB;;AAiK1B;;;AAGAu2D,qBAAiB,yBAAUjnE,KAAV,EAAiB2mE,QAAjB,EAA2Bx/D,SAA3B,EAAsC6sD,gBAAtC,EAAwD;AACvE,UAAI2T,gBAAgBhB,SAASiB,OAA7B;;AAEA,UAAID,aAAJ,EAAmB;AACjB,YAAIE,YAAY/B,QAAQ9lE,KAAR,EAAe6nE,SAAf,GAA2B,IAAIrxE,QAAQmxE,cAAc7/H,IAAtB,CAAJ,CAAgCi+H,QAAQY,SAASiB,OAAjB,CAAhC,CAA3C;AACA5nE,cAAM70D,GAAN,CAAU08H,SAAV;AACD;AACF,KA3KyB;;AA6K1B;;;AAGAX,mBAAe,uBAAUlnE,KAAV,EAAiB2mE,QAAjB,EAA2Bx/D,SAA3B,EAAsC6sD,gBAAtC,EAAwD;AACrE,UAAI2S,SAAShlD,KAAb,EAAoB;AAClB,YAAImmD,UAAUhC,QAAQ9lE,KAAR,EAAe8nE,OAAf,GAAyB,IAAI37E,IAAJ,CAAS45E,QAAQY,SAAShlD,KAAjB,CAAT,CAAvC;AACA3hB,cAAM70D,GAAN,CAAU28H,OAAV;AACAC,4BAAoBD,OAApB,EAA6B9T,gBAA7B;AACD;AACF,KAtLyB;;AAwL1B;;;AAGAqT,qBAAiB,yBAAUrnE,KAAV,EAAiB2mE,QAAjB,EAA2BqB,cAA3B,EAA2C;AAC1D,UAAIH,YAAY/B,QAAQ9lE,KAAR,EAAe6nE,SAA/B;;AAEA,UAAIA,SAAJ,EAAe;AACbA,kBAAU1kG,QAAV,CAAmBwjG,SAASiB,OAAT,CAAiBvyG,KAApC;AACA2yG,uBAAeH,SAAf,EAA0B;AACxBlpG,iBAAOgoG,SAASiB,OAAT,CAAiBjpG;AADA,SAA1B;AAGD;AACF,KApMyB;;AAsM1B;;;AAGA2oG,mBAAe,uBAAUtnE,KAAV,EAAiB2mE,QAAjB,EAA2BqB,cAA3B,EAA2ChU,gBAA3C,EAA6D;AAC1E,UAAI8T,UAAUhC,QAAQ9lE,KAAR,EAAe8nE,OAA7B;;AAEA,UAAIA,OAAJ,EAAa;AACXA,gBAAQ3kG,QAAR,CAAiBwjG,SAAShlD,KAAT,CAAetsD,KAAhC;AACA2yG,uBAAeF,OAAf,EAAwB;AACtB;AACA;AACAnpG,iBAAOgoG,SAAShlD,KAAT,CAAehjD,KAHA;AAItBzoB,oBAAUywH,SAAShlD,KAAT,CAAezrE;AAJH,SAAxB;AAMA6xH,4BAAoBD,OAApB,EAA6B9T,gBAA7B;AACD;AACF,KAtNyB;;AAwN1B;;;AAGAwT,mBAAe,uBAAUrhI,KAAV,EAAiB;AAC9B,UAAI,KAAKkgI,SAAL,IAAkB,CAAC,KAAK4B,qBAA5B,EAAmD;AACjD;AACD;;AAED,UAAIjU,mBAAmB,KAAK0S,iBAA5B;;AAEA,UAAI3+G,KAAK,KAAKykD,IAAL,CAAU+oB,KAAV,EAAT;;AAEA,UAAImvC,SAAS,KAAK0B,OAAlB;AACA,UAAI8B,cAAclU,iBAAiB1gE,QAAjB,CAA0B,QAA1B,CAAlB;AACA,UAAIypB,SAASi3C,iBAAiBpqH,GAAjB,CAAqB,QAArB,CAAb;;AAEA,UAAI,CAACs+H,YAAYt+H,GAAZ,CAAgB,MAAhB,CAAD,IAA4B,CAACmzE,MAA7B,IAAuCA,WAAW,MAAtD,EAA8D;AAC5D2nD,kBAAU38G,GAAGxL,MAAH,CAAUmoH,MAAV,CAAV;AACA,aAAK0B,OAAL,GAAe,IAAf;AACA;AACD;;AAED,UAAI7iE,MAAJ;;AAEA,UAAI,CAAC,KAAK6iE,OAAV,EAAmB;AACjB7iE,iBAAS,IAAT;AACAmhE,iBAAS,KAAK0B,OAAL,GAAe9vE,WAAW4xE,YAAYt+H,GAAZ,CAAgB,MAAhB,CAAX,EAAoC;AAC1D+H,kBAAQ,MADkD;AAE1DrE,qBAAW,IAF+C;AAG1D66H,uBAAa,qBAAU/6H,CAAV,EAAa;AACxB;AACA2Z,iBAAK3Z,EAAEW,KAAP;AACD,WANyD;AAO1Dq6H,uBAAapC,OAAO,KAAKqC,iBAAZ,EAA+B,IAA/B,EAAqC,CAArC,EAAwC,CAAxC,CAP6C;AAQ1Dn6H,iBAAO83H,OAAO,KAAKqC,iBAAZ,EAA+B,IAA/B,CARmD;AAS1DC,qBAAWtC,OAAO,KAAKuC,gBAAZ,EAA8B,IAA9B;AAT+C,SAApC,CAAxB;AAWAxgH,WAAG5c,GAAH,CAAOu5H,MAAP;AACD;;AAED6C,2BAAqB7C,MAArB,EAA6B1Q,gBAA7B,EAA+C,KAA/C,EArC8B,CAqCyB;;AAEvD,UAAIwU,gBAAgB,CAAC,OAAD,EAAU,aAAV,EAAyB,aAAzB,EAAwC,SAAxC,EAAmD,aAAnD,EAAkE,YAAlE,EAAgF,eAAhF,EAAiG,eAAjG,CAApB;AACA9D,aAAOvhG,QAAP,CAAgB+kG,YAAYpxE,YAAZ,CAAyB,IAAzB,EAA+B0xE,aAA/B,CAAhB,EAxC8B,CAwCkC;;AAEhE,UAAIC,aAAaP,YAAYt+H,GAAZ,CAAgB,MAAhB,CAAjB;;AAEA,UAAI,CAACnE,QAAQgjI,UAAR,CAAL,EAA0B;AACxBA,qBAAa,CAACA,UAAD,EAAaA,UAAb,CAAb;AACD;;AAED/D,aAAOh8G,IAAP,CAAY,OAAZ,EAAqB,CAAC+/G,WAAW,CAAX,IAAgB,CAAjB,EAAoBA,WAAW,CAAX,IAAgB,CAApC,CAArB;AACAvhD,qBAAe,IAAf,EAAqB,wBAArB,EAA+CghD,YAAYt+H,GAAZ,CAAgB,UAAhB,KAA+B,CAA9E,EAAiF,SAAjF;;AAEA,WAAK8+H,kBAAL,CAAwBviI,KAAxB,EAA+Bo9D,MAA/B;AACD,KA/QyB;;AAiR1B;;;AAGAmlE,wBAAoB,4BAAUviI,KAAV,EAAiBo9D,MAAjB,EAAyB;AAC3C6jE,oBAAc,KAAKV,iBAAnB,EAAsC,CAACnjE,MAAD,IAAW,KAAKwjE,cAAtD,EAAsE,KAAKX,OAA3E,EAAoFuC,oBAAoB,KAAKC,kBAAL,CAAwBziI,KAAxB,EAA+B,KAAKsgI,UAApC,EAAgD,KAAKC,iBAArD,CAApB,CAApF;AACD,KAtRyB;;AAwR1B;;;AAGA2B,uBAAmB,2BAAUr6H,EAAV,EAAcC,EAAd,EAAkB;AACnC,UAAIy2H,SAAS,KAAK0B,OAAlB;;AAEA,UAAI,CAAC1B,MAAL,EAAa;AACX;AACD;;AAED,WAAK2B,SAAL,GAAiB,IAAjB,CAPmC,CAOZ;;AAEvB,UAAIwC,QAAQ,KAAKZ,qBAAL,CAA2BU,oBAAoBjE,MAApB,CAA3B,EAAwD,CAAC12H,EAAD,EAAKC,EAAL,CAAxD,EAAkE,KAAKw4H,UAAvE,EAAmF,KAAKC,iBAAxF,CAAZ;AACA,WAAKF,YAAL,GAAoBqC,KAApB;AACAnE,aAAOt8G,aAAP;AACAs8G,aAAOh8G,IAAP,CAAYigH,oBAAoBE,KAApB,CAAZ;AACA/C,cAAQpB,MAAR,EAAgBoE,QAAhB,GAA2B,IAA3B;;AAEA,WAAKC,sBAAL;AACD,KA3SyB;;AA6S1B;;;;AAIAA,4BAAwB,kCAAY;AAClC,UAAIrE,SAAS,KAAK0B,OAAlB;;AAEA,UAAI,CAAC1B,MAAL,EAAa;AACX;AACD;;AAED,UAAI3B,cAAc,KAAKyD,YAAvB;AACA,UAAIr/D,YAAY,KAAKs/D,UAArB;;AAEA,WAAKj6D,IAAL,CAAUmsB,cAAV,CAAyB;AACvB7wF,cAAM,mBADiB;AAEvB+C,WAAGk4H,YAAYiG,WAAZ,CAAwB,CAAxB,CAFoB;AAGvBl+H,WAAGi4H,YAAYiG,WAAZ,CAAwB,CAAxB,CAHoB;AAIvB/E,uBAAelB,YAAYkB,aAJJ;AAKvBtR,kBAAU,CAAC;AACTvrD,mBAASD,UAAUyrC,IAAV,CAAelpC,GADf;AAETxC,qBAAWC,UAAUzE;AAFZ,SAAD;AALa,OAAzB;AAUD,KArUyB;;AAuU1B;;;AAGA6lE,sBAAkB,0BAAUzB,aAAV,EAAyB;AACzC,WAAKT,SAAL,GAAiB,KAAjB;AACA,UAAI3B,SAAS,KAAK0B,OAAlB;;AAEA,UAAI,CAAC1B,MAAL,EAAa;AACX;AACD;;AAED,UAAIv+H,QAAQ,KAAKugI,iBAAL,CAAuB98H,GAAvB,CAA2B,OAA3B,CAAZ,CARyC,CAQQ;AACjD;AACA;;;AAGA,WAAK8+H,kBAAL,CAAwBviI,KAAxB,EAbyC,CAaT;AAChC;;;AAGA,WAAKqmE,IAAL,CAAUmsB,cAAV,CAAyB;AACvB7wF,cAAM;AADiB,OAAzB;AAGD,KA9VyB;;AAgW1B;;;;;;;;AAQA8gI,wBAAoB,IAxWM;;AA0W1B;;;;;;;;;AASAX,2BAAuB,IAnXG;;AAqX1B;;;AAGAzrH,WAAO,eAAUk0D,GAAV,EAAe;AACpB,WAAK41D,UAAL,GAAkB,IAAlB;AACA,WAAKC,WAAL,GAAmB,IAAnB;AACA,UAAIx+G,KAAK2oD,IAAI6kB,KAAJ,EAAT;AACA,UAAIv1B,QAAQ,KAAKkmE,MAAjB;AACA,UAAIxB,SAAS,KAAK0B,OAAlB;;AAEA,UAAIr+G,MAAMi4C,KAAV,EAAiB;AACf,aAAKmmE,eAAL,GAAuB,IAAvB;AACAnmE,iBAASj4C,GAAGxL,MAAH,CAAUyjD,KAAV,CAAT;AACA0kE,kBAAU38G,GAAGxL,MAAH,CAAUmoH,MAAV,CAAV;AACA,aAAKwB,MAAL,GAAc,IAAd;AACA,aAAKE,OAAL,GAAe,IAAf;AACA,aAAKI,YAAL,GAAoB,IAApB;AACD;AACF,KAvYyB;;AAyY1B;;;AAGAyC,aAAS,mBAAY,CAAC;AACrB,KA7YyB;;AA+Y1B;;;;;;AAMAC,gBAAY,oBAAU9I,EAAV,EAAc31F,EAAd,EAAkB0+F,SAAlB,EAA6B;AACvCA,kBAAYA,aAAa,CAAzB;AACA,aAAO;AACLt+H,WAAGu1H,GAAG+I,SAAH,CADE;AAELr+H,WAAGs1H,GAAG,IAAI+I,SAAP,CAFE;AAGLp/G,eAAO0gB,GAAG0+F,SAAH,CAHF;AAILn/G,gBAAQygB,GAAG,IAAI0+F,SAAP;AAJH,OAAP;AAMD;AA7ZyB,GAA5B;AA+ZAlD,kBAAgBhjI,SAAhB,CAA0B6B,WAA1B,GAAwCmhI,eAAxC;;AAEA,WAASmB,aAAT,CAAuB7a,cAAvB,EAAuCua,aAAvC,EAAsDt0H,EAAtD,EAA0D2T,KAA1D,EAAiE;AAC/D;AACA,QAAI,CAACijH,WAAWtD,QAAQtzH,EAAR,EAAYs2H,QAAvB,EAAiC3iH,KAAjC,CAAL,EAA8C;AAC5C2/G,cAAQtzH,EAAR,EAAYs2H,QAAZ,GAAuB3iH,KAAvB;AACA2gH,sBAAgBjyE,YAAYriD,EAAZ,EAAgB2T,KAAhB,EAAuBomG,cAAvB,CAAhB,IAA0D/5G,GAAG4V,aAAH,IAAoB5V,GAAGkW,IAAH,CAAQvC,KAAR,CAA9E;AACD;AACF;;AAED,WAASijH,UAAT,CAAoBC,SAApB,EAA+BC,QAA/B,EAAyC;AACvC,QAAIhkI,WAAW+jI,SAAX,KAAyB/jI,WAAWgkI,QAAX,CAA7B,EAAmD;AACjD,UAAIC,SAAS,IAAb;AACAziI,aAAOwiI,QAAP,EAAiB,UAAU70F,IAAV,EAAgBxvC,GAAhB,EAAqB;AACpCskI,iBAASA,UAAUH,WAAWC,UAAUpkI,GAAV,CAAX,EAA2BwvC,IAA3B,CAAnB;AACD,OAFD;AAGA,aAAO,CAAC,CAAC80F,MAAT;AACD,KAND,MAMO;AACL,aAAOF,cAAcC,QAArB;AACD;AACF;;AAED,WAASvB,mBAAT,CAA6BD,OAA7B,EAAsC9T,gBAAtC,EAAwD;AACtD8T,YAAQ9T,iBAAiBpqH,GAAjB,CAAqB,YAArB,IAAqC,MAArC,GAA8C,MAAtD;AACD;;AAED,WAAS++H,mBAAT,CAA6BE,KAA7B,EAAoC;AAClC,WAAO;AACL3yH,gBAAU2yH,MAAM3yH,QAAN,CAAexS,KAAf,EADL;AAELyS,gBAAU0yH,MAAM1yH,QAAN,IAAkB;AAFvB,KAAP;AAID;;AAED,WAASoxH,oBAAT,CAA8BvnE,KAA9B,EAAqCg0D,gBAArC,EAAuDvhH,MAAvD,EAA+D;AAC7D,QAAI0d,IAAI6jG,iBAAiBpqH,GAAjB,CAAqB,GAArB,CAAR;AACA,QAAIsmB,SAAS8jG,iBAAiBpqH,GAAjB,CAAqB,QAArB,CAAb;AACAo2D,aAASA,MAAMh3C,QAAN,CAAe,UAAUxW,EAAV,EAAc;AACpC,UAAIA,GAAG1K,IAAH,KAAY,OAAhB,EAAyB;AACvBqoB,aAAK,IAAL,KAAc3d,GAAG2d,CAAH,GAAOA,CAArB;AACAD,kBAAU,IAAV,KAAmB1d,GAAG0d,MAAH,GAAYA,MAA/B;AACA1d,WAAGC,MAAH,GAAYA,MAAZ;AACD;AACF,KANQ,CAAT;AAOD;;AAEDmkC,oBAAkBqvF,eAAlB;;AAEA;;;;;;;;;;;;;;;;;;AAkBA;;;;AAIA,WAASuD,YAAT,CAAsBxV,gBAAtB,EAAwC;AACtC,QAAIyV,kBAAkBzV,iBAAiBpqH,GAAjB,CAAqB,MAArB,CAAtB;AACA,QAAI8/H,aAAa1V,iBAAiB1gE,QAAjB,CAA0Bm2E,kBAAkB,OAA5C,CAAjB;AACA,QAAIp0G,KAAJ;;AAEA,QAAIo0G,oBAAoB,MAAxB,EAAgC;AAC9Bp0G,cAAQq0G,WAAWvwF,YAAX,EAAR;AACA9jB,YAAMlD,IAAN,GAAa,IAAb;AACD,KAHD,MAGO,IAAIs3G,oBAAoB,QAAxB,EAAkC;AACvCp0G,cAAQq0G,WAAWjwF,YAAX,EAAR;AACApkB,YAAMjD,MAAN,GAAe,IAAf;AACD;;AAED,WAAOiD,KAAP;AACD;AACD;;;;AAIA,WAASs0G,kBAAT,CAA4BhD,QAA5B,EAAsCx/D,SAAtC,EAAiD6sD,gBAAjD,EAAmEtjD,GAAnE,EAAwEk5D,QAAxE,EAAkF;AAChF,QAAIzjI,QAAQ6tH,iBAAiBpqH,GAAjB,CAAqB,OAArB,CAAZ;AACA,QAAIipB,OAAOg3G,cAAc1jI,KAAd,EAAqBghE,UAAUyrC,IAA/B,EAAqCzrC,UAAUzxB,OAA/C,EAAwDs+E,iBAAiBpqH,GAAjB,CAAqB,mBAArB,CAAxD,EAAmG;AAC5GkxD,iBAAWk5D,iBAAiBpqH,GAAjB,CAAqB,iBAArB,CADiG;AAE5GuzE,iBAAW62C,iBAAiBpqH,GAAjB,CAAqB,iBAArB;AAFiG,KAAnG,CAAX;AAIA,QAAIipD,aAAamhE,iBAAiB1gE,QAAjB,CAA0B,OAA1B,CAAjB;AACA,QAAIw2E,WAAW7rE,oBAAoBpL,WAAWjpD,GAAX,CAAe,SAAf,KAA6B,CAAjD,CAAf;AACA,QAAIkpB,OAAO+/B,WAAWoB,OAAX,EAAX;AACA,QAAIrgC,WAAWpH,iBAAgBqG,IAAhB,EAAsBC,IAAtB,CAAf;AACA,QAAI5c,WAAW0zH,SAAS1zH,QAAxB;AACA,QAAI6T,QAAQ6J,SAAS7J,KAAT,GAAiB+/G,SAAS,CAAT,CAAjB,GAA+BA,SAAS,CAAT,CAA3C;AACA,QAAI9/G,SAAS4J,SAAS5J,MAAT,GAAkB8/G,SAAS,CAAT,CAAlB,GAAgCA,SAAS,CAAT,CAA7C,CAZgF,CAYtB;;AAE1D,QAAIhQ,QAAQ8P,SAAS9P,KAArB;AACAA,cAAU,OAAV,KAAsB5jH,SAAS,CAAT,KAAe6T,KAArC;AACA+vG,cAAU,QAAV,KAAuB5jH,SAAS,CAAT,KAAe6T,QAAQ,CAA9C;AACA,QAAIggH,gBAAgBH,SAASG,aAA7B;AACAA,sBAAkB,QAAlB,KAA+B7zH,SAAS,CAAT,KAAe8T,MAA9C;AACA+/G,sBAAkB,QAAlB,KAA+B7zH,SAAS,CAAT,KAAe8T,SAAS,CAAvD,EAnBgF,CAmBrB;;AAE3DggH,uBAAmB9zH,QAAnB,EAA6B6T,KAA7B,EAAoCC,MAApC,EAA4C0mD,GAA5C;AACA,QAAIu5D,UAAUp3E,WAAWjpD,GAAX,CAAe,iBAAf,CAAd;;AAEA,QAAI,CAACqgI,OAAD,IAAYA,YAAY,MAA5B,EAAoC;AAClCA,gBAAU9iE,UAAUv9D,GAAV,CAAc,0BAAd,CAAV;AACD;;AAED+8H,aAAShlD,KAAT,GAAiB;AACfhjD,aAAO;AACL9zB,WAAG,CADE;AAELC,WAAG,CAFE;AAGLif,eAAOA,KAHF;AAILC,gBAAQA,MAJH;AAKL/L,WAAG40C,WAAWjpD,GAAX,CAAe,cAAf;AALE,OADQ;AAQfsM,gBAAUA,SAASxS,KAAT,EARK;AASf;AACA2xB,aAAO;AACLxC,cAAMA,IADD;AAELE,kBAAUD,IAFL;AAGLO,kBAAUw/B,WAAW+D,YAAX,EAHL;AAILjjC,sBAAc,QAJT;AAKLxB,cAAM83G,OALD;AAML73G,gBAAQygC,WAAWjpD,GAAX,CAAe,aAAf,KAAiC,aANpC;AAOL+oB,mBAAWkgC,WAAWjpD,GAAX,CAAe,aAAf,KAAiC,CAPvC;AAQL4oB,oBAAYqgC,WAAWjpD,GAAX,CAAe,YAAf,CARP;AASLmgD,qBAAa8I,WAAWjpD,GAAX,CAAe,aAAf,CATR;AAUL6oB,uBAAeogC,WAAWjpD,GAAX,CAAe,eAAf,CAVV;AAWL8oB,uBAAemgC,WAAWjpD,GAAX,CAAe,eAAf;AAXV,OAVQ;AAuBf;AACAwmB,UAAI;AAxBW,KAAjB;AA0BD,GA9mpC2B,CA8mpC1B;;AAEF,WAAS45G,kBAAT,CAA4B9zH,QAA5B,EAAsC6T,KAAtC,EAA6CC,MAA7C,EAAqD0mD,GAArD,EAA0D;AACxD,QAAIw5D,YAAYx5D,IAAI35C,QAAJ,EAAhB;AACA,QAAIozG,aAAaz5D,IAAI15C,SAAJ,EAAjB;AACA9gB,aAAS,CAAT,IAAc1K,KAAKoB,GAAL,CAASsJ,SAAS,CAAT,IAAc6T,KAAvB,EAA8BmgH,SAA9B,IAA2CngH,KAAzD;AACA7T,aAAS,CAAT,IAAc1K,KAAKoB,GAAL,CAASsJ,SAAS,CAAT,IAAc8T,MAAvB,EAA+BmgH,UAA/B,IAA6CngH,MAA3D;AACA9T,aAAS,CAAT,IAAc1K,KAAKqB,GAAL,CAASqJ,SAAS,CAAT,CAAT,EAAsB,CAAtB,CAAd;AACAA,aAAS,CAAT,IAAc1K,KAAKqB,GAAL,CAASqJ,SAAS,CAAT,CAAT,EAAsB,CAAtB,CAAd;AACD;AACD;;;;;;;;;;AAWA,WAAS2zH,aAAT,CAAuB1jI,KAAvB,EAA8BysG,IAA9B,EAAoCl9D,OAApC,EAA6CouF,iBAA7C,EAAgEvwF,GAAhE,EAAqE;AACnEptC,YAAQysG,KAAK7mG,KAAL,CAAW0S,KAAX,CAAiBtY,KAAjB,CAAR;AACA,QAAI0sB,OAAO+/E,KAAK7mG,KAAL,CAAW6jG,QAAX,EAAqB;AAChC;AACAzpG,SAFW,EAEJ;AACL20D,iBAAWvnB,IAAIunB;AADV,KAFI,CAAX;AAKA,QAAIqiB,YAAY5pC,IAAI4pC,SAApB;;AAEA,QAAIA,SAAJ,EAAe;AACb,UAAIl+D,SAAS;AACX9Y,eAAOy0G,gBAAgBhI,IAAhB,EAAsBzsG,KAAtB,CADI;AAEXikI,oBAAY;AAFD,OAAb;AAIAtjI,aAAOg9H,iBAAP,EAA0B,UAAUuG,OAAV,EAAmB;AAC3C,YAAI37D,SAASh5B,QAAQk5B,gBAAR,CAAyBy7D,QAAQx7D,WAAjC,CAAb;AACA,YAAI35B,YAAYm1F,QAAQp1F,eAAxB;AACA,YAAIq1F,aAAa57D,UAAUA,OAAO2N,aAAP,CAAqBnnC,SAArB,CAA3B;AACAo1F,sBAAcrrH,OAAOmrH,UAAP,CAAkBljI,IAAlB,CAAuBojI,UAAvB,CAAd;AACD,OALD;;AAOA,UAAIziI,SAASs1E,SAAT,CAAJ,EAAyB;AACvBtqD,eAAOsqD,UAAUh0E,OAAV,CAAkB,SAAlB,EAA6B0pB,IAA7B,CAAP;AACD,OAFD,MAEO,IAAIjrB,aAAau1E,SAAb,CAAJ,EAA6B;AAClCtqD,eAAOsqD,UAAUl+D,MAAV,CAAP;AACD;AACF;;AAED,WAAO4T,IAAP;AACD;AACD;;;;;;;;AAQA,WAAS03G,sBAAT,CAAgC33B,IAAhC,EAAsCzsG,KAAtC,EAA6CqkI,UAA7C,EAAyD;AACvD,QAAIl0H,YAAYzC,UAAhB;AACAa,WAAO4B,SAAP,EAAkBA,SAAlB,EAA6Bk0H,WAAWr0H,QAAxC;AACA1B,cAAU6B,SAAV,EAAqBA,SAArB,EAAgCk0H,WAAWt0H,QAA3C;AACA,WAAOg/C,iBAAiB,CAAC09C,KAAK0D,WAAL,CAAiBnwG,KAAjB,CAAD,EAA0B,CAACqkI,WAAWnc,WAAX,IAA0B,CAA3B,IAAgC,CAACmc,WAAWhc,cAAX,IAA6B,CAA9B,KAAoCgc,WAAWpY,WAAX,IAA0B,CAA9D,CAA1D,CAAjB,EAA8I97G,SAA9I,CAAP;AACD;AACD,WAASm0H,iCAAT,CAA2CtkI,KAA3C,EAAkDwgI,QAAlD,EAA4D6D,UAA5D,EAAwErjE,SAAxE,EAAmF6sD,gBAAnF,EAAqGtjD,GAArG,EAA0G;AACxG,QAAIg6D,aAAatc,YAAY6B,eAAZ,CAA4Bua,WAAWr0H,QAAvC,EAAiD,CAAjD,EAAoDq0H,WAAWhc,cAA/D,CAAjB;AACAgc,eAAWpY,WAAX,GAAyB4B,iBAAiBpqH,GAAjB,CAAqB,cAArB,CAAzB;AACA+/H,uBAAmBhD,QAAnB,EAA6Bx/D,SAA7B,EAAwC6sD,gBAAxC,EAA0DtjD,GAA1D,EAA+D;AAC7Dx6D,gBAAUq0H,uBAAuBpjE,UAAUyrC,IAAjC,EAAuCzsG,KAAvC,EAA8CqkI,UAA9C,CADmD;AAE7D1Q,aAAO4Q,WAAW52G,SAF2C;AAG7Di2G,qBAAeW,WAAW32G;AAHmC,KAA/D;AAKD;AACD;;;;;;AAMA,WAAS42G,aAAT,CAAuB1oH,EAAvB,EAA2Be,EAA3B,EAA+BmmH,SAA/B,EAA0C;AACxCA,gBAAYA,aAAa,CAAzB;AACA,WAAO;AACLhtF,UAAIl6B,GAAGknH,SAAH,CADC;AAEL/sF,UAAIn6B,GAAG,IAAIknH,SAAP,CAFC;AAGLp3G,UAAI/O,GAAGmmH,SAAH,CAHC;AAILn3G,UAAIhP,GAAG,IAAImmH,SAAP;AAJC,KAAP;AAMD;AACD;;;;;;AAMA,WAASyB,aAAT,CAAuBxK,EAAvB,EAA2B31F,EAA3B,EAA+B0+F,SAA/B,EAA0C;AACxCA,gBAAYA,aAAa,CAAzB;AACA,WAAO;AACLt+H,SAAGu1H,GAAG+I,SAAH,CADE;AAELr+H,SAAGs1H,GAAG,IAAI+I,SAAP,CAFE;AAGLp/G,aAAO0gB,GAAG0+F,SAAH,CAHF;AAILn/G,cAAQygB,GAAG,IAAI0+F,SAAP;AAJH,KAAP;AAMD;;AAED;;;;;;;;;;;;;;;;;;AAkBA,MAAI0B,uBAAuB5E,gBAAgBpgI,MAAhB,CAAuB;AAChD;;;AAGA+gI,kBAAc,sBAAUD,QAAV,EAAoBxgI,KAApB,EAA2BghE,SAA3B,EAAsC6sD,gBAAtC,EAAwDtjD,GAAxD,EAA6D;AACzE,UAAIkiC,OAAOzrC,UAAUyrC,IAArB;AACA,UAAIoT,OAAOpT,KAAKoT,IAAhB;AACA,UAAIyjB,kBAAkBzV,iBAAiBpqH,GAAjB,CAAqB,MAArB,CAAtB;AACA,UAAIkhI,cAAcxhB,aAAatD,IAAb,EAAmBpT,IAAnB,EAAyBqC,YAAzB,CAAsCrC,IAAtC,EAA4C2D,eAA5C,EAAlB;AACA,UAAIw0B,aAAan4B,KAAKyD,aAAL,CAAmBzD,KAAK0D,WAAL,CAAiBnwG,KAAjB,EAAwB,IAAxB,CAAnB,CAAjB;;AAEA,UAAIsjI,mBAAmBA,oBAAoB,MAA3C,EAAmD;AACjD,YAAIuB,UAAUxB,aAAaxV,gBAAb,CAAd;AACA,YAAI2T,gBAAgBsD,oBAAoBxB,eAApB,EAAqC72B,IAArC,EAA2Cm4B,UAA3C,EAAuDD,WAAvD,EAAoEE,OAApE,CAApB;AACArD,sBAActyG,KAAd,GAAsB21G,OAAtB;AACArE,iBAASE,UAAT,GAAsBc,cAAc7/H,IAApC;AACA6+H,iBAASiB,OAAT,GAAmBD,aAAnB;AACD;;AAED,UAAI6C,aAAanU,SAASrQ,KAAKjtE,KAAd,EAAqBouB,SAArB,CAAjB;AACAsjE,wCAAkCtkI,KAAlC,EAAyCwgI,QAAzC,EAAmD6D,UAAnD,EAA+DrjE,SAA/D,EAA0E6sD,gBAA1E,EAA4FtjD,GAA5F;AACD,KArB+C;;AAuBhD;;;AAGAk4D,wBAAoB,4BAAUziI,KAAV,EAAiBghE,SAAjB,EAA4B6sD,gBAA5B,EAA8C;AAChE,UAAIwW,aAAanU,SAASlvD,UAAUyrC,IAAV,CAAeoT,IAAf,CAAoBjtE,KAA7B,EAAoCouB,SAApC,EAA+C;AAC9D0vD,qBAAa;AADiD,OAA/C,CAAjB;AAGA2T,iBAAWpY,WAAX,GAAyB4B,iBAAiBpqH,GAAjB,CAAqB,eAArB,CAAzB;AACA,aAAO;AACLsM,kBAAUq0H,uBAAuBpjE,UAAUyrC,IAAjC,EAAuCzsG,KAAvC,EAA8CqkI,UAA9C,CADL;AAELr0H,kBAAUq0H,WAAWr0H,QAAX,IAAuBq0H,WAAWhc,cAAX,GAA4B,CAA5B,GAAgChjH,KAAKgN,EAArC,GAA0C,CAAjE;AAFL,OAAP;AAID,KAnC+C;;AAqChD;;;AAGAyvH,2BAAuB,+BAAU3xH,SAAV,EAAqBwJ,KAArB,EAA4BqnD,SAA5B,EAAuC6sD,gBAAvC,EAAyD;AAC9E,UAAIphB,OAAOzrC,UAAUyrC,IAArB;AACA,UAAIoT,OAAOpT,KAAKoT,IAAhB;AACA,UAAI3S,aAAaT,KAAK2D,eAAL,CAAqB,IAArB,CAAjB;AACA,UAAIu0B,cAAcxhB,aAAatD,IAAb,EAAmBpT,IAAnB,EAAyBqC,YAAzB,CAAsCrC,IAAtC,EAA4C2D,eAA5C,EAAlB;AACA,UAAIrrC,WAAW0nC,KAAKlpC,GAAL,KAAa,GAAb,GAAmB,CAAnB,GAAuB,CAAtC;AACA,UAAIwhE,eAAe50H,UAAUJ,QAA7B;AACAg1H,mBAAahgE,QAAb,KAA0BprD,MAAMorD,QAAN,CAA1B;AACAggE,mBAAahgE,QAAb,IAAyB1/D,KAAKoB,GAAL,CAASymG,WAAW,CAAX,CAAT,EAAwB63B,aAAahgE,QAAb,CAAxB,CAAzB;AACAggE,mBAAahgE,QAAb,IAAyB1/D,KAAKqB,GAAL,CAASwmG,WAAW,CAAX,CAAT,EAAwB63B,aAAahgE,QAAb,CAAxB,CAAzB;AACA,UAAIigE,mBAAmB,CAACL,YAAY,CAAZ,IAAiBA,YAAY,CAAZ,CAAlB,IAAoC,CAA3D;AACA,UAAI9B,cAAc,CAACmC,gBAAD,EAAmBA,gBAAnB,CAAlB;AACAnC,kBAAY99D,QAAZ,IAAwBggE,aAAahgE,QAAb,CAAxB,CAZ8E,CAY9B;;AAEhD,UAAIkgE,iBAAiB,CAAC;AACpBrB,uBAAe;AADK,OAAD,EAElB;AACDjQ,eAAO;AADN,OAFkB,CAArB;AAKA,aAAO;AACL5jH,kBAAUg1H,YADL;AAEL/0H,kBAAUG,UAAUH,QAFf;AAGL6yH,qBAAaA,WAHR;AAIL/E,uBAAemH,eAAelgE,QAAf;AAJV,OAAP;AAMD;AAjE+C,GAAvB,CAA3B;;AAoEA,WAASo+C,YAAT,CAAsBtD,IAAtB,EAA4BpT,IAA5B,EAAkC;AAChC,QAAIr/D,MAAM,EAAV;AACAA,QAAIq/D,KAAKlpC,GAAL,GAAW,WAAf,IAA8BkpC,KAAK31E,KAAnC;AACA,WAAO+oF,KAAKsD,YAAL,CAAkB/1E,GAAlB,CAAP;AACD;;AAED,MAAI03F,sBAAsB;AACxBxtG,UAAM,cAAUm1E,IAAV,EAAgBm4B,UAAhB,EAA4BD,WAA5B,EAAyCE,OAAzC,EAAkD;AACtD,UAAIK,cAAcV,cAAc,CAACI,UAAD,EAAaD,YAAY,CAAZ,CAAb,CAAd,EAA4C,CAACC,UAAD,EAAaD,YAAY,CAAZ,CAAb,CAA5C,EAA0EQ,gBAAgB14B,IAAhB,CAA1E,CAAlB;AACA7jD,2BAAqB;AACnBpwB,eAAO0sG,WADY;AAEnBh2G,eAAO21G;AAFY,OAArB;AAIA,aAAO;AACLljI,cAAM,MADD;AAEL62B,eAAO0sG;AAFF,OAAP;AAID,KAXuB;AAYxBE,YAAQ,gBAAU34B,IAAV,EAAgBm4B,UAAhB,EAA4BD,WAA5B,EAAyCE,OAAzC,EAAkD;AACxD,UAAI13B,YAAY9nG,KAAKqB,GAAL,CAAS,CAAT,EAAY+lG,KAAKW,YAAL,EAAZ,CAAhB;AACA,UAAIlC,OAAOy5B,YAAY,CAAZ,IAAiBA,YAAY,CAAZ,CAA5B;AACA,aAAO;AACLhjI,cAAM,MADD;AAEL62B,eAAOisG,cAAc,CAACG,aAAaz3B,YAAY,CAA1B,EAA6Bw3B,YAAY,CAAZ,CAA7B,CAAd,EAA4D,CAACx3B,SAAD,EAAYjC,IAAZ,CAA5D,EAA+Ei6B,gBAAgB14B,IAAhB,CAA/E;AAFF,OAAP;AAID;AAnBuB,GAA1B;;AAsBA,WAAS04B,eAAT,CAAyB14B,IAAzB,EAA+B;AAC7B,WAAOA,KAAKlpC,GAAL,KAAa,GAAb,GAAmB,CAAnB,GAAuB,CAA9B;AACD;;AAEDisD,WAASS,wBAAT,CAAkC,sBAAlC,EAA0DyU,oBAA1D;;AAEA;;;;;;;;;;;;;;;;;;AAkBA;AACA;;AAEAvuC,uBAAqB,UAAUloD,MAAV,EAAkB;AACrC;AACA,QAAIA,MAAJ,EAAY;AACV,OAAC,CAACA,OAAOoiC,WAAR,IAAuBpiC,OAAOoiC,WAAP,CAAmB5xE,MAAnB,KAA8B,CAAtD,MAA6DwvC,OAAOoiC,WAAP,GAAqB,EAAlF;AACA,UAAIiiD,OAAOrkF,OAAOoiC,WAAP,CAAmBiiD,IAA9B,CAFU,CAE0B;AACpC;AACA;;AAEA,UAAIA,QAAQ,CAAChzH,QAAQgzH,IAAR,CAAb,EAA4B;AAC1BrkF,eAAOoiC,WAAP,CAAmBiiD,IAAnB,GAA0B,CAACA,IAAD,CAA1B;AACD;AACF;AACF,GAZD,EAp2pC4B,CAg3pCxB;AACJ;;AAEAj8B,oBAAkB/J,SAASC,SAAT,CAAmBE,SAArC,EAAgD,UAAUl9C,OAAV,EAAmBg7B,GAAnB,EAAwB;AACtE;AACA;AACAh7B,YAAQqxB,YAAR,CAAqB,aAArB,EAAoC8rD,gBAApC,GAAuDH,QAAQh9E,OAAR,EAAiBg7B,GAAjB,CAAvD;AACD,GAJD,EAn3pC4B,CAu3pCxB;;AAEJosB,iBAAe;AACbh1F,UAAM,mBADO;AAEbiG,WAAO,mBAFM;AAGbgb,YAAQ;AAHK,GAAf,EAIGo4G,WAJH;;AAMA;;;;;;;;;;;;;;;;;;AAkBAtjC,uBAAqB;AACnB/1F,UAAM,SADa;AAEnBg8D,kBAAc,CAAC,aAAD,CAFK;AAGnBnB,mBAAe;AACbzyC,cAAQ,CADK;AAEbC,SAAG,CAFU;AAGb/G,YAAM,IAHO;AAIb;AACAoiH,mBAAa,IALA;AAMb;AACA;AACAp8H,eAAS,MARI;AASb;AACAo1H,iBAAW,iBAVE;AAWbiH,yBAAmB,KAXN;AAYbC,mBAAa,QAZA;AAab;AACA;AACA;AACA;AACA;AACA;AACA;AACAC,eAAS,KApBI;AAqBb;AACA;AACAC,iBAAW,CAvBE;AAwBb;AACAC,iBAAW,GAzBE;AA0Bb;AACAC,0BAAoB,GA3BP;AA4BbC,iBAAW,KA5BE;AA6Bb;AACApiG,uBAAiB,oBA9BJ;AA+Bb;AACA6nD,mBAAa,MAhCA;AAiCb;AACAuoC,oBAAc,CAlCD;AAmCb;AACAnS,mBAAa,CApCA;AAqCb;AACA;AACAlrF,eAAS,CAvCI;AAwCb;AACAwiC,oBAAc,EAzCD;AA0Cb;AACAsX,mBAAa;AACX;AACA;AACA1uE,cAAM,MAHK;AAIX;AACA;AACA;AACA;AACA8qG,cAAM,MARK;AASXhsF,mBAAW,MATA;AAUXy9C,iCAAyB,GAVd;AAWXC,+BAAuB,gBAXZ;AAYX+sB,oBAAY;AACV/wE,iBAAO,MADG;AAEVyJ,iBAAO,CAFG;AAGVjiB,gBAAM,QAHI;AAIV;AACAyqD,qBAAW,EALD,CAKI;AACd;;AANU;AAZD,OA3CA;AAiEbA,iBAAW;AACTjyC,eAAO,MADE;AAET4S,kBAAU;AAFD;AAjEE;AAHI,GAArB;;AA2EA;;;;;;;;;;;;;;;;;;AAkBA,MAAI84G,UAAUllI,MAAd;AACA,MAAImlI,gBAAgBnuE,WAApB;AACA,MAAIouE,UAAU,CAAC,EAAD,EAAK,UAAL,EAAiB,OAAjB,EAA0B,KAA1B,CAAd;AACA,MAAIC,WAAW,wFAAf;AACA;;;;;;AAMA,WAASC,kBAAT,CAA4B33E,QAA5B,EAAsC;AACpC,QAAI43E,kBAAkB,gCAAtB;AACA,QAAIC,iBAAiB,UAAU73E,QAAV,GAAqB,IAArB,GAA4B43E,eAA5B,GAA8C,GAA9C,GAAoD,MAApD,GAA6D53E,QAA7D,GAAwE,IAAxE,GAA+E43E,eAApG;AACA,WAAOzoI,IAAIsoI,OAAJ,EAAa,UAAUK,YAAV,EAAwB;AAC1C,aAAOA,eAAe,aAAf,GAA+BD,cAAtC;AACD,KAFM,EAEJ7oH,IAFI,CAEC,GAFD,CAAP;AAGD;AACD;;;;;;AAOA,WAAS+oH,YAAT,CAAsBh6E,cAAtB,EAAsC;AACpC,QAAIhuB,UAAU,EAAd;AACA,QAAItR,WAAWs/B,eAAe5oD,GAAf,CAAmB,UAAnB,CAAf;AACA,QAAI0W,QAAQkyC,eAAeoE,YAAf,EAAZ;AACAt2C,aAASkkB,QAAQt9B,IAAR,CAAa,WAAWoZ,KAAxB,CAAT;AACAkkB,YAAQt9B,IAAR,CAAa,UAAUsrD,eAAeyB,OAAf,EAAvB;AACA/gC,gBAAYsR,QAAQt9B,IAAR,CAAa,iBAAiBsE,KAAK6R,KAAL,CAAW6V,WAAW,CAAX,GAAe,CAA1B,CAAjB,GAAgD,IAA7D,CAAZ;AACA84G,YAAQ,CAAC,YAAD,EAAe,OAAf,CAAR,EAAiC,UAAU/nI,IAAV,EAAgB;AAC/C,UAAI2E,MAAM4pD,eAAe5oD,GAAf,CAAmB3F,IAAnB,CAAV;AACA2E,aAAO47B,QAAQt9B,IAAR,CAAa,UAAUjD,IAAV,GAAiB,GAAjB,GAAuB2E,GAApC,CAAP;AACD,KAHD;AAIA,WAAO47B,QAAQ/gB,IAAR,CAAa,GAAb,CAAP;AACD;AACD;;;;;;AAOA,WAASgpH,eAAT,CAAyBvQ,YAAzB,EAAuC;AACrC,QAAI13F,UAAU,EAAd;AACA,QAAIsnG,qBAAqB5P,aAAatyH,GAAb,CAAiB,oBAAjB,CAAzB;AACA,QAAI+/B,kBAAkBuyF,aAAatyH,GAAb,CAAiB,iBAAjB,CAAtB;AACA,QAAI4oD,iBAAiB0pE,aAAa5oE,QAAb,CAAsB,WAAtB,CAArB;AACA,QAAI52B,UAAUw/F,aAAatyH,GAAb,CAAiB,SAAjB,CAAd,CALqC,CAKM;;AAE3CkiI,0BAAsBtnG,QAAQt9B,IAAR,CAAaklI,mBAAmBN,kBAAnB,CAAb,CAAtB;;AAEA,QAAIniG,eAAJ,EAAqB;AACnB,UAAI5nC,MAAMT,eAAV,EAA2B;AACzBkjC,gBAAQt9B,IAAR,CAAa,sBAAsByiC,eAAnC;AACD,OAFD,MAEO;AACL;AACAnF,gBAAQt9B,IAAR,CAAa,uBAAuBwZ,MAAMipB,eAAN,CAApC;AACAnF,gBAAQt9B,IAAR,CAAa,0BAAb;AACD;AACF,KAjBoC,CAiBnC;;;AAGF8kI,YAAQ,CAAC,OAAD,EAAU,OAAV,EAAmB,QAAnB,CAAR,EAAsC,UAAU/nI,IAAV,EAAgB;AACpD,UAAIyoI,aAAa,YAAYzoI,IAA7B;AACA,UAAI0oI,YAAYV,cAAcS,UAAd,CAAhB;AACA,UAAI9jI,MAAMszH,aAAatyH,GAAb,CAAiB+iI,SAAjB,CAAV;AACA/jI,aAAO,IAAP,IAAe47B,QAAQt9B,IAAR,CAAawlI,aAAa,GAAb,GAAmB9jI,GAAnB,IAA0B3E,SAAS,OAAT,GAAmB,EAAnB,GAAwB,IAAlD,CAAb,CAAf;AACD,KALD,EApBqC,CAyBjC;;AAEJugC,YAAQt9B,IAAR,CAAaslI,aAAah6E,cAAb,CAAb,EA3BqC,CA2BO;;AAE5C,QAAI91B,WAAW,IAAf,EAAqB;AACnB8H,cAAQt9B,IAAR,CAAa,aAAa+2D,oBAAoBvhC,OAApB,EAA6BjZ,IAA7B,CAAkC,KAAlC,CAAb,GAAwD,IAArE;AACD;;AAED,WAAO+gB,QAAQ/gB,IAAR,CAAa,GAAb,IAAoB,GAA3B;AACD;AACD;;;;;AAMA,WAASmpH,cAAT,CAAwB90F,SAAxB,EAAmC44B,GAAnC,EAAwC;AACtC,QAAI3uE,MAAMV,GAAV,EAAe;AACb,aAAO,IAAP;AACD;;AAED,QAAImR,KAAK/Q,SAASe,aAAT,CAAuB,KAAvB,CAAT;AACA,QAAIulB,KAAK,KAAK8rE,GAAL,GAAWnjB,IAAI6kB,KAAJ,EAApB;AACA,SAAK/iF,EAAL,GAAUA,EAAV;AACA,SAAK/E,EAAL,GAAUijE,IAAI35C,QAAJ,KAAiB,CAA3B;AACA,SAAKppB,EAAL,GAAU+iE,IAAI15C,SAAJ,KAAkB,CAA5B;AACA8gB,cAAUnS,WAAV,CAAsBnzB,EAAtB;AACA,SAAKq6H,UAAL,GAAkB/0F,SAAlB;AACA,SAAKg1F,KAAL,GAAa,KAAb;AACA;;;;AAIA,SAAKC,YAAL;AACA,QAAIrrI,OAAO,IAAX;;AAEA8Q,OAAGw6H,YAAH,GAAkB,YAAY;AAC5B;AACA,UAAItrI,KAAKurI,UAAT,EAAqB;AACnB58F,qBAAa3uC,KAAKqrI,YAAlB;AACArrI,aAAKorI,KAAL,GAAa,IAAb;AACD;;AAEDprI,WAAKwrI,UAAL,GAAkB,IAAlB;AACD,KARD;;AAUA16H,OAAG21H,WAAH,GAAiB,UAAU/6H,CAAV,EAAa;AAC5BA,UAAIA,KAAKzK,OAAOoL,KAAhB;;AAEA,UAAI,CAACrM,KAAKurI,UAAV,EAAsB;AACpB;AACA;AACA,YAAIr+H,UAAUmZ,GAAGnZ,OAAjB;AACA09B,uBAAewL,SAAf,EAA0B1qC,CAA1B,EAA6B,IAA7B;AACAwB,gBAAQuD,QAAR,CAAiB,WAAjB,EAA8B/E,CAA9B;AACD;AACF,KAVD;;AAYAoF,OAAG26H,YAAH,GAAkB,YAAY;AAC5B,UAAIzrI,KAAKurI,UAAT,EAAqB;AACnB,YAAIvrI,KAAKorI,KAAT,EAAgB;AACdprI,eAAK0rI,SAAL,CAAe1rI,KAAK2rI,UAApB;AACD;AACF;;AAED3rI,WAAKwrI,UAAL,GAAkB,KAAlB;AACD,KARD;AASD;;AAEDN,iBAAe3pI,SAAf,GAA2B;AACzB6B,iBAAa8nI,cADY;;AAGzB;;;;AAIAK,gBAAY,IAPa;;AASzB;;;AAGAlkH,YAAQ,kBAAY;AAClB;AACA;AACA,UAAI+uB,YAAY,KAAK+0F,UAArB;AACA,UAAIhiG,MAAMiN,UAAUw1F,YAAV,IAA0B7rI,SAASqpC,WAAT,CAAqBC,gBAArB,CAAsC+M,SAAtC,CAApC;AACA,UAAIxgB,WAAWwgB,UAAUziB,KAAzB;;AAEA,UAAIiC,SAASphB,QAAT,KAAsB,UAAtB,IAAoC20B,IAAI30B,QAAJ,KAAiB,UAAzD,EAAqE;AACnEohB,iBAASphB,QAAT,GAAoB,UAApB;AACD,OATiB,CAShB;AACF;AACA;AAED,KAzBwB;AA0BzBkT,UAAM,cAAU8yG,YAAV,EAAwB;AAC5B7rF,mBAAa,KAAK08F,YAAlB;AACA,UAAIv6H,KAAK,KAAKA,EAAd;AACAA,SAAG6iB,KAAH,CAASmP,OAAT,GAAmB2nG,WAAWM,gBAAgBvQ,YAAhB,CAAX,CAAyC;AAAzC,QACjB,QADiB,GACN,KAAKzuH,EADC,GACI,SADJ,GACgB,KAAKE,EADrB,GAC0B,KAD1B,IACmCuuH,aAAatyH,GAAb,CAAiB,cAAjB,KAAoC,EADvE,CAAnB;AAEA4I,SAAG6iB,KAAH,CAAS4U,OAAT,GAAmBz3B,GAAGwyB,SAAH,GAAe,OAAf,GAAyB,MAA5C;AACA,WAAK8nG,KAAL,GAAa,IAAb;AACD,KAjCwB;AAkCzBS,gBAAY,oBAAU5c,OAAV,EAAmB;AAC7B,WAAKn+G,EAAL,CAAQwyB,SAAR,GAAoB2rF,WAAW,IAAX,GAAkB,EAAlB,GAAuBA,OAA3C;AACD,KApCwB;AAqCzB6c,kBAAc,sBAAUzB,SAAV,EAAqB;AACjC,WAAKkB,UAAL,GAAkBlB,SAAlB;AACD,KAvCwB;AAwCzB0B,aAAS,mBAAY;AACnB,UAAIj7H,KAAK,KAAKA,EAAd;AACA,aAAO,CAACA,GAAGk7H,WAAJ,EAAiBl7H,GAAGm7H,YAApB,CAAP;AACD,KA3CwB;AA4CzB1uG,YAAQ,gBAAUp0B,CAAV,EAAaC,CAAb,EAAgB;AACtB;AACA;AACA;AACA,UAAIid,KAAK,KAAK8rE,GAAd;AACA,UAAI+5C,kBAAJ;;AAEA,UAAI7lH,MAAMA,GAAGnX,OAAT,KAAqBg9H,qBAAqB7lH,GAAGnX,OAAH,CAAWs1B,qBAAX,EAA1C,CAAJ,EAAmF;AACjFr7B,aAAK+iI,mBAAmBxnG,UAAxB;AACAt7B,aAAK8iI,mBAAmBvnG,SAAxB;AACD;;AAED,UAAIhR,QAAQ,KAAK7iB,EAAL,CAAQ6iB,KAApB;AACAA,YAAM3H,IAAN,GAAa7iB,IAAI,IAAjB;AACAwqB,YAAM6B,GAAN,GAAYpsB,IAAI,IAAhB;AACA,WAAK2C,EAAL,GAAU5C,CAAV;AACA,WAAK8C,EAAL,GAAU7C,CAAV;AACD,KA7DwB;AA8DzBoe,UAAM,gBAAY;AAChB,WAAK1W,EAAL,CAAQ6iB,KAAR,CAAc4U,OAAd,GAAwB,MAAxB;AACA,WAAK6iG,KAAL,GAAa,KAAb;AACD,KAjEwB;AAkEzBM,eAAW,mBAAUtoH,IAAV,EAAgB;AACzB,UAAI,KAAKgoH,KAAL,IAAc,EAAE,KAAKI,UAAL,IAAmB,KAAKD,UAA1B,CAAlB,EAAyD;AACvD,YAAInoH,IAAJ,EAAU;AACR,eAAKuoH,UAAL,GAAkBvoH,IAAlB,CADQ,CACgB;;AAExB,eAAKgoH,KAAL,GAAa,KAAb;AACA,eAAKC,YAAL,GAAoB5zG,WAAW9xB,KAAK,KAAK6hB,IAAV,EAAgB,IAAhB,CAAX,EAAkCpE,IAAlC,CAApB;AACD,SALD,MAKO;AACL,eAAKoE,IAAL;AACD;AACF;AACF,KA7EwB;AA8EzB2kH,YAAQ,kBAAY;AAClB,aAAO,KAAKf,KAAZ;AACD;AAhFwB,GAA3B;;AAmFA;;;;;;;;;;;;;;;;;;AAkBA,MAAIgB,SAASzmI,IAAb;AACA,MAAI0mI,UAAUjnI,MAAd;AACA,MAAIknI,iBAAiBtzE,cAArB;AACA,MAAIuzE,YAAY,IAAI9hF,IAAJ,CAAS;AACvBxtB,WAAO;AACL9zB,SAAG,CAAC,CADC;AAELC,SAAG,CAAC,CAFC;AAGLif,aAAO,CAHF;AAILC,cAAQ;AAJH;AADgB,GAAT,CAAhB;AAQA8zE,sBAAoB;AAClBh2F,UAAM,SADY;AAElBkrC,UAAM,cAAU0C,OAAV,EAAmBg7B,GAAnB,EAAwB;AAC5B,UAAI3uE,MAAMX,IAAV,EAAgB;AACd;AACD;;AAED,UAAI8sI,iBAAiB,IAAItB,cAAJ,CAAmBl8D,IAAI4kB,MAAJ,EAAnB,EAAiC5kB,GAAjC,CAArB;AACA,WAAKy9D,eAAL,GAAuBD,cAAvB;AACD,KATiB;AAUlB5pD,YAAQ,gBAAU43C,YAAV,EAAwBxmF,OAAxB,EAAiCg7B,GAAjC,EAAsC;AAC5C,UAAI3uE,MAAMX,IAAN,IAAcW,MAAMV,GAAxB,EAA6B;AAC3B;AACD,OAH2C,CAG1C;;;AAGF,WAAK2+D,KAAL,CAAW1zC,SAAX;AACA;;;;;AAKA,WAAK8hH,aAAL,GAAqBlS,YAArB;AACA;;;;;AAKA,WAAKmS,QAAL,GAAgB34F,OAAhB;AACA;;;;;AAKA,WAAK82B,IAAL,GAAYkE,GAAZ;AACA;;;;;;AAMA,WAAK49D,mBAAL,GAA2B,IAA3B;AACA;;;;;AAKA,WAAKC,kBAAL,GAA0BrS,aAAatyH,GAAb,CAAiB,mBAAjB,CAA1B;AACA,UAAIskI,iBAAiB,KAAKC,eAA1B;AACAD,qBAAenlH,MAAf;AACAmlH,qBAAeV,YAAf,CAA4BtR,aAAatyH,GAAb,CAAiB,WAAjB,CAA5B;;AAEA,WAAK4kI,mBAAL;;AAEA,WAAKC,SAAL;AACD,KAvDiB;AAwDlBD,yBAAqB,+BAAY;AAC/B,UAAItS,eAAe,KAAKkS,aAAxB;AACA,UAAI5J,YAAYtI,aAAatyH,GAAb,CAAiB,WAAjB,CAAhB;AACAmnE,eAAS,aAAT,EAAwB,KAAKvE,IAA7B,EAAmCshE,OAAO,UAAU1M,WAAV,EAAuBh0H,CAAvB,EAA0BurF,cAA1B,EAA0C;AAClF;AACA,YAAI6rC,cAAc,MAAlB,EAA0B;AACxB,cAAIA,UAAUv+H,OAAV,CAAkBm7H,WAAlB,KAAkC,CAAtC,EAAyC;AACvC,iBAAKsN,QAAL,CAActhI,CAAd,EAAiBurF,cAAjB;AACD,WAFD,MAEO,IAAIyoC,gBAAgB,OAApB,EAA6B;AAClC,iBAAKuN,KAAL,CAAWh2C,cAAX;AACD;AACF;AACF,OATkC,EAShC,IATgC,CAAnC;AAUD,KArEiB;AAsElB81C,eAAW,qBAAY;AACrB,UAAIvS,eAAe,KAAKkS,aAAxB;AACA,UAAI14F,UAAU,KAAK24F,QAAnB;AACA,UAAI39D,MAAM,KAAKlE,IAAf,CAHqB,CAGA;;AAErB,UAAI,KAAKv7D,MAAL,IAAe,IAAf,IAAuB,KAAKC,MAAL,IAAe,IAAtC,CAA2C;AAC/C;AACA;AAFI,SAGDgrH,aAAatyH,GAAb,CAAiB,WAAjB,MAAkC,MAHrC,EAG6C;AAC3C,YAAIlI,OAAO,IAAX;AACA2uC,qBAAa,KAAKu+F,qBAAlB;AACA,aAAKA,qBAAL,GAA6Bz1G,WAAW,YAAY;AAClD;AACA;AACA;AACAz3B,eAAKmtI,eAAL,CAAqB3S,YAArB,EAAmCxmF,OAAnC,EAA4Cg7B,GAA5C,EAAiD;AAC/C7lE,eAAGnJ,KAAKuP,MADuC;AAE/CnG,eAAGpJ,KAAKwP;AAFuC,WAAjD;AAID,SAR4B,CAA7B;AASD;AACF,KA3FiB;;AA6FlB;;;;;;;;;;;;;;;;AAgBA29H,qBAAiB,yBAAU3S,YAAV,EAAwBxmF,OAAxB,EAAiCg7B,GAAjC,EAAsC17B,OAAtC,EAA+C;AAC9D,UAAIA,QAAQjwC,IAAR,KAAiB,KAAK89D,GAAtB,IAA6B9gE,MAAMX,IAAvC,EAA6C;AAC3C;AACD;;AAED,UAAIu3F,iBAAiBm2C,qBAAqB95F,OAArB,EAA8B07B,GAA9B,CAArB,CAL8D,CAKL;;AAEzD,WAAKq+D,OAAL,GAAe,EAAf,CAP8D,CAO3C;;AAEnB,UAAIpN,iBAAiB3sF,QAAQ2sF,cAA7B;;AAEA,UAAI3sF,QAAQsiC,OAAR,IAAmBtiC,QAAQnqC,CAAR,IAAa,IAAhC,IAAwCmqC,QAAQlqC,CAAR,IAAa,IAAzD,EAA+D;AAC7D,YAAI0H,KAAKy7H,SAAT;AACAz7H,WAAG0D,QAAH,GAAc,CAAC8+B,QAAQnqC,CAAT,EAAYmqC,QAAQlqC,CAApB,CAAd;AACA0H,WAAGuW,MAAH;AACAvW,WAAG8kE,OAAH,GAAatiC,QAAQsiC,OAArB,CAJ6D,CAI/B;;AAE9B,aAAKo3D,QAAL,CAAc;AACZhhI,mBAASsnC,QAAQnqC,CADL;AAEZ+C,mBAASonC,QAAQlqC,CAFL;AAGZ1F,kBAAQoN;AAHI,SAAd,EAIGmmF,cAJH;AAKD,OAXD,MAWO,IAAIgpC,cAAJ,EAAoB;AACzB,aAAK+M,QAAL,CAAc;AACZhhI,mBAASsnC,QAAQnqC,CADL;AAEZ+C,mBAASonC,QAAQlqC,CAFL;AAGZoL,oBAAU8+B,QAAQ9+B,QAHN;AAIZnI,iBAAO,EAJK;AAKZ4zH,0BAAgB3sF,QAAQ2sF,cALZ;AAMZsC,yBAAejvF,QAAQivF;AANX,SAAd,EAOGtrC,cAPH;AAQD,OATM,MASA,IAAI3jD,QAAQ65B,WAAR,IAAuB,IAA3B,EAAiC;AACtC,YAAI,KAAKmgE,oBAAL,CAA0B9S,YAA1B,EAAwCxmF,OAAxC,EAAiDg7B,GAAjD,EAAsD17B,OAAtD,CAAJ,EAAoE;AAClE;AACD;;AAED,YAAIi6F,YAAYlO,oBAAoB/rF,OAApB,EAA6BU,OAA7B,CAAhB;AACA,YAAI8L,KAAKytF,UAAUzjF,KAAV,CAAgB,CAAhB,CAAT;AACA,YAAI/J,KAAKwtF,UAAUzjF,KAAV,CAAgB,CAAhB,CAAT;;AAEA,YAAIhK,MAAM,IAAN,IAAcC,MAAM,IAAxB,EAA8B;AAC5B,eAAKitF,QAAL,CAAc;AACZhhI,qBAAS8zC,EADG;AAEZ5zC,qBAAS6zC,EAFG;AAGZvrC,sBAAU8+B,QAAQ9+B,QAHN;AAIZ9Q,oBAAQ6pI,UAAUz8H,EAJN;AAKZzE,mBAAO;AALK,WAAd,EAMG4qF,cANH;AAOD;AACF,OAlBM,MAkBA,IAAI3jD,QAAQnqC,CAAR,IAAa,IAAb,IAAqBmqC,QAAQlqC,CAAR,IAAa,IAAtC,EAA4C;AACjD;AACA;AACA4lE,YAAIioB,cAAJ,CAAmB;AACjB7wF,gBAAM,mBADW;AAEjB+C,aAAGmqC,QAAQnqC,CAFM;AAGjBC,aAAGkqC,QAAQlqC;AAHM,SAAnB;;AAMA,aAAK4jI,QAAL,CAAc;AACZhhI,mBAASsnC,QAAQnqC,CADL;AAEZ+C,mBAASonC,QAAQlqC,CAFL;AAGZoL,oBAAU8+B,QAAQ9+B,QAHN;AAIZ9Q,kBAAQsrE,IAAI6kB,KAAJ,GAAYnnF,SAAZ,CAAsB4mC,QAAQnqC,CAA9B,EAAiCmqC,QAAQlqC,CAAzC,EAA4C1F,MAJxC;AAKZ2I,iBAAO;AALK,SAAd,EAMG4qF,cANH;AAOD;AACF,KA/KiB;AAgLlBu2C,qBAAiB,yBAAUhT,YAAV,EAAwBxmF,OAAxB,EAAiCg7B,GAAjC,EAAsC17B,OAAtC,EAA+C;AAC9D,UAAIk5F,iBAAiB,KAAKC,eAA1B;;AAEA,UAAI,CAAC,KAAKI,kBAAN,IAA4B,KAAKH,aAArC,EAAoD;AAClDF,uBAAed,SAAf,CAAyB,KAAKgB,aAAL,CAAmBxkI,GAAnB,CAAuB,WAAvB,CAAzB;AACD;;AAED,WAAKqH,MAAL,GAAc,KAAKC,MAAL,GAAc,IAA5B;;AAEA,UAAI8jC,QAAQjwC,IAAR,KAAiB,KAAK89D,GAA1B,EAA+B;AAC7B,aAAK8rE,KAAL,CAAWG,qBAAqB95F,OAArB,EAA8B07B,GAA9B,CAAX;AACD;AACF,KA5LiB;AA6LlB;AACA;AACA;AACAs+D,0BAAsB,8BAAU9S,YAAV,EAAwBxmF,OAAxB,EAAiCg7B,GAAjC,EAAsC17B,OAAtC,EAA+C;AACnE,UAAI65B,cAAc75B,QAAQ65B,WAA1B;AACA,UAAI35B,YAAYF,QAAQE,SAAxB;AACA,UAAI29E,mBAAmBn9E,QAAQqxB,YAAR,CAAqB,aAArB,EAAoC8rD,gBAA3D;;AAEA,UAAIhkD,eAAe,IAAf,IAAuB35B,aAAa,IAApC,IAA4C29E,oBAAoB,IAApE,EAA0E;AACxE;AACD;;AAED,UAAIptD,cAAc/vB,QAAQk5B,gBAAR,CAAyBC,WAAzB,CAAlB;;AAEA,UAAI,CAACpJ,WAAL,EAAkB;AAChB;AACD;;AAED,UAAI5+D,OAAO4+D,YAAY2S,OAAZ,EAAX;AACA,UAAI8jD,eAAeiT,kBAAkB,CAACtoI,KAAKq2E,YAAL,CAAkBhoC,SAAlB,CAAD,EAA+BuwB,WAA/B,EAA4C,CAACA,YAAYqb,gBAAZ,IAAgC,EAAjC,EAAqC/nC,KAAjF,EAAwFmjF,YAAxF,CAAlB,CAAnB;;AAEA,UAAIA,aAAatyH,GAAb,CAAiB,SAAjB,MAAgC,MAApC,EAA4C;AAC1C;AACD;;AAED8mE,UAAIioB,cAAJ,CAAmB;AACjB7wF,cAAM,mBADW;AAEjB+mE,qBAAaA,WAFI;AAGjB35B,mBAAWA,SAHM;AAIjBh/B,kBAAU8+B,QAAQ9+B;AAJD,OAAnB;AAMA,aAAO,IAAP;AACD,KA7NiB;AA8NlBw4H,cAAU,kBAAUthI,CAAV,EAAaurF,cAAb,EAA6B;AACrC,UAAInmF,KAAKpF,EAAEhI,MAAX;AACA,UAAI82H,eAAe,KAAKkS,aAAxB;;AAEA,UAAI,CAAClS,YAAL,EAAmB;AACjB;AACD,OANoC,CAMnC;;;AAGF,WAAKjrH,MAAL,GAAc7D,EAAEM,OAAhB;AACA,WAAKwD,MAAL,GAAc9D,EAAEQ,OAAhB;AACA,UAAI+zH,iBAAiBv0H,EAAEu0H,cAAvB;;AAEA,UAAIA,kBAAkBA,eAAe/8H,MAArC,EAA6C;AAC3C,aAAKwqI,gBAAL,CAAsBzN,cAAtB,EAAsCv0H,CAAtC;AACD,OAFD,CAEE;AAFF,WAGK,IAAIoF,MAAMA,GAAG0iC,SAAH,IAAgB,IAA1B,EAAgC;AACjC,eAAKo5F,mBAAL,GAA2B,IAA3B;;AAEA,eAAKe,sBAAL,CAA4BjiI,CAA5B,EAA+BoF,EAA/B,EAAmCmmF,cAAnC;AACD,SAJE,CAID;AAJC,aAKE,IAAInmF,MAAMA,GAAG8kE,OAAb,EAAsB;AACvB,iBAAKg3D,mBAAL,GAA2B,IAA3B;;AAEA,iBAAKgB,yBAAL,CAA+BliI,CAA/B,EAAkCoF,EAAlC,EAAsCmmF,cAAtC;AACD,WAJE,MAII;AACL,iBAAK21C,mBAAL,GAA2B,IAA3B;;AAEA,iBAAKK,KAAL,CAAWh2C,cAAX;AACD;AACN,KA5PiB;AA6PlB42C,iBAAa,qBAAUrT,YAAV,EAAwBl1H,EAAxB,EAA4B;AACvC;AACA;AACA;AACA;AACA,UAAImT,QAAQ+hH,aAAatyH,GAAb,CAAiB,WAAjB,CAAZ;AACA5C,WAAKK,KAAKL,EAAL,EAAS,IAAT,CAAL;AACAqpC,mBAAa,KAAKm/F,WAAlB;AACAr1H,cAAQ,CAAR,GAAY,KAAKq1H,WAAL,GAAmBr2G,WAAWnyB,EAAX,EAAemT,KAAf,CAA/B,GAAuDnT,IAAvD;AACD,KAtQiB;AAuQlBooI,sBAAkB,0BAAUzN,cAAV,EAA0Bv0H,CAA1B,EAA6B;AAC7C,UAAIsoC,UAAU,KAAK24F,QAAnB;AACA,UAAIpb,qBAAqB,KAAKmb,aAA9B;AACA,UAAI5iF,QAAQ,CAACp+C,EAAEM,OAAH,EAAYN,EAAEQ,OAAd,CAAZ;AACA,UAAI6hI,oBAAoB,EAAxB;AACA,UAAIC,mBAAmB,EAAvB;AACA,UAAIC,qBAAqBR,kBAAkB,CAAC/hI,EAAE62H,aAAH,EAAkBhR,kBAAlB,CAAlB,CAAzB;AACA8a,cAAQpM,cAAR,EAAwB,UAAUiO,YAAV,EAAwB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA7B,gBAAQ6B,aAAajM,UAArB,EAAiC,UAAUlvF,IAAV,EAAgB;AAC/C,cAAI0yB,YAAYzxB,QAAQqxB,YAAR,CAAqBtyB,KAAK2yB,OAAL,GAAe,MAApC,EAA4C3yB,KAAKyyB,SAAjD,CAAhB;AACA,cAAI2oE,YAAYp7F,KAAKtuC,KAArB;AACA,cAAI2pI,oBAAoB,EAAxB;;AAEA,cAAI,CAAC3oE,SAAD,IAAc0oE,aAAa,IAA/B,EAAqC;AACnC;AACD;;AAED,cAAIE,aAAalG,cAAcgG,SAAd,EAAyB1oE,UAAUyrC,IAAnC,EAAyCl9D,OAAzC,EAAkDjB,KAAKqvF,iBAAvD,EAA0ErvF,KAAKovF,aAA/E,CAAjB;AACA/8H,iBAAO2tC,KAAKqvF,iBAAZ,EAA+B,UAAUuG,OAAV,EAAmB;AAChD,gBAAI37D,SAASh5B,QAAQk5B,gBAAR,CAAyBy7D,QAAQx7D,WAAjC,CAAb;AACA,gBAAI35B,YAAYm1F,QAAQp1F,eAAxB;AACA,gBAAIq1F,aAAa57D,UAAUA,OAAO2N,aAAP,CAAqBnnC,SAArB,CAA3B;AACAo1F,uBAAWljE,OAAX,GAAqB3yB,KAAK2yB,OAA1B;AACAkjE,uBAAWpjE,SAAX,GAAuBzyB,KAAKyyB,SAA5B;AACAojE,uBAAWlpC,QAAX,GAAsB3sD,KAAK2sD,QAA3B;AACAkpC,uBAAW1G,MAAX,GAAoBnvF,KAAKmvF,MAAzB;AACA0G,uBAAWuF,SAAX,GAAuBj1B,gBAAgBzzC,UAAUyrC,IAA1B,EAAgCi9B,SAAhC,CAAvB;AACAvF,uBAAW0F,cAAX,GAA4BD,UAA5B;;AAEA,gBAAIzF,UAAJ,EAAgB;AACdoF,+BAAiBxoI,IAAjB,CAAsBojI,UAAtB;AACAwF,gCAAkB5oI,IAAlB,CAAuBwnE,OAAO0O,aAAP,CAAqBloC,SAArB,EAAgC,IAAhC,CAAvB;AACD;AACF,WAfD,EAV+C,CAyB3C;AACJ;AACA;AACA;;AAEA,cAAI+6F,YAAYF,UAAhB;AACAN,4BAAkBvoI,IAAlB,CAAuB,CAAC+oI,YAAY7xE,WAAW6xE,SAAX,IAAwB,QAApC,GAA+C,EAAhD,IAAsDH,kBAAkBrsH,IAAlB,CAAuB,QAAvB,CAA7E;AACD,SAhCD;AAiCD,OA5CD,EA4CG,IA5CH,EAP6C,CAmDnC;;AAEVgsH,wBAAkBt9B,OAAlB;AACAs9B,0BAAoBA,kBAAkBhsH,IAAlB,CAAuB,cAAvB,CAApB;AACA,UAAIysH,eAAe9iI,EAAE8I,QAArB;;AAEA,WAAKq5H,WAAL,CAAiBI,kBAAjB,EAAqC,YAAY;AAC/C,YAAI,KAAKQ,8BAAL,CAAoCxO,cAApC,CAAJ,EAAyD;AACvD,eAAKyO,eAAL,CAAqBT,kBAArB,EAAyCO,YAAzC,EAAuD1kF,MAAM,CAAN,CAAvD,EAAiEA,MAAM,CAAN,CAAjE,EAA2E,KAAK2iF,eAAhF,EAAiGuB,gBAAjG;AACD,SAFD,MAEO;AACL,eAAKW,mBAAL,CAAyBV,kBAAzB,EAA6CF,iBAA7C,EAAgEC,gBAAhE,EAAkFlkI,KAAKg7B,MAAL,EAAlF,EAAiGglB,MAAM,CAAN,CAAjG,EAA2GA,MAAM,CAAN,CAA3G,EAAqH0kF,YAArH;AACD;AACF,OAND,EAzD6C,CA+DzC;AACJ;AAED,KAzUiB;AA0UlBb,4BAAwB,gCAAUjiI,CAAV,EAAaoF,EAAb,EAAiBmmF,cAAjB,EAAiC;AACvD,UAAIjjD,UAAU,KAAK24F,QAAnB,CADuD,CAC1B;AAC7B;AACA;;AAEA,UAAIx/D,cAAcr8D,GAAGq8D,WAArB;AACA,UAAIpJ,cAAc/vB,QAAQk5B,gBAAR,CAAyBC,WAAzB,CAAlB,CANuD,CAME;;AAEzD,UAAI8rB,YAAYnoF,GAAGmoF,SAAH,IAAgBl1B,WAAhC;AACA,UAAIvwB,YAAY1iC,GAAG0iC,SAAnB;AACA,UAAIonC,WAAW9pE,GAAG8pE,QAAlB;AACA,UAAIz1E,OAAO8zF,UAAUviB,OAAV,EAAX;AACA,UAAI8jD,eAAeiT,kBAAkB,CAACtoI,KAAKq2E,YAAL,CAAkBhoC,SAAlB,CAAD,EAA+BylD,SAA/B,EAA0Cl1B,eAAe,CAACA,YAAYqb,gBAAZ,IAAgC,EAAjC,EAAqC/nC,KAA9F,EAAqG,KAAKq1F,aAA1G,CAAlB,CAAnB;AACA,UAAIkC,iBAAiBpU,aAAatyH,GAAb,CAAiB,SAAjB,CAArB;;AAEA,UAAI0mI,kBAAkB,IAAlB,IAA0BA,mBAAmB,MAAjD,EAAyD;AACvD;AACD;;AAED,UAAIrxH,SAAS07E,UAAUte,aAAV,CAAwBnnC,SAAxB,EAAmConC,QAAnC,CAAb;AACA,UAAIi0D,cAAc51C,UAAUvd,aAAV,CAAwBloC,SAAxB,EAAmC,KAAnC,EAA0ConC,QAA1C,CAAlB;AACA,UAAIk0D,cAAc,UAAU71C,UAAU12F,IAApB,GAA2B,GAA3B,GAAiCixC,SAAnD;;AAEA,WAAKq6F,WAAL,CAAiBrT,YAAjB,EAA+B,YAAY;AACzC,aAAKmU,mBAAL,CAAyBnU,YAAzB,EAAuCqU,WAAvC,EAAoDtxH,MAApD,EAA4DuxH,WAA5D,EAAyEpjI,EAAEM,OAA3E,EAAoFN,EAAEQ,OAAtF,EAA+FR,EAAE8I,QAAjG,EAA2G9I,EAAEhI,MAA7G;AACD,OAFD,EAvBuD,CAyBnD;AACJ;;;AAGAuzF,qBAAe;AACb7wF,cAAM,SADO;AAEbmtC,yBAAiBC,SAFJ;AAGbA,mBAAWruC,KAAKyyE,WAAL,CAAiBpkC,SAAjB,CAHE;AAIb25B,qBAAaA,WAJA;AAKb9pE,cAAM,KAAK89D;AALE,OAAf;AAOD,KA9WiB;AA+WlBysE,+BAA2B,mCAAUliI,CAAV,EAAaoF,EAAb,EAAiBmmF,cAAjB,EAAiC;AAC1D,UAAI23B,aAAa99G,GAAG8kE,OAApB;;AAEA,UAAI,OAAOg5C,UAAP,KAAsB,QAA1B,EAAoC;AAClC,YAAIK,UAAUL,UAAd;AACAA,qBAAa;AACXK,mBAASA,OADE;AAEX;AACAxzC,qBAAWwzC;AAHA,SAAb;AAKD;;AAED,UAAI8f,kBAAkB,IAAIt5E,KAAJ,CAAUm5D,UAAV,EAAsB,KAAK8d,aAA3B,EAA0C,KAAKC,QAA/C,CAAtB;AACA,UAAIkC,cAAcE,gBAAgB7mI,GAAhB,CAAoB,SAApB,CAAlB;AACA,UAAI4mI,cAAchlI,KAAKg7B,MAAL,EAAlB,CAd0D,CAczB;AACjC;AACA;;AAEA,WAAK+oG,WAAL,CAAiBkB,eAAjB,EAAkC,YAAY;AAC5C,aAAKJ,mBAAL,CAAyBI,eAAzB,EAA0CF,WAA1C,EAAuDE,gBAAgB7mI,GAAhB,CAAoB,iBAApB,KAA0C,EAAjG,EAAqG4mI,WAArG,EAAkHpjI,EAAEM,OAApH,EAA6HN,EAAEQ,OAA/H,EAAwIR,EAAE8I,QAA1I,EAAoJ1D,EAApJ;AACD,OAFD,EAlB0D,CAoBtD;;;AAGJmmF,qBAAe;AACb7wF,cAAM,SADO;AAEb/C,cAAM,KAAK89D;AAFE,OAAf;AAID,KA1YiB;AA2YlBwtE,yBAAqB,6BAAUnU,YAAV,EAAwBqU,WAAxB,EAAqCtxH,MAArC,EAA6CuxH,WAA7C,EAA0D3lI,CAA1D,EAA6DC,CAA7D,EAAgEolI,YAAhE,EAA8E19H,EAA9E,EAAkF;AACrG;AACA,WAAKu8H,OAAL,GAAe,EAAf;;AAEA,UAAI,CAAC7S,aAAatyH,GAAb,CAAiB,aAAjB,CAAD,IAAoC,CAACsyH,aAAatyH,GAAb,CAAiB,MAAjB,CAAzC,EAAmE;AACjE;AACD;;AAED,UAAIskI,iBAAiB,KAAKC,eAA1B;AACA,UAAIhxD,YAAY++C,aAAatyH,GAAb,CAAiB,WAAjB,CAAhB;AACAsmI,qBAAeA,gBAAgBhU,aAAatyH,GAAb,CAAiB,UAAjB,CAA/B;AACA,UAAI8mI,OAAOH,WAAX;;AAEA,UAAIpzD,aAAa,OAAOA,SAAP,KAAqB,QAAtC,EAAgD;AAC9CuzD,eAAOjyE,UAAU0e,SAAV,EAAqBl+D,MAArB,EAA6B,IAA7B,CAAP;AACD,OAFD,MAEO,IAAI,OAAOk+D,SAAP,KAAqB,UAAzB,EAAqC;AAC1C,YAAI72D,WAAWwnH,OAAO,UAAU6C,QAAV,EAAoBD,IAApB,EAA0B;AAC9C,cAAIC,aAAa,KAAK5B,OAAtB,EAA+B;AAC7Bb,2BAAeX,UAAf,CAA0BmD,IAA1B;;AAEA,iBAAKN,eAAL,CAAqBlU,YAArB,EAAmCgU,YAAnC,EAAiDrlI,CAAjD,EAAoDC,CAApD,EAAuDojI,cAAvD,EAAuEjvH,MAAvE,EAA+EzM,EAA/E;AACD;AACF,SANc,EAMZ,IANY,CAAf;AAOA,aAAKu8H,OAAL,GAAeyB,WAAf;AACAE,eAAOvzD,UAAUl+D,MAAV,EAAkBuxH,WAAlB,EAA+BlqH,QAA/B,CAAP;AACD;;AAED4nH,qBAAeX,UAAf,CAA0BmD,IAA1B;AACAxC,qBAAe9kH,IAAf,CAAoB8yG,YAApB;;AAEA,WAAKkU,eAAL,CAAqBlU,YAArB,EAAmCgU,YAAnC,EAAiDrlI,CAAjD,EAAoDC,CAApD,EAAuDojI,cAAvD,EAAuEjvH,MAAvE,EAA+EzM,EAA/E;AACD,KA1aiB;;AA4alB;;;;;;;;;;AAUA49H,qBAAiB,yBAAUlU,YAAV,EAAwBgU,YAAxB,EAAsCrlI,CAAtC,EAAyCC,CAAzC,EAA4C6lH,OAA5C,EAAqD1xG,MAArD,EAA6DzM,EAA7D,EAAiE;AAChF,UAAI03H,YAAY,KAAK19D,IAAL,CAAUz1C,QAAV,EAAhB;;AAEA,UAAIozG,aAAa,KAAK39D,IAAL,CAAUx1C,SAAV,EAAjB;;AAEAk5G,qBAAeA,gBAAgBhU,aAAatyH,GAAb,CAAiB,UAAjB,CAA/B;AACA,UAAIgnI,cAAcjgB,QAAQ8c,OAAR,EAAlB;AACA,UAAI3T,QAAQoC,aAAatyH,GAAb,CAAiB,OAAjB,CAAZ;AACA,UAAIinI,SAAS3U,aAAatyH,GAAb,CAAiB,eAAjB,CAAb;AACA,UAAIuhB,OAAO3Y,MAAMA,GAAGga,eAAH,GAAqBpoB,KAArB,EAAjB;AACAoO,YAAM2Y,KAAKze,cAAL,CAAoB8F,GAAG8D,SAAvB,CAAN;;AAEA,UAAI,OAAO45H,YAAP,KAAwB,UAA5B,EAAwC;AACtC;AACAA,uBAAeA,aAAa,CAACrlI,CAAD,EAAIC,CAAJ,CAAb,EAAqBmU,MAArB,EAA6B0xG,QAAQn+G,EAArC,EAAyC2Y,IAAzC,EAA+C;AAC5D2lH,oBAAU,CAAC5G,SAAD,EAAYC,UAAZ,CADkD;AAE5DyG,uBAAaA,YAAYltI,KAAZ;AAF+C,SAA/C,CAAf;AAID;;AAED,UAAI+B,QAAQyqI,YAAR,CAAJ,EAA2B;AACzBrlI,YAAImjI,eAAekC,aAAa,CAAb,CAAf,EAAgChG,SAAhC,CAAJ;AACAp/H,YAAIkjI,eAAekC,aAAa,CAAb,CAAf,EAAgC/F,UAAhC,CAAJ;AACD,OAHD,MAGO,IAAI7kI,WAAW4qI,YAAX,CAAJ,EAA8B;AACnCA,qBAAanmH,KAAb,GAAqB6mH,YAAY,CAAZ,CAArB;AACAV,qBAAalmH,MAAb,GAAsB4mH,YAAY,CAAZ,CAAtB;AACA,YAAI9X,aAAaj4D,cAAcqvE,YAAd,EAA4B;AAC3CnmH,iBAAOmgH,SADoC;AAE3ClgH,kBAAQmgH;AAFmC,SAA5B,CAAjB;AAIAt/H,YAAIiuH,WAAWjuH,CAAf;AACAC,YAAIguH,WAAWhuH,CAAf;AACAgvH,gBAAQ,IAAR,CATmC,CASrB;AACd;;AAEA+W,iBAAS,IAAT;AACD,OAbM,CAaL;AAbK,WAcF,IAAI,OAAOX,YAAP,KAAwB,QAAxB,IAAoC19H,EAAxC,EAA4C;AAC7C,cAAIi8B,MAAMsiG,oBAAoBb,YAApB,EAAkC/kH,IAAlC,EAAwCylH,WAAxC,CAAV;AACA/lI,cAAI4jC,IAAI,CAAJ,CAAJ;AACA3jC,cAAI2jC,IAAI,CAAJ,CAAJ;AACD,SAJE,MAII;AACL,cAAIA,MAAMuiG,qBAAqBnmI,CAArB,EAAwBC,CAAxB,EAA2B6lH,QAAQn+G,EAAnC,EAAuC03H,SAAvC,EAAkDC,UAAlD,EAA8DrQ,QAAQ,IAAR,GAAe,EAA7E,EAAiF+W,SAAS,IAAT,GAAgB,EAAjG,CAAV;AACAhmI,cAAI4jC,IAAI,CAAJ,CAAJ;AACA3jC,cAAI2jC,IAAI,CAAJ,CAAJ;AACD;;AAEHqrF,gBAAUjvH,KAAKomI,cAAcnX,KAAd,IAAuB8W,YAAY,CAAZ,IAAiB,CAAxC,GAA4C9W,UAAU,OAAV,GAAoB8W,YAAY,CAAZ,CAApB,GAAqC,CAAhG;AACAC,iBAAW/lI,KAAKmmI,cAAcJ,MAAd,IAAwBD,YAAY,CAAZ,IAAiB,CAAzC,GAA6CC,WAAW,QAAX,GAAsBD,YAAY,CAAZ,CAAtB,GAAuC,CAApG;;AAEA,UAAI1U,aAAatyH,GAAb,CAAiB,SAAjB,CAAJ,EAAiC;AAC/B,YAAI6kC,MAAMyiG,uBAAuBrmI,CAAvB,EAA0BC,CAA1B,EAA6B6lH,QAAQn+G,EAArC,EAAyC03H,SAAzC,EAAoDC,UAApD,CAAV;AACAt/H,YAAI4jC,IAAI,CAAJ,CAAJ;AACA3jC,YAAI2jC,IAAI,CAAJ,CAAJ;AACD;;AAEDkiF,cAAQ1xF,MAAR,CAAep0B,CAAf,EAAkBC,CAAlB;AACD,KA/eiB;AAgflB;AACA;AACAqlI,oCAAgC,wCAAUxO,cAAV,EAA0B;AACxD,UAAIwP,eAAe,KAAK7C,mBAAxB;AACA,UAAI8C,oBAAoB,CAAC,CAACD,YAAF,IAAkBA,aAAavsI,MAAb,KAAwB+8H,eAAe/8H,MAAjF;AACAwsI,2BAAqBrD,QAAQoD,YAAR,EAAsB,UAAUE,gBAAV,EAA4BC,aAA5B,EAA2C;AACpF,YAAIC,iBAAiBF,iBAAiB1N,UAAjB,IAA+B,EAApD;AACA,YAAI6N,mBAAmB7P,eAAe2P,aAAf,KAAiC,EAAxD;AACA,YAAIG,iBAAiBD,iBAAiB7N,UAAjB,IAA+B,EAApD;AACAyN,6BAAqBG,eAAe3sI,MAAf,KAA0B6sI,eAAe7sI,MAA9D;AACAwsI,6BAAqBrD,QAAQwD,cAAR,EAAwB,UAAUG,QAAV,EAAoBC,SAApB,EAA+B;AAC1E,cAAIh4E,WAAW83E,eAAeE,SAAf,KAA6B,EAA5C;AACA,cAAIC,cAAcF,SAAS5N,iBAAT,IAA8B,EAAhD;AACA,cAAIp9B,aAAa/sC,SAASmqE,iBAAT,IAA8B,EAA/C;AACAsN,+BAAqBM,SAASvrI,KAAT,KAAmBwzD,SAASxzD,KAA5B,IAAqCurI,SAAStwC,QAAT,KAAsBznC,SAASynC,QAApE,IAAgFswC,SAAS9N,MAAT,KAAoBjqE,SAASiqE,MAA7G,IAAuHgO,YAAYhtI,MAAZ,KAAuB8hG,WAAW9hG,MAA9K;AACAwsI,+BAAqBrD,QAAQ6D,WAAR,EAAqB,UAAUC,WAAV,EAAuBvvH,CAAvB,EAA0B;AAClE,gBAAIwvH,aAAaprC,WAAWpkF,CAAX,CAAjB;AACA8uH,iCAAqBS,YAAYhjE,WAAZ,KAA4BijE,WAAWjjE,WAAvC,IAAsDgjE,YAAY38F,SAAZ,KAA0B48F,WAAW58F,SAAhH;AACD,WAHoB,CAArB;AAID,SAToB,CAArB;AAUD,OAfoB,CAArB;AAgBA,WAAKo5F,mBAAL,GAA2B3M,cAA3B;AACA,aAAO,CAAC,CAACyP,iBAAT;AACD,KAvgBiB;AAwgBlBzC,WAAO,eAAUh2C,cAAV,EAA0B;AAC/B;AACA;AACA;AACA;AACA,WAAK21C,mBAAL,GAA2B,IAA3B;AACA31C,qBAAe;AACb7wF,cAAM,SADO;AAEb/C,cAAM,KAAK89D;AAFE,OAAf;AAID,KAlhBiB;AAmhBlBryD,aAAS,iBAAUklC,OAAV,EAAmBg7B,GAAnB,EAAwB;AAC/B,UAAI3uE,MAAMX,IAAN,IAAcW,MAAMV,GAAxB,EAA6B;AAC3B;AACD;;AAED,WAAK8sI,eAAL,CAAqBjlH,IAArB;;AAEA08G,iBAAW,aAAX,EAA0Bl1D,GAA1B;AACD;AA3hBiB,GAApB;AA6hBA;;;;;AAKA,WAASy+D,iBAAT,CAA2B4C,YAA3B,EAAyC;AACvC,QAAIC,cAAcD,aAAa3yH,GAAb,EAAlB;;AAEA,WAAO2yH,aAAantI,MAApB,EAA4B;AAC1B,UAAI0rH,aAAayhB,aAAa3yH,GAAb,EAAjB;;AAEA,UAAIkxG,UAAJ,EAAgB;AACd,YAAIn5D,MAAM3f,UAAN,CAAiB84E,UAAjB,CAAJ,EAAkC;AAChCA,uBAAaA,WAAW1mH,GAAX,CAAe,SAAf,EAA0B,IAA1B,CAAb;AACD,SAHa,CAGZ;AACF;AACA;AACA;AACA;;;AAGA,YAAI,OAAO0mH,UAAP,KAAsB,QAA1B,EAAoC;AAClCA,uBAAa;AACXnzC,uBAAWmzC;AADA,WAAb;AAGD;;AAED0hB,sBAAc,IAAI76E,KAAJ,CAAUm5D,UAAV,EAAsB0hB,WAAtB,EAAmCA,YAAYt8F,OAA/C,CAAd;AACD;AACF;;AAED,WAAOs8F,WAAP;AACD;;AAED,WAASlD,oBAAT,CAA8B95F,OAA9B,EAAuC07B,GAAvC,EAA4C;AAC1C,WAAO17B,QAAQ2jD,cAAR,IAA0BtxF,KAAKqpE,IAAIioB,cAAT,EAAyBjoB,GAAzB,CAAjC;AACD;;AAED,WAASsgE,oBAAT,CAA8BnmI,CAA9B,EAAiCC,CAAjC,EAAoC0H,EAApC,EAAwC03H,SAAxC,EAAmDC,UAAnD,EAA+D8H,IAA/D,EAAqEC,IAArE,EAA2E;AACzE,QAAI/8B,OAAOg9B,aAAa3/H,EAAb,CAAX;AACA,QAAIuX,QAAQorF,KAAKprF,KAAjB;AACA,QAAIC,SAASmrF,KAAKnrF,MAAlB;;AAEA,QAAIioH,QAAQ,IAAZ,EAAkB;AAChB,UAAIpnI,IAAIkf,KAAJ,GAAYkoH,IAAZ,GAAmB/H,SAAvB,EAAkC;AAChCr/H,aAAKkf,QAAQkoH,IAAb;AACD,OAFD,MAEO;AACLpnI,aAAKonI,IAAL;AACD;AACF;;AAED,QAAIC,QAAQ,IAAZ,EAAkB;AAChB,UAAIpnI,IAAIkf,MAAJ,GAAakoH,IAAb,GAAoB/H,UAAxB,EAAoC;AAClCr/H,aAAKkf,SAASkoH,IAAd;AACD,OAFD,MAEO;AACLpnI,aAAKonI,IAAL;AACD;AACF;;AAED,WAAO,CAACrnI,CAAD,EAAIC,CAAJ,CAAP;AACD;;AAED,WAASomI,sBAAT,CAAgCrmI,CAAhC,EAAmCC,CAAnC,EAAsC0H,EAAtC,EAA0C03H,SAA1C,EAAqDC,UAArD,EAAiE;AAC/D,QAAIh1B,OAAOg9B,aAAa3/H,EAAb,CAAX;AACA,QAAIuX,QAAQorF,KAAKprF,KAAjB;AACA,QAAIC,SAASmrF,KAAKnrF,MAAlB;AACAnf,QAAIW,KAAKoB,GAAL,CAAS/B,IAAIkf,KAAb,EAAoBmgH,SAApB,IAAiCngH,KAArC;AACAjf,QAAIU,KAAKoB,GAAL,CAAS9B,IAAIkf,MAAb,EAAqBmgH,UAArB,IAAmCngH,MAAvC;AACAnf,QAAIW,KAAKqB,GAAL,CAAShC,CAAT,EAAY,CAAZ,CAAJ;AACAC,QAAIU,KAAKqB,GAAL,CAAS/B,CAAT,EAAY,CAAZ,CAAJ;AACA,WAAO,CAACD,CAAD,EAAIC,CAAJ,CAAP;AACD;;AAED,WAASqnI,YAAT,CAAsB3/H,EAAtB,EAA0B;AACxB,QAAIuX,QAAQvX,GAAGk7H,WAAf;AACA,QAAI1jH,SAASxX,GAAGm7H,YAAhB,CAFwB,CAEM;AAC9B;;AAEA,QAAIlsI,SAASqpC,WAAT,IAAwBrpC,SAASqpC,WAAT,CAAqBC,gBAAjD,EAAmE;AACjE,UAAIF,MAAMppC,SAASqpC,WAAT,CAAqBC,gBAArB,CAAsCv4B,EAAtC,CAAV;;AAEA,UAAIq4B,GAAJ,EAAS;AACP9gB,iBAASnM,SAASitB,IAAIunG,WAAb,EAA0B,EAA1B,IAAgCx0H,SAASitB,IAAIwnG,YAAb,EAA2B,EAA3B,CAAhC,GAAiEz0H,SAASitB,IAAIynG,eAAb,EAA8B,EAA9B,CAAjE,GAAqG10H,SAASitB,IAAI0nG,gBAAb,EAA+B,EAA/B,CAA9G;AACAvoH,kBAAUpM,SAASitB,IAAI2nG,UAAb,EAAyB,EAAzB,IAA+B50H,SAASitB,IAAI4nG,aAAb,EAA4B,EAA5B,CAA/B,GAAiE70H,SAASitB,IAAI6nG,cAAb,EAA6B,EAA7B,CAAjE,GAAoG90H,SAASitB,IAAI8nG,iBAAb,EAAgC,EAAhC,CAA9G;AACD;AACF;;AAED,WAAO;AACL5oH,aAAOA,KADF;AAELC,cAAQA;AAFH,KAAP;AAID;;AAED,WAAS+mH,mBAAT,CAA6B76H,QAA7B,EAAuCiV,IAAvC,EAA6CylH,WAA7C,EAA0D;AACxD,QAAIgC,WAAWhC,YAAY,CAAZ,CAAf;AACA,QAAIiC,YAAYjC,YAAY,CAAZ,CAAhB;AACA,QAAIt2H,MAAM,CAAV;AACA,QAAIzP,IAAI,CAAR;AACA,QAAIC,IAAI,CAAR;AACA,QAAIgoI,YAAY3nH,KAAKpB,KAArB;AACA,QAAIgpH,aAAa5nH,KAAKnB,MAAtB;;AAEA,YAAQ9T,QAAR;AACE,WAAK,QAAL;AACErL,YAAIsgB,KAAKtgB,CAAL,GAASioI,YAAY,CAArB,GAAyBF,WAAW,CAAxC;AACA9nI,YAAIqgB,KAAKrgB,CAAL,GAASioI,aAAa,CAAtB,GAA0BF,YAAY,CAA1C;AACA;;AAEF,WAAK,KAAL;AACEhoI,YAAIsgB,KAAKtgB,CAAL,GAASioI,YAAY,CAArB,GAAyBF,WAAW,CAAxC;AACA9nI,YAAIqgB,KAAKrgB,CAAL,GAAS+nI,SAAT,GAAqBv4H,GAAzB;AACA;;AAEF,WAAK,QAAL;AACEzP,YAAIsgB,KAAKtgB,CAAL,GAASioI,YAAY,CAArB,GAAyBF,WAAW,CAAxC;AACA9nI,YAAIqgB,KAAKrgB,CAAL,GAASioI,UAAT,GAAsBz4H,GAA1B;AACA;;AAEF,WAAK,MAAL;AACEzP,YAAIsgB,KAAKtgB,CAAL,GAAS+nI,QAAT,GAAoBt4H,GAAxB;AACAxP,YAAIqgB,KAAKrgB,CAAL,GAASioI,aAAa,CAAtB,GAA0BF,YAAY,CAA1C;AACA;;AAEF,WAAK,OAAL;AACEhoI,YAAIsgB,KAAKtgB,CAAL,GAASioI,SAAT,GAAqBx4H,GAAzB;AACAxP,YAAIqgB,KAAKrgB,CAAL,GAASioI,aAAa,CAAtB,GAA0BF,YAAY,CAA1C;AAvBJ;;AA0BA,WAAO,CAAChoI,CAAD,EAAIC,CAAJ,CAAP;AACD;;AAED,WAASmmI,aAAT,CAAuBnX,KAAvB,EAA8B;AAC5B,WAAOA,UAAU,QAAV,IAAsBA,UAAU,QAAvC;AACD;;AAED;;;;;;;;;;;;;;;;;;AAkBA;AACA;;;;;;;;;AASAh9B,iBAAe;AACbh1F,UAAM,SADO;AAEbiG,WAAO,SAFM;AAGbgb,YAAQ;AAHK,GAAf,EAIG;AACH,cAAY,CAAE,CALd;AAMA+zE,iBAAe;AACbh1F,UAAM,SADO;AAEbiG,WAAO,SAFM;AAGbgb,YAAQ;AAHK,GAAf,EAIG;AACH,cAAY,CAAE,CALd;;AAOAvoB,UAAQ+B,OAAR,GAAkBA,OAAlB;AACA/B,UAAQsjE,YAAR,GAAuBA,YAAvB;AACAtjE,UAAQiyF,QAAR,GAAmBA,QAAnB;AACAjyF,UAAQwyC,IAAR,GAAeA,IAAf;AACAxyC,UAAQy7F,OAAR,GAAkBA,OAAlB;AACAz7F,UAAQ07F,UAAR,GAAqBA,UAArB;AACA17F,UAAQ27F,UAAR,GAAqBA,UAArB;AACA37F,UAAQgQ,OAAR,GAAkBA,OAAlB;AACAhQ,UAAQw7F,gBAAR,GAA2BA,gBAA3B;AACAx7F,UAAQ47F,eAAR,GAA0BA,eAA1B;AACA57F,UAAQ67F,aAAR,GAAwBA,aAAxB;AACA77F,UAAQ87F,oBAAR,GAA+BA,oBAA/B;AACA97F,UAAQg8F,iBAAR,GAA4BA,iBAA5B;AACAh8F,UAAQo8F,kBAAR,GAA6BA,kBAA7B;AACAp8F,UAAQs8F,cAAR,GAAyBA,cAAzB;AACAt8F,UAAQu8F,wBAAR,GAAmCA,wBAAnC;AACAv8F,UAAQy8F,6BAAR,GAAwCA,6BAAxC;AACAz8F,UAAQ48F,cAAR,GAAyBA,cAAzB;AACA58F,UAAQ88F,cAAR,GAAyBA,cAAzB;AACA98F,UAAQm9F,eAAR,GAA0BA,eAA1B;AACAn9F,UAAQq9F,oBAAR,GAA+BA,oBAA/B;AACAr9F,UAAQs9F,mBAAR,GAA8BA,mBAA9B;AACAt9F,UAAQu9F,iBAAR,GAA4BA,iBAA5B;AACAv9F,UAAQw9F,eAAR,GAA0BA,eAA1B;AACAx9F,UAAQy9F,gBAAR,GAA2BA,gBAA3B;AACAz9F,UAAQ29F,WAAR,GAAsBA,WAAtB;AACA39F,UAAQi+F,MAAR,GAAiBA,MAAjB;AACAj+F,UAAQk+F,QAAR,GAAmBA,QAAnB;AACAl+F,UAAQuyC,OAAR,GAAkBA,OAAlB;AACAvyC,UAAQg2D,OAAR,GAAkBA,OAAlB;AACAh2D,UAAQo9D,MAAR,GAAiBA,MAAjB;AACAp9D,UAAQk/D,MAAR,GAAiBA,MAAjB;AACAl/D,UAAQgmF,QAAR,GAAmBA,QAAnB;AACAhmF,UAAQ69G,MAAR,GAAiBA,MAAjB;AACA79G,UAAQoV,MAAR,GAAiBA,MAAjB;AACApV,UAAQsM,MAAR,GAAiBA,MAAjB;AACAtM,UAAQ8f,KAAR,GAAgBA,KAAhB;AACA9f,UAAQq/G,YAAR,GAAuBA,YAAvB;AACAr/G,UAAQ4jH,YAAR,GAAuBA,YAAvB;AACA5jH,UAAQwyI,IAAR,GAAe3uB,MAAf;AACA7jH,UAAQgiG,IAAR,GAAeA,IAAf;AACAhiG,UAAQ22D,KAAR,GAAgBA,KAAhB;AACA32D,UAAQ2iH,IAAR,GAAeA,IAAf;AACA3iH,UAAQO,GAAR,GAAcgB,KAAd;AAEC,CAt+rCA,CAAD","file":"echarts.cee5c91d.map","sourceRoot":"..","sourcesContent":["(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n\ttypeof define === 'function' && define.amd ? define(['exports'], factory) :\n\t(factory((global.echarts = {})));\n}(this, (function (exports) { 'use strict';\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n// (1) The code `if (__DEV__) ...` can be removed by build tool.\n// (2) If intend to use `__DEV__`, this module should be imported. Use a global\n// variable `__DEV__` may cause that miss the declaration (see #6535), or the\n// declaration is behind of the using position (for example in `Model.extent`,\n// And tools like rollup can not analysis the dependency if not import).\n\n/**\n * zrender: id\n *\n * @author errorrik (errorrik@gmail.com)\n */\nvar idStart = 0x0907;\nvar guid = function () {\n  return idStart++;\n};\n\n/**\n * echarts\n *\n * @desc echartsCanvasJavascript\n * @author firede[firede@firede.us]\n * @desc thanks zepto.\n */\nvar env = {};\n\nif (typeof wx === 'object' && typeof wx.getSystemInfoSync === 'function') {\n  // In Weixin Application\n  env = {\n    browser: {},\n    os: {},\n    node: false,\n    wxa: true,\n    // Weixin Application\n    canvasSupported: true,\n    svgSupported: false,\n    touchEventsSupported: true\n  };\n} else if (typeof document === 'undefined' && typeof self !== 'undefined') {\n  // In worker\n  env = {\n    browser: {},\n    os: {},\n    node: false,\n    worker: true,\n    canvasSupported: true\n  };\n} else if (typeof navigator === 'undefined') {\n  // In node\n  env = {\n    browser: {},\n    os: {},\n    node: true,\n    worker: false,\n    // Assume canvas is supported\n    canvasSupported: true,\n    svgSupported: true\n  };\n} else {\n  env = detect(navigator.userAgent);\n}\n\nvar env$1 = env; // Zepto.js\n// (c) 2010-2013 Thomas Fuchs\n// Zepto.js may be freely distributed under the MIT license.\n\nfunction detect(ua) {\n  var os = {};\n  var browser = {}; // var webkit = ua.match(/Web[kK]it[\\/]{0,1}([\\d.]+)/);\n  // var android = ua.match(/(Android);?[\\s\\/]+([\\d.]+)?/);\n  // var ipad = ua.match(/(iPad).*OS\\s([\\d_]+)/);\n  // var ipod = ua.match(/(iPod)(.*OS\\s([\\d_]+))?/);\n  // var iphone = !ipad && ua.match(/(iPhone\\sOS)\\s([\\d_]+)/);\n  // var webos = ua.match(/(webOS|hpwOS)[\\s\\/]([\\d.]+)/);\n  // var touchpad = webos && ua.match(/TouchPad/);\n  // var kindle = ua.match(/Kindle\\/([\\d.]+)/);\n  // var silk = ua.match(/Silk\\/([\\d._]+)/);\n  // var blackberry = ua.match(/(BlackBerry).*Version\\/([\\d.]+)/);\n  // var bb10 = ua.match(/(BB10).*Version\\/([\\d.]+)/);\n  // var rimtabletos = ua.match(/(RIM\\sTablet\\sOS)\\s([\\d.]+)/);\n  // var playbook = ua.match(/PlayBook/);\n  // var chrome = ua.match(/Chrome\\/([\\d.]+)/) || ua.match(/CriOS\\/([\\d.]+)/);\n\n  var firefox = ua.match(/Firefox\\/([\\d.]+)/); // var safari = webkit && ua.match(/Mobile\\//) && !chrome;\n  // var webview = ua.match(/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/) && !chrome;\n\n  var ie = ua.match(/MSIE\\s([\\d.]+)/) // IE 11 Trident/7.0; rv:11.0\n  || ua.match(/Trident\\/.+?rv:(([\\d.]+))/);\n  var edge = ua.match(/Edge\\/([\\d.]+)/); // IE 12 and 12+\n\n  var weChat = /micromessenger/i.test(ua); // Todo: clean this up with a better OS/browser seperation:\n  // - discern (more) between multiple browsers on android\n  // - decide if kindle fire in silk mode is android or not\n  // - Firefox on Android doesn't specify the Android version\n  // - possibly devide in os, device and browser hashes\n  // if (browser.webkit = !!webkit) browser.version = webkit[1];\n  // if (android) os.android = true, os.version = android[2];\n  // if (iphone && !ipod) os.ios = os.iphone = true, os.version = iphone[2].replace(/_/g, '.');\n  // if (ipad) os.ios = os.ipad = true, os.version = ipad[2].replace(/_/g, '.');\n  // if (ipod) os.ios = os.ipod = true, os.version = ipod[3] ? ipod[3].replace(/_/g, '.') : null;\n  // if (webos) os.webos = true, os.version = webos[2];\n  // if (touchpad) os.touchpad = true;\n  // if (blackberry) os.blackberry = true, os.version = blackberry[2];\n  // if (bb10) os.bb10 = true, os.version = bb10[2];\n  // if (rimtabletos) os.rimtabletos = true, os.version = rimtabletos[2];\n  // if (playbook) browser.playbook = true;\n  // if (kindle) os.kindle = true, os.version = kindle[1];\n  // if (silk) browser.silk = true, browser.version = silk[1];\n  // if (!silk && os.android && ua.match(/Kindle Fire/)) browser.silk = true;\n  // if (chrome) browser.chrome = true, browser.version = chrome[1];\n\n  if (firefox) {\n    browser.firefox = true;\n    browser.version = firefox[1];\n  } // if (safari && (ua.match(/Safari/) || !!os.ios)) browser.safari = true;\n  // if (webview) browser.webview = true;\n\n\n  if (ie) {\n    browser.ie = true;\n    browser.version = ie[1];\n  }\n\n  if (edge) {\n    browser.edge = true;\n    browser.version = edge[1];\n  } // It is difficult to detect WeChat in Win Phone precisely, because ua can\n  // not be set on win phone. So we do not consider Win Phone.\n\n\n  if (weChat) {\n    browser.weChat = true;\n  } // os.tablet = !!(ipad || playbook || (android && !ua.match(/Mobile/)) ||\n  //     (firefox && ua.match(/Tablet/)) || (ie && !ua.match(/Phone/) && ua.match(/Touch/)));\n  // os.phone  = !!(!os.tablet && !os.ipod && (android || iphone || webos ||\n  //     (chrome && ua.match(/Android/)) || (chrome && ua.match(/CriOS\\/([\\d.]+)/)) ||\n  //     (firefox && ua.match(/Mobile/)) || (ie && ua.match(/Touch/))));\n\n\n  return {\n    browser: browser,\n    os: os,\n    node: false,\n    // canvas\n    // canvasSupported : !(browser.ie && parseFloat(browser.version) < 9)\n    canvasSupported: !!document.createElement('canvas').getContext,\n    svgSupported: typeof SVGRect !== 'undefined',\n    // works on most browsers\n    // IE10/11 does not support touch event, and MS Edge supports them but not by\n    // default, so we dont check navigator.maxTouchPoints for them here.\n    touchEventsSupported: 'ontouchstart' in window && !browser.ie && !browser.edge,\n    // <http://caniuse.com/#search=pointer%20event>.\n    pointerEventsSupported: 'onpointerdown' in window // Firefox supports pointer but not by default, only MS browsers are reliable on pointer\n    // events currently. So we dont use that on other browsers unless tested sufficiently.\n    // Although IE 10 supports pointer event, it use old style and is different from the\n    // standard. So we exclude that. (IE 10 is hardly used on touch device)\n    && (browser.edge || browser.ie && browser.version >= 11) // passiveSupported: detectPassiveSupport()\n\n  };\n} // See https://github.com/WICG/EventListenerOptions/blob/gh-pages/explainer.md#feature-detection\n// function detectPassiveSupport() {\n//     // Test via a getter in the options object to see if the passive property is accessed\n//     var supportsPassive = false;\n//     try {\n//         var opts = Object.defineProperty({}, 'passive', {\n//             get: function() {\n//                 supportsPassive = true;\n//             }\n//         });\n//         window.addEventListener('testPassive', function() {}, opts);\n//     } catch (e) {\n//     }\n//     return supportsPassive;\n// }\n\n/**\n * @module zrender/core/util\n */\n// mergeDate\nvar BUILTIN_OBJECT = {\n  '[object Function]': 1,\n  '[object RegExp]': 1,\n  '[object Date]': 1,\n  '[object Error]': 1,\n  '[object CanvasGradient]': 1,\n  '[object CanvasPattern]': 1,\n  // For node-canvas\n  '[object Image]': 1,\n  '[object Canvas]': 1\n};\nvar TYPED_ARRAY = {\n  '[object Int8Array]': 1,\n  '[object Uint8Array]': 1,\n  '[object Uint8ClampedArray]': 1,\n  '[object Int16Array]': 1,\n  '[object Uint16Array]': 1,\n  '[object Int32Array]': 1,\n  '[object Uint32Array]': 1,\n  '[object Float32Array]': 1,\n  '[object Float64Array]': 1\n};\nvar objToString = Object.prototype.toString;\nvar arrayProto = Array.prototype;\nvar nativeForEach = arrayProto.forEach;\nvar nativeFilter = arrayProto.filter;\nvar nativeSlice = arrayProto.slice;\nvar nativeMap = arrayProto.map;\nvar nativeReduce = arrayProto.reduce; // Avoid assign to an exported variable, for transforming to cjs.\n\nvar methods = {};\nfunction $override(name, fn) {\n  // Clear ctx instance for different environment\n  if (name === 'createCanvas') {\n    _ctx = null;\n  }\n\n  methods[name] = fn;\n}\n/**\n * Those data types can be cloned:\n *     Plain object, Array, TypedArray, number, string, null, undefined.\n * Those data types will be assgined using the orginal data:\n *     BUILTIN_OBJECT\n * Instance of user defined class will be cloned to a plain object, without\n * properties in prototype.\n * Other data types is not supported (not sure what will happen).\n *\n * Caution: do not support clone Date, for performance consideration.\n * (There might be a large number of date in `series.data`).\n * So date should not be modified in and out of echarts.\n *\n * @param {*} source\n * @return {*} new\n */\n\nfunction clone(source) {\n  if (source == null || typeof source != 'object') {\n    return source;\n  }\n\n  var result = source;\n  var typeStr = objToString.call(source);\n\n  if (typeStr === '[object Array]') {\n    if (!isPrimitive(source)) {\n      result = [];\n\n      for (var i = 0, len = source.length; i < len; i++) {\n        result[i] = clone(source[i]);\n      }\n    }\n  } else if (TYPED_ARRAY[typeStr]) {\n    if (!isPrimitive(source)) {\n      var Ctor = source.constructor;\n\n      if (source.constructor.from) {\n        result = Ctor.from(source);\n      } else {\n        result = new Ctor(source.length);\n\n        for (var i = 0, len = source.length; i < len; i++) {\n          result[i] = clone(source[i]);\n        }\n      }\n    }\n  } else if (!BUILTIN_OBJECT[typeStr] && !isPrimitive(source) && !isDom(source)) {\n    result = {};\n\n    for (var key in source) {\n      if (source.hasOwnProperty(key)) {\n        result[key] = clone(source[key]);\n      }\n    }\n  }\n\n  return result;\n}\n/**\n * @memberOf module:zrender/core/util\n * @param {*} target\n * @param {*} source\n * @param {boolean} [overwrite=false]\n */\n\nfunction merge(target, source, overwrite) {\n  // We should escapse that source is string\n  // and enter for ... in ...\n  if (!isObject$1(source) || !isObject$1(target)) {\n    return overwrite ? clone(source) : target;\n  }\n\n  for (var key in source) {\n    if (source.hasOwnProperty(key)) {\n      var targetProp = target[key];\n      var sourceProp = source[key];\n\n      if (isObject$1(sourceProp) && isObject$1(targetProp) && !isArray(sourceProp) && !isArray(targetProp) && !isDom(sourceProp) && !isDom(targetProp) && !isBuiltInObject(sourceProp) && !isBuiltInObject(targetProp) && !isPrimitive(sourceProp) && !isPrimitive(targetProp)) {\n        // merge\n        merge(targetProp, sourceProp, overwrite);\n      } else if (overwrite || !(key in target)) {\n        // overwritetrue\n        // NOTE target[key] \n        target[key] = clone(source[key], true);\n      }\n    }\n  }\n\n  return target;\n}\n/**\n * @param {Array} targetAndSources The first item is target, and the rests are source.\n * @param {boolean} [overwrite=false]\n * @return {*} target\n */\n\nfunction mergeAll(targetAndSources, overwrite) {\n  var result = targetAndSources[0];\n\n  for (var i = 1, len = targetAndSources.length; i < len; i++) {\n    result = merge(result, targetAndSources[i], overwrite);\n  }\n\n  return result;\n}\n/**\n * @param {*} target\n * @param {*} source\n * @memberOf module:zrender/core/util\n */\n\nfunction extend(target, source) {\n  for (var key in source) {\n    if (source.hasOwnProperty(key)) {\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n/**\n * @param {*} target\n * @param {*} source\n * @param {boolean} [overlay=false]\n * @memberOf module:zrender/core/util\n */\n\nfunction defaults(target, source, overlay) {\n  for (var key in source) {\n    if (source.hasOwnProperty(key) && (overlay ? source[key] != null : target[key] == null)) {\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\nvar createCanvas = function () {\n  return methods.createCanvas();\n};\n\nmethods.createCanvas = function () {\n  return document.createElement('canvas');\n}; // FIXME\n\n\nvar _ctx;\n\nfunction getContext() {\n  if (!_ctx) {\n    // Use util.createCanvas instead of createCanvas\n    // because createCanvas may be overwritten in different environment\n    _ctx = createCanvas().getContext('2d');\n  }\n\n  return _ctx;\n}\n/**\n * index\n * @memberOf module:zrender/core/util\n */\n\nfunction indexOf(array, value) {\n  if (array) {\n    if (array.indexOf) {\n      return array.indexOf(value);\n    }\n\n    for (var i = 0, len = array.length; i < len; i++) {\n      if (array[i] === value) {\n        return i;\n      }\n    }\n  }\n\n  return -1;\n}\n/**\n * \n *\n * @memberOf module:zrender/core/util\n * @param {Function} clazz \n * @param {Function} baseClazz \n */\n\nfunction inherits(clazz, baseClazz) {\n  var clazzPrototype = clazz.prototype;\n\n  function F() {}\n\n  F.prototype = baseClazz.prototype;\n  clazz.prototype = new F();\n\n  for (var prop in clazzPrototype) {\n    clazz.prototype[prop] = clazzPrototype[prop];\n  }\n\n  clazz.prototype.constructor = clazz;\n  clazz.superClass = baseClazz;\n}\n/**\n * @memberOf module:zrender/core/util\n * @param {Object|Function} target\n * @param {Object|Function} sorce\n * @param {boolean} overlay\n */\n\nfunction mixin(target, source, overlay) {\n  target = 'prototype' in target ? target.prototype : target;\n  source = 'prototype' in source ? source.prototype : source;\n  defaults(target, source, overlay);\n}\n/**\n * Consider typed array.\n * @param {Array|TypedArray} data\n */\n\nfunction isArrayLike(data) {\n  if (!data) {\n    return;\n  }\n\n  if (typeof data == 'string') {\n    return false;\n  }\n\n  return typeof data.length == 'number';\n}\n/**\n * \n * @memberOf module:zrender/core/util\n * @param {Object|Array} obj\n * @param {Function} cb\n * @param {*} [context]\n */\n\nfunction each$1(obj, cb, context) {\n  if (!(obj && cb)) {\n    return;\n  }\n\n  if (obj.forEach && obj.forEach === nativeForEach) {\n    obj.forEach(cb, context);\n  } else if (obj.length === +obj.length) {\n    for (var i = 0, len = obj.length; i < len; i++) {\n      cb.call(context, obj[i], i, obj);\n    }\n  } else {\n    for (var key in obj) {\n      if (obj.hasOwnProperty(key)) {\n        cb.call(context, obj[key], key, obj);\n      }\n    }\n  }\n}\n/**\n * \n * @memberOf module:zrender/core/util\n * @param {Array} obj\n * @param {Function} cb\n * @param {*} [context]\n * @return {Array}\n */\n\nfunction map(obj, cb, context) {\n  if (!(obj && cb)) {\n    return;\n  }\n\n  if (obj.map && obj.map === nativeMap) {\n    return obj.map(cb, context);\n  } else {\n    var result = [];\n\n    for (var i = 0, len = obj.length; i < len; i++) {\n      result.push(cb.call(context, obj[i], i, obj));\n    }\n\n    return result;\n  }\n}\n/**\n * @memberOf module:zrender/core/util\n * @param {Array} obj\n * @param {Function} cb\n * @param {Object} [memo]\n * @param {*} [context]\n * @return {Array}\n */\n\nfunction reduce(obj, cb, memo, context) {\n  if (!(obj && cb)) {\n    return;\n  }\n\n  if (obj.reduce && obj.reduce === nativeReduce) {\n    return obj.reduce(cb, memo, context);\n  } else {\n    for (var i = 0, len = obj.length; i < len; i++) {\n      memo = cb.call(context, memo, obj[i], i, obj);\n    }\n\n    return memo;\n  }\n}\n/**\n * \n * @memberOf module:zrender/core/util\n * @param {Array} obj\n * @param {Function} cb\n * @param {*} [context]\n * @return {Array}\n */\n\nfunction filter(obj, cb, context) {\n  if (!(obj && cb)) {\n    return;\n  }\n\n  if (obj.filter && obj.filter === nativeFilter) {\n    return obj.filter(cb, context);\n  } else {\n    var result = [];\n\n    for (var i = 0, len = obj.length; i < len; i++) {\n      if (cb.call(context, obj[i], i, obj)) {\n        result.push(obj[i]);\n      }\n    }\n\n    return result;\n  }\n}\n/**\n * \n * @memberOf module:zrender/core/util\n * @param {Array} obj\n * @param {Function} cb\n * @param {*} [context]\n * @return {*}\n */\n\nfunction find(obj, cb, context) {\n  if (!(obj && cb)) {\n    return;\n  }\n\n  for (var i = 0, len = obj.length; i < len; i++) {\n    if (cb.call(context, obj[i], i, obj)) {\n      return obj[i];\n    }\n  }\n}\n/**\n * @memberOf module:zrender/core/util\n * @param {Function} func\n * @param {*} context\n * @return {Function}\n */\n\nfunction bind(func, context) {\n  var args = nativeSlice.call(arguments, 2);\n  return function () {\n    return func.apply(context, args.concat(nativeSlice.call(arguments)));\n  };\n}\n/**\n * @memberOf module:zrender/core/util\n * @param {Function} func\n * @return {Function}\n */\n\nfunction curry(func) {\n  var args = nativeSlice.call(arguments, 1);\n  return function () {\n    return func.apply(this, args.concat(nativeSlice.call(arguments)));\n  };\n}\n/**\n * @memberOf module:zrender/core/util\n * @param {*} value\n * @return {boolean}\n */\n\nfunction isArray(value) {\n  return objToString.call(value) === '[object Array]';\n}\n/**\n * @memberOf module:zrender/core/util\n * @param {*} value\n * @return {boolean}\n */\n\nfunction isFunction$1(value) {\n  return typeof value === 'function';\n}\n/**\n * @memberOf module:zrender/core/util\n * @param {*} value\n * @return {boolean}\n */\n\nfunction isString(value) {\n  return objToString.call(value) === '[object String]';\n}\n/**\n * @memberOf module:zrender/core/util\n * @param {*} value\n * @return {boolean}\n */\n\nfunction isObject$1(value) {\n  // Avoid a V8 JIT bug in Chrome 19-20.\n  // See https://code.google.com/p/v8/issues/detail?id=2291 for more details.\n  var type = typeof value;\n  return type === 'function' || !!value && type == 'object';\n}\n/**\n * @memberOf module:zrender/core/util\n * @param {*} value\n * @return {boolean}\n */\n\nfunction isBuiltInObject(value) {\n  return !!BUILTIN_OBJECT[objToString.call(value)];\n}\n/**\n * @memberOf module:zrender/core/util\n * @param {*} value\n * @return {boolean}\n */\n\nfunction isTypedArray(value) {\n  return !!TYPED_ARRAY[objToString.call(value)];\n}\n/**\n * @memberOf module:zrender/core/util\n * @param {*} value\n * @return {boolean}\n */\n\nfunction isDom(value) {\n  return typeof value === 'object' && typeof value.nodeType === 'number' && typeof value.ownerDocument === 'object';\n}\n/**\n * Whether is exactly NaN. Notice isNaN('a') returns true.\n * @param {*} value\n * @return {boolean}\n */\n\nfunction eqNaN(value) {\n  return value !== value;\n}\n/**\n * If value1 is not null, then return value1, otherwise judget rest of values.\n * Low performance.\n * @memberOf module:zrender/core/util\n * @return {*} Final value\n */\n\nfunction retrieve(values) {\n  for (var i = 0, len = arguments.length; i < len; i++) {\n    if (arguments[i] != null) {\n      return arguments[i];\n    }\n  }\n}\nfunction retrieve2(value0, value1) {\n  return value0 != null ? value0 : value1;\n}\nfunction retrieve3(value0, value1, value2) {\n  return value0 != null ? value0 : value1 != null ? value1 : value2;\n}\n/**\n * @memberOf module:zrender/core/util\n * @param {Array} arr\n * @param {number} startIndex\n * @param {number} endIndex\n * @return {Array}\n */\n\nfunction slice() {\n  return Function.call.apply(nativeSlice, arguments);\n}\n/**\n * Normalize css liked array configuration\n * e.g.\n *  3 => [3, 3, 3, 3]\n *  [4, 2] => [4, 2, 4, 2]\n *  [4, 3, 2] => [4, 3, 2, 3]\n * @param {number|Array.<number>} val\n * @return {Array.<number>}\n */\n\nfunction normalizeCssArray(val) {\n  if (typeof val === 'number') {\n    return [val, val, val, val];\n  }\n\n  var len = val.length;\n\n  if (len === 2) {\n    // vertical | horizontal\n    return [val[0], val[1], val[0], val[1]];\n  } else if (len === 3) {\n    // top | horizontal | bottom\n    return [val[0], val[1], val[2], val[1]];\n  }\n\n  return val;\n}\n/**\n * @memberOf module:zrender/core/util\n * @param {boolean} condition\n * @param {string} message\n */\n\nfunction assert$1(condition, message) {\n  if (!condition) {\n    throw new Error(message);\n  }\n}\n/**\n * @memberOf module:zrender/core/util\n * @param {string} str string to be trimed\n * @return {string} trimed string\n */\n\nfunction trim(str) {\n  if (str == null) {\n    return null;\n  } else if (typeof str.trim === 'function') {\n    return str.trim();\n  } else {\n    return str.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g, '');\n  }\n}\nvar primitiveKey = '__ec_primitive__';\n/**\n * Set an object as primitive to be ignored traversing children in clone or merge\n */\n\nfunction setAsPrimitive(obj) {\n  obj[primitiveKey] = true;\n}\nfunction isPrimitive(obj) {\n  return obj[primitiveKey];\n}\n/**\n * @constructor\n * @param {Object} obj Only apply `ownProperty`.\n */\n\nfunction HashMap(obj) {\n  var isArr = isArray(obj);\n  var thisMap = this;\n  obj instanceof HashMap ? obj.each(visit) : obj && each$1(obj, visit);\n\n  function visit(value, key) {\n    isArr ? thisMap.set(value, key) : thisMap.set(key, value);\n  }\n} // Add prefix to avoid conflict with Object.prototype.\n\n\nHashMap.prototype = {\n  constructor: HashMap,\n  // Do not provide `has` method to avoid defining what is `has`.\n  // (We usually treat `null` and `undefined` as the same, different\n  // from ES6 Map).\n  get: function (key) {\n    return this.hasOwnProperty(key) ? this[key] : null;\n  },\n  set: function (key, value) {\n    // Comparing with invocation chaining, `return value` is more commonly\n    // used in this case: `var someVal = map.set('a', genVal());`\n    return this[key] = value;\n  },\n  // Although util.each can be performed on this hashMap directly, user\n  // should not use the exposed keys, who are prefixed.\n  each: function (cb, context) {\n    context !== void 0 && (cb = bind(cb, context));\n\n    for (var key in this) {\n      this.hasOwnProperty(key) && cb(this[key], key);\n    }\n  },\n  // Do not use this method if performance sensitive.\n  removeKey: function (key) {\n    delete this[key];\n  }\n};\nfunction createHashMap(obj) {\n  return new HashMap(obj);\n}\nfunction concatArray(a, b) {\n  var newArray = new a.constructor(a.length + b.length);\n\n  for (var i = 0; i < a.length; i++) {\n    newArray[i] = a[i];\n  }\n\n  var offset = a.length;\n\n  for (i = 0; i < b.length; i++) {\n    newArray[i + offset] = b[i];\n  }\n\n  return newArray;\n}\nfunction noop() {}\n\nvar zrUtil = (Object.freeze || Object)({\n\t$override: $override,\n\tclone: clone,\n\tmerge: merge,\n\tmergeAll: mergeAll,\n\textend: extend,\n\tdefaults: defaults,\n\tcreateCanvas: createCanvas,\n\tgetContext: getContext,\n\tindexOf: indexOf,\n\tinherits: inherits,\n\tmixin: mixin,\n\tisArrayLike: isArrayLike,\n\teach: each$1,\n\tmap: map,\n\treduce: reduce,\n\tfilter: filter,\n\tfind: find,\n\tbind: bind,\n\tcurry: curry,\n\tisArray: isArray,\n\tisFunction: isFunction$1,\n\tisString: isString,\n\tisObject: isObject$1,\n\tisBuiltInObject: isBuiltInObject,\n\tisTypedArray: isTypedArray,\n\tisDom: isDom,\n\teqNaN: eqNaN,\n\tretrieve: retrieve,\n\tretrieve2: retrieve2,\n\tretrieve3: retrieve3,\n\tslice: slice,\n\tnormalizeCssArray: normalizeCssArray,\n\tassert: assert$1,\n\ttrim: trim,\n\tsetAsPrimitive: setAsPrimitive,\n\tisPrimitive: isPrimitive,\n\tcreateHashMap: createHashMap,\n\tconcatArray: concatArray,\n\tnoop: noop\n});\n\nvar ArrayCtor = typeof Float32Array === 'undefined' ? Array : Float32Array;\n/**\n * \n * @param {number} [x=0]\n * @param {number} [y=0]\n * @return {Vector2}\n */\n\nfunction create(x, y) {\n  var out = new ArrayCtor(2);\n\n  if (x == null) {\n    x = 0;\n  }\n\n  if (y == null) {\n    y = 0;\n  }\n\n  out[0] = x;\n  out[1] = y;\n  return out;\n}\n/**\n * \n * @param {Vector2} out\n * @param {Vector2} v\n * @return {Vector2}\n */\n\nfunction copy(out, v) {\n  out[0] = v[0];\n  out[1] = v[1];\n  return out;\n}\n/**\n * \n * @param {Vector2} v\n * @return {Vector2}\n */\n\nfunction clone$1(v) {\n  var out = new ArrayCtor(2);\n  out[0] = v[0];\n  out[1] = v[1];\n  return out;\n}\n/**\n * \n * @param {Vector2} out\n * @param {number} a\n * @param {number} b\n * @return {Vector2} \n */\n\nfunction set(out, a, b) {\n  out[0] = a;\n  out[1] = b;\n  return out;\n}\n/**\n * \n * @param {Vector2} out\n * @param {Vector2} v1\n * @param {Vector2} v2\n */\n\nfunction add(out, v1, v2) {\n  out[0] = v1[0] + v2[0];\n  out[1] = v1[1] + v2[1];\n  return out;\n}\n/**\n * \n * @param {Vector2} out\n * @param {Vector2} v1\n * @param {Vector2} v2\n * @param {number} a\n */\n\nfunction scaleAndAdd(out, v1, v2, a) {\n  out[0] = v1[0] + v2[0] * a;\n  out[1] = v1[1] + v2[1] * a;\n  return out;\n}\n/**\n * \n * @param {Vector2} out\n * @param {Vector2} v1\n * @param {Vector2} v2\n */\n\nfunction sub(out, v1, v2) {\n  out[0] = v1[0] - v2[0];\n  out[1] = v1[1] - v2[1];\n  return out;\n}\n/**\n * \n * @param {Vector2} v\n * @return {number}\n */\n\nfunction len(v) {\n  return Math.sqrt(lenSquare(v));\n}\nvar length = len; // jshint ignore:line\n\n/**\n * \n * @param {Vector2} v\n * @return {number}\n */\n\nfunction lenSquare(v) {\n  return v[0] * v[0] + v[1] * v[1];\n}\nvar lengthSquare = lenSquare;\n/**\n * \n * @param {Vector2} out\n * @param {Vector2} v1\n * @param {Vector2} v2\n */\n\nfunction mul(out, v1, v2) {\n  out[0] = v1[0] * v2[0];\n  out[1] = v1[1] * v2[1];\n  return out;\n}\n/**\n * \n * @param {Vector2} out\n * @param {Vector2} v1\n * @param {Vector2} v2\n */\n\nfunction div(out, v1, v2) {\n  out[0] = v1[0] / v2[0];\n  out[1] = v1[1] / v2[1];\n  return out;\n}\n/**\n * \n * @param {Vector2} v1\n * @param {Vector2} v2\n * @return {number}\n */\n\nfunction dot(v1, v2) {\n  return v1[0] * v2[0] + v1[1] * v2[1];\n}\n/**\n * \n * @param {Vector2} out\n * @param {Vector2} v\n * @param {number} s\n */\n\nfunction scale(out, v, s) {\n  out[0] = v[0] * s;\n  out[1] = v[1] * s;\n  return out;\n}\n/**\n * \n * @param {Vector2} out\n * @param {Vector2} v\n */\n\nfunction normalize(out, v) {\n  var d = len(v);\n\n  if (d === 0) {\n    out[0] = 0;\n    out[1] = 0;\n  } else {\n    out[0] = v[0] / d;\n    out[1] = v[1] / d;\n  }\n\n  return out;\n}\n/**\n * \n * @param {Vector2} v1\n * @param {Vector2} v2\n * @return {number}\n */\n\nfunction distance(v1, v2) {\n  return Math.sqrt((v1[0] - v2[0]) * (v1[0] - v2[0]) + (v1[1] - v2[1]) * (v1[1] - v2[1]));\n}\nvar dist = distance;\n/**\n * \n * @param {Vector2} v1\n * @param {Vector2} v2\n * @return {number}\n */\n\nfunction distanceSquare(v1, v2) {\n  return (v1[0] - v2[0]) * (v1[0] - v2[0]) + (v1[1] - v2[1]) * (v1[1] - v2[1]);\n}\nvar distSquare = distanceSquare;\n/**\n * \n * @param {Vector2} out\n * @param {Vector2} v\n */\n\nfunction negate(out, v) {\n  out[0] = -v[0];\n  out[1] = -v[1];\n  return out;\n}\n/**\n * \n * @param {Vector2} out\n * @param {Vector2} v1\n * @param {Vector2} v2\n * @param {number} t\n */\n\nfunction lerp(out, v1, v2, t) {\n  out[0] = v1[0] + t * (v2[0] - v1[0]);\n  out[1] = v1[1] + t * (v2[1] - v1[1]);\n  return out;\n}\n/**\n * \n * @param {Vector2} out\n * @param {Vector2} v\n * @param {Vector2} m\n */\n\nfunction applyTransform(out, v, m) {\n  var x = v[0];\n  var y = v[1];\n  out[0] = m[0] * x + m[2] * y + m[4];\n  out[1] = m[1] * x + m[3] * y + m[5];\n  return out;\n}\n/**\n * \n * @param  {Vector2} out\n * @param  {Vector2} v1\n * @param  {Vector2} v2\n */\n\nfunction min(out, v1, v2) {\n  out[0] = Math.min(v1[0], v2[0]);\n  out[1] = Math.min(v1[1], v2[1]);\n  return out;\n}\n/**\n * \n * @param  {Vector2} out\n * @param  {Vector2} v1\n * @param  {Vector2} v2\n */\n\nfunction max(out, v1, v2) {\n  out[0] = Math.max(v1[0], v2[0]);\n  out[1] = Math.max(v1[1], v2[1]);\n  return out;\n}\n\nvar vector = (Object.freeze || Object)({\n\tcreate: create,\n\tcopy: copy,\n\tclone: clone$1,\n\tset: set,\n\tadd: add,\n\tscaleAndAdd: scaleAndAdd,\n\tsub: sub,\n\tlen: len,\n\tlength: length,\n\tlenSquare: lenSquare,\n\tlengthSquare: lengthSquare,\n\tmul: mul,\n\tdiv: div,\n\tdot: dot,\n\tscale: scale,\n\tnormalize: normalize,\n\tdistance: distance,\n\tdist: dist,\n\tdistanceSquare: distanceSquare,\n\tdistSquare: distSquare,\n\tnegate: negate,\n\tlerp: lerp,\n\tapplyTransform: applyTransform,\n\tmin: min,\n\tmax: max\n});\n\n// TODO Draggable for group\n// FIXME Draggable on element which has parent rotation or scale\nfunction Draggable() {\n  this.on('mousedown', this._dragStart, this);\n  this.on('mousemove', this._drag, this);\n  this.on('mouseup', this._dragEnd, this);\n  this.on('globalout', this._dragEnd, this); // this._dropTarget = null;\n  // this._draggingTarget = null;\n  // this._x = 0;\n  // this._y = 0;\n}\n\nDraggable.prototype = {\n  constructor: Draggable,\n  _dragStart: function (e) {\n    var draggingTarget = e.target;\n\n    if (draggingTarget && draggingTarget.draggable) {\n      this._draggingTarget = draggingTarget;\n      draggingTarget.dragging = true;\n      this._x = e.offsetX;\n      this._y = e.offsetY;\n      this.dispatchToElement(param(draggingTarget, e), 'dragstart', e.event);\n    }\n  },\n  _drag: function (e) {\n    var draggingTarget = this._draggingTarget;\n\n    if (draggingTarget) {\n      var x = e.offsetX;\n      var y = e.offsetY;\n      var dx = x - this._x;\n      var dy = y - this._y;\n      this._x = x;\n      this._y = y;\n      draggingTarget.drift(dx, dy, e);\n      this.dispatchToElement(param(draggingTarget, e), 'drag', e.event);\n      var dropTarget = this.findHover(x, y, draggingTarget).target;\n      var lastDropTarget = this._dropTarget;\n      this._dropTarget = dropTarget;\n\n      if (draggingTarget !== dropTarget) {\n        if (lastDropTarget && dropTarget !== lastDropTarget) {\n          this.dispatchToElement(param(lastDropTarget, e), 'dragleave', e.event);\n        }\n\n        if (dropTarget && dropTarget !== lastDropTarget) {\n          this.dispatchToElement(param(dropTarget, e), 'dragenter', e.event);\n        }\n      }\n    }\n  },\n  _dragEnd: function (e) {\n    var draggingTarget = this._draggingTarget;\n\n    if (draggingTarget) {\n      draggingTarget.dragging = false;\n    }\n\n    this.dispatchToElement(param(draggingTarget, e), 'dragend', e.event);\n\n    if (this._dropTarget) {\n      this.dispatchToElement(param(this._dropTarget, e), 'drop', e.event);\n    }\n\n    this._draggingTarget = null;\n    this._dropTarget = null;\n  }\n};\n\nfunction param(target, e) {\n  return {\n    target: target,\n    topTarget: e && e.topTarget\n  };\n}\n\n/**\n * \n * @module zrender/mixin/Eventful\n * @author Kener (@Kener-, kener.linfeng@gmail.com)\n *         pissang (https://www.github.com/pissang)\n */\nvar arrySlice = Array.prototype.slice;\n/**\n * \n * @alias module:zrender/mixin/Eventful\n * @constructor\n */\n\nvar Eventful = function () {\n  this._$handlers = {};\n};\n\nEventful.prototype = {\n  constructor: Eventful,\n\n  /**\n   * trigger\n   *\n   * @param {string} event \n   * @param {Function} handler \n   * @param {Object} context\n   */\n  one: function (event, handler, context) {\n    var _h = this._$handlers;\n\n    if (!handler || !event) {\n      return this;\n    }\n\n    if (!_h[event]) {\n      _h[event] = [];\n    }\n\n    for (var i = 0; i < _h[event].length; i++) {\n      if (_h[event][i].h === handler) {\n        return this;\n      }\n    }\n\n    _h[event].push({\n      h: handler,\n      one: true,\n      ctx: context || this\n    });\n\n    return this;\n  },\n\n  /**\n   * \n   * @param {string} event \n   * @param {Function} handler \n   * @param {Object} [context]\n   */\n  on: function (event, handler, context) {\n    var _h = this._$handlers;\n\n    if (!handler || !event) {\n      return this;\n    }\n\n    if (!_h[event]) {\n      _h[event] = [];\n    }\n\n    for (var i = 0; i < _h[event].length; i++) {\n      if (_h[event][i].h === handler) {\n        return this;\n      }\n    }\n\n    _h[event].push({\n      h: handler,\n      one: false,\n      ctx: context || this\n    });\n\n    return this;\n  },\n\n  /**\n   * \n   * @param  {string}  event\n   * @return {boolean}\n   */\n  isSilent: function (event) {\n    var _h = this._$handlers;\n    return _h[event] && _h[event].length;\n  },\n\n  /**\n   * \n   * @param {string} event \n   * @param {Function} [handler] \n   */\n  off: function (event, handler) {\n    var _h = this._$handlers;\n\n    if (!event) {\n      this._$handlers = {};\n      return this;\n    }\n\n    if (handler) {\n      if (_h[event]) {\n        var newList = [];\n\n        for (var i = 0, l = _h[event].length; i < l; i++) {\n          if (_h[event][i]['h'] != handler) {\n            newList.push(_h[event][i]);\n          }\n        }\n\n        _h[event] = newList;\n      }\n\n      if (_h[event] && _h[event].length === 0) {\n        delete _h[event];\n      }\n    } else {\n      delete _h[event];\n    }\n\n    return this;\n  },\n\n  /**\n   * \n   *\n   * @param {string} type \n   */\n  trigger: function (type) {\n    if (this._$handlers[type]) {\n      var args = arguments;\n      var argLen = args.length;\n\n      if (argLen > 3) {\n        args = arrySlice.call(args, 1);\n      }\n\n      var _h = this._$handlers[type];\n      var len = _h.length;\n\n      for (var i = 0; i < len;) {\n        // Optimize advise from backbone\n        switch (argLen) {\n          case 1:\n            _h[i]['h'].call(_h[i]['ctx']);\n\n            break;\n\n          case 2:\n            _h[i]['h'].call(_h[i]['ctx'], args[1]);\n\n            break;\n\n          case 3:\n            _h[i]['h'].call(_h[i]['ctx'], args[1], args[2]);\n\n            break;\n\n          default:\n            // have more than 2 given arguments\n            _h[i]['h'].apply(_h[i]['ctx'], args);\n\n            break;\n        }\n\n        if (_h[i]['one']) {\n          _h.splice(i, 1);\n\n          len--;\n        } else {\n          i++;\n        }\n      }\n    }\n\n    return this;\n  },\n\n  /**\n   * context, context\n   * @param {string} type \n   */\n  triggerWithContext: function (type) {\n    if (this._$handlers[type]) {\n      var args = arguments;\n      var argLen = args.length;\n\n      if (argLen > 4) {\n        args = arrySlice.call(args, 1, args.length - 1);\n      }\n\n      var ctx = args[args.length - 1];\n      var _h = this._$handlers[type];\n      var len = _h.length;\n\n      for (var i = 0; i < len;) {\n        // Optimize advise from backbone\n        switch (argLen) {\n          case 1:\n            _h[i]['h'].call(ctx);\n\n            break;\n\n          case 2:\n            _h[i]['h'].call(ctx, args[1]);\n\n            break;\n\n          case 3:\n            _h[i]['h'].call(ctx, args[1], args[2]);\n\n            break;\n\n          default:\n            // have more than 2 given arguments\n            _h[i]['h'].apply(ctx, args);\n\n            break;\n        }\n\n        if (_h[i]['one']) {\n          _h.splice(i, 1);\n\n          len--;\n        } else {\n          i++;\n        }\n      }\n    }\n\n    return this;\n  }\n}; //  onxxxx \n\nvar SILENT = 'silent';\n\nfunction makeEventPacket(eveType, targetInfo, event) {\n  return {\n    type: eveType,\n    event: event,\n    // target can only be an element that is not silent.\n    target: targetInfo.target,\n    // topTarget can be a silent element.\n    topTarget: targetInfo.topTarget,\n    cancelBubble: false,\n    offsetX: event.zrX,\n    offsetY: event.zrY,\n    gestureEvent: event.gestureEvent,\n    pinchX: event.pinchX,\n    pinchY: event.pinchY,\n    pinchScale: event.pinchScale,\n    wheelDelta: event.zrDelta,\n    zrByTouch: event.zrByTouch,\n    which: event.which\n  };\n}\n\nfunction EmptyProxy() {}\n\nEmptyProxy.prototype.dispose = function () {};\n\nvar handlerNames = ['click', 'dblclick', 'mousewheel', 'mouseout', 'mouseup', 'mousedown', 'mousemove', 'contextmenu'];\n/**\n * @alias module:zrender/Handler\n * @constructor\n * @extends module:zrender/mixin/Eventful\n * @param {module:zrender/Storage} storage Storage instance.\n * @param {module:zrender/Painter} painter Painter instance.\n * @param {module:zrender/dom/HandlerProxy} proxy HandlerProxy instance.\n * @param {HTMLElement} painterRoot painter.root (not painter.getViewportRoot()).\n */\n\nvar Handler = function (storage, painter, proxy, painterRoot) {\n  Eventful.call(this);\n  this.storage = storage;\n  this.painter = painter;\n  this.painterRoot = painterRoot;\n  proxy = proxy || new EmptyProxy();\n  /**\n   * Proxy of event. can be Dom, WebGLSurface, etc.\n   */\n\n  this.proxy = null;\n  /**\n   * {target, topTarget, x, y}\n   * @private\n   * @type {Object}\n   */\n\n  this._hovered = {};\n  /**\n   * @private\n   * @type {Date}\n   */\n\n  this._lastTouchMoment;\n  /**\n   * @private\n   * @type {number}\n   */\n\n  this._lastX;\n  /**\n   * @private\n   * @type {number}\n   */\n\n  this._lastY;\n  Draggable.call(this);\n  this.setHandlerProxy(proxy);\n};\n\nHandler.prototype = {\n  constructor: Handler,\n  setHandlerProxy: function (proxy) {\n    if (this.proxy) {\n      this.proxy.dispose();\n    }\n\n    if (proxy) {\n      each$1(handlerNames, function (name) {\n        proxy.on && proxy.on(name, this[name], this);\n      }, this); // Attach handler\n\n      proxy.handler = this;\n    }\n\n    this.proxy = proxy;\n  },\n  mousemove: function (event) {\n    var x = event.zrX;\n    var y = event.zrY;\n    var lastHovered = this._hovered;\n    var lastHoveredTarget = lastHovered.target; // If lastHoveredTarget is removed from zr (detected by '__zr') by some API call\n    // (like 'setOption' or 'dispatchAction') in event handlers, we should find\n    // lastHovered again here. Otherwise 'mouseout' can not be triggered normally.\n    // See #6198.\n\n    if (lastHoveredTarget && !lastHoveredTarget.__zr) {\n      lastHovered = this.findHover(lastHovered.x, lastHovered.y);\n      lastHoveredTarget = lastHovered.target;\n    }\n\n    var hovered = this._hovered = this.findHover(x, y);\n    var hoveredTarget = hovered.target;\n    var proxy = this.proxy;\n    proxy.setCursor && proxy.setCursor(hoveredTarget ? hoveredTarget.cursor : 'default'); // Mouse out on previous hovered element\n\n    if (lastHoveredTarget && hoveredTarget !== lastHoveredTarget) {\n      this.dispatchToElement(lastHovered, 'mouseout', event);\n    } // Mouse moving on one element\n\n\n    this.dispatchToElement(hovered, 'mousemove', event); // Mouse over on a new element\n\n    if (hoveredTarget && hoveredTarget !== lastHoveredTarget) {\n      this.dispatchToElement(hovered, 'mouseover', event);\n    }\n  },\n  mouseout: function (event) {\n    this.dispatchToElement(this._hovered, 'mouseout', event); // There might be some doms created by upper layer application\n    // at the same level of painter.getViewportRoot() (e.g., tooltip\n    // dom created by echarts), where 'globalout' event should not\n    // be triggered when mouse enters these doms. (But 'mouseout'\n    // should be triggered at the original hovered element as usual).\n\n    var element = event.toElement || event.relatedTarget;\n    var innerDom;\n\n    do {\n      element = element && element.parentNode;\n    } while (element && element.nodeType != 9 && !(innerDom = element === this.painterRoot));\n\n    !innerDom && this.trigger('globalout', {\n      event: event\n    });\n  },\n\n  /**\n   * Resize\n   */\n  resize: function (event) {\n    this._hovered = {};\n  },\n\n  /**\n   * Dispatch event\n   * @param {string} eventName\n   * @param {event=} eventArgs\n   */\n  dispatch: function (eventName, eventArgs) {\n    var handler = this[eventName];\n    handler && handler.call(this, eventArgs);\n  },\n\n  /**\n   * Dispose\n   */\n  dispose: function () {\n    this.proxy.dispose();\n    this.storage = this.proxy = this.painter = null;\n  },\n\n  /**\n   * cursor style\n   * @param {string} [cursorStyle='default']  crosshair\n   */\n  setCursorStyle: function (cursorStyle) {\n    var proxy = this.proxy;\n    proxy.setCursor && proxy.setCursor(cursorStyle);\n  },\n\n  /**\n   * \n   *\n   * @private\n   * @param {Object} targetInfo {target, topTarget} \n   * @param {string} eventName \n   * @param {Object} event \n   */\n  dispatchToElement: function (targetInfo, eventName, event) {\n    targetInfo = targetInfo || {};\n    var el = targetInfo.target;\n\n    if (el && el.silent) {\n      return;\n    }\n\n    var eventHandler = 'on' + eventName;\n    var eventPacket = makeEventPacket(eventName, targetInfo, event);\n\n    while (el) {\n      el[eventHandler] && (eventPacket.cancelBubble = el[eventHandler].call(el, eventPacket));\n      el.trigger(eventName, eventPacket);\n      el = el.parent;\n\n      if (eventPacket.cancelBubble) {\n        break;\n      }\n    }\n\n    if (!eventPacket.cancelBubble) {\n      //  zrender \n      this.trigger(eventName, eventPacket); // \n      //  click  dispose painter \n\n      this.painter && this.painter.eachOtherLayer(function (layer) {\n        if (typeof layer[eventHandler] == 'function') {\n          layer[eventHandler].call(layer, eventPacket);\n        }\n\n        if (layer.trigger) {\n          layer.trigger(eventName, eventPacket);\n        }\n      });\n    }\n  },\n\n  /**\n   * @private\n   * @param {number} x\n   * @param {number} y\n   * @param {module:zrender/graphic/Displayable} exclude\n   * @return {model:zrender/Element}\n   * @method\n   */\n  findHover: function (x, y, exclude) {\n    var list = this.storage.getDisplayList();\n    var out = {\n      x: x,\n      y: y\n    };\n\n    for (var i = list.length - 1; i >= 0; i--) {\n      var hoverCheckResult;\n\n      if (list[i] !== exclude // getDisplayList may include ignored item in VML mode\n      && !list[i].ignore && (hoverCheckResult = isHover(list[i], x, y))) {\n        !out.topTarget && (out.topTarget = list[i]);\n\n        if (hoverCheckResult !== SILENT) {\n          out.target = list[i];\n          break;\n        }\n      }\n    }\n\n    return out;\n  }\n}; // Common handlers\n\neach$1(['click', 'mousedown', 'mouseup', 'mousewheel', 'dblclick', 'contextmenu'], function (name) {\n  Handler.prototype[name] = function (event) {\n    // Find hover again to avoid click event is dispatched manually. Or click is triggered without mouseover\n    var hovered = this.findHover(event.zrX, event.zrY);\n    var hoveredTarget = hovered.target;\n\n    if (name === 'mousedown') {\n      this._downEl = hoveredTarget;\n      this._downPoint = [event.zrX, event.zrY]; // In case click triggered before mouseup\n\n      this._upEl = hoveredTarget;\n    } else if (name === 'mouseup') {\n      this._upEl = hoveredTarget;\n    } else if (name === 'click') {\n      if (this._downEl !== this._upEl // Original click event is triggered on the whole canvas element,\n      // including the case that `mousedown` - `mousemove` - `mouseup`,\n      // which should be filtered, otherwise it will bring trouble to\n      // pan and zoom.\n      || !this._downPoint // Arbitrary value\n      || dist(this._downPoint, [event.zrX, event.zrY]) > 4) {\n        return;\n      }\n\n      this._downPoint = null;\n    }\n\n    this.dispatchToElement(hovered, name, event);\n  };\n});\n\nfunction isHover(displayable, x, y) {\n  if (displayable[displayable.rectHover ? 'rectContain' : 'contain'](x, y)) {\n    var el = displayable;\n    var isSilent;\n\n    while (el) {\n      // If clipped by ancestor.\n      // FIXME: If clipPath has neither stroke nor fill,\n      // el.clipPath.contain(x, y) will always return false.\n      if (el.clipPath && !el.clipPath.contain(x, y)) {\n        return false;\n      }\n\n      if (el.silent) {\n        isSilent = true;\n      }\n\n      el = el.parent;\n    }\n\n    return isSilent ? SILENT : true;\n  }\n\n  return false;\n}\n\nmixin(Handler, Eventful);\nmixin(Handler, Draggable);\n\n/**\n * 3x2\n * @exports zrender/tool/matrix\n */\nvar ArrayCtor$1 = typeof Float32Array === 'undefined' ? Array : Float32Array;\n/**\n * Create a identity matrix.\n * @return {Float32Array|Array.<number>}\n */\n\nfunction create$1() {\n  var out = new ArrayCtor$1(6);\n  identity(out);\n  return out;\n}\n/**\n * \n * @param {Float32Array|Array.<number>} out\n */\n\nfunction identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  out[4] = 0;\n  out[5] = 0;\n  return out;\n}\n/**\n * \n * @param {Float32Array|Array.<number>} out\n * @param {Float32Array|Array.<number>} m\n */\n\nfunction copy$1(out, m) {\n  out[0] = m[0];\n  out[1] = m[1];\n  out[2] = m[2];\n  out[3] = m[3];\n  out[4] = m[4];\n  out[5] = m[5];\n  return out;\n}\n/**\n * \n * @param {Float32Array|Array.<number>} out\n * @param {Float32Array|Array.<number>} m1\n * @param {Float32Array|Array.<number>} m2\n */\n\nfunction mul$1(out, m1, m2) {\n  // Consider matrix.mul(m, m2, m);\n  // where out is the same as m2.\n  // So use temp variable to escape error.\n  var out0 = m1[0] * m2[0] + m1[2] * m2[1];\n  var out1 = m1[1] * m2[0] + m1[3] * m2[1];\n  var out2 = m1[0] * m2[2] + m1[2] * m2[3];\n  var out3 = m1[1] * m2[2] + m1[3] * m2[3];\n  var out4 = m1[0] * m2[4] + m1[2] * m2[5] + m1[4];\n  var out5 = m1[1] * m2[4] + m1[3] * m2[5] + m1[5];\n  out[0] = out0;\n  out[1] = out1;\n  out[2] = out2;\n  out[3] = out3;\n  out[4] = out4;\n  out[5] = out5;\n  return out;\n}\n/**\n * \n * @param {Float32Array|Array.<number>} out\n * @param {Float32Array|Array.<number>} a\n * @param {Float32Array|Array.<number>} v\n */\n\nfunction translate(out, a, v) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4] + v[0];\n  out[5] = a[5] + v[1];\n  return out;\n}\n/**\n * \n * @param {Float32Array|Array.<number>} out\n * @param {Float32Array|Array.<number>} a\n * @param {number} rad\n */\n\nfunction rotate(out, a, rad) {\n  var aa = a[0];\n  var ac = a[2];\n  var atx = a[4];\n  var ab = a[1];\n  var ad = a[3];\n  var aty = a[5];\n  var st = Math.sin(rad);\n  var ct = Math.cos(rad);\n  out[0] = aa * ct + ab * st;\n  out[1] = -aa * st + ab * ct;\n  out[2] = ac * ct + ad * st;\n  out[3] = -ac * st + ct * ad;\n  out[4] = ct * atx + st * aty;\n  out[5] = ct * aty - st * atx;\n  return out;\n}\n/**\n * \n * @param {Float32Array|Array.<number>} out\n * @param {Float32Array|Array.<number>} a\n * @param {Float32Array|Array.<number>} v\n */\n\nfunction scale$1(out, a, v) {\n  var vx = v[0];\n  var vy = v[1];\n  out[0] = a[0] * vx;\n  out[1] = a[1] * vy;\n  out[2] = a[2] * vx;\n  out[3] = a[3] * vy;\n  out[4] = a[4] * vx;\n  out[5] = a[5] * vy;\n  return out;\n}\n/**\n * \n * @param {Float32Array|Array.<number>} out\n * @param {Float32Array|Array.<number>} a\n */\n\nfunction invert(out, a) {\n  var aa = a[0];\n  var ac = a[2];\n  var atx = a[4];\n  var ab = a[1];\n  var ad = a[3];\n  var aty = a[5];\n  var det = aa * ad - ab * ac;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = ad * det;\n  out[1] = -ab * det;\n  out[2] = -ac * det;\n  out[3] = aa * det;\n  out[4] = (ac * aty - ad * atx) * det;\n  out[5] = (ab * atx - aa * aty) * det;\n  return out;\n}\n/**\n * Clone a new matrix.\n * @param {Float32Array|Array.<number>} a\n */\n\nfunction clone$2(a) {\n  var b = create$1();\n  copy$1(b, a);\n  return b;\n}\n\nvar matrix = (Object.freeze || Object)({\n\tcreate: create$1,\n\tidentity: identity,\n\tcopy: copy$1,\n\tmul: mul$1,\n\ttranslate: translate,\n\trotate: rotate,\n\tscale: scale$1,\n\tinvert: invert,\n\tclone: clone$2\n});\n\n/**\n * \n * @module zrender/mixin/Transformable\n * @author pissang (https://www.github.com/pissang)\n */\nvar mIdentity = identity;\nvar EPSILON = 5e-5;\n\nfunction isNotAroundZero(val) {\n  return val > EPSILON || val < -EPSILON;\n}\n/**\n * @alias module:zrender/mixin/Transformable\n * @constructor\n */\n\n\nvar Transformable = function (opts) {\n  opts = opts || {}; // If there are no given position, rotation, scale\n\n  if (!opts.position) {\n    /**\n     * \n     * @type {Array.<number>}\n     * @default [0, 0]\n     */\n    this.position = [0, 0];\n  }\n\n  if (opts.rotation == null) {\n    /**\n     * \n     * @type {Array.<number>}\n     * @default 0\n     */\n    this.rotation = 0;\n  }\n\n  if (!opts.scale) {\n    /**\n     * \n     * @type {Array.<number>}\n     * @default [1, 1]\n     */\n    this.scale = [1, 1];\n  }\n  /**\n   * \n   * @type {Array.<number>}\n   * @default null\n   */\n\n\n  this.origin = this.origin || null;\n};\n\nvar transformableProto = Transformable.prototype;\ntransformableProto.transform = null;\n/**\n * \n * , position, rotation, scaletransformtransform\n */\n\ntransformableProto.needLocalTransform = function () {\n  return isNotAroundZero(this.rotation) || isNotAroundZero(this.position[0]) || isNotAroundZero(this.position[1]) || isNotAroundZero(this.scale[0] - 1) || isNotAroundZero(this.scale[1] - 1);\n};\n\ntransformableProto.updateTransform = function () {\n  var parent = this.parent;\n  var parentHasTransform = parent && parent.transform;\n  var needLocalTransform = this.needLocalTransform();\n  var m = this.transform;\n\n  if (!(needLocalTransform || parentHasTransform)) {\n    m && mIdentity(m);\n    return;\n  }\n\n  m = m || create$1();\n\n  if (needLocalTransform) {\n    this.getLocalTransform(m);\n  } else {\n    mIdentity(m);\n  } // \n\n\n  if (parentHasTransform) {\n    if (needLocalTransform) {\n      mul$1(m, parent.transform, m);\n    } else {\n      copy$1(m, parent.transform);\n    }\n  } // \n\n\n  this.transform = m;\n  this.invTransform = this.invTransform || create$1();\n  invert(this.invTransform, m);\n};\n\ntransformableProto.getLocalTransform = function (m) {\n  return Transformable.getLocalTransform(this, m);\n};\n/**\n * transformcontext\n * @param {CanvasRenderingContext2D} ctx\n */\n\n\ntransformableProto.setTransform = function (ctx) {\n  var m = this.transform;\n  var dpr = ctx.dpr || 1;\n\n  if (m) {\n    ctx.setTransform(dpr * m[0], dpr * m[1], dpr * m[2], dpr * m[3], dpr * m[4], dpr * m[5]);\n  } else {\n    ctx.setTransform(dpr, 0, 0, dpr, 0, 0);\n  }\n};\n\ntransformableProto.restoreTransform = function (ctx) {\n  var dpr = ctx.dpr || 1;\n  ctx.setTransform(dpr, 0, 0, dpr, 0, 0);\n};\n\nvar tmpTransform = [];\n/**\n * `transform``position`, `rotation`, `scale`\n */\n\ntransformableProto.decomposeTransform = function () {\n  if (!this.transform) {\n    return;\n  }\n\n  var parent = this.parent;\n  var m = this.transform;\n\n  if (parent && parent.transform) {\n    // Get local transform and decompose them to position, scale, rotation\n    mul$1(tmpTransform, parent.invTransform, m);\n    m = tmpTransform;\n  }\n\n  var sx = m[0] * m[0] + m[1] * m[1];\n  var sy = m[2] * m[2] + m[3] * m[3];\n  var position = this.position;\n  var scale$$1 = this.scale;\n\n  if (isNotAroundZero(sx - 1)) {\n    sx = Math.sqrt(sx);\n  }\n\n  if (isNotAroundZero(sy - 1)) {\n    sy = Math.sqrt(sy);\n  }\n\n  if (m[0] < 0) {\n    sx = -sx;\n  }\n\n  if (m[3] < 0) {\n    sy = -sy;\n  }\n\n  position[0] = m[4];\n  position[1] = m[5];\n  scale$$1[0] = sx;\n  scale$$1[1] = sy;\n  this.rotation = Math.atan2(-m[1] / sy, m[0] / sx);\n};\n/**\n * Get global scale\n * @return {Array.<number>}\n */\n\n\ntransformableProto.getGlobalScale = function () {\n  var m = this.transform;\n\n  if (!m) {\n    return [1, 1];\n  }\n\n  var sx = Math.sqrt(m[0] * m[0] + m[1] * m[1]);\n  var sy = Math.sqrt(m[2] * m[2] + m[3] * m[3]);\n\n  if (m[0] < 0) {\n    sx = -sx;\n  }\n\n  if (m[3] < 0) {\n    sy = -sy;\n  }\n\n  return [sx, sy];\n};\n/**\n *  shape \n * @method\n * @param {number} x\n * @param {number} y\n * @return {Array.<number>}\n */\n\n\ntransformableProto.transformCoordToLocal = function (x, y) {\n  var v2 = [x, y];\n  var invTransform = this.invTransform;\n\n  if (invTransform) {\n    applyTransform(v2, v2, invTransform);\n  }\n\n  return v2;\n};\n/**\n * \n * @method\n * @param {number} x\n * @param {number} y\n * @return {Array.<number>}\n */\n\n\ntransformableProto.transformCoordToGlobal = function (x, y) {\n  var v2 = [x, y];\n  var transform = this.transform;\n\n  if (transform) {\n    applyTransform(v2, v2, transform);\n  }\n\n  return v2;\n};\n/**\n * @static\n * @param {Object} target\n * @param {Array.<number>} target.origin\n * @param {number} target.rotation\n * @param {Array.<number>} target.position\n * @param {Array.<number>} [m]\n */\n\n\nTransformable.getLocalTransform = function (target, m) {\n  m = m || [];\n  mIdentity(m);\n  var origin = target.origin;\n  var scale$$1 = target.scale || [1, 1];\n  var rotation = target.rotation || 0;\n  var position = target.position || [0, 0];\n\n  if (origin) {\n    // Translate to origin\n    m[4] -= origin[0];\n    m[5] -= origin[1];\n  }\n\n  scale$1(m, m, scale$$1);\n\n  if (rotation) {\n    rotate(m, m, rotation);\n  }\n\n  if (origin) {\n    // Translate back from origin\n    m[4] += origin[0];\n    m[5] += origin[1];\n  }\n\n  m[4] += position[0];\n  m[5] += position[1];\n  return m;\n};\n\n/**\n *  https://github.com/sole/tween.js/blob/master/src/Tween.js\n * @see http://sole.github.io/tween.js/examples/03_graphs.html\n * @exports zrender/animation/easing\n */\nvar easing = {\n  /**\n  * @param {number} k\n  * @return {number}\n  */\n  linear: function (k) {\n    return k;\n  },\n\n  /**\n  * @param {number} k\n  * @return {number}\n  */\n  quadraticIn: function (k) {\n    return k * k;\n  },\n\n  /**\n  * @param {number} k\n  * @return {number}\n  */\n  quadraticOut: function (k) {\n    return k * (2 - k);\n  },\n\n  /**\n  * @param {number} k\n  * @return {number}\n  */\n  quadraticInOut: function (k) {\n    if ((k *= 2) < 1) {\n      return 0.5 * k * k;\n    }\n\n    return -0.5 * (--k * (k - 2) - 1);\n  },\n  // t^3\n\n  /**\n  * @param {number} k\n  * @return {number}\n  */\n  cubicIn: function (k) {\n    return k * k * k;\n  },\n\n  /**\n  * @param {number} k\n  * @return {number}\n  */\n  cubicOut: function (k) {\n    return --k * k * k + 1;\n  },\n\n  /**\n  * @param {number} k\n  * @return {number}\n  */\n  cubicInOut: function (k) {\n    if ((k *= 2) < 1) {\n      return 0.5 * k * k * k;\n    }\n\n    return 0.5 * ((k -= 2) * k * k + 2);\n  },\n  // t^4\n\n  /**\n  * @param {number} k\n  * @return {number}\n  */\n  quarticIn: function (k) {\n    return k * k * k * k;\n  },\n\n  /**\n  * @param {number} k\n  * @return {number}\n  */\n  quarticOut: function (k) {\n    return 1 - --k * k * k * k;\n  },\n\n  /**\n  * @param {number} k\n  * @return {number}\n  */\n  quarticInOut: function (k) {\n    if ((k *= 2) < 1) {\n      return 0.5 * k * k * k * k;\n    }\n\n    return -0.5 * ((k -= 2) * k * k * k - 2);\n  },\n  // t^5\n\n  /**\n  * @param {number} k\n  * @return {number}\n  */\n  quinticIn: function (k) {\n    return k * k * k * k * k;\n  },\n\n  /**\n  * @param {number} k\n  * @return {number}\n  */\n  quinticOut: function (k) {\n    return --k * k * k * k * k + 1;\n  },\n\n  /**\n  * @param {number} k\n  * @return {number}\n  */\n  quinticInOut: function (k) {\n    if ((k *= 2) < 1) {\n      return 0.5 * k * k * k * k * k;\n    }\n\n    return 0.5 * ((k -= 2) * k * k * k * k + 2);\n  },\n  // sin(t)\n\n  /**\n  * @param {number} k\n  * @return {number}\n  */\n  sinusoidalIn: function (k) {\n    return 1 - Math.cos(k * Math.PI / 2);\n  },\n\n  /**\n  * @param {number} k\n  * @return {number}\n  */\n  sinusoidalOut: function (k) {\n    return Math.sin(k * Math.PI / 2);\n  },\n\n  /**\n  * @param {number} k\n  * @return {number}\n  */\n  sinusoidalInOut: function (k) {\n    return 0.5 * (1 - Math.cos(Math.PI * k));\n  },\n  // 2^t\n\n  /**\n  * @param {number} k\n  * @return {number}\n  */\n  exponentialIn: function (k) {\n    return k === 0 ? 0 : Math.pow(1024, k - 1);\n  },\n\n  /**\n  * @param {number} k\n  * @return {number}\n  */\n  exponentialOut: function (k) {\n    return k === 1 ? 1 : 1 - Math.pow(2, -10 * k);\n  },\n\n  /**\n  * @param {number} k\n  * @return {number}\n  */\n  exponentialInOut: function (k) {\n    if (k === 0) {\n      return 0;\n    }\n\n    if (k === 1) {\n      return 1;\n    }\n\n    if ((k *= 2) < 1) {\n      return 0.5 * Math.pow(1024, k - 1);\n    }\n\n    return 0.5 * (-Math.pow(2, -10 * (k - 1)) + 2);\n  },\n  // sqrt(1-t^2)\n\n  /**\n  * @param {number} k\n  * @return {number}\n  */\n  circularIn: function (k) {\n    return 1 - Math.sqrt(1 - k * k);\n  },\n\n  /**\n  * @param {number} k\n  * @return {number}\n  */\n  circularOut: function (k) {\n    return Math.sqrt(1 - --k * k);\n  },\n\n  /**\n  * @param {number} k\n  * @return {number}\n  */\n  circularInOut: function (k) {\n    if ((k *= 2) < 1) {\n      return -0.5 * (Math.sqrt(1 - k * k) - 1);\n    }\n\n    return 0.5 * (Math.sqrt(1 - (k -= 2) * k) + 1);\n  },\n  // \n\n  /**\n  * @param {number} k\n  * @return {number}\n  */\n  elasticIn: function (k) {\n    var s;\n    var a = 0.1;\n    var p = 0.4;\n\n    if (k === 0) {\n      return 0;\n    }\n\n    if (k === 1) {\n      return 1;\n    }\n\n    if (!a || a < 1) {\n      a = 1;\n      s = p / 4;\n    } else {\n      s = p * Math.asin(1 / a) / (2 * Math.PI);\n    }\n\n    return -(a * Math.pow(2, 10 * (k -= 1)) * Math.sin((k - s) * (2 * Math.PI) / p));\n  },\n\n  /**\n  * @param {number} k\n  * @return {number}\n  */\n  elasticOut: function (k) {\n    var s;\n    var a = 0.1;\n    var p = 0.4;\n\n    if (k === 0) {\n      return 0;\n    }\n\n    if (k === 1) {\n      return 1;\n    }\n\n    if (!a || a < 1) {\n      a = 1;\n      s = p / 4;\n    } else {\n      s = p * Math.asin(1 / a) / (2 * Math.PI);\n    }\n\n    return a * Math.pow(2, -10 * k) * Math.sin((k - s) * (2 * Math.PI) / p) + 1;\n  },\n\n  /**\n  * @param {number} k\n  * @return {number}\n  */\n  elasticInOut: function (k) {\n    var s;\n    var a = 0.1;\n    var p = 0.4;\n\n    if (k === 0) {\n      return 0;\n    }\n\n    if (k === 1) {\n      return 1;\n    }\n\n    if (!a || a < 1) {\n      a = 1;\n      s = p / 4;\n    } else {\n      s = p * Math.asin(1 / a) / (2 * Math.PI);\n    }\n\n    if ((k *= 2) < 1) {\n      return -0.5 * (a * Math.pow(2, 10 * (k -= 1)) * Math.sin((k - s) * (2 * Math.PI) / p));\n    }\n\n    return a * Math.pow(2, -10 * (k -= 1)) * Math.sin((k - s) * (2 * Math.PI) / p) * 0.5 + 1;\n  },\n  // \n\n  /**\n  * @param {number} k\n  * @return {number}\n  */\n  backIn: function (k) {\n    var s = 1.70158;\n    return k * k * ((s + 1) * k - s);\n  },\n\n  /**\n  * @param {number} k\n  * @return {number}\n  */\n  backOut: function (k) {\n    var s = 1.70158;\n    return --k * k * ((s + 1) * k + s) + 1;\n  },\n\n  /**\n  * @param {number} k\n  * @return {number}\n  */\n  backInOut: function (k) {\n    var s = 1.70158 * 1.525;\n\n    if ((k *= 2) < 1) {\n      return 0.5 * (k * k * ((s + 1) * k - s));\n    }\n\n    return 0.5 * ((k -= 2) * k * ((s + 1) * k + s) + 2);\n  },\n  // \n\n  /**\n  * @param {number} k\n  * @return {number}\n  */\n  bounceIn: function (k) {\n    return 1 - easing.bounceOut(1 - k);\n  },\n\n  /**\n  * @param {number} k\n  * @return {number}\n  */\n  bounceOut: function (k) {\n    if (k < 1 / 2.75) {\n      return 7.5625 * k * k;\n    } else if (k < 2 / 2.75) {\n      return 7.5625 * (k -= 1.5 / 2.75) * k + 0.75;\n    } else if (k < 2.5 / 2.75) {\n      return 7.5625 * (k -= 2.25 / 2.75) * k + 0.9375;\n    } else {\n      return 7.5625 * (k -= 2.625 / 2.75) * k + 0.984375;\n    }\n  },\n\n  /**\n  * @param {number} k\n  * @return {number}\n  */\n  bounceInOut: function (k) {\n    if (k < 0.5) {\n      return easing.bounceIn(k * 2) * 0.5;\n    }\n\n    return easing.bounceOut(k * 2 - 1) * 0.5 + 0.5;\n  }\n};\n\n/**\n * \n * @config target onframe\n * @config life(1000) \n * @config delay(0) \n * @config loop(true)\n * @config gap(0) \n * @config onframe\n * @config easing(optional)\n * @config ondestroy(optional)\n * @config onrestart(optional)\n *\n * TODO pause\n */\nfunction Clip(options) {\n  this._target = options.target; // \n\n  this._life = options.life || 1000; // \n\n  this._delay = options.delay || 0; // \n  // this._startTime = new Date().getTime() + this._delay;// \n\n  this._initialized = false; // \n\n  this.loop = options.loop == null ? false : options.loop;\n  this.gap = options.gap || 0;\n  this.easing = options.easing || 'Linear';\n  this.onframe = options.onframe;\n  this.ondestroy = options.ondestroy;\n  this.onrestart = options.onrestart;\n  this._pausedTime = 0;\n  this._paused = false;\n}\n\nClip.prototype = {\n  constructor: Clip,\n  step: function (globalTime, deltaTime) {\n    // Set startTime on first step, or _startTime may has milleseconds different between clips\n    // PENDING\n    if (!this._initialized) {\n      this._startTime = globalTime + this._delay;\n      this._initialized = true;\n    }\n\n    if (this._paused) {\n      this._pausedTime += deltaTime;\n      return;\n    }\n\n    var percent = (globalTime - this._startTime - this._pausedTime) / this._life; // \n\n    if (percent < 0) {\n      return;\n    }\n\n    percent = Math.min(percent, 1);\n    var easing$$1 = this.easing;\n    var easingFunc = typeof easing$$1 == 'string' ? easing[easing$$1] : easing$$1;\n    var schedule = typeof easingFunc === 'function' ? easingFunc(percent) : percent;\n    this.fire('frame', schedule); // \n\n    if (percent == 1) {\n      if (this.loop) {\n        this.restart(globalTime); // \n        //  stage.update \n\n        return 'restart';\n      } // \n      // Animation.update\n\n\n      this._needsRemove = true;\n      return 'destroy';\n    }\n\n    return null;\n  },\n  restart: function (globalTime) {\n    var remainder = (globalTime - this._startTime - this._pausedTime) % this._life;\n    this._startTime = globalTime - remainder + this.gap;\n    this._pausedTime = 0;\n    this._needsRemove = false;\n  },\n  fire: function (eventType, arg) {\n    eventType = 'on' + eventType;\n\n    if (this[eventType]) {\n      this[eventType](this._target, arg);\n    }\n  },\n  pause: function () {\n    this._paused = true;\n  },\n  resume: function () {\n    this._paused = false;\n  }\n};\n\n// Simple LRU cache use doubly linked list\n// @module zrender/core/LRU\n\n/**\n * Simple double linked list. Compared with array, it has O(1) remove operation.\n * @constructor\n */\nvar LinkedList = function () {\n  /**\n   * @type {module:zrender/core/LRU~Entry}\n   */\n  this.head = null;\n  /**\n   * @type {module:zrender/core/LRU~Entry}\n   */\n\n  this.tail = null;\n  this._len = 0;\n};\n\nvar linkedListProto = LinkedList.prototype;\n/**\n * Insert a new value at the tail\n * @param  {} val\n * @return {module:zrender/core/LRU~Entry}\n */\n\nlinkedListProto.insert = function (val) {\n  var entry = new Entry(val);\n  this.insertEntry(entry);\n  return entry;\n};\n/**\n * Insert an entry at the tail\n * @param  {module:zrender/core/LRU~Entry} entry\n */\n\n\nlinkedListProto.insertEntry = function (entry) {\n  if (!this.head) {\n    this.head = this.tail = entry;\n  } else {\n    this.tail.next = entry;\n    entry.prev = this.tail;\n    entry.next = null;\n    this.tail = entry;\n  }\n\n  this._len++;\n};\n/**\n * Remove entry.\n * @param  {module:zrender/core/LRU~Entry} entry\n */\n\n\nlinkedListProto.remove = function (entry) {\n  var prev = entry.prev;\n  var next = entry.next;\n\n  if (prev) {\n    prev.next = next;\n  } else {\n    // Is head\n    this.head = next;\n  }\n\n  if (next) {\n    next.prev = prev;\n  } else {\n    // Is tail\n    this.tail = prev;\n  }\n\n  entry.next = entry.prev = null;\n  this._len--;\n};\n/**\n * @return {number}\n */\n\n\nlinkedListProto.len = function () {\n  return this._len;\n};\n/**\n * Clear list\n */\n\n\nlinkedListProto.clear = function () {\n  this.head = this.tail = null;\n  this._len = 0;\n};\n/**\n * @constructor\n * @param {} val\n */\n\n\nvar Entry = function (val) {\n  /**\n   * @type {}\n   */\n  this.value = val;\n  /**\n   * @type {module:zrender/core/LRU~Entry}\n   */\n\n  this.next;\n  /**\n   * @type {module:zrender/core/LRU~Entry}\n   */\n\n  this.prev;\n};\n/**\n * LRU Cache\n * @constructor\n * @alias module:zrender/core/LRU\n */\n\n\nvar LRU = function (maxSize) {\n  this._list = new LinkedList();\n  this._map = {};\n  this._maxSize = maxSize || 10;\n  this._lastRemovedEntry = null;\n};\n\nvar LRUProto = LRU.prototype;\n/**\n * @param  {string} key\n * @param  {} value\n * @return {} Removed value\n */\n\nLRUProto.put = function (key, value) {\n  var list = this._list;\n  var map = this._map;\n  var removed = null;\n\n  if (map[key] == null) {\n    var len = list.len(); // Reuse last removed entry\n\n    var entry = this._lastRemovedEntry;\n\n    if (len >= this._maxSize && len > 0) {\n      // Remove the least recently used\n      var leastUsedEntry = list.head;\n      list.remove(leastUsedEntry);\n      delete map[leastUsedEntry.key];\n      removed = leastUsedEntry.value;\n      this._lastRemovedEntry = leastUsedEntry;\n    }\n\n    if (entry) {\n      entry.value = value;\n    } else {\n      entry = new Entry(value);\n    }\n\n    entry.key = key;\n    list.insertEntry(entry);\n    map[key] = entry;\n  }\n\n  return removed;\n};\n/**\n * @param  {string} key\n * @return {}\n */\n\n\nLRUProto.get = function (key) {\n  var entry = this._map[key];\n  var list = this._list;\n\n  if (entry != null) {\n    // Put the latest used entry in the tail\n    if (entry !== list.tail) {\n      list.remove(entry);\n      list.insertEntry(entry);\n    }\n\n    return entry.value;\n  }\n};\n/**\n * Clear the cache\n */\n\n\nLRUProto.clear = function () {\n  this._list.clear();\n\n  this._map = {};\n};\n\nvar kCSSColorTable = {\n  'transparent': [0, 0, 0, 0],\n  'aliceblue': [240, 248, 255, 1],\n  'antiquewhite': [250, 235, 215, 1],\n  'aqua': [0, 255, 255, 1],\n  'aquamarine': [127, 255, 212, 1],\n  'azure': [240, 255, 255, 1],\n  'beige': [245, 245, 220, 1],\n  'bisque': [255, 228, 196, 1],\n  'black': [0, 0, 0, 1],\n  'blanchedalmond': [255, 235, 205, 1],\n  'blue': [0, 0, 255, 1],\n  'blueviolet': [138, 43, 226, 1],\n  'brown': [165, 42, 42, 1],\n  'burlywood': [222, 184, 135, 1],\n  'cadetblue': [95, 158, 160, 1],\n  'chartreuse': [127, 255, 0, 1],\n  'chocolate': [210, 105, 30, 1],\n  'coral': [255, 127, 80, 1],\n  'cornflowerblue': [100, 149, 237, 1],\n  'cornsilk': [255, 248, 220, 1],\n  'crimson': [220, 20, 60, 1],\n  'cyan': [0, 255, 255, 1],\n  'darkblue': [0, 0, 139, 1],\n  'darkcyan': [0, 139, 139, 1],\n  'darkgoldenrod': [184, 134, 11, 1],\n  'darkgray': [169, 169, 169, 1],\n  'darkgreen': [0, 100, 0, 1],\n  'darkgrey': [169, 169, 169, 1],\n  'darkkhaki': [189, 183, 107, 1],\n  'darkmagenta': [139, 0, 139, 1],\n  'darkolivegreen': [85, 107, 47, 1],\n  'darkorange': [255, 140, 0, 1],\n  'darkorchid': [153, 50, 204, 1],\n  'darkred': [139, 0, 0, 1],\n  'darksalmon': [233, 150, 122, 1],\n  'darkseagreen': [143, 188, 143, 1],\n  'darkslateblue': [72, 61, 139, 1],\n  'darkslategray': [47, 79, 79, 1],\n  'darkslategrey': [47, 79, 79, 1],\n  'darkturquoise': [0, 206, 209, 1],\n  'darkviolet': [148, 0, 211, 1],\n  'deeppink': [255, 20, 147, 1],\n  'deepskyblue': [0, 191, 255, 1],\n  'dimgray': [105, 105, 105, 1],\n  'dimgrey': [105, 105, 105, 1],\n  'dodgerblue': [30, 144, 255, 1],\n  'firebrick': [178, 34, 34, 1],\n  'floralwhite': [255, 250, 240, 1],\n  'forestgreen': [34, 139, 34, 1],\n  'fuchsia': [255, 0, 255, 1],\n  'gainsboro': [220, 220, 220, 1],\n  'ghostwhite': [248, 248, 255, 1],\n  'gold': [255, 215, 0, 1],\n  'goldenrod': [218, 165, 32, 1],\n  'gray': [128, 128, 128, 1],\n  'green': [0, 128, 0, 1],\n  'greenyellow': [173, 255, 47, 1],\n  'grey': [128, 128, 128, 1],\n  'honeydew': [240, 255, 240, 1],\n  'hotpink': [255, 105, 180, 1],\n  'indianred': [205, 92, 92, 1],\n  'indigo': [75, 0, 130, 1],\n  'ivory': [255, 255, 240, 1],\n  'khaki': [240, 230, 140, 1],\n  'lavender': [230, 230, 250, 1],\n  'lavenderblush': [255, 240, 245, 1],\n  'lawngreen': [124, 252, 0, 1],\n  'lemonchiffon': [255, 250, 205, 1],\n  'lightblue': [173, 216, 230, 1],\n  'lightcoral': [240, 128, 128, 1],\n  'lightcyan': [224, 255, 255, 1],\n  'lightgoldenrodyellow': [250, 250, 210, 1],\n  'lightgray': [211, 211, 211, 1],\n  'lightgreen': [144, 238, 144, 1],\n  'lightgrey': [211, 211, 211, 1],\n  'lightpink': [255, 182, 193, 1],\n  'lightsalmon': [255, 160, 122, 1],\n  'lightseagreen': [32, 178, 170, 1],\n  'lightskyblue': [135, 206, 250, 1],\n  'lightslategray': [119, 136, 153, 1],\n  'lightslategrey': [119, 136, 153, 1],\n  'lightsteelblue': [176, 196, 222, 1],\n  'lightyellow': [255, 255, 224, 1],\n  'lime': [0, 255, 0, 1],\n  'limegreen': [50, 205, 50, 1],\n  'linen': [250, 240, 230, 1],\n  'magenta': [255, 0, 255, 1],\n  'maroon': [128, 0, 0, 1],\n  'mediumaquamarine': [102, 205, 170, 1],\n  'mediumblue': [0, 0, 205, 1],\n  'mediumorchid': [186, 85, 211, 1],\n  'mediumpurple': [147, 112, 219, 1],\n  'mediumseagreen': [60, 179, 113, 1],\n  'mediumslateblue': [123, 104, 238, 1],\n  'mediumspringgreen': [0, 250, 154, 1],\n  'mediumturquoise': [72, 209, 204, 1],\n  'mediumvioletred': [199, 21, 133, 1],\n  'midnightblue': [25, 25, 112, 1],\n  'mintcream': [245, 255, 250, 1],\n  'mistyrose': [255, 228, 225, 1],\n  'moccasin': [255, 228, 181, 1],\n  'navajowhite': [255, 222, 173, 1],\n  'navy': [0, 0, 128, 1],\n  'oldlace': [253, 245, 230, 1],\n  'olive': [128, 128, 0, 1],\n  'olivedrab': [107, 142, 35, 1],\n  'orange': [255, 165, 0, 1],\n  'orangered': [255, 69, 0, 1],\n  'orchid': [218, 112, 214, 1],\n  'palegoldenrod': [238, 232, 170, 1],\n  'palegreen': [152, 251, 152, 1],\n  'paleturquoise': [175, 238, 238, 1],\n  'palevioletred': [219, 112, 147, 1],\n  'papayawhip': [255, 239, 213, 1],\n  'peachpuff': [255, 218, 185, 1],\n  'peru': [205, 133, 63, 1],\n  'pink': [255, 192, 203, 1],\n  'plum': [221, 160, 221, 1],\n  'powderblue': [176, 224, 230, 1],\n  'purple': [128, 0, 128, 1],\n  'red': [255, 0, 0, 1],\n  'rosybrown': [188, 143, 143, 1],\n  'royalblue': [65, 105, 225, 1],\n  'saddlebrown': [139, 69, 19, 1],\n  'salmon': [250, 128, 114, 1],\n  'sandybrown': [244, 164, 96, 1],\n  'seagreen': [46, 139, 87, 1],\n  'seashell': [255, 245, 238, 1],\n  'sienna': [160, 82, 45, 1],\n  'silver': [192, 192, 192, 1],\n  'skyblue': [135, 206, 235, 1],\n  'slateblue': [106, 90, 205, 1],\n  'slategray': [112, 128, 144, 1],\n  'slategrey': [112, 128, 144, 1],\n  'snow': [255, 250, 250, 1],\n  'springgreen': [0, 255, 127, 1],\n  'steelblue': [70, 130, 180, 1],\n  'tan': [210, 180, 140, 1],\n  'teal': [0, 128, 128, 1],\n  'thistle': [216, 191, 216, 1],\n  'tomato': [255, 99, 71, 1],\n  'turquoise': [64, 224, 208, 1],\n  'violet': [238, 130, 238, 1],\n  'wheat': [245, 222, 179, 1],\n  'white': [255, 255, 255, 1],\n  'whitesmoke': [245, 245, 245, 1],\n  'yellow': [255, 255, 0, 1],\n  'yellowgreen': [154, 205, 50, 1]\n};\n\nfunction clampCssByte(i) {\n  // Clamp to integer 0 .. 255.\n  i = Math.round(i); // Seems to be what Chrome does (vs truncation).\n\n  return i < 0 ? 0 : i > 255 ? 255 : i;\n}\n\nfunction clampCssAngle(i) {\n  // Clamp to integer 0 .. 360.\n  i = Math.round(i); // Seems to be what Chrome does (vs truncation).\n\n  return i < 0 ? 0 : i > 360 ? 360 : i;\n}\n\nfunction clampCssFloat(f) {\n  // Clamp to float 0.0 .. 1.0.\n  return f < 0 ? 0 : f > 1 ? 1 : f;\n}\n\nfunction parseCssInt(str) {\n  // int or percentage.\n  if (str.length && str.charAt(str.length - 1) === '%') {\n    return clampCssByte(parseFloat(str) / 100 * 255);\n  }\n\n  return clampCssByte(parseInt(str, 10));\n}\n\nfunction parseCssFloat(str) {\n  // float or percentage.\n  if (str.length && str.charAt(str.length - 1) === '%') {\n    return clampCssFloat(parseFloat(str) / 100);\n  }\n\n  return clampCssFloat(parseFloat(str));\n}\n\nfunction cssHueToRgb(m1, m2, h) {\n  if (h < 0) {\n    h += 1;\n  } else if (h > 1) {\n    h -= 1;\n  }\n\n  if (h * 6 < 1) {\n    return m1 + (m2 - m1) * h * 6;\n  }\n\n  if (h * 2 < 1) {\n    return m2;\n  }\n\n  if (h * 3 < 2) {\n    return m1 + (m2 - m1) * (2 / 3 - h) * 6;\n  }\n\n  return m1;\n}\n\nfunction lerpNumber(a, b, p) {\n  return a + (b - a) * p;\n}\n\nfunction setRgba(out, r, g, b, a) {\n  out[0] = r;\n  out[1] = g;\n  out[2] = b;\n  out[3] = a;\n  return out;\n}\n\nfunction copyRgba(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n\nvar colorCache = new LRU(20);\nvar lastRemovedArr = null;\n\nfunction putToCache(colorStr, rgbaArr) {\n  // Reuse removed array\n  if (lastRemovedArr) {\n    copyRgba(lastRemovedArr, rgbaArr);\n  }\n\n  lastRemovedArr = colorCache.put(colorStr, lastRemovedArr || rgbaArr.slice());\n}\n/**\n * @param {string} colorStr\n * @param {Array.<number>} out\n * @return {Array.<number>}\n * @memberOf module:zrender/util/color\n */\n\n\nfunction parse(colorStr, rgbaArr) {\n  if (!colorStr) {\n    return;\n  }\n\n  rgbaArr = rgbaArr || [];\n  var cached = colorCache.get(colorStr);\n\n  if (cached) {\n    return copyRgba(rgbaArr, cached);\n  } // colorStr may be not string\n\n\n  colorStr = colorStr + ''; // Remove all whitespace, not compliant, but should just be more accepting.\n\n  var str = colorStr.replace(/ /g, '').toLowerCase(); // Color keywords (and transparent) lookup.\n\n  if (str in kCSSColorTable) {\n    copyRgba(rgbaArr, kCSSColorTable[str]);\n    putToCache(colorStr, rgbaArr);\n    return rgbaArr;\n  } // #abc and #abc123 syntax.\n\n\n  if (str.charAt(0) === '#') {\n    if (str.length === 4) {\n      var iv = parseInt(str.substr(1), 16); // TODO(deanm): Stricter parsing.\n\n      if (!(iv >= 0 && iv <= 0xfff)) {\n        setRgba(rgbaArr, 0, 0, 0, 1);\n        return; // Covers NaN.\n      }\n\n      setRgba(rgbaArr, (iv & 0xf00) >> 4 | (iv & 0xf00) >> 8, iv & 0xf0 | (iv & 0xf0) >> 4, iv & 0xf | (iv & 0xf) << 4, 1);\n      putToCache(colorStr, rgbaArr);\n      return rgbaArr;\n    } else if (str.length === 7) {\n      var iv = parseInt(str.substr(1), 16); // TODO(deanm): Stricter parsing.\n\n      if (!(iv >= 0 && iv <= 0xffffff)) {\n        setRgba(rgbaArr, 0, 0, 0, 1);\n        return; // Covers NaN.\n      }\n\n      setRgba(rgbaArr, (iv & 0xff0000) >> 16, (iv & 0xff00) >> 8, iv & 0xff, 1);\n      putToCache(colorStr, rgbaArr);\n      return rgbaArr;\n    }\n\n    return;\n  }\n\n  var op = str.indexOf('('),\n      ep = str.indexOf(')');\n\n  if (op !== -1 && ep + 1 === str.length) {\n    var fname = str.substr(0, op);\n    var params = str.substr(op + 1, ep - (op + 1)).split(',');\n    var alpha = 1; // To allow case fallthrough.\n\n    switch (fname) {\n      case 'rgba':\n        if (params.length !== 4) {\n          setRgba(rgbaArr, 0, 0, 0, 1);\n          return;\n        }\n\n        alpha = parseCssFloat(params.pop());\n      // jshint ignore:line\n      // Fall through.\n\n      case 'rgb':\n        if (params.length !== 3) {\n          setRgba(rgbaArr, 0, 0, 0, 1);\n          return;\n        }\n\n        setRgba(rgbaArr, parseCssInt(params[0]), parseCssInt(params[1]), parseCssInt(params[2]), alpha);\n        putToCache(colorStr, rgbaArr);\n        return rgbaArr;\n\n      case 'hsla':\n        if (params.length !== 4) {\n          setRgba(rgbaArr, 0, 0, 0, 1);\n          return;\n        }\n\n        params[3] = parseCssFloat(params[3]);\n        hsla2rgba(params, rgbaArr);\n        putToCache(colorStr, rgbaArr);\n        return rgbaArr;\n\n      case 'hsl':\n        if (params.length !== 3) {\n          setRgba(rgbaArr, 0, 0, 0, 1);\n          return;\n        }\n\n        hsla2rgba(params, rgbaArr);\n        putToCache(colorStr, rgbaArr);\n        return rgbaArr;\n\n      default:\n        return;\n    }\n  }\n\n  setRgba(rgbaArr, 0, 0, 0, 1);\n  return;\n}\n/**\n * @param {Array.<number>} hsla\n * @param {Array.<number>} rgba\n * @return {Array.<number>} rgba\n */\n\nfunction hsla2rgba(hsla, rgba) {\n  var h = (parseFloat(hsla[0]) % 360 + 360) % 360 / 360; // 0 .. 1\n  // NOTE(deanm): According to the CSS spec s/l should only be\n  // percentages, but we don't bother and let float or percentage.\n\n  var s = parseCssFloat(hsla[1]);\n  var l = parseCssFloat(hsla[2]);\n  var m2 = l <= 0.5 ? l * (s + 1) : l + s - l * s;\n  var m1 = l * 2 - m2;\n  rgba = rgba || [];\n  setRgba(rgba, clampCssByte(cssHueToRgb(m1, m2, h + 1 / 3) * 255), clampCssByte(cssHueToRgb(m1, m2, h) * 255), clampCssByte(cssHueToRgb(m1, m2, h - 1 / 3) * 255), 1);\n\n  if (hsla.length === 4) {\n    rgba[3] = hsla[3];\n  }\n\n  return rgba;\n}\n/**\n * @param {Array.<number>} rgba\n * @return {Array.<number>} hsla\n */\n\n\nfunction rgba2hsla(rgba) {\n  if (!rgba) {\n    return;\n  } // RGB from 0 to 255\n\n\n  var R = rgba[0] / 255;\n  var G = rgba[1] / 255;\n  var B = rgba[2] / 255;\n  var vMin = Math.min(R, G, B); // Min. value of RGB\n\n  var vMax = Math.max(R, G, B); // Max. value of RGB\n\n  var delta = vMax - vMin; // Delta RGB value\n\n  var L = (vMax + vMin) / 2;\n  var H;\n  var S; // HSL results from 0 to 1\n\n  if (delta === 0) {\n    H = 0;\n    S = 0;\n  } else {\n    if (L < 0.5) {\n      S = delta / (vMax + vMin);\n    } else {\n      S = delta / (2 - vMax - vMin);\n    }\n\n    var deltaR = ((vMax - R) / 6 + delta / 2) / delta;\n    var deltaG = ((vMax - G) / 6 + delta / 2) / delta;\n    var deltaB = ((vMax - B) / 6 + delta / 2) / delta;\n\n    if (R === vMax) {\n      H = deltaB - deltaG;\n    } else if (G === vMax) {\n      H = 1 / 3 + deltaR - deltaB;\n    } else if (B === vMax) {\n      H = 2 / 3 + deltaG - deltaR;\n    }\n\n    if (H < 0) {\n      H += 1;\n    }\n\n    if (H > 1) {\n      H -= 1;\n    }\n  }\n\n  var hsla = [H * 360, S, L];\n\n  if (rgba[3] != null) {\n    hsla.push(rgba[3]);\n  }\n\n  return hsla;\n}\n/**\n * @param {string} color\n * @param {number} level\n * @return {string}\n * @memberOf module:zrender/util/color\n */\n\n\nfunction lift(color, level) {\n  var colorArr = parse(color);\n\n  if (colorArr) {\n    for (var i = 0; i < 3; i++) {\n      if (level < 0) {\n        colorArr[i] = colorArr[i] * (1 - level) | 0;\n      } else {\n        colorArr[i] = (255 - colorArr[i]) * level + colorArr[i] | 0;\n      }\n\n      if (colorArr[i] > 255) {\n        colorArr[i] = 255;\n      } else if (color[i] < 0) {\n        colorArr[i] = 0;\n      }\n    }\n\n    return stringify(colorArr, colorArr.length === 4 ? 'rgba' : 'rgb');\n  }\n}\n/**\n * @param {string} color\n * @return {string}\n * @memberOf module:zrender/util/color\n */\n\nfunction toHex(color) {\n  var colorArr = parse(color);\n\n  if (colorArr) {\n    return ((1 << 24) + (colorArr[0] << 16) + (colorArr[1] << 8) + +colorArr[2]).toString(16).slice(1);\n  }\n}\n/**\n * Map value to color. Faster than lerp methods because color is represented by rgba array.\n * @param {number} normalizedValue A float between 0 and 1.\n * @param {Array.<Array.<number>>} colors List of rgba color array\n * @param {Array.<number>} [out] Mapped gba color array\n * @return {Array.<number>} will be null/undefined if input illegal.\n */\n\nfunction fastLerp(normalizedValue, colors, out) {\n  if (!(colors && colors.length) || !(normalizedValue >= 0 && normalizedValue <= 1)) {\n    return;\n  }\n\n  out = out || [];\n  var value = normalizedValue * (colors.length - 1);\n  var leftIndex = Math.floor(value);\n  var rightIndex = Math.ceil(value);\n  var leftColor = colors[leftIndex];\n  var rightColor = colors[rightIndex];\n  var dv = value - leftIndex;\n  out[0] = clampCssByte(lerpNumber(leftColor[0], rightColor[0], dv));\n  out[1] = clampCssByte(lerpNumber(leftColor[1], rightColor[1], dv));\n  out[2] = clampCssByte(lerpNumber(leftColor[2], rightColor[2], dv));\n  out[3] = clampCssFloat(lerpNumber(leftColor[3], rightColor[3], dv));\n  return out;\n}\n/**\n * @deprecated\n */\n\nvar fastMapToColor = fastLerp;\n/**\n * @param {number} normalizedValue A float between 0 and 1.\n * @param {Array.<string>} colors Color list.\n * @param {boolean=} fullOutput Default false.\n * @return {(string|Object)} Result color. If fullOutput,\n *                           return {color: ..., leftIndex: ..., rightIndex: ..., value: ...},\n * @memberOf module:zrender/util/color\n */\n\nfunction lerp$1(normalizedValue, colors, fullOutput) {\n  if (!(colors && colors.length) || !(normalizedValue >= 0 && normalizedValue <= 1)) {\n    return;\n  }\n\n  var value = normalizedValue * (colors.length - 1);\n  var leftIndex = Math.floor(value);\n  var rightIndex = Math.ceil(value);\n  var leftColor = parse(colors[leftIndex]);\n  var rightColor = parse(colors[rightIndex]);\n  var dv = value - leftIndex;\n  var color = stringify([clampCssByte(lerpNumber(leftColor[0], rightColor[0], dv)), clampCssByte(lerpNumber(leftColor[1], rightColor[1], dv)), clampCssByte(lerpNumber(leftColor[2], rightColor[2], dv)), clampCssFloat(lerpNumber(leftColor[3], rightColor[3], dv))], 'rgba');\n  return fullOutput ? {\n    color: color,\n    leftIndex: leftIndex,\n    rightIndex: rightIndex,\n    value: value\n  } : color;\n}\n/**\n * @deprecated\n */\n\nvar mapToColor = lerp$1;\n/**\n * @param {string} color\n * @param {number=} h 0 ~ 360, ignore when null.\n * @param {number=} s 0 ~ 1, ignore when null.\n * @param {number=} l 0 ~ 1, ignore when null.\n * @return {string} Color string in rgba format.\n * @memberOf module:zrender/util/color\n */\n\nfunction modifyHSL(color, h, s, l) {\n  color = parse(color);\n\n  if (color) {\n    color = rgba2hsla(color);\n    h != null && (color[0] = clampCssAngle(h));\n    s != null && (color[1] = parseCssFloat(s));\n    l != null && (color[2] = parseCssFloat(l));\n    return stringify(hsla2rgba(color), 'rgba');\n  }\n}\n/**\n * @param {string} color\n * @param {number=} alpha 0 ~ 1\n * @return {string} Color string in rgba format.\n * @memberOf module:zrender/util/color\n */\n\nfunction modifyAlpha(color, alpha) {\n  color = parse(color);\n\n  if (color && alpha != null) {\n    color[3] = clampCssFloat(alpha);\n    return stringify(color, 'rgba');\n  }\n}\n/**\n * @param {Array.<number>} arrColor like [12,33,44,0.4]\n * @param {string} type 'rgba', 'hsva', ...\n * @return {string} Result color. (If input illegal, return undefined).\n */\n\nfunction stringify(arrColor, type) {\n  if (!arrColor || !arrColor.length) {\n    return;\n  }\n\n  var colorStr = arrColor[0] + ',' + arrColor[1] + ',' + arrColor[2];\n\n  if (type === 'rgba' || type === 'hsva' || type === 'hsla') {\n    colorStr += ',' + arrColor[3];\n  }\n\n  return type + '(' + colorStr + ')';\n}\n\nvar color = (Object.freeze || Object)({\n\tparse: parse,\n\tlift: lift,\n\ttoHex: toHex,\n\tfastLerp: fastLerp,\n\tfastMapToColor: fastMapToColor,\n\tlerp: lerp$1,\n\tmapToColor: mapToColor,\n\tmodifyHSL: modifyHSL,\n\tmodifyAlpha: modifyAlpha,\n\tstringify: stringify\n});\n\n/**\n * @module echarts/animation/Animator\n */\nvar arraySlice = Array.prototype.slice;\n\nfunction defaultGetter(target, key) {\n  return target[key];\n}\n\nfunction defaultSetter(target, key, value) {\n  target[key] = value;\n}\n/**\n * @param  {number} p0\n * @param  {number} p1\n * @param  {number} percent\n * @return {number}\n */\n\n\nfunction interpolateNumber(p0, p1, percent) {\n  return (p1 - p0) * percent + p0;\n}\n/**\n * @param  {string} p0\n * @param  {string} p1\n * @param  {number} percent\n * @return {string}\n */\n\n\nfunction interpolateString(p0, p1, percent) {\n  return percent > 0.5 ? p1 : p0;\n}\n/**\n * @param  {Array} p0\n * @param  {Array} p1\n * @param  {number} percent\n * @param  {Array} out\n * @param  {number} arrDim\n */\n\n\nfunction interpolateArray(p0, p1, percent, out, arrDim) {\n  var len = p0.length;\n\n  if (arrDim == 1) {\n    for (var i = 0; i < len; i++) {\n      out[i] = interpolateNumber(p0[i], p1[i], percent);\n    }\n  } else {\n    var len2 = len && p0[0].length;\n\n    for (var i = 0; i < len; i++) {\n      for (var j = 0; j < len2; j++) {\n        out[i][j] = interpolateNumber(p0[i][j], p1[i][j], percent);\n      }\n    }\n  }\n} // arr0 is source array, arr1 is target array.\n// Do some preprocess to avoid error happened when interpolating from arr0 to arr1\n\n\nfunction fillArr(arr0, arr1, arrDim) {\n  var arr0Len = arr0.length;\n  var arr1Len = arr1.length;\n\n  if (arr0Len !== arr1Len) {\n    // FIXME Not work for TypedArray\n    var isPreviousLarger = arr0Len > arr1Len;\n\n    if (isPreviousLarger) {\n      // Cut the previous\n      arr0.length = arr1Len;\n    } else {\n      // Fill the previous\n      for (var i = arr0Len; i < arr1Len; i++) {\n        arr0.push(arrDim === 1 ? arr1[i] : arraySlice.call(arr1[i]));\n      }\n    }\n  } // Handling NaN value\n\n\n  var len2 = arr0[0] && arr0[0].length;\n\n  for (var i = 0; i < arr0.length; i++) {\n    if (arrDim === 1) {\n      if (isNaN(arr0[i])) {\n        arr0[i] = arr1[i];\n      }\n    } else {\n      for (var j = 0; j < len2; j++) {\n        if (isNaN(arr0[i][j])) {\n          arr0[i][j] = arr1[i][j];\n        }\n      }\n    }\n  }\n}\n/**\n * @param  {Array} arr0\n * @param  {Array} arr1\n * @param  {number} arrDim\n * @return {boolean}\n */\n\n\nfunction isArraySame(arr0, arr1, arrDim) {\n  if (arr0 === arr1) {\n    return true;\n  }\n\n  var len = arr0.length;\n\n  if (len !== arr1.length) {\n    return false;\n  }\n\n  if (arrDim === 1) {\n    for (var i = 0; i < len; i++) {\n      if (arr0[i] !== arr1[i]) {\n        return false;\n      }\n    }\n  } else {\n    var len2 = arr0[0].length;\n\n    for (var i = 0; i < len; i++) {\n      for (var j = 0; j < len2; j++) {\n        if (arr0[i][j] !== arr1[i][j]) {\n          return false;\n        }\n      }\n    }\n  }\n\n  return true;\n}\n/**\n * Catmull Rom interpolate array\n * @param  {Array} p0\n * @param  {Array} p1\n * @param  {Array} p2\n * @param  {Array} p3\n * @param  {number} t\n * @param  {number} t2\n * @param  {number} t3\n * @param  {Array} out\n * @param  {number} arrDim\n */\n\n\nfunction catmullRomInterpolateArray(p0, p1, p2, p3, t, t2, t3, out, arrDim) {\n  var len = p0.length;\n\n  if (arrDim == 1) {\n    for (var i = 0; i < len; i++) {\n      out[i] = catmullRomInterpolate(p0[i], p1[i], p2[i], p3[i], t, t2, t3);\n    }\n  } else {\n    var len2 = p0[0].length;\n\n    for (var i = 0; i < len; i++) {\n      for (var j = 0; j < len2; j++) {\n        out[i][j] = catmullRomInterpolate(p0[i][j], p1[i][j], p2[i][j], p3[i][j], t, t2, t3);\n      }\n    }\n  }\n}\n/**\n * Catmull Rom interpolate number\n * @param  {number} p0\n * @param  {number} p1\n * @param  {number} p2\n * @param  {number} p3\n * @param  {number} t\n * @param  {number} t2\n * @param  {number} t3\n * @return {number}\n */\n\n\nfunction catmullRomInterpolate(p0, p1, p2, p3, t, t2, t3) {\n  var v0 = (p2 - p0) * 0.5;\n  var v1 = (p3 - p1) * 0.5;\n  return (2 * (p1 - p2) + v0 + v1) * t3 + (-3 * (p1 - p2) - 2 * v0 - v1) * t2 + v0 * t + p1;\n}\n\nfunction cloneValue(value) {\n  if (isArrayLike(value)) {\n    var len = value.length;\n\n    if (isArrayLike(value[0])) {\n      var ret = [];\n\n      for (var i = 0; i < len; i++) {\n        ret.push(arraySlice.call(value[i]));\n      }\n\n      return ret;\n    }\n\n    return arraySlice.call(value);\n  }\n\n  return value;\n}\n\nfunction rgba2String(rgba) {\n  rgba[0] = Math.floor(rgba[0]);\n  rgba[1] = Math.floor(rgba[1]);\n  rgba[2] = Math.floor(rgba[2]);\n  return 'rgba(' + rgba.join(',') + ')';\n}\n\nfunction getArrayDim(keyframes) {\n  var lastValue = keyframes[keyframes.length - 1].value;\n  return isArrayLike(lastValue && lastValue[0]) ? 2 : 1;\n}\n\nfunction createTrackClip(animator, easing, oneTrackDone, keyframes, propName, forceAnimate) {\n  var getter = animator._getter;\n  var setter = animator._setter;\n  var useSpline = easing === 'spline';\n  var trackLen = keyframes.length;\n\n  if (!trackLen) {\n    return;\n  } // Guess data type\n\n\n  var firstVal = keyframes[0].value;\n  var isValueArray = isArrayLike(firstVal);\n  var isValueColor = false;\n  var isValueString = false; // For vertices morphing\n\n  var arrDim = isValueArray ? getArrayDim(keyframes) : 0;\n  var trackMaxTime; // Sort keyframe as ascending\n\n  keyframes.sort(function (a, b) {\n    return a.time - b.time;\n  });\n  trackMaxTime = keyframes[trackLen - 1].time; // Percents of each keyframe\n\n  var kfPercents = []; // Value of each keyframe\n\n  var kfValues = [];\n  var prevValue = keyframes[0].value;\n  var isAllValueEqual = true;\n\n  for (var i = 0; i < trackLen; i++) {\n    kfPercents.push(keyframes[i].time / trackMaxTime); // Assume value is a color when it is a string\n\n    var value = keyframes[i].value; // Check if value is equal, deep check if value is array\n\n    if (!(isValueArray && isArraySame(value, prevValue, arrDim) || !isValueArray && value === prevValue)) {\n      isAllValueEqual = false;\n    }\n\n    prevValue = value; // Try converting a string to a color array\n\n    if (typeof value == 'string') {\n      var colorArray = parse(value);\n\n      if (colorArray) {\n        value = colorArray;\n        isValueColor = true;\n      } else {\n        isValueString = true;\n      }\n    }\n\n    kfValues.push(value);\n  }\n\n  if (!forceAnimate && isAllValueEqual) {\n    return;\n  }\n\n  var lastValue = kfValues[trackLen - 1]; // Polyfill array and NaN value\n\n  for (var i = 0; i < trackLen - 1; i++) {\n    if (isValueArray) {\n      fillArr(kfValues[i], lastValue, arrDim);\n    } else {\n      if (isNaN(kfValues[i]) && !isNaN(lastValue) && !isValueString && !isValueColor) {\n        kfValues[i] = lastValue;\n      }\n    }\n  }\n\n  isValueArray && fillArr(getter(animator._target, propName), lastValue, arrDim); // Cache the key of last frame to speed up when\n  // animation playback is sequency\n\n  var lastFrame = 0;\n  var lastFramePercent = 0;\n  var start;\n  var w;\n  var p0;\n  var p1;\n  var p2;\n  var p3;\n\n  if (isValueColor) {\n    var rgba = [0, 0, 0, 0];\n  }\n\n  var onframe = function (target, percent) {\n    // Find the range keyframes\n    // kf1-----kf2---------current--------kf3\n    // find kf2 and kf3 and do interpolation\n    var frame; // In the easing function like elasticOut, percent may less than 0\n\n    if (percent < 0) {\n      frame = 0;\n    } else if (percent < lastFramePercent) {\n      // Start from next key\n      // PENDING start from lastFrame ?\n      start = Math.min(lastFrame + 1, trackLen - 1);\n\n      for (frame = start; frame >= 0; frame--) {\n        if (kfPercents[frame] <= percent) {\n          break;\n        }\n      } // PENDING really need to do this ?\n\n\n      frame = Math.min(frame, trackLen - 2);\n    } else {\n      for (frame = lastFrame; frame < trackLen; frame++) {\n        if (kfPercents[frame] > percent) {\n          break;\n        }\n      }\n\n      frame = Math.min(frame - 1, trackLen - 2);\n    }\n\n    lastFrame = frame;\n    lastFramePercent = percent;\n    var range = kfPercents[frame + 1] - kfPercents[frame];\n\n    if (range === 0) {\n      return;\n    } else {\n      w = (percent - kfPercents[frame]) / range;\n    }\n\n    if (useSpline) {\n      p1 = kfValues[frame];\n      p0 = kfValues[frame === 0 ? frame : frame - 1];\n      p2 = kfValues[frame > trackLen - 2 ? trackLen - 1 : frame + 1];\n      p3 = kfValues[frame > trackLen - 3 ? trackLen - 1 : frame + 2];\n\n      if (isValueArray) {\n        catmullRomInterpolateArray(p0, p1, p2, p3, w, w * w, w * w * w, getter(target, propName), arrDim);\n      } else {\n        var value;\n\n        if (isValueColor) {\n          value = catmullRomInterpolateArray(p0, p1, p2, p3, w, w * w, w * w * w, rgba, 1);\n          value = rgba2String(rgba);\n        } else if (isValueString) {\n          // String is step(0.5)\n          return interpolateString(p1, p2, w);\n        } else {\n          value = catmullRomInterpolate(p0, p1, p2, p3, w, w * w, w * w * w);\n        }\n\n        setter(target, propName, value);\n      }\n    } else {\n      if (isValueArray) {\n        interpolateArray(kfValues[frame], kfValues[frame + 1], w, getter(target, propName), arrDim);\n      } else {\n        var value;\n\n        if (isValueColor) {\n          interpolateArray(kfValues[frame], kfValues[frame + 1], w, rgba, 1);\n          value = rgba2String(rgba);\n        } else if (isValueString) {\n          // String is step(0.5)\n          return interpolateString(kfValues[frame], kfValues[frame + 1], w);\n        } else {\n          value = interpolateNumber(kfValues[frame], kfValues[frame + 1], w);\n        }\n\n        setter(target, propName, value);\n      }\n    }\n  };\n\n  var clip = new Clip({\n    target: animator._target,\n    life: trackMaxTime,\n    loop: animator._loop,\n    delay: animator._delay,\n    onframe: onframe,\n    ondestroy: oneTrackDone\n  });\n\n  if (easing && easing !== 'spline') {\n    clip.easing = easing;\n  }\n\n  return clip;\n}\n/**\n * @alias module:zrender/animation/Animator\n * @constructor\n * @param {Object} target\n * @param {boolean} loop\n * @param {Function} getter\n * @param {Function} setter\n */\n\n\nvar Animator = function (target, loop, getter, setter) {\n  this._tracks = {};\n  this._target = target;\n  this._loop = loop || false;\n  this._getter = getter || defaultGetter;\n  this._setter = setter || defaultSetter;\n  this._clipCount = 0;\n  this._delay = 0;\n  this._doneList = [];\n  this._onframeList = [];\n  this._clipList = [];\n};\n\nAnimator.prototype = {\n  /**\n   * \n   * @param  {number} time ms\n   * @param  {Object} props key-value\n   * @return {module:zrender/animation/Animator}\n   */\n  when: function (time\n  /* ms */\n  , props) {\n    var tracks = this._tracks;\n\n    for (var propName in props) {\n      if (!props.hasOwnProperty(propName)) {\n        continue;\n      }\n\n      if (!tracks[propName]) {\n        tracks[propName] = []; // Invalid value\n\n        var value = this._getter(this._target, propName);\n\n        if (value == null) {\n          // zrLog('Invalid property ' + propName);\n          continue;\n        } // If time is 0\n        //  Then props is given initialize value\n        // Else\n        //  Initialize value from current prop value\n\n\n        if (time !== 0) {\n          tracks[propName].push({\n            time: 0,\n            value: cloneValue(value)\n          });\n        }\n      }\n\n      tracks[propName].push({\n        time: time,\n        value: props[propName]\n      });\n    }\n\n    return this;\n  },\n\n  /**\n   * \n   * @param  {Function} callback\n   * @return {module:zrender/animation/Animator}\n   */\n  during: function (callback) {\n    this._onframeList.push(callback);\n\n    return this;\n  },\n  pause: function () {\n    for (var i = 0; i < this._clipList.length; i++) {\n      this._clipList[i].pause();\n    }\n\n    this._paused = true;\n  },\n  resume: function () {\n    for (var i = 0; i < this._clipList.length; i++) {\n      this._clipList[i].resume();\n    }\n\n    this._paused = false;\n  },\n  isPaused: function () {\n    return !!this._paused;\n  },\n  _doneCallback: function () {\n    // Clear all tracks\n    this._tracks = {}; // Clear all clips\n\n    this._clipList.length = 0;\n    var doneList = this._doneList;\n    var len = doneList.length;\n\n    for (var i = 0; i < len; i++) {\n      doneList[i].call(this);\n    }\n  },\n\n  /**\n   * \n   * @param  {string|Function} [easing]\n   *         {@link module:zrender/animation/easing}\n   * @param  {boolean} forceAnimate\n   * @return {module:zrender/animation/Animator}\n   */\n  start: function (easing, forceAnimate) {\n    var self = this;\n    var clipCount = 0;\n\n    var oneTrackDone = function () {\n      clipCount--;\n\n      if (!clipCount) {\n        self._doneCallback();\n      }\n    };\n\n    var lastClip;\n\n    for (var propName in this._tracks) {\n      if (!this._tracks.hasOwnProperty(propName)) {\n        continue;\n      }\n\n      var clip = createTrackClip(this, easing, oneTrackDone, this._tracks[propName], propName, forceAnimate);\n\n      if (clip) {\n        this._clipList.push(clip);\n\n        clipCount++; // If start after added to animation\n\n        if (this.animation) {\n          this.animation.addClip(clip);\n        }\n\n        lastClip = clip;\n      }\n    } // Add during callback on the last clip\n\n\n    if (lastClip) {\n      var oldOnFrame = lastClip.onframe;\n\n      lastClip.onframe = function (target, percent) {\n        oldOnFrame(target, percent);\n\n        for (var i = 0; i < self._onframeList.length; i++) {\n          self._onframeList[i](target, percent);\n        }\n      };\n    } // This optimization will help the case that in the upper application\n    // the view may be refreshed frequently, where animation will be\n    // called repeatly but nothing changed.\n\n\n    if (!clipCount) {\n      this._doneCallback();\n    }\n\n    return this;\n  },\n\n  /**\n   * \n   * @param {boolean} forwardToLast If move to last frame before stop\n   */\n  stop: function (forwardToLast) {\n    var clipList = this._clipList;\n    var animation = this.animation;\n\n    for (var i = 0; i < clipList.length; i++) {\n      var clip = clipList[i];\n\n      if (forwardToLast) {\n        // Move to last frame before stop\n        clip.onframe(this._target, 1);\n      }\n\n      animation && animation.removeClip(clip);\n    }\n\n    clipList.length = 0;\n  },\n\n  /**\n   * \n   * @param  {number} time ms\n   * @return {module:zrender/animation/Animator}\n   */\n  delay: function (time) {\n    this._delay = time;\n    return this;\n  },\n\n  /**\n   * \n   * @param  {Function} cb\n   * @return {module:zrender/animation/Animator}\n   */\n  done: function (cb) {\n    if (cb) {\n      this._doneList.push(cb);\n    }\n\n    return this;\n  },\n\n  /**\n   * @return {Array.<module:zrender/animation/Clip>}\n   */\n  getClips: function () {\n    return this._clipList;\n  }\n};\n\nvar dpr = 1; // If in browser environment\n\nif (typeof window !== 'undefined') {\n  dpr = Math.max(window.devicePixelRatio || 1, 1);\n}\n/**\n * config\n * @exports zrender/config\n * @author Kener (@Kener-, kener.linfeng@gmail.com)\n */\n\n/**\n * debugcatchBrushExceptiontrue\n * 0 : debug\n * 1 : \n * 2 : \n */\n\n\nvar debugMode = 0; // retina \n\nvar devicePixelRatio = dpr;\n\nvar log = function () {};\n\nif (debugMode === 1) {\n  log = function () {\n    for (var k in arguments) {\n      throw new Error(arguments[k]);\n    }\n  };\n} else if (debugMode > 1) {\n  log = function () {\n    for (var k in arguments) {\n      console.log(arguments[k]);\n    }\n  };\n}\n\nvar log$1 = log;\n\n/**\n * @alias modue:zrender/mixin/Animatable\n * @constructor\n */\n\nvar Animatable = function () {\n  /**\n   * @type {Array.<module:zrender/animation/Animator>}\n   * @readOnly\n   */\n  this.animators = [];\n};\n\nAnimatable.prototype = {\n  constructor: Animatable,\n\n  /**\n   * \n   *\n   * @param {string} path The path to fetch value from object, like 'a.b.c'.\n   * @param {boolean} [loop] Whether to loop animation.\n   * @return {module:zrender/animation/Animator}\n   * @example:\n   *     el.animate('style', false)\n   *         .when(1000, {x: 10} )\n   *         .done(function(){ // Animation done })\n   *         .start()\n   */\n  animate: function (path, loop) {\n    var target;\n    var animatingShape = false;\n    var el = this;\n    var zr = this.__zr;\n\n    if (path) {\n      var pathSplitted = path.split('.');\n      var prop = el; // If animating shape\n\n      animatingShape = pathSplitted[0] === 'shape';\n\n      for (var i = 0, l = pathSplitted.length; i < l; i++) {\n        if (!prop) {\n          continue;\n        }\n\n        prop = prop[pathSplitted[i]];\n      }\n\n      if (prop) {\n        target = prop;\n      }\n    } else {\n      target = el;\n    }\n\n    if (!target) {\n      log$1('Property \"' + path + '\" is not existed in element ' + el.id);\n      return;\n    }\n\n    var animators = el.animators;\n    var animator = new Animator(target, loop);\n    animator.during(function (target) {\n      el.dirty(animatingShape);\n    }).done(function () {\n      // FIXME Animator will not be removed if use `Animator#stop` to stop animation\n      animators.splice(indexOf(animators, animator), 1);\n    });\n    animators.push(animator); // If animate after added to the zrender\n\n    if (zr) {\n      zr.animation.addAnimator(animator);\n    }\n\n    return animator;\n  },\n\n  /**\n   * \n   * @param {boolean} forwardToLast If move to last frame before stop\n   */\n  stopAnimation: function (forwardToLast) {\n    var animators = this.animators;\n    var len = animators.length;\n\n    for (var i = 0; i < len; i++) {\n      animators[i].stop(forwardToLast);\n    }\n\n    animators.length = 0;\n    return this;\n  },\n\n  /**\n   * Caution: this method will stop previous animation.\n   * So do not use this method to one element twice before\n   * animation starts, unless you know what you are doing.\n   * @param {Object} target\n   * @param {number} [time=500] Time in ms\n   * @param {string} [easing='linear']\n   * @param {number} [delay=0]\n   * @param {Function} [callback]\n   * @param {Function} [forceAnimate] Prevent stop animation and callback\n   *        immediently when target values are the same as current values.\n   *\n   * @example\n   *  // Animate position\n   *  el.animateTo({\n   *      position: [10, 10]\n   *  }, function () { // done })\n   *\n   *  // Animate shape, style and position in 100ms, delayed 100ms, with cubicOut easing\n   *  el.animateTo({\n   *      shape: {\n   *          width: 500\n   *      },\n   *      style: {\n   *          fill: 'red'\n   *      }\n   *      position: [10, 10]\n   *  }, 100, 100, 'cubicOut', function () { // done })\n   */\n  // TODO Return animation key\n  animateTo: function (target, time, delay, easing, callback, forceAnimate) {\n    // animateTo(target, time, easing, callback);\n    if (isString(delay)) {\n      callback = easing;\n      easing = delay;\n      delay = 0;\n    } // animateTo(target, time, delay, callback);\n    else if (isFunction$1(easing)) {\n        callback = easing;\n        easing = 'linear';\n        delay = 0;\n      } // animateTo(target, time, callback);\n      else if (isFunction$1(delay)) {\n          callback = delay;\n          delay = 0;\n        } // animateTo(target, callback)\n        else if (isFunction$1(time)) {\n            callback = time;\n            time = 500;\n          } // animateTo(target)\n          else if (!time) {\n              time = 500;\n            } // Stop all previous animations\n\n\n    this.stopAnimation();\n\n    this._animateToShallow('', this, target, time, delay); // Animators may be removed immediately after start\n    // if there is nothing to animate\n\n\n    var animators = this.animators.slice();\n    var count = animators.length;\n\n    function done() {\n      count--;\n\n      if (!count) {\n        callback && callback();\n      }\n    } // No animators. This should be checked before animators[i].start(),\n    // because 'done' may be executed immediately if no need to animate.\n\n\n    if (!count) {\n      callback && callback();\n    } // Start after all animators created\n    // Incase any animator is done immediately when all animation properties are not changed\n\n\n    for (var i = 0; i < animators.length; i++) {\n      animators[i].done(done).start(easing, forceAnimate);\n    }\n  },\n\n  /**\n   * @private\n   * @param {string} path=''\n   * @param {Object} source=this\n   * @param {Object} target\n   * @param {number} [time=500]\n   * @param {number} [delay=0]\n   *\n   * @example\n   *  // Animate position\n   *  el._animateToShallow({\n   *      position: [10, 10]\n   *  })\n   *\n   *  // Animate shape, style and position in 100ms, delayed 100ms\n   *  el._animateToShallow({\n   *      shape: {\n   *          width: 500\n   *      },\n   *      style: {\n   *          fill: 'red'\n   *      }\n   *      position: [10, 10]\n   *  }, 100, 100)\n   */\n  _animateToShallow: function (path, source, target, time, delay) {\n    var objShallow = {};\n    var propertyCount = 0;\n\n    for (var name in target) {\n      if (!target.hasOwnProperty(name)) {\n        continue;\n      }\n\n      if (source[name] != null) {\n        if (isObject$1(target[name]) && !isArrayLike(target[name])) {\n          this._animateToShallow(path ? path + '.' + name : name, source[name], target[name], time, delay);\n        } else {\n          objShallow[name] = target[name];\n          propertyCount++;\n        }\n      } else if (target[name] != null) {\n        // Attr directly if not has property\n        // FIXME, if some property not needed for element ?\n        if (!path) {\n          this.attr(name, target[name]);\n        } else {\n          // Shape or style\n          var props = {};\n          props[path] = {};\n          props[path][name] = target[name];\n          this.attr(props);\n        }\n      }\n    }\n\n    if (propertyCount > 0) {\n      this.animate(path, false).when(time == null ? 500 : time, objShallow).delay(delay || 0);\n    }\n\n    return this;\n  }\n};\n\n/**\n * @alias module:zrender/Element\n * @constructor\n * @extends {module:zrender/mixin/Animatable}\n * @extends {module:zrender/mixin/Transformable}\n * @extends {module:zrender/mixin/Eventful}\n */\n\nvar Element = function (opts) {\n  // jshint ignore:line\n  Transformable.call(this, opts);\n  Eventful.call(this, opts);\n  Animatable.call(this, opts);\n  /**\n   * ID\n   * @type {string}\n   */\n\n  this.id = opts.id || guid();\n};\n\nElement.prototype = {\n  /**\n   * \n   * Element type\n   * @type {string}\n   */\n  type: 'element',\n\n  /**\n   * \n   * Element name\n   * @type {string}\n   */\n  name: '',\n\n  /**\n   * ZRender  element  zrender \n   * ZRender instance will be assigned when element is associated with zrender\n   * @name module:/zrender/Element#__zr\n   * @type {module:zrender/ZRender}\n   */\n  __zr: null,\n\n  /**\n   * true\n   * If ignore drawing and events of the element object\n   * @name module:/zrender/Element#ignore\n   * @type {boolean}\n   * @default false\n   */\n  ignore: false,\n\n  /**\n   * (shape) Group \n   * \n   * @type {module:zrender/graphic/Path}\n   * @see http://www.w3.org/TR/2dcontext/#clipping-region\n   * @readOnly\n   */\n  clipPath: null,\n\n  /**\n   *  Group\n   * @type {boolean}\n   */\n  isGroup: false,\n\n  /**\n   * Drift element\n   * @param  {number} dx dx on the global space\n   * @param  {number} dy dy on the global space\n   */\n  drift: function (dx, dy) {\n    switch (this.draggable) {\n      case 'horizontal':\n        dy = 0;\n        break;\n\n      case 'vertical':\n        dx = 0;\n        break;\n    }\n\n    var m = this.transform;\n\n    if (!m) {\n      m = this.transform = [1, 0, 0, 1, 0, 0];\n    }\n\n    m[4] += dx;\n    m[5] += dy;\n    this.decomposeTransform();\n    this.dirty(false);\n  },\n\n  /**\n   * Hook before update\n   */\n  beforeUpdate: function () {},\n\n  /**\n   * Hook after update\n   */\n  afterUpdate: function () {},\n\n  /**\n   * Update each frame\n   */\n  update: function () {\n    this.updateTransform();\n  },\n\n  /**\n   * @param  {Function} cb\n   * @param  {}   context\n   */\n  traverse: function (cb, context) {},\n\n  /**\n   * @protected\n   */\n  attrKV: function (key, value) {\n    if (key === 'position' || key === 'scale' || key === 'origin') {\n      // Copy the array\n      if (value) {\n        var target = this[key];\n\n        if (!target) {\n          target = this[key] = [];\n        }\n\n        target[0] = value[0];\n        target[1] = value[1];\n      }\n    } else {\n      this[key] = value;\n    }\n  },\n\n  /**\n   * Hide the element\n   */\n  hide: function () {\n    this.ignore = true;\n    this.__zr && this.__zr.refresh();\n  },\n\n  /**\n   * Show the element\n   */\n  show: function () {\n    this.ignore = false;\n    this.__zr && this.__zr.refresh();\n  },\n\n  /**\n   * @param {string|Object} key\n   * @param {*} value\n   */\n  attr: function (key, value) {\n    if (typeof key === 'string') {\n      this.attrKV(key, value);\n    } else if (isObject$1(key)) {\n      for (var name in key) {\n        if (key.hasOwnProperty(name)) {\n          this.attrKV(name, key[name]);\n        }\n      }\n    }\n\n    this.dirty(false);\n    return this;\n  },\n\n  /**\n   * @param {module:zrender/graphic/Path} clipPath\n   */\n  setClipPath: function (clipPath) {\n    var zr = this.__zr;\n\n    if (zr) {\n      clipPath.addSelfToZr(zr);\n    } // Remove previous clip path\n\n\n    if (this.clipPath && this.clipPath !== clipPath) {\n      this.removeClipPath();\n    }\n\n    this.clipPath = clipPath;\n    clipPath.__zr = zr;\n    clipPath.__clipTarget = this;\n    this.dirty(false);\n  },\n\n  /**\n   */\n  removeClipPath: function () {\n    var clipPath = this.clipPath;\n\n    if (clipPath) {\n      if (clipPath.__zr) {\n        clipPath.removeSelfFromZr(clipPath.__zr);\n      }\n\n      clipPath.__zr = null;\n      clipPath.__clipTarget = null;\n      this.clipPath = null;\n      this.dirty(false);\n    }\n  },\n\n  /**\n   * Add self from zrender instance.\n   * Not recursively because it will be invoked when element added to storage.\n   * @param {module:zrender/ZRender} zr\n   */\n  addSelfToZr: function (zr) {\n    this.__zr = zr; // \n\n    var animators = this.animators;\n\n    if (animators) {\n      for (var i = 0; i < animators.length; i++) {\n        zr.animation.addAnimator(animators[i]);\n      }\n    }\n\n    if (this.clipPath) {\n      this.clipPath.addSelfToZr(zr);\n    }\n  },\n\n  /**\n   * Remove self from zrender instance.\n   * Not recursively because it will be invoked when element added to storage.\n   * @param {module:zrender/ZRender} zr\n   */\n  removeSelfFromZr: function (zr) {\n    this.__zr = null; // \n\n    var animators = this.animators;\n\n    if (animators) {\n      for (var i = 0; i < animators.length; i++) {\n        zr.animation.removeAnimator(animators[i]);\n      }\n    }\n\n    if (this.clipPath) {\n      this.clipPath.removeSelfFromZr(zr);\n    }\n  }\n};\nmixin(Element, Animatable);\nmixin(Element, Transformable);\nmixin(Element, Eventful);\n\n/**\n * @module echarts/core/BoundingRect\n */\nvar v2ApplyTransform = applyTransform;\nvar mathMin = Math.min;\nvar mathMax = Math.max;\n/**\n * @alias module:echarts/core/BoundingRect\n */\n\nfunction BoundingRect(x, y, width, height) {\n  if (width < 0) {\n    x = x + width;\n    width = -width;\n  }\n\n  if (height < 0) {\n    y = y + height;\n    height = -height;\n  }\n  /**\n   * @type {number}\n   */\n\n\n  this.x = x;\n  /**\n   * @type {number}\n   */\n\n  this.y = y;\n  /**\n   * @type {number}\n   */\n\n  this.width = width;\n  /**\n   * @type {number}\n   */\n\n  this.height = height;\n}\n\nBoundingRect.prototype = {\n  constructor: BoundingRect,\n\n  /**\n   * @param {module:echarts/core/BoundingRect} other\n   */\n  union: function (other) {\n    var x = mathMin(other.x, this.x);\n    var y = mathMin(other.y, this.y);\n    this.width = mathMax(other.x + other.width, this.x + this.width) - x;\n    this.height = mathMax(other.y + other.height, this.y + this.height) - y;\n    this.x = x;\n    this.y = y;\n  },\n\n  /**\n   * @param {Array.<number>} m\n   * @methods\n   */\n  applyTransform: function () {\n    var lt = [];\n    var rb = [];\n    var lb = [];\n    var rt = [];\n    return function (m) {\n      // In case usage like this\n      // el.getBoundingRect().applyTransform(el.transform)\n      // And element has no transform\n      if (!m) {\n        return;\n      }\n\n      lt[0] = lb[0] = this.x;\n      lt[1] = rt[1] = this.y;\n      rb[0] = rt[0] = this.x + this.width;\n      rb[1] = lb[1] = this.y + this.height;\n      v2ApplyTransform(lt, lt, m);\n      v2ApplyTransform(rb, rb, m);\n      v2ApplyTransform(lb, lb, m);\n      v2ApplyTransform(rt, rt, m);\n      this.x = mathMin(lt[0], rb[0], lb[0], rt[0]);\n      this.y = mathMin(lt[1], rb[1], lb[1], rt[1]);\n      var maxX = mathMax(lt[0], rb[0], lb[0], rt[0]);\n      var maxY = mathMax(lt[1], rb[1], lb[1], rt[1]);\n      this.width = maxX - this.x;\n      this.height = maxY - this.y;\n    };\n  }(),\n\n  /**\n   * Calculate matrix of transforming from self to target rect\n   * @param  {module:zrender/core/BoundingRect} b\n   * @return {Array.<number>}\n   */\n  calculateTransform: function (b) {\n    var a = this;\n    var sx = b.width / a.width;\n    var sy = b.height / a.height;\n    var m = create$1(); // \n\n    translate(m, m, [-a.x, -a.y]);\n    scale$1(m, m, [sx, sy]);\n    translate(m, m, [b.x, b.y]);\n    return m;\n  },\n\n  /**\n   * @param {(module:echarts/core/BoundingRect|Object)} b\n   * @return {boolean}\n   */\n  intersect: function (b) {\n    if (!b) {\n      return false;\n    }\n\n    if (!(b instanceof BoundingRect)) {\n      // Normalize negative width/height.\n      b = BoundingRect.create(b);\n    }\n\n    var a = this;\n    var ax0 = a.x;\n    var ax1 = a.x + a.width;\n    var ay0 = a.y;\n    var ay1 = a.y + a.height;\n    var bx0 = b.x;\n    var bx1 = b.x + b.width;\n    var by0 = b.y;\n    var by1 = b.y + b.height;\n    return !(ax1 < bx0 || bx1 < ax0 || ay1 < by0 || by1 < ay0);\n  },\n  contain: function (x, y) {\n    var rect = this;\n    return x >= rect.x && x <= rect.x + rect.width && y >= rect.y && y <= rect.y + rect.height;\n  },\n\n  /**\n   * @return {module:echarts/core/BoundingRect}\n   */\n  clone: function () {\n    return new BoundingRect(this.x, this.y, this.width, this.height);\n  },\n\n  /**\n   * Copy from another rect\n   */\n  copy: function (other) {\n    this.x = other.x;\n    this.y = other.y;\n    this.width = other.width;\n    this.height = other.height;\n  },\n  plain: function () {\n    return {\n      x: this.x,\n      y: this.y,\n      width: this.width,\n      height: this.height\n    };\n  }\n};\n/**\n * @param {Object|module:zrender/core/BoundingRect} rect\n * @param {number} rect.x\n * @param {number} rect.y\n * @param {number} rect.width\n * @param {number} rect.height\n * @return {module:zrender/core/BoundingRect}\n */\n\nBoundingRect.create = function (rect) {\n  return new BoundingRect(rect.x, rect.y, rect.width, rect.height);\n};\n\n/**\n * GroupGroup\n * @module zrender/graphic/Group\n * @example\n *     var Group = require('zrender/container/Group');\n *     var Circle = require('zrender/graphic/shape/Circle');\n *     var g = new Group();\n *     g.position[0] = 100;\n *     g.position[1] = 100;\n *     g.add(new Circle({\n *         style: {\n *             x: 100,\n *             y: 100,\n *             r: 20,\n *         }\n *     }));\n *     zr.add(g);\n */\n/**\n * @alias module:zrender/graphic/Group\n * @constructor\n * @extends module:zrender/mixin/Transformable\n * @extends module:zrender/mixin/Eventful\n */\n\nvar Group = function (opts) {\n  opts = opts || {};\n  Element.call(this, opts);\n\n  for (var key in opts) {\n    if (opts.hasOwnProperty(key)) {\n      this[key] = opts[key];\n    }\n  }\n\n  this._children = [];\n  this.__storage = null;\n  this.__dirty = true;\n};\n\nGroup.prototype = {\n  constructor: Group,\n  isGroup: true,\n\n  /**\n   * @type {string}\n   */\n  type: 'group',\n\n  /**\n   * \n   * @name module:/zrender/container/Group#silent\n   * @type {boolean}\n   * @default false\n   */\n  silent: false,\n\n  /**\n   * @return {Array.<module:zrender/Element>}\n   */\n  children: function () {\n    return this._children.slice();\n  },\n\n  /**\n   *  index \n   * @param  {number} idx\n   * @return {module:zrender/Element}\n   */\n  childAt: function (idx) {\n    return this._children[idx];\n  },\n\n  /**\n   * \n   * @param  {string} name\n   * @return {module:zrender/Element}\n   */\n  childOfName: function (name) {\n    var children = this._children;\n\n    for (var i = 0; i < children.length; i++) {\n      if (children[i].name === name) {\n        return children[i];\n      }\n    }\n  },\n\n  /**\n   * @return {number}\n   */\n  childCount: function () {\n    return this._children.length;\n  },\n\n  /**\n   * \n   * @param {module:zrender/Element} child\n   */\n  add: function (child) {\n    if (child && child !== this && child.parent !== this) {\n      this._children.push(child);\n\n      this._doAdd(child);\n    }\n\n    return this;\n  },\n\n  /**\n   *  nextSibling \n   * @param {module:zrender/Element} child\n   * @param {module:zrender/Element} nextSibling\n   */\n  addBefore: function (child, nextSibling) {\n    if (child && child !== this && child.parent !== this && nextSibling && nextSibling.parent === this) {\n      var children = this._children;\n      var idx = children.indexOf(nextSibling);\n\n      if (idx >= 0) {\n        children.splice(idx, 0, child);\n\n        this._doAdd(child);\n      }\n    }\n\n    return this;\n  },\n  _doAdd: function (child) {\n    if (child.parent) {\n      child.parent.remove(child);\n    }\n\n    child.parent = this;\n    var storage = this.__storage;\n    var zr = this.__zr;\n\n    if (storage && storage !== child.__storage) {\n      storage.addToStorage(child);\n\n      if (child instanceof Group) {\n        child.addChildrenToStorage(storage);\n      }\n    }\n\n    zr && zr.refresh();\n  },\n\n  /**\n   * \n   * @param {module:zrender/Element} child\n   */\n  remove: function (child) {\n    var zr = this.__zr;\n    var storage = this.__storage;\n    var children = this._children;\n    var idx = indexOf(children, child);\n\n    if (idx < 0) {\n      return this;\n    }\n\n    children.splice(idx, 1);\n    child.parent = null;\n\n    if (storage) {\n      storage.delFromStorage(child);\n\n      if (child instanceof Group) {\n        child.delChildrenFromStorage(storage);\n      }\n    }\n\n    zr && zr.refresh();\n    return this;\n  },\n\n  /**\n   * \n   */\n  removeAll: function () {\n    var children = this._children;\n    var storage = this.__storage;\n    var child;\n    var i;\n\n    for (i = 0; i < children.length; i++) {\n      child = children[i];\n\n      if (storage) {\n        storage.delFromStorage(child);\n\n        if (child instanceof Group) {\n          child.delChildrenFromStorage(storage);\n        }\n      }\n\n      child.parent = null;\n    }\n\n    children.length = 0;\n    return this;\n  },\n\n  /**\n   * \n   * @param  {Function} cb\n   * @param  {}   context\n   */\n  eachChild: function (cb, context) {\n    var children = this._children;\n\n    for (var i = 0; i < children.length; i++) {\n      var child = children[i];\n      cb.call(context, child, i);\n    }\n\n    return this;\n  },\n\n  /**\n   * \n   * @param  {Function} cb\n   * @param  {}   context\n   */\n  traverse: function (cb, context) {\n    for (var i = 0; i < this._children.length; i++) {\n      var child = this._children[i];\n      cb.call(context, child);\n\n      if (child.type === 'group') {\n        child.traverse(cb, context);\n      }\n    }\n\n    return this;\n  },\n  addChildrenToStorage: function (storage) {\n    for (var i = 0; i < this._children.length; i++) {\n      var child = this._children[i];\n      storage.addToStorage(child);\n\n      if (child instanceof Group) {\n        child.addChildrenToStorage(storage);\n      }\n    }\n  },\n  delChildrenFromStorage: function (storage) {\n    for (var i = 0; i < this._children.length; i++) {\n      var child = this._children[i];\n      storage.delFromStorage(child);\n\n      if (child instanceof Group) {\n        child.delChildrenFromStorage(storage);\n      }\n    }\n  },\n  dirty: function () {\n    this.__dirty = true;\n    this.__zr && this.__zr.refresh();\n    return this;\n  },\n\n  /**\n   * @return {module:zrender/core/BoundingRect}\n   */\n  getBoundingRect: function (includeChildren) {\n    // TODO Caching\n    var rect = null;\n    var tmpRect = new BoundingRect(0, 0, 0, 0);\n    var children = includeChildren || this._children;\n    var tmpMat = [];\n\n    for (var i = 0; i < children.length; i++) {\n      var child = children[i];\n\n      if (child.ignore || child.invisible) {\n        continue;\n      }\n\n      var childRect = child.getBoundingRect();\n      var transform = child.getLocalTransform(tmpMat); // TODO\n      // The boundingRect cacluated by transforming original\n      // rect may be bigger than the actual bundingRect when rotation\n      // is used. (Consider a circle rotated aginst its center, where\n      // the actual boundingRect should be the same as that not be\n      // rotated.) But we can not find better approach to calculate\n      // actual boundingRect yet, considering performance.\n\n      if (transform) {\n        tmpRect.copy(childRect);\n        tmpRect.applyTransform(transform);\n        rect = rect || tmpRect.clone();\n        rect.union(tmpRect);\n      } else {\n        rect = rect || childRect.clone();\n        rect.union(childRect);\n      }\n    }\n\n    return rect || tmpRect;\n  }\n};\ninherits(Group, Element);\n\n// https://github.com/mziccard/node-timsort\nvar DEFAULT_MIN_MERGE = 32;\nvar DEFAULT_MIN_GALLOPING = 7;\nfunction minRunLength(n) {\n  var r = 0;\n\n  while (n >= DEFAULT_MIN_MERGE) {\n    r |= n & 1;\n    n >>= 1;\n  }\n\n  return n + r;\n}\n\nfunction makeAscendingRun(array, lo, hi, compare) {\n  var runHi = lo + 1;\n\n  if (runHi === hi) {\n    return 1;\n  }\n\n  if (compare(array[runHi++], array[lo]) < 0) {\n    while (runHi < hi && compare(array[runHi], array[runHi - 1]) < 0) {\n      runHi++;\n    }\n\n    reverseRun(array, lo, runHi);\n  } else {\n    while (runHi < hi && compare(array[runHi], array[runHi - 1]) >= 0) {\n      runHi++;\n    }\n  }\n\n  return runHi - lo;\n}\n\nfunction reverseRun(array, lo, hi) {\n  hi--;\n\n  while (lo < hi) {\n    var t = array[lo];\n    array[lo++] = array[hi];\n    array[hi--] = t;\n  }\n}\n\nfunction binaryInsertionSort(array, lo, hi, start, compare) {\n  if (start === lo) {\n    start++;\n  }\n\n  for (; start < hi; start++) {\n    var pivot = array[start];\n    var left = lo;\n    var right = start;\n    var mid;\n\n    while (left < right) {\n      mid = left + right >>> 1;\n\n      if (compare(pivot, array[mid]) < 0) {\n        right = mid;\n      } else {\n        left = mid + 1;\n      }\n    }\n\n    var n = start - left;\n\n    switch (n) {\n      case 3:\n        array[left + 3] = array[left + 2];\n\n      case 2:\n        array[left + 2] = array[left + 1];\n\n      case 1:\n        array[left + 1] = array[left];\n        break;\n\n      default:\n        while (n > 0) {\n          array[left + n] = array[left + n - 1];\n          n--;\n        }\n\n    }\n\n    array[left] = pivot;\n  }\n}\n\nfunction gallopLeft(value, array, start, length, hint, compare) {\n  var lastOffset = 0;\n  var maxOffset = 0;\n  var offset = 1;\n\n  if (compare(value, array[start + hint]) > 0) {\n    maxOffset = length - hint;\n\n    while (offset < maxOffset && compare(value, array[start + hint + offset]) > 0) {\n      lastOffset = offset;\n      offset = (offset << 1) + 1;\n\n      if (offset <= 0) {\n        offset = maxOffset;\n      }\n    }\n\n    if (offset > maxOffset) {\n      offset = maxOffset;\n    }\n\n    lastOffset += hint;\n    offset += hint;\n  } else {\n    maxOffset = hint + 1;\n\n    while (offset < maxOffset && compare(value, array[start + hint - offset]) <= 0) {\n      lastOffset = offset;\n      offset = (offset << 1) + 1;\n\n      if (offset <= 0) {\n        offset = maxOffset;\n      }\n    }\n\n    if (offset > maxOffset) {\n      offset = maxOffset;\n    }\n\n    var tmp = lastOffset;\n    lastOffset = hint - offset;\n    offset = hint - tmp;\n  }\n\n  lastOffset++;\n\n  while (lastOffset < offset) {\n    var m = lastOffset + (offset - lastOffset >>> 1);\n\n    if (compare(value, array[start + m]) > 0) {\n      lastOffset = m + 1;\n    } else {\n      offset = m;\n    }\n  }\n\n  return offset;\n}\n\nfunction gallopRight(value, array, start, length, hint, compare) {\n  var lastOffset = 0;\n  var maxOffset = 0;\n  var offset = 1;\n\n  if (compare(value, array[start + hint]) < 0) {\n    maxOffset = hint + 1;\n\n    while (offset < maxOffset && compare(value, array[start + hint - offset]) < 0) {\n      lastOffset = offset;\n      offset = (offset << 1) + 1;\n\n      if (offset <= 0) {\n        offset = maxOffset;\n      }\n    }\n\n    if (offset > maxOffset) {\n      offset = maxOffset;\n    }\n\n    var tmp = lastOffset;\n    lastOffset = hint - offset;\n    offset = hint - tmp;\n  } else {\n    maxOffset = length - hint;\n\n    while (offset < maxOffset && compare(value, array[start + hint + offset]) >= 0) {\n      lastOffset = offset;\n      offset = (offset << 1) + 1;\n\n      if (offset <= 0) {\n        offset = maxOffset;\n      }\n    }\n\n    if (offset > maxOffset) {\n      offset = maxOffset;\n    }\n\n    lastOffset += hint;\n    offset += hint;\n  }\n\n  lastOffset++;\n\n  while (lastOffset < offset) {\n    var m = lastOffset + (offset - lastOffset >>> 1);\n\n    if (compare(value, array[start + m]) < 0) {\n      offset = m;\n    } else {\n      lastOffset = m + 1;\n    }\n  }\n\n  return offset;\n}\n\nfunction TimSort(array, compare) {\n  var minGallop = DEFAULT_MIN_GALLOPING;\n  var runStart;\n  var runLength;\n  var stackSize = 0;\n  var tmp = [];\n  runStart = [];\n  runLength = [];\n\n  function pushRun(_runStart, _runLength) {\n    runStart[stackSize] = _runStart;\n    runLength[stackSize] = _runLength;\n    stackSize += 1;\n  }\n\n  function mergeRuns() {\n    while (stackSize > 1) {\n      var n = stackSize - 2;\n\n      if (n >= 1 && runLength[n - 1] <= runLength[n] + runLength[n + 1] || n >= 2 && runLength[n - 2] <= runLength[n] + runLength[n - 1]) {\n        if (runLength[n - 1] < runLength[n + 1]) {\n          n--;\n        }\n      } else if (runLength[n] > runLength[n + 1]) {\n        break;\n      }\n\n      mergeAt(n);\n    }\n  }\n\n  function forceMergeRuns() {\n    while (stackSize > 1) {\n      var n = stackSize - 2;\n\n      if (n > 0 && runLength[n - 1] < runLength[n + 1]) {\n        n--;\n      }\n\n      mergeAt(n);\n    }\n  }\n\n  function mergeAt(i) {\n    var start1 = runStart[i];\n    var length1 = runLength[i];\n    var start2 = runStart[i + 1];\n    var length2 = runLength[i + 1];\n    runLength[i] = length1 + length2;\n\n    if (i === stackSize - 3) {\n      runStart[i + 1] = runStart[i + 2];\n      runLength[i + 1] = runLength[i + 2];\n    }\n\n    stackSize--;\n    var k = gallopRight(array[start2], array, start1, length1, 0, compare);\n    start1 += k;\n    length1 -= k;\n\n    if (length1 === 0) {\n      return;\n    }\n\n    length2 = gallopLeft(array[start1 + length1 - 1], array, start2, length2, length2 - 1, compare);\n\n    if (length2 === 0) {\n      return;\n    }\n\n    if (length1 <= length2) {\n      mergeLow(start1, length1, start2, length2);\n    } else {\n      mergeHigh(start1, length1, start2, length2);\n    }\n  }\n\n  function mergeLow(start1, length1, start2, length2) {\n    var i = 0;\n\n    for (i = 0; i < length1; i++) {\n      tmp[i] = array[start1 + i];\n    }\n\n    var cursor1 = 0;\n    var cursor2 = start2;\n    var dest = start1;\n    array[dest++] = array[cursor2++];\n\n    if (--length2 === 0) {\n      for (i = 0; i < length1; i++) {\n        array[dest + i] = tmp[cursor1 + i];\n      }\n\n      return;\n    }\n\n    if (length1 === 1) {\n      for (i = 0; i < length2; i++) {\n        array[dest + i] = array[cursor2 + i];\n      }\n\n      array[dest + length2] = tmp[cursor1];\n      return;\n    }\n\n    var _minGallop = minGallop;\n    var count1, count2, exit;\n\n    while (1) {\n      count1 = 0;\n      count2 = 0;\n      exit = false;\n\n      do {\n        if (compare(array[cursor2], tmp[cursor1]) < 0) {\n          array[dest++] = array[cursor2++];\n          count2++;\n          count1 = 0;\n\n          if (--length2 === 0) {\n            exit = true;\n            break;\n          }\n        } else {\n          array[dest++] = tmp[cursor1++];\n          count1++;\n          count2 = 0;\n\n          if (--length1 === 1) {\n            exit = true;\n            break;\n          }\n        }\n      } while ((count1 | count2) < _minGallop);\n\n      if (exit) {\n        break;\n      }\n\n      do {\n        count1 = gallopRight(array[cursor2], tmp, cursor1, length1, 0, compare);\n\n        if (count1 !== 0) {\n          for (i = 0; i < count1; i++) {\n            array[dest + i] = tmp[cursor1 + i];\n          }\n\n          dest += count1;\n          cursor1 += count1;\n          length1 -= count1;\n\n          if (length1 <= 1) {\n            exit = true;\n            break;\n          }\n        }\n\n        array[dest++] = array[cursor2++];\n\n        if (--length2 === 0) {\n          exit = true;\n          break;\n        }\n\n        count2 = gallopLeft(tmp[cursor1], array, cursor2, length2, 0, compare);\n\n        if (count2 !== 0) {\n          for (i = 0; i < count2; i++) {\n            array[dest + i] = array[cursor2 + i];\n          }\n\n          dest += count2;\n          cursor2 += count2;\n          length2 -= count2;\n\n          if (length2 === 0) {\n            exit = true;\n            break;\n          }\n        }\n\n        array[dest++] = tmp[cursor1++];\n\n        if (--length1 === 1) {\n          exit = true;\n          break;\n        }\n\n        _minGallop--;\n      } while (count1 >= DEFAULT_MIN_GALLOPING || count2 >= DEFAULT_MIN_GALLOPING);\n\n      if (exit) {\n        break;\n      }\n\n      if (_minGallop < 0) {\n        _minGallop = 0;\n      }\n\n      _minGallop += 2;\n    }\n\n    minGallop = _minGallop;\n    minGallop < 1 && (minGallop = 1);\n\n    if (length1 === 1) {\n      for (i = 0; i < length2; i++) {\n        array[dest + i] = array[cursor2 + i];\n      }\n\n      array[dest + length2] = tmp[cursor1];\n    } else if (length1 === 0) {\n      throw new Error(); // throw new Error('mergeLow preconditions were not respected');\n    } else {\n      for (i = 0; i < length1; i++) {\n        array[dest + i] = tmp[cursor1 + i];\n      }\n    }\n  }\n\n  function mergeHigh(start1, length1, start2, length2) {\n    var i = 0;\n\n    for (i = 0; i < length2; i++) {\n      tmp[i] = array[start2 + i];\n    }\n\n    var cursor1 = start1 + length1 - 1;\n    var cursor2 = length2 - 1;\n    var dest = start2 + length2 - 1;\n    var customCursor = 0;\n    var customDest = 0;\n    array[dest--] = array[cursor1--];\n\n    if (--length1 === 0) {\n      customCursor = dest - (length2 - 1);\n\n      for (i = 0; i < length2; i++) {\n        array[customCursor + i] = tmp[i];\n      }\n\n      return;\n    }\n\n    if (length2 === 1) {\n      dest -= length1;\n      cursor1 -= length1;\n      customDest = dest + 1;\n      customCursor = cursor1 + 1;\n\n      for (i = length1 - 1; i >= 0; i--) {\n        array[customDest + i] = array[customCursor + i];\n      }\n\n      array[dest] = tmp[cursor2];\n      return;\n    }\n\n    var _minGallop = minGallop;\n\n    while (true) {\n      var count1 = 0;\n      var count2 = 0;\n      var exit = false;\n\n      do {\n        if (compare(tmp[cursor2], array[cursor1]) < 0) {\n          array[dest--] = array[cursor1--];\n          count1++;\n          count2 = 0;\n\n          if (--length1 === 0) {\n            exit = true;\n            break;\n          }\n        } else {\n          array[dest--] = tmp[cursor2--];\n          count2++;\n          count1 = 0;\n\n          if (--length2 === 1) {\n            exit = true;\n            break;\n          }\n        }\n      } while ((count1 | count2) < _minGallop);\n\n      if (exit) {\n        break;\n      }\n\n      do {\n        count1 = length1 - gallopRight(tmp[cursor2], array, start1, length1, length1 - 1, compare);\n\n        if (count1 !== 0) {\n          dest -= count1;\n          cursor1 -= count1;\n          length1 -= count1;\n          customDest = dest + 1;\n          customCursor = cursor1 + 1;\n\n          for (i = count1 - 1; i >= 0; i--) {\n            array[customDest + i] = array[customCursor + i];\n          }\n\n          if (length1 === 0) {\n            exit = true;\n            break;\n          }\n        }\n\n        array[dest--] = tmp[cursor2--];\n\n        if (--length2 === 1) {\n          exit = true;\n          break;\n        }\n\n        count2 = length2 - gallopLeft(array[cursor1], tmp, 0, length2, length2 - 1, compare);\n\n        if (count2 !== 0) {\n          dest -= count2;\n          cursor2 -= count2;\n          length2 -= count2;\n          customDest = dest + 1;\n          customCursor = cursor2 + 1;\n\n          for (i = 0; i < count2; i++) {\n            array[customDest + i] = tmp[customCursor + i];\n          }\n\n          if (length2 <= 1) {\n            exit = true;\n            break;\n          }\n        }\n\n        array[dest--] = array[cursor1--];\n\n        if (--length1 === 0) {\n          exit = true;\n          break;\n        }\n\n        _minGallop--;\n      } while (count1 >= DEFAULT_MIN_GALLOPING || count2 >= DEFAULT_MIN_GALLOPING);\n\n      if (exit) {\n        break;\n      }\n\n      if (_minGallop < 0) {\n        _minGallop = 0;\n      }\n\n      _minGallop += 2;\n    }\n\n    minGallop = _minGallop;\n\n    if (minGallop < 1) {\n      minGallop = 1;\n    }\n\n    if (length2 === 1) {\n      dest -= length1;\n      cursor1 -= length1;\n      customDest = dest + 1;\n      customCursor = cursor1 + 1;\n\n      for (i = length1 - 1; i >= 0; i--) {\n        array[customDest + i] = array[customCursor + i];\n      }\n\n      array[dest] = tmp[cursor2];\n    } else if (length2 === 0) {\n      throw new Error(); // throw new Error('mergeHigh preconditions were not respected');\n    } else {\n      customCursor = dest - (length2 - 1);\n\n      for (i = 0; i < length2; i++) {\n        array[customCursor + i] = tmp[i];\n      }\n    }\n  }\n\n  this.mergeRuns = mergeRuns;\n  this.forceMergeRuns = forceMergeRuns;\n  this.pushRun = pushRun;\n}\n\nfunction sort(array, compare, lo, hi) {\n  if (!lo) {\n    lo = 0;\n  }\n\n  if (!hi) {\n    hi = array.length;\n  }\n\n  var remaining = hi - lo;\n\n  if (remaining < 2) {\n    return;\n  }\n\n  var runLength = 0;\n\n  if (remaining < DEFAULT_MIN_MERGE) {\n    runLength = makeAscendingRun(array, lo, hi, compare);\n    binaryInsertionSort(array, lo, hi, lo + runLength, compare);\n    return;\n  }\n\n  var ts = new TimSort(array, compare);\n  var minRun = minRunLength(remaining);\n\n  do {\n    runLength = makeAscendingRun(array, lo, hi, compare);\n\n    if (runLength < minRun) {\n      var force = remaining;\n\n      if (force > minRun) {\n        force = minRun;\n      }\n\n      binaryInsertionSort(array, lo, lo + force, lo + runLength, compare);\n      runLength = force;\n    }\n\n    ts.pushRun(lo, runLength);\n    ts.mergeRuns();\n    remaining -= runLength;\n    lo += runLength;\n  } while (remaining !== 0);\n\n  ts.forceMergeRuns();\n}\n\n// https://jsfiddle.net/pissang/jr4x7mdm/8/\n\nfunction shapeCompareFunc(a, b) {\n  if (a.zlevel === b.zlevel) {\n    if (a.z === b.z) {\n      // if (a.z2 === b.z2) {\n      //     // FIXME Slow has renderidx compare\n      //     // http://stackoverflow.com/questions/20883421/sorting-in-javascript-should-every-compare-function-have-a-return-0-statement\n      //     // https://github.com/v8/v8/blob/47cce544a31ed5577ffe2963f67acb4144ee0232/src/js/array.js#L1012\n      //     return a.__renderidx - b.__renderidx;\n      // }\n      return a.z2 - b.z2;\n    }\n\n    return a.z - b.z;\n  }\n\n  return a.zlevel - b.zlevel;\n}\n/**\n *  (M)\n * @alias module:zrender/Storage\n * @constructor\n */\n\n\nvar Storage = function () {\n  // jshint ignore:line\n  this._roots = [];\n  this._displayList = [];\n  this._displayListLen = 0;\n};\n\nStorage.prototype = {\n  constructor: Storage,\n\n  /**\n   * @param  {Function} cb\n   *\n   */\n  traverse: function (cb, context) {\n    for (var i = 0; i < this._roots.length; i++) {\n      this._roots[i].traverse(cb, context);\n    }\n  },\n\n  /**\n   * \n   * @param {boolean} [update=false] \n   * @param {boolean} [includeIgnore=false]  ignore ,  update  true \n   *\n   * {@link module:zrender/graphic/Displayable.prototype.updateDisplayList}\n   * @return {Array.<module:zrender/graphic/Displayable>}\n   */\n  getDisplayList: function (update, includeIgnore) {\n    includeIgnore = includeIgnore || false;\n\n    if (update) {\n      this.updateDisplayList(includeIgnore);\n    }\n\n    return this._displayList;\n  },\n\n  /**\n   * \n   * GroupShapeShape\n   * zlevel > z > \n   * @param {boolean} [includeIgnore=false]  ignore \n   */\n  updateDisplayList: function (includeIgnore) {\n    this._displayListLen = 0;\n    var roots = this._roots;\n    var displayList = this._displayList;\n\n    for (var i = 0, len = roots.length; i < len; i++) {\n      this._updateAndAddDisplayable(roots[i], null, includeIgnore);\n    }\n\n    displayList.length = this._displayListLen;\n    env$1.canvasSupported && sort(displayList, shapeCompareFunc);\n  },\n  _updateAndAddDisplayable: function (el, clipPaths, includeIgnore) {\n    if (el.ignore && !includeIgnore) {\n      return;\n    }\n\n    el.beforeUpdate();\n\n    if (el.__dirty) {\n      el.update();\n    }\n\n    el.afterUpdate();\n    var userSetClipPath = el.clipPath;\n\n    if (userSetClipPath) {\n      // FIXME \n      if (clipPaths) {\n        clipPaths = clipPaths.slice();\n      } else {\n        clipPaths = [];\n      }\n\n      var currentClipPath = userSetClipPath;\n      var parentClipPath = el; // Recursively add clip path\n\n      while (currentClipPath) {\n        // clipPath  clipPath \n        currentClipPath.parent = parentClipPath;\n        currentClipPath.updateTransform();\n        clipPaths.push(currentClipPath);\n        parentClipPath = currentClipPath;\n        currentClipPath = currentClipPath.clipPath;\n      }\n    }\n\n    if (el.isGroup) {\n      var children = el._children;\n\n      for (var i = 0; i < children.length; i++) {\n        var child = children[i]; // Force to mark as dirty if group is dirty\n        // FIXME __dirtyPath ?\n\n        if (el.__dirty) {\n          child.__dirty = true;\n        }\n\n        this._updateAndAddDisplayable(child, clipPaths, includeIgnore);\n      } // Mark group clean here\n\n\n      el.__dirty = false;\n    } else {\n      el.__clipPaths = clipPaths;\n      this._displayList[this._displayListLen++] = el;\n    }\n  },\n\n  /**\n   * (Shape)(Group)\n   * @param {module:zrender/Element} el\n   */\n  addRoot: function (el) {\n    if (el.__storage === this) {\n      return;\n    }\n\n    if (el instanceof Group) {\n      el.addChildrenToStorage(this);\n    }\n\n    this.addToStorage(el);\n\n    this._roots.push(el);\n  },\n\n  /**\n   * (Shape)(Group)\n   * @param {string|Array.<string>} [el] Storage\n   */\n  delRoot: function (el) {\n    if (el == null) {\n      // el\n      for (var i = 0; i < this._roots.length; i++) {\n        var root = this._roots[i];\n\n        if (root instanceof Group) {\n          root.delChildrenFromStorage(this);\n        }\n      }\n\n      this._roots = [];\n      this._displayList = [];\n      this._displayListLen = 0;\n      return;\n    }\n\n    if (el instanceof Array) {\n      for (var i = 0, l = el.length; i < l; i++) {\n        this.delRoot(el[i]);\n      }\n\n      return;\n    }\n\n    var idx = indexOf(this._roots, el);\n\n    if (idx >= 0) {\n      this.delFromStorage(el);\n\n      this._roots.splice(idx, 1);\n\n      if (el instanceof Group) {\n        el.delChildrenFromStorage(this);\n      }\n    }\n  },\n  addToStorage: function (el) {\n    if (el) {\n      el.__storage = this;\n      el.dirty(false);\n    }\n\n    return this;\n  },\n  delFromStorage: function (el) {\n    if (el) {\n      el.__storage = null;\n    }\n\n    return this;\n  },\n\n  /**\n   * Storage\n   */\n  dispose: function () {\n    this._renderList = this._roots = null;\n  },\n  displayableSortFunc: shapeCompareFunc\n};\n\nvar SHADOW_PROPS = {\n  'shadowBlur': 1,\n  'shadowOffsetX': 1,\n  'shadowOffsetY': 1,\n  'textShadowBlur': 1,\n  'textShadowOffsetX': 1,\n  'textShadowOffsetY': 1,\n  'textBoxShadowBlur': 1,\n  'textBoxShadowOffsetX': 1,\n  'textBoxShadowOffsetY': 1\n};\nvar fixShadow = function (ctx, propName, value) {\n  if (SHADOW_PROPS.hasOwnProperty(propName)) {\n    return value *= ctx.dpr;\n  }\n\n  return value;\n};\n\nvar STYLE_COMMON_PROPS = [['shadowBlur', 0], ['shadowOffsetX', 0], ['shadowOffsetY', 0], ['shadowColor', '#000'], ['lineCap', 'butt'], ['lineJoin', 'miter'], ['miterLimit', 10]]; // var SHADOW_PROPS = STYLE_COMMON_PROPS.slice(0, 4);\n// var LINE_PROPS = STYLE_COMMON_PROPS.slice(4);\n\nvar Style = function (opts, host) {\n  this.extendFrom(opts, false);\n  this.host = host;\n};\n\nfunction createLinearGradient(ctx, obj, rect) {\n  var x = obj.x == null ? 0 : obj.x;\n  var x2 = obj.x2 == null ? 1 : obj.x2;\n  var y = obj.y == null ? 0 : obj.y;\n  var y2 = obj.y2 == null ? 0 : obj.y2;\n\n  if (!obj.global) {\n    x = x * rect.width + rect.x;\n    x2 = x2 * rect.width + rect.x;\n    y = y * rect.height + rect.y;\n    y2 = y2 * rect.height + rect.y;\n  } // Fix NaN when rect is Infinity\n\n\n  x = isNaN(x) ? 0 : x;\n  x2 = isNaN(x2) ? 1 : x2;\n  y = isNaN(y) ? 0 : y;\n  y2 = isNaN(y2) ? 0 : y2;\n  var canvasGradient = ctx.createLinearGradient(x, y, x2, y2);\n  return canvasGradient;\n}\n\nfunction createRadialGradient(ctx, obj, rect) {\n  var width = rect.width;\n  var height = rect.height;\n  var min = Math.min(width, height);\n  var x = obj.x == null ? 0.5 : obj.x;\n  var y = obj.y == null ? 0.5 : obj.y;\n  var r = obj.r == null ? 0.5 : obj.r;\n\n  if (!obj.global) {\n    x = x * width + rect.x;\n    y = y * height + rect.y;\n    r = r * min;\n  }\n\n  var canvasGradient = ctx.createRadialGradient(x, y, 0, x, y, r);\n  return canvasGradient;\n}\n\nStyle.prototype = {\n  constructor: Style,\n\n  /**\n   * @type {module:zrender/graphic/Displayable}\n   */\n  host: null,\n\n  /**\n   * @type {string}\n   */\n  fill: '#000',\n\n  /**\n   * @type {string}\n   */\n  stroke: null,\n\n  /**\n   * @type {number}\n   */\n  opacity: 1,\n\n  /**\n   * @type {Array.<number>}\n   */\n  lineDash: null,\n\n  /**\n   * @type {number}\n   */\n  lineDashOffset: 0,\n\n  /**\n   * @type {number}\n   */\n  shadowBlur: 0,\n\n  /**\n   * @type {number}\n   */\n  shadowOffsetX: 0,\n\n  /**\n   * @type {number}\n   */\n  shadowOffsetY: 0,\n\n  /**\n   * @type {number}\n   */\n  lineWidth: 1,\n\n  /**\n   * If stroke ignore scale\n   * @type {Boolean}\n   */\n  strokeNoScale: false,\n  // Bounding rect text configuration\n  // Not affected by element transform\n\n  /**\n   * @type {string}\n   */\n  text: null,\n\n  /**\n   * If `fontSize` or `fontFamily` exists, `font` will be reset by\n   * `fontSize`, `fontStyle`, `fontWeight`, `fontFamily`.\n   * So do not visit it directly in upper application (like echarts),\n   * but use `contain/text#makeFont` instead.\n   * @type {string}\n   */\n  font: null,\n\n  /**\n   * The same as font. Use font please.\n   * @deprecated\n   * @type {string}\n   */\n  textFont: null,\n\n  /**\n   * It helps merging respectively, rather than parsing an entire font string.\n   * @type {string}\n   */\n  fontStyle: null,\n\n  /**\n   * It helps merging respectively, rather than parsing an entire font string.\n   * @type {string}\n   */\n  fontWeight: null,\n\n  /**\n   * It helps merging respectively, rather than parsing an entire font string.\n   * Should be 12 but not '12px'.\n   * @type {number}\n   */\n  fontSize: null,\n\n  /**\n   * It helps merging respectively, rather than parsing an entire font string.\n   * @type {string}\n   */\n  fontFamily: null,\n\n  /**\n   * Reserved for special functinality, like 'hr'.\n   * @type {string}\n   */\n  textTag: null,\n\n  /**\n   * @type {string}\n   */\n  textFill: '#000',\n\n  /**\n   * @type {string}\n   */\n  textStroke: null,\n\n  /**\n   * @type {number}\n   */\n  textWidth: null,\n\n  /**\n   * Only for textBackground.\n   * @type {number}\n   */\n  textHeight: null,\n\n  /**\n   * textStroke may be set as some color as a default\n   * value in upper applicaion, where the default value\n   * of textStrokeWidth should be 0 to make sure that\n   * user can choose to do not use text stroke.\n   * @type {number}\n   */\n  textStrokeWidth: 0,\n\n  /**\n   * @type {number}\n   */\n  textLineHeight: null,\n\n  /**\n   * 'inside', 'left', 'right', 'top', 'bottom'\n   * [x, y]\n   * Based on x, y of rect.\n   * @type {string|Array.<number>}\n   * @default 'inside'\n   */\n  textPosition: 'inside',\n\n  /**\n   * If not specified, use the boundingRect of a `displayable`.\n   * @type {Object}\n   */\n  textRect: null,\n\n  /**\n   * [x, y]\n   * @type {Array.<number>}\n   */\n  textOffset: null,\n\n  /**\n   * @type {string}\n   */\n  textAlign: null,\n\n  /**\n   * @type {string}\n   */\n  textVerticalAlign: null,\n\n  /**\n   * @type {number}\n   */\n  textDistance: 5,\n\n  /**\n   * @type {string}\n   */\n  textShadowColor: 'transparent',\n\n  /**\n   * @type {number}\n   */\n  textShadowBlur: 0,\n\n  /**\n   * @type {number}\n   */\n  textShadowOffsetX: 0,\n\n  /**\n   * @type {number}\n   */\n  textShadowOffsetY: 0,\n\n  /**\n   * @type {string}\n   */\n  textBoxShadowColor: 'transparent',\n\n  /**\n   * @type {number}\n   */\n  textBoxShadowBlur: 0,\n\n  /**\n   * @type {number}\n   */\n  textBoxShadowOffsetX: 0,\n\n  /**\n   * @type {number}\n   */\n  textBoxShadowOffsetY: 0,\n\n  /**\n   * Whether transform text.\n   * Only useful in Path and Image element\n   * @type {boolean}\n   */\n  transformText: false,\n\n  /**\n   * Text rotate around position of Path or Image\n   * Only useful in Path and Image element and transformText is false.\n   */\n  textRotation: 0,\n\n  /**\n   * Text origin of text rotation, like [10, 40].\n   * Based on x, y of rect.\n   * Useful in label rotation of circular symbol.\n   * By default, this origin is textPosition.\n   * Can be 'center'.\n   * @type {string|Array.<number>}\n   */\n  textOrigin: null,\n\n  /**\n   * @type {string}\n   */\n  textBackgroundColor: null,\n\n  /**\n   * @type {string}\n   */\n  textBorderColor: null,\n\n  /**\n   * @type {number}\n   */\n  textBorderWidth: 0,\n\n  /**\n   * @type {number}\n   */\n  textBorderRadius: 0,\n\n  /**\n   * Can be `2` or `[2, 4]` or `[2, 3, 4, 5]`\n   * @type {number|Array.<number>}\n   */\n  textPadding: null,\n\n  /**\n   * Text styles for rich text.\n   * @type {Object}\n   */\n  rich: null,\n\n  /**\n   * {outerWidth, outerHeight, ellipsis, placeholder}\n   * @type {Object}\n   */\n  truncate: null,\n\n  /**\n   * https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/globalCompositeOperation\n   * @type {string}\n   */\n  blend: null,\n\n  /**\n   * @param {CanvasRenderingContext2D} ctx\n   */\n  bind: function (ctx, el, prevEl) {\n    var style = this;\n    var prevStyle = prevEl && prevEl.style;\n    var firstDraw = !prevStyle;\n\n    for (var i = 0; i < STYLE_COMMON_PROPS.length; i++) {\n      var prop = STYLE_COMMON_PROPS[i];\n      var styleName = prop[0];\n\n      if (firstDraw || style[styleName] !== prevStyle[styleName]) {\n        // FIXME Invalid property value will cause style leak from previous element.\n        ctx[styleName] = fixShadow(ctx, styleName, style[styleName] || prop[1]);\n      }\n    }\n\n    if (firstDraw || style.fill !== prevStyle.fill) {\n      ctx.fillStyle = style.fill;\n    }\n\n    if (firstDraw || style.stroke !== prevStyle.stroke) {\n      ctx.strokeStyle = style.stroke;\n    }\n\n    if (firstDraw || style.opacity !== prevStyle.opacity) {\n      ctx.globalAlpha = style.opacity == null ? 1 : style.opacity;\n    }\n\n    if (firstDraw || style.blend !== prevStyle.blend) {\n      ctx.globalCompositeOperation = style.blend || 'source-over';\n    }\n\n    if (this.hasStroke()) {\n      var lineWidth = style.lineWidth;\n      ctx.lineWidth = lineWidth / (this.strokeNoScale && el && el.getLineScale ? el.getLineScale() : 1);\n    }\n  },\n  hasFill: function () {\n    var fill = this.fill;\n    return fill != null && fill !== 'none';\n  },\n  hasStroke: function () {\n    var stroke = this.stroke;\n    return stroke != null && stroke !== 'none' && this.lineWidth > 0;\n  },\n\n  /**\n   * Extend from other style\n   * @param {zrender/graphic/Style} otherStyle\n   * @param {boolean} overwrite true: overwrirte any way.\n   *                            false: overwrite only when !target.hasOwnProperty\n   *                            others: overwrite when property is not null/undefined.\n   */\n  extendFrom: function (otherStyle, overwrite) {\n    if (otherStyle) {\n      for (var name in otherStyle) {\n        if (otherStyle.hasOwnProperty(name) && (overwrite === true || (overwrite === false ? !this.hasOwnProperty(name) : otherStyle[name] != null))) {\n          this[name] = otherStyle[name];\n        }\n      }\n    }\n  },\n\n  /**\n   * Batch setting style with a given object\n   * @param {Object|string} obj\n   * @param {*} [obj]\n   */\n  set: function (obj, value) {\n    if (typeof obj === 'string') {\n      this[obj] = value;\n    } else {\n      this.extendFrom(obj, true);\n    }\n  },\n\n  /**\n   * Clone\n   * @return {zrender/graphic/Style} [description]\n   */\n  clone: function () {\n    var newStyle = new this.constructor();\n    newStyle.extendFrom(this, true);\n    return newStyle;\n  },\n  getGradient: function (ctx, obj, rect) {\n    var method = obj.type === 'radial' ? createRadialGradient : createLinearGradient;\n    var canvasGradient = method(ctx, obj, rect);\n    var colorStops = obj.colorStops;\n\n    for (var i = 0; i < colorStops.length; i++) {\n      canvasGradient.addColorStop(colorStops[i].offset, colorStops[i].color);\n    }\n\n    return canvasGradient;\n  }\n};\nvar styleProto = Style.prototype;\n\nfor (var i = 0; i < STYLE_COMMON_PROPS.length; i++) {\n  var prop = STYLE_COMMON_PROPS[i];\n\n  if (!(prop[0] in styleProto)) {\n    styleProto[prop[0]] = prop[1];\n  }\n} // Provide for others\n\n\nStyle.getGradient = styleProto.getGradient;\n\nvar Pattern = function (image, repeat) {\n  // Should do nothing more in this constructor. Because gradient can be\n  // declard by `color: {image: ...}`, where this constructor will not be called.\n  this.image = image;\n  this.repeat = repeat; // Can be cloned\n\n  this.type = 'pattern';\n};\n\nPattern.prototype.getCanvasPattern = function (ctx) {\n  return ctx.createPattern(this.image, this.repeat || 'repeat');\n};\n\n/**\n * @module zrender/Layer\n * @author pissang(https://www.github.com/pissang)\n */\nfunction returnFalse() {\n  return false;\n}\n/**\n * dom\n *\n * @inner\n * @param {string} id dom id \n * @param {Painter} painter painter instance\n * @param {number} number\n */\n\n\nfunction createDom(id, painter, dpr) {\n  var newDom = createCanvas();\n  var width = painter.getWidth();\n  var height = painter.getHeight();\n  var newDomStyle = newDom.style;\n\n  if (newDomStyle) {\n    // In node or some other non-browser environment\n    newDomStyle.position = 'absolute';\n    newDomStyle.left = 0;\n    newDomStyle.top = 0;\n    newDomStyle.width = width + 'px';\n    newDomStyle.height = height + 'px';\n    newDom.setAttribute('data-zr-dom-id', id);\n  }\n\n  newDom.width = width * dpr;\n  newDom.height = height * dpr;\n  return newDom;\n}\n/**\n * @alias module:zrender/Layer\n * @constructor\n * @extends module:zrender/mixin/Transformable\n * @param {string} id\n * @param {module:zrender/Painter} painter\n * @param {number} [dpr]\n */\n\n\nvar Layer = function (id, painter, dpr) {\n  var dom;\n  dpr = dpr || devicePixelRatio;\n\n  if (typeof id === 'string') {\n    dom = createDom(id, painter, dpr);\n  } // Not using isDom because in node it will return false\n  else if (isObject$1(id)) {\n      dom = id;\n      id = dom.id;\n    }\n\n  this.id = id;\n  this.dom = dom;\n  var domStyle = dom.style;\n\n  if (domStyle) {\n    // Not in node\n    dom.onselectstart = returnFalse; // \n\n    domStyle['-webkit-user-select'] = 'none';\n    domStyle['user-select'] = 'none';\n    domStyle['-webkit-touch-callout'] = 'none';\n    domStyle['-webkit-tap-highlight-color'] = 'rgba(0,0,0,0)';\n    domStyle['padding'] = 0;\n    domStyle['margin'] = 0;\n    domStyle['border-width'] = 0;\n  }\n\n  this.domBack = null;\n  this.ctxBack = null;\n  this.painter = painter;\n  this.config = null; // Configs\n\n  /**\n   * \n   * @type {string}\n   * @default 0\n   */\n\n  this.clearColor = 0;\n  /**\n   * \n   * @type {boolean}\n   * @default false\n   */\n\n  this.motionBlur = false;\n  /**\n   * alpha\n   * @type {number}\n   * @default 0.7\n   */\n\n  this.lastFrameAlpha = 0.7;\n  /**\n   * Layer dpr\n   * @type {number}\n   */\n\n  this.dpr = dpr;\n};\n\nLayer.prototype = {\n  constructor: Layer,\n  __dirty: true,\n  __used: false,\n  __drawIndex: 0,\n  __startIndex: 0,\n  __endIndex: 0,\n  incremental: false,\n  getElementCount: function () {\n    return this.__endIndex - this.__startIndex;\n  },\n  initContext: function () {\n    this.ctx = this.dom.getContext('2d');\n    this.ctx.dpr = this.dpr;\n  },\n  createBackBuffer: function () {\n    var dpr = this.dpr;\n    this.domBack = createDom('back-' + this.id, this.painter, dpr);\n    this.ctxBack = this.domBack.getContext('2d');\n\n    if (dpr != 1) {\n      this.ctxBack.scale(dpr, dpr);\n    }\n  },\n\n  /**\n   * @param  {number} width\n   * @param  {number} height\n   */\n  resize: function (width, height) {\n    var dpr = this.dpr;\n    var dom = this.dom;\n    var domStyle = dom.style;\n    var domBack = this.domBack;\n\n    if (domStyle) {\n      domStyle.width = width + 'px';\n      domStyle.height = height + 'px';\n    }\n\n    dom.width = width * dpr;\n    dom.height = height * dpr;\n\n    if (domBack) {\n      domBack.width = width * dpr;\n      domBack.height = height * dpr;\n\n      if (dpr != 1) {\n        this.ctxBack.scale(dpr, dpr);\n      }\n    }\n  },\n\n  /**\n   * \n   * @param {boolean} [clearAll]=false Clear all with out motion blur\n   * @param {Color} [clearColor]\n   */\n  clear: function (clearAll, clearColor) {\n    var dom = this.dom;\n    var ctx = this.ctx;\n    var width = dom.width;\n    var height = dom.height;\n    var clearColor = clearColor || this.clearColor;\n    var haveMotionBLur = this.motionBlur && !clearAll;\n    var lastFrameAlpha = this.lastFrameAlpha;\n    var dpr = this.dpr;\n\n    if (haveMotionBLur) {\n      if (!this.domBack) {\n        this.createBackBuffer();\n      }\n\n      this.ctxBack.globalCompositeOperation = 'copy';\n      this.ctxBack.drawImage(dom, 0, 0, width / dpr, height / dpr);\n    }\n\n    ctx.clearRect(0, 0, width, height);\n\n    if (clearColor && clearColor !== 'transparent') {\n      var clearColorGradientOrPattern; // Gradient\n\n      if (clearColor.colorStops) {\n        // Cache canvas gradient\n        clearColorGradientOrPattern = clearColor.__canvasGradient || Style.getGradient(ctx, clearColor, {\n          x: 0,\n          y: 0,\n          width: width,\n          height: height\n        });\n        clearColor.__canvasGradient = clearColorGradientOrPattern;\n      } // Pattern\n      else if (clearColor.image) {\n          clearColorGradientOrPattern = Pattern.prototype.getCanvasPattern.call(clearColor, ctx);\n        }\n\n      ctx.save();\n      ctx.fillStyle = clearColorGradientOrPattern || clearColor;\n      ctx.fillRect(0, 0, width, height);\n      ctx.restore();\n    }\n\n    if (haveMotionBLur) {\n      var domBack = this.domBack;\n      ctx.save();\n      ctx.globalAlpha = lastFrameAlpha;\n      ctx.drawImage(domBack, 0, 0, width, height);\n      ctx.restore();\n    }\n  }\n};\n\nvar requestAnimationFrame = typeof window !== 'undefined' && (window.requestAnimationFrame && window.requestAnimationFrame.bind(window) || // https://github.com/ecomfe/zrender/issues/189#issuecomment-224919809\nwindow.msRequestAnimationFrame && window.msRequestAnimationFrame.bind(window) || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame) || function (func) {\n  setTimeout(func, 16);\n};\n\nvar globalImageCache = new LRU(50);\n/**\n * @param {string|HTMLImageElement|HTMLCanvasElement|Canvas} newImageOrSrc\n * @return {HTMLImageElement|HTMLCanvasElement|Canvas} image\n */\n\nfunction findExistImage(newImageOrSrc) {\n  if (typeof newImageOrSrc === 'string') {\n    var cachedImgObj = globalImageCache.get(newImageOrSrc);\n    return cachedImgObj && cachedImgObj.image;\n  } else {\n    return newImageOrSrc;\n  }\n}\n/**\n * Caution: User should cache loaded images, but not just count on LRU.\n * Consider if required images more than LRU size, will dead loop occur?\n *\n * @param {string|HTMLImageElement|HTMLCanvasElement|Canvas} newImageOrSrc\n * @param {HTMLImageElement|HTMLCanvasElement|Canvas} image Existent image.\n * @param {module:zrender/Element} [hostEl] For calling `dirty`.\n * @param {Function} [cb] params: (image, cbPayload)\n * @param {Object} [cbPayload] Payload on cb calling.\n * @return {HTMLImageElement|HTMLCanvasElement|Canvas} image\n */\n\nfunction createOrUpdateImage(newImageOrSrc, image, hostEl, cb, cbPayload) {\n  if (!newImageOrSrc) {\n    return image;\n  } else if (typeof newImageOrSrc === 'string') {\n    // Image should not be loaded repeatly.\n    if (image && image.__zrImageSrc === newImageOrSrc || !hostEl) {\n      return image;\n    } // Only when there is no existent image or existent image src\n    // is different, this method is responsible for load.\n\n\n    var cachedImgObj = globalImageCache.get(newImageOrSrc);\n    var pendingWrap = {\n      hostEl: hostEl,\n      cb: cb,\n      cbPayload: cbPayload\n    };\n\n    if (cachedImgObj) {\n      image = cachedImgObj.image;\n      !isImageReady(image) && cachedImgObj.pending.push(pendingWrap);\n    } else {\n      !image && (image = new Image());\n      image.onload = imageOnLoad;\n      globalImageCache.put(newImageOrSrc, image.__cachedImgObj = {\n        image: image,\n        pending: [pendingWrap]\n      });\n      image.src = image.__zrImageSrc = newImageOrSrc;\n    }\n\n    return image;\n  } // newImageOrSrc is an HTMLImageElement or HTMLCanvasElement or Canvas\n  else {\n      return newImageOrSrc;\n    }\n}\n\nfunction imageOnLoad() {\n  var cachedImgObj = this.__cachedImgObj;\n  this.onload = this.__cachedImgObj = null;\n\n  for (var i = 0; i < cachedImgObj.pending.length; i++) {\n    var pendingWrap = cachedImgObj.pending[i];\n    var cb = pendingWrap.cb;\n    cb && cb(this, pendingWrap.cbPayload);\n    pendingWrap.hostEl.dirty();\n  }\n\n  cachedImgObj.pending.length = 0;\n}\n\nfunction isImageReady(image) {\n  return image && image.width && image.height;\n}\n\nvar textWidthCache = {};\nvar textWidthCacheCounter = 0;\nvar TEXT_CACHE_MAX = 5000;\nvar STYLE_REG = /\\{([a-zA-Z0-9_]+)\\|([^}]*)\\}/g;\nvar DEFAULT_FONT = '12px sans-serif'; // Avoid assign to an exported variable, for transforming to cjs.\n\nvar methods$1 = {};\n\n/**\n * @public\n * @param {string} text\n * @param {string} font\n * @return {number} width\n */\n\nfunction getWidth(text, font) {\n  font = font || DEFAULT_FONT;\n  var key = text + ':' + font;\n\n  if (textWidthCache[key]) {\n    return textWidthCache[key];\n  }\n\n  var textLines = (text + '').split('\\n');\n  var width = 0;\n\n  for (var i = 0, l = textLines.length; i < l; i++) {\n    // textContain.measureText may be overrided in SVG or VML\n    width = Math.max(measureText(textLines[i], font).width, width);\n  }\n\n  if (textWidthCacheCounter > TEXT_CACHE_MAX) {\n    textWidthCacheCounter = 0;\n    textWidthCache = {};\n  }\n\n  textWidthCacheCounter++;\n  textWidthCache[key] = width;\n  return width;\n}\n/**\n * @public\n * @param {string} text\n * @param {string} font\n * @param {string} [textAlign='left']\n * @param {string} [textVerticalAlign='top']\n * @param {Array.<number>} [textPadding]\n * @param {Object} [rich]\n * @param {Object} [truncate]\n * @return {Object} {x, y, width, height, lineHeight}\n */\n\nfunction getBoundingRect(text, font, textAlign, textVerticalAlign, textPadding, rich, truncate) {\n  return rich ? getRichTextRect(text, font, textAlign, textVerticalAlign, textPadding, rich, truncate) : getPlainTextRect(text, font, textAlign, textVerticalAlign, textPadding, truncate);\n}\n\nfunction getPlainTextRect(text, font, textAlign, textVerticalAlign, textPadding, truncate) {\n  var contentBlock = parsePlainText(text, font, textPadding, truncate);\n  var outerWidth = getWidth(text, font);\n\n  if (textPadding) {\n    outerWidth += textPadding[1] + textPadding[3];\n  }\n\n  var outerHeight = contentBlock.outerHeight;\n  var x = adjustTextX(0, outerWidth, textAlign);\n  var y = adjustTextY(0, outerHeight, textVerticalAlign);\n  var rect = new BoundingRect(x, y, outerWidth, outerHeight);\n  rect.lineHeight = contentBlock.lineHeight;\n  return rect;\n}\n\nfunction getRichTextRect(text, font, textAlign, textVerticalAlign, textPadding, rich, truncate) {\n  var contentBlock = parseRichText(text, {\n    rich: rich,\n    truncate: truncate,\n    font: font,\n    textAlign: textAlign,\n    textPadding: textPadding\n  });\n  var outerWidth = contentBlock.outerWidth;\n  var outerHeight = contentBlock.outerHeight;\n  var x = adjustTextX(0, outerWidth, textAlign);\n  var y = adjustTextY(0, outerHeight, textVerticalAlign);\n  return new BoundingRect(x, y, outerWidth, outerHeight);\n}\n/**\n * @public\n * @param {number} x\n * @param {number} width\n * @param {string} [textAlign='left']\n * @return {number} Adjusted x.\n */\n\n\nfunction adjustTextX(x, width, textAlign) {\n  // FIXME Right to left language\n  if (textAlign === 'right') {\n    x -= width;\n  } else if (textAlign === 'center') {\n    x -= width / 2;\n  }\n\n  return x;\n}\n/**\n * @public\n * @param {number} y\n * @param {number} height\n * @param {string} [textVerticalAlign='top']\n * @return {number} Adjusted y.\n */\n\nfunction adjustTextY(y, height, textVerticalAlign) {\n  if (textVerticalAlign === 'middle') {\n    y -= height / 2;\n  } else if (textVerticalAlign === 'bottom') {\n    y -= height;\n  }\n\n  return y;\n}\n/**\n * @public\n * @param {stirng} textPosition\n * @param {Object} rect {x, y, width, height}\n * @param {number} distance\n * @return {Object} {x, y, textAlign, textVerticalAlign}\n */\n\nfunction adjustTextPositionOnRect(textPosition, rect, distance) {\n  var x = rect.x;\n  var y = rect.y;\n  var height = rect.height;\n  var width = rect.width;\n  var halfHeight = height / 2;\n  var textAlign = 'left';\n  var textVerticalAlign = 'top';\n\n  switch (textPosition) {\n    case 'left':\n      x -= distance;\n      y += halfHeight;\n      textAlign = 'right';\n      textVerticalAlign = 'middle';\n      break;\n\n    case 'right':\n      x += distance + width;\n      y += halfHeight;\n      textVerticalAlign = 'middle';\n      break;\n\n    case 'top':\n      x += width / 2;\n      y -= distance;\n      textAlign = 'center';\n      textVerticalAlign = 'bottom';\n      break;\n\n    case 'bottom':\n      x += width / 2;\n      y += height + distance;\n      textAlign = 'center';\n      break;\n\n    case 'inside':\n      x += width / 2;\n      y += halfHeight;\n      textAlign = 'center';\n      textVerticalAlign = 'middle';\n      break;\n\n    case 'insideLeft':\n      x += distance;\n      y += halfHeight;\n      textVerticalAlign = 'middle';\n      break;\n\n    case 'insideRight':\n      x += width - distance;\n      y += halfHeight;\n      textAlign = 'right';\n      textVerticalAlign = 'middle';\n      break;\n\n    case 'insideTop':\n      x += width / 2;\n      y += distance;\n      textAlign = 'center';\n      break;\n\n    case 'insideBottom':\n      x += width / 2;\n      y += height - distance;\n      textAlign = 'center';\n      textVerticalAlign = 'bottom';\n      break;\n\n    case 'insideTopLeft':\n      x += distance;\n      y += distance;\n      break;\n\n    case 'insideTopRight':\n      x += width - distance;\n      y += distance;\n      textAlign = 'right';\n      break;\n\n    case 'insideBottomLeft':\n      x += distance;\n      y += height - distance;\n      textVerticalAlign = 'bottom';\n      break;\n\n    case 'insideBottomRight':\n      x += width - distance;\n      y += height - distance;\n      textAlign = 'right';\n      textVerticalAlign = 'bottom';\n      break;\n  }\n\n  return {\n    x: x,\n    y: y,\n    textAlign: textAlign,\n    textVerticalAlign: textVerticalAlign\n  };\n}\n/**\n * Show ellipsis if overflow.\n *\n * @public\n * @param  {string} text\n * @param  {string} containerWidth\n * @param  {string} font\n * @param  {number} [ellipsis='...']\n * @param  {Object} [options]\n * @param  {number} [options.maxIterations=3]\n * @param  {number} [options.minChar=0] If truncate result are less\n *                  then minChar, ellipsis will not show, which is\n *                  better for user hint in some cases.\n * @param  {number} [options.placeholder=''] When all truncated, use the placeholder.\n * @return {string}\n */\n\nfunction truncateText(text, containerWidth, font, ellipsis, options) {\n  if (!containerWidth) {\n    return '';\n  }\n\n  var textLines = (text + '').split('\\n');\n  options = prepareTruncateOptions(containerWidth, font, ellipsis, options); // FIXME\n  // It is not appropriate that every line has '...' when truncate multiple lines.\n\n  for (var i = 0, len = textLines.length; i < len; i++) {\n    textLines[i] = truncateSingleLine(textLines[i], options);\n  }\n\n  return textLines.join('\\n');\n}\n\nfunction prepareTruncateOptions(containerWidth, font, ellipsis, options) {\n  options = extend({}, options);\n  options.font = font;\n  var ellipsis = retrieve2(ellipsis, '...');\n  options.maxIterations = retrieve2(options.maxIterations, 2);\n  var minChar = options.minChar = retrieve2(options.minChar, 0); // FIXME\n  // Other languages?\n\n  options.cnCharWidth = getWidth('', font); // FIXME\n  // Consider proportional font?\n\n  var ascCharWidth = options.ascCharWidth = getWidth('a', font);\n  options.placeholder = retrieve2(options.placeholder, ''); // Example 1: minChar: 3, text: 'asdfzxcv', truncate result: 'asdf', but not: 'a...'.\n  // Example 2: minChar: 3, text: '', truncate result: '', but not: '...'.\n\n  var contentWidth = containerWidth = Math.max(0, containerWidth - 1); // Reserve some gap.\n\n  for (var i = 0; i < minChar && contentWidth >= ascCharWidth; i++) {\n    contentWidth -= ascCharWidth;\n  }\n\n  var ellipsisWidth = getWidth(ellipsis);\n\n  if (ellipsisWidth > contentWidth) {\n    ellipsis = '';\n    ellipsisWidth = 0;\n  }\n\n  contentWidth = containerWidth - ellipsisWidth;\n  options.ellipsis = ellipsis;\n  options.ellipsisWidth = ellipsisWidth;\n  options.contentWidth = contentWidth;\n  options.containerWidth = containerWidth;\n  return options;\n}\n\nfunction truncateSingleLine(textLine, options) {\n  var containerWidth = options.containerWidth;\n  var font = options.font;\n  var contentWidth = options.contentWidth;\n\n  if (!containerWidth) {\n    return '';\n  }\n\n  var lineWidth = getWidth(textLine, font);\n\n  if (lineWidth <= containerWidth) {\n    return textLine;\n  }\n\n  for (var j = 0;; j++) {\n    if (lineWidth <= contentWidth || j >= options.maxIterations) {\n      textLine += options.ellipsis;\n      break;\n    }\n\n    var subLength = j === 0 ? estimateLength(textLine, contentWidth, options.ascCharWidth, options.cnCharWidth) : lineWidth > 0 ? Math.floor(textLine.length * contentWidth / lineWidth) : 0;\n    textLine = textLine.substr(0, subLength);\n    lineWidth = getWidth(textLine, font);\n  }\n\n  if (textLine === '') {\n    textLine = options.placeholder;\n  }\n\n  return textLine;\n}\n\nfunction estimateLength(text, contentWidth, ascCharWidth, cnCharWidth) {\n  var width = 0;\n  var i = 0;\n\n  for (var len = text.length; i < len && width < contentWidth; i++) {\n    var charCode = text.charCodeAt(i);\n    width += 0 <= charCode && charCode <= 127 ? ascCharWidth : cnCharWidth;\n  }\n\n  return i;\n}\n/**\n * @public\n * @param {string} font\n * @return {number} line height\n */\n\n\nfunction getLineHeight(font) {\n  // FIXME A rough approach.\n  return getWidth('', font);\n}\n/**\n * @public\n * @param {string} text\n * @param {string} font\n * @return {Object} width\n */\n\nfunction measureText(text, font) {\n  return methods$1.measureText(text, font);\n} // Avoid assign to an exported variable, for transforming to cjs.\n\nmethods$1.measureText = function (text, font) {\n  var ctx = getContext();\n  ctx.font = font || DEFAULT_FONT;\n  return ctx.measureText(text);\n};\n/**\n * @public\n * @param {string} text\n * @param {string} font\n * @param {Object} [truncate]\n * @return {Object} block: {lineHeight, lines, height, outerHeight}\n *  Notice: for performance, do not calculate outerWidth util needed.\n */\n\n\nfunction parsePlainText(text, font, padding, truncate) {\n  text != null && (text += '');\n  var lineHeight = getLineHeight(font);\n  var lines = text ? text.split('\\n') : [];\n  var height = lines.length * lineHeight;\n  var outerHeight = height;\n\n  if (padding) {\n    outerHeight += padding[0] + padding[2];\n  }\n\n  if (text && truncate) {\n    var truncOuterHeight = truncate.outerHeight;\n    var truncOuterWidth = truncate.outerWidth;\n\n    if (truncOuterHeight != null && outerHeight > truncOuterHeight) {\n      text = '';\n      lines = [];\n    } else if (truncOuterWidth != null) {\n      var options = prepareTruncateOptions(truncOuterWidth - (padding ? padding[1] + padding[3] : 0), font, truncate.ellipsis, {\n        minChar: truncate.minChar,\n        placeholder: truncate.placeholder\n      }); // FIXME\n      // It is not appropriate that every line has '...' when truncate multiple lines.\n\n      for (var i = 0, len = lines.length; i < len; i++) {\n        lines[i] = truncateSingleLine(lines[i], options);\n      }\n    }\n  }\n\n  return {\n    lines: lines,\n    height: height,\n    outerHeight: outerHeight,\n    lineHeight: lineHeight\n  };\n}\n/**\n * For example: 'some text {a|some text}other text{b|some text}xxx{c|}xxx'\n * Also consider 'bbbb{a|xxx\\nzzz}xxxx\\naaaa'.\n *\n * @public\n * @param {string} text\n * @param {Object} style\n * @return {Object} block\n * {\n *      width,\n *      height,\n *      lines: [{\n *          lineHeight,\n *          width,\n *          tokens: [[{\n *              styleName,\n *              text,\n *              width,      // include textPadding\n *              height,     // include textPadding\n *              textWidth, // pure text width\n *              textHeight, // pure text height\n *              lineHeihgt,\n *              font,\n *              textAlign,\n *              textVerticalAlign\n *          }], [...], ...]\n *      }, ...]\n * }\n * If styleName is undefined, it is plain text.\n */\n\nfunction parseRichText(text, style) {\n  var contentBlock = {\n    lines: [],\n    width: 0,\n    height: 0\n  };\n  text != null && (text += '');\n\n  if (!text) {\n    return contentBlock;\n  }\n\n  var lastIndex = STYLE_REG.lastIndex = 0;\n  var result;\n\n  while ((result = STYLE_REG.exec(text)) != null) {\n    var matchedIndex = result.index;\n\n    if (matchedIndex > lastIndex) {\n      pushTokens(contentBlock, text.substring(lastIndex, matchedIndex));\n    }\n\n    pushTokens(contentBlock, result[2], result[1]);\n    lastIndex = STYLE_REG.lastIndex;\n  }\n\n  if (lastIndex < text.length) {\n    pushTokens(contentBlock, text.substring(lastIndex, text.length));\n  }\n\n  var lines = contentBlock.lines;\n  var contentHeight = 0;\n  var contentWidth = 0; // For `textWidth: 100%`\n\n  var pendingList = [];\n  var stlPadding = style.textPadding;\n  var truncate = style.truncate;\n  var truncateWidth = truncate && truncate.outerWidth;\n  var truncateHeight = truncate && truncate.outerHeight;\n\n  if (stlPadding) {\n    truncateWidth != null && (truncateWidth -= stlPadding[1] + stlPadding[3]);\n    truncateHeight != null && (truncateHeight -= stlPadding[0] + stlPadding[2]);\n  } // Calculate layout info of tokens.\n\n\n  for (var i = 0; i < lines.length; i++) {\n    var line = lines[i];\n    var lineHeight = 0;\n    var lineWidth = 0;\n\n    for (var j = 0; j < line.tokens.length; j++) {\n      var token = line.tokens[j];\n      var tokenStyle = token.styleName && style.rich[token.styleName] || {}; // textPadding should not inherit from style.\n\n      var textPadding = token.textPadding = tokenStyle.textPadding; // textFont has been asigned to font by `normalizeStyle`.\n\n      var font = token.font = tokenStyle.font || style.font; // textHeight can be used when textVerticalAlign is specified in token.\n\n      var tokenHeight = token.textHeight = retrieve2( // textHeight should not be inherited, consider it can be specified\n      // as box height of the block.\n      tokenStyle.textHeight, getLineHeight(font));\n      textPadding && (tokenHeight += textPadding[0] + textPadding[2]);\n      token.height = tokenHeight;\n      token.lineHeight = retrieve3(tokenStyle.textLineHeight, style.textLineHeight, tokenHeight);\n      token.textAlign = tokenStyle && tokenStyle.textAlign || style.textAlign;\n      token.textVerticalAlign = tokenStyle && tokenStyle.textVerticalAlign || 'middle';\n\n      if (truncateHeight != null && contentHeight + token.lineHeight > truncateHeight) {\n        return {\n          lines: [],\n          width: 0,\n          height: 0\n        };\n      }\n\n      token.textWidth = getWidth(token.text, font);\n      var tokenWidth = tokenStyle.textWidth;\n      var tokenWidthNotSpecified = tokenWidth == null || tokenWidth === 'auto'; // Percent width, can be `100%`, can be used in drawing separate\n      // line when box width is needed to be auto.\n\n      if (typeof tokenWidth === 'string' && tokenWidth.charAt(tokenWidth.length - 1) === '%') {\n        token.percentWidth = tokenWidth;\n        pendingList.push(token);\n        tokenWidth = 0; // Do not truncate in this case, because there is no user case\n        // and it is too complicated.\n      } else {\n        if (tokenWidthNotSpecified) {\n          tokenWidth = token.textWidth; // FIXME: If image is not loaded and textWidth is not specified, calling\n          // `getBoundingRect()` will not get correct result.\n\n          var textBackgroundColor = tokenStyle.textBackgroundColor;\n          var bgImg = textBackgroundColor && textBackgroundColor.image; // Use cases:\n          // (1) If image is not loaded, it will be loaded at render phase and call\n          // `dirty()` and `textBackgroundColor.image` will be replaced with the loaded\n          // image, and then the right size will be calculated here at the next tick.\n          // See `graphic/helper/text.js`.\n          // (2) If image loaded, and `textBackgroundColor.image` is image src string,\n          // use `imageHelper.findExistImage` to find cached image.\n          // `imageHelper.findExistImage` will always be called here before\n          // `imageHelper.createOrUpdateImage` in `graphic/helper/text.js#renderRichText`\n          // which ensures that image will not be rendered before correct size calcualted.\n\n          if (bgImg) {\n            bgImg = findExistImage(bgImg);\n\n            if (isImageReady(bgImg)) {\n              tokenWidth = Math.max(tokenWidth, bgImg.width * tokenHeight / bgImg.height);\n            }\n          }\n        }\n\n        var paddingW = textPadding ? textPadding[1] + textPadding[3] : 0;\n        tokenWidth += paddingW;\n        var remianTruncWidth = truncateWidth != null ? truncateWidth - lineWidth : null;\n\n        if (remianTruncWidth != null && remianTruncWidth < tokenWidth) {\n          if (!tokenWidthNotSpecified || remianTruncWidth < paddingW) {\n            token.text = '';\n            token.textWidth = tokenWidth = 0;\n          } else {\n            token.text = truncateText(token.text, remianTruncWidth - paddingW, font, truncate.ellipsis, {\n              minChar: truncate.minChar\n            });\n            token.textWidth = getWidth(token.text, font);\n            tokenWidth = token.textWidth + paddingW;\n          }\n        }\n      }\n\n      lineWidth += token.width = tokenWidth;\n      tokenStyle && (lineHeight = Math.max(lineHeight, token.lineHeight));\n    }\n\n    line.width = lineWidth;\n    line.lineHeight = lineHeight;\n    contentHeight += lineHeight;\n    contentWidth = Math.max(contentWidth, lineWidth);\n  }\n\n  contentBlock.outerWidth = contentBlock.width = retrieve2(style.textWidth, contentWidth);\n  contentBlock.outerHeight = contentBlock.height = retrieve2(style.textHeight, contentHeight);\n\n  if (stlPadding) {\n    contentBlock.outerWidth += stlPadding[1] + stlPadding[3];\n    contentBlock.outerHeight += stlPadding[0] + stlPadding[2];\n  }\n\n  for (var i = 0; i < pendingList.length; i++) {\n    var token = pendingList[i];\n    var percentWidth = token.percentWidth; // Should not base on outerWidth, because token can not be placed out of padding.\n\n    token.width = parseInt(percentWidth, 10) / 100 * contentWidth;\n  }\n\n  return contentBlock;\n}\n\nfunction pushTokens(block, str, styleName) {\n  var isEmptyStr = str === '';\n  var strs = str.split('\\n');\n  var lines = block.lines;\n\n  for (var i = 0; i < strs.length; i++) {\n    var text = strs[i];\n    var token = {\n      styleName: styleName,\n      text: text,\n      isLineHolder: !text && !isEmptyStr\n    }; // The first token should be appended to the last line.\n\n    if (!i) {\n      var tokens = (lines[lines.length - 1] || (lines[0] = {\n        tokens: []\n      })).tokens; // Consider cases:\n      // (1) ''.split('\\n') => ['', '\\n', ''], the '' at the first item\n      // (which is a placeholder) should be replaced by new token.\n      // (2) A image backage, where token likes {a|}.\n      // (3) A redundant '' will affect textAlign in line.\n      // (4) tokens with the same tplName should not be merged, because\n      // they should be displayed in different box (with border and padding).\n\n      var tokensLen = tokens.length;\n      tokensLen === 1 && tokens[0].isLineHolder ? tokens[0] = token : // Consider text is '', only insert when it is the \"lineHolder\" or\n      // \"emptyStr\". Otherwise a redundant '' will affect textAlign in line.\n      (text || !tokensLen || isEmptyStr) && tokens.push(token);\n    } // Other tokens always start a new line.\n    else {\n        // If there is '', insert it as a placeholder.\n        lines.push({\n          tokens: [token]\n        });\n      }\n  }\n}\n\nfunction makeFont(style) {\n  // FIXME in node-canvas fontWeight is before fontStyle\n  // Use `fontSize` `fontFamily` to check whether font properties are defined.\n  var font = (style.fontSize || style.fontFamily) && [style.fontStyle, style.fontWeight, (style.fontSize || 12) + 'px', // If font properties are defined, `fontFamily` should not be ignored.\n  style.fontFamily || 'sans-serif'].join(' ');\n  return font && trim(font) || style.textFont || style.font;\n}\n\nfunction buildPath(ctx, shape) {\n  var x = shape.x;\n  var y = shape.y;\n  var width = shape.width;\n  var height = shape.height;\n  var r = shape.r;\n  var r1;\n  var r2;\n  var r3;\n  var r4; // Convert width and height to positive for better borderRadius\n\n  if (width < 0) {\n    x = x + width;\n    width = -width;\n  }\n\n  if (height < 0) {\n    y = y + height;\n    height = -height;\n  }\n\n  if (typeof r === 'number') {\n    r1 = r2 = r3 = r4 = r;\n  } else if (r instanceof Array) {\n    if (r.length === 1) {\n      r1 = r2 = r3 = r4 = r[0];\n    } else if (r.length === 2) {\n      r1 = r3 = r[0];\n      r2 = r4 = r[1];\n    } else if (r.length === 3) {\n      r1 = r[0];\n      r2 = r4 = r[1];\n      r3 = r[2];\n    } else {\n      r1 = r[0];\n      r2 = r[1];\n      r3 = r[2];\n      r4 = r[3];\n    }\n  } else {\n    r1 = r2 = r3 = r4 = 0;\n  }\n\n  var total;\n\n  if (r1 + r2 > width) {\n    total = r1 + r2;\n    r1 *= width / total;\n    r2 *= width / total;\n  }\n\n  if (r3 + r4 > width) {\n    total = r3 + r4;\n    r3 *= width / total;\n    r4 *= width / total;\n  }\n\n  if (r2 + r3 > height) {\n    total = r2 + r3;\n    r2 *= height / total;\n    r3 *= height / total;\n  }\n\n  if (r1 + r4 > height) {\n    total = r1 + r4;\n    r1 *= height / total;\n    r4 *= height / total;\n  }\n\n  ctx.moveTo(x + r1, y);\n  ctx.lineTo(x + width - r2, y);\n  r2 !== 0 && ctx.arc(x + width - r2, y + r2, r2, -Math.PI / 2, 0);\n  ctx.lineTo(x + width, y + height - r3);\n  r3 !== 0 && ctx.arc(x + width - r3, y + height - r3, r3, 0, Math.PI / 2);\n  ctx.lineTo(x + r4, y + height);\n  r4 !== 0 && ctx.arc(x + r4, y + height - r4, r4, Math.PI / 2, Math.PI);\n  ctx.lineTo(x, y + r1);\n  r1 !== 0 && ctx.arc(x + r1, y + r1, r1, Math.PI, Math.PI * 1.5);\n}\n\nvar VALID_TEXT_ALIGN = {\n  left: 1,\n  right: 1,\n  center: 1\n};\nvar VALID_TEXT_VERTICAL_ALIGN = {\n  top: 1,\n  bottom: 1,\n  middle: 1\n};\n/**\n * @param {module:zrender/graphic/Style} style\n * @return {module:zrender/graphic/Style} The input style.\n */\n\nfunction normalizeTextStyle(style) {\n  normalizeStyle(style);\n  each$1(style.rich, normalizeStyle);\n  return style;\n}\n\nfunction normalizeStyle(style) {\n  if (style) {\n    style.font = makeFont(style);\n    var textAlign = style.textAlign;\n    textAlign === 'middle' && (textAlign = 'center');\n    style.textAlign = textAlign == null || VALID_TEXT_ALIGN[textAlign] ? textAlign : 'left'; // Compatible with textBaseline.\n\n    var textVerticalAlign = style.textVerticalAlign || style.textBaseline;\n    textVerticalAlign === 'center' && (textVerticalAlign = 'middle');\n    style.textVerticalAlign = textVerticalAlign == null || VALID_TEXT_VERTICAL_ALIGN[textVerticalAlign] ? textVerticalAlign : 'top';\n    var textPadding = style.textPadding;\n\n    if (textPadding) {\n      style.textPadding = normalizeCssArray(style.textPadding);\n    }\n  }\n}\n/**\n * @param {CanvasRenderingContext2D} ctx\n * @param {string} text\n * @param {module:zrender/graphic/Style} style\n * @param {Object|boolean} [rect] {x, y, width, height}\n *                  If set false, rect text is not used.\n */\n\n\nfunction renderText(hostEl, ctx, text, style, rect) {\n  style.rich ? renderRichText(hostEl, ctx, text, style, rect) : renderPlainText(hostEl, ctx, text, style, rect);\n}\n\nfunction renderPlainText(hostEl, ctx, text, style, rect) {\n  var font = setCtx(ctx, 'font', style.font || DEFAULT_FONT);\n  var textPadding = style.textPadding;\n  var contentBlock = hostEl.__textCotentBlock;\n\n  if (!contentBlock || hostEl.__dirty) {\n    contentBlock = hostEl.__textCotentBlock = parsePlainText(text, font, textPadding, style.truncate);\n  }\n\n  var outerHeight = contentBlock.outerHeight;\n  var textLines = contentBlock.lines;\n  var lineHeight = contentBlock.lineHeight;\n  var boxPos = getBoxPosition(outerHeight, style, rect);\n  var baseX = boxPos.baseX;\n  var baseY = boxPos.baseY;\n  var textAlign = boxPos.textAlign;\n  var textVerticalAlign = boxPos.textVerticalAlign; // Origin of textRotation should be the base point of text drawing.\n\n  applyTextRotation(ctx, style, rect, baseX, baseY);\n  var boxY = adjustTextY(baseY, outerHeight, textVerticalAlign);\n  var textX = baseX;\n  var textY = boxY;\n  var needDrawBg = needDrawBackground(style);\n\n  if (needDrawBg || textPadding) {\n    // Consider performance, do not call getTextWidth util necessary.\n    var textWidth = getWidth(text, font);\n    var outerWidth = textWidth;\n    textPadding && (outerWidth += textPadding[1] + textPadding[3]);\n    var boxX = adjustTextX(baseX, outerWidth, textAlign);\n    needDrawBg && drawBackground(hostEl, ctx, style, boxX, boxY, outerWidth, outerHeight);\n\n    if (textPadding) {\n      textX = getTextXForPadding(baseX, textAlign, textPadding);\n      textY += textPadding[0];\n    }\n  }\n\n  setCtx(ctx, 'textAlign', textAlign || 'left'); // Force baseline to be \"middle\". Otherwise, if using \"top\", the\n  // text will offset downward a little bit in font \"Microsoft YaHei\".\n\n  setCtx(ctx, 'textBaseline', 'middle'); // Always set shadowBlur and shadowOffset to avoid leak from displayable.\n\n  setCtx(ctx, 'shadowBlur', style.textShadowBlur || 0);\n  setCtx(ctx, 'shadowColor', style.textShadowColor || 'transparent');\n  setCtx(ctx, 'shadowOffsetX', style.textShadowOffsetX || 0);\n  setCtx(ctx, 'shadowOffsetY', style.textShadowOffsetY || 0); // `textBaseline` is set as 'middle'.\n\n  textY += lineHeight / 2;\n  var textStrokeWidth = style.textStrokeWidth;\n  var textStroke = getStroke(style.textStroke, textStrokeWidth);\n  var textFill = getFill(style.textFill);\n\n  if (textStroke) {\n    setCtx(ctx, 'lineWidth', textStrokeWidth);\n    setCtx(ctx, 'strokeStyle', textStroke);\n  }\n\n  if (textFill) {\n    setCtx(ctx, 'fillStyle', textFill);\n  }\n\n  for (var i = 0; i < textLines.length; i++) {\n    // Fill after stroke so the outline will not cover the main part.\n    textStroke && ctx.strokeText(textLines[i], textX, textY);\n    textFill && ctx.fillText(textLines[i], textX, textY);\n    textY += lineHeight;\n  }\n}\n\nfunction renderRichText(hostEl, ctx, text, style, rect) {\n  var contentBlock = hostEl.__textCotentBlock;\n\n  if (!contentBlock || hostEl.__dirty) {\n    contentBlock = hostEl.__textCotentBlock = parseRichText(text, style);\n  }\n\n  drawRichText(hostEl, ctx, contentBlock, style, rect);\n}\n\nfunction drawRichText(hostEl, ctx, contentBlock, style, rect) {\n  var contentWidth = contentBlock.width;\n  var outerWidth = contentBlock.outerWidth;\n  var outerHeight = contentBlock.outerHeight;\n  var textPadding = style.textPadding;\n  var boxPos = getBoxPosition(outerHeight, style, rect);\n  var baseX = boxPos.baseX;\n  var baseY = boxPos.baseY;\n  var textAlign = boxPos.textAlign;\n  var textVerticalAlign = boxPos.textVerticalAlign; // Origin of textRotation should be the base point of text drawing.\n\n  applyTextRotation(ctx, style, rect, baseX, baseY);\n  var boxX = adjustTextX(baseX, outerWidth, textAlign);\n  var boxY = adjustTextY(baseY, outerHeight, textVerticalAlign);\n  var xLeft = boxX;\n  var lineTop = boxY;\n\n  if (textPadding) {\n    xLeft += textPadding[3];\n    lineTop += textPadding[0];\n  }\n\n  var xRight = xLeft + contentWidth;\n  needDrawBackground(style) && drawBackground(hostEl, ctx, style, boxX, boxY, outerWidth, outerHeight);\n\n  for (var i = 0; i < contentBlock.lines.length; i++) {\n    var line = contentBlock.lines[i];\n    var tokens = line.tokens;\n    var tokenCount = tokens.length;\n    var lineHeight = line.lineHeight;\n    var usedWidth = line.width;\n    var leftIndex = 0;\n    var lineXLeft = xLeft;\n    var lineXRight = xRight;\n    var rightIndex = tokenCount - 1;\n    var token;\n\n    while (leftIndex < tokenCount && (token = tokens[leftIndex], !token.textAlign || token.textAlign === 'left')) {\n      placeToken(hostEl, ctx, token, style, lineHeight, lineTop, lineXLeft, 'left');\n      usedWidth -= token.width;\n      lineXLeft += token.width;\n      leftIndex++;\n    }\n\n    while (rightIndex >= 0 && (token = tokens[rightIndex], token.textAlign === 'right')) {\n      placeToken(hostEl, ctx, token, style, lineHeight, lineTop, lineXRight, 'right');\n      usedWidth -= token.width;\n      lineXRight -= token.width;\n      rightIndex--;\n    } // The other tokens are placed as textAlign 'center' if there is enough space.\n\n\n    lineXLeft += (contentWidth - (lineXLeft - xLeft) - (xRight - lineXRight) - usedWidth) / 2;\n\n    while (leftIndex <= rightIndex) {\n      token = tokens[leftIndex]; // Consider width specified by user, use 'center' rather than 'left'.\n\n      placeToken(hostEl, ctx, token, style, lineHeight, lineTop, lineXLeft + token.width / 2, 'center');\n      lineXLeft += token.width;\n      leftIndex++;\n    }\n\n    lineTop += lineHeight;\n  }\n}\n\nfunction applyTextRotation(ctx, style, rect, x, y) {\n  // textRotation only apply in RectText.\n  if (rect && style.textRotation) {\n    var origin = style.textOrigin;\n\n    if (origin === 'center') {\n      x = rect.width / 2 + rect.x;\n      y = rect.height / 2 + rect.y;\n    } else if (origin) {\n      x = origin[0] + rect.x;\n      y = origin[1] + rect.y;\n    }\n\n    ctx.translate(x, y); // Positive: anticlockwise\n\n    ctx.rotate(-style.textRotation);\n    ctx.translate(-x, -y);\n  }\n}\n\nfunction placeToken(hostEl, ctx, token, style, lineHeight, lineTop, x, textAlign) {\n  var tokenStyle = style.rich[token.styleName] || {}; // 'ctx.textBaseline' is always set as 'middle', for sake of\n  // the bias of \"Microsoft YaHei\".\n\n  var textVerticalAlign = token.textVerticalAlign;\n  var y = lineTop + lineHeight / 2;\n\n  if (textVerticalAlign === 'top') {\n    y = lineTop + token.height / 2;\n  } else if (textVerticalAlign === 'bottom') {\n    y = lineTop + lineHeight - token.height / 2;\n  }\n\n  !token.isLineHolder && needDrawBackground(tokenStyle) && drawBackground(hostEl, ctx, tokenStyle, textAlign === 'right' ? x - token.width : textAlign === 'center' ? x - token.width / 2 : x, y - token.height / 2, token.width, token.height);\n  var textPadding = token.textPadding;\n\n  if (textPadding) {\n    x = getTextXForPadding(x, textAlign, textPadding);\n    y -= token.height / 2 - textPadding[2] - token.textHeight / 2;\n  }\n\n  setCtx(ctx, 'shadowBlur', retrieve3(tokenStyle.textShadowBlur, style.textShadowBlur, 0));\n  setCtx(ctx, 'shadowColor', tokenStyle.textShadowColor || style.textShadowColor || 'transparent');\n  setCtx(ctx, 'shadowOffsetX', retrieve3(tokenStyle.textShadowOffsetX, style.textShadowOffsetX, 0));\n  setCtx(ctx, 'shadowOffsetY', retrieve3(tokenStyle.textShadowOffsetY, style.textShadowOffsetY, 0));\n  setCtx(ctx, 'textAlign', textAlign); // Force baseline to be \"middle\". Otherwise, if using \"top\", the\n  // text will offset downward a little bit in font \"Microsoft YaHei\".\n\n  setCtx(ctx, 'textBaseline', 'middle');\n  setCtx(ctx, 'font', token.font || DEFAULT_FONT);\n  var textStroke = getStroke(tokenStyle.textStroke || style.textStroke, textStrokeWidth);\n  var textFill = getFill(tokenStyle.textFill || style.textFill);\n  var textStrokeWidth = retrieve2(tokenStyle.textStrokeWidth, style.textStrokeWidth); // Fill after stroke so the outline will not cover the main part.\n\n  if (textStroke) {\n    setCtx(ctx, 'lineWidth', textStrokeWidth);\n    setCtx(ctx, 'strokeStyle', textStroke);\n    ctx.strokeText(token.text, x, y);\n  }\n\n  if (textFill) {\n    setCtx(ctx, 'fillStyle', textFill);\n    ctx.fillText(token.text, x, y);\n  }\n}\n\nfunction needDrawBackground(style) {\n  return style.textBackgroundColor || style.textBorderWidth && style.textBorderColor;\n} // style: {textBackgroundColor, textBorderWidth, textBorderColor, textBorderRadius}\n// shape: {x, y, width, height}\n\n\nfunction drawBackground(hostEl, ctx, style, x, y, width, height) {\n  var textBackgroundColor = style.textBackgroundColor;\n  var textBorderWidth = style.textBorderWidth;\n  var textBorderColor = style.textBorderColor;\n  var isPlainBg = isString(textBackgroundColor);\n  setCtx(ctx, 'shadowBlur', style.textBoxShadowBlur || 0);\n  setCtx(ctx, 'shadowColor', style.textBoxShadowColor || 'transparent');\n  setCtx(ctx, 'shadowOffsetX', style.textBoxShadowOffsetX || 0);\n  setCtx(ctx, 'shadowOffsetY', style.textBoxShadowOffsetY || 0);\n\n  if (isPlainBg || textBorderWidth && textBorderColor) {\n    ctx.beginPath();\n    var textBorderRadius = style.textBorderRadius;\n\n    if (!textBorderRadius) {\n      ctx.rect(x, y, width, height);\n    } else {\n      buildPath(ctx, {\n        x: x,\n        y: y,\n        width: width,\n        height: height,\n        r: textBorderRadius\n      });\n    }\n\n    ctx.closePath();\n  }\n\n  if (isPlainBg) {\n    setCtx(ctx, 'fillStyle', textBackgroundColor);\n    ctx.fill();\n  } else if (isObject$1(textBackgroundColor)) {\n    var image = textBackgroundColor.image;\n    image = createOrUpdateImage(image, null, hostEl, onBgImageLoaded, textBackgroundColor);\n\n    if (image && isImageReady(image)) {\n      ctx.drawImage(image, x, y, width, height);\n    }\n  }\n\n  if (textBorderWidth && textBorderColor) {\n    setCtx(ctx, 'lineWidth', textBorderWidth);\n    setCtx(ctx, 'strokeStyle', textBorderColor);\n    ctx.stroke();\n  }\n}\n\nfunction onBgImageLoaded(image, textBackgroundColor) {\n  // Replace image, so that `contain/text.js#parseRichText`\n  // will get correct result in next tick.\n  textBackgroundColor.image = image;\n}\n\nfunction getBoxPosition(blockHeiht, style, rect) {\n  var baseX = style.x || 0;\n  var baseY = style.y || 0;\n  var textAlign = style.textAlign;\n  var textVerticalAlign = style.textVerticalAlign; // Text position represented by coord\n\n  if (rect) {\n    var textPosition = style.textPosition;\n\n    if (textPosition instanceof Array) {\n      // Percent\n      baseX = rect.x + parsePercent(textPosition[0], rect.width);\n      baseY = rect.y + parsePercent(textPosition[1], rect.height);\n    } else {\n      var res = adjustTextPositionOnRect(textPosition, rect, style.textDistance);\n      baseX = res.x;\n      baseY = res.y; // Default align and baseline when has textPosition\n\n      textAlign = textAlign || res.textAlign;\n      textVerticalAlign = textVerticalAlign || res.textVerticalAlign;\n    } // textOffset is only support in RectText, otherwise\n    // we have to adjust boundingRect for textOffset.\n\n\n    var textOffset = style.textOffset;\n\n    if (textOffset) {\n      baseX += textOffset[0];\n      baseY += textOffset[1];\n    }\n  }\n\n  return {\n    baseX: baseX,\n    baseY: baseY,\n    textAlign: textAlign,\n    textVerticalAlign: textVerticalAlign\n  };\n}\n\nfunction setCtx(ctx, prop, value) {\n  ctx[prop] = fixShadow(ctx, prop, value);\n  return ctx[prop];\n}\n/**\n * @param {string} [stroke] If specified, do not check style.textStroke.\n * @param {string} [lineWidth] If specified, do not check style.textStroke.\n * @param {number} style\n */\n\n\nfunction getStroke(stroke, lineWidth) {\n  return stroke == null || lineWidth <= 0 || stroke === 'transparent' || stroke === 'none' ? null // TODO pattern and gradient?\n  : stroke.image || stroke.colorStops ? '#000' : stroke;\n}\nfunction getFill(fill) {\n  return fill == null || fill === 'none' ? null // TODO pattern and gradient?\n  : fill.image || fill.colorStops ? '#000' : fill;\n}\n\nfunction parsePercent(value, maxValue) {\n  if (typeof value === 'string') {\n    if (value.lastIndexOf('%') >= 0) {\n      return parseFloat(value) / 100 * maxValue;\n    }\n\n    return parseFloat(value);\n  }\n\n  return value;\n}\n\nfunction getTextXForPadding(x, textAlign, textPadding) {\n  return textAlign === 'right' ? x - textPadding[1] : textAlign === 'center' ? x + textPadding[3] / 2 - textPadding[1] / 2 : x + textPadding[3];\n}\n/**\n * @param {string} text\n * @param {module:zrender/Style} style\n * @return {boolean}\n */\n\n\nfunction needDrawText(text, style) {\n  return text != null && (text || style.textBackgroundColor || style.textBorderWidth && style.textBorderColor || style.textPadding);\n}\n\n/**\n * Mixin for drawing text in a element bounding rect\n * @module zrender/mixin/RectText\n */\nvar tmpRect$1 = new BoundingRect();\n\nvar RectText = function () {};\n\nRectText.prototype = {\n  constructor: RectText,\n\n  /**\n   * Draw text in a rect with specified position.\n   * @param  {CanvasRenderingContext2D} ctx\n   * @param  {Object} rect Displayable rect\n   */\n  drawRectText: function (ctx, rect) {\n    var style = this.style;\n    rect = style.textRect || rect; // Optimize, avoid normalize every time.\n\n    this.__dirty && normalizeTextStyle(style, true);\n    var text = style.text; // Convert to string\n\n    text != null && (text += '');\n\n    if (!needDrawText(text, style)) {\n      return;\n    } // FIXME\n\n\n    ctx.save(); // Transform rect to view space\n\n    var transform = this.transform;\n\n    if (!style.transformText) {\n      if (transform) {\n        tmpRect$1.copy(rect);\n        tmpRect$1.applyTransform(transform);\n        rect = tmpRect$1;\n      }\n    } else {\n      this.setTransform(ctx);\n    } // transformText and textRotation can not be used at the same time.\n\n\n    renderText(this, ctx, text, style, rect);\n    ctx.restore();\n  }\n};\n\n/**\n * \n * Base class of all displayable graphic objects\n * @module zrender/graphic/Displayable\n */\n/**\n * @alias module:zrender/graphic/Displayable\n * @extends module:zrender/Element\n * @extends module:zrender/graphic/mixin/RectText\n */\n\nfunction Displayable(opts) {\n  opts = opts || {};\n  Element.call(this, opts); // Extend properties\n\n  for (var name in opts) {\n    if (opts.hasOwnProperty(name) && name !== 'style') {\n      this[name] = opts[name];\n    }\n  }\n  /**\n   * @type {module:zrender/graphic/Style}\n   */\n\n\n  this.style = new Style(opts.style, this);\n  this._rect = null; // Shapes for cascade clipping.\n\n  this.__clipPaths = []; // FIXME Stateful must be mixined after style is setted\n  // Stateful.call(this, opts);\n}\n\nDisplayable.prototype = {\n  constructor: Displayable,\n  type: 'displayable',\n\n  /**\n   * Displayable Painter \n   * Dirty flag. From which painter will determine if this displayable object needs brush\n   * @name module:zrender/graphic/Displayable#__dirty\n   * @type {boolean}\n   */\n  __dirty: true,\n\n  /**\n   * true\n   * If ignore drawing of the displayable object. Mouse event will still be triggered\n   * @name module:/zrender/graphic/Displayable#invisible\n   * @type {boolean}\n   * @default false\n   */\n  invisible: false,\n\n  /**\n   * @name module:/zrender/graphic/Displayable#z\n   * @type {number}\n   * @default 0\n   */\n  z: 0,\n\n  /**\n   * @name module:/zrender/graphic/Displayable#z\n   * @type {number}\n   * @default 0\n   */\n  z2: 0,\n\n  /**\n   * zlevelcanvas\n   * @name module:/zrender/graphic/Displayable#zlevel\n   * @type {number}\n   * @default 0\n   */\n  zlevel: 0,\n\n  /**\n   * \n   * @name module:/zrender/graphic/Displayable#draggable\n   * @type {boolean}\n   * @default false\n   */\n  draggable: false,\n\n  /**\n   * \n   * @name module:/zrender/graphic/Displayable#draggable\n   * @type {boolean}\n   * @default false\n   */\n  dragging: false,\n\n  /**\n   * \n   * @name module:/zrender/graphic/Displayable#silent\n   * @type {boolean}\n   * @default false\n   */\n  silent: false,\n\n  /**\n   * If enable culling\n   * @type {boolean}\n   * @default false\n   */\n  culling: false,\n\n  /**\n   * Mouse cursor when hovered\n   * @name module:/zrender/graphic/Displayable#cursor\n   * @type {string}\n   */\n  cursor: 'pointer',\n\n  /**\n   * If hover area is bounding rect\n   * @name module:/zrender/graphic/Displayable#rectHover\n   * @type {string}\n   */\n  rectHover: false,\n\n  /**\n   * Render the element progressively when the value >= 0,\n   * usefull for large data.\n   * @type {boolean}\n   */\n  progressive: false,\n\n  /**\n   * @type {boolean}\n   */\n  incremental: false,\n  // inplace is used with incremental\n  inplace: false,\n  beforeBrush: function (ctx) {},\n  afterBrush: function (ctx) {},\n\n  /**\n   * \n   * @param {CanvasRenderingContext2D} ctx\n   */\n  // Interface\n  brush: function (ctx, prevEl) {},\n\n  /**\n   * \n   * @return {module:zrender/core/BoundingRect}\n   */\n  // Interface\n  getBoundingRect: function () {},\n\n  /**\n   *  x, y \n   * If displayable element contain coord x, y\n   * @param  {number} x\n   * @param  {number} y\n   * @return {boolean}\n   */\n  contain: function (x, y) {\n    return this.rectContain(x, y);\n  },\n\n  /**\n   * @param  {Function} cb\n   * @param  {}   context\n   */\n  traverse: function (cb, context) {\n    cb.call(context, this);\n  },\n\n  /**\n   *  x, y \n   * If bounding rect of element contain coord x, y\n   * @param  {number} x\n   * @param  {number} y\n   * @return {boolean}\n   */\n  rectContain: function (x, y) {\n    var coord = this.transformCoordToLocal(x, y);\n    var rect = this.getBoundingRect();\n    return rect.contain(coord[0], coord[1]);\n  },\n\n  /**\n   * \n   * Mark displayable element dirty and refresh next frame\n   */\n  dirty: function () {\n    this.__dirty = true;\n    this._rect = null;\n    this.__zr && this.__zr.refresh();\n  },\n\n  /**\n   * \n   * If displayable object binded any event\n   * @return {boolean}\n   */\n  // TODO,  bind \n  // isSilent: function () {\n  //     return !(\n  //         this.hoverable || this.draggable\n  //         || this.onmousemove || this.onmouseover || this.onmouseout\n  //         || this.onmousedown || this.onmouseup || this.onclick\n  //         || this.ondragenter || this.ondragover || this.ondragleave\n  //         || this.ondrop\n  //     );\n  // },\n\n  /**\n   * Alias for animate('style')\n   * @param {boolean} loop\n   */\n  animateStyle: function (loop) {\n    return this.animate('style', loop);\n  },\n  attrKV: function (key, value) {\n    if (key !== 'style') {\n      Element.prototype.attrKV.call(this, key, value);\n    } else {\n      this.style.set(value);\n    }\n  },\n\n  /**\n   * @param {Object|string} key\n   * @param {*} value\n   */\n  setStyle: function (key, value) {\n    this.style.set(key, value);\n    this.dirty(false);\n    return this;\n  },\n\n  /**\n   * Use given style object\n   * @param  {Object} obj\n   */\n  useStyle: function (obj) {\n    this.style = new Style(obj, this);\n    this.dirty(false);\n    return this;\n  }\n};\ninherits(Displayable, Element);\nmixin(Displayable, RectText); // zrUtil.mixin(Displayable, Stateful);\n\n/**\n * @alias zrender/graphic/Image\n * @extends module:zrender/graphic/Displayable\n * @constructor\n * @param {Object} opts\n */\n\nfunction ZImage(opts) {\n  Displayable.call(this, opts);\n}\n\nZImage.prototype = {\n  constructor: ZImage,\n  type: 'image',\n  brush: function (ctx, prevEl) {\n    var style = this.style;\n    var src = style.image; // Must bind each time\n\n    style.bind(ctx, this, prevEl);\n    var image = this._image = createOrUpdateImage(src, this._image, this, this.onload);\n\n    if (!image || !isImageReady(image)) {\n      return;\n    } // \n    // if (image.nodeName.toUpperCase() == 'IMG') {\n    //     if (!image.complete) {\n    //         return;\n    //     }\n    // }\n    // Else is canvas\n\n\n    var x = style.x || 0;\n    var y = style.y || 0;\n    var width = style.width;\n    var height = style.height;\n    var aspect = image.width / image.height;\n\n    if (width == null && height != null) {\n      // Keep image/height ratio\n      width = height * aspect;\n    } else if (height == null && width != null) {\n      height = width / aspect;\n    } else if (width == null && height == null) {\n      width = image.width;\n      height = image.height;\n    } // transform\n\n\n    this.setTransform(ctx);\n\n    if (style.sWidth && style.sHeight) {\n      var sx = style.sx || 0;\n      var sy = style.sy || 0;\n      ctx.drawImage(image, sx, sy, style.sWidth, style.sHeight, x, y, width, height);\n    } else if (style.sx && style.sy) {\n      var sx = style.sx;\n      var sy = style.sy;\n      var sWidth = width - sx;\n      var sHeight = height - sy;\n      ctx.drawImage(image, sx, sy, sWidth, sHeight, x, y, width, height);\n    } else {\n      ctx.drawImage(image, x, y, width, height);\n    } // Draw rect text\n\n\n    if (style.text != null) {\n      // Only restore transform when needs draw text.\n      this.restoreTransform(ctx);\n      this.drawRectText(ctx, this.getBoundingRect());\n    }\n  },\n  getBoundingRect: function () {\n    var style = this.style;\n\n    if (!this._rect) {\n      this._rect = new BoundingRect(style.x || 0, style.y || 0, style.width || 0, style.height || 0);\n    }\n\n    return this._rect;\n  }\n};\ninherits(ZImage, Displayable);\n\nvar HOVER_LAYER_ZLEVEL = 1e5;\nvar CANVAS_ZLEVEL = 314159;\nvar EL_AFTER_INCREMENTAL_INC = 0.01;\nvar INCREMENTAL_INC = 0.001;\n\nfunction parseInt10(val) {\n  return parseInt(val, 10);\n}\n\nfunction isLayerValid(layer) {\n  if (!layer) {\n    return false;\n  }\n\n  if (layer.__builtin__) {\n    return true;\n  }\n\n  if (typeof layer.resize !== 'function' || typeof layer.refresh !== 'function') {\n    return false;\n  }\n\n  return true;\n}\n\nvar tmpRect = new BoundingRect(0, 0, 0, 0);\nvar viewRect = new BoundingRect(0, 0, 0, 0);\n\nfunction isDisplayableCulled(el, width, height) {\n  tmpRect.copy(el.getBoundingRect());\n\n  if (el.transform) {\n    tmpRect.applyTransform(el.transform);\n  }\n\n  viewRect.width = width;\n  viewRect.height = height;\n  return !tmpRect.intersect(viewRect);\n}\n\nfunction isClipPathChanged(clipPaths, prevClipPaths) {\n  if (clipPaths == prevClipPaths) {\n    // Can both be null or undefined\n    return false;\n  }\n\n  if (!clipPaths || !prevClipPaths || clipPaths.length !== prevClipPaths.length) {\n    return true;\n  }\n\n  for (var i = 0; i < clipPaths.length; i++) {\n    if (clipPaths[i] !== prevClipPaths[i]) {\n      return true;\n    }\n  }\n}\n\nfunction doClip(clipPaths, ctx) {\n  for (var i = 0; i < clipPaths.length; i++) {\n    var clipPath = clipPaths[i];\n    clipPath.setTransform(ctx);\n    ctx.beginPath();\n    clipPath.buildPath(ctx, clipPath.shape);\n    ctx.clip(); // Transform back\n\n    clipPath.restoreTransform(ctx);\n  }\n}\n\nfunction createRoot(width, height) {\n  var domRoot = document.createElement('div'); // domRoot.onselectstart = returnFalse; // \n\n  domRoot.style.cssText = ['position:relative', 'overflow:hidden', 'width:' + width + 'px', 'height:' + height + 'px', 'padding:0', 'margin:0', 'border-width:0'].join(';') + ';';\n  return domRoot;\n}\n/**\n * @alias module:zrender/Painter\n * @constructor\n * @param {HTMLElement} root \n * @param {module:zrender/Storage} storage\n * @param {Object} opts\n */\n\n\nvar Painter = function (root, storage, opts) {\n  this.type = 'canvas'; // In node environment using node-canvas\n\n  var singleCanvas = !root.nodeName // In node ?\n  || root.nodeName.toUpperCase() === 'CANVAS';\n  this._opts = opts = extend({}, opts || {});\n  /**\n   * @type {number}\n   */\n\n  this.dpr = opts.devicePixelRatio || devicePixelRatio;\n  /**\n   * @type {boolean}\n   * @private\n   */\n\n  this._singleCanvas = singleCanvas;\n  /**\n   * \n   * @type {HTMLElement}\n   */\n\n  this.root = root;\n  var rootStyle = root.style;\n\n  if (rootStyle) {\n    rootStyle['-webkit-tap-highlight-color'] = 'transparent';\n    rootStyle['-webkit-user-select'] = rootStyle['user-select'] = rootStyle['-webkit-touch-callout'] = 'none';\n    root.innerHTML = '';\n  }\n  /**\n   * @type {module:zrender/Storage}\n   */\n\n\n  this.storage = storage;\n  /**\n   * @type {Array.<number>}\n   * @private\n   */\n\n  var zlevelList = this._zlevelList = [];\n  /**\n   * @type {Object.<string, module:zrender/Layer>}\n   * @private\n   */\n\n  var layers = this._layers = {};\n  /**\n   * @type {Object.<string, Object>}\n   * @private\n   */\n\n  this._layerConfig = {};\n  /**\n   * zrender will do compositing when root is a canvas and have multiple zlevels.\n   */\n\n  this._needsManuallyCompositing = false;\n\n  if (!singleCanvas) {\n    this._width = this._getSize(0);\n    this._height = this._getSize(1);\n    var domRoot = this._domRoot = createRoot(this._width, this._height);\n    root.appendChild(domRoot);\n  } else {\n    var width = root.width;\n    var height = root.height;\n\n    if (opts.width != null) {\n      width = opts.width;\n    }\n\n    if (opts.height != null) {\n      height = opts.height;\n    }\n\n    this.dpr = opts.devicePixelRatio || 1; // Use canvas width and height directly\n\n    root.width = width * this.dpr;\n    root.height = height * this.dpr;\n    this._width = width;\n    this._height = height; // Create layer if only one given canvas\n    // Device can be specified to create a high dpi image.\n\n    var mainLayer = new Layer(root, this, this.dpr);\n    mainLayer.__builtin__ = true;\n    mainLayer.initContext(); // FIXME Use canvas width and height\n    // mainLayer.resize(width, height);\n\n    layers[CANVAS_ZLEVEL] = mainLayer;\n    mainLayer.zlevel = CANVAS_ZLEVEL; // Not use common zlevel.\n\n    zlevelList.push(CANVAS_ZLEVEL);\n    this._domRoot = root;\n  }\n  /**\n   * @type {module:zrender/Layer}\n   * @private\n   */\n\n\n  this._hoverlayer = null;\n  this._hoverElements = [];\n};\n\nPainter.prototype = {\n  constructor: Painter,\n  getType: function () {\n    return 'canvas';\n  },\n\n  /**\n   * If painter use a single canvas\n   * @return {boolean}\n   */\n  isSingleCanvas: function () {\n    return this._singleCanvas;\n  },\n\n  /**\n   * @return {HTMLDivElement}\n   */\n  getViewportRoot: function () {\n    return this._domRoot;\n  },\n  getViewportRootOffset: function () {\n    var viewportRoot = this.getViewportRoot();\n\n    if (viewportRoot) {\n      return {\n        offsetLeft: viewportRoot.offsetLeft || 0,\n        offsetTop: viewportRoot.offsetTop || 0\n      };\n    }\n  },\n\n  /**\n   * \n   * @param {boolean} [paintAll=false] displayable\n   */\n  refresh: function (paintAll) {\n    var list = this.storage.getDisplayList(true);\n    var zlevelList = this._zlevelList;\n    this._redrawId = Math.random();\n\n    this._paintList(list, paintAll, this._redrawId); // Paint custum layers\n\n\n    for (var i = 0; i < zlevelList.length; i++) {\n      var z = zlevelList[i];\n      var layer = this._layers[z];\n\n      if (!layer.__builtin__ && layer.refresh) {\n        var clearColor = i === 0 ? this._backgroundColor : null;\n        layer.refresh(clearColor);\n      }\n    }\n\n    this.refreshHover();\n    return this;\n  },\n  addHover: function (el, hoverStyle) {\n    if (el.__hoverMir) {\n      return;\n    }\n\n    var elMirror = new el.constructor({\n      style: el.style,\n      shape: el.shape\n    });\n    elMirror.__from = el;\n    el.__hoverMir = elMirror;\n    elMirror.setStyle(hoverStyle);\n\n    this._hoverElements.push(elMirror);\n  },\n  removeHover: function (el) {\n    var elMirror = el.__hoverMir;\n    var hoverElements = this._hoverElements;\n    var idx = indexOf(hoverElements, elMirror);\n\n    if (idx >= 0) {\n      hoverElements.splice(idx, 1);\n    }\n\n    el.__hoverMir = null;\n  },\n  clearHover: function (el) {\n    var hoverElements = this._hoverElements;\n\n    for (var i = 0; i < hoverElements.length; i++) {\n      var from = hoverElements[i].__from;\n\n      if (from) {\n        from.__hoverMir = null;\n      }\n    }\n\n    hoverElements.length = 0;\n  },\n  refreshHover: function () {\n    var hoverElements = this._hoverElements;\n    var len = hoverElements.length;\n    var hoverLayer = this._hoverlayer;\n    hoverLayer && hoverLayer.clear();\n\n    if (!len) {\n      return;\n    }\n\n    sort(hoverElements, this.storage.displayableSortFunc); // Use a extream large zlevel\n    // FIXME?\n\n    if (!hoverLayer) {\n      hoverLayer = this._hoverlayer = this.getLayer(HOVER_LAYER_ZLEVEL);\n    }\n\n    var scope = {};\n    hoverLayer.ctx.save();\n\n    for (var i = 0; i < len;) {\n      var el = hoverElements[i];\n      var originalEl = el.__from; // Original el is removed\n      // PENDING\n\n      if (!(originalEl && originalEl.__zr)) {\n        hoverElements.splice(i, 1);\n        originalEl.__hoverMir = null;\n        len--;\n        continue;\n      }\n\n      i++; // Use transform\n      // FIXME style and shape ?\n\n      if (!originalEl.invisible) {\n        el.transform = originalEl.transform;\n        el.invTransform = originalEl.invTransform;\n        el.__clipPaths = originalEl.__clipPaths; // el.\n\n        this._doPaintEl(el, hoverLayer, true, scope);\n      }\n    }\n\n    hoverLayer.ctx.restore();\n  },\n  getHoverLayer: function () {\n    return this.getLayer(HOVER_LAYER_ZLEVEL);\n  },\n  _paintList: function (list, paintAll, redrawId) {\n    if (this._redrawId !== redrawId) {\n      return;\n    }\n\n    paintAll = paintAll || false;\n\n    this._updateLayerStatus(list);\n\n    var finished = this._doPaintList(list, paintAll);\n\n    if (this._needsManuallyCompositing) {\n      this._compositeManually();\n    }\n\n    if (!finished) {\n      var self = this;\n      requestAnimationFrame(function () {\n        self._paintList(list, paintAll, redrawId);\n      });\n    }\n  },\n  _compositeManually: function () {\n    var ctx = this.getLayer(CANVAS_ZLEVEL).ctx;\n    var width = this._domRoot.width;\n    var height = this._domRoot.height;\n    ctx.clearRect(0, 0, width, height); // PENDING, If only builtin layer?\n\n    this.eachBuiltinLayer(function (layer) {\n      if (layer.virtual) {\n        ctx.drawImage(layer.dom, 0, 0, width, height);\n      }\n    });\n  },\n  _doPaintList: function (list, paintAll) {\n    var layerList = [];\n\n    for (var zi = 0; zi < this._zlevelList.length; zi++) {\n      var zlevel = this._zlevelList[zi];\n      var layer = this._layers[zlevel];\n\n      if (layer.__builtin__ && layer !== this._hoverlayer && (layer.__dirty || paintAll)) {\n        layerList.push(layer);\n      }\n    }\n\n    var finished = true;\n\n    for (var k = 0; k < layerList.length; k++) {\n      var layer = layerList[k];\n      var ctx = layer.ctx;\n      var scope = {};\n      ctx.save();\n      var start = paintAll ? layer.__startIndex : layer.__drawIndex;\n      var useTimer = !paintAll && layer.incremental && Date.now;\n      var startTime = useTimer && Date.now();\n      var clearColor = layer.zlevel === this._zlevelList[0] ? this._backgroundColor : null; // All elements in this layer are cleared.\n\n      if (layer.__startIndex === layer.__endIndex) {\n        layer.clear(false, clearColor);\n      } else if (start === layer.__startIndex) {\n        var firstEl = list[start];\n\n        if (!firstEl.incremental || !firstEl.notClear || paintAll) {\n          layer.clear(false, clearColor);\n        }\n      }\n\n      if (start === -1) {\n        console.error('For some unknown reason. drawIndex is -1');\n        start = layer.__startIndex;\n      }\n\n      for (var i = start; i < layer.__endIndex; i++) {\n        var el = list[i];\n\n        this._doPaintEl(el, layer, paintAll, scope);\n\n        el.__dirty = false;\n\n        if (useTimer) {\n          // Date.now can be executed in 13,025,305 ops/second.\n          var dTime = Date.now() - startTime; // Give 15 millisecond to draw.\n          // The rest elements will be drawn in the next frame.\n\n          if (dTime > 15) {\n            break;\n          }\n        }\n      }\n\n      layer.__drawIndex = i;\n\n      if (layer.__drawIndex < layer.__endIndex) {\n        finished = false;\n      }\n\n      if (scope.prevElClipPaths) {\n        // Needs restore the state. If last drawn element is in the clipping area.\n        ctx.restore();\n      }\n\n      ctx.restore();\n    }\n\n    if (env$1.wxa) {\n      // Flush for weixin application\n      each$1(this._layers, function (layer) {\n        if (layer && layer.ctx && layer.ctx.draw) {\n          layer.ctx.draw();\n        }\n      });\n    }\n\n    return finished;\n  },\n  _doPaintEl: function (el, currentLayer, forcePaint, scope) {\n    var ctx = currentLayer.ctx;\n    var m = el.transform;\n\n    if ((currentLayer.__dirty || forcePaint) && // Ignore invisible element\n    !el.invisible // Ignore transparent element\n    && el.style.opacity !== 0 // Ignore scale 0 element, in some environment like node-canvas\n    // Draw a scale 0 element can cause all following draw wrong\n    // And setTransform with scale 0 will cause set back transform failed.\n    && !(m && !m[0] && !m[3]) // Ignore culled element\n    && !(el.culling && isDisplayableCulled(el, this._width, this._height))) {\n      var clipPaths = el.__clipPaths; // Optimize when clipping on group with several elements\n\n      if (!scope.prevElClipPaths || isClipPathChanged(clipPaths, scope.prevElClipPaths)) {\n        // If has previous clipping state, restore from it\n        if (scope.prevElClipPaths) {\n          currentLayer.ctx.restore();\n          scope.prevElClipPaths = null; // Reset prevEl since context has been restored\n\n          scope.prevEl = null;\n        } // New clipping state\n\n\n        if (clipPaths) {\n          ctx.save();\n          doClip(clipPaths, ctx);\n          scope.prevElClipPaths = clipPaths;\n        }\n      }\n\n      el.beforeBrush && el.beforeBrush(ctx);\n      el.brush(ctx, scope.prevEl || null);\n      scope.prevEl = el;\n      el.afterBrush && el.afterBrush(ctx);\n    }\n  },\n\n  /**\n   *  zlevel \n   * @param {number} zlevel\n   * @param {boolean} virtual Virtual layer will not be inserted into dom.\n   * @return {module:zrender/Layer}\n   */\n  getLayer: function (zlevel, virtual) {\n    if (this._singleCanvas && !this._needsManuallyCompositing) {\n      zlevel = CANVAS_ZLEVEL;\n    }\n\n    var layer = this._layers[zlevel];\n\n    if (!layer) {\n      // Create a new layer\n      layer = new Layer('zr_' + zlevel, this, this.dpr);\n      layer.zlevel = zlevel;\n      layer.__builtin__ = true;\n\n      if (this._layerConfig[zlevel]) {\n        merge(layer, this._layerConfig[zlevel], true);\n      }\n\n      if (virtual) {\n        layer.virtual = virtual;\n      }\n\n      this.insertLayer(zlevel, layer); // Context is created after dom inserted to document\n      // Or excanvas will get 0px clientWidth and clientHeight\n\n      layer.initContext();\n    }\n\n    return layer;\n  },\n  insertLayer: function (zlevel, layer) {\n    var layersMap = this._layers;\n    var zlevelList = this._zlevelList;\n    var len = zlevelList.length;\n    var prevLayer = null;\n    var i = -1;\n    var domRoot = this._domRoot;\n\n    if (layersMap[zlevel]) {\n      log$1('ZLevel ' + zlevel + ' has been used already');\n      return;\n    } // Check if is a valid layer\n\n\n    if (!isLayerValid(layer)) {\n      log$1('Layer of zlevel ' + zlevel + ' is not valid');\n      return;\n    }\n\n    if (len > 0 && zlevel > zlevelList[0]) {\n      for (i = 0; i < len - 1; i++) {\n        if (zlevelList[i] < zlevel && zlevelList[i + 1] > zlevel) {\n          break;\n        }\n      }\n\n      prevLayer = layersMap[zlevelList[i]];\n    }\n\n    zlevelList.splice(i + 1, 0, zlevel);\n    layersMap[zlevel] = layer; // Vitual layer will not directly show on the screen.\n    // (It can be a WebGL layer and assigned to a ZImage element)\n    // But it still under management of zrender.\n\n    if (!layer.virtual) {\n      if (prevLayer) {\n        var prevDom = prevLayer.dom;\n\n        if (prevDom.nextSibling) {\n          domRoot.insertBefore(layer.dom, prevDom.nextSibling);\n        } else {\n          domRoot.appendChild(layer.dom);\n        }\n      } else {\n        if (domRoot.firstChild) {\n          domRoot.insertBefore(layer.dom, domRoot.firstChild);\n        } else {\n          domRoot.appendChild(layer.dom);\n        }\n      }\n    }\n  },\n  // Iterate each layer\n  eachLayer: function (cb, context) {\n    var zlevelList = this._zlevelList;\n    var z;\n    var i;\n\n    for (i = 0; i < zlevelList.length; i++) {\n      z = zlevelList[i];\n      cb.call(context, this._layers[z], z);\n    }\n  },\n  // Iterate each buildin layer\n  eachBuiltinLayer: function (cb, context) {\n    var zlevelList = this._zlevelList;\n    var layer;\n    var z;\n    var i;\n\n    for (i = 0; i < zlevelList.length; i++) {\n      z = zlevelList[i];\n      layer = this._layers[z];\n\n      if (layer.__builtin__) {\n        cb.call(context, layer, z);\n      }\n    }\n  },\n  // Iterate each other layer except buildin layer\n  eachOtherLayer: function (cb, context) {\n    var zlevelList = this._zlevelList;\n    var layer;\n    var z;\n    var i;\n\n    for (i = 0; i < zlevelList.length; i++) {\n      z = zlevelList[i];\n      layer = this._layers[z];\n\n      if (!layer.__builtin__) {\n        cb.call(context, layer, z);\n      }\n    }\n  },\n\n  /**\n   * \n   * @param {Array.<module:zrender/Layer>} [prevLayer]\n   */\n  getLayers: function () {\n    return this._layers;\n  },\n  _updateLayerStatus: function (list) {\n    this.eachBuiltinLayer(function (layer, z) {\n      layer.__dirty = layer.__used = false;\n    });\n\n    function updatePrevLayer(idx) {\n      if (prevLayer) {\n        if (prevLayer.__endIndex !== idx) {\n          prevLayer.__dirty = true;\n        }\n\n        prevLayer.__endIndex = idx;\n      }\n    }\n\n    if (this._singleCanvas) {\n      for (var i = 1; i < list.length; i++) {\n        var el = list[i];\n\n        if (el.zlevel !== list[i - 1].zlevel || el.incremental) {\n          this._needsManuallyCompositing = true;\n          break;\n        }\n      }\n    }\n\n    var prevLayer = null;\n    var incrementalLayerCount = 0;\n\n    for (var i = 0; i < list.length; i++) {\n      var el = list[i];\n      var zlevel = el.zlevel;\n      var layer; // PENDING If change one incremental element style ?\n      // TODO Where there are non-incremental elements between incremental elements.\n\n      if (el.incremental) {\n        layer = this.getLayer(zlevel + INCREMENTAL_INC, this._needsManuallyCompositing);\n        layer.incremental = true;\n        incrementalLayerCount = 1;\n      } else {\n        layer = this.getLayer(zlevel + (incrementalLayerCount > 0 ? EL_AFTER_INCREMENTAL_INC : 0), this._needsManuallyCompositing);\n      }\n\n      if (!layer.__builtin__) {\n        log$1('ZLevel ' + zlevel + ' has been used by unkown layer ' + layer.id);\n      }\n\n      if (layer !== prevLayer) {\n        layer.__used = true;\n\n        if (layer.__startIndex !== i) {\n          layer.__dirty = true;\n        }\n\n        layer.__startIndex = i;\n\n        if (!layer.incremental) {\n          layer.__drawIndex = i;\n        } else {\n          // Mark layer draw index needs to update.\n          layer.__drawIndex = -1;\n        }\n\n        updatePrevLayer(i);\n        prevLayer = layer;\n      }\n\n      if (el.__dirty) {\n        layer.__dirty = true;\n\n        if (layer.incremental && layer.__drawIndex < 0) {\n          // Start draw from the first dirty element.\n          layer.__drawIndex = i;\n        }\n      }\n    }\n\n    updatePrevLayer(i);\n    this.eachBuiltinLayer(function (layer, z) {\n      // Used in last frame but not in this frame. Needs clear\n      if (!layer.__used && layer.getElementCount() > 0) {\n        layer.__dirty = true;\n        layer.__startIndex = layer.__endIndex = layer.__drawIndex = 0;\n      } // For incremental layer. In case start index changed and no elements are dirty.\n\n\n      if (layer.__dirty && layer.__drawIndex < 0) {\n        layer.__drawIndex = layer.__startIndex;\n      }\n    });\n  },\n\n  /**\n   * hover\n   */\n  clear: function () {\n    this.eachBuiltinLayer(this._clearLayer);\n    return this;\n  },\n  _clearLayer: function (layer) {\n    layer.clear();\n  },\n  setBackgroundColor: function (backgroundColor) {\n    this._backgroundColor = backgroundColor;\n  },\n\n  /**\n   * zlevel\n   *\n   * @param {string} zlevel\n   * @param {Object} config \n   * @param {string} [config.clearColor=0] \n   * @param {string} [config.motionBlur=false] \n   * @param {number} [config.lastFrameAlpha=0.7]\n   *                 alpha\n   */\n  configLayer: function (zlevel, config) {\n    if (config) {\n      var layerConfig = this._layerConfig;\n\n      if (!layerConfig[zlevel]) {\n        layerConfig[zlevel] = config;\n      } else {\n        merge(layerConfig[zlevel], config, true);\n      }\n\n      for (var i = 0; i < this._zlevelList.length; i++) {\n        var _zlevel = this._zlevelList[i];\n\n        if (_zlevel === zlevel || _zlevel === zlevel + EL_AFTER_INCREMENTAL_INC) {\n          var layer = this._layers[_zlevel];\n          merge(layer, layerConfig[zlevel], true);\n        }\n      }\n    }\n  },\n\n  /**\n   * \n   * @param {number} zlevel zlevel\n   */\n  delLayer: function (zlevel) {\n    var layers = this._layers;\n    var zlevelList = this._zlevelList;\n    var layer = layers[zlevel];\n\n    if (!layer) {\n      return;\n    }\n\n    layer.dom.parentNode.removeChild(layer.dom);\n    delete layers[zlevel];\n    zlevelList.splice(indexOf(zlevelList, zlevel), 1);\n  },\n\n  /**\n   * \n   */\n  resize: function (width, height) {\n    if (!this._domRoot.style) {\n      // Maybe in node or worker\n      if (width == null || height == null) {\n        return;\n      }\n\n      this._width = width;\n      this._height = height;\n      this.getLayer(CANVAS_ZLEVEL).resize(width, height);\n    } else {\n      var domRoot = this._domRoot; // FIXME Why ?\n\n      domRoot.style.display = 'none'; // Save input w/h\n\n      var opts = this._opts;\n      width != null && (opts.width = width);\n      height != null && (opts.height = height);\n      width = this._getSize(0);\n      height = this._getSize(1);\n      domRoot.style.display = ''; // resize\n\n      if (this._width != width || height != this._height) {\n        domRoot.style.width = width + 'px';\n        domRoot.style.height = height + 'px';\n\n        for (var id in this._layers) {\n          if (this._layers.hasOwnProperty(id)) {\n            this._layers[id].resize(width, height);\n          }\n        }\n\n        each$1(this._progressiveLayers, function (layer) {\n          layer.resize(width, height);\n        });\n        this.refresh(true);\n      }\n\n      this._width = width;\n      this._height = height;\n    }\n\n    return this;\n  },\n\n  /**\n   * \n   * @param {number} zlevel\n   */\n  clearLayer: function (zlevel) {\n    var layer = this._layers[zlevel];\n\n    if (layer) {\n      layer.clear();\n    }\n  },\n\n  /**\n   * \n   */\n  dispose: function () {\n    this.root.innerHTML = '';\n    this.root = this.storage = this._domRoot = this._layers = null;\n  },\n\n  /**\n   * Get canvas which has all thing rendered\n   * @param {Object} opts\n   * @param {string} [opts.backgroundColor]\n   * @param {number} [opts.pixelRatio]\n   */\n  getRenderedCanvas: function (opts) {\n    opts = opts || {};\n\n    if (this._singleCanvas && !this._compositeManually) {\n      return this._layers[CANVAS_ZLEVEL].dom;\n    }\n\n    var imageLayer = new Layer('image', this, opts.pixelRatio || this.dpr);\n    imageLayer.initContext();\n    imageLayer.clear(false, opts.backgroundColor || this._backgroundColor);\n\n    if (opts.pixelRatio <= this.dpr) {\n      this.refresh();\n      var width = imageLayer.dom.width;\n      var height = imageLayer.dom.height;\n      var ctx = imageLayer.ctx;\n      this.eachLayer(function (layer) {\n        if (layer.__builtin__) {\n          ctx.drawImage(layer.dom, 0, 0, width, height);\n        } else if (layer.renderToCanvas) {\n          imageLayer.ctx.save();\n          layer.renderToCanvas(imageLayer.ctx);\n          imageLayer.ctx.restore();\n        }\n      });\n    } else {\n      // PENDING, echarts-gl and incremental rendering.\n      var scope = {};\n      var displayList = this.storage.getDisplayList(true);\n\n      for (var i = 0; i < displayList.length; i++) {\n        var el = displayList[i];\n\n        this._doPaintEl(el, imageLayer, true, scope);\n      }\n    }\n\n    return imageLayer.dom;\n  },\n\n  /**\n   * \n   */\n  getWidth: function () {\n    return this._width;\n  },\n\n  /**\n   * \n   */\n  getHeight: function () {\n    return this._height;\n  },\n  _getSize: function (whIdx) {\n    var opts = this._opts;\n    var wh = ['width', 'height'][whIdx];\n    var cwh = ['clientWidth', 'clientHeight'][whIdx];\n    var plt = ['paddingLeft', 'paddingTop'][whIdx];\n    var prb = ['paddingRight', 'paddingBottom'][whIdx];\n\n    if (opts[wh] != null && opts[wh] !== 'auto') {\n      return parseFloat(opts[wh]);\n    }\n\n    var root = this.root; // IE8 does not support getComputedStyle, but it use VML.\n\n    var stl = document.defaultView.getComputedStyle(root);\n    return (root[cwh] || parseInt10(stl[wh]) || parseInt10(root.style[wh])) - (parseInt10(stl[plt]) || 0) - (parseInt10(stl[prb]) || 0) | 0;\n  },\n  pathToImage: function (path, dpr) {\n    dpr = dpr || this.dpr;\n    var canvas = document.createElement('canvas');\n    var ctx = canvas.getContext('2d');\n    var rect = path.getBoundingRect();\n    var style = path.style;\n    var shadowBlurSize = style.shadowBlur * dpr;\n    var shadowOffsetX = style.shadowOffsetX * dpr;\n    var shadowOffsetY = style.shadowOffsetY * dpr;\n    var lineWidth = style.hasStroke() ? style.lineWidth : 0;\n    var leftMargin = Math.max(lineWidth / 2, -shadowOffsetX + shadowBlurSize);\n    var rightMargin = Math.max(lineWidth / 2, shadowOffsetX + shadowBlurSize);\n    var topMargin = Math.max(lineWidth / 2, -shadowOffsetY + shadowBlurSize);\n    var bottomMargin = Math.max(lineWidth / 2, shadowOffsetY + shadowBlurSize);\n    var width = rect.width + leftMargin + rightMargin;\n    var height = rect.height + topMargin + bottomMargin;\n    canvas.width = width * dpr;\n    canvas.height = height * dpr;\n    ctx.scale(dpr, dpr);\n    ctx.clearRect(0, 0, width, height);\n    ctx.dpr = dpr;\n    var pathTransform = {\n      position: path.position,\n      rotation: path.rotation,\n      scale: path.scale\n    };\n    path.position = [leftMargin - rect.x, topMargin - rect.y];\n    path.rotation = 0;\n    path.scale = [1, 1];\n    path.updateTransform();\n\n    if (path) {\n      path.brush(ctx);\n    }\n\n    var ImageShape = ZImage;\n    var imgShape = new ImageShape({\n      style: {\n        x: 0,\n        y: 0,\n        image: canvas\n      }\n    });\n\n    if (pathTransform.position != null) {\n      imgShape.position = path.position = pathTransform.position;\n    }\n\n    if (pathTransform.rotation != null) {\n      imgShape.rotation = path.rotation = pathTransform.rotation;\n    }\n\n    if (pathTransform.scale != null) {\n      imgShape.scale = path.scale = pathTransform.scale;\n    }\n\n    return imgShape;\n  }\n};\n\n/**\n * \n * @module zrender/core/event\n * @author Kener (@Kener-, kener.linfeng@gmail.com)\n */\nvar isDomLevel2 = typeof window !== 'undefined' && !!window.addEventListener;\nvar MOUSE_EVENT_REG = /^(?:mouse|pointer|contextmenu|drag|drop)|click/;\n\nfunction getBoundingClientRect(el) {\n  // BlackBerry 5, iOS 3 (original iPhone) don't have getBoundingRect\n  return el.getBoundingClientRect ? el.getBoundingClientRect() : {\n    left: 0,\n    top: 0\n  };\n} // `calculate` is optional, default false\n\n\nfunction clientToLocal(el, e, out, calculate) {\n  out = out || {}; // According to the W3C Working Draft, offsetX and offsetY should be relative\n  // to the padding edge of the target element. The only browser using this convention\n  // is IE. Webkit uses the border edge, Opera uses the content edge, and FireFox does\n  // not support the properties.\n  // (see http://www.jacklmoore.com/notes/mouse-position/)\n  // In zr painter.dom, padding edge equals to border edge.\n  // FIXME\n  // When mousemove event triggered on ec tooltip, target is not zr painter.dom, and\n  // offsetX/Y is relative to e.target, where the calculation of zrX/Y via offsetX/Y\n  // is too complex. So css-transfrom dont support in this case temporarily.\n\n  if (calculate || !env$1.canvasSupported) {\n    defaultGetZrXY(el, e, out);\n  } // Caution: In FireFox, layerX/layerY Mouse position relative to the closest positioned\n  // ancestor element, so we should make sure el is positioned (e.g., not position:static).\n  // BTW1, Webkit don't return the same results as FF in non-simple cases (like add\n  // zoom-factor, overflow / opacity layers, transforms ...)\n  // BTW2, (ev.offsetY || ev.pageY - $(ev.target).offset().top) is not correct in preserve-3d.\n  // <https://bugs.jquery.com/ticket/8523#comment:14>\n  // BTW3, In ff, offsetX/offsetY is always 0.\n  else if (env$1.browser.firefox && e.layerX != null && e.layerX !== e.offsetX) {\n      out.zrX = e.layerX;\n      out.zrY = e.layerY;\n    } // For IE6+, chrome, safari, opera. (When will ff support offsetX?)\n    else if (e.offsetX != null) {\n        out.zrX = e.offsetX;\n        out.zrY = e.offsetY;\n      } // For some other device, e.g., IOS safari.\n      else {\n          defaultGetZrXY(el, e, out);\n        }\n\n  return out;\n}\n\nfunction defaultGetZrXY(el, e, out) {\n  // This well-known method below does not support css transform.\n  var box = getBoundingClientRect(el);\n  out.zrX = e.clientX - box.left;\n  out.zrY = e.clientY - box.top;\n}\n/**\n * domtouch.\n * `calculate` is optional, default false.\n */\n\n\nfunction normalizeEvent(el, e, calculate) {\n  e = e || window.event;\n\n  if (e.zrX != null) {\n    return e;\n  }\n\n  var eventType = e.type;\n  var isTouch = eventType && eventType.indexOf('touch') >= 0;\n\n  if (!isTouch) {\n    clientToLocal(el, e, e, calculate);\n    e.zrDelta = e.wheelDelta ? e.wheelDelta / 120 : -(e.detail || 0) / 3;\n  } else {\n    var touch = eventType != 'touchend' ? e.targetTouches[0] : e.changedTouches[0];\n    touch && clientToLocal(el, touch, e, calculate);\n  } // Add which for click: 1 === left; 2 === middle; 3 === right; otherwise: 0;\n  // See jQuery: https://github.com/jquery/jquery/blob/master/src/event.js\n  // If e.which has been defined, if may be readonly,\n  // see: https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/which\n\n\n  var button = e.button;\n\n  if (e.which == null && button !== undefined && MOUSE_EVENT_REG.test(e.type)) {\n    e.which = button & 1 ? 1 : button & 2 ? 3 : button & 4 ? 2 : 0;\n  }\n\n  return e;\n}\n/**\n * @param {HTMLElement} el\n * @param {string} name\n * @param {Function} handler\n */\n\nfunction addEventListener(el, name, handler) {\n  if (isDomLevel2) {\n    // Reproduct the console warning:\n    // [Violation] Added non-passive event listener to a scroll-blocking <some> event.\n    // Consider marking event handler as 'passive' to make the page more responsive.\n    // Just set console log level: verbose in chrome dev tool.\n    // then the warning log will be printed when addEventListener called.\n    // See https://github.com/WICG/EventListenerOptions/blob/gh-pages/explainer.md\n    // We have not yet found a neat way to using passive. Because in zrender the dom event\n    // listener delegate all of the upper events of element. Some of those events need\n    // to prevent default. For example, the feature `preventDefaultMouseMove` of echarts.\n    // Before passive can be adopted, these issues should be considered:\n    // (1) Whether and how a zrender user specifies an event listener passive. And by default,\n    // passive or not.\n    // (2) How to tread that some zrender event listener is passive, and some is not. If\n    // we use other way but not preventDefault of mousewheel and touchmove, browser\n    // compatibility should be handled.\n    // var opts = (env.passiveSupported && name === 'mousewheel')\n    //     ? {passive: true}\n    //     // By default, the third param of el.addEventListener is `capture: false`.\n    //     : void 0;\n    // el.addEventListener(name, handler /* , opts */);\n    el.addEventListener(name, handler);\n  } else {\n    el.attachEvent('on' + name, handler);\n  }\n}\nfunction removeEventListener(el, name, handler) {\n  if (isDomLevel2) {\n    el.removeEventListener(name, handler);\n  } else {\n    el.detachEvent('on' + name, handler);\n  }\n}\n/**\n * preventDefault and stopPropagation.\n * Notice: do not do that in zrender. Upper application\n * do that if necessary.\n *\n * @memberOf module:zrender/core/event\n * @method\n * @param {Event} e : event\n */\n\nvar stop = isDomLevel2 ? function (e) {\n  e.preventDefault();\n  e.stopPropagation();\n  e.cancelBubble = true;\n} : function (e) {\n  e.returnValue = false;\n  e.cancelBubble = true;\n};\n // \n\n/**\n * , \n *\n * @module zrender/animation/Animation\n * @author pissang(https://github.com/pissang)\n */\n// TODO Additive animation\n// http://iosoteric.com/additive-animations-animatewithduration-in-ios-8/\n// https://developer.apple.com/videos/wwdc2014/#236\n/**\n * @typedef {Object} IZRenderStage\n * @property {Function} update\n */\n\n/**\n * @alias module:zrender/animation/Animation\n * @constructor\n * @param {Object} [options]\n * @param {Function} [options.onframe]\n * @param {IZRenderStage} [options.stage]\n * @example\n *     var animation = new Animation();\n *     var obj = {\n *         x: 100,\n *         y: 100\n *     };\n *     animation.animate(node.position)\n *         .when(1000, {\n *             x: 500,\n *             y: 500\n *         })\n *         .when(2000, {\n *             x: 100,\n *             y: 100\n *         })\n *         .start('spline');\n */\n\nvar Animation = function (options) {\n  options = options || {};\n  this.stage = options.stage || {};\n\n  this.onframe = options.onframe || function () {}; // private properties\n\n\n  this._clips = [];\n  this._running = false;\n  this._time;\n  this._pausedTime;\n  this._pauseStart;\n  this._paused = false;\n  Eventful.call(this);\n};\n\nAnimation.prototype = {\n  constructor: Animation,\n\n  /**\n   *  clip\n   * @param {module:zrender/animation/Clip} clip\n   */\n  addClip: function (clip) {\n    this._clips.push(clip);\n  },\n\n  /**\n   *  animator\n   * @param {module:zrender/animation/Animator} animator\n   */\n  addAnimator: function (animator) {\n    animator.animation = this;\n    var clips = animator.getClips();\n\n    for (var i = 0; i < clips.length; i++) {\n      this.addClip(clips[i]);\n    }\n  },\n\n  /**\n   * \n   * @param {module:zrender/animation/Clip} clip\n   */\n  removeClip: function (clip) {\n    var idx = indexOf(this._clips, clip);\n\n    if (idx >= 0) {\n      this._clips.splice(idx, 1);\n    }\n  },\n\n  /**\n   * \n   * @param {module:zrender/animation/Animator} animator\n   */\n  removeAnimator: function (animator) {\n    var clips = animator.getClips();\n\n    for (var i = 0; i < clips.length; i++) {\n      this.removeClip(clips[i]);\n    }\n\n    animator.animation = null;\n  },\n  _update: function () {\n    var time = new Date().getTime() - this._pausedTime;\n\n    var delta = time - this._time;\n    var clips = this._clips;\n    var len = clips.length;\n    var deferredEvents = [];\n    var deferredClips = [];\n\n    for (var i = 0; i < len; i++) {\n      var clip = clips[i];\n      var e = clip.step(time, delta); // Throw out the events need to be called after\n      // stage.update, like destroy\n\n      if (e) {\n        deferredEvents.push(e);\n        deferredClips.push(clip);\n      }\n    } // Remove the finished clip\n\n\n    for (var i = 0; i < len;) {\n      if (clips[i]._needsRemove) {\n        clips[i] = clips[len - 1];\n        clips.pop();\n        len--;\n      } else {\n        i++;\n      }\n    }\n\n    len = deferredEvents.length;\n\n    for (var i = 0; i < len; i++) {\n      deferredClips[i].fire(deferredEvents[i]);\n    }\n\n    this._time = time;\n    this.onframe(delta); // 'frame' should be triggered before stage, because upper application\n    // depends on the sequence (e.g., echarts-stream and finish\n    // event judge)\n\n    this.trigger('frame', delta);\n\n    if (this.stage.update) {\n      this.stage.update();\n    }\n  },\n  _startLoop: function () {\n    var self = this;\n    this._running = true;\n\n    function step() {\n      if (self._running) {\n        requestAnimationFrame(step);\n        !self._paused && self._update();\n      }\n    }\n\n    requestAnimationFrame(step);\n  },\n\n  /**\n   * Start animation.\n   */\n  start: function () {\n    this._time = new Date().getTime();\n    this._pausedTime = 0;\n\n    this._startLoop();\n  },\n\n  /**\n   * Stop animation.\n   */\n  stop: function () {\n    this._running = false;\n  },\n\n  /**\n   * Pause animation.\n   */\n  pause: function () {\n    if (!this._paused) {\n      this._pauseStart = new Date().getTime();\n      this._paused = true;\n    }\n  },\n\n  /**\n   * Resume animation.\n   */\n  resume: function () {\n    if (this._paused) {\n      this._pausedTime += new Date().getTime() - this._pauseStart;\n      this._paused = false;\n    }\n  },\n\n  /**\n   * Clear animation.\n   */\n  clear: function () {\n    this._clips = [];\n  },\n\n  /**\n   * Whether animation finished.\n   */\n  isFinished: function () {\n    return !this._clips.length;\n  },\n\n  /**\n   * Creat animator for a target, whose props can be animated.\n   *\n   * @param  {Object} target\n   * @param  {Object} options\n   * @param  {boolean} [options.loop=false] Whether loop animation.\n   * @param  {Function} [options.getter=null] Get value from target.\n   * @param  {Function} [options.setter=null] Set value to target.\n   * @return {module:zrender/animation/Animation~Animator}\n   */\n  // TODO Gap\n  animate: function (target, options) {\n    options = options || {};\n    var animator = new Animator(target, options.loop, options.getter, options.setter);\n    this.addAnimator(animator);\n    return animator;\n  }\n};\nmixin(Animation, Eventful);\n\n/**\n * Only implements needed gestures for mobile.\n */\nvar GestureMgr = function () {\n  /**\n   * @private\n   * @type {Array.<Object>}\n   */\n  this._track = [];\n};\n\nGestureMgr.prototype = {\n  constructor: GestureMgr,\n  recognize: function (event, target, root) {\n    this._doTrack(event, target, root);\n\n    return this._recognize(event);\n  },\n  clear: function () {\n    this._track.length = 0;\n    return this;\n  },\n  _doTrack: function (event, target, root) {\n    var touches = event.touches;\n\n    if (!touches) {\n      return;\n    }\n\n    var trackItem = {\n      points: [],\n      touches: [],\n      target: target,\n      event: event\n    };\n\n    for (var i = 0, len = touches.length; i < len; i++) {\n      var touch = touches[i];\n      var pos = clientToLocal(root, touch, {});\n      trackItem.points.push([pos.zrX, pos.zrY]);\n      trackItem.touches.push(touch);\n    }\n\n    this._track.push(trackItem);\n  },\n  _recognize: function (event) {\n    for (var eventName in recognizers) {\n      if (recognizers.hasOwnProperty(eventName)) {\n        var gestureInfo = recognizers[eventName](this._track, event);\n\n        if (gestureInfo) {\n          return gestureInfo;\n        }\n      }\n    }\n  }\n};\n\nfunction dist$1(pointPair) {\n  var dx = pointPair[1][0] - pointPair[0][0];\n  var dy = pointPair[1][1] - pointPair[0][1];\n  return Math.sqrt(dx * dx + dy * dy);\n}\n\nfunction center(pointPair) {\n  return [(pointPair[0][0] + pointPair[1][0]) / 2, (pointPair[0][1] + pointPair[1][1]) / 2];\n}\n\nvar recognizers = {\n  pinch: function (track, event) {\n    var trackLen = track.length;\n\n    if (!trackLen) {\n      return;\n    }\n\n    var pinchEnd = (track[trackLen - 1] || {}).points;\n    var pinchPre = (track[trackLen - 2] || {}).points || pinchEnd;\n\n    if (pinchPre && pinchPre.length > 1 && pinchEnd && pinchEnd.length > 1) {\n      var pinchScale = dist$1(pinchEnd) / dist$1(pinchPre);\n      !isFinite(pinchScale) && (pinchScale = 1);\n      event.pinchScale = pinchScale;\n      var pinchCenter = center(pinchEnd);\n      event.pinchX = pinchCenter[0];\n      event.pinchY = pinchCenter[1];\n      return {\n        type: 'pinch',\n        target: track[0].target,\n        event: event\n      };\n    }\n  } // Only pinch currently.\n\n};\n\nvar TOUCH_CLICK_DELAY = 300;\nvar mouseHandlerNames = ['click', 'dblclick', 'mousewheel', 'mouseout', 'mouseup', 'mousedown', 'mousemove', 'contextmenu'];\nvar touchHandlerNames = ['touchstart', 'touchend', 'touchmove'];\nvar pointerEventNames = {\n  pointerdown: 1,\n  pointerup: 1,\n  pointermove: 1,\n  pointerout: 1\n};\nvar pointerHandlerNames = map(mouseHandlerNames, function (name) {\n  var nm = name.replace('mouse', 'pointer');\n  return pointerEventNames[nm] ? nm : name;\n});\n\nfunction eventNameFix(name) {\n  return name === 'mousewheel' && env$1.browser.firefox ? 'DOMMouseScroll' : name;\n}\n\nfunction processGesture(proxy, event, stage) {\n  var gestureMgr = proxy._gestureMgr;\n  stage === 'start' && gestureMgr.clear();\n  var gestureInfo = gestureMgr.recognize(event, proxy.handler.findHover(event.zrX, event.zrY, null).target, proxy.dom);\n  stage === 'end' && gestureMgr.clear(); // Do not do any preventDefault here. Upper application do that if necessary.\n\n  if (gestureInfo) {\n    var type = gestureInfo.type;\n    event.gestureEvent = type;\n    proxy.handler.dispatchToElement({\n      target: gestureInfo.target\n    }, type, gestureInfo.event);\n  }\n} // function onMSGestureChange(proxy, event) {\n//     if (event.translationX || event.translationY) {\n//         // mousemove is carried by MSGesture to reduce the sensitivity.\n//         proxy.handler.dispatchToElement(event.target, 'mousemove', event);\n//     }\n//     if (event.scale !== 1) {\n//         event.pinchX = event.offsetX;\n//         event.pinchY = event.offsetY;\n//         event.pinchScale = event.scale;\n//         proxy.handler.dispatchToElement(event.target, 'pinch', event);\n//     }\n// }\n\n/**\n * Prevent mouse event from being dispatched after Touch Events action\n * @see <https://github.com/deltakosh/handjs/blob/master/src/hand.base.js>\n * 1. Mobile browsers dispatch mouse events 300ms after touchend.\n * 2. Chrome for Android dispatch mousedown for long-touch about 650ms\n * Result: Blocking Mouse Events for 700ms.\n */\n\n\nfunction setTouchTimer(instance) {\n  instance._touching = true;\n  clearTimeout(instance._touchTimer);\n  instance._touchTimer = setTimeout(function () {\n    instance._touching = false;\n  }, 700);\n}\n\nvar domHandlers = {\n  /**\n   * Mouse move handler\n   * @inner\n   * @param {Event} event\n   */\n  mousemove: function (event) {\n    event = normalizeEvent(this.dom, event);\n    this.trigger('mousemove', event);\n  },\n\n  /**\n   * Mouse out handler\n   * @inner\n   * @param {Event} event\n   */\n  mouseout: function (event) {\n    event = normalizeEvent(this.dom, event);\n    var element = event.toElement || event.relatedTarget;\n\n    if (element != this.dom) {\n      while (element && element.nodeType != 9) {\n        // rootdommouseOut\n        if (element === this.dom) {\n          return;\n        }\n\n        element = element.parentNode;\n      }\n    }\n\n    this.trigger('mouseout', event);\n  },\n\n  /**\n   * Touch\n   * @inner\n   * @param {Event} event\n   */\n  touchstart: function (event) {\n    // Default mouse behaviour should not be disabled here.\n    // For example, page may needs to be slided.\n    event = normalizeEvent(this.dom, event); // Mark touch, which is useful in distinguish touch and\n    // mouse event in upper applicatoin.\n\n    event.zrByTouch = true;\n    this._lastTouchMoment = new Date();\n    processGesture(this, event, 'start'); // In touch device, trigger `mousemove`(`mouseover`) should\n    // be triggered, and must before `mousedown` triggered.\n\n    domHandlers.mousemove.call(this, event);\n    domHandlers.mousedown.call(this, event);\n    setTouchTimer(this);\n  },\n\n  /**\n   * Touch\n   * @inner\n   * @param {Event} event\n   */\n  touchmove: function (event) {\n    event = normalizeEvent(this.dom, event); // Mark touch, which is useful in distinguish touch and\n    // mouse event in upper applicatoin.\n\n    event.zrByTouch = true;\n    processGesture(this, event, 'change'); // Mouse move should always be triggered no matter whether\n    // there is gestrue event, because mouse move and pinch may\n    // be used at the same time.\n\n    domHandlers.mousemove.call(this, event);\n    setTouchTimer(this);\n  },\n\n  /**\n   * Touch\n   * @inner\n   * @param {Event} event\n   */\n  touchend: function (event) {\n    event = normalizeEvent(this.dom, event); // Mark touch, which is useful in distinguish touch and\n    // mouse event in upper applicatoin.\n\n    event.zrByTouch = true;\n    processGesture(this, event, 'end');\n    domHandlers.mouseup.call(this, event); // Do not trigger `mouseout` here, in spite of `mousemove`(`mouseover`) is\n    // triggered in `touchstart`. This seems to be illogical, but by this mechanism,\n    // we can conveniently implement \"hover style\" in both PC and touch device just\n    // by listening to `mouseover` to add \"hover style\" and listening to `mouseout`\n    // to remove \"hover style\" on an element, without any additional code for\n    // compatibility. (`mouseout` will not be triggered in `touchend`, so \"hover\n    // style\" will remain for user view)\n    // click event should always be triggered no matter whether\n    // there is gestrue event. System click can not be prevented.\n\n    if (+new Date() - this._lastTouchMoment < TOUCH_CLICK_DELAY) {\n      domHandlers.click.call(this, event);\n    }\n\n    setTouchTimer(this);\n  },\n  pointerdown: function (event) {\n    domHandlers.mousedown.call(this, event); // if (useMSGuesture(this, event)) {\n    //     this._msGesture.addPointer(event.pointerId);\n    // }\n  },\n  pointermove: function (event) {\n    // FIXME\n    // pointermove is so sensitive that it always triggered when\n    // tap(click) on touch screen, which affect some judgement in\n    // upper application. So, we dont support mousemove on MS touch\n    // device yet.\n    if (!isPointerFromTouch(event)) {\n      domHandlers.mousemove.call(this, event);\n    }\n  },\n  pointerup: function (event) {\n    domHandlers.mouseup.call(this, event);\n  },\n  pointerout: function (event) {\n    // pointerout will be triggered when tap on touch screen\n    // (IE11+/Edge on MS Surface) after click event triggered,\n    // which is inconsistent with the mousout behavior we defined\n    // in touchend. So we unify them.\n    // (check domHandlers.touchend for detailed explanation)\n    if (!isPointerFromTouch(event)) {\n      domHandlers.mouseout.call(this, event);\n    }\n  }\n};\n\nfunction isPointerFromTouch(event) {\n  var pointerType = event.pointerType;\n  return pointerType === 'pen' || pointerType === 'touch';\n} // function useMSGuesture(handlerProxy, event) {\n//     return isPointerFromTouch(event) && !!handlerProxy._msGesture;\n// }\n// Common handlers\n\n\neach$1(['click', 'mousedown', 'mouseup', 'mousewheel', 'dblclick', 'contextmenu'], function (name) {\n  domHandlers[name] = function (event) {\n    event = normalizeEvent(this.dom, event);\n    this.trigger(name, event);\n  };\n});\n/**\n * dom \n *\n * @inner\n * @param {module:zrender/Handler} instance \n */\n\nfunction initDomHandler(instance) {\n  each$1(touchHandlerNames, function (name) {\n    instance._handlers[name] = bind(domHandlers[name], instance);\n  });\n  each$1(pointerHandlerNames, function (name) {\n    instance._handlers[name] = bind(domHandlers[name], instance);\n  });\n  each$1(mouseHandlerNames, function (name) {\n    instance._handlers[name] = makeMouseHandler(domHandlers[name], instance);\n  });\n\n  function makeMouseHandler(fn, instance) {\n    return function () {\n      if (instance._touching) {\n        return;\n      }\n\n      return fn.apply(instance, arguments);\n    };\n  }\n}\n\nfunction HandlerDomProxy(dom) {\n  Eventful.call(this);\n  this.dom = dom;\n  /**\n   * @private\n   * @type {boolean}\n   */\n\n  this._touching = false;\n  /**\n   * @private\n   * @type {number}\n   */\n\n  this._touchTimer;\n  /**\n   * @private\n   * @type {module:zrender/core/GestureMgr}\n   */\n\n  this._gestureMgr = new GestureMgr();\n  this._handlers = {};\n  initDomHandler(this);\n\n  if (env$1.pointerEventsSupported) {\n    // Only IE11+/Edge\n    // 1. On devices that both enable touch and mouse (e.g., MS Surface and lenovo X240),\n    // IE11+/Edge do not trigger touch event, but trigger pointer event and mouse event\n    // at the same time.\n    // 2. On MS Surface, it probablely only trigger mousedown but no mouseup when tap on\n    // screen, which do not occurs in pointer event.\n    // So we use pointer event to both detect touch gesture and mouse behavior.\n    mountHandlers(pointerHandlerNames, this); // FIXME\n    // Note: MS Gesture require CSS touch-action set. But touch-action is not reliable,\n    // which does not prevent defuault behavior occasionally (which may cause view port\n    // zoomed in but use can not zoom it back). And event.preventDefault() does not work.\n    // So we have to not to use MSGesture and not to support touchmove and pinch on MS\n    // touch screen. And we only support click behavior on MS touch screen now.\n    // MS Gesture Event is only supported on IE11+/Edge and on Windows 8+.\n    // We dont support touch on IE on win7.\n    // See <https://msdn.microsoft.com/en-us/library/dn433243(v=vs.85).aspx>\n    // if (typeof MSGesture === 'function') {\n    //     (this._msGesture = new MSGesture()).target = dom; // jshint ignore:line\n    //     dom.addEventListener('MSGestureChange', onMSGestureChange);\n    // }\n  } else {\n    if (env$1.touchEventsSupported) {\n      mountHandlers(touchHandlerNames, this); // Handler of 'mouseout' event is needed in touch mode, which will be mounted below.\n      // addEventListener(root, 'mouseout', this._mouseoutHandler);\n    } // 1. Considering some devices that both enable touch and mouse event (like on MS Surface\n    // and lenovo X240, @see #2350), we make mouse event be always listened, otherwise\n    // mouse event can not be handle in those devices.\n    // 2. On MS Surface, Chrome will trigger both touch event and mouse event. How to prevent\n    // mouseevent after touch event triggered, see `setTouchTimer`.\n\n\n    mountHandlers(mouseHandlerNames, this);\n  }\n\n  function mountHandlers(handlerNames, instance) {\n    each$1(handlerNames, function (name) {\n      addEventListener(dom, eventNameFix(name), instance._handlers[name]);\n    }, instance);\n  }\n}\n\nvar handlerDomProxyProto = HandlerDomProxy.prototype;\n\nhandlerDomProxyProto.dispose = function () {\n  var handlerNames = mouseHandlerNames.concat(touchHandlerNames);\n\n  for (var i = 0; i < handlerNames.length; i++) {\n    var name = handlerNames[i];\n    removeEventListener(this.dom, eventNameFix(name), this._handlers[name]);\n  }\n};\n\nhandlerDomProxyProto.setCursor = function (cursorStyle) {\n  this.dom.style && (this.dom.style.cursor = cursorStyle || 'default');\n};\n\nmixin(HandlerDomProxy, Eventful);\n\n/*!\n* ZRender, a high performance 2d drawing library.\n*\n* Copyright (c) 2013, Baidu Inc.\n* All rights reserved.\n*\n* LICENSE\n* https://github.com/ecomfe/zrender/blob/master/LICENSE.txt\n*/\nvar useVML = !env$1.canvasSupported;\nvar painterCtors = {\n  canvas: Painter\n};\nvar instances$1 = {}; // ZRendermap\n\n/**\n * @type {string}\n */\n\nvar version$1 = '4.0.4';\n/**\n * Initializing a zrender instance\n * @param {HTMLElement} dom\n * @param {Object} opts\n * @param {string} [opts.renderer='canvas'] 'canvas' or 'svg'\n * @param {number} [opts.devicePixelRatio]\n * @param {number|string} [opts.width] Can be 'auto' (the same as null/undefined)\n * @param {number|string} [opts.height] Can be 'auto' (the same as null/undefined)\n * @return {module:zrender/ZRender}\n */\n\nfunction init$1(dom, opts) {\n  var zr = new ZRender(guid(), dom, opts);\n  instances$1[zr.id] = zr;\n  return zr;\n}\n/**\n * Dispose zrender instance\n * @param {module:zrender/ZRender} zr\n */\n\nfunction dispose$1(zr) {\n  if (zr) {\n    zr.dispose();\n  } else {\n    for (var key in instances$1) {\n      if (instances$1.hasOwnProperty(key)) {\n        instances$1[key].dispose();\n      }\n    }\n\n    instances$1 = {};\n  }\n\n  return this;\n}\n/**\n * Get zrender instance by id\n * @param {string} id zrender instance id\n * @return {module:zrender/ZRender}\n */\n\nfunction getInstance(id) {\n  return instances$1[id];\n}\nfunction registerPainter(name, Ctor) {\n  painterCtors[name] = Ctor;\n}\n\nfunction delInstance(id) {\n  delete instances$1[id];\n}\n/**\n * @module zrender/ZRender\n */\n\n/**\n * @constructor\n * @alias module:zrender/ZRender\n * @param {string} id\n * @param {HTMLElement} dom\n * @param {Object} opts\n * @param {string} [opts.renderer='canvas'] 'canvas' or 'svg'\n * @param {number} [opts.devicePixelRatio]\n * @param {number} [opts.width] Can be 'auto' (the same as null/undefined)\n * @param {number} [opts.height] Can be 'auto' (the same as null/undefined)\n */\n\n\nvar ZRender = function (id, dom, opts) {\n  opts = opts || {};\n  /**\n   * @type {HTMLDomElement}\n   */\n\n  this.dom = dom;\n  /**\n   * @type {string}\n   */\n\n  this.id = id;\n  var self = this;\n  var storage = new Storage();\n  var rendererType = opts.renderer; // TODO WebGL\n\n  if (useVML) {\n    if (!painterCtors.vml) {\n      throw new Error('You need to require \\'zrender/vml/vml\\' to support IE8');\n    }\n\n    rendererType = 'vml';\n  } else if (!rendererType || !painterCtors[rendererType]) {\n    rendererType = 'canvas';\n  }\n\n  var painter = new painterCtors[rendererType](dom, storage, opts, id);\n  this.storage = storage;\n  this.painter = painter;\n  var handerProxy = !env$1.node && !env$1.worker ? new HandlerDomProxy(painter.getViewportRoot()) : null;\n  this.handler = new Handler(storage, painter, handerProxy, painter.root);\n  /**\n   * @type {module:zrender/animation/Animation}\n   */\n\n  this.animation = new Animation({\n    stage: {\n      update: bind(this.flush, this)\n    }\n  });\n  this.animation.start();\n  /**\n   * @type {boolean}\n   * @private\n   */\n\n  this._needsRefresh; //  storage.delFromStorage, \n  // FIXME ugly\n\n  var oldDelFromStorage = storage.delFromStorage;\n  var oldAddToStorage = storage.addToStorage;\n\n  storage.delFromStorage = function (el) {\n    oldDelFromStorage.call(storage, el);\n    el && el.removeSelfFromZr(self);\n  };\n\n  storage.addToStorage = function (el) {\n    oldAddToStorage.call(storage, el);\n    el.addSelfToZr(self);\n  };\n};\n\nZRender.prototype = {\n  constructor: ZRender,\n\n  /**\n   * \n   * @return {string}\n   */\n  getId: function () {\n    return this.id;\n  },\n\n  /**\n   * \n   * @param  {module:zrender/Element} el\n   */\n  add: function (el) {\n    this.storage.addRoot(el);\n    this._needsRefresh = true;\n  },\n\n  /**\n   * \n   * @param  {module:zrender/Element} el\n   */\n  remove: function (el) {\n    this.storage.delRoot(el);\n    this._needsRefresh = true;\n  },\n\n  /**\n   * Change configuration of layer\n   * @param {string} zLevel\n   * @param {Object} config\n   * @param {string} [config.clearColor=0] Clear color\n   * @param {string} [config.motionBlur=false] If enable motion blur\n   * @param {number} [config.lastFrameAlpha=0.7] Motion blur factor. Larger value cause longer trailer\n  */\n  configLayer: function (zLevel, config) {\n    if (this.painter.configLayer) {\n      this.painter.configLayer(zLevel, config);\n    }\n\n    this._needsRefresh = true;\n  },\n\n  /**\n   * Set background color\n   * @param {string} backgroundColor\n   */\n  setBackgroundColor: function (backgroundColor) {\n    if (this.painter.setBackgroundColor) {\n      this.painter.setBackgroundColor(backgroundColor);\n    }\n\n    this._needsRefresh = true;\n  },\n\n  /**\n   * Repaint the canvas immediately\n   */\n  refreshImmediately: function () {\n    // var start = new Date();\n    // Clear needsRefresh ahead to avoid something wrong happens in refresh\n    // Or it will cause zrender refreshes again and again.\n    this._needsRefresh = false;\n    this.painter.refresh();\n    /**\n     * Avoid trigger zr.refresh in Element#beforeUpdate hook\n     */\n\n    this._needsRefresh = false; // var end = new Date();\n    // var log = document.getElementById('log');\n    // if (log) {\n    //     log.innerHTML = log.innerHTML + '<br>' + (end - start);\n    // }\n  },\n\n  /**\n   * Mark and repaint the canvas in the next frame of browser\n   */\n  refresh: function () {\n    this._needsRefresh = true;\n  },\n\n  /**\n   * Perform all refresh\n   */\n  flush: function () {\n    var triggerRendered;\n\n    if (this._needsRefresh) {\n      triggerRendered = true;\n      this.refreshImmediately();\n    }\n\n    if (this._needsRefreshHover) {\n      triggerRendered = true;\n      this.refreshHoverImmediately();\n    }\n\n    triggerRendered && this.trigger('rendered');\n  },\n\n  /**\n   * Add element to hover layer\n   * @param  {module:zrender/Element} el\n   * @param {Object} style\n   */\n  addHover: function (el, style) {\n    if (this.painter.addHover) {\n      this.painter.addHover(el, style);\n      this.refreshHover();\n    }\n  },\n\n  /**\n   * Add element from hover layer\n   * @param  {module:zrender/Element} el\n   */\n  removeHover: function (el) {\n    if (this.painter.removeHover) {\n      this.painter.removeHover(el);\n      this.refreshHover();\n    }\n  },\n\n  /**\n   * Clear all hover elements in hover layer\n   * @param  {module:zrender/Element} el\n   */\n  clearHover: function () {\n    if (this.painter.clearHover) {\n      this.painter.clearHover();\n      this.refreshHover();\n    }\n  },\n\n  /**\n   * Refresh hover in next frame\n   */\n  refreshHover: function () {\n    this._needsRefreshHover = true;\n  },\n\n  /**\n   * Refresh hover immediately\n   */\n  refreshHoverImmediately: function () {\n    this._needsRefreshHover = false;\n    this.painter.refreshHover && this.painter.refreshHover();\n  },\n\n  /**\n   * Resize the canvas.\n   * Should be invoked when container size is changed\n   * @param {Object} [opts]\n   * @param {number|string} [opts.width] Can be 'auto' (the same as null/undefined)\n   * @param {number|string} [opts.height] Can be 'auto' (the same as null/undefined)\n   */\n  resize: function (opts) {\n    opts = opts || {};\n    this.painter.resize(opts.width, opts.height);\n    this.handler.resize();\n  },\n\n  /**\n   * Stop and clear all animation immediately\n   */\n  clearAnimation: function () {\n    this.animation.clear();\n  },\n\n  /**\n   * Get container width\n   */\n  getWidth: function () {\n    return this.painter.getWidth();\n  },\n\n  /**\n   * Get container height\n   */\n  getHeight: function () {\n    return this.painter.getHeight();\n  },\n\n  /**\n   * Export the canvas as Base64 URL\n   * @param {string} type\n   * @param {string} [backgroundColor='#fff']\n   * @return {string} Base64 URL\n   */\n  // toDataURL: function(type, backgroundColor) {\n  //     return this.painter.getRenderedCanvas({\n  //         backgroundColor: backgroundColor\n  //     }).toDataURL(type);\n  // },\n\n  /**\n   * Converting a path to image.\n   * It has much better performance of drawing image rather than drawing a vector path.\n   * @param {module:zrender/graphic/Path} e\n   * @param {number} width\n   * @param {number} height\n   */\n  pathToImage: function (e, dpr) {\n    return this.painter.pathToImage(e, dpr);\n  },\n\n  /**\n   * Set default cursor\n   * @param {string} [cursorStyle='default']  crosshair\n   */\n  setCursorStyle: function (cursorStyle) {\n    this.handler.setCursorStyle(cursorStyle);\n  },\n\n  /**\n   * Find hovered element\n   * @param {number} x\n   * @param {number} y\n   * @return {Object} {target, topTarget}\n   */\n  findHover: function (x, y) {\n    return this.handler.findHover(x, y);\n  },\n\n  /**\n   * Bind event\n   *\n   * @param {string} eventName Event name\n   * @param {Function} eventHandler Handler function\n   * @param {Object} [context] Context object\n   */\n  on: function (eventName, eventHandler, context) {\n    this.handler.on(eventName, eventHandler, context);\n  },\n\n  /**\n   * Unbind event\n   * @param {string} eventName Event name\n   * @param {Function} [eventHandler] Handler function\n   */\n  off: function (eventName, eventHandler) {\n    this.handler.off(eventName, eventHandler);\n  },\n\n  /**\n   * Trigger event manually\n   *\n   * @param {string} eventName Event name\n   * @param {event=} event Event object\n   */\n  trigger: function (eventName, event) {\n    this.handler.trigger(eventName, event);\n  },\n\n  /**\n   * Clear all objects and the canvas.\n   */\n  clear: function () {\n    this.storage.delRoot();\n    this.painter.clear();\n  },\n\n  /**\n   * Dispose self.\n   */\n  dispose: function () {\n    this.animation.stop();\n    this.clear();\n    this.storage.dispose();\n    this.painter.dispose();\n    this.handler.dispose();\n    this.animation = this.storage = this.painter = this.handler = null;\n    delInstance(this.id);\n  }\n};\n\nvar zrender = (Object.freeze || Object)({\n\tversion: version$1,\n\tinit: init$1,\n\tdispose: dispose$1,\n\tgetInstance: getInstance,\n\tregisterPainter: registerPainter\n});\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar each$2 = each$1;\nvar isObject$2 = isObject$1;\nvar isArray$1 = isArray;\n/**\n * Make the name displayable. But we should\n * make sure it is not duplicated with user\n * specified name, so use '\\0';\n */\n\nvar DUMMY_COMPONENT_NAME_PREFIX = 'series\\0';\n/**\n * If value is not array, then translate it to array.\n * @param  {*} value\n * @return {Array} [value] or value\n */\n\nfunction normalizeToArray(value) {\n  return value instanceof Array ? value : value == null ? [] : [value];\n}\n/**\n * Sync default option between normal and emphasis like `position` and `show`\n * In case some one will write code like\n *     label: {\n *          show: false,\n *          position: 'outside',\n *          fontSize: 18\n *     },\n *     emphasis: {\n *          label: { show: true }\n *     }\n * @param {Object} opt\n * @param {string} key\n * @param {Array.<string>} subOpts\n */\n\nfunction defaultEmphasis(opt, key, subOpts) {\n  // Caution: performance sensitive.\n  if (opt) {\n    opt[key] = opt[key] || {};\n    opt.emphasis = opt.emphasis || {};\n    opt.emphasis[key] = opt.emphasis[key] || {}; // Default emphasis option from normal\n\n    for (var i = 0, len = subOpts.length; i < len; i++) {\n      var subOptName = subOpts[i];\n\n      if (!opt.emphasis[key].hasOwnProperty(subOptName) && opt[key].hasOwnProperty(subOptName)) {\n        opt.emphasis[key][subOptName] = opt[key][subOptName];\n      }\n    }\n  }\n}\nvar TEXT_STYLE_OPTIONS = ['fontStyle', 'fontWeight', 'fontSize', 'fontFamily', 'rich', 'tag', 'color', 'textBorderColor', 'textBorderWidth', 'width', 'height', 'lineHeight', 'align', 'verticalAlign', 'baseline', 'shadowColor', 'shadowBlur', 'shadowOffsetX', 'shadowOffsetY', 'textShadowColor', 'textShadowBlur', 'textShadowOffsetX', 'textShadowOffsetY', 'backgroundColor', 'borderColor', 'borderWidth', 'borderRadius', 'padding']; // modelUtil.LABEL_OPTIONS = modelUtil.TEXT_STYLE_OPTIONS.concat([\n//     'position', 'offset', 'rotate', 'origin', 'show', 'distance', 'formatter',\n//     'fontStyle', 'fontWeight', 'fontSize', 'fontFamily',\n//     // FIXME: deprecated, check and remove it.\n//     'textStyle'\n// ]);\n\n/**\n * The method do not ensure performance.\n * data could be [12, 2323, {value: 223}, [1221, 23], {value: [2, 23]}]\n * This helper method retieves value from data.\n * @param {string|number|Date|Array|Object} dataItem\n * @return {number|string|Date|Array.<number|string|Date>}\n */\n\nfunction getDataItemValue(dataItem) {\n  return isObject$2(dataItem) && !isArray$1(dataItem) && !(dataItem instanceof Date) ? dataItem.value : dataItem;\n}\n/**\n * data could be [12, 2323, {value: 223}, [1221, 23], {value: [2, 23]}]\n * This helper method determine if dataItem has extra option besides value\n * @param {string|number|Date|Array|Object} dataItem\n */\n\nfunction isDataItemOption(dataItem) {\n  return isObject$2(dataItem) && !(dataItem instanceof Array); // // markLine data can be array\n  // && !(dataItem[0] && isObject(dataItem[0]) && !(dataItem[0] instanceof Array));\n}\n/**\n * Mapping to exists for merge.\n *\n * @public\n * @param {Array.<Object>|Array.<module:echarts/model/Component>} exists\n * @param {Object|Array.<Object>} newCptOptions\n * @return {Array.<Object>} Result, like [{exist: ..., option: ...}, {}],\n *                          index of which is the same as exists.\n */\n\nfunction mappingToExists(exists, newCptOptions) {\n  // Mapping by the order by original option (but not order of\n  // new option) in merge mode. Because we should ensure\n  // some specified index (like xAxisIndex) is consistent with\n  // original option, which is easy to understand, espatially in\n  // media query. And in most case, merge option is used to\n  // update partial option but not be expected to change order.\n  newCptOptions = (newCptOptions || []).slice();\n  var result = map(exists || [], function (obj, index) {\n    return {\n      exist: obj\n    };\n  }); // Mapping by id or name if specified.\n\n  each$2(newCptOptions, function (cptOption, index) {\n    if (!isObject$2(cptOption)) {\n      return;\n    } // id has highest priority.\n\n\n    for (var i = 0; i < result.length; i++) {\n      if (!result[i].option // Consider name: two map to one.\n      && cptOption.id != null && result[i].exist.id === cptOption.id + '') {\n        result[i].option = cptOption;\n        newCptOptions[index] = null;\n        return;\n      }\n    }\n\n    for (var i = 0; i < result.length; i++) {\n      var exist = result[i].exist;\n\n      if (!result[i].option // Consider name: two map to one.\n      // Can not match when both ids exist but different.\n      && (exist.id == null || cptOption.id == null) && cptOption.name != null && !isIdInner(cptOption) && !isIdInner(exist) && exist.name === cptOption.name + '') {\n        result[i].option = cptOption;\n        newCptOptions[index] = null;\n        return;\n      }\n    }\n  }); // Otherwise mapping by index.\n\n  each$2(newCptOptions, function (cptOption, index) {\n    if (!isObject$2(cptOption)) {\n      return;\n    }\n\n    var i = 0;\n\n    for (; i < result.length; i++) {\n      var exist = result[i].exist;\n\n      if (!result[i].option // Existing model that already has id should be able to\n      // mapped to (because after mapping performed model may\n      // be assigned with a id, whish should not affect next\n      // mapping), except those has inner id.\n      && !isIdInner(exist) // Caution:\n      // Do not overwrite id. But name can be overwritten,\n      // because axis use name as 'show label text'.\n      // 'exist' always has id and name and we dont\n      // need to check it.\n      && cptOption.id == null) {\n        result[i].option = cptOption;\n        break;\n      }\n    }\n\n    if (i >= result.length) {\n      result.push({\n        option: cptOption\n      });\n    }\n  });\n  return result;\n}\n/**\n * Make id and name for mapping result (result of mappingToExists)\n * into `keyInfo` field.\n *\n * @public\n * @param {Array.<Object>} Result, like [{exist: ..., option: ...}, {}],\n *                          which order is the same as exists.\n * @return {Array.<Object>} The input.\n */\n\nfunction makeIdAndName(mapResult) {\n  // We use this id to hash component models and view instances\n  // in echarts. id can be specified by user, or auto generated.\n  // The id generation rule ensures new view instance are able\n  // to mapped to old instance when setOption are called in\n  // no-merge mode. So we generate model id by name and plus\n  // type in view id.\n  // name can be duplicated among components, which is convenient\n  // to specify multi components (like series) by one name.\n  // Ensure that each id is distinct.\n  var idMap = createHashMap();\n  each$2(mapResult, function (item, index) {\n    var existCpt = item.exist;\n    existCpt && idMap.set(existCpt.id, item);\n  });\n  each$2(mapResult, function (item, index) {\n    var opt = item.option;\n    assert$1(!opt || opt.id == null || !idMap.get(opt.id) || idMap.get(opt.id) === item, 'id duplicates: ' + (opt && opt.id));\n    opt && opt.id != null && idMap.set(opt.id, item);\n    !item.keyInfo && (item.keyInfo = {});\n  }); // Make name and id.\n\n  each$2(mapResult, function (item, index) {\n    var existCpt = item.exist;\n    var opt = item.option;\n    var keyInfo = item.keyInfo;\n\n    if (!isObject$2(opt)) {\n      return;\n    } // name can be overwitten. Consider case: axis.name = '20km'.\n    // But id generated by name will not be changed, which affect\n    // only in that case: setOption with 'not merge mode' and view\n    // instance will be recreated, which can be accepted.\n\n\n    keyInfo.name = opt.name != null ? opt.name + '' : existCpt ? existCpt.name // Avoid diffferent series has the same name,\n    // because name may be used like in color pallet.\n    : DUMMY_COMPONENT_NAME_PREFIX + index;\n\n    if (existCpt) {\n      keyInfo.id = existCpt.id;\n    } else if (opt.id != null) {\n      keyInfo.id = opt.id + '';\n    } else {\n      // Consider this situatoin:\n      //  optionA: [{name: 'a'}, {name: 'a'}, {..}]\n      //  optionB [{..}, {name: 'a'}, {name: 'a'}]\n      // Series with the same name between optionA and optionB\n      // should be mapped.\n      var idNum = 0;\n\n      do {\n        keyInfo.id = '\\0' + keyInfo.name + '\\0' + idNum++;\n      } while (idMap.get(keyInfo.id));\n    }\n\n    idMap.set(keyInfo.id, item);\n  });\n}\nfunction isNameSpecified(componentModel) {\n  var name = componentModel.name; // Is specified when `indexOf` get -1 or > 0.\n\n  return !!(name && name.indexOf(DUMMY_COMPONENT_NAME_PREFIX));\n}\n/**\n * @public\n * @param {Object} cptOption\n * @return {boolean}\n */\n\nfunction isIdInner(cptOption) {\n  return isObject$2(cptOption) && cptOption.id && (cptOption.id + '').indexOf('\\0_ec_\\0') === 0;\n}\n/**\n * A helper for removing duplicate items between batchA and batchB,\n * and in themselves, and categorize by series.\n *\n * @param {Array.<Object>} batchA Like: [{seriesId: 2, dataIndex: [32, 4, 5]}, ...]\n * @param {Array.<Object>} batchB Like: [{seriesId: 2, dataIndex: [32, 4, 5]}, ...]\n * @return {Array.<Array.<Object>, Array.<Object>>} result: [resultBatchA, resultBatchB]\n */\n\n\n/**\n * @param {module:echarts/data/List} data\n * @param {Object} payload Contains dataIndex (means rawIndex) / dataIndexInside / name\n *                         each of which can be Array or primary type.\n * @return {number|Array.<number>} dataIndex If not found, return undefined/null.\n */\n\nfunction queryDataIndex(data, payload) {\n  if (payload.dataIndexInside != null) {\n    return payload.dataIndexInside;\n  } else if (payload.dataIndex != null) {\n    return isArray(payload.dataIndex) ? map(payload.dataIndex, function (value) {\n      return data.indexOfRawIndex(value);\n    }) : data.indexOfRawIndex(payload.dataIndex);\n  } else if (payload.name != null) {\n    return isArray(payload.name) ? map(payload.name, function (value) {\n      return data.indexOfName(value);\n    }) : data.indexOfName(payload.name);\n  }\n}\n/**\n * Enable property storage to any host object.\n * Notice: Serialization is not supported.\n *\n * For example:\n * var inner = zrUitl.makeInner();\n *\n * function some1(hostObj) {\n *      inner(hostObj).someProperty = 1212;\n *      ...\n * }\n * function some2() {\n *      var fields = inner(this);\n *      fields.someProperty1 = 1212;\n *      fields.someProperty2 = 'xx';\n *      ...\n * }\n *\n * @return {Function}\n */\n\nfunction makeInner() {\n  // Consider different scope by es module import.\n  var key = '__\\0ec_inner_' + innerUniqueIndex++ + '_' + Math.random().toFixed(5);\n  return function (hostObj) {\n    return hostObj[key] || (hostObj[key] = {});\n  };\n}\nvar innerUniqueIndex = 0;\n/**\n * @param {module:echarts/model/Global} ecModel\n * @param {string|Object} finder\n *        If string, e.g., 'geo', means {geoIndex: 0}.\n *        If Object, could contain some of these properties below:\n *        {\n *            seriesIndex, seriesId, seriesName,\n *            geoIndex, geoId, geoName,\n *            bmapIndex, bmapId, bmapName,\n *            xAxisIndex, xAxisId, xAxisName,\n *            yAxisIndex, yAxisId, yAxisName,\n *            gridIndex, gridId, gridName,\n *            ... (can be extended)\n *        }\n *        Each properties can be number|string|Array.<number>|Array.<string>\n *        For example, a finder could be\n *        {\n *            seriesIndex: 3,\n *            geoId: ['aa', 'cc'],\n *            gridName: ['xx', 'rr']\n *        }\n *        xxxIndex can be set as 'all' (means all xxx) or 'none' (means not specify)\n *        If nothing or null/undefined specified, return nothing.\n * @param {Object} [opt]\n * @param {string} [opt.defaultMainType]\n * @param {Array.<string>} [opt.includeMainTypes]\n * @return {Object} result like:\n *        {\n *            seriesModels: [seriesModel1, seriesModel2],\n *            seriesModel: seriesModel1, // The first model\n *            geoModels: [geoModel1, geoModel2],\n *            geoModel: geoModel1, // The first model\n *            ...\n *        }\n */\n\nfunction parseFinder(ecModel, finder, opt) {\n  if (isString(finder)) {\n    var obj = {};\n    obj[finder + 'Index'] = 0;\n    finder = obj;\n  }\n\n  var defaultMainType = opt && opt.defaultMainType;\n\n  if (defaultMainType && !has(finder, defaultMainType + 'Index') && !has(finder, defaultMainType + 'Id') && !has(finder, defaultMainType + 'Name')) {\n    finder[defaultMainType + 'Index'] = 0;\n  }\n\n  var result = {};\n  each$2(finder, function (value, key) {\n    var value = finder[key]; // Exclude 'dataIndex' and other illgal keys.\n\n    if (key === 'dataIndex' || key === 'dataIndexInside') {\n      result[key] = value;\n      return;\n    }\n\n    var parsedKey = key.match(/^(\\w+)(Index|Id|Name)$/) || [];\n    var mainType = parsedKey[1];\n    var queryType = (parsedKey[2] || '').toLowerCase();\n\n    if (!mainType || !queryType || value == null || queryType === 'index' && value === 'none' || opt && opt.includeMainTypes && indexOf(opt.includeMainTypes, mainType) < 0) {\n      return;\n    }\n\n    var queryParam = {\n      mainType: mainType\n    };\n\n    if (queryType !== 'index' || value !== 'all') {\n      queryParam[queryType] = value;\n    }\n\n    var models = ecModel.queryComponents(queryParam);\n    result[mainType + 'Models'] = models;\n    result[mainType + 'Model'] = models[0];\n  });\n  return result;\n}\n\nfunction has(obj, prop) {\n  return obj && obj.hasOwnProperty(prop);\n}\n\nfunction setAttribute(dom, key, value) {\n  dom.setAttribute ? dom.setAttribute(key, value) : dom[key] = value;\n}\nfunction getAttribute(dom, key) {\n  return dom.getAttribute ? dom.getAttribute(key) : dom[key];\n}\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar TYPE_DELIMITER = '.';\nvar IS_CONTAINER = '___EC__COMPONENT__CONTAINER___';\n/**\n * Notice, parseClassType('') should returns {main: '', sub: ''}\n * @public\n */\n\nfunction parseClassType$1(componentType) {\n  var ret = {\n    main: '',\n    sub: ''\n  };\n\n  if (componentType) {\n    componentType = componentType.split(TYPE_DELIMITER);\n    ret.main = componentType[0] || '';\n    ret.sub = componentType[1] || '';\n  }\n\n  return ret;\n}\n/**\n * @public\n */\n\nfunction checkClassType(componentType) {\n  assert$1(/^[a-zA-Z0-9_]+([.][a-zA-Z0-9_]+)?$/.test(componentType), 'componentType \"' + componentType + '\" illegal');\n}\n/**\n * @public\n */\n\n\nfunction enableClassExtend(RootClass, mandatoryMethods) {\n  RootClass.$constructor = RootClass;\n\n  RootClass.extend = function (proto) {\n    var superClass = this;\n\n    var ExtendedClass = function () {\n      if (!proto.$constructor) {\n        superClass.apply(this, arguments);\n      } else {\n        proto.$constructor.apply(this, arguments);\n      }\n    };\n\n    extend(ExtendedClass.prototype, proto);\n    ExtendedClass.extend = this.extend;\n    ExtendedClass.superCall = superCall;\n    ExtendedClass.superApply = superApply;\n    inherits(ExtendedClass, this);\n    ExtendedClass.superClass = superClass;\n    return ExtendedClass;\n  };\n}\nvar classBase = 0;\n/**\n * Can not use instanceof, consider different scope by\n * cross domain or es module import in ec extensions.\n * Mount a method \"isInstance()\" to Clz.\n */\n\nfunction enableClassCheck(Clz) {\n  var classAttr = ['__\\0is_clz', classBase++, Math.random().toFixed(3)].join('_');\n  Clz.prototype[classAttr] = true;\n\n  Clz.isInstance = function (obj) {\n    return !!(obj && obj[classAttr]);\n  };\n} // superCall should have class info, which can not be fetch from 'this'.\n// Consider this case:\n// class A has method f,\n// class B inherits class A, overrides method f, f call superApply('f'),\n// class C inherits class B, do not overrides method f,\n// then when method of class C is called, dead loop occured.\n\nfunction superCall(context, methodName) {\n  var args = slice(arguments, 2);\n  return this.superClass.prototype[methodName].apply(context, args);\n}\n\nfunction superApply(context, methodName, args) {\n  return this.superClass.prototype[methodName].apply(context, args);\n}\n/**\n * @param {Object} entity\n * @param {Object} options\n * @param {boolean} [options.registerWhenExtend]\n * @public\n */\n\n\nfunction enableClassManagement(entity, options) {\n  options = options || {};\n  /**\n   * Component model classes\n   * key: componentType,\n   * value:\n   *     componentClass, when componentType is 'xxx'\n   *     or Object.<subKey, componentClass>, when componentType is 'xxx.yy'\n   * @type {Object}\n   */\n\n  var storage = {};\n\n  entity.registerClass = function (Clazz, componentType) {\n    if (componentType) {\n      checkClassType(componentType);\n      componentType = parseClassType$1(componentType);\n\n      if (!componentType.sub) {\n        storage[componentType.main] = Clazz;\n      } else if (componentType.sub !== IS_CONTAINER) {\n        var container = makeContainer(componentType);\n        container[componentType.sub] = Clazz;\n      }\n    }\n\n    return Clazz;\n  };\n\n  entity.getClass = function (componentMainType, subType, throwWhenNotFound) {\n    var Clazz = storage[componentMainType];\n\n    if (Clazz && Clazz[IS_CONTAINER]) {\n      Clazz = subType ? Clazz[subType] : null;\n    }\n\n    if (throwWhenNotFound && !Clazz) {\n      throw new Error(!subType ? componentMainType + '.' + 'type should be specified.' : 'Component ' + componentMainType + '.' + (subType || '') + ' not exists. Load it first.');\n    }\n\n    return Clazz;\n  };\n\n  entity.getClassesByMainType = function (componentType) {\n    componentType = parseClassType$1(componentType);\n    var result = [];\n    var obj = storage[componentType.main];\n\n    if (obj && obj[IS_CONTAINER]) {\n      each$1(obj, function (o, type) {\n        type !== IS_CONTAINER && result.push(o);\n      });\n    } else {\n      result.push(obj);\n    }\n\n    return result;\n  };\n\n  entity.hasClass = function (componentType) {\n    // Just consider componentType.main.\n    componentType = parseClassType$1(componentType);\n    return !!storage[componentType.main];\n  };\n  /**\n   * @return {Array.<string>} Like ['aa', 'bb'], but can not be ['aa.xx']\n   */\n\n\n  entity.getAllClassMainTypes = function () {\n    var types = [];\n    each$1(storage, function (obj, type) {\n      types.push(type);\n    });\n    return types;\n  };\n  /**\n   * If a main type is container and has sub types\n   * @param  {string}  mainType\n   * @return {boolean}\n   */\n\n\n  entity.hasSubTypes = function (componentType) {\n    componentType = parseClassType$1(componentType);\n    var obj = storage[componentType.main];\n    return obj && obj[IS_CONTAINER];\n  };\n\n  entity.parseClassType = parseClassType$1;\n\n  function makeContainer(componentType) {\n    var container = storage[componentType.main];\n\n    if (!container || !container[IS_CONTAINER]) {\n      container = storage[componentType.main] = {};\n      container[IS_CONTAINER] = true;\n    }\n\n    return container;\n  }\n\n  if (options.registerWhenExtend) {\n    var originalExtend = entity.extend;\n\n    if (originalExtend) {\n      entity.extend = function (proto) {\n        var ExtendedClass = originalExtend.call(this, proto);\n        return entity.registerClass(ExtendedClass, proto.type);\n      };\n    }\n  }\n\n  return entity;\n}\n/**\n * @param {string|Array.<string>} properties\n */\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n// TODO Parse shadow style\n// TODO Only shallow path support\nvar makeStyleMapper = function (properties) {\n  // Normalize\n  for (var i = 0; i < properties.length; i++) {\n    if (!properties[i][1]) {\n      properties[i][1] = properties[i][0];\n    }\n  }\n\n  return function (model, excludes, includes) {\n    var style = {};\n\n    for (var i = 0; i < properties.length; i++) {\n      var propName = properties[i][1];\n\n      if (excludes && indexOf(excludes, propName) >= 0 || includes && indexOf(includes, propName) < 0) {\n        continue;\n      }\n\n      var val = model.getShallow(propName);\n\n      if (val != null) {\n        style[properties[i][0]] = val;\n      }\n    }\n\n    return style;\n  };\n};\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar getLineStyle = makeStyleMapper([['lineWidth', 'width'], ['stroke', 'color'], ['opacity'], ['shadowBlur'], ['shadowOffsetX'], ['shadowOffsetY'], ['shadowColor']]);\nvar lineStyleMixin = {\n  getLineStyle: function (excludes) {\n    var style = getLineStyle(this, excludes);\n    var lineDash = this.getLineDash(style.lineWidth);\n    lineDash && (style.lineDash = lineDash);\n    return style;\n  },\n  getLineDash: function (lineWidth) {\n    if (lineWidth == null) {\n      lineWidth = 1;\n    }\n\n    var lineType = this.get('type');\n    var dotSize = Math.max(lineWidth, 2);\n    var dashSize = lineWidth * 4;\n    return lineType === 'solid' || lineType == null ? null : lineType === 'dashed' ? [dashSize, dashSize] : [dotSize, dotSize];\n  }\n};\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar getAreaStyle = makeStyleMapper([['fill', 'color'], ['shadowBlur'], ['shadowOffsetX'], ['shadowOffsetY'], ['opacity'], ['shadowColor']]);\nvar areaStyleMixin = {\n  getAreaStyle: function (excludes, includes) {\n    return getAreaStyle(this, excludes, includes);\n  }\n};\n\n/**\n * \n * @module zrender/core/curve\n * @author pissang(https://www.github.com/pissang)\n */\nvar mathPow = Math.pow;\nvar mathSqrt$2 = Math.sqrt;\nvar EPSILON$1 = 1e-8;\nvar EPSILON_NUMERIC = 1e-4;\nvar THREE_SQRT = mathSqrt$2(3);\nvar ONE_THIRD = 1 / 3; // \n\nvar _v0 = create();\n\nvar _v1 = create();\n\nvar _v2 = create();\n\nfunction isAroundZero(val) {\n  return val > -EPSILON$1 && val < EPSILON$1;\n}\n\nfunction isNotAroundZero$1(val) {\n  return val > EPSILON$1 || val < -EPSILON$1;\n}\n/**\n * \n * @memberOf module:zrender/core/curve\n * @param  {number} p0\n * @param  {number} p1\n * @param  {number} p2\n * @param  {number} p3\n * @param  {number} t\n * @return {number}\n */\n\n\nfunction cubicAt(p0, p1, p2, p3, t) {\n  var onet = 1 - t;\n  return onet * onet * (onet * p0 + 3 * t * p1) + t * t * (t * p3 + 3 * onet * p2);\n}\n/**\n * \n * @memberOf module:zrender/core/curve\n * @param  {number} p0\n * @param  {number} p1\n * @param  {number} p2\n * @param  {number} p3\n * @param  {number} t\n * @return {number}\n */\n\nfunction cubicDerivativeAt(p0, p1, p2, p3, t) {\n  var onet = 1 - t;\n  return 3 * (((p1 - p0) * onet + 2 * (p2 - p1) * t) * onet + (p3 - p2) * t * t);\n}\n/**\n * \n * @memberOf module:zrender/core/curve\n * @param  {number} p0\n * @param  {number} p1\n * @param  {number} p2\n * @param  {number} p3\n * @param  {number} val\n * @param  {Array.<number>} roots\n * @return {number} \n */\n\nfunction cubicRootAt(p0, p1, p2, p3, val, roots) {\n  // Evaluate roots of cubic functions\n  var a = p3 + 3 * (p1 - p2) - p0;\n  var b = 3 * (p2 - p1 * 2 + p0);\n  var c = 3 * (p1 - p0);\n  var d = p0 - val;\n  var A = b * b - 3 * a * c;\n  var B = b * c - 9 * a * d;\n  var C = c * c - 3 * b * d;\n  var n = 0;\n\n  if (isAroundZero(A) && isAroundZero(B)) {\n    if (isAroundZero(b)) {\n      roots[0] = 0;\n    } else {\n      var t1 = -c / b; //t1, t2, t3, b is not zero\n\n      if (t1 >= 0 && t1 <= 1) {\n        roots[n++] = t1;\n      }\n    }\n  } else {\n    var disc = B * B - 4 * A * C;\n\n    if (isAroundZero(disc)) {\n      var K = B / A;\n      var t1 = -b / a + K; // t1, a is not zero\n\n      var t2 = -K / 2; // t2, t3\n\n      if (t1 >= 0 && t1 <= 1) {\n        roots[n++] = t1;\n      }\n\n      if (t2 >= 0 && t2 <= 1) {\n        roots[n++] = t2;\n      }\n    } else if (disc > 0) {\n      var discSqrt = mathSqrt$2(disc);\n      var Y1 = A * b + 1.5 * a * (-B + discSqrt);\n      var Y2 = A * b + 1.5 * a * (-B - discSqrt);\n\n      if (Y1 < 0) {\n        Y1 = -mathPow(-Y1, ONE_THIRD);\n      } else {\n        Y1 = mathPow(Y1, ONE_THIRD);\n      }\n\n      if (Y2 < 0) {\n        Y2 = -mathPow(-Y2, ONE_THIRD);\n      } else {\n        Y2 = mathPow(Y2, ONE_THIRD);\n      }\n\n      var t1 = (-b - (Y1 + Y2)) / (3 * a);\n\n      if (t1 >= 0 && t1 <= 1) {\n        roots[n++] = t1;\n      }\n    } else {\n      var T = (2 * A * b - 3 * a * B) / (2 * mathSqrt$2(A * A * A));\n      var theta = Math.acos(T) / 3;\n      var ASqrt = mathSqrt$2(A);\n      var tmp = Math.cos(theta);\n      var t1 = (-b - 2 * ASqrt * tmp) / (3 * a);\n      var t2 = (-b + ASqrt * (tmp + THREE_SQRT * Math.sin(theta))) / (3 * a);\n      var t3 = (-b + ASqrt * (tmp - THREE_SQRT * Math.sin(theta))) / (3 * a);\n\n      if (t1 >= 0 && t1 <= 1) {\n        roots[n++] = t1;\n      }\n\n      if (t2 >= 0 && t2 <= 1) {\n        roots[n++] = t2;\n      }\n\n      if (t3 >= 0 && t3 <= 1) {\n        roots[n++] = t3;\n      }\n    }\n  }\n\n  return n;\n}\n/**\n * \n * @memberOf module:zrender/core/curve\n * @param  {number} p0\n * @param  {number} p1\n * @param  {number} p2\n * @param  {number} p3\n * @param  {Array.<number>} extrema\n * @return {number} \n */\n\nfunction cubicExtrema(p0, p1, p2, p3, extrema) {\n  var b = 6 * p2 - 12 * p1 + 6 * p0;\n  var a = 9 * p1 + 3 * p3 - 3 * p0 - 9 * p2;\n  var c = 3 * p1 - 3 * p0;\n  var n = 0;\n\n  if (isAroundZero(a)) {\n    if (isNotAroundZero$1(b)) {\n      var t1 = -c / b;\n\n      if (t1 >= 0 && t1 <= 1) {\n        extrema[n++] = t1;\n      }\n    }\n  } else {\n    var disc = b * b - 4 * a * c;\n\n    if (isAroundZero(disc)) {\n      extrema[0] = -b / (2 * a);\n    } else if (disc > 0) {\n      var discSqrt = mathSqrt$2(disc);\n      var t1 = (-b + discSqrt) / (2 * a);\n      var t2 = (-b - discSqrt) / (2 * a);\n\n      if (t1 >= 0 && t1 <= 1) {\n        extrema[n++] = t1;\n      }\n\n      if (t2 >= 0 && t2 <= 1) {\n        extrema[n++] = t2;\n      }\n    }\n  }\n\n  return n;\n}\n/**\n * \n * @memberOf module:zrender/core/curve\n * @param  {number} p0\n * @param  {number} p1\n * @param  {number} p2\n * @param  {number} p3\n * @param  {number} t\n * @param  {Array.<number>} out\n */\n\nfunction cubicSubdivide(p0, p1, p2, p3, t, out) {\n  var p01 = (p1 - p0) * t + p0;\n  var p12 = (p2 - p1) * t + p1;\n  var p23 = (p3 - p2) * t + p2;\n  var p012 = (p12 - p01) * t + p01;\n  var p123 = (p23 - p12) * t + p12;\n  var p0123 = (p123 - p012) * t + p012; // Seg0\n\n  out[0] = p0;\n  out[1] = p01;\n  out[2] = p012;\n  out[3] = p0123; // Seg1\n\n  out[4] = p0123;\n  out[5] = p123;\n  out[6] = p23;\n  out[7] = p3;\n}\n/**\n * \n * \n * @param {number} x0\n * @param {number} y0\n * @param {number} x1\n * @param {number} y1\n * @param {number} x2\n * @param {number} y2\n * @param {number} x3\n * @param {number} y3\n * @param {number} x\n * @param {number} y\n * @param {Array.<number>} [out] \n * @return {number}\n */\n\nfunction cubicProjectPoint(x0, y0, x1, y1, x2, y2, x3, y3, x, y, out) {\n  // http://pomax.github.io/bezierinfo/#projections\n  var t;\n  var interval = 0.005;\n  var d = Infinity;\n  var prev;\n  var next;\n  var d1;\n  var d2;\n  _v0[0] = x;\n  _v0[1] = y; //  t \n  // PENDING\n\n  for (var _t = 0; _t < 1; _t += 0.05) {\n    _v1[0] = cubicAt(x0, x1, x2, x3, _t);\n    _v1[1] = cubicAt(y0, y1, y2, y3, _t);\n    d1 = distSquare(_v0, _v1);\n\n    if (d1 < d) {\n      t = _t;\n      d = d1;\n    }\n  }\n\n  d = Infinity; // At most 32 iteration\n\n  for (var i = 0; i < 32; i++) {\n    if (interval < EPSILON_NUMERIC) {\n      break;\n    }\n\n    prev = t - interval;\n    next = t + interval; // t - interval\n\n    _v1[0] = cubicAt(x0, x1, x2, x3, prev);\n    _v1[1] = cubicAt(y0, y1, y2, y3, prev);\n    d1 = distSquare(_v1, _v0);\n\n    if (prev >= 0 && d1 < d) {\n      t = prev;\n      d = d1;\n    } else {\n      // t + interval\n      _v2[0] = cubicAt(x0, x1, x2, x3, next);\n      _v2[1] = cubicAt(y0, y1, y2, y3, next);\n      d2 = distSquare(_v2, _v0);\n\n      if (next <= 1 && d2 < d) {\n        t = next;\n        d = d2;\n      } else {\n        interval *= 0.5;\n      }\n    }\n  } // t\n\n\n  if (out) {\n    out[0] = cubicAt(x0, x1, x2, x3, t);\n    out[1] = cubicAt(y0, y1, y2, y3, t);\n  } // console.log(interval, i);\n\n\n  return mathSqrt$2(d);\n}\n/**\n * \n * @param  {number} p0\n * @param  {number} p1\n * @param  {number} p2\n * @param  {number} t\n * @return {number}\n */\n\nfunction quadraticAt(p0, p1, p2, t) {\n  var onet = 1 - t;\n  return onet * (onet * p0 + 2 * t * p1) + t * t * p2;\n}\n/**\n * \n * @param  {number} p0\n * @param  {number} p1\n * @param  {number} p2\n * @param  {number} t\n * @return {number}\n */\n\nfunction quadraticDerivativeAt(p0, p1, p2, t) {\n  return 2 * ((1 - t) * (p1 - p0) + t * (p2 - p1));\n}\n/**\n * \n * @param  {number} p0\n * @param  {number} p1\n * @param  {number} p2\n * @param  {number} t\n * @param  {Array.<number>} roots\n * @return {number} \n */\n\nfunction quadraticRootAt(p0, p1, p2, val, roots) {\n  var a = p0 - 2 * p1 + p2;\n  var b = 2 * (p1 - p0);\n  var c = p0 - val;\n  var n = 0;\n\n  if (isAroundZero(a)) {\n    if (isNotAroundZero$1(b)) {\n      var t1 = -c / b;\n\n      if (t1 >= 0 && t1 <= 1) {\n        roots[n++] = t1;\n      }\n    }\n  } else {\n    var disc = b * b - 4 * a * c;\n\n    if (isAroundZero(disc)) {\n      var t1 = -b / (2 * a);\n\n      if (t1 >= 0 && t1 <= 1) {\n        roots[n++] = t1;\n      }\n    } else if (disc > 0) {\n      var discSqrt = mathSqrt$2(disc);\n      var t1 = (-b + discSqrt) / (2 * a);\n      var t2 = (-b - discSqrt) / (2 * a);\n\n      if (t1 >= 0 && t1 <= 1) {\n        roots[n++] = t1;\n      }\n\n      if (t2 >= 0 && t2 <= 1) {\n        roots[n++] = t2;\n      }\n    }\n  }\n\n  return n;\n}\n/**\n * \n * @memberOf module:zrender/core/curve\n * @param  {number} p0\n * @param  {number} p1\n * @param  {number} p2\n * @return {number}\n */\n\nfunction quadraticExtremum(p0, p1, p2) {\n  var divider = p0 + p2 - 2 * p1;\n\n  if (divider === 0) {\n    // p1 is center of p0 and p2\n    return 0.5;\n  } else {\n    return (p0 - p1) / divider;\n  }\n}\n/**\n * \n * @memberOf module:zrender/core/curve\n * @param  {number} p0\n * @param  {number} p1\n * @param  {number} p2\n * @param  {number} t\n * @param  {Array.<number>} out\n */\n\nfunction quadraticSubdivide(p0, p1, p2, t, out) {\n  var p01 = (p1 - p0) * t + p0;\n  var p12 = (p2 - p1) * t + p1;\n  var p012 = (p12 - p01) * t + p01; // Seg0\n\n  out[0] = p0;\n  out[1] = p01;\n  out[2] = p012; // Seg1\n\n  out[3] = p012;\n  out[4] = p12;\n  out[5] = p2;\n}\n/**\n * \n * \n * @param {number} x0\n * @param {number} y0\n * @param {number} x1\n * @param {number} y1\n * @param {number} x2\n * @param {number} y2\n * @param {number} x\n * @param {number} y\n * @param {Array.<number>} out \n * @return {number}\n */\n\nfunction quadraticProjectPoint(x0, y0, x1, y1, x2, y2, x, y, out) {\n  // http://pomax.github.io/bezierinfo/#projections\n  var t;\n  var interval = 0.005;\n  var d = Infinity;\n  _v0[0] = x;\n  _v0[1] = y; //  t \n  // PENDING\n\n  for (var _t = 0; _t < 1; _t += 0.05) {\n    _v1[0] = quadraticAt(x0, x1, x2, _t);\n    _v1[1] = quadraticAt(y0, y1, y2, _t);\n    var d1 = distSquare(_v0, _v1);\n\n    if (d1 < d) {\n      t = _t;\n      d = d1;\n    }\n  }\n\n  d = Infinity; // At most 32 iteration\n\n  for (var i = 0; i < 32; i++) {\n    if (interval < EPSILON_NUMERIC) {\n      break;\n    }\n\n    var prev = t - interval;\n    var next = t + interval; // t - interval\n\n    _v1[0] = quadraticAt(x0, x1, x2, prev);\n    _v1[1] = quadraticAt(y0, y1, y2, prev);\n    var d1 = distSquare(_v1, _v0);\n\n    if (prev >= 0 && d1 < d) {\n      t = prev;\n      d = d1;\n    } else {\n      // t + interval\n      _v2[0] = quadraticAt(x0, x1, x2, next);\n      _v2[1] = quadraticAt(y0, y1, y2, next);\n      var d2 = distSquare(_v2, _v0);\n\n      if (next <= 1 && d2 < d) {\n        t = next;\n        d = d2;\n      } else {\n        interval *= 0.5;\n      }\n    }\n  } // t\n\n\n  if (out) {\n    out[0] = quadraticAt(x0, x1, x2, t);\n    out[1] = quadraticAt(y0, y1, y2, t);\n  } // console.log(interval, i);\n\n\n  return mathSqrt$2(d);\n}\n\n/**\n * @author Yi Shen(https://github.com/pissang)\n */\nvar mathMin$3 = Math.min;\nvar mathMax$3 = Math.max;\nvar mathSin$2 = Math.sin;\nvar mathCos$2 = Math.cos;\nvar PI2 = Math.PI * 2;\nvar start = create();\nvar end = create();\nvar extremity = create();\n/**\n * `min``max`\n * @module zrender/core/bbox\n * @param {Array<Object>} points \n * @param {number} min\n * @param {number} max\n */\n\nfunction fromPoints(points, min$$1, max$$1) {\n  if (points.length === 0) {\n    return;\n  }\n\n  var p = points[0];\n  var left = p[0];\n  var right = p[0];\n  var top = p[1];\n  var bottom = p[1];\n  var i;\n\n  for (i = 1; i < points.length; i++) {\n    p = points[i];\n    left = mathMin$3(left, p[0]);\n    right = mathMax$3(right, p[0]);\n    top = mathMin$3(top, p[1]);\n    bottom = mathMax$3(bottom, p[1]);\n  }\n\n  min$$1[0] = left;\n  min$$1[1] = top;\n  max$$1[0] = right;\n  max$$1[1] = bottom;\n}\n/**\n * @memberOf module:zrender/core/bbox\n * @param {number} x0\n * @param {number} y0\n * @param {number} x1\n * @param {number} y1\n * @param {Array.<number>} min\n * @param {Array.<number>} max\n */\n\nfunction fromLine(x0, y0, x1, y1, min$$1, max$$1) {\n  min$$1[0] = mathMin$3(x0, x1);\n  min$$1[1] = mathMin$3(y0, y1);\n  max$$1[0] = mathMax$3(x0, x1);\n  max$$1[1] = mathMax$3(y0, y1);\n}\nvar xDim = [];\nvar yDim = [];\n/**\n * (p0, p1, p2, p3)`min``max`\n * @memberOf module:zrender/core/bbox\n * @param {number} x0\n * @param {number} y0\n * @param {number} x1\n * @param {number} y1\n * @param {number} x2\n * @param {number} y2\n * @param {number} x3\n * @param {number} y3\n * @param {Array.<number>} min\n * @param {Array.<number>} max\n */\n\nfunction fromCubic(x0, y0, x1, y1, x2, y2, x3, y3, min$$1, max$$1) {\n  var cubicExtrema$$1 = cubicExtrema;\n  var cubicAt$$1 = cubicAt;\n  var i;\n  var n = cubicExtrema$$1(x0, x1, x2, x3, xDim);\n  min$$1[0] = Infinity;\n  min$$1[1] = Infinity;\n  max$$1[0] = -Infinity;\n  max$$1[1] = -Infinity;\n\n  for (i = 0; i < n; i++) {\n    var x = cubicAt$$1(x0, x1, x2, x3, xDim[i]);\n    min$$1[0] = mathMin$3(x, min$$1[0]);\n    max$$1[0] = mathMax$3(x, max$$1[0]);\n  }\n\n  n = cubicExtrema$$1(y0, y1, y2, y3, yDim);\n\n  for (i = 0; i < n; i++) {\n    var y = cubicAt$$1(y0, y1, y2, y3, yDim[i]);\n    min$$1[1] = mathMin$3(y, min$$1[1]);\n    max$$1[1] = mathMax$3(y, max$$1[1]);\n  }\n\n  min$$1[0] = mathMin$3(x0, min$$1[0]);\n  max$$1[0] = mathMax$3(x0, max$$1[0]);\n  min$$1[0] = mathMin$3(x3, min$$1[0]);\n  max$$1[0] = mathMax$3(x3, max$$1[0]);\n  min$$1[1] = mathMin$3(y0, min$$1[1]);\n  max$$1[1] = mathMax$3(y0, max$$1[1]);\n  min$$1[1] = mathMin$3(y3, min$$1[1]);\n  max$$1[1] = mathMax$3(y3, max$$1[1]);\n}\n/**\n * (p0, p1, p2)`min``max`\n * @memberOf module:zrender/core/bbox\n * @param {number} x0\n * @param {number} y0\n * @param {number} x1\n * @param {number} y1\n * @param {number} x2\n * @param {number} y2\n * @param {Array.<number>} min\n * @param {Array.<number>} max\n */\n\nfunction fromQuadratic(x0, y0, x1, y1, x2, y2, min$$1, max$$1) {\n  var quadraticExtremum$$1 = quadraticExtremum;\n  var quadraticAt$$1 = quadraticAt; // Find extremities, where derivative in x dim or y dim is zero\n\n  var tx = mathMax$3(mathMin$3(quadraticExtremum$$1(x0, x1, x2), 1), 0);\n  var ty = mathMax$3(mathMin$3(quadraticExtremum$$1(y0, y1, y2), 1), 0);\n  var x = quadraticAt$$1(x0, x1, x2, tx);\n  var y = quadraticAt$$1(y0, y1, y2, ty);\n  min$$1[0] = mathMin$3(x0, x2, x);\n  min$$1[1] = mathMin$3(y0, y2, y);\n  max$$1[0] = mathMax$3(x0, x2, x);\n  max$$1[1] = mathMax$3(y0, y2, y);\n}\n/**\n * `min``max`\n * @method\n * @memberOf module:zrender/core/bbox\n * @param {number} x\n * @param {number} y\n * @param {number} rx\n * @param {number} ry\n * @param {number} startAngle\n * @param {number} endAngle\n * @param {number} anticlockwise\n * @param {Array.<number>} min\n * @param {Array.<number>} max\n */\n\nfunction fromArc(x, y, rx, ry, startAngle, endAngle, anticlockwise, min$$1, max$$1) {\n  var vec2Min = min;\n  var vec2Max = max;\n  var diff = Math.abs(startAngle - endAngle);\n\n  if (diff % PI2 < 1e-4 && diff > 1e-4) {\n    // Is a circle\n    min$$1[0] = x - rx;\n    min$$1[1] = y - ry;\n    max$$1[0] = x + rx;\n    max$$1[1] = y + ry;\n    return;\n  }\n\n  start[0] = mathCos$2(startAngle) * rx + x;\n  start[1] = mathSin$2(startAngle) * ry + y;\n  end[0] = mathCos$2(endAngle) * rx + x;\n  end[1] = mathSin$2(endAngle) * ry + y;\n  vec2Min(min$$1, start, end);\n  vec2Max(max$$1, start, end); // Thresh to [0, Math.PI * 2]\n\n  startAngle = startAngle % PI2;\n\n  if (startAngle < 0) {\n    startAngle = startAngle + PI2;\n  }\n\n  endAngle = endAngle % PI2;\n\n  if (endAngle < 0) {\n    endAngle = endAngle + PI2;\n  }\n\n  if (startAngle > endAngle && !anticlockwise) {\n    endAngle += PI2;\n  } else if (startAngle < endAngle && anticlockwise) {\n    startAngle += PI2;\n  }\n\n  if (anticlockwise) {\n    var tmp = endAngle;\n    endAngle = startAngle;\n    startAngle = tmp;\n  } // var number = 0;\n  // var step = (anticlockwise ? -Math.PI : Math.PI) / 2;\n\n\n  for (var angle = 0; angle < endAngle; angle += Math.PI / 2) {\n    if (angle > startAngle) {\n      extremity[0] = mathCos$2(angle) * rx + x;\n      extremity[1] = mathSin$2(angle) * ry + y;\n      vec2Min(min$$1, extremity, min$$1);\n      vec2Max(max$$1, extremity, max$$1);\n    }\n  }\n}\n\n/**\n * Path `buildPath``ctx`, pathpathCommands\n *  isInsidePath boundingRect\n *\n * @module zrender/core/PathProxy\n * @author Yi Shen (http://www.github.com/pissang)\n */\n// TODO getTotalLength, getPointAtLength\nvar CMD = {\n  M: 1,\n  L: 2,\n  C: 3,\n  Q: 4,\n  A: 5,\n  Z: 6,\n  // Rect\n  R: 7\n}; // var CMD_MEM_SIZE = {\n//     M: 3,\n//     L: 3,\n//     C: 7,\n//     Q: 5,\n//     A: 9,\n//     R: 5,\n//     Z: 1\n// };\n\nvar min$1 = [];\nvar max$1 = [];\nvar min2 = [];\nvar max2 = [];\nvar mathMin$2 = Math.min;\nvar mathMax$2 = Math.max;\nvar mathCos$1 = Math.cos;\nvar mathSin$1 = Math.sin;\nvar mathSqrt$1 = Math.sqrt;\nvar mathAbs = Math.abs;\nvar hasTypedArray = typeof Float32Array != 'undefined';\n/**\n * @alias module:zrender/core/PathProxy\n * @constructor\n */\n\nvar PathProxy = function (notSaveData) {\n  this._saveData = !(notSaveData || false);\n\n  if (this._saveData) {\n    /**\n     * Path data. Stored as flat array\n     * @type {Array.<Object>}\n     */\n    this.data = [];\n  }\n\n  this._ctx = null;\n};\n/**\n * Path\n * @return {Object}\n */\n\n\nPathProxy.prototype = {\n  constructor: PathProxy,\n  _xi: 0,\n  _yi: 0,\n  _x0: 0,\n  _y0: 0,\n  // Unit x, Unit y. Provide for avoiding drawing that too short line segment\n  _ux: 0,\n  _uy: 0,\n  _len: 0,\n  _lineDash: null,\n  _dashOffset: 0,\n  _dashIdx: 0,\n  _dashSum: 0,\n\n  /**\n   * @readOnly\n   */\n  setScale: function (sx, sy) {\n    this._ux = mathAbs(1 / devicePixelRatio / sx) || 0;\n    this._uy = mathAbs(1 / devicePixelRatio / sy) || 0;\n  },\n  getContext: function () {\n    return this._ctx;\n  },\n\n  /**\n   * @param  {CanvasRenderingContext2D} ctx\n   * @return {module:zrender/core/PathProxy}\n   */\n  beginPath: function (ctx) {\n    this._ctx = ctx;\n    ctx && ctx.beginPath();\n    ctx && (this.dpr = ctx.dpr); // Reset\n\n    if (this._saveData) {\n      this._len = 0;\n    }\n\n    if (this._lineDash) {\n      this._lineDash = null;\n      this._dashOffset = 0;\n    }\n\n    return this;\n  },\n\n  /**\n   * @param  {number} x\n   * @param  {number} y\n   * @return {module:zrender/core/PathProxy}\n   */\n  moveTo: function (x, y) {\n    this.addData(CMD.M, x, y);\n    this._ctx && this._ctx.moveTo(x, y); // x0, y0, xi, yi  _dashedXXXXTo \n    // xi, yi , x0, y0  closePath \n    //  beginPath  lineTo x0, y0 \n    //  lineTo dashed line  IE10- \n\n    this._x0 = x;\n    this._y0 = y;\n    this._xi = x;\n    this._yi = y;\n    return this;\n  },\n\n  /**\n   * @param  {number} x\n   * @param  {number} y\n   * @return {module:zrender/core/PathProxy}\n   */\n  lineTo: function (x, y) {\n    var exceedUnit = mathAbs(x - this._xi) > this._ux || mathAbs(y - this._yi) > this._uy // Force draw the first segment\n    || this._len < 5;\n    this.addData(CMD.L, x, y);\n\n    if (this._ctx && exceedUnit) {\n      this._needsDash() ? this._dashedLineTo(x, y) : this._ctx.lineTo(x, y);\n    }\n\n    if (exceedUnit) {\n      this._xi = x;\n      this._yi = y;\n    }\n\n    return this;\n  },\n\n  /**\n   * @param  {number} x1\n   * @param  {number} y1\n   * @param  {number} x2\n   * @param  {number} y2\n   * @param  {number} x3\n   * @param  {number} y3\n   * @return {module:zrender/core/PathProxy}\n   */\n  bezierCurveTo: function (x1, y1, x2, y2, x3, y3) {\n    this.addData(CMD.C, x1, y1, x2, y2, x3, y3);\n\n    if (this._ctx) {\n      this._needsDash() ? this._dashedBezierTo(x1, y1, x2, y2, x3, y3) : this._ctx.bezierCurveTo(x1, y1, x2, y2, x3, y3);\n    }\n\n    this._xi = x3;\n    this._yi = y3;\n    return this;\n  },\n\n  /**\n   * @param  {number} x1\n   * @param  {number} y1\n   * @param  {number} x2\n   * @param  {number} y2\n   * @return {module:zrender/core/PathProxy}\n   */\n  quadraticCurveTo: function (x1, y1, x2, y2) {\n    this.addData(CMD.Q, x1, y1, x2, y2);\n\n    if (this._ctx) {\n      this._needsDash() ? this._dashedQuadraticTo(x1, y1, x2, y2) : this._ctx.quadraticCurveTo(x1, y1, x2, y2);\n    }\n\n    this._xi = x2;\n    this._yi = y2;\n    return this;\n  },\n\n  /**\n   * @param  {number} cx\n   * @param  {number} cy\n   * @param  {number} r\n   * @param  {number} startAngle\n   * @param  {number} endAngle\n   * @param  {boolean} anticlockwise\n   * @return {module:zrender/core/PathProxy}\n   */\n  arc: function (cx, cy, r, startAngle, endAngle, anticlockwise) {\n    this.addData(CMD.A, cx, cy, r, r, startAngle, endAngle - startAngle, 0, anticlockwise ? 0 : 1);\n    this._ctx && this._ctx.arc(cx, cy, r, startAngle, endAngle, anticlockwise);\n    this._xi = mathCos$1(endAngle) * r + cx;\n    this._yi = mathSin$1(endAngle) * r + cx;\n    return this;\n  },\n  // TODO\n  arcTo: function (x1, y1, x2, y2, radius) {\n    if (this._ctx) {\n      this._ctx.arcTo(x1, y1, x2, y2, radius);\n    }\n\n    return this;\n  },\n  // TODO\n  rect: function (x, y, w, h) {\n    this._ctx && this._ctx.rect(x, y, w, h);\n    this.addData(CMD.R, x, y, w, h);\n    return this;\n  },\n\n  /**\n   * @return {module:zrender/core/PathProxy}\n   */\n  closePath: function () {\n    this.addData(CMD.Z);\n    var ctx = this._ctx;\n    var x0 = this._x0;\n    var y0 = this._y0;\n\n    if (ctx) {\n      this._needsDash() && this._dashedLineTo(x0, y0);\n      ctx.closePath();\n    }\n\n    this._xi = x0;\n    this._yi = y0;\n    return this;\n  },\n\n  /**\n   * Context  rebuildPath  fill\n   * stroke \n   * @param {CanvasRenderingContext2D} ctx\n   * @return {module:zrender/core/PathProxy}\n   */\n  fill: function (ctx) {\n    ctx && ctx.fill();\n    this.toStatic();\n  },\n\n  /**\n   * @param {CanvasRenderingContext2D} ctx\n   * @return {module:zrender/core/PathProxy}\n   */\n  stroke: function (ctx) {\n    ctx && ctx.stroke();\n    this.toStatic();\n  },\n\n  /**\n   * \n   * Must be invoked before all other path drawing methods\n   * @return {module:zrender/core/PathProxy}\n   */\n  setLineDash: function (lineDash) {\n    if (lineDash instanceof Array) {\n      this._lineDash = lineDash;\n      this._dashIdx = 0;\n      var lineDashSum = 0;\n\n      for (var i = 0; i < lineDash.length; i++) {\n        lineDashSum += lineDash[i];\n      }\n\n      this._dashSum = lineDashSum;\n    }\n\n    return this;\n  },\n\n  /**\n   * \n   * Must be invoked before all other path drawing methods\n   * @return {module:zrender/core/PathProxy}\n   */\n  setLineDashOffset: function (offset) {\n    this._dashOffset = offset;\n    return this;\n  },\n\n  /**\n   *\n   * @return {boolean}\n   */\n  len: function () {\n    return this._len;\n  },\n\n  /**\n   *  Path \n   */\n  setData: function (data) {\n    var len$$1 = data.length;\n\n    if (!(this.data && this.data.length == len$$1) && hasTypedArray) {\n      this.data = new Float32Array(len$$1);\n    }\n\n    for (var i = 0; i < len$$1; i++) {\n      this.data[i] = data[i];\n    }\n\n    this._len = len$$1;\n  },\n\n  /**\n   * \n   * @param {module:zrender/core/PathProxy|Array.<module:zrender/core/PathProxy>} path\n   */\n  appendPath: function (path) {\n    if (!(path instanceof Array)) {\n      path = [path];\n    }\n\n    var len$$1 = path.length;\n    var appendSize = 0;\n    var offset = this._len;\n\n    for (var i = 0; i < len$$1; i++) {\n      appendSize += path[i].len();\n    }\n\n    if (hasTypedArray && this.data instanceof Float32Array) {\n      this.data = new Float32Array(offset + appendSize);\n    }\n\n    for (var i = 0; i < len$$1; i++) {\n      var appendPathData = path[i].data;\n\n      for (var k = 0; k < appendPathData.length; k++) {\n        this.data[offset++] = appendPathData[k];\n      }\n    }\n\n    this._len = offset;\n  },\n\n  /**\n   *  Path \n   * \n   */\n  addData: function (cmd) {\n    if (!this._saveData) {\n      return;\n    }\n\n    var data = this.data;\n\n    if (this._len + arguments.length > data.length) {\n      //  Float32Array\n      // \n      this._expandData();\n\n      data = this.data;\n    }\n\n    for (var i = 0; i < arguments.length; i++) {\n      data[this._len++] = arguments[i];\n    }\n\n    this._prevCmd = cmd;\n  },\n  _expandData: function () {\n    // Only if data is Float32Array\n    if (!(this.data instanceof Array)) {\n      var newData = [];\n\n      for (var i = 0; i < this._len; i++) {\n        newData[i] = this.data[i];\n      }\n\n      this.data = newData;\n    }\n  },\n\n  /**\n   * If needs js implemented dashed line\n   * @return {boolean}\n   * @private\n   */\n  _needsDash: function () {\n    return this._lineDash;\n  },\n  _dashedLineTo: function (x1, y1) {\n    var dashSum = this._dashSum;\n    var offset = this._dashOffset;\n    var lineDash = this._lineDash;\n    var ctx = this._ctx;\n    var x0 = this._xi;\n    var y0 = this._yi;\n    var dx = x1 - x0;\n    var dy = y1 - y0;\n    var dist$$1 = mathSqrt$1(dx * dx + dy * dy);\n    var x = x0;\n    var y = y0;\n    var dash;\n    var nDash = lineDash.length;\n    var idx;\n    dx /= dist$$1;\n    dy /= dist$$1;\n\n    if (offset < 0) {\n      // Convert to positive offset\n      offset = dashSum + offset;\n    }\n\n    offset %= dashSum;\n    x -= offset * dx;\n    y -= offset * dy;\n\n    while (dx > 0 && x <= x1 || dx < 0 && x >= x1 || dx == 0 && (dy > 0 && y <= y1 || dy < 0 && y >= y1)) {\n      idx = this._dashIdx;\n      dash = lineDash[idx];\n      x += dx * dash;\n      y += dy * dash;\n      this._dashIdx = (idx + 1) % nDash; // Skip positive offset\n\n      if (dx > 0 && x < x0 || dx < 0 && x > x0 || dy > 0 && y < y0 || dy < 0 && y > y0) {\n        continue;\n      }\n\n      ctx[idx % 2 ? 'moveTo' : 'lineTo'](dx >= 0 ? mathMin$2(x, x1) : mathMax$2(x, x1), dy >= 0 ? mathMin$2(y, y1) : mathMax$2(y, y1));\n    } // Offset for next lineTo\n\n\n    dx = x - x1;\n    dy = y - y1;\n    this._dashOffset = -mathSqrt$1(dx * dx + dy * dy);\n  },\n  // Not accurate dashed line to\n  _dashedBezierTo: function (x1, y1, x2, y2, x3, y3) {\n    var dashSum = this._dashSum;\n    var offset = this._dashOffset;\n    var lineDash = this._lineDash;\n    var ctx = this._ctx;\n    var x0 = this._xi;\n    var y0 = this._yi;\n    var t;\n    var dx;\n    var dy;\n    var cubicAt$$1 = cubicAt;\n    var bezierLen = 0;\n    var idx = this._dashIdx;\n    var nDash = lineDash.length;\n    var x;\n    var y;\n    var tmpLen = 0;\n\n    if (offset < 0) {\n      // Convert to positive offset\n      offset = dashSum + offset;\n    }\n\n    offset %= dashSum; // Bezier approx length\n\n    for (t = 0; t < 1; t += 0.1) {\n      dx = cubicAt$$1(x0, x1, x2, x3, t + 0.1) - cubicAt$$1(x0, x1, x2, x3, t);\n      dy = cubicAt$$1(y0, y1, y2, y3, t + 0.1) - cubicAt$$1(y0, y1, y2, y3, t);\n      bezierLen += mathSqrt$1(dx * dx + dy * dy);\n    } // Find idx after add offset\n\n\n    for (; idx < nDash; idx++) {\n      tmpLen += lineDash[idx];\n\n      if (tmpLen > offset) {\n        break;\n      }\n    }\n\n    t = (tmpLen - offset) / bezierLen;\n\n    while (t <= 1) {\n      x = cubicAt$$1(x0, x1, x2, x3, t);\n      y = cubicAt$$1(y0, y1, y2, y3, t); // Use line to approximate dashed bezier\n      // Bad result if dash is long\n\n      idx % 2 ? ctx.moveTo(x, y) : ctx.lineTo(x, y);\n      t += lineDash[idx] / bezierLen;\n      idx = (idx + 1) % nDash;\n    } // Finish the last segment and calculate the new offset\n\n\n    idx % 2 !== 0 && ctx.lineTo(x3, y3);\n    dx = x3 - x;\n    dy = y3 - y;\n    this._dashOffset = -mathSqrt$1(dx * dx + dy * dy);\n  },\n  _dashedQuadraticTo: function (x1, y1, x2, y2) {\n    // Convert quadratic to cubic using degree elevation\n    var x3 = x2;\n    var y3 = y2;\n    x2 = (x2 + 2 * x1) / 3;\n    y2 = (y2 + 2 * y1) / 3;\n    x1 = (this._xi + 2 * x1) / 3;\n    y1 = (this._yi + 2 * y1) / 3;\n\n    this._dashedBezierTo(x1, y1, x2, y2, x3, y3);\n  },\n\n  /**\n   *  Float32Array \n   * Convert dynamic array to static Float32Array\n   */\n  toStatic: function () {\n    var data = this.data;\n\n    if (data instanceof Array) {\n      data.length = this._len;\n\n      if (hasTypedArray) {\n        this.data = new Float32Array(data);\n      }\n    }\n  },\n\n  /**\n   * @return {module:zrender/core/BoundingRect}\n   */\n  getBoundingRect: function () {\n    min$1[0] = min$1[1] = min2[0] = min2[1] = Number.MAX_VALUE;\n    max$1[0] = max$1[1] = max2[0] = max2[1] = -Number.MAX_VALUE;\n    var data = this.data;\n    var xi = 0;\n    var yi = 0;\n    var x0 = 0;\n    var y0 = 0;\n\n    for (var i = 0; i < data.length;) {\n      var cmd = data[i++];\n\n      if (i == 1) {\n        //  L, C, Q\n        //  previous point  point\n        //\n        //  Arc \n        xi = data[i];\n        yi = data[i + 1];\n        x0 = xi;\n        y0 = yi;\n      }\n\n      switch (cmd) {\n        case CMD.M:\n          // moveTo  subpath, \n          //  closePath \n          x0 = data[i++];\n          y0 = data[i++];\n          xi = x0;\n          yi = y0;\n          min2[0] = x0;\n          min2[1] = y0;\n          max2[0] = x0;\n          max2[1] = y0;\n          break;\n\n        case CMD.L:\n          fromLine(xi, yi, data[i], data[i + 1], min2, max2);\n          xi = data[i++];\n          yi = data[i++];\n          break;\n\n        case CMD.C:\n          fromCubic(xi, yi, data[i++], data[i++], data[i++], data[i++], data[i], data[i + 1], min2, max2);\n          xi = data[i++];\n          yi = data[i++];\n          break;\n\n        case CMD.Q:\n          fromQuadratic(xi, yi, data[i++], data[i++], data[i], data[i + 1], min2, max2);\n          xi = data[i++];\n          yi = data[i++];\n          break;\n\n        case CMD.A:\n          // TODO Arc \n          var cx = data[i++];\n          var cy = data[i++];\n          var rx = data[i++];\n          var ry = data[i++];\n          var startAngle = data[i++];\n          var endAngle = data[i++] + startAngle; // TODO Arc \n\n          var psi = data[i++];\n          var anticlockwise = 1 - data[i++];\n\n          if (i == 1) {\n            //  arc \n            // \n            x0 = mathCos$1(startAngle) * rx + cx;\n            y0 = mathSin$1(startAngle) * ry + cy;\n          }\n\n          fromArc(cx, cy, rx, ry, startAngle, endAngle, anticlockwise, min2, max2);\n          xi = mathCos$1(endAngle) * rx + cx;\n          yi = mathSin$1(endAngle) * ry + cy;\n          break;\n\n        case CMD.R:\n          x0 = xi = data[i++];\n          y0 = yi = data[i++];\n          var width = data[i++];\n          var height = data[i++]; // Use fromLine\n\n          fromLine(x0, y0, x0 + width, y0 + height, min2, max2);\n          break;\n\n        case CMD.Z:\n          xi = x0;\n          yi = y0;\n          break;\n      } // Union\n\n\n      min(min$1, min$1, min2);\n      max(max$1, max$1, max2);\n    } // No data\n\n\n    if (i === 0) {\n      min$1[0] = min$1[1] = max$1[0] = max$1[1] = 0;\n    }\n\n    return new BoundingRect(min$1[0], min$1[1], max$1[0] - min$1[0], max$1[1] - min$1[1]);\n  },\n\n  /**\n   * Rebuild path from current data\n   * Rebuild path will not consider javascript implemented line dash.\n   * @param {CanvasRenderingContext2D} ctx\n   */\n  rebuildPath: function (ctx) {\n    var d = this.data;\n    var x0, y0;\n    var xi, yi;\n    var x, y;\n    var ux = this._ux;\n    var uy = this._uy;\n    var len$$1 = this._len;\n\n    for (var i = 0; i < len$$1;) {\n      var cmd = d[i++];\n\n      if (i == 1) {\n        //  L, C, Q\n        //  previous point  point\n        //\n        //  Arc \n        xi = d[i];\n        yi = d[i + 1];\n        x0 = xi;\n        y0 = yi;\n      }\n\n      switch (cmd) {\n        case CMD.M:\n          x0 = xi = d[i++];\n          y0 = yi = d[i++];\n          ctx.moveTo(xi, yi);\n          break;\n\n        case CMD.L:\n          x = d[i++];\n          y = d[i++]; // Not draw too small seg between\n\n          if (mathAbs(x - xi) > ux || mathAbs(y - yi) > uy || i === len$$1 - 1) {\n            ctx.lineTo(x, y);\n            xi = x;\n            yi = y;\n          }\n\n          break;\n\n        case CMD.C:\n          ctx.bezierCurveTo(d[i++], d[i++], d[i++], d[i++], d[i++], d[i++]);\n          xi = d[i - 2];\n          yi = d[i - 1];\n          break;\n\n        case CMD.Q:\n          ctx.quadraticCurveTo(d[i++], d[i++], d[i++], d[i++]);\n          xi = d[i - 2];\n          yi = d[i - 1];\n          break;\n\n        case CMD.A:\n          var cx = d[i++];\n          var cy = d[i++];\n          var rx = d[i++];\n          var ry = d[i++];\n          var theta = d[i++];\n          var dTheta = d[i++];\n          var psi = d[i++];\n          var fs = d[i++];\n          var r = rx > ry ? rx : ry;\n          var scaleX = rx > ry ? 1 : rx / ry;\n          var scaleY = rx > ry ? ry / rx : 1;\n          var isEllipse = Math.abs(rx - ry) > 1e-3;\n          var endAngle = theta + dTheta;\n\n          if (isEllipse) {\n            ctx.translate(cx, cy);\n            ctx.rotate(psi);\n            ctx.scale(scaleX, scaleY);\n            ctx.arc(0, 0, r, theta, endAngle, 1 - fs);\n            ctx.scale(1 / scaleX, 1 / scaleY);\n            ctx.rotate(-psi);\n            ctx.translate(-cx, -cy);\n          } else {\n            ctx.arc(cx, cy, r, theta, endAngle, 1 - fs);\n          }\n\n          if (i == 1) {\n            //  arc \n            // \n            x0 = mathCos$1(theta) * rx + cx;\n            y0 = mathSin$1(theta) * ry + cy;\n          }\n\n          xi = mathCos$1(endAngle) * rx + cx;\n          yi = mathSin$1(endAngle) * ry + cy;\n          break;\n\n        case CMD.R:\n          x0 = xi = d[i];\n          y0 = yi = d[i + 1];\n          ctx.rect(d[i++], d[i++], d[i++], d[i++]);\n          break;\n\n        case CMD.Z:\n          ctx.closePath();\n          xi = x0;\n          yi = y0;\n      }\n    }\n  }\n};\nPathProxy.CMD = CMD;\n\n/**\n * \n * @param  {number}  x0\n * @param  {number}  y0\n * @param  {number}  x1\n * @param  {number}  y1\n * @param  {number}  lineWidth\n * @param  {number}  x\n * @param  {number}  y\n * @return {boolean}\n */\nfunction containStroke$1(x0, y0, x1, y1, lineWidth, x, y) {\n  if (lineWidth === 0) {\n    return false;\n  }\n\n  var _l = lineWidth;\n  var _a = 0;\n  var _b = x0; // Quick reject\n\n  if (y > y0 + _l && y > y1 + _l || y < y0 - _l && y < y1 - _l || x > x0 + _l && x > x1 + _l || x < x0 - _l && x < x1 - _l) {\n    return false;\n  }\n\n  if (x0 !== x1) {\n    _a = (y0 - y1) / (x0 - x1);\n    _b = (x0 * y1 - x1 * y0) / (x0 - x1);\n  } else {\n    return Math.abs(x - x0) <= _l / 2;\n  }\n\n  var tmp = _a * x - y + _b;\n\n  var _s = tmp * tmp / (_a * _a + 1);\n\n  return _s <= _l / 2 * _l / 2;\n}\n\n/**\n * \n * @param  {number}  x0\n * @param  {number}  y0\n * @param  {number}  x1\n * @param  {number}  y1\n * @param  {number}  x2\n * @param  {number}  y2\n * @param  {number}  x3\n * @param  {number}  y3\n * @param  {number}  lineWidth\n * @param  {number}  x\n * @param  {number}  y\n * @return {boolean}\n */\n\nfunction containStroke$2(x0, y0, x1, y1, x2, y2, x3, y3, lineWidth, x, y) {\n  if (lineWidth === 0) {\n    return false;\n  }\n\n  var _l = lineWidth; // Quick reject\n\n  if (y > y0 + _l && y > y1 + _l && y > y2 + _l && y > y3 + _l || y < y0 - _l && y < y1 - _l && y < y2 - _l && y < y3 - _l || x > x0 + _l && x > x1 + _l && x > x2 + _l && x > x3 + _l || x < x0 - _l && x < x1 - _l && x < x2 - _l && x < x3 - _l) {\n    return false;\n  }\n\n  var d = cubicProjectPoint(x0, y0, x1, y1, x2, y2, x3, y3, x, y, null);\n  return d <= _l / 2;\n}\n\n/**\n * \n * @param  {number}  x0\n * @param  {number}  y0\n * @param  {number}  x1\n * @param  {number}  y1\n * @param  {number}  x2\n * @param  {number}  y2\n * @param  {number}  lineWidth\n * @param  {number}  x\n * @param  {number}  y\n * @return {boolean}\n */\n\nfunction containStroke$3(x0, y0, x1, y1, x2, y2, lineWidth, x, y) {\n  if (lineWidth === 0) {\n    return false;\n  }\n\n  var _l = lineWidth; // Quick reject\n\n  if (y > y0 + _l && y > y1 + _l && y > y2 + _l || y < y0 - _l && y < y1 - _l && y < y2 - _l || x > x0 + _l && x > x1 + _l && x > x2 + _l || x < x0 - _l && x < x1 - _l && x < x2 - _l) {\n    return false;\n  }\n\n  var d = quadraticProjectPoint(x0, y0, x1, y1, x2, y2, x, y, null);\n  return d <= _l / 2;\n}\n\nvar PI2$3 = Math.PI * 2;\nfunction normalizeRadian(angle) {\n  angle %= PI2$3;\n\n  if (angle < 0) {\n    angle += PI2$3;\n  }\n\n  return angle;\n}\n\nvar PI2$2 = Math.PI * 2;\n/**\n * \n * @param  {number}  cx\n * @param  {number}  cy\n * @param  {number}  r\n * @param  {number}  startAngle\n * @param  {number}  endAngle\n * @param  {boolean}  anticlockwise\n * @param  {number} lineWidth\n * @param  {number}  x\n * @param  {number}  y\n * @return {Boolean}\n */\n\nfunction containStroke$4(cx, cy, r, startAngle, endAngle, anticlockwise, lineWidth, x, y) {\n  if (lineWidth === 0) {\n    return false;\n  }\n\n  var _l = lineWidth;\n  x -= cx;\n  y -= cy;\n  var d = Math.sqrt(x * x + y * y);\n\n  if (d - _l > r || d + _l < r) {\n    return false;\n  }\n\n  if (Math.abs(startAngle - endAngle) % PI2$2 < 1e-4) {\n    // Is a circle\n    return true;\n  }\n\n  if (anticlockwise) {\n    var tmp = startAngle;\n    startAngle = normalizeRadian(endAngle);\n    endAngle = normalizeRadian(tmp);\n  } else {\n    startAngle = normalizeRadian(startAngle);\n    endAngle = normalizeRadian(endAngle);\n  }\n\n  if (startAngle > endAngle) {\n    endAngle += PI2$2;\n  }\n\n  var angle = Math.atan2(y, x);\n\n  if (angle < 0) {\n    angle += PI2$2;\n  }\n\n  return angle >= startAngle && angle <= endAngle || angle + PI2$2 >= startAngle && angle + PI2$2 <= endAngle;\n}\n\nfunction windingLine(x0, y0, x1, y1, x, y) {\n  if (y > y0 && y > y1 || y < y0 && y < y1) {\n    return 0;\n  } // Ignore horizontal line\n\n\n  if (y1 === y0) {\n    return 0;\n  }\n\n  var dir = y1 < y0 ? 1 : -1;\n  var t = (y - y0) / (y1 - y0); // Avoid winding error when intersection point is the connect point of two line of polygon\n\n  if (t === 1 || t === 0) {\n    dir = y1 < y0 ? 0.5 : -0.5;\n  }\n\n  var x_ = t * (x1 - x0) + x0; // If (x, y) on the line, considered as \"contain\".\n\n  return x_ === x ? Infinity : x_ > x ? dir : 0;\n}\n\nvar CMD$1 = PathProxy.CMD;\nvar PI2$1 = Math.PI * 2;\nvar EPSILON$2 = 1e-4;\n\nfunction isAroundEqual(a, b) {\n  return Math.abs(a - b) < EPSILON$2;\n} // \n\n\nvar roots = [-1, -1, -1];\nvar extrema = [-1, -1];\n\nfunction swapExtrema() {\n  var tmp = extrema[0];\n  extrema[0] = extrema[1];\n  extrema[1] = tmp;\n}\n\nfunction windingCubic(x0, y0, x1, y1, x2, y2, x3, y3, x, y) {\n  // Quick reject\n  if (y > y0 && y > y1 && y > y2 && y > y3 || y < y0 && y < y1 && y < y2 && y < y3) {\n    return 0;\n  }\n\n  var nRoots = cubicRootAt(y0, y1, y2, y3, y, roots);\n\n  if (nRoots === 0) {\n    return 0;\n  } else {\n    var w = 0;\n    var nExtrema = -1;\n    var y0_, y1_;\n\n    for (var i = 0; i < nRoots; i++) {\n      var t = roots[i]; // Avoid winding error when intersection point is the connect point of two line of polygon\n\n      var unit = t === 0 || t === 1 ? 0.5 : 1;\n      var x_ = cubicAt(x0, x1, x2, x3, t);\n\n      if (x_ < x) {\n        // Quick reject\n        continue;\n      }\n\n      if (nExtrema < 0) {\n        nExtrema = cubicExtrema(y0, y1, y2, y3, extrema);\n\n        if (extrema[1] < extrema[0] && nExtrema > 1) {\n          swapExtrema();\n        }\n\n        y0_ = cubicAt(y0, y1, y2, y3, extrema[0]);\n\n        if (nExtrema > 1) {\n          y1_ = cubicAt(y0, y1, y2, y3, extrema[1]);\n        }\n      }\n\n      if (nExtrema == 2) {\n        // \n        if (t < extrema[0]) {\n          w += y0_ < y0 ? unit : -unit;\n        } else if (t < extrema[1]) {\n          w += y1_ < y0_ ? unit : -unit;\n        } else {\n          w += y3 < y1_ ? unit : -unit;\n        }\n      } else {\n        // \n        if (t < extrema[0]) {\n          w += y0_ < y0 ? unit : -unit;\n        } else {\n          w += y3 < y0_ ? unit : -unit;\n        }\n      }\n    }\n\n    return w;\n  }\n}\n\nfunction windingQuadratic(x0, y0, x1, y1, x2, y2, x, y) {\n  // Quick reject\n  if (y > y0 && y > y1 && y > y2 || y < y0 && y < y1 && y < y2) {\n    return 0;\n  }\n\n  var nRoots = quadraticRootAt(y0, y1, y2, y, roots);\n\n  if (nRoots === 0) {\n    return 0;\n  } else {\n    var t = quadraticExtremum(y0, y1, y2);\n\n    if (t >= 0 && t <= 1) {\n      var w = 0;\n      var y_ = quadraticAt(y0, y1, y2, t);\n\n      for (var i = 0; i < nRoots; i++) {\n        // Remove one endpoint.\n        var unit = roots[i] === 0 || roots[i] === 1 ? 0.5 : 1;\n        var x_ = quadraticAt(x0, x1, x2, roots[i]);\n\n        if (x_ < x) {\n          // Quick reject\n          continue;\n        }\n\n        if (roots[i] < t) {\n          w += y_ < y0 ? unit : -unit;\n        } else {\n          w += y2 < y_ ? unit : -unit;\n        }\n      }\n\n      return w;\n    } else {\n      // Remove one endpoint.\n      var unit = roots[0] === 0 || roots[0] === 1 ? 0.5 : 1;\n      var x_ = quadraticAt(x0, x1, x2, roots[0]);\n\n      if (x_ < x) {\n        // Quick reject\n        return 0;\n      }\n\n      return y2 < y0 ? unit : -unit;\n    }\n  }\n} // TODO\n// Arc \n\n\nfunction windingArc(cx, cy, r, startAngle, endAngle, anticlockwise, x, y) {\n  y -= cy;\n\n  if (y > r || y < -r) {\n    return 0;\n  }\n\n  var tmp = Math.sqrt(r * r - y * y);\n  roots[0] = -tmp;\n  roots[1] = tmp;\n  var diff = Math.abs(startAngle - endAngle);\n\n  if (diff < 1e-4) {\n    return 0;\n  }\n\n  if (diff % PI2$1 < 1e-4) {\n    // Is a circle\n    startAngle = 0;\n    endAngle = PI2$1;\n    var dir = anticlockwise ? 1 : -1;\n\n    if (x >= roots[0] + cx && x <= roots[1] + cx) {\n      return dir;\n    } else {\n      return 0;\n    }\n  }\n\n  if (anticlockwise) {\n    var tmp = startAngle;\n    startAngle = normalizeRadian(endAngle);\n    endAngle = normalizeRadian(tmp);\n  } else {\n    startAngle = normalizeRadian(startAngle);\n    endAngle = normalizeRadian(endAngle);\n  }\n\n  if (startAngle > endAngle) {\n    endAngle += PI2$1;\n  }\n\n  var w = 0;\n\n  for (var i = 0; i < 2; i++) {\n    var x_ = roots[i];\n\n    if (x_ + cx > x) {\n      var angle = Math.atan2(y, x_);\n      var dir = anticlockwise ? 1 : -1;\n\n      if (angle < 0) {\n        angle = PI2$1 + angle;\n      }\n\n      if (angle >= startAngle && angle <= endAngle || angle + PI2$1 >= startAngle && angle + PI2$1 <= endAngle) {\n        if (angle > Math.PI / 2 && angle < Math.PI * 1.5) {\n          dir = -dir;\n        }\n\n        w += dir;\n      }\n    }\n  }\n\n  return w;\n}\n\nfunction containPath(data, lineWidth, isStroke, x, y) {\n  var w = 0;\n  var xi = 0;\n  var yi = 0;\n  var x0 = 0;\n  var y0 = 0;\n\n  for (var i = 0; i < data.length;) {\n    var cmd = data[i++]; // Begin a new subpath\n\n    if (cmd === CMD$1.M && i > 1) {\n      // Close previous subpath\n      if (!isStroke) {\n        w += windingLine(xi, yi, x0, y0, x, y);\n      } //  subpath \n      // if (w !== 0) {\n      //     return true;\n      // }\n\n    }\n\n    if (i == 1) {\n      //  L, C, Q\n      //  previous point  point\n      //\n      //  Arc \n      xi = data[i];\n      yi = data[i + 1];\n      x0 = xi;\n      y0 = yi;\n    }\n\n    switch (cmd) {\n      case CMD$1.M:\n        // moveTo  subpath, \n        //  closePath \n        x0 = data[i++];\n        y0 = data[i++];\n        xi = x0;\n        yi = y0;\n        break;\n\n      case CMD$1.L:\n        if (isStroke) {\n          if (containStroke$1(xi, yi, data[i], data[i + 1], lineWidth, x, y)) {\n            return true;\n          }\n        } else {\n          // NOTE  L, C, Q  NaN\n          w += windingLine(xi, yi, data[i], data[i + 1], x, y) || 0;\n        }\n\n        xi = data[i++];\n        yi = data[i++];\n        break;\n\n      case CMD$1.C:\n        if (isStroke) {\n          if (containStroke$2(xi, yi, data[i++], data[i++], data[i++], data[i++], data[i], data[i + 1], lineWidth, x, y)) {\n            return true;\n          }\n        } else {\n          w += windingCubic(xi, yi, data[i++], data[i++], data[i++], data[i++], data[i], data[i + 1], x, y) || 0;\n        }\n\n        xi = data[i++];\n        yi = data[i++];\n        break;\n\n      case CMD$1.Q:\n        if (isStroke) {\n          if (containStroke$3(xi, yi, data[i++], data[i++], data[i], data[i + 1], lineWidth, x, y)) {\n            return true;\n          }\n        } else {\n          w += windingQuadratic(xi, yi, data[i++], data[i++], data[i], data[i + 1], x, y) || 0;\n        }\n\n        xi = data[i++];\n        yi = data[i++];\n        break;\n\n      case CMD$1.A:\n        // TODO Arc \n        var cx = data[i++];\n        var cy = data[i++];\n        var rx = data[i++];\n        var ry = data[i++];\n        var theta = data[i++];\n        var dTheta = data[i++]; // TODO Arc \n\n        var psi = data[i++];\n        var anticlockwise = 1 - data[i++];\n        var x1 = Math.cos(theta) * rx + cx;\n        var y1 = Math.sin(theta) * ry + cy; //  arc \n\n        if (i > 1) {\n          w += windingLine(xi, yi, x1, y1, x, y);\n        } else {\n          // \n          x0 = x1;\n          y0 = y1;\n        } // zr scale, x\n\n\n        var _x = (x - cx) * ry / rx + cx;\n\n        if (isStroke) {\n          if (containStroke$4(cx, cy, ry, theta, theta + dTheta, anticlockwise, lineWidth, _x, y)) {\n            return true;\n          }\n        } else {\n          w += windingArc(cx, cy, ry, theta, theta + dTheta, anticlockwise, _x, y);\n        }\n\n        xi = Math.cos(theta + dTheta) * rx + cx;\n        yi = Math.sin(theta + dTheta) * ry + cy;\n        break;\n\n      case CMD$1.R:\n        x0 = xi = data[i++];\n        y0 = yi = data[i++];\n        var width = data[i++];\n        var height = data[i++];\n        var x1 = x0 + width;\n        var y1 = y0 + height;\n\n        if (isStroke) {\n          if (containStroke$1(x0, y0, x1, y0, lineWidth, x, y) || containStroke$1(x1, y0, x1, y1, lineWidth, x, y) || containStroke$1(x1, y1, x0, y1, lineWidth, x, y) || containStroke$1(x0, y1, x0, y0, lineWidth, x, y)) {\n            return true;\n          }\n        } else {\n          // FIXME Clockwise ?\n          w += windingLine(x1, y0, x1, y1, x, y);\n          w += windingLine(x0, y1, x0, y0, x, y);\n        }\n\n        break;\n\n      case CMD$1.Z:\n        if (isStroke) {\n          if (containStroke$1(xi, yi, x0, y0, lineWidth, x, y)) {\n            return true;\n          }\n        } else {\n          // Close a subpath\n          w += windingLine(xi, yi, x0, y0, x, y); //  subpath \n          // FIXME subpaths may overlap\n          // if (w !== 0) {\n          //     return true;\n          // }\n        }\n\n        xi = x0;\n        yi = y0;\n        break;\n    }\n  }\n\n  if (!isStroke && !isAroundEqual(yi, y0)) {\n    w += windingLine(xi, yi, x0, y0, x, y) || 0;\n  }\n\n  return w !== 0;\n}\n\nfunction contain(pathData, x, y) {\n  return containPath(pathData, 0, false, x, y);\n}\nfunction containStroke(pathData, lineWidth, x, y) {\n  return containPath(pathData, lineWidth, true, x, y);\n}\n\nvar getCanvasPattern = Pattern.prototype.getCanvasPattern;\nvar abs = Math.abs;\nvar pathProxyForDraw = new PathProxy(true);\n/**\n * @alias module:zrender/graphic/Path\n * @extends module:zrender/graphic/Displayable\n * @constructor\n * @param {Object} opts\n */\n\nfunction Path(opts) {\n  Displayable.call(this, opts);\n  /**\n   * @type {module:zrender/core/PathProxy}\n   * @readOnly\n   */\n\n  this.path = null;\n}\n\nPath.prototype = {\n  constructor: Path,\n  type: 'path',\n  __dirtyPath: true,\n  strokeContainThreshold: 5,\n  brush: function (ctx, prevEl) {\n    var style = this.style;\n    var path = this.path || pathProxyForDraw;\n    var hasStroke = style.hasStroke();\n    var hasFill = style.hasFill();\n    var fill = style.fill;\n    var stroke = style.stroke;\n    var hasFillGradient = hasFill && !!fill.colorStops;\n    var hasStrokeGradient = hasStroke && !!stroke.colorStops;\n    var hasFillPattern = hasFill && !!fill.image;\n    var hasStrokePattern = hasStroke && !!stroke.image;\n    style.bind(ctx, this, prevEl);\n    this.setTransform(ctx);\n\n    if (this.__dirty) {\n      var rect; // Update gradient because bounding rect may changed\n\n      if (hasFillGradient) {\n        rect = rect || this.getBoundingRect();\n        this._fillGradient = style.getGradient(ctx, fill, rect);\n      }\n\n      if (hasStrokeGradient) {\n        rect = rect || this.getBoundingRect();\n        this._strokeGradient = style.getGradient(ctx, stroke, rect);\n      }\n    } // Use the gradient or pattern\n\n\n    if (hasFillGradient) {\n      // PENDING If may have affect the state\n      ctx.fillStyle = this._fillGradient;\n    } else if (hasFillPattern) {\n      ctx.fillStyle = getCanvasPattern.call(fill, ctx);\n    }\n\n    if (hasStrokeGradient) {\n      ctx.strokeStyle = this._strokeGradient;\n    } else if (hasStrokePattern) {\n      ctx.strokeStyle = getCanvasPattern.call(stroke, ctx);\n    }\n\n    var lineDash = style.lineDash;\n    var lineDashOffset = style.lineDashOffset;\n    var ctxLineDash = !!ctx.setLineDash; // Update path sx, sy\n\n    var scale = this.getGlobalScale();\n    path.setScale(scale[0], scale[1]); // Proxy context\n    // Rebuild path in following 2 cases\n    // 1. Path is dirty\n    // 2. Path needs javascript implemented lineDash stroking.\n    //    In this case, lineDash information will not be saved in PathProxy\n\n    if (this.__dirtyPath || lineDash && !ctxLineDash && hasStroke) {\n      path.beginPath(ctx); // Setting line dash before build path\n\n      if (lineDash && !ctxLineDash) {\n        path.setLineDash(lineDash);\n        path.setLineDashOffset(lineDashOffset);\n      }\n\n      this.buildPath(path, this.shape, false); // Clear path dirty flag\n\n      if (this.path) {\n        this.__dirtyPath = false;\n      }\n    } else {\n      // Replay path building\n      ctx.beginPath();\n      this.path.rebuildPath(ctx);\n    }\n\n    hasFill && path.fill(ctx);\n\n    if (lineDash && ctxLineDash) {\n      ctx.setLineDash(lineDash);\n      ctx.lineDashOffset = lineDashOffset;\n    }\n\n    hasStroke && path.stroke(ctx);\n\n    if (lineDash && ctxLineDash) {\n      // PENDING\n      // Remove lineDash\n      ctx.setLineDash([]);\n    } // Draw rect text\n\n\n    if (style.text != null) {\n      // Only restore transform when needs draw text.\n      this.restoreTransform(ctx);\n      this.drawRectText(ctx, this.getBoundingRect());\n    }\n  },\n  // When bundling path, some shape may decide if use moveTo to begin a new subpath or closePath\n  // Like in circle\n  buildPath: function (ctx, shapeCfg, inBundle) {},\n  createPathProxy: function () {\n    this.path = new PathProxy();\n  },\n  getBoundingRect: function () {\n    var rect = this._rect;\n    var style = this.style;\n    var needsUpdateRect = !rect;\n\n    if (needsUpdateRect) {\n      var path = this.path;\n\n      if (!path) {\n        // Create path on demand.\n        path = this.path = new PathProxy();\n      }\n\n      if (this.__dirtyPath) {\n        path.beginPath();\n        this.buildPath(path, this.shape, false);\n      }\n\n      rect = path.getBoundingRect();\n    }\n\n    this._rect = rect;\n\n    if (style.hasStroke()) {\n      // Needs update rect with stroke lineWidth when\n      // 1. Element changes scale or lineWidth\n      // 2. Shape is changed\n      var rectWithStroke = this._rectWithStroke || (this._rectWithStroke = rect.clone());\n\n      if (this.__dirty || needsUpdateRect) {\n        rectWithStroke.copy(rect); // FIXME Must after updateTransform\n\n        var w = style.lineWidth; // PENDING, Min line width is needed when line is horizontal or vertical\n\n        var lineScale = style.strokeNoScale ? this.getLineScale() : 1; // Only add extra hover lineWidth when there are no fill\n\n        if (!style.hasFill()) {\n          w = Math.max(w, this.strokeContainThreshold || 4);\n        } // Consider line width\n        // Line scale can't be 0;\n\n\n        if (lineScale > 1e-10) {\n          rectWithStroke.width += w / lineScale;\n          rectWithStroke.height += w / lineScale;\n          rectWithStroke.x -= w / lineScale / 2;\n          rectWithStroke.y -= w / lineScale / 2;\n        }\n      } // Return rect with stroke\n\n\n      return rectWithStroke;\n    }\n\n    return rect;\n  },\n  contain: function (x, y) {\n    var localPos = this.transformCoordToLocal(x, y);\n    var rect = this.getBoundingRect();\n    var style = this.style;\n    x = localPos[0];\n    y = localPos[1];\n\n    if (rect.contain(x, y)) {\n      var pathData = this.path.data;\n\n      if (style.hasStroke()) {\n        var lineWidth = style.lineWidth;\n        var lineScale = style.strokeNoScale ? this.getLineScale() : 1; // Line scale can't be 0;\n\n        if (lineScale > 1e-10) {\n          // Only add extra hover lineWidth when there are no fill\n          if (!style.hasFill()) {\n            lineWidth = Math.max(lineWidth, this.strokeContainThreshold);\n          }\n\n          if (containStroke(pathData, lineWidth / lineScale, x, y)) {\n            return true;\n          }\n        }\n      }\n\n      if (style.hasFill()) {\n        return contain(pathData, x, y);\n      }\n    }\n\n    return false;\n  },\n\n  /**\n   * @param  {boolean} dirtyPath\n   */\n  dirty: function (dirtyPath) {\n    if (dirtyPath == null) {\n      dirtyPath = true;\n    } // Only mark dirty, not mark clean\n\n\n    if (dirtyPath) {\n      this.__dirtyPath = dirtyPath;\n      this._rect = null;\n    }\n\n    this.__dirty = true;\n    this.__zr && this.__zr.refresh(); // Used as a clipping path\n\n    if (this.__clipTarget) {\n      this.__clipTarget.dirty();\n    }\n  },\n\n  /**\n   * Alias for animate('shape')\n   * @param {boolean} loop\n   */\n  animateShape: function (loop) {\n    return this.animate('shape', loop);\n  },\n  // Overwrite attrKV\n  attrKV: function (key, value) {\n    // FIXME\n    if (key === 'shape') {\n      this.setShape(value);\n      this.__dirtyPath = true;\n      this._rect = null;\n    } else {\n      Displayable.prototype.attrKV.call(this, key, value);\n    }\n  },\n\n  /**\n   * @param {Object|string} key\n   * @param {*} value\n   */\n  setShape: function (key, value) {\n    var shape = this.shape; // Path from string may not have shape\n\n    if (shape) {\n      if (isObject$1(key)) {\n        for (var name in key) {\n          if (key.hasOwnProperty(name)) {\n            shape[name] = key[name];\n          }\n        }\n      } else {\n        shape[key] = value;\n      }\n\n      this.dirty(true);\n    }\n\n    return this;\n  },\n  getLineScale: function () {\n    var m = this.transform; // Get the line scale.\n    // Determinant of `m` means how much the area is enlarged by the\n    // transformation. So its square root can be used as a scale factor\n    // for width.\n\n    return m && abs(m[0] - 1) > 1e-10 && abs(m[3] - 1) > 1e-10 ? Math.sqrt(abs(m[0] * m[3] - m[2] * m[1])) : 1;\n  }\n};\n/**\n *  Path element, \n * Extend a path element\n * @param {Object} props\n * @param {string} props.type Path type\n * @param {Function} props.init Initialize\n * @param {Function} props.buildPath Overwrite buildPath method\n * @param {Object} [props.style] Extended default style config\n * @param {Object} [props.shape] Extended default shape config\n */\n\nPath.extend = function (defaults$$1) {\n  var Sub = function (opts) {\n    Path.call(this, opts);\n\n    if (defaults$$1.style) {\n      // Extend default style\n      this.style.extendFrom(defaults$$1.style, false);\n    } // Extend default shape\n\n\n    var defaultShape = defaults$$1.shape;\n\n    if (defaultShape) {\n      this.shape = this.shape || {};\n      var thisShape = this.shape;\n\n      for (var name in defaultShape) {\n        if (!thisShape.hasOwnProperty(name) && defaultShape.hasOwnProperty(name)) {\n          thisShape[name] = defaultShape[name];\n        }\n      }\n    }\n\n    defaults$$1.init && defaults$$1.init.call(this, opts);\n  };\n\n  inherits(Sub, Path); // FIXME  extend position, rotation \n\n  for (var name in defaults$$1) {\n    // Extending prototype values and methods\n    if (name !== 'style' && name !== 'shape') {\n      Sub.prototype[name] = defaults$$1[name];\n    }\n  }\n\n  return Sub;\n};\n\ninherits(Path, Displayable);\n\nvar CMD$2 = PathProxy.CMD;\nvar points = [[], [], []];\nvar mathSqrt$3 = Math.sqrt;\nvar mathAtan2 = Math.atan2;\nvar transformPath = function (path, m) {\n  var data = path.data;\n  var cmd;\n  var nPoint;\n  var i;\n  var j;\n  var k;\n  var p;\n  var M = CMD$2.M;\n  var C = CMD$2.C;\n  var L = CMD$2.L;\n  var R = CMD$2.R;\n  var A = CMD$2.A;\n  var Q = CMD$2.Q;\n\n  for (i = 0, j = 0; i < data.length;) {\n    cmd = data[i++];\n    j = i;\n    nPoint = 0;\n\n    switch (cmd) {\n      case M:\n        nPoint = 1;\n        break;\n\n      case L:\n        nPoint = 1;\n        break;\n\n      case C:\n        nPoint = 3;\n        break;\n\n      case Q:\n        nPoint = 2;\n        break;\n\n      case A:\n        var x = m[4];\n        var y = m[5];\n        var sx = mathSqrt$3(m[0] * m[0] + m[1] * m[1]);\n        var sy = mathSqrt$3(m[2] * m[2] + m[3] * m[3]);\n        var angle = mathAtan2(-m[1] / sy, m[0] / sx); // cx\n\n        data[i] *= sx;\n        data[i++] += x; // cy\n\n        data[i] *= sy;\n        data[i++] += y; // Scale rx and ry\n        // FIXME Assume psi is 0 here\n\n        data[i++] *= sx;\n        data[i++] *= sy; // Start angle\n\n        data[i++] += angle; // end angle\n\n        data[i++] += angle; // FIXME psi\n\n        i += 2;\n        j = i;\n        break;\n\n      case R:\n        // x0, y0\n        p[0] = data[i++];\n        p[1] = data[i++];\n        applyTransform(p, p, m);\n        data[j++] = p[0];\n        data[j++] = p[1]; // x1, y1\n\n        p[0] += data[i++];\n        p[1] += data[i++];\n        applyTransform(p, p, m);\n        data[j++] = p[0];\n        data[j++] = p[1];\n    }\n\n    for (k = 0; k < nPoint; k++) {\n      var p = points[k];\n      p[0] = data[i++];\n      p[1] = data[i++];\n      applyTransform(p, p, m); // Write back\n\n      data[j++] = p[0];\n      data[j++] = p[1];\n    }\n  }\n};\n\nvar cc = ['m', 'M', 'l', 'L', 'v', 'V', 'h', 'H', 'z', 'Z', 'c', 'C', 'q', 'Q', 't', 'T', 's', 'S', 'a', 'A'];\nvar mathSqrt = Math.sqrt;\nvar mathSin = Math.sin;\nvar mathCos = Math.cos;\nvar PI = Math.PI;\n\nvar vMag = function (v) {\n  return Math.sqrt(v[0] * v[0] + v[1] * v[1]);\n};\n\nvar vRatio = function (u, v) {\n  return (u[0] * v[0] + u[1] * v[1]) / (vMag(u) * vMag(v));\n};\n\nvar vAngle = function (u, v) {\n  return (u[0] * v[1] < u[1] * v[0] ? -1 : 1) * Math.acos(vRatio(u, v));\n};\n\nfunction processArc(x1, y1, x2, y2, fa, fs, rx, ry, psiDeg, cmd, path) {\n  var psi = psiDeg * (PI / 180.0);\n  var xp = mathCos(psi) * (x1 - x2) / 2.0 + mathSin(psi) * (y1 - y2) / 2.0;\n  var yp = -1 * mathSin(psi) * (x1 - x2) / 2.0 + mathCos(psi) * (y1 - y2) / 2.0;\n  var lambda = xp * xp / (rx * rx) + yp * yp / (ry * ry);\n\n  if (lambda > 1) {\n    rx *= mathSqrt(lambda);\n    ry *= mathSqrt(lambda);\n  }\n\n  var f = (fa === fs ? -1 : 1) * mathSqrt((rx * rx * (ry * ry) - rx * rx * (yp * yp) - ry * ry * (xp * xp)) / (rx * rx * (yp * yp) + ry * ry * (xp * xp))) || 0;\n  var cxp = f * rx * yp / ry;\n  var cyp = f * -ry * xp / rx;\n  var cx = (x1 + x2) / 2.0 + mathCos(psi) * cxp - mathSin(psi) * cyp;\n  var cy = (y1 + y2) / 2.0 + mathSin(psi) * cxp + mathCos(psi) * cyp;\n  var theta = vAngle([1, 0], [(xp - cxp) / rx, (yp - cyp) / ry]);\n  var u = [(xp - cxp) / rx, (yp - cyp) / ry];\n  var v = [(-1 * xp - cxp) / rx, (-1 * yp - cyp) / ry];\n  var dTheta = vAngle(u, v);\n\n  if (vRatio(u, v) <= -1) {\n    dTheta = PI;\n  }\n\n  if (vRatio(u, v) >= 1) {\n    dTheta = 0;\n  }\n\n  if (fs === 0 && dTheta > 0) {\n    dTheta = dTheta - 2 * PI;\n  }\n\n  if (fs === 1 && dTheta < 0) {\n    dTheta = dTheta + 2 * PI;\n  }\n\n  path.addData(cmd, cx, cy, rx, ry, theta, dTheta, psi, fs);\n}\n\nfunction createPathProxyFromString(data) {\n  if (!data) {\n    return [];\n  } // command string\n\n\n  var cs = data.replace(/-/g, ' -').replace(/  /g, ' ').replace(/ /g, ',').replace(/,,/g, ',');\n  var n; // create pipes so that we can split the data\n\n  for (n = 0; n < cc.length; n++) {\n    cs = cs.replace(new RegExp(cc[n], 'g'), '|' + cc[n]);\n  } // create array\n\n\n  var arr = cs.split('|'); // init context point\n\n  var cpx = 0;\n  var cpy = 0;\n  var path = new PathProxy();\n  var CMD = PathProxy.CMD;\n  var prevCmd;\n\n  for (n = 1; n < arr.length; n++) {\n    var str = arr[n];\n    var c = str.charAt(0);\n    var off = 0;\n    var p = str.slice(1).replace(/e,-/g, 'e-').split(',');\n    var cmd;\n\n    if (p.length > 0 && p[0] === '') {\n      p.shift();\n    }\n\n    for (var i = 0; i < p.length; i++) {\n      p[i] = parseFloat(p[i]);\n    }\n\n    while (off < p.length && !isNaN(p[off])) {\n      if (isNaN(p[0])) {\n        break;\n      }\n\n      var ctlPtx;\n      var ctlPty;\n      var rx;\n      var ry;\n      var psi;\n      var fa;\n      var fs;\n      var x1 = cpx;\n      var y1 = cpy; // convert l, H, h, V, and v to L\n\n      switch (c) {\n        case 'l':\n          cpx += p[off++];\n          cpy += p[off++];\n          cmd = CMD.L;\n          path.addData(cmd, cpx, cpy);\n          break;\n\n        case 'L':\n          cpx = p[off++];\n          cpy = p[off++];\n          cmd = CMD.L;\n          path.addData(cmd, cpx, cpy);\n          break;\n\n        case 'm':\n          cpx += p[off++];\n          cpy += p[off++];\n          cmd = CMD.M;\n          path.addData(cmd, cpx, cpy);\n          c = 'l';\n          break;\n\n        case 'M':\n          cpx = p[off++];\n          cpy = p[off++];\n          cmd = CMD.M;\n          path.addData(cmd, cpx, cpy);\n          c = 'L';\n          break;\n\n        case 'h':\n          cpx += p[off++];\n          cmd = CMD.L;\n          path.addData(cmd, cpx, cpy);\n          break;\n\n        case 'H':\n          cpx = p[off++];\n          cmd = CMD.L;\n          path.addData(cmd, cpx, cpy);\n          break;\n\n        case 'v':\n          cpy += p[off++];\n          cmd = CMD.L;\n          path.addData(cmd, cpx, cpy);\n          break;\n\n        case 'V':\n          cpy = p[off++];\n          cmd = CMD.L;\n          path.addData(cmd, cpx, cpy);\n          break;\n\n        case 'C':\n          cmd = CMD.C;\n          path.addData(cmd, p[off++], p[off++], p[off++], p[off++], p[off++], p[off++]);\n          cpx = p[off - 2];\n          cpy = p[off - 1];\n          break;\n\n        case 'c':\n          cmd = CMD.C;\n          path.addData(cmd, p[off++] + cpx, p[off++] + cpy, p[off++] + cpx, p[off++] + cpy, p[off++] + cpx, p[off++] + cpy);\n          cpx += p[off - 2];\n          cpy += p[off - 1];\n          break;\n\n        case 'S':\n          ctlPtx = cpx;\n          ctlPty = cpy;\n          var len = path.len();\n          var pathData = path.data;\n\n          if (prevCmd === CMD.C) {\n            ctlPtx += cpx - pathData[len - 4];\n            ctlPty += cpy - pathData[len - 3];\n          }\n\n          cmd = CMD.C;\n          x1 = p[off++];\n          y1 = p[off++];\n          cpx = p[off++];\n          cpy = p[off++];\n          path.addData(cmd, ctlPtx, ctlPty, x1, y1, cpx, cpy);\n          break;\n\n        case 's':\n          ctlPtx = cpx;\n          ctlPty = cpy;\n          var len = path.len();\n          var pathData = path.data;\n\n          if (prevCmd === CMD.C) {\n            ctlPtx += cpx - pathData[len - 4];\n            ctlPty += cpy - pathData[len - 3];\n          }\n\n          cmd = CMD.C;\n          x1 = cpx + p[off++];\n          y1 = cpy + p[off++];\n          cpx += p[off++];\n          cpy += p[off++];\n          path.addData(cmd, ctlPtx, ctlPty, x1, y1, cpx, cpy);\n          break;\n\n        case 'Q':\n          x1 = p[off++];\n          y1 = p[off++];\n          cpx = p[off++];\n          cpy = p[off++];\n          cmd = CMD.Q;\n          path.addData(cmd, x1, y1, cpx, cpy);\n          break;\n\n        case 'q':\n          x1 = p[off++] + cpx;\n          y1 = p[off++] + cpy;\n          cpx += p[off++];\n          cpy += p[off++];\n          cmd = CMD.Q;\n          path.addData(cmd, x1, y1, cpx, cpy);\n          break;\n\n        case 'T':\n          ctlPtx = cpx;\n          ctlPty = cpy;\n          var len = path.len();\n          var pathData = path.data;\n\n          if (prevCmd === CMD.Q) {\n            ctlPtx += cpx - pathData[len - 4];\n            ctlPty += cpy - pathData[len - 3];\n          }\n\n          cpx = p[off++];\n          cpy = p[off++];\n          cmd = CMD.Q;\n          path.addData(cmd, ctlPtx, ctlPty, cpx, cpy);\n          break;\n\n        case 't':\n          ctlPtx = cpx;\n          ctlPty = cpy;\n          var len = path.len();\n          var pathData = path.data;\n\n          if (prevCmd === CMD.Q) {\n            ctlPtx += cpx - pathData[len - 4];\n            ctlPty += cpy - pathData[len - 3];\n          }\n\n          cpx += p[off++];\n          cpy += p[off++];\n          cmd = CMD.Q;\n          path.addData(cmd, ctlPtx, ctlPty, cpx, cpy);\n          break;\n\n        case 'A':\n          rx = p[off++];\n          ry = p[off++];\n          psi = p[off++];\n          fa = p[off++];\n          fs = p[off++];\n          x1 = cpx, y1 = cpy;\n          cpx = p[off++];\n          cpy = p[off++];\n          cmd = CMD.A;\n          processArc(x1, y1, cpx, cpy, fa, fs, rx, ry, psi, cmd, path);\n          break;\n\n        case 'a':\n          rx = p[off++];\n          ry = p[off++];\n          psi = p[off++];\n          fa = p[off++];\n          fs = p[off++];\n          x1 = cpx, y1 = cpy;\n          cpx += p[off++];\n          cpy += p[off++];\n          cmd = CMD.A;\n          processArc(x1, y1, cpx, cpy, fa, fs, rx, ry, psi, cmd, path);\n          break;\n      }\n    }\n\n    if (c === 'z' || c === 'Z') {\n      cmd = CMD.Z;\n      path.addData(cmd);\n    }\n\n    prevCmd = cmd;\n  }\n\n  path.toStatic();\n  return path;\n} // TODO Optimize double memory cost problem\n\n\nfunction createPathOptions(str, opts) {\n  var pathProxy = createPathProxyFromString(str);\n  opts = opts || {};\n\n  opts.buildPath = function (path) {\n    if (path.setData) {\n      path.setData(pathProxy.data); // Svg and vml renderer don't have context\n\n      var ctx = path.getContext();\n\n      if (ctx) {\n        path.rebuildPath(ctx);\n      }\n    } else {\n      var ctx = path;\n      pathProxy.rebuildPath(ctx);\n    }\n  };\n\n  opts.applyTransform = function (m) {\n    transformPath(pathProxy, m);\n    this.dirty(true);\n  };\n\n  return opts;\n}\n/**\n * Create a Path object from path string data\n * http://www.w3.org/TR/SVG/paths.html#PathData\n * @param  {Object} opts Other options\n */\n\n\nfunction createFromString(str, opts) {\n  return new Path(createPathOptions(str, opts));\n}\n/**\n * Create a Path class from path string data\n * @param  {string} str\n * @param  {Object} opts Other options\n */\n\nfunction extendFromString(str, opts) {\n  return Path.extend(createPathOptions(str, opts));\n}\n/**\n * Merge multiple paths\n */\n// TODO Apply transform\n// TODO stroke dash\n// TODO Optimize double memory cost problem\n\nfunction mergePath$1(pathEls, opts) {\n  var pathList = [];\n  var len = pathEls.length;\n\n  for (var i = 0; i < len; i++) {\n    var pathEl = pathEls[i];\n\n    if (!pathEl.path) {\n      pathEl.createPathProxy();\n    }\n\n    if (pathEl.__dirtyPath) {\n      pathEl.buildPath(pathEl.path, pathEl.shape, true);\n    }\n\n    pathList.push(pathEl.path);\n  }\n\n  var pathBundle = new Path(opts); // Need path proxy.\n\n  pathBundle.createPathProxy();\n\n  pathBundle.buildPath = function (path) {\n    path.appendPath(pathList); // Svg and vml renderer don't have context\n\n    var ctx = path.getContext();\n\n    if (ctx) {\n      path.rebuildPath(ctx);\n    }\n  };\n\n  return pathBundle;\n}\n\n/**\n * @alias zrender/graphic/Text\n * @extends module:zrender/graphic/Displayable\n * @constructor\n * @param {Object} opts\n */\n\nvar Text = function (opts) {\n  // jshint ignore:line\n  Displayable.call(this, opts);\n};\n\nText.prototype = {\n  constructor: Text,\n  type: 'text',\n  brush: function (ctx, prevEl) {\n    var style = this.style; // Optimize, avoid normalize every time.\n\n    this.__dirty && normalizeTextStyle(style, true); // Use props with prefix 'text'.\n\n    style.fill = style.stroke = style.shadowBlur = style.shadowColor = style.shadowOffsetX = style.shadowOffsetY = null;\n    var text = style.text; // Convert to string\n\n    text != null && (text += ''); // Always bind style\n\n    style.bind(ctx, this, prevEl);\n\n    if (!needDrawText(text, style)) {\n      return;\n    }\n\n    this.setTransform(ctx);\n    renderText(this, ctx, text, style);\n    this.restoreTransform(ctx);\n  },\n  getBoundingRect: function () {\n    var style = this.style; // Optimize, avoid normalize every time.\n\n    this.__dirty && normalizeTextStyle(style, true);\n\n    if (!this._rect) {\n      var text = style.text;\n      text != null ? text += '' : text = '';\n      var rect = getBoundingRect(style.text + '', style.font, style.textAlign, style.textVerticalAlign, style.textPadding, style.rich);\n      rect.x += style.x || 0;\n      rect.y += style.y || 0;\n\n      if (getStroke(style.textStroke, style.textStrokeWidth)) {\n        var w = style.textStrokeWidth;\n        rect.x -= w / 2;\n        rect.y -= w / 2;\n        rect.width += w;\n        rect.height += w;\n      }\n\n      this._rect = rect;\n    }\n\n    return this._rect;\n  }\n};\ninherits(Text, Displayable);\n\n/**\n * \n * @module zrender/shape/Circle\n */\nvar Circle = Path.extend({\n  type: 'circle',\n  shape: {\n    cx: 0,\n    cy: 0,\n    r: 0\n  },\n  buildPath: function (ctx, shape, inBundle) {\n    // Better stroking in ShapeBundle\n    // Always do it may have performence issue ( fill may be 2x more cost)\n    if (inBundle) {\n      ctx.moveTo(shape.cx + shape.r, shape.cy);\n    } // else {\n    //     if (ctx.allocate && !ctx.data.length) {\n    //         ctx.allocate(ctx.CMD_MEM_SIZE.A);\n    //     }\n    // }\n    // Better stroking in ShapeBundle\n    // ctx.moveTo(shape.cx + shape.r, shape.cy);\n\n\n    ctx.arc(shape.cx, shape.cy, shape.r, 0, Math.PI * 2, true);\n  }\n});\n\n// where exception \"unexpected call to method or property access\"\n// might be thrown when calling ctx.fill or ctx.stroke after a path\n// whose area size is zero is drawn and ctx.clip() is called and\n// shadowBlur is set. See #4572, #3112, #5777.\n// (e.g.,\n//  ctx.moveTo(10, 10);\n//  ctx.lineTo(20, 10);\n//  ctx.closePath();\n//  ctx.clip();\n//  ctx.shadowBlur = 10;\n//  ...\n//  ctx.fill();\n// )\n\nvar shadowTemp = [['shadowBlur', 0], ['shadowColor', '#000'], ['shadowOffsetX', 0], ['shadowOffsetY', 0]];\nvar fixClipWithShadow = function (orignalBrush) {\n  // version string can be: '11.0'\n  return env$1.browser.ie && env$1.browser.version >= 11 ? function () {\n    var clipPaths = this.__clipPaths;\n    var style = this.style;\n    var modified;\n\n    if (clipPaths) {\n      for (var i = 0; i < clipPaths.length; i++) {\n        var clipPath = clipPaths[i];\n        var shape = clipPath && clipPath.shape;\n        var type = clipPath && clipPath.type;\n\n        if (shape && (type === 'sector' && shape.startAngle === shape.endAngle || type === 'rect' && (!shape.width || !shape.height))) {\n          for (var j = 0; j < shadowTemp.length; j++) {\n            // It is save to put shadowTemp static, because shadowTemp\n            // will be all modified each item brush called.\n            shadowTemp[j][2] = style[shadowTemp[j][0]];\n            style[shadowTemp[j][0]] = shadowTemp[j][1];\n          }\n\n          modified = true;\n          break;\n        }\n      }\n    }\n\n    orignalBrush.apply(this, arguments);\n\n    if (modified) {\n      for (var j = 0; j < shadowTemp.length; j++) {\n        style[shadowTemp[j][0]] = shadowTemp[j][2];\n      }\n    }\n  } : orignalBrush;\n};\n\n/**\n * \n * @module zrender/graphic/shape/Sector\n */\nvar Sector = Path.extend({\n  type: 'sector',\n  shape: {\n    cx: 0,\n    cy: 0,\n    r0: 0,\n    r: 0,\n    startAngle: 0,\n    endAngle: Math.PI * 2,\n    clockwise: true\n  },\n  brush: fixClipWithShadow(Path.prototype.brush),\n  buildPath: function (ctx, shape) {\n    var x = shape.cx;\n    var y = shape.cy;\n    var r0 = Math.max(shape.r0 || 0, 0);\n    var r = Math.max(shape.r, 0);\n    var startAngle = shape.startAngle;\n    var endAngle = shape.endAngle;\n    var clockwise = shape.clockwise;\n    var unitX = Math.cos(startAngle);\n    var unitY = Math.sin(startAngle);\n    ctx.moveTo(unitX * r0 + x, unitY * r0 + y);\n    ctx.lineTo(unitX * r + x, unitY * r + y);\n    ctx.arc(x, y, r, startAngle, endAngle, !clockwise);\n    ctx.lineTo(Math.cos(endAngle) * r0 + x, Math.sin(endAngle) * r0 + y);\n\n    if (r0 !== 0) {\n      ctx.arc(x, y, r0, endAngle, startAngle, clockwise);\n    }\n\n    ctx.closePath();\n  }\n});\n\n/**\n * \n * @module zrender/graphic/shape/Ring\n */\nvar Ring = Path.extend({\n  type: 'ring',\n  shape: {\n    cx: 0,\n    cy: 0,\n    r: 0,\n    r0: 0\n  },\n  buildPath: function (ctx, shape) {\n    var x = shape.cx;\n    var y = shape.cy;\n    var PI2 = Math.PI * 2;\n    ctx.moveTo(x + shape.r, y);\n    ctx.arc(x, y, shape.r, 0, PI2, false);\n    ctx.moveTo(x + shape.r0, y);\n    ctx.arc(x, y, shape.r0, 0, PI2, true);\n  }\n});\n\n/**\n * Catmull-Rom spline \n * @module zrender/shape/util/smoothSpline\n * @author pissang (https://www.github.com/pissang)\n *         Kener (@Kener-, kener.linfeng@gmail.com)\n *         errorrik (errorrik@gmail.com)\n */\n/**\n * @inner\n */\n\nfunction interpolate(p0, p1, p2, p3, t, t2, t3) {\n  var v0 = (p2 - p0) * 0.5;\n  var v1 = (p3 - p1) * 0.5;\n  return (2 * (p1 - p2) + v0 + v1) * t3 + (-3 * (p1 - p2) - 2 * v0 - v1) * t2 + v0 * t + p1;\n}\n/**\n * @alias module:zrender/shape/util/smoothSpline\n * @param {Array} points \n * @param {boolean} isLoop\n * @return {Array}\n */\n\n\nvar smoothSpline = function (points, isLoop) {\n  var len$$1 = points.length;\n  var ret = [];\n  var distance$$1 = 0;\n\n  for (var i = 1; i < len$$1; i++) {\n    distance$$1 += distance(points[i - 1], points[i]);\n  }\n\n  var segs = distance$$1 / 2;\n  segs = segs < len$$1 ? len$$1 : segs;\n\n  for (var i = 0; i < segs; i++) {\n    var pos = i / (segs - 1) * (isLoop ? len$$1 : len$$1 - 1);\n    var idx = Math.floor(pos);\n    var w = pos - idx;\n    var p0;\n    var p1 = points[idx % len$$1];\n    var p2;\n    var p3;\n\n    if (!isLoop) {\n      p0 = points[idx === 0 ? idx : idx - 1];\n      p2 = points[idx > len$$1 - 2 ? len$$1 - 1 : idx + 1];\n      p3 = points[idx > len$$1 - 3 ? len$$1 - 1 : idx + 2];\n    } else {\n      p0 = points[(idx - 1 + len$$1) % len$$1];\n      p2 = points[(idx + 1) % len$$1];\n      p3 = points[(idx + 2) % len$$1];\n    }\n\n    var w2 = w * w;\n    var w3 = w * w2;\n    ret.push([interpolate(p0[0], p1[0], p2[0], p3[0], w, w2, w3), interpolate(p0[1], p1[1], p2[1], p3[1], w, w2, w3)]);\n  }\n\n  return ret;\n};\n\n/**\n * \n * @module zrender/shape/util/smoothBezier\n * @author pissang (https://www.github.com/pissang)\n *         Kener (@Kener-, kener.linfeng@gmail.com)\n *         errorrik (errorrik@gmail.com)\n */\n/**\n * \n * @alias module:zrender/shape/util/smoothBezier\n * @param {Array} points \n * @param {number} smooth , 0-1\n * @param {boolean} isLoop\n * @param {Array} constraint \n *                            [[0, 0], [100, 100]], \n *                           \n * @param {Array} \n */\n\nvar smoothBezier = function (points, smooth, isLoop, constraint) {\n  var cps = [];\n  var v = [];\n  var v1 = [];\n  var v2 = [];\n  var prevPoint;\n  var nextPoint;\n  var min$$1, max$$1;\n\n  if (constraint) {\n    min$$1 = [Infinity, Infinity];\n    max$$1 = [-Infinity, -Infinity];\n\n    for (var i = 0, len$$1 = points.length; i < len$$1; i++) {\n      min(min$$1, min$$1, points[i]);\n      max(max$$1, max$$1, points[i]);\n    } // \n\n\n    min(min$$1, min$$1, constraint[0]);\n    max(max$$1, max$$1, constraint[1]);\n  }\n\n  for (var i = 0, len$$1 = points.length; i < len$$1; i++) {\n    var point = points[i];\n\n    if (isLoop) {\n      prevPoint = points[i ? i - 1 : len$$1 - 1];\n      nextPoint = points[(i + 1) % len$$1];\n    } else {\n      if (i === 0 || i === len$$1 - 1) {\n        cps.push(clone$1(points[i]));\n        continue;\n      } else {\n        prevPoint = points[i - 1];\n        nextPoint = points[i + 1];\n      }\n    }\n\n    sub(v, nextPoint, prevPoint); // use degree to scale the handle length\n\n    scale(v, v, smooth);\n    var d0 = distance(point, prevPoint);\n    var d1 = distance(point, nextPoint);\n    var sum = d0 + d1;\n\n    if (sum !== 0) {\n      d0 /= sum;\n      d1 /= sum;\n    }\n\n    scale(v1, v, -d0);\n    scale(v2, v, d1);\n    var cp0 = add([], point, v1);\n    var cp1 = add([], point, v2);\n\n    if (constraint) {\n      max(cp0, cp0, min$$1);\n      min(cp0, cp0, max$$1);\n      max(cp1, cp1, min$$1);\n      min(cp1, cp1, max$$1);\n    }\n\n    cps.push(cp0);\n    cps.push(cp1);\n  }\n\n  if (isLoop) {\n    cps.push(cps.shift());\n  }\n\n  return cps;\n};\n\nfunction buildPath$1(ctx, shape, closePath) {\n  var points = shape.points;\n  var smooth = shape.smooth;\n\n  if (points && points.length >= 2) {\n    if (smooth && smooth !== 'spline') {\n      var controlPoints = smoothBezier(points, smooth, closePath, shape.smoothConstraint);\n      ctx.moveTo(points[0][0], points[0][1]);\n      var len = points.length;\n\n      for (var i = 0; i < (closePath ? len : len - 1); i++) {\n        var cp1 = controlPoints[i * 2];\n        var cp2 = controlPoints[i * 2 + 1];\n        var p = points[(i + 1) % len];\n        ctx.bezierCurveTo(cp1[0], cp1[1], cp2[0], cp2[1], p[0], p[1]);\n      }\n    } else {\n      if (smooth === 'spline') {\n        points = smoothSpline(points, closePath);\n      }\n\n      ctx.moveTo(points[0][0], points[0][1]);\n\n      for (var i = 1, l = points.length; i < l; i++) {\n        ctx.lineTo(points[i][0], points[i][1]);\n      }\n    }\n\n    closePath && ctx.closePath();\n  }\n}\n\n/**\n * \n * @module zrender/shape/Polygon\n */\nvar Polygon = Path.extend({\n  type: 'polygon',\n  shape: {\n    points: null,\n    smooth: false,\n    smoothConstraint: null\n  },\n  buildPath: function (ctx, shape) {\n    buildPath$1(ctx, shape, true);\n  }\n});\n\n/**\n * @module zrender/graphic/shape/Polyline\n */\nvar Polyline = Path.extend({\n  type: 'polyline',\n  shape: {\n    points: null,\n    smooth: false,\n    smoothConstraint: null\n  },\n  style: {\n    stroke: '#000',\n    fill: null\n  },\n  buildPath: function (ctx, shape) {\n    buildPath$1(ctx, shape, false);\n  }\n});\n\n/**\n * \n * @module zrender/graphic/shape/Rect\n */\nvar Rect = Path.extend({\n  type: 'rect',\n  shape: {\n    // r1r2r3r4\n    // r1          [1, 1, 1, 1]\n    // r[1]        [1, 1, 1, 1]\n    // r[1, 2]     [1, 2, 1, 2]\n    // r[1, 2, 3]  [1, 2, 3, 2]\n    r: 0,\n    x: 0,\n    y: 0,\n    width: 0,\n    height: 0\n  },\n  buildPath: function (ctx, shape) {\n    var x = shape.x;\n    var y = shape.y;\n    var width = shape.width;\n    var height = shape.height;\n\n    if (!shape.r) {\n      ctx.rect(x, y, width, height);\n    } else {\n      buildPath(ctx, shape);\n    }\n\n    ctx.closePath();\n    return;\n  }\n});\n\n/**\n * \n * @module zrender/graphic/shape/Line\n */\nvar Line = Path.extend({\n  type: 'line',\n  shape: {\n    // Start point\n    x1: 0,\n    y1: 0,\n    // End point\n    x2: 0,\n    y2: 0,\n    percent: 1\n  },\n  style: {\n    stroke: '#000',\n    fill: null\n  },\n  buildPath: function (ctx, shape) {\n    var x1 = shape.x1;\n    var y1 = shape.y1;\n    var x2 = shape.x2;\n    var y2 = shape.y2;\n    var percent = shape.percent;\n\n    if (percent === 0) {\n      return;\n    }\n\n    ctx.moveTo(x1, y1);\n\n    if (percent < 1) {\n      x2 = x1 * (1 - percent) + x2 * percent;\n      y2 = y1 * (1 - percent) + y2 * percent;\n    }\n\n    ctx.lineTo(x2, y2);\n  },\n\n  /**\n   * Get point at percent\n   * @param  {number} percent\n   * @return {Array.<number>}\n   */\n  pointAt: function (p) {\n    var shape = this.shape;\n    return [shape.x1 * (1 - p) + shape.x2 * p, shape.y1 * (1 - p) + shape.y2 * p];\n  }\n});\n\n/**\n * \n * @module zrender/shape/BezierCurve\n */\nvar out = [];\n\nfunction someVectorAt(shape, t, isTangent) {\n  var cpx2 = shape.cpx2;\n  var cpy2 = shape.cpy2;\n\n  if (cpx2 === null || cpy2 === null) {\n    return [(isTangent ? cubicDerivativeAt : cubicAt)(shape.x1, shape.cpx1, shape.cpx2, shape.x2, t), (isTangent ? cubicDerivativeAt : cubicAt)(shape.y1, shape.cpy1, shape.cpy2, shape.y2, t)];\n  } else {\n    return [(isTangent ? quadraticDerivativeAt : quadraticAt)(shape.x1, shape.cpx1, shape.x2, t), (isTangent ? quadraticDerivativeAt : quadraticAt)(shape.y1, shape.cpy1, shape.y2, t)];\n  }\n}\n\nvar BezierCurve = Path.extend({\n  type: 'bezier-curve',\n  shape: {\n    x1: 0,\n    y1: 0,\n    x2: 0,\n    y2: 0,\n    cpx1: 0,\n    cpy1: 0,\n    // cpx2: 0,\n    // cpy2: 0\n    // Curve show percent, for animating\n    percent: 1\n  },\n  style: {\n    stroke: '#000',\n    fill: null\n  },\n  buildPath: function (ctx, shape) {\n    var x1 = shape.x1;\n    var y1 = shape.y1;\n    var x2 = shape.x2;\n    var y2 = shape.y2;\n    var cpx1 = shape.cpx1;\n    var cpy1 = shape.cpy1;\n    var cpx2 = shape.cpx2;\n    var cpy2 = shape.cpy2;\n    var percent = shape.percent;\n\n    if (percent === 0) {\n      return;\n    }\n\n    ctx.moveTo(x1, y1);\n\n    if (cpx2 == null || cpy2 == null) {\n      if (percent < 1) {\n        quadraticSubdivide(x1, cpx1, x2, percent, out);\n        cpx1 = out[1];\n        x2 = out[2];\n        quadraticSubdivide(y1, cpy1, y2, percent, out);\n        cpy1 = out[1];\n        y2 = out[2];\n      }\n\n      ctx.quadraticCurveTo(cpx1, cpy1, x2, y2);\n    } else {\n      if (percent < 1) {\n        cubicSubdivide(x1, cpx1, cpx2, x2, percent, out);\n        cpx1 = out[1];\n        cpx2 = out[2];\n        x2 = out[3];\n        cubicSubdivide(y1, cpy1, cpy2, y2, percent, out);\n        cpy1 = out[1];\n        cpy2 = out[2];\n        y2 = out[3];\n      }\n\n      ctx.bezierCurveTo(cpx1, cpy1, cpx2, cpy2, x2, y2);\n    }\n  },\n\n  /**\n   * Get point at percent\n   * @param  {number} t\n   * @return {Array.<number>}\n   */\n  pointAt: function (t) {\n    return someVectorAt(this.shape, t, false);\n  },\n\n  /**\n   * Get tangent at percent\n   * @param  {number} t\n   * @return {Array.<number>}\n   */\n  tangentAt: function (t) {\n    var p = someVectorAt(this.shape, t, true);\n    return normalize(p, p);\n  }\n});\n\n/**\n * \n * @module zrender/graphic/shape/Arc\n */\nvar Arc = Path.extend({\n  type: 'arc',\n  shape: {\n    cx: 0,\n    cy: 0,\n    r: 0,\n    startAngle: 0,\n    endAngle: Math.PI * 2,\n    clockwise: true\n  },\n  style: {\n    stroke: '#000',\n    fill: null\n  },\n  buildPath: function (ctx, shape) {\n    var x = shape.cx;\n    var y = shape.cy;\n    var r = Math.max(shape.r, 0);\n    var startAngle = shape.startAngle;\n    var endAngle = shape.endAngle;\n    var clockwise = shape.clockwise;\n    var unitX = Math.cos(startAngle);\n    var unitY = Math.sin(startAngle);\n    ctx.moveTo(unitX * r + x, unitY * r + y);\n    ctx.arc(x, y, r, startAngle, endAngle, !clockwise);\n  }\n});\n\n// CompoundPath to improve performance\nvar CompoundPath = Path.extend({\n  type: 'compound',\n  shape: {\n    paths: null\n  },\n  _updatePathDirty: function () {\n    var dirtyPath = this.__dirtyPath;\n    var paths = this.shape.paths;\n\n    for (var i = 0; i < paths.length; i++) {\n      // Mark as dirty if any subpath is dirty\n      dirtyPath = dirtyPath || paths[i].__dirtyPath;\n    }\n\n    this.__dirtyPath = dirtyPath;\n    this.__dirty = this.__dirty || dirtyPath;\n  },\n  beforeBrush: function () {\n    this._updatePathDirty();\n\n    var paths = this.shape.paths || [];\n    var scale = this.getGlobalScale(); // Update path scale\n\n    for (var i = 0; i < paths.length; i++) {\n      if (!paths[i].path) {\n        paths[i].createPathProxy();\n      }\n\n      paths[i].path.setScale(scale[0], scale[1]);\n    }\n  },\n  buildPath: function (ctx, shape) {\n    var paths = shape.paths || [];\n\n    for (var i = 0; i < paths.length; i++) {\n      paths[i].buildPath(ctx, paths[i].shape, true);\n    }\n  },\n  afterBrush: function () {\n    var paths = this.shape.paths || [];\n\n    for (var i = 0; i < paths.length; i++) {\n      paths[i].__dirtyPath = false;\n    }\n  },\n  getBoundingRect: function () {\n    this._updatePathDirty();\n\n    return Path.prototype.getBoundingRect.call(this);\n  }\n});\n\n/**\n * @param {Array.<Object>} colorStops\n */\nvar Gradient = function (colorStops) {\n  this.colorStops = colorStops || [];\n};\n\nGradient.prototype = {\n  constructor: Gradient,\n  addColorStop: function (offset, color) {\n    this.colorStops.push({\n      offset: offset,\n      color: color\n    });\n  }\n};\n\n/**\n * x, y, x2, y2 are all percent from 0 to 1\n * @param {number} [x=0]\n * @param {number} [y=0]\n * @param {number} [x2=1]\n * @param {number} [y2=0]\n * @param {Array.<Object>} colorStops\n * @param {boolean} [globalCoord=false]\n */\n\nvar LinearGradient = function (x, y, x2, y2, colorStops, globalCoord) {\n  // Should do nothing more in this constructor. Because gradient can be\n  // declard by `color: {type: 'linear', colorStops: ...}`, where\n  // this constructor will not be called.\n  this.x = x == null ? 0 : x;\n  this.y = y == null ? 0 : y;\n  this.x2 = x2 == null ? 1 : x2;\n  this.y2 = y2 == null ? 0 : y2; // Can be cloned\n\n  this.type = 'linear'; // If use global coord\n\n  this.global = globalCoord || false;\n  Gradient.call(this, colorStops);\n};\n\nLinearGradient.prototype = {\n  constructor: LinearGradient\n};\ninherits(LinearGradient, Gradient);\n\n/**\n * x, y, r are all percent from 0 to 1\n * @param {number} [x=0.5]\n * @param {number} [y=0.5]\n * @param {number} [r=0.5]\n * @param {Array.<Object>} [colorStops]\n * @param {boolean} [globalCoord=false]\n */\n\nvar RadialGradient = function (x, y, r, colorStops, globalCoord) {\n  // Should do nothing more in this constructor. Because gradient can be\n  // declard by `color: {type: 'radial', colorStops: ...}`, where\n  // this constructor will not be called.\n  this.x = x == null ? 0.5 : x;\n  this.y = y == null ? 0.5 : y;\n  this.r = r == null ? 0.5 : r; // Can be cloned\n\n  this.type = 'radial'; // If use global coord\n\n  this.global = globalCoord || false;\n  Gradient.call(this, colorStops);\n};\n\nRadialGradient.prototype = {\n  constructor: RadialGradient\n};\ninherits(RadialGradient, Gradient);\n\n/**\n * Displayable for incremental rendering. It will be rendered in a separate layer\n * IncrementalDisplay have too main methods. `clearDisplayables` and `addDisplayables`\n * addDisplayables will render the added displayables incremetally.\n *\n * It use a not clearFlag to tell the painter don't clear the layer if it's the first element.\n */\nfunction IncrementalDisplayble(opts) {\n  Displayable.call(this, opts);\n  this._displayables = [];\n  this._temporaryDisplayables = [];\n  this._cursor = 0;\n  this.notClear = true;\n}\n\nIncrementalDisplayble.prototype.incremental = true;\n\nIncrementalDisplayble.prototype.clearDisplaybles = function () {\n  this._displayables = [];\n  this._temporaryDisplayables = [];\n  this._cursor = 0;\n  this.dirty();\n  this.notClear = false;\n};\n\nIncrementalDisplayble.prototype.addDisplayable = function (displayable, notPersistent) {\n  if (notPersistent) {\n    this._temporaryDisplayables.push(displayable);\n  } else {\n    this._displayables.push(displayable);\n  }\n\n  this.dirty();\n};\n\nIncrementalDisplayble.prototype.addDisplayables = function (displayables, notPersistent) {\n  notPersistent = notPersistent || false;\n\n  for (var i = 0; i < displayables.length; i++) {\n    this.addDisplayable(displayables[i], notPersistent);\n  }\n};\n\nIncrementalDisplayble.prototype.eachPendingDisplayable = function (cb) {\n  for (var i = this._cursor; i < this._displayables.length; i++) {\n    cb && cb(this._displayables[i]);\n  }\n\n  for (var i = 0; i < this._temporaryDisplayables.length; i++) {\n    cb && cb(this._temporaryDisplayables[i]);\n  }\n};\n\nIncrementalDisplayble.prototype.update = function () {\n  this.updateTransform();\n\n  for (var i = this._cursor; i < this._displayables.length; i++) {\n    var displayable = this._displayables[i]; // PENDING\n\n    displayable.parent = this;\n    displayable.update();\n    displayable.parent = null;\n  }\n\n  for (var i = 0; i < this._temporaryDisplayables.length; i++) {\n    var displayable = this._temporaryDisplayables[i]; // PENDING\n\n    displayable.parent = this;\n    displayable.update();\n    displayable.parent = null;\n  }\n};\n\nIncrementalDisplayble.prototype.brush = function (ctx, prevEl) {\n  // Render persistant displayables.\n  for (var i = this._cursor; i < this._displayables.length; i++) {\n    var displayable = this._displayables[i];\n    displayable.beforeBrush && displayable.beforeBrush(ctx);\n    displayable.brush(ctx, i === this._cursor ? null : this._displayables[i - 1]);\n    displayable.afterBrush && displayable.afterBrush(ctx);\n  }\n\n  this._cursor = i; // Render temporary displayables.\n\n  for (var i = 0; i < this._temporaryDisplayables.length; i++) {\n    var displayable = this._temporaryDisplayables[i];\n    displayable.beforeBrush && displayable.beforeBrush(ctx);\n    displayable.brush(ctx, i === 0 ? null : this._temporaryDisplayables[i - 1]);\n    displayable.afterBrush && displayable.afterBrush(ctx);\n  }\n\n  this._temporaryDisplayables = [];\n  this.notClear = true;\n};\n\nvar m = [];\n\nIncrementalDisplayble.prototype.getBoundingRect = function () {\n  if (!this._rect) {\n    var rect = new BoundingRect(Infinity, Infinity, -Infinity, -Infinity);\n\n    for (var i = 0; i < this._displayables.length; i++) {\n      var displayable = this._displayables[i];\n      var childRect = displayable.getBoundingRect().clone();\n\n      if (displayable.needLocalTransform()) {\n        childRect.applyTransform(displayable.getLocalTransform(m));\n      }\n\n      rect.union(childRect);\n    }\n\n    this._rect = rect;\n  }\n\n  return this._rect;\n};\n\nIncrementalDisplayble.prototype.contain = function (x, y) {\n  var localPos = this.transformCoordToLocal(x, y);\n  var rect = this.getBoundingRect();\n\n  if (rect.contain(localPos[0], localPos[1])) {\n    for (var i = 0; i < this._displayables.length; i++) {\n      var displayable = this._displayables[i];\n\n      if (displayable.contain(x, y)) {\n        return true;\n      }\n    }\n  }\n\n  return false;\n};\n\ninherits(IncrementalDisplayble, Displayable);\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar round = Math.round;\nvar mathMax$1 = Math.max;\nvar mathMin$1 = Math.min;\nvar EMPTY_OBJ = {};\n/**\n * Extend shape with parameters\n */\n\nfunction extendShape(opts) {\n  return Path.extend(opts);\n}\n/**\n * Extend path\n */\n\nfunction extendPath(pathData, opts) {\n  return extendFromString(pathData, opts);\n}\n/**\n * Create a path element from path data string\n * @param {string} pathData\n * @param {Object} opts\n * @param {module:zrender/core/BoundingRect} rect\n * @param {string} [layout=cover] 'center' or 'cover'\n */\n\nfunction makePath(pathData, opts, rect, layout) {\n  var path = createFromString(pathData, opts);\n  var boundingRect = path.getBoundingRect();\n\n  if (rect) {\n    if (layout === 'center') {\n      rect = centerGraphic(rect, boundingRect);\n    }\n\n    resizePath(path, rect);\n  }\n\n  return path;\n}\n/**\n * Create a image element from image url\n * @param {string} imageUrl image url\n * @param {Object} opts options\n * @param {module:zrender/core/BoundingRect} rect constrain rect\n * @param {string} [layout=cover] 'center' or 'cover'\n */\n\nfunction makeImage(imageUrl, rect, layout) {\n  var path = new ZImage({\n    style: {\n      image: imageUrl,\n      x: rect.x,\n      y: rect.y,\n      width: rect.width,\n      height: rect.height\n    },\n    onload: function (img) {\n      if (layout === 'center') {\n        var boundingRect = {\n          width: img.width,\n          height: img.height\n        };\n        path.setStyle(centerGraphic(rect, boundingRect));\n      }\n    }\n  });\n  return path;\n}\n/**\n * Get position of centered element in bounding box.\n *\n * @param  {Object} rect         element local bounding box\n * @param  {Object} boundingRect constraint bounding box\n * @return {Object} element position containing x, y, width, and height\n */\n\nfunction centerGraphic(rect, boundingRect) {\n  // Set rect to center, keep width / height ratio.\n  var aspect = boundingRect.width / boundingRect.height;\n  var width = rect.height * aspect;\n  var height;\n\n  if (width <= rect.width) {\n    height = rect.height;\n  } else {\n    width = rect.width;\n    height = width / aspect;\n  }\n\n  var cx = rect.x + rect.width / 2;\n  var cy = rect.y + rect.height / 2;\n  return {\n    x: cx - width / 2,\n    y: cy - height / 2,\n    width: width,\n    height: height\n  };\n}\n\nvar mergePath = mergePath$1;\n/**\n * Resize a path to fit the rect\n * @param {module:zrender/graphic/Path} path\n * @param {Object} rect\n */\n\nfunction resizePath(path, rect) {\n  if (!path.applyTransform) {\n    return;\n  }\n\n  var pathRect = path.getBoundingRect();\n  var m = pathRect.calculateTransform(rect);\n  path.applyTransform(m);\n}\n/**\n * Sub pixel optimize line for canvas\n *\n * @param {Object} param\n * @param {Object} [param.shape]\n * @param {number} [param.shape.x1]\n * @param {number} [param.shape.y1]\n * @param {number} [param.shape.x2]\n * @param {number} [param.shape.y2]\n * @param {Object} [param.style]\n * @param {number} [param.style.lineWidth]\n * @return {Object} Modified param\n */\n\nfunction subPixelOptimizeLine(param) {\n  var shape = param.shape;\n  var lineWidth = param.style.lineWidth;\n\n  if (round(shape.x1 * 2) === round(shape.x2 * 2)) {\n    shape.x1 = shape.x2 = subPixelOptimize(shape.x1, lineWidth, true);\n  }\n\n  if (round(shape.y1 * 2) === round(shape.y2 * 2)) {\n    shape.y1 = shape.y2 = subPixelOptimize(shape.y1, lineWidth, true);\n  }\n\n  return param;\n}\n/**\n * Sub pixel optimize rect for canvas\n *\n * @param {Object} param\n * @param {Object} [param.shape]\n * @param {number} [param.shape.x]\n * @param {number} [param.shape.y]\n * @param {number} [param.shape.width]\n * @param {number} [param.shape.height]\n * @param {Object} [param.style]\n * @param {number} [param.style.lineWidth]\n * @return {Object} Modified param\n */\n\nfunction subPixelOptimizeRect(param) {\n  var shape = param.shape;\n  var lineWidth = param.style.lineWidth;\n  var originX = shape.x;\n  var originY = shape.y;\n  var originWidth = shape.width;\n  var originHeight = shape.height;\n  shape.x = subPixelOptimize(shape.x, lineWidth, true);\n  shape.y = subPixelOptimize(shape.y, lineWidth, true);\n  shape.width = Math.max(subPixelOptimize(originX + originWidth, lineWidth, false) - shape.x, originWidth === 0 ? 0 : 1);\n  shape.height = Math.max(subPixelOptimize(originY + originHeight, lineWidth, false) - shape.y, originHeight === 0 ? 0 : 1);\n  return param;\n}\n/**\n * Sub pixel optimize for canvas\n *\n * @param {number} position Coordinate, such as x, y\n * @param {number} lineWidth Should be nonnegative integer.\n * @param {boolean=} positiveOrNegative Default false (negative).\n * @return {number} Optimized position.\n */\n\nfunction subPixelOptimize(position, lineWidth, positiveOrNegative) {\n  // Assure that (position + lineWidth / 2) is near integer edge,\n  // otherwise line will be fuzzy in canvas.\n  var doubledPosition = round(position * 2);\n  return (doubledPosition + round(lineWidth)) % 2 === 0 ? doubledPosition / 2 : (doubledPosition + (positiveOrNegative ? 1 : -1)) / 2;\n}\n\nfunction hasFillOrStroke(fillOrStroke) {\n  return fillOrStroke != null && fillOrStroke != 'none';\n}\n\nfunction liftColor(color) {\n  return typeof color === 'string' ? lift(color, -0.1) : color;\n}\n/**\n * @private\n */\n\n\nfunction cacheElementStl(el) {\n  if (el.__hoverStlDirty) {\n    var stroke = el.style.stroke;\n    var fill = el.style.fill; // Create hoverStyle on mouseover\n\n    var hoverStyle = el.__hoverStl;\n    hoverStyle.fill = hoverStyle.fill || (hasFillOrStroke(fill) ? liftColor(fill) : null);\n    hoverStyle.stroke = hoverStyle.stroke || (hasFillOrStroke(stroke) ? liftColor(stroke) : null);\n    var normalStyle = {};\n\n    for (var name in hoverStyle) {\n      // See comment in `doSingleEnterHover`.\n      if (hoverStyle[name] != null) {\n        normalStyle[name] = el.style[name];\n      }\n    }\n\n    el.__normalStl = normalStyle;\n    el.__hoverStlDirty = false;\n  }\n}\n/**\n * @private\n */\n\n\nfunction doSingleEnterHover(el) {\n  if (el.__isHover) {\n    return;\n  }\n\n  cacheElementStl(el);\n\n  if (el.useHoverLayer) {\n    el.__zr && el.__zr.addHover(el, el.__hoverStl);\n  } else {\n    var style = el.style;\n    var insideRollbackOpt = style.insideRollbackOpt; // Consider case: only `position: 'top'` is set on emphasis, then text\n    // color should be returned to `autoColor`, rather than remain '#fff'.\n    // So we should rollback then apply again after style merging.\n\n    insideRollbackOpt && rollbackInsideStyle(style); // styles can be:\n    // {\n    //    label: {\n    //        show: false,\n    //        position: 'outside',\n    //        fontSize: 18\n    //    },\n    //    emphasis: {\n    //        label: {\n    //            show: true\n    //        }\n    //    }\n    // },\n    // where properties of `emphasis` may not appear in `normal`. We previously use\n    // module:echarts/util/model#defaultEmphasis to merge `normal` to `emphasis`.\n    // But consider rich text and setOption in merge mode, it is impossible to cover\n    // all properties in merge. So we use merge mode when setting style here, where\n    // only properties that is not `null/undefined` can be set. The disadventage:\n    // null/undefined can not be used to remove style any more in `emphasis`.\n\n    style.extendFrom(el.__hoverStl); // Do not save `insideRollback`.\n\n    if (insideRollbackOpt) {\n      applyInsideStyle(style, style.insideOriginalTextPosition, insideRollbackOpt); // textFill may be rollbacked to null.\n\n      if (style.textFill == null) {\n        style.textFill = insideRollbackOpt.autoColor;\n      }\n    }\n\n    el.dirty(false);\n    el.z2 += 1;\n  }\n\n  el.__isHover = true;\n}\n/**\n * @inner\n */\n\n\nfunction doSingleLeaveHover(el) {\n  if (!el.__isHover) {\n    return;\n  }\n\n  var normalStl = el.__normalStl;\n\n  if (el.useHoverLayer) {\n    el.__zr && el.__zr.removeHover(el);\n  } else {\n    // Consider null/undefined value, should use\n    // `setStyle` but not `extendFrom(stl, true)`.\n    normalStl && el.setStyle(normalStl);\n    el.z2 -= 1;\n  }\n\n  el.__isHover = false;\n}\n/**\n * @inner\n */\n\n\nfunction doEnterHover(el) {\n  el.type === 'group' ? el.traverse(function (child) {\n    if (child.type !== 'group') {\n      doSingleEnterHover(child);\n    }\n  }) : doSingleEnterHover(el);\n}\n\nfunction doLeaveHover(el) {\n  el.type === 'group' ? el.traverse(function (child) {\n    if (child.type !== 'group') {\n      doSingleLeaveHover(child);\n    }\n  }) : doSingleLeaveHover(el);\n}\n/**\n * @inner\n */\n\n\nfunction setElementHoverStl(el, hoverStl) {\n  // If element has sepcified hoverStyle, then use it instead of given hoverStyle\n  // Often used when item group has a label element and it's hoverStyle is different\n  el.__hoverStl = el.hoverStyle || hoverStl || {};\n  el.__hoverStlDirty = true;\n\n  if (el.__isHover) {\n    cacheElementStl(el);\n  }\n}\n/**\n * @inner\n */\n\n\nfunction onElementMouseOver(e) {\n  if (this.__hoverSilentOnTouch && e.zrByTouch) {\n    return;\n  } // Only if element is not in emphasis status\n\n\n  !this.__isEmphasis && doEnterHover(this);\n}\n/**\n * @inner\n */\n\n\nfunction onElementMouseOut(e) {\n  if (this.__hoverSilentOnTouch && e.zrByTouch) {\n    return;\n  } // Only if element is not in emphasis status\n\n\n  !this.__isEmphasis && doLeaveHover(this);\n}\n/**\n * @inner\n */\n\n\nfunction enterEmphasis() {\n  this.__isEmphasis = true;\n  doEnterHover(this);\n}\n/**\n * @inner\n */\n\n\nfunction leaveEmphasis() {\n  this.__isEmphasis = false;\n  doLeaveHover(this);\n}\n/**\n * Set hover style of element.\n * This method can be called repeatly without side-effects.\n * @param {module:zrender/Element} el\n * @param {Object} [hoverStyle]\n * @param {Object} [opt]\n * @param {boolean} [opt.hoverSilentOnTouch=false]\n *        In touch device, mouseover event will be trigger on touchstart event\n *        (see module:zrender/dom/HandlerProxy). By this mechanism, we can\n *        conviniently use hoverStyle when tap on touch screen without additional\n *        code for compatibility.\n *        But if the chart/component has select feature, which usually also use\n *        hoverStyle, there might be conflict between 'select-highlight' and\n *        'hover-highlight' especially when roam is enabled (see geo for example).\n *        In this case, hoverSilentOnTouch should be used to disable hover-highlight\n *        on touch device.\n */\n\n\nfunction setHoverStyle(el, hoverStyle, opt) {\n  el.__hoverSilentOnTouch = opt && opt.hoverSilentOnTouch;\n  el.type === 'group' ? el.traverse(function (child) {\n    if (child.type !== 'group') {\n      setElementHoverStl(child, hoverStyle);\n    }\n  }) : setElementHoverStl(el, hoverStyle); // Duplicated function will be auto-ignored, see Eventful.js.\n\n  el.on('mouseover', onElementMouseOver).on('mouseout', onElementMouseOut); // Emphasis, normal can be triggered manually\n\n  el.on('emphasis', enterEmphasis).on('normal', leaveEmphasis);\n}\n/**\n * @param {Object|module:zrender/graphic/Style} normalStyle\n * @param {Object} emphasisStyle\n * @param {module:echarts/model/Model} normalModel\n * @param {module:echarts/model/Model} emphasisModel\n * @param {Object} opt Check `opt` of `setTextStyleCommon` to find other props.\n * @param {string|Function} [opt.defaultText]\n * @param {module:echarts/model/Model} [opt.labelFetcher] Fetch text by\n *      `opt.labelFetcher.getFormattedLabel(opt.labelDataIndex, 'normal'/'emphasis', null, opt.labelDimIndex)`\n * @param {module:echarts/model/Model} [opt.labelDataIndex] Fetch text by\n *      `opt.textFetcher.getFormattedLabel(opt.labelDataIndex, 'normal'/'emphasis', null, opt.labelDimIndex)`\n * @param {module:echarts/model/Model} [opt.labelDimIndex] Fetch text by\n *      `opt.textFetcher.getFormattedLabel(opt.labelDataIndex, 'normal'/'emphasis', null, opt.labelDimIndex)`\n * @param {Object} [normalSpecified]\n * @param {Object} [emphasisSpecified]\n */\n\nfunction setLabelStyle(normalStyle, emphasisStyle, normalModel, emphasisModel, opt, normalSpecified, emphasisSpecified) {\n  opt = opt || EMPTY_OBJ;\n  var labelFetcher = opt.labelFetcher;\n  var labelDataIndex = opt.labelDataIndex;\n  var labelDimIndex = opt.labelDimIndex; // This scenario, `label.normal.show = true; label.emphasis.show = false`,\n  // is not supported util someone requests.\n\n  var showNormal = normalModel.getShallow('show');\n  var showEmphasis = emphasisModel.getShallow('show'); // Consider performance, only fetch label when necessary.\n  // If `normal.show` is `false` and `emphasis.show` is `true` and `emphasis.formatter` is not set,\n  // label should be displayed, where text is fetched by `normal.formatter` or `opt.defaultText`.\n\n  var baseText;\n\n  if (showNormal || showEmphasis) {\n    if (labelFetcher) {\n      baseText = labelFetcher.getFormattedLabel(labelDataIndex, 'normal', null, labelDimIndex);\n    }\n\n    if (baseText == null) {\n      baseText = isFunction$1(opt.defaultText) ? opt.defaultText(labelDataIndex, opt) : opt.defaultText;\n    }\n  }\n\n  var normalStyleText = showNormal ? baseText : null;\n  var emphasisStyleText = showEmphasis ? retrieve2(labelFetcher ? labelFetcher.getFormattedLabel(labelDataIndex, 'emphasis', null, labelDimIndex) : null, baseText) : null; // Optimize: If style.text is null, text will not be drawn.\n\n  if (normalStyleText != null || emphasisStyleText != null) {\n    // Always set `textStyle` even if `normalStyle.text` is null, because default\n    // values have to be set on `normalStyle`.\n    // If we set default values on `emphasisStyle`, consider case:\n    // Firstly, `setOption(... label: {normal: {text: null}, emphasis: {show: true}} ...);`\n    // Secondly, `setOption(... label: {noraml: {show: true, text: 'abc', color: 'red'} ...);`\n    // Then the 'red' will not work on emphasis.\n    setTextStyle(normalStyle, normalModel, normalSpecified, opt);\n    setTextStyle(emphasisStyle, emphasisModel, emphasisSpecified, opt, true);\n  }\n\n  normalStyle.text = normalStyleText;\n  emphasisStyle.text = emphasisStyleText;\n}\n/**\n * Set basic textStyle properties.\n * @param {Object|module:zrender/graphic/Style} textStyle\n * @param {module:echarts/model/Model} model\n * @param {Object} [specifiedTextStyle] Can be overrided by settings in model.\n * @param {Object} [opt] See `opt` of `setTextStyleCommon`.\n * @param {boolean} [isEmphasis]\n */\n\nfunction setTextStyle(textStyle, textStyleModel, specifiedTextStyle, opt, isEmphasis) {\n  setTextStyleCommon(textStyle, textStyleModel, opt, isEmphasis);\n  specifiedTextStyle && extend(textStyle, specifiedTextStyle);\n  textStyle.host && textStyle.host.dirty && textStyle.host.dirty(false);\n  return textStyle;\n}\n/**\n * Set text option in the style.\n * @deprecated\n * @param {Object} textStyle\n * @param {module:echarts/model/Model} labelModel\n * @param {string|boolean} defaultColor Default text color.\n *        If set as false, it will be processed as a emphasis style.\n */\n\nfunction setText(textStyle, labelModel, defaultColor) {\n  var opt = {\n    isRectText: true\n  };\n  var isEmphasis;\n\n  if (defaultColor === false) {\n    isEmphasis = true;\n  } else {\n    // Support setting color as 'auto' to get visual color.\n    opt.autoColor = defaultColor;\n  }\n\n  setTextStyleCommon(textStyle, labelModel, opt, isEmphasis);\n  textStyle.host && textStyle.host.dirty && textStyle.host.dirty(false);\n}\n/**\n * {\n *      disableBox: boolean, Whether diable drawing box of block (outer most).\n *      isRectText: boolean,\n *      autoColor: string, specify a color when color is 'auto',\n *              for textFill, textStroke, textBackgroundColor, and textBorderColor.\n *              If autoColor specified, it is used as default textFill.\n *      useInsideStyle:\n *              `true`: Use inside style (textFill, textStroke, textStrokeWidth)\n *                  if `textFill` is not specified.\n *              `false`: Do not use inside style.\n *              `null/undefined`: use inside style if `isRectText` is true and\n *                  `textFill` is not specified and textPosition contains `'inside'`.\n *      forceRich: boolean\n * }\n */\n\nfunction setTextStyleCommon(textStyle, textStyleModel, opt, isEmphasis) {\n  // Consider there will be abnormal when merge hover style to normal style if given default value.\n  opt = opt || EMPTY_OBJ;\n\n  if (opt.isRectText) {\n    var textPosition = textStyleModel.getShallow('position') || (isEmphasis ? null : 'inside'); // 'outside' is not a valid zr textPostion value, but used\n    // in bar series, and magric type should be considered.\n\n    textPosition === 'outside' && (textPosition = 'top');\n    textStyle.textPosition = textPosition;\n    textStyle.textOffset = textStyleModel.getShallow('offset');\n    var labelRotate = textStyleModel.getShallow('rotate');\n    labelRotate != null && (labelRotate *= Math.PI / 180);\n    textStyle.textRotation = labelRotate;\n    textStyle.textDistance = retrieve2(textStyleModel.getShallow('distance'), isEmphasis ? null : 5);\n  }\n\n  var ecModel = textStyleModel.ecModel;\n  var globalTextStyle = ecModel && ecModel.option.textStyle; // Consider case:\n  // {\n  //     data: [{\n  //         value: 12,\n  //         label: {\n  //             rich: {\n  //                 // no 'a' here but using parent 'a'.\n  //             }\n  //         }\n  //     }],\n  //     rich: {\n  //         a: { ... }\n  //     }\n  // }\n\n  var richItemNames = getRichItemNames(textStyleModel);\n  var richResult;\n\n  if (richItemNames) {\n    richResult = {};\n\n    for (var name in richItemNames) {\n      if (richItemNames.hasOwnProperty(name)) {\n        // Cascade is supported in rich.\n        var richTextStyle = textStyleModel.getModel(['rich', name]); // In rich, never `disableBox`.\n\n        setTokenTextStyle(richResult[name] = {}, richTextStyle, globalTextStyle, opt, isEmphasis);\n      }\n    }\n  }\n\n  textStyle.rich = richResult;\n  setTokenTextStyle(textStyle, textStyleModel, globalTextStyle, opt, isEmphasis, true);\n\n  if (opt.forceRich && !opt.textStyle) {\n    opt.textStyle = {};\n  }\n\n  return textStyle;\n} // Consider case:\n// {\n//     data: [{\n//         value: 12,\n//         label: {\n//             rich: {\n//                 // no 'a' here but using parent 'a'.\n//             }\n//         }\n//     }],\n//     rich: {\n//         a: { ... }\n//     }\n// }\n\n\nfunction getRichItemNames(textStyleModel) {\n  // Use object to remove duplicated names.\n  var richItemNameMap;\n\n  while (textStyleModel && textStyleModel !== textStyleModel.ecModel) {\n    var rich = (textStyleModel.option || EMPTY_OBJ).rich;\n\n    if (rich) {\n      richItemNameMap = richItemNameMap || {};\n\n      for (var name in rich) {\n        if (rich.hasOwnProperty(name)) {\n          richItemNameMap[name] = 1;\n        }\n      }\n    }\n\n    textStyleModel = textStyleModel.parentModel;\n  }\n\n  return richItemNameMap;\n}\n\nfunction setTokenTextStyle(textStyle, textStyleModel, globalTextStyle, opt, isEmphasis, isBlock) {\n  // In merge mode, default value should not be given.\n  globalTextStyle = !isEmphasis && globalTextStyle || EMPTY_OBJ;\n  textStyle.textFill = getAutoColor(textStyleModel.getShallow('color'), opt) || globalTextStyle.color;\n  textStyle.textStroke = getAutoColor(textStyleModel.getShallow('textBorderColor'), opt) || globalTextStyle.textBorderColor;\n  textStyle.textStrokeWidth = retrieve2(textStyleModel.getShallow('textBorderWidth'), globalTextStyle.textBorderWidth);\n\n  if (!isEmphasis) {\n    if (isBlock) {\n      // Always set `insideRollback`, for clearing previous.\n      var originalTextPosition = textStyle.textPosition;\n      textStyle.insideRollback = applyInsideStyle(textStyle, originalTextPosition, opt); // Save original textPosition, because style.textPosition will be repalced by\n      // real location (like [10, 30]) in zrender.\n\n      textStyle.insideOriginalTextPosition = originalTextPosition;\n      textStyle.insideRollbackOpt = opt;\n    } // Set default finally.\n\n\n    if (textStyle.textFill == null) {\n      textStyle.textFill = opt.autoColor;\n    }\n  } // Do not use `getFont` here, because merge should be supported, where\n  // part of these properties may be changed in emphasis style, and the\n  // others should remain their original value got from normal style.\n\n\n  textStyle.fontStyle = textStyleModel.getShallow('fontStyle') || globalTextStyle.fontStyle;\n  textStyle.fontWeight = textStyleModel.getShallow('fontWeight') || globalTextStyle.fontWeight;\n  textStyle.fontSize = textStyleModel.getShallow('fontSize') || globalTextStyle.fontSize;\n  textStyle.fontFamily = textStyleModel.getShallow('fontFamily') || globalTextStyle.fontFamily;\n  textStyle.textAlign = textStyleModel.getShallow('align');\n  textStyle.textVerticalAlign = textStyleModel.getShallow('verticalAlign') || textStyleModel.getShallow('baseline');\n  textStyle.textLineHeight = textStyleModel.getShallow('lineHeight');\n  textStyle.textWidth = textStyleModel.getShallow('width');\n  textStyle.textHeight = textStyleModel.getShallow('height');\n  textStyle.textTag = textStyleModel.getShallow('tag');\n\n  if (!isBlock || !opt.disableBox) {\n    textStyle.textBackgroundColor = getAutoColor(textStyleModel.getShallow('backgroundColor'), opt);\n    textStyle.textPadding = textStyleModel.getShallow('padding');\n    textStyle.textBorderColor = getAutoColor(textStyleModel.getShallow('borderColor'), opt);\n    textStyle.textBorderWidth = textStyleModel.getShallow('borderWidth');\n    textStyle.textBorderRadius = textStyleModel.getShallow('borderRadius');\n    textStyle.textBoxShadowColor = textStyleModel.getShallow('shadowColor');\n    textStyle.textBoxShadowBlur = textStyleModel.getShallow('shadowBlur');\n    textStyle.textBoxShadowOffsetX = textStyleModel.getShallow('shadowOffsetX');\n    textStyle.textBoxShadowOffsetY = textStyleModel.getShallow('shadowOffsetY');\n  }\n\n  textStyle.textShadowColor = textStyleModel.getShallow('textShadowColor') || globalTextStyle.textShadowColor;\n  textStyle.textShadowBlur = textStyleModel.getShallow('textShadowBlur') || globalTextStyle.textShadowBlur;\n  textStyle.textShadowOffsetX = textStyleModel.getShallow('textShadowOffsetX') || globalTextStyle.textShadowOffsetX;\n  textStyle.textShadowOffsetY = textStyleModel.getShallow('textShadowOffsetY') || globalTextStyle.textShadowOffsetY;\n}\n\nfunction getAutoColor(color, opt) {\n  return color !== 'auto' ? color : opt && opt.autoColor ? opt.autoColor : null;\n}\n\nfunction applyInsideStyle(textStyle, textPosition, opt) {\n  var useInsideStyle = opt.useInsideStyle;\n  var insideRollback;\n\n  if (textStyle.textFill == null && useInsideStyle !== false && (useInsideStyle === true || opt.isRectText && textPosition // textPosition can be [10, 30]\n  && typeof textPosition === 'string' && textPosition.indexOf('inside') >= 0)) {\n    insideRollback = {\n      textFill: null,\n      textStroke: textStyle.textStroke,\n      textStrokeWidth: textStyle.textStrokeWidth\n    };\n    textStyle.textFill = '#fff'; // Consider text with #fff overflow its container.\n\n    if (textStyle.textStroke == null) {\n      textStyle.textStroke = opt.autoColor;\n      textStyle.textStrokeWidth == null && (textStyle.textStrokeWidth = 2);\n    }\n  }\n\n  return insideRollback;\n}\n\nfunction rollbackInsideStyle(style) {\n  var insideRollback = style.insideRollback;\n\n  if (insideRollback) {\n    style.textFill = insideRollback.textFill;\n    style.textStroke = insideRollback.textStroke;\n    style.textStrokeWidth = insideRollback.textStrokeWidth;\n  }\n}\n\nfunction getFont(opt, ecModel) {\n  // ecModel or default text style model.\n  var gTextStyleModel = ecModel || ecModel.getModel('textStyle');\n  return trim([// FIXME in node-canvas fontWeight is before fontStyle\n  opt.fontStyle || gTextStyleModel && gTextStyleModel.getShallow('fontStyle') || '', opt.fontWeight || gTextStyleModel && gTextStyleModel.getShallow('fontWeight') || '', (opt.fontSize || gTextStyleModel && gTextStyleModel.getShallow('fontSize') || 12) + 'px', opt.fontFamily || gTextStyleModel && gTextStyleModel.getShallow('fontFamily') || 'sans-serif'].join(' '));\n}\n\nfunction animateOrSetProps(isUpdate, el, props, animatableModel, dataIndex, cb) {\n  if (typeof dataIndex === 'function') {\n    cb = dataIndex;\n    dataIndex = null;\n  } // Do not check 'animation' property directly here. Consider this case:\n  // animation model is an `itemModel`, whose does not have `isAnimationEnabled`\n  // but its parent model (`seriesModel`) does.\n\n\n  var animationEnabled = animatableModel && animatableModel.isAnimationEnabled();\n\n  if (animationEnabled) {\n    var postfix = isUpdate ? 'Update' : '';\n    var duration = animatableModel.getShallow('animationDuration' + postfix);\n    var animationEasing = animatableModel.getShallow('animationEasing' + postfix);\n    var animationDelay = animatableModel.getShallow('animationDelay' + postfix);\n\n    if (typeof animationDelay === 'function') {\n      animationDelay = animationDelay(dataIndex, animatableModel.getAnimationDelayParams ? animatableModel.getAnimationDelayParams(el, dataIndex) : null);\n    }\n\n    if (typeof duration === 'function') {\n      duration = duration(dataIndex);\n    }\n\n    duration > 0 ? el.animateTo(props, duration, animationDelay || 0, animationEasing, cb, !!cb) : (el.stopAnimation(), el.attr(props), cb && cb());\n  } else {\n    el.stopAnimation();\n    el.attr(props);\n    cb && cb();\n  }\n}\n/**\n * Update graphic element properties with or without animation according to the\n * configuration in series.\n *\n * Caution: this method will stop previous animation.\n * So if do not use this method to one element twice before\n * animation starts, unless you know what you are doing.\n *\n * @param {module:zrender/Element} el\n * @param {Object} props\n * @param {module:echarts/model/Model} [animatableModel]\n * @param {number} [dataIndex]\n * @param {Function} [cb]\n * @example\n *     graphic.updateProps(el, {\n *         position: [100, 100]\n *     }, seriesModel, dataIndex, function () { console.log('Animation done!'); });\n *     // Or\n *     graphic.updateProps(el, {\n *         position: [100, 100]\n *     }, seriesModel, function () { console.log('Animation done!'); });\n */\n\n\nfunction updateProps(el, props, animatableModel, dataIndex, cb) {\n  animateOrSetProps(true, el, props, animatableModel, dataIndex, cb);\n}\n/**\n * Init graphic element properties with or without animation according to the\n * configuration in series.\n *\n * Caution: this method will stop previous animation.\n * So if do not use this method to one element twice before\n * animation starts, unless you know what you are doing.\n *\n * @param {module:zrender/Element} el\n * @param {Object} props\n * @param {module:echarts/model/Model} [animatableModel]\n * @param {number} [dataIndex]\n * @param {Function} cb\n */\n\nfunction initProps(el, props, animatableModel, dataIndex, cb) {\n  animateOrSetProps(false, el, props, animatableModel, dataIndex, cb);\n}\n/**\n * Get transform matrix of target (param target),\n * in coordinate of its ancestor (param ancestor)\n *\n * @param {module:zrender/mixin/Transformable} target\n * @param {module:zrender/mixin/Transformable} [ancestor]\n */\n\nfunction getTransform(target, ancestor) {\n  var mat = identity([]);\n\n  while (target && target !== ancestor) {\n    mul$1(mat, target.getLocalTransform(), mat);\n    target = target.parent;\n  }\n\n  return mat;\n}\n/**\n * Apply transform to an vertex.\n * @param {Array.<number>} target [x, y]\n * @param {Array.<number>|TypedArray.<number>|Object} transform Can be:\n *      + Transform matrix: like [1, 0, 0, 1, 0, 0]\n *      + {position, rotation, scale}, the same as `zrender/Transformable`.\n * @param {boolean=} invert Whether use invert matrix.\n * @return {Array.<number>} [x, y]\n */\n\nfunction applyTransform$1(target, transform, invert$$1) {\n  if (transform && !isArrayLike(transform)) {\n    transform = Transformable.getLocalTransform(transform);\n  }\n\n  if (invert$$1) {\n    transform = invert([], transform);\n  }\n\n  return applyTransform([], target, transform);\n}\n/**\n * @param {string} direction 'left' 'right' 'top' 'bottom'\n * @param {Array.<number>} transform Transform matrix: like [1, 0, 0, 1, 0, 0]\n * @param {boolean=} invert Whether use invert matrix.\n * @return {string} Transformed direction. 'left' 'right' 'top' 'bottom'\n */\n\nfunction transformDirection(direction, transform, invert$$1) {\n  // Pick a base, ensure that transform result will not be (0, 0).\n  var hBase = transform[4] === 0 || transform[5] === 0 || transform[0] === 0 ? 1 : Math.abs(2 * transform[4] / transform[0]);\n  var vBase = transform[4] === 0 || transform[5] === 0 || transform[2] === 0 ? 1 : Math.abs(2 * transform[4] / transform[2]);\n  var vertex = [direction === 'left' ? -hBase : direction === 'right' ? hBase : 0, direction === 'top' ? -vBase : direction === 'bottom' ? vBase : 0];\n  vertex = applyTransform$1(vertex, transform, invert$$1);\n  return Math.abs(vertex[0]) > Math.abs(vertex[1]) ? vertex[0] > 0 ? 'right' : 'left' : vertex[1] > 0 ? 'bottom' : 'top';\n}\n/**\n * Apply group transition animation from g1 to g2.\n * If no animatableModel, no animation.\n */\n\nfunction groupTransition(g1, g2, animatableModel, cb) {\n  if (!g1 || !g2) {\n    return;\n  }\n\n  function getElMap(g) {\n    var elMap = {};\n    g.traverse(function (el) {\n      if (!el.isGroup && el.anid) {\n        elMap[el.anid] = el;\n      }\n    });\n    return elMap;\n  }\n\n  function getAnimatableProps(el) {\n    var obj = {\n      position: clone$1(el.position),\n      rotation: el.rotation\n    };\n\n    if (el.shape) {\n      obj.shape = extend({}, el.shape);\n    }\n\n    return obj;\n  }\n\n  var elMap1 = getElMap(g1);\n  g2.traverse(function (el) {\n    if (!el.isGroup && el.anid) {\n      var oldEl = elMap1[el.anid];\n\n      if (oldEl) {\n        var newProp = getAnimatableProps(el);\n        el.attr(getAnimatableProps(oldEl));\n        updateProps(el, newProp, animatableModel, el.dataIndex);\n      } // else {\n      //     if (el.previousProps) {\n      //         graphic.updateProps\n      //     }\n      // }\n\n    }\n  });\n}\n/**\n * @param {Array.<Array.<number>>} points Like: [[23, 44], [53, 66], ...]\n * @param {Object} rect {x, y, width, height}\n * @return {Array.<Array.<number>>} A new clipped points.\n */\n\nfunction clipPointsByRect(points, rect) {\n  return map(points, function (point) {\n    var x = point[0];\n    x = mathMax$1(x, rect.x);\n    x = mathMin$1(x, rect.x + rect.width);\n    var y = point[1];\n    y = mathMax$1(y, rect.y);\n    y = mathMin$1(y, rect.y + rect.height);\n    return [x, y];\n  });\n}\n/**\n * @param {Object} targetRect {x, y, width, height}\n * @param {Object} rect {x, y, width, height}\n * @return {Object} A new clipped rect. If rect size are negative, return undefined.\n */\n\nfunction clipRectByRect(targetRect, rect) {\n  var x = mathMax$1(targetRect.x, rect.x);\n  var x2 = mathMin$1(targetRect.x + targetRect.width, rect.x + rect.width);\n  var y = mathMax$1(targetRect.y, rect.y);\n  var y2 = mathMin$1(targetRect.y + targetRect.height, rect.y + rect.height);\n\n  if (x2 >= x && y2 >= y) {\n    return {\n      x: x,\n      y: y,\n      width: x2 - x,\n      height: y2 - y\n    };\n  }\n}\n/**\n * @param {string} iconStr Support 'image://' or 'path://' or direct svg path.\n * @param {Object} [opt] Properties of `module:zrender/Element`, except `style`.\n * @param {Object} [rect] {x, y, width, height}\n * @return {module:zrender/Element} Icon path or image element.\n */\n\nfunction createIcon(iconStr, opt, rect) {\n  opt = extend({\n    rectHover: true\n  }, opt);\n  var style = opt.style = {\n    strokeNoScale: true\n  };\n  rect = rect || {\n    x: -1,\n    y: -1,\n    width: 2,\n    height: 2\n  };\n\n  if (iconStr) {\n    return iconStr.indexOf('image://') === 0 ? (style.image = iconStr.slice(8), defaults(style, rect), new ZImage(opt)) : makePath(iconStr.replace('path://', ''), opt, rect, 'center');\n  }\n}\n\n\nvar graphic = (Object.freeze || Object)({\n\textendShape: extendShape,\n\textendPath: extendPath,\n\tmakePath: makePath,\n\tmakeImage: makeImage,\n\tmergePath: mergePath,\n\tresizePath: resizePath,\n\tsubPixelOptimizeLine: subPixelOptimizeLine,\n\tsubPixelOptimizeRect: subPixelOptimizeRect,\n\tsubPixelOptimize: subPixelOptimize,\n\tsetHoverStyle: setHoverStyle,\n\tsetLabelStyle: setLabelStyle,\n\tsetTextStyle: setTextStyle,\n\tsetText: setText,\n\tgetFont: getFont,\n\tupdateProps: updateProps,\n\tinitProps: initProps,\n\tgetTransform: getTransform,\n\tapplyTransform: applyTransform$1,\n\ttransformDirection: transformDirection,\n\tgroupTransition: groupTransition,\n\tclipPointsByRect: clipPointsByRect,\n\tclipRectByRect: clipRectByRect,\n\tcreateIcon: createIcon,\n\tGroup: Group,\n\tImage: ZImage,\n\tText: Text,\n\tCircle: Circle,\n\tSector: Sector,\n\tRing: Ring,\n\tPolygon: Polygon,\n\tPolyline: Polyline,\n\tRect: Rect,\n\tLine: Line,\n\tBezierCurve: BezierCurve,\n\tArc: Arc,\n\tIncrementalDisplayable: IncrementalDisplayble,\n\tCompoundPath: CompoundPath,\n\tLinearGradient: LinearGradient,\n\tRadialGradient: RadialGradient,\n\tBoundingRect: BoundingRect\n});\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar PATH_COLOR = ['textStyle', 'color'];\nvar textStyleMixin = {\n  /**\n   * Get color property or get color from option.textStyle.color\n   * @param {boolean} [isEmphasis]\n   * @return {string}\n   */\n  getTextColor: function (isEmphasis) {\n    var ecModel = this.ecModel;\n    return this.getShallow('color') || (!isEmphasis && ecModel ? ecModel.get(PATH_COLOR) : null);\n  },\n\n  /**\n   * Create font string from fontStyle, fontWeight, fontSize, fontFamily\n   * @return {string}\n   */\n  getFont: function () {\n    return getFont({\n      fontStyle: this.getShallow('fontStyle'),\n      fontWeight: this.getShallow('fontWeight'),\n      fontSize: this.getShallow('fontSize'),\n      fontFamily: this.getShallow('fontFamily')\n    }, this.ecModel);\n  },\n  getTextRect: function (text) {\n    return getBoundingRect(text, this.getFont(), this.getShallow('align'), this.getShallow('verticalAlign') || this.getShallow('baseline'), this.getShallow('padding'), this.getShallow('rich'), this.getShallow('truncateText'));\n  }\n};\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar getItemStyle = makeStyleMapper([['fill', 'color'], ['stroke', 'borderColor'], ['lineWidth', 'borderWidth'], ['opacity'], ['shadowBlur'], ['shadowOffsetX'], ['shadowOffsetY'], ['shadowColor'], ['textPosition'], ['textAlign']]);\nvar itemStyleMixin = {\n  getItemStyle: function (excludes, includes) {\n    var style = getItemStyle(this, excludes, includes);\n    var lineDash = this.getBorderLineDash();\n    lineDash && (style.lineDash = lineDash);\n    return style;\n  },\n  getBorderLineDash: function () {\n    var lineType = this.get('borderType');\n    return lineType === 'solid' || lineType == null ? null : lineType === 'dashed' ? [5, 5] : [1, 1];\n  }\n};\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * @module echarts/model/Model\n */\nvar mixin$1 = mixin;\nvar inner = makeInner();\n/**\n * @alias module:echarts/model/Model\n * @constructor\n * @param {Object} option\n * @param {module:echarts/model/Model} [parentModel]\n * @param {module:echarts/model/Global} [ecModel]\n */\n\nfunction Model(option, parentModel, ecModel) {\n  /**\n   * @type {module:echarts/model/Model}\n   * @readOnly\n   */\n  this.parentModel = parentModel;\n  /**\n   * @type {module:echarts/model/Global}\n   * @readOnly\n   */\n\n  this.ecModel = ecModel;\n  /**\n   * @type {Object}\n   * @protected\n   */\n\n  this.option = option; // Simple optimization\n  // if (this.init) {\n  //     if (arguments.length <= 4) {\n  //         this.init(option, parentModel, ecModel, extraOpt);\n  //     }\n  //     else {\n  //         this.init.apply(this, arguments);\n  //     }\n  // }\n}\n\nModel.prototype = {\n  constructor: Model,\n\n  /**\n   * Model \n   * @param {Object} option\n   */\n  init: null,\n\n  /**\n   *  Option merge\n   */\n  mergeOption: function (option) {\n    merge(this.option, option, true);\n  },\n\n  /**\n   * @param {string|Array.<string>} path\n   * @param {boolean} [ignoreParent=false]\n   * @return {*}\n   */\n  get: function (path, ignoreParent) {\n    if (path == null) {\n      return this.option;\n    }\n\n    return doGet(this.option, this.parsePath(path), !ignoreParent && getParent(this, path));\n  },\n\n  /**\n   * @param {string} key\n   * @param {boolean} [ignoreParent=false]\n   * @return {*}\n   */\n  getShallow: function (key, ignoreParent) {\n    var option = this.option;\n    var val = option == null ? option : option[key];\n    var parentModel = !ignoreParent && getParent(this, key);\n\n    if (val == null && parentModel) {\n      val = parentModel.getShallow(key);\n    }\n\n    return val;\n  },\n\n  /**\n   * @param {string|Array.<string>} [path]\n   * @param {module:echarts/model/Model} [parentModel]\n   * @return {module:echarts/model/Model}\n   */\n  getModel: function (path, parentModel) {\n    var obj = path == null ? this.option : doGet(this.option, path = this.parsePath(path));\n    var thisParentModel;\n    parentModel = parentModel || (thisParentModel = getParent(this, path)) && thisParentModel.getModel(path);\n    return new Model(obj, parentModel, this.ecModel);\n  },\n\n  /**\n   * If model has option\n   */\n  isEmpty: function () {\n    return this.option == null;\n  },\n  restoreData: function () {},\n  // Pending\n  clone: function () {\n    var Ctor = this.constructor;\n    return new Ctor(clone(this.option));\n  },\n  setReadOnly: function (properties) {// clazzUtil.setReadOnly(this, properties);\n  },\n  // If path is null/undefined, return null/undefined.\n  parsePath: function (path) {\n    if (typeof path === 'string') {\n      path = path.split('.');\n    }\n\n    return path;\n  },\n\n  /**\n   * @param {Function} getParentMethod\n   *        param {Array.<string>|string} path\n   *        return {module:echarts/model/Model}\n   */\n  customizeGetParent: function (getParentMethod) {\n    inner(this).getParent = getParentMethod;\n  },\n  isAnimationEnabled: function () {\n    if (!env$1.node) {\n      if (this.option.animation != null) {\n        return !!this.option.animation;\n      } else if (this.parentModel) {\n        return this.parentModel.isAnimationEnabled();\n      }\n    }\n  }\n};\n\nfunction doGet(obj, pathArr, parentModel) {\n  for (var i = 0; i < pathArr.length; i++) {\n    // Ignore empty\n    if (!pathArr[i]) {\n      continue;\n    } // obj could be number/string/... (like 0)\n\n\n    obj = obj && typeof obj === 'object' ? obj[pathArr[i]] : null;\n\n    if (obj == null) {\n      break;\n    }\n  }\n\n  if (obj == null && parentModel) {\n    obj = parentModel.get(pathArr);\n  }\n\n  return obj;\n} // `path` can be null/undefined\n\n\nfunction getParent(model, path) {\n  var getParentMethod = inner(model).getParent;\n  return getParentMethod ? getParentMethod.call(model, path) : model.parentModel;\n} // Enable Model.extend.\n\n\nenableClassExtend(Model);\nenableClassCheck(Model);\nmixin$1(Model, lineStyleMixin);\nmixin$1(Model, areaStyleMixin);\nmixin$1(Model, textStyleMixin);\nmixin$1(Model, itemStyleMixin);\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar base = 0;\n/**\n * @public\n * @param {string} type\n * @return {string}\n */\n\nfunction getUID(type) {\n  // Considering the case of crossing js context,\n  // use Math.random to make id as unique as possible.\n  return [type || '', base++, Math.random().toFixed(5)].join('_');\n}\n/**\n * @inner\n */\n\nfunction enableSubTypeDefaulter(entity) {\n  var subTypeDefaulters = {};\n\n  entity.registerSubTypeDefaulter = function (componentType, defaulter) {\n    componentType = parseClassType$1(componentType);\n    subTypeDefaulters[componentType.main] = defaulter;\n  };\n\n  entity.determineSubType = function (componentType, option) {\n    var type = option.type;\n\n    if (!type) {\n      var componentTypeMain = parseClassType$1(componentType).main;\n\n      if (entity.hasSubTypes(componentType) && subTypeDefaulters[componentTypeMain]) {\n        type = subTypeDefaulters[componentTypeMain](option);\n      }\n    }\n\n    return type;\n  };\n\n  return entity;\n}\n/**\n * Topological travel on Activity Network (Activity On Vertices).\n * Dependencies is defined in Model.prototype.dependencies, like ['xAxis', 'yAxis'].\n *\n * If 'xAxis' or 'yAxis' is absent in componentTypeList, just ignore it in topology.\n *\n * If there is circle dependencey, Error will be thrown.\n *\n */\n\nfunction enableTopologicalTravel(entity, dependencyGetter) {\n  /**\n   * @public\n   * @param {Array.<string>} targetNameList Target Component type list.\n   *                                           Can be ['aa', 'bb', 'aa.xx']\n   * @param {Array.<string>} fullNameList By which we can build dependency graph.\n   * @param {Function} callback Params: componentType, dependencies.\n   * @param {Object} context Scope of callback.\n   */\n  entity.topologicalTravel = function (targetNameList, fullNameList, callback, context) {\n    if (!targetNameList.length) {\n      return;\n    }\n\n    var result = makeDepndencyGraph(fullNameList);\n    var graph = result.graph;\n    var stack = result.noEntryList;\n    var targetNameSet = {};\n    each$1(targetNameList, function (name) {\n      targetNameSet[name] = true;\n    });\n\n    while (stack.length) {\n      var currComponentType = stack.pop();\n      var currVertex = graph[currComponentType];\n      var isInTargetNameSet = !!targetNameSet[currComponentType];\n\n      if (isInTargetNameSet) {\n        callback.call(context, currComponentType, currVertex.originalDeps.slice());\n        delete targetNameSet[currComponentType];\n      }\n\n      each$1(currVertex.successor, isInTargetNameSet ? removeEdgeAndAdd : removeEdge);\n    }\n\n    each$1(targetNameSet, function () {\n      throw new Error('Circle dependency may exists');\n    });\n\n    function removeEdge(succComponentType) {\n      graph[succComponentType].entryCount--;\n\n      if (graph[succComponentType].entryCount === 0) {\n        stack.push(succComponentType);\n      }\n    } // Consider this case: legend depends on series, and we call\n    // chart.setOption({series: [...]}), where only series is in option.\n    // If we do not have 'removeEdgeAndAdd', legendModel.mergeOption will\n    // not be called, but only sereis.mergeOption is called. Thus legend\n    // have no chance to update its local record about series (like which\n    // name of series is available in legend).\n\n\n    function removeEdgeAndAdd(succComponentType) {\n      targetNameSet[succComponentType] = true;\n      removeEdge(succComponentType);\n    }\n  };\n  /**\n   * DepndencyGraph: {Object}\n   * key: conponentType,\n   * value: {\n   *     successor: [conponentTypes...],\n   *     originalDeps: [conponentTypes...],\n   *     entryCount: {number}\n   * }\n   */\n\n\n  function makeDepndencyGraph(fullNameList) {\n    var graph = {};\n    var noEntryList = [];\n    each$1(fullNameList, function (name) {\n      var thisItem = createDependencyGraphItem(graph, name);\n      var originalDeps = thisItem.originalDeps = dependencyGetter(name);\n      var availableDeps = getAvailableDependencies(originalDeps, fullNameList);\n      thisItem.entryCount = availableDeps.length;\n\n      if (thisItem.entryCount === 0) {\n        noEntryList.push(name);\n      }\n\n      each$1(availableDeps, function (dependentName) {\n        if (indexOf(thisItem.predecessor, dependentName) < 0) {\n          thisItem.predecessor.push(dependentName);\n        }\n\n        var thatItem = createDependencyGraphItem(graph, dependentName);\n\n        if (indexOf(thatItem.successor, dependentName) < 0) {\n          thatItem.successor.push(name);\n        }\n      });\n    });\n    return {\n      graph: graph,\n      noEntryList: noEntryList\n    };\n  }\n\n  function createDependencyGraphItem(graph, name) {\n    if (!graph[name]) {\n      graph[name] = {\n        predecessor: [],\n        successor: []\n      };\n    }\n\n    return graph[name];\n  }\n\n  function getAvailableDependencies(originalDeps, fullNameList) {\n    var availableDeps = [];\n    each$1(originalDeps, function (dep) {\n      indexOf(fullNameList, dep) >= 0 && availableDeps.push(dep);\n    });\n    return availableDeps;\n  }\n}\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar RADIAN_EPSILON = 1e-4;\n\nfunction _trim(str) {\n  return str.replace(/^\\s+/, '').replace(/\\s+$/, '');\n}\n/**\n * Linear mapping a value from domain to range\n * @memberOf module:echarts/util/number\n * @param  {(number|Array.<number>)} val\n * @param  {Array.<number>} domain Domain extent domain[0] can be bigger than domain[1]\n * @param  {Array.<number>} range  Range extent range[0] can be bigger than range[1]\n * @param  {boolean} clamp\n * @return {(number|Array.<number>}\n */\n\n\nfunction linearMap(val, domain, range, clamp) {\n  var subDomain = domain[1] - domain[0];\n  var subRange = range[1] - range[0];\n\n  if (subDomain === 0) {\n    return subRange === 0 ? range[0] : (range[0] + range[1]) / 2;\n  } // Avoid accuracy problem in edge, such as\n  // 146.39 - 62.83 === 83.55999999999999.\n  // See echarts/test/ut/spec/util/number.js#linearMap#accuracyError\n  // It is a little verbose for efficiency considering this method\n  // is a hotspot.\n\n\n  if (clamp) {\n    if (subDomain > 0) {\n      if (val <= domain[0]) {\n        return range[0];\n      } else if (val >= domain[1]) {\n        return range[1];\n      }\n    } else {\n      if (val >= domain[0]) {\n        return range[0];\n      } else if (val <= domain[1]) {\n        return range[1];\n      }\n    }\n  } else {\n    if (val === domain[0]) {\n      return range[0];\n    }\n\n    if (val === domain[1]) {\n      return range[1];\n    }\n  }\n\n  return (val - domain[0]) / subDomain * subRange + range[0];\n}\n/**\n * Convert a percent string to absolute number.\n * Returns NaN if percent is not a valid string or number\n * @memberOf module:echarts/util/number\n * @param {string|number} percent\n * @param {number} all\n * @return {number}\n */\n\nfunction parsePercent$1(percent, all) {\n  switch (percent) {\n    case 'center':\n    case 'middle':\n      percent = '50%';\n      break;\n\n    case 'left':\n    case 'top':\n      percent = '0%';\n      break;\n\n    case 'right':\n    case 'bottom':\n      percent = '100%';\n      break;\n  }\n\n  if (typeof percent === 'string') {\n    if (_trim(percent).match(/%$/)) {\n      return parseFloat(percent) / 100 * all;\n    }\n\n    return parseFloat(percent);\n  }\n\n  return percent == null ? NaN : +percent;\n}\n/**\n * (1) Fix rounding error of float numbers.\n * (2) Support return string to avoid scientific notation like '3.5e-7'.\n *\n * @param {number} x\n * @param {number} [precision]\n * @param {boolean} [returnStr]\n * @return {number|string}\n */\n\nfunction round$1(x, precision, returnStr) {\n  if (precision == null) {\n    precision = 10;\n  } // Avoid range error\n\n\n  precision = Math.min(Math.max(0, precision), 20);\n  x = (+x).toFixed(precision);\n  return returnStr ? x : +x;\n}\nfunction asc(arr) {\n  arr.sort(function (a, b) {\n    return a - b;\n  });\n  return arr;\n}\n/**\n * Get precision\n * @param {number} val\n */\n\nfunction getPrecision(val) {\n  val = +val;\n\n  if (isNaN(val)) {\n    return 0;\n  } // It is much faster than methods converting number to string as follows\n  //      var tmp = val.toString();\n  //      return tmp.length - 1 - tmp.indexOf('.');\n  // especially when precision is low\n\n\n  var e = 1;\n  var count = 0;\n\n  while (Math.round(val * e) / e !== val) {\n    e *= 10;\n    count++;\n  }\n\n  return count;\n}\n/**\n * @param {string|number} val\n * @return {number}\n */\n\nfunction getPrecisionSafe(val) {\n  var str = val.toString(); // Consider scientific notation: '3.4e-12' '3.4e+12'\n\n  var eIndex = str.indexOf('e');\n\n  if (eIndex > 0) {\n    var precision = +str.slice(eIndex + 1);\n    return precision < 0 ? -precision : 0;\n  } else {\n    var dotIndex = str.indexOf('.');\n    return dotIndex < 0 ? 0 : str.length - 1 - dotIndex;\n  }\n}\n/**\n * Minimal dicernible data precisioin according to a single pixel.\n *\n * @param {Array.<number>} dataExtent\n * @param {Array.<number>} pixelExtent\n * @return {number} precision\n */\n\nfunction getPixelPrecision(dataExtent, pixelExtent) {\n  var log = Math.log;\n  var LN10 = Math.LN10;\n  var dataQuantity = Math.floor(log(dataExtent[1] - dataExtent[0]) / LN10);\n  var sizeQuantity = Math.round(log(Math.abs(pixelExtent[1] - pixelExtent[0])) / LN10); // toFixed() digits argument must be between 0 and 20.\n\n  var precision = Math.min(Math.max(-dataQuantity + sizeQuantity, 0), 20);\n  return !isFinite(precision) ? 20 : precision;\n}\n/**\n * Get a data of given precision, assuring the sum of percentages\n * in valueList is 1.\n * The largest remainer method is used.\n * https://en.wikipedia.org/wiki/Largest_remainder_method\n *\n * @param {Array.<number>} valueList a list of all data\n * @param {number} idx index of the data to be processed in valueList\n * @param {number} precision integer number showing digits of precision\n * @return {number} percent ranging from 0 to 100\n */\n\nfunction getPercentWithPrecision(valueList, idx, precision) {\n  if (!valueList[idx]) {\n    return 0;\n  }\n\n  var sum = reduce(valueList, function (acc, val) {\n    return acc + (isNaN(val) ? 0 : val);\n  }, 0);\n\n  if (sum === 0) {\n    return 0;\n  }\n\n  var digits = Math.pow(10, precision);\n  var votesPerQuota = map(valueList, function (val) {\n    return (isNaN(val) ? 0 : val) / sum * digits * 100;\n  });\n  var targetSeats = digits * 100;\n  var seats = map(votesPerQuota, function (votes) {\n    // Assign automatic seats.\n    return Math.floor(votes);\n  });\n  var currentSum = reduce(seats, function (acc, val) {\n    return acc + val;\n  }, 0);\n  var remainder = map(votesPerQuota, function (votes, idx) {\n    return votes - seats[idx];\n  }); // Has remainding votes.\n\n  while (currentSum < targetSeats) {\n    // Find next largest remainder.\n    var max = Number.NEGATIVE_INFINITY;\n    var maxId = null;\n\n    for (var i = 0, len = remainder.length; i < len; ++i) {\n      if (remainder[i] > max) {\n        max = remainder[i];\n        maxId = i;\n      }\n    } // Add a vote to max remainder.\n\n\n    ++seats[maxId];\n    remainder[maxId] = 0;\n    ++currentSum;\n  }\n\n  return seats[idx] / digits;\n} // Number.MAX_SAFE_INTEGER, ie do not support.\n\nvar MAX_SAFE_INTEGER = 9007199254740991;\n/**\n * To 0 - 2 * PI, considering negative radian.\n * @param {number} radian\n * @return {number}\n */\n\nfunction remRadian(radian) {\n  var pi2 = Math.PI * 2;\n  return (radian % pi2 + pi2) % pi2;\n}\n/**\n * @param {type} radian\n * @return {boolean}\n */\n\nfunction isRadianAroundZero(val) {\n  return val > -RADIAN_EPSILON && val < RADIAN_EPSILON;\n}\nvar TIME_REG = /^(?:(\\d{4})(?:[-\\/](\\d{1,2})(?:[-\\/](\\d{1,2})(?:[T ](\\d{1,2})(?::(\\d\\d)(?::(\\d\\d)(?:[.,](\\d+))?)?)?(Z|[\\+\\-]\\d\\d:?\\d\\d)?)?)?)?)?$/; // jshint ignore:line\n\n/**\n * @param {string|Date|number} value These values can be accepted:\n *   + An instance of Date, represent a time in its own time zone.\n *   + Or string in a subset of ISO 8601, only including:\n *     + only year, month, date: '2012-03', '2012-03-01', '2012-03-01 05', '2012-03-01 05:06',\n *     + separated with T or space: '2012-03-01T12:22:33.123', '2012-03-01 12:22:33.123',\n *     + time zone: '2012-03-01T12:22:33Z', '2012-03-01T12:22:33+8000', '2012-03-01T12:22:33-05:00',\n *     all of which will be treated as local time if time zone is not specified\n *     (see <https://momentjs.com/>).\n *   + Or other string format, including (all of which will be treated as loacal time):\n *     '2012', '2012-3-1', '2012/3/1', '2012/03/01',\n *     '2009/6/12 2:00', '2009/6/12 2:05:08', '2009/6/12 2:05:08.123'\n *   + a timestamp, which represent a time in UTC.\n * @return {Date} date\n */\n\nfunction parseDate(value) {\n  if (value instanceof Date) {\n    return value;\n  } else if (typeof value === 'string') {\n    // Different browsers parse date in different way, so we parse it manually.\n    // Some other issues:\n    // new Date('1970-01-01') is UTC,\n    // new Date('1970/01/01') and new Date('1970-1-01') is local.\n    // See issue #3623\n    var match = TIME_REG.exec(value);\n\n    if (!match) {\n      // return Invalid Date.\n      return new Date(NaN);\n    } // Use local time when no timezone offset specifed.\n\n\n    if (!match[8]) {\n      // match[n] can only be string or undefined.\n      // But take care of '12' + 1 => '121'.\n      return new Date(+match[1], +(match[2] || 1) - 1, +match[3] || 1, +match[4] || 0, +(match[5] || 0), +match[6] || 0, +match[7] || 0);\n    } // Timezoneoffset of Javascript Date has considered DST (Daylight Saving Time,\n    // https://tc39.github.io/ecma262/#sec-daylight-saving-time-adjustment).\n    // For example, system timezone is set as \"Time Zone: America/Toronto\",\n    // then these code will get different result:\n    // `new Date(1478411999999).getTimezoneOffset();  // get 240`\n    // `new Date(1478412000000).getTimezoneOffset();  // get 300`\n    // So we should not use `new Date`, but use `Date.UTC`.\n    else {\n        var hour = +match[4] || 0;\n\n        if (match[8].toUpperCase() !== 'Z') {\n          hour -= match[8].slice(0, 3);\n        }\n\n        return new Date(Date.UTC(+match[1], +(match[2] || 1) - 1, +match[3] || 1, hour, +(match[5] || 0), +match[6] || 0, +match[7] || 0));\n      }\n  } else if (value == null) {\n    return new Date(NaN);\n  }\n\n  return new Date(Math.round(value));\n}\n/**\n * Quantity of a number. e.g. 0.1, 1, 10, 100\n *\n * @param  {number} val\n * @return {number}\n */\n\nfunction quantity(val) {\n  return Math.pow(10, quantityExponent(val));\n}\n\nfunction quantityExponent(val) {\n  return Math.floor(Math.log(val) / Math.LN10);\n}\n/**\n * find a nice number approximately equal to x. Round the number if round = true,\n * take ceiling if round = false. The primary observation is that the nicest\n * numbers in decimal are 1, 2, and 5, and all power-of-ten multiples of these numbers.\n *\n * See \"Nice Numbers for Graph Labels\" of Graphic Gems.\n *\n * @param  {number} val Non-negative value.\n * @param  {boolean} round\n * @return {number}\n */\n\n\nfunction nice(val, round) {\n  var exponent = quantityExponent(val);\n  var exp10 = Math.pow(10, exponent);\n  var f = val / exp10; // 1 <= f < 10\n\n  var nf;\n\n  if (round) {\n    if (f < 1.5) {\n      nf = 1;\n    } else if (f < 2.5) {\n      nf = 2;\n    } else if (f < 4) {\n      nf = 3;\n    } else if (f < 7) {\n      nf = 5;\n    } else {\n      nf = 10;\n    }\n  } else {\n    if (f < 1) {\n      nf = 1;\n    } else if (f < 2) {\n      nf = 2;\n    } else if (f < 3) {\n      nf = 3;\n    } else if (f < 5) {\n      nf = 5;\n    } else {\n      nf = 10;\n    }\n  }\n\n  val = nf * exp10; // Fix 3 * 0.1 === 0.30000000000000004 issue (see IEEE 754).\n  // 20 is the uppper bound of toFixed.\n\n  return exponent >= -20 ? +val.toFixed(exponent < 0 ? -exponent : 0) : val;\n}\n/**\n * Order intervals asc, and split them when overlap.\n * expect(numberUtil.reformIntervals([\n *     {interval: [18, 62], close: [1, 1]},\n *     {interval: [-Infinity, -70], close: [0, 0]},\n *     {interval: [-70, -26], close: [1, 1]},\n *     {interval: [-26, 18], close: [1, 1]},\n *     {interval: [62, 150], close: [1, 1]},\n *     {interval: [106, 150], close: [1, 1]},\n *     {interval: [150, Infinity], close: [0, 0]}\n * ])).toEqual([\n *     {interval: [-Infinity, -70], close: [0, 0]},\n *     {interval: [-70, -26], close: [1, 1]},\n *     {interval: [-26, 18], close: [0, 1]},\n *     {interval: [18, 62], close: [0, 1]},\n *     {interval: [62, 150], close: [0, 1]},\n *     {interval: [150, Infinity], close: [0, 0]}\n * ]);\n * @param {Array.<Object>} list, where `close` mean open or close\n *        of the interval, and Infinity can be used.\n * @return {Array.<Object>} The origin list, which has been reformed.\n */\n\nfunction reformIntervals(list) {\n  list.sort(function (a, b) {\n    return littleThan(a, b, 0) ? -1 : 1;\n  });\n  var curr = -Infinity;\n  var currClose = 1;\n\n  for (var i = 0; i < list.length;) {\n    var interval = list[i].interval;\n    var close = list[i].close;\n\n    for (var lg = 0; lg < 2; lg++) {\n      if (interval[lg] <= curr) {\n        interval[lg] = curr;\n        close[lg] = !lg ? 1 - currClose : 1;\n      }\n\n      curr = interval[lg];\n      currClose = close[lg];\n    }\n\n    if (interval[0] === interval[1] && close[0] * close[1] !== 1) {\n      list.splice(i, 1);\n    } else {\n      i++;\n    }\n  }\n\n  return list;\n\n  function littleThan(a, b, lg) {\n    return a.interval[lg] < b.interval[lg] || a.interval[lg] === b.interval[lg] && (a.close[lg] - b.close[lg] === (!lg ? 1 : -1) || !lg && littleThan(a, b, 1));\n  }\n}\n/**\n * parseFloat NaNs numeric-cast false positives (null|true|false|\"\")\n * ...but misinterprets leading-number strings, particularly hex literals (\"0x...\")\n * subtraction forces infinities to NaN\n *\n * @param {*} v\n * @return {boolean}\n */\n\nfunction isNumeric(v) {\n  return v - parseFloat(v) >= 0;\n}\n\nvar number = (Object.freeze || Object)({\n\tlinearMap: linearMap,\n\tparsePercent: parsePercent$1,\n\tround: round$1,\n\tasc: asc,\n\tgetPrecision: getPrecision,\n\tgetPrecisionSafe: getPrecisionSafe,\n\tgetPixelPrecision: getPixelPrecision,\n\tgetPercentWithPrecision: getPercentWithPrecision,\n\tMAX_SAFE_INTEGER: MAX_SAFE_INTEGER,\n\tremRadian: remRadian,\n\tisRadianAroundZero: isRadianAroundZero,\n\tparseDate: parseDate,\n\tquantity: quantity,\n\tnice: nice,\n\treformIntervals: reformIntervals,\n\tisNumeric: isNumeric\n});\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n/**\n * ,\n * @param {string|number} x\n * @return {string}\n */\n\nfunction addCommas(x) {\n  if (isNaN(x)) {\n    return '-';\n  }\n\n  x = (x + '').split('.');\n  return x[0].replace(/(\\d{1,3})(?=(?:\\d{3})+(?!\\d))/g, '$1,') + (x.length > 1 ? '.' + x[1] : '');\n}\n/**\n * @param {string} str\n * @param {boolean} [upperCaseFirst=false]\n * @return {string} str\n */\n\nfunction toCamelCase(str, upperCaseFirst) {\n  str = (str || '').toLowerCase().replace(/-(.)/g, function (match, group1) {\n    return group1.toUpperCase();\n  });\n\n  if (upperCaseFirst && str) {\n    str = str.charAt(0).toUpperCase() + str.slice(1);\n  }\n\n  return str;\n}\nvar normalizeCssArray$1 = normalizeCssArray;\nvar replaceReg = /([&<>\"'])/g;\nvar replaceMap = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  '\\'': '&#39;'\n};\nfunction encodeHTML(source) {\n  return source == null ? '' : (source + '').replace(replaceReg, function (str, c) {\n    return replaceMap[c];\n  });\n}\nvar TPL_VAR_ALIAS = ['a', 'b', 'c', 'd', 'e', 'f', 'g'];\n\nvar wrapVar = function (varName, seriesIdx) {\n  return '{' + varName + (seriesIdx == null ? '' : seriesIdx) + '}';\n};\n/**\n * Template formatter\n * @param {string} tpl\n * @param {Array.<Object>|Object} paramsList\n * @param {boolean} [encode=false]\n * @return {string}\n */\n\n\nfunction formatTpl(tpl, paramsList, encode) {\n  if (!isArray(paramsList)) {\n    paramsList = [paramsList];\n  }\n\n  var seriesLen = paramsList.length;\n\n  if (!seriesLen) {\n    return '';\n  }\n\n  var $vars = paramsList[0].$vars || [];\n\n  for (var i = 0; i < $vars.length; i++) {\n    var alias = TPL_VAR_ALIAS[i];\n    tpl = tpl.replace(wrapVar(alias), wrapVar(alias, 0));\n  }\n\n  for (var seriesIdx = 0; seriesIdx < seriesLen; seriesIdx++) {\n    for (var k = 0; k < $vars.length; k++) {\n      var val = paramsList[seriesIdx][$vars[k]];\n      tpl = tpl.replace(wrapVar(TPL_VAR_ALIAS[k], seriesIdx), encode ? encodeHTML(val) : val);\n    }\n  }\n\n  return tpl;\n}\n/**\n * simple Template formatter\n *\n * @param {string} tpl\n * @param {Object} param\n * @param {boolean} [encode=false]\n * @return {string}\n */\n\nfunction formatTplSimple(tpl, param, encode) {\n  each$1(param, function (value, key) {\n    tpl = tpl.replace('{' + key + '}', encode ? encodeHTML(value) : value);\n  });\n  return tpl;\n}\n/**\n * @param {Object|string} [opt] If string, means color.\n * @param {string} [opt.color]\n * @param {string} [opt.extraCssText]\n * @param {string} [opt.type='item'] 'item' or 'subItem'\n * @return {string}\n */\n\nfunction getTooltipMarker(opt, extraCssText) {\n  opt = isString(opt) ? {\n    color: opt,\n    extraCssText: extraCssText\n  } : opt || {};\n  var color = opt.color;\n  var type = opt.type;\n  var extraCssText = opt.extraCssText;\n\n  if (!color) {\n    return '';\n  }\n\n  return type === 'subItem' ? '<span style=\"display:inline-block;vertical-align:middle;margin-right:8px;margin-left:3px;' + 'border-radius:4px;width:4px;height:4px;background-color:' + encodeHTML(color) + ';' + (extraCssText || '') + '\"></span>' : '<span style=\"display:inline-block;margin-right:5px;' + 'border-radius:10px;width:10px;height:10px;background-color:' + encodeHTML(color) + ';' + (extraCssText || '') + '\"></span>';\n}\n\nfunction pad(str, len) {\n  str += '';\n  return '0000'.substr(0, len - str.length) + str;\n}\n/**\n * ISO Date format\n * @param {string} tpl\n * @param {number} value\n * @param {boolean} [isUTC=false] Default in local time.\n *           see `module:echarts/scale/Time`\n *           and `module:echarts/util/number#parseDate`.\n * @inner\n */\n\n\nfunction formatTime(tpl, value, isUTC) {\n  if (tpl === 'week' || tpl === 'month' || tpl === 'quarter' || tpl === 'half-year' || tpl === 'year') {\n    tpl = 'MM-dd\\nyyyy';\n  }\n\n  var date = parseDate(value);\n  var utc = isUTC ? 'UTC' : '';\n  var y = date['get' + utc + 'FullYear']();\n  var M = date['get' + utc + 'Month']() + 1;\n  var d = date['get' + utc + 'Date']();\n  var h = date['get' + utc + 'Hours']();\n  var m = date['get' + utc + 'Minutes']();\n  var s = date['get' + utc + 'Seconds']();\n  var S = date['get' + utc + 'Milliseconds']();\n  tpl = tpl.replace('MM', pad(M, 2)).replace('M', M).replace('yyyy', y).replace('yy', y % 100).replace('dd', pad(d, 2)).replace('d', d).replace('hh', pad(h, 2)).replace('h', h).replace('mm', pad(m, 2)).replace('m', m).replace('ss', pad(s, 2)).replace('s', s).replace('SSS', pad(S, 3));\n  return tpl;\n}\n/**\n * Capital first\n * @param {string} str\n * @return {string}\n */\n\nfunction capitalFirst(str) {\n  return str ? str.charAt(0).toUpperCase() + str.substr(1) : str;\n}\nvar truncateText$1 = truncateText;\nvar getTextRect = getBoundingRect;\n\nvar format = (Object.freeze || Object)({\n\taddCommas: addCommas,\n\ttoCamelCase: toCamelCase,\n\tnormalizeCssArray: normalizeCssArray$1,\n\tencodeHTML: encodeHTML,\n\tformatTpl: formatTpl,\n\tformatTplSimple: formatTplSimple,\n\tgetTooltipMarker: getTooltipMarker,\n\tformatTime: formatTime,\n\tcapitalFirst: capitalFirst,\n\ttruncateText: truncateText$1,\n\tgetTextRect: getTextRect\n});\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n// Layout helpers for each component positioning\nvar each$3 = each$1;\n/**\n * @public\n */\n\nvar LOCATION_PARAMS = ['left', 'right', 'top', 'bottom', 'width', 'height'];\n/**\n * @public\n */\n\nvar HV_NAMES = [['width', 'left', 'right'], ['height', 'top', 'bottom']];\n\nfunction boxLayout(orient, group, gap, maxWidth, maxHeight) {\n  var x = 0;\n  var y = 0;\n\n  if (maxWidth == null) {\n    maxWidth = Infinity;\n  }\n\n  if (maxHeight == null) {\n    maxHeight = Infinity;\n  }\n\n  var currentLineMaxSize = 0;\n  group.eachChild(function (child, idx) {\n    var position = child.position;\n    var rect = child.getBoundingRect();\n    var nextChild = group.childAt(idx + 1);\n    var nextChildRect = nextChild && nextChild.getBoundingRect();\n    var nextX;\n    var nextY;\n\n    if (orient === 'horizontal') {\n      var moveX = rect.width + (nextChildRect ? -nextChildRect.x + rect.x : 0);\n      nextX = x + moveX; // Wrap when width exceeds maxWidth or meet a `newline` group\n      // FIXME compare before adding gap?\n\n      if (nextX > maxWidth || child.newline) {\n        x = 0;\n        nextX = moveX;\n        y += currentLineMaxSize + gap;\n        currentLineMaxSize = rect.height;\n      } else {\n        // FIXME: consider rect.y is not `0`?\n        currentLineMaxSize = Math.max(currentLineMaxSize, rect.height);\n      }\n    } else {\n      var moveY = rect.height + (nextChildRect ? -nextChildRect.y + rect.y : 0);\n      nextY = y + moveY; // Wrap when width exceeds maxHeight or meet a `newline` group\n\n      if (nextY > maxHeight || child.newline) {\n        x += currentLineMaxSize + gap;\n        y = 0;\n        nextY = moveY;\n        currentLineMaxSize = rect.width;\n      } else {\n        currentLineMaxSize = Math.max(currentLineMaxSize, rect.width);\n      }\n    }\n\n    if (child.newline) {\n      return;\n    }\n\n    position[0] = x;\n    position[1] = y;\n    orient === 'horizontal' ? x = nextX + gap : y = nextY + gap;\n  });\n}\n/**\n * VBox or HBox layouting\n * @param {string} orient\n * @param {module:zrender/container/Group} group\n * @param {number} gap\n * @param {number} [width=Infinity]\n * @param {number} [height=Infinity]\n */\n\n\nvar box = boxLayout;\n/**\n * VBox layouting\n * @param {module:zrender/container/Group} group\n * @param {number} gap\n * @param {number} [width=Infinity]\n * @param {number} [height=Infinity]\n */\n\nvar vbox = curry(boxLayout, 'vertical');\n/**\n * HBox layouting\n * @param {module:zrender/container/Group} group\n * @param {number} gap\n * @param {number} [width=Infinity]\n * @param {number} [height=Infinity]\n */\n\nvar hbox = curry(boxLayout, 'horizontal');\n/**\n * If x or x2 is not specified or 'center' 'left' 'right',\n * the width would be as long as possible.\n * If y or y2 is not specified or 'middle' 'top' 'bottom',\n * the height would be as long as possible.\n *\n * @param {Object} positionInfo\n * @param {number|string} [positionInfo.x]\n * @param {number|string} [positionInfo.y]\n * @param {number|string} [positionInfo.x2]\n * @param {number|string} [positionInfo.y2]\n * @param {Object} containerRect {width, height}\n * @param {string|number} margin\n * @return {Object} {width, height}\n */\n\n\n/**\n * Parse position info.\n *\n * @param {Object} positionInfo\n * @param {number|string} [positionInfo.left]\n * @param {number|string} [positionInfo.top]\n * @param {number|string} [positionInfo.right]\n * @param {number|string} [positionInfo.bottom]\n * @param {number|string} [positionInfo.width]\n * @param {number|string} [positionInfo.height]\n * @param {number|string} [positionInfo.aspect] Aspect is width / height\n * @param {Object} containerRect\n * @param {string|number} [margin]\n *\n * @return {module:zrender/core/BoundingRect}\n */\n\nfunction getLayoutRect(positionInfo, containerRect, margin) {\n  margin = normalizeCssArray$1(margin || 0);\n  var containerWidth = containerRect.width;\n  var containerHeight = containerRect.height;\n  var left = parsePercent$1(positionInfo.left, containerWidth);\n  var top = parsePercent$1(positionInfo.top, containerHeight);\n  var right = parsePercent$1(positionInfo.right, containerWidth);\n  var bottom = parsePercent$1(positionInfo.bottom, containerHeight);\n  var width = parsePercent$1(positionInfo.width, containerWidth);\n  var height = parsePercent$1(positionInfo.height, containerHeight);\n  var verticalMargin = margin[2] + margin[0];\n  var horizontalMargin = margin[1] + margin[3];\n  var aspect = positionInfo.aspect; // If width is not specified, calculate width from left and right\n\n  if (isNaN(width)) {\n    width = containerWidth - right - horizontalMargin - left;\n  }\n\n  if (isNaN(height)) {\n    height = containerHeight - bottom - verticalMargin - top;\n  }\n\n  if (aspect != null) {\n    // If width and height are not given\n    // 1. Graph should not exceeds the container\n    // 2. Aspect must be keeped\n    // 3. Graph should take the space as more as possible\n    // FIXME\n    // Margin is not considered, because there is no case that both\n    // using margin and aspect so far.\n    if (isNaN(width) && isNaN(height)) {\n      if (aspect > containerWidth / containerHeight) {\n        width = containerWidth * 0.8;\n      } else {\n        height = containerHeight * 0.8;\n      }\n    } // Calculate width or height with given aspect\n\n\n    if (isNaN(width)) {\n      width = aspect * height;\n    }\n\n    if (isNaN(height)) {\n      height = width / aspect;\n    }\n  } // If left is not specified, calculate left from right and width\n\n\n  if (isNaN(left)) {\n    left = containerWidth - right - width - horizontalMargin;\n  }\n\n  if (isNaN(top)) {\n    top = containerHeight - bottom - height - verticalMargin;\n  } // Align left and top\n\n\n  switch (positionInfo.left || positionInfo.right) {\n    case 'center':\n      left = containerWidth / 2 - width / 2 - margin[3];\n      break;\n\n    case 'right':\n      left = containerWidth - width - horizontalMargin;\n      break;\n  }\n\n  switch (positionInfo.top || positionInfo.bottom) {\n    case 'middle':\n    case 'center':\n      top = containerHeight / 2 - height / 2 - margin[0];\n      break;\n\n    case 'bottom':\n      top = containerHeight - height - verticalMargin;\n      break;\n  } // If something is wrong and left, top, width, height are calculated as NaN\n\n\n  left = left || 0;\n  top = top || 0;\n\n  if (isNaN(width)) {\n    // Width may be NaN if only one value is given except width\n    width = containerWidth - horizontalMargin - left - (right || 0);\n  }\n\n  if (isNaN(height)) {\n    // Height may be NaN if only one value is given except height\n    height = containerHeight - verticalMargin - top - (bottom || 0);\n  }\n\n  var rect = new BoundingRect(left + margin[3], top + margin[0], width, height);\n  rect.margin = margin;\n  return rect;\n}\n/**\n * Position a zr element in viewport\n *  Group position is specified by either\n *  {left, top}, {right, bottom}\n *  If all properties exists, right and bottom will be igonred.\n *\n * Logic:\n *     1. Scale (against origin point in parent coord)\n *     2. Rotate (against origin point in parent coord)\n *     3. Traslate (with el.position by this method)\n * So this method only fixes the last step 'Traslate', which does not affect\n * scaling and rotating.\n *\n * If be called repeatly with the same input el, the same result will be gotten.\n *\n * @param {module:zrender/Element} el Should have `getBoundingRect` method.\n * @param {Object} positionInfo\n * @param {number|string} [positionInfo.left]\n * @param {number|string} [positionInfo.top]\n * @param {number|string} [positionInfo.right]\n * @param {number|string} [positionInfo.bottom]\n * @param {number|string} [positionInfo.width] Only for opt.boundingModel: 'raw'\n * @param {number|string} [positionInfo.height] Only for opt.boundingModel: 'raw'\n * @param {Object} containerRect\n * @param {string|number} margin\n * @param {Object} [opt]\n * @param {Array.<number>} [opt.hv=[1,1]] Only horizontal or only vertical.\n * @param {Array.<number>} [opt.boundingMode='all']\n *        Specify how to calculate boundingRect when locating.\n *        'all': Position the boundingRect that is transformed and uioned\n *               both itself and its descendants.\n *               This mode simplies confine the elements in the bounding\n *               of their container (e.g., using 'right: 0').\n *        'raw': Position the boundingRect that is not transformed and only itself.\n *               This mode is useful when you want a element can overflow its\n *               container. (Consider a rotated circle needs to be located in a corner.)\n *               In this mode positionInfo.width/height can only be number.\n */\n\n\n/**\n * @param {Object} option Contains some of the properties in HV_NAMES.\n * @param {number} hvIdx 0: horizontal; 1: vertical.\n */\n\n\n/**\n * Consider Case:\n * When defulat option has {left: 0, width: 100}, and we set {right: 0}\n * through setOption or media query, using normal zrUtil.merge will cause\n * {right: 0} does not take effect.\n *\n * @example\n * ComponentModel.extend({\n *     init: function () {\n *         ...\n *         var inputPositionParams = layout.getLayoutParams(option);\n *         this.mergeOption(inputPositionParams);\n *     },\n *     mergeOption: function (newOption) {\n *         newOption && zrUtil.merge(thisOption, newOption, true);\n *         layout.mergeLayoutParam(thisOption, newOption);\n *     }\n * });\n *\n * @param {Object} targetOption\n * @param {Object} newOption\n * @param {Object|string} [opt]\n * @param {boolean|Array.<boolean>} [opt.ignoreSize=false] Used for the components\n *  that width (or height) should not be calculated by left and right (or top and bottom).\n */\n\nfunction mergeLayoutParam(targetOption, newOption, opt) {\n  !isObject$1(opt) && (opt = {});\n  var ignoreSize = opt.ignoreSize;\n  !isArray(ignoreSize) && (ignoreSize = [ignoreSize, ignoreSize]);\n  var hResult = merge$$1(HV_NAMES[0], 0);\n  var vResult = merge$$1(HV_NAMES[1], 1);\n  copy(HV_NAMES[0], targetOption, hResult);\n  copy(HV_NAMES[1], targetOption, vResult);\n\n  function merge$$1(names, hvIdx) {\n    var newParams = {};\n    var newValueCount = 0;\n    var merged = {};\n    var mergedValueCount = 0;\n    var enoughParamNumber = 2;\n    each$3(names, function (name) {\n      merged[name] = targetOption[name];\n    });\n    each$3(names, function (name) {\n      // Consider case: newOption.width is null, which is\n      // set by user for removing width setting.\n      hasProp(newOption, name) && (newParams[name] = merged[name] = newOption[name]);\n      hasValue(newParams, name) && newValueCount++;\n      hasValue(merged, name) && mergedValueCount++;\n    });\n\n    if (ignoreSize[hvIdx]) {\n      // Only one of left/right is premitted to exist.\n      if (hasValue(newOption, names[1])) {\n        merged[names[2]] = null;\n      } else if (hasValue(newOption, names[2])) {\n        merged[names[1]] = null;\n      }\n\n      return merged;\n    } // Case: newOption: {width: ..., right: ...},\n    // or targetOption: {right: ...} and newOption: {width: ...},\n    // There is no conflict when merged only has params count\n    // little than enoughParamNumber.\n\n\n    if (mergedValueCount === enoughParamNumber || !newValueCount) {\n      return merged;\n    } // Case: newOption: {width: ..., right: ...},\n    // Than we can make sure user only want those two, and ignore\n    // all origin params in targetOption.\n    else if (newValueCount >= enoughParamNumber) {\n        return newParams;\n      } else {\n        // Chose another param from targetOption by priority.\n        for (var i = 0; i < names.length; i++) {\n          var name = names[i];\n\n          if (!hasProp(newParams, name) && hasProp(targetOption, name)) {\n            newParams[name] = targetOption[name];\n            break;\n          }\n        }\n\n        return newParams;\n      }\n  }\n\n  function hasProp(obj, name) {\n    return obj.hasOwnProperty(name);\n  }\n\n  function hasValue(obj, name) {\n    return obj[name] != null && obj[name] !== 'auto';\n  }\n\n  function copy(names, target, source) {\n    each$3(names, function (name) {\n      target[name] = source[name];\n    });\n  }\n}\n/**\n * Retrieve 'left', 'right', 'top', 'bottom', 'width', 'height' from object.\n * @param {Object} source\n * @return {Object} Result contains those props.\n */\n\nfunction getLayoutParams(source) {\n  return copyLayoutParams({}, source);\n}\n/**\n * Retrieve 'left', 'right', 'top', 'bottom', 'width', 'height' from object.\n * @param {Object} source\n * @return {Object} Result contains those props.\n */\n\nfunction copyLayoutParams(target, source) {\n  source && target && each$3(LOCATION_PARAMS, function (name) {\n    source.hasOwnProperty(name) && (target[name] = source[name]);\n  });\n  return target;\n}\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar boxLayoutMixin = {\n  getBoxLayoutParams: function () {\n    return {\n      left: this.get('left'),\n      top: this.get('top'),\n      right: this.get('right'),\n      bottom: this.get('bottom'),\n      width: this.get('width'),\n      height: this.get('height')\n    };\n  }\n};\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * Component model\n *\n * @module echarts/model/Component\n */\nvar inner$1 = makeInner();\n/**\n * @alias module:echarts/model/Component\n * @constructor\n * @param {Object} option\n * @param {module:echarts/model/Model} parentModel\n * @param {module:echarts/model/Model} ecModel\n */\n\nvar ComponentModel = Model.extend({\n  type: 'component',\n\n  /**\n   * @readOnly\n   * @type {string}\n   */\n  id: '',\n\n  /**\n   * Because simplified concept is probably better, series.name (or component.name)\n   * has been having too many resposibilities:\n   * (1) Generating id (which requires name in option should not be modified).\n   * (2) As an index to mapping series when merging option or calling API (a name\n   * can refer to more then one components, which is convinient is some case).\n   * (3) Display.\n   * @readOnly\n   */\n  name: '',\n\n  /**\n   * @readOnly\n   * @type {string}\n   */\n  mainType: '',\n\n  /**\n   * @readOnly\n   * @type {string}\n   */\n  subType: '',\n\n  /**\n   * @readOnly\n   * @type {number}\n   */\n  componentIndex: 0,\n\n  /**\n   * @type {Object}\n   * @protected\n   */\n  defaultOption: null,\n\n  /**\n   * @type {module:echarts/model/Global}\n   * @readOnly\n   */\n  ecModel: null,\n\n  /**\n   * key: componentType\n   * value:  Component model list, can not be null.\n   * @type {Object.<string, Array.<module:echarts/model/Model>>}\n   * @readOnly\n   */\n  dependentModels: [],\n\n  /**\n   * @type {string}\n   * @readOnly\n   */\n  uid: null,\n\n  /**\n   * Support merge layout params.\n   * Only support 'box' now (left/right/top/bottom/width/height).\n   * @type {string|Object} Object can be {ignoreSize: true}\n   * @readOnly\n   */\n  layoutMode: null,\n  $constructor: function (option, parentModel, ecModel, extraOpt) {\n    Model.call(this, option, parentModel, ecModel, extraOpt);\n    this.uid = getUID('ec_cpt_model');\n  },\n  init: function (option, parentModel, ecModel, extraOpt) {\n    this.mergeDefaultAndTheme(option, ecModel);\n  },\n  mergeDefaultAndTheme: function (option, ecModel) {\n    var layoutMode = this.layoutMode;\n    var inputPositionParams = layoutMode ? getLayoutParams(option) : {};\n    var themeModel = ecModel.getTheme();\n    merge(option, themeModel.get(this.mainType));\n    merge(option, this.getDefaultOption());\n\n    if (layoutMode) {\n      mergeLayoutParam(option, inputPositionParams, layoutMode);\n    }\n  },\n  mergeOption: function (option, extraOpt) {\n    merge(this.option, option, true);\n    var layoutMode = this.layoutMode;\n\n    if (layoutMode) {\n      mergeLayoutParam(this.option, option, layoutMode);\n    }\n  },\n  // Hooker after init or mergeOption\n  optionUpdated: function (newCptOption, isInit) {},\n  getDefaultOption: function () {\n    var fields = inner$1(this);\n\n    if (!fields.defaultOption) {\n      var optList = [];\n      var Class = this.constructor;\n\n      while (Class) {\n        var opt = Class.prototype.defaultOption;\n        opt && optList.push(opt);\n        Class = Class.superClass;\n      }\n\n      var defaultOption = {};\n\n      for (var i = optList.length - 1; i >= 0; i--) {\n        defaultOption = merge(defaultOption, optList[i], true);\n      }\n\n      fields.defaultOption = defaultOption;\n    }\n\n    return fields.defaultOption;\n  },\n  getReferringComponents: function (mainType) {\n    return this.ecModel.queryComponents({\n      mainType: mainType,\n      index: this.get(mainType + 'Index', true),\n      id: this.get(mainType + 'Id', true)\n    });\n  }\n}); // Reset ComponentModel.extend, add preConstruct.\n// clazzUtil.enableClassExtend(\n//     ComponentModel,\n//     function (option, parentModel, ecModel, extraOpt) {\n//         // Set dependentModels, componentIndex, name, id, mainType, subType.\n//         zrUtil.extend(this, extraOpt);\n//         this.uid = componentUtil.getUID('componentModel');\n//         // this.setReadOnly([\n//         //     'type', 'id', 'uid', 'name', 'mainType', 'subType',\n//         //     'dependentModels', 'componentIndex'\n//         // ]);\n//     }\n// );\n// Add capability of registerClass, getClass, hasClass, registerSubTypeDefaulter and so on.\n\nenableClassManagement(ComponentModel, {\n  registerWhenExtend: true\n});\nenableSubTypeDefaulter(ComponentModel); // Add capability of ComponentModel.topologicalTravel.\n\nenableTopologicalTravel(ComponentModel, getDependencies);\n\nfunction getDependencies(componentType) {\n  var deps = [];\n  each$1(ComponentModel.getClassesByMainType(componentType), function (Clazz) {\n    deps = deps.concat(Clazz.prototype.dependencies || []);\n  }); // Ensure main type.\n\n  deps = map(deps, function (type) {\n    return parseClassType$1(type).main;\n  }); // Hack dataset for convenience.\n\n  if (componentType !== 'dataset' && indexOf(deps, 'dataset') <= 0) {\n    deps.unshift('dataset');\n  }\n\n  return deps;\n}\n\nmixin(ComponentModel, boxLayoutMixin);\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar platform = ''; // Navigator not exists in node\n\nif (typeof navigator !== 'undefined') {\n  platform = navigator.platform || '';\n}\n\nvar globalDefault = {\n  // backgroundColor: 'rgba(0,0,0,0)',\n  // https://dribbble.com/shots/1065960-Infographic-Pie-chart-visualization\n  // color: ['#5793f3', '#d14a61', '#fd9c35', '#675bba', '#fec42c', '#dd4444', '#d4df5a', '#cd4870'],\n  // Light colors:\n  // color: ['#bcd3bb', '#e88f70', '#edc1a5', '#9dc5c8', '#e1e8c8', '#7b7c68', '#e5b5b5', '#f0b489', '#928ea8', '#bda29a'],\n  // color: ['#cc5664', '#9bd6ec', '#ea946e', '#8acaaa', '#f1ec64', '#ee8686', '#a48dc1', '#5da6bc', '#b9dcae'],\n  // Dark colors:\n  color: ['#c23531', '#2f4554', '#61a0a8', '#d48265', '#91c7ae', '#749f83', '#ca8622', '#bda29a', '#6e7074', '#546570', '#c4ccd3'],\n  gradientColor: ['#f6efa6', '#d88273', '#bf444c'],\n  // If xAxis and yAxis declared, grid is created by default.\n  // grid: {},\n  textStyle: {\n    // color: '#000',\n    // decoration: 'none',\n    // PENDING\n    fontFamily: platform.match(/^Win/) ? 'Microsoft YaHei' : 'sans-serif',\n    // fontFamily: 'Arial, Verdana, sans-serif',\n    fontSize: 12,\n    fontStyle: 'normal',\n    fontWeight: 'normal'\n  },\n  // http://blogs.adobe.com/webplatform/2014/02/24/using-blend-modes-in-html-canvas/\n  // https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/globalCompositeOperation\n  // Default is source-over\n  blendMode: null,\n  animation: 'auto',\n  animationDuration: 1000,\n  animationDurationUpdate: 300,\n  animationEasing: 'exponentialOut',\n  animationEasingUpdate: 'cubicOut',\n  animationThreshold: 2000,\n  // Configuration for progressive/incremental rendering\n  progressiveThreshold: 3000,\n  progressive: 400,\n  // Threshold of if use single hover layer to optimize.\n  // It is recommended that `hoverLayerThreshold` is equivalent to or less than\n  // `progressiveThreshold`, otherwise hover will cause restart of progressive,\n  // which is unexpected.\n  // see example <echarts/test/heatmap-large.html>.\n  hoverLayerThreshold: 3000,\n  // See: module:echarts/scale/Time\n  useUTC: false\n};\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar inner$2 = makeInner();\n\nfunction getNearestColorPalette(colors, requestColorNum) {\n  var paletteNum = colors.length; // TODO colors must be in order\n\n  for (var i = 0; i < paletteNum; i++) {\n    if (colors[i].length > requestColorNum) {\n      return colors[i];\n    }\n  }\n\n  return colors[paletteNum - 1];\n}\n\nvar colorPaletteMixin = {\n  clearColorPalette: function () {\n    inner$2(this).colorIdx = 0;\n    inner$2(this).colorNameMap = {};\n  },\n\n  /**\n   * @param {string} name MUST NOT be null/undefined. Otherwise call this function\n   *                 twise with the same parameters will get different result.\n   * @param {Object} [scope=this]\n   * @param {Object} [requestColorNum]\n   * @return {string} color string.\n   */\n  getColorFromPalette: function (name, scope, requestColorNum) {\n    scope = scope || this;\n    var scopeFields = inner$2(scope);\n    var colorIdx = scopeFields.colorIdx || 0;\n    var colorNameMap = scopeFields.colorNameMap = scopeFields.colorNameMap || {}; // Use `hasOwnProperty` to avoid conflict with Object.prototype.\n\n    if (colorNameMap.hasOwnProperty(name)) {\n      return colorNameMap[name];\n    }\n\n    var defaultColorPalette = normalizeToArray(this.get('color', true));\n    var layeredColorPalette = this.get('colorLayer', true);\n    var colorPalette = requestColorNum == null || !layeredColorPalette ? defaultColorPalette : getNearestColorPalette(layeredColorPalette, requestColorNum); // In case can't find in layered color palette.\n\n    colorPalette = colorPalette || defaultColorPalette;\n\n    if (!colorPalette || !colorPalette.length) {\n      return;\n    }\n\n    var color = colorPalette[colorIdx];\n\n    if (name) {\n      colorNameMap[name] = color;\n    }\n\n    scopeFields.colorIdx = (colorIdx + 1) % colorPalette.length;\n    return color;\n  }\n};\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * Helper for model references.\n * There are many manners to refer axis/coordSys.\n */\n// TODO\n// merge relevant logic to this file?\n// check: \"modelHelper\" of tooltip and \"BrushTargetManager\".\n/**\n * @return {Object} For example:\n * {\n *     coordSysName: 'cartesian2d',\n *     coordSysDims: ['x', 'y', ...],\n *     axisMap: HashMap({\n *         x: xAxisModel,\n *         y: yAxisModel\n *     }),\n *     categoryAxisMap: HashMap({\n *         x: xAxisModel,\n *         y: undefined\n *     }),\n *     // It also indicate that whether there is category axis.\n *     firstCategoryDimIndex: 1,\n *     // To replace user specified encode.\n * }\n */\n\nfunction getCoordSysDefineBySeries(seriesModel) {\n  var coordSysName = seriesModel.get('coordinateSystem');\n  var result = {\n    coordSysName: coordSysName,\n    coordSysDims: [],\n    axisMap: createHashMap(),\n    categoryAxisMap: createHashMap()\n  };\n  var fetch = fetchers[coordSysName];\n\n  if (fetch) {\n    fetch(seriesModel, result, result.axisMap, result.categoryAxisMap);\n    return result;\n  }\n}\nvar fetchers = {\n  cartesian2d: function (seriesModel, result, axisMap, categoryAxisMap) {\n    var xAxisModel = seriesModel.getReferringComponents('xAxis')[0];\n    var yAxisModel = seriesModel.getReferringComponents('yAxis')[0];\n    result.coordSysDims = ['x', 'y'];\n    axisMap.set('x', xAxisModel);\n    axisMap.set('y', yAxisModel);\n\n    if (isCategory(xAxisModel)) {\n      categoryAxisMap.set('x', xAxisModel);\n      result.firstCategoryDimIndex = 0;\n    }\n\n    if (isCategory(yAxisModel)) {\n      categoryAxisMap.set('y', yAxisModel);\n      result.firstCategoryDimIndex = 1;\n    }\n  },\n  singleAxis: function (seriesModel, result, axisMap, categoryAxisMap) {\n    var singleAxisModel = seriesModel.getReferringComponents('singleAxis')[0];\n    result.coordSysDims = ['single'];\n    axisMap.set('single', singleAxisModel);\n\n    if (isCategory(singleAxisModel)) {\n      categoryAxisMap.set('single', singleAxisModel);\n      result.firstCategoryDimIndex = 0;\n    }\n  },\n  polar: function (seriesModel, result, axisMap, categoryAxisMap) {\n    var polarModel = seriesModel.getReferringComponents('polar')[0];\n    var radiusAxisModel = polarModel.findAxisModel('radiusAxis');\n    var angleAxisModel = polarModel.findAxisModel('angleAxis');\n    result.coordSysDims = ['radius', 'angle'];\n    axisMap.set('radius', radiusAxisModel);\n    axisMap.set('angle', angleAxisModel);\n\n    if (isCategory(radiusAxisModel)) {\n      categoryAxisMap.set('radius', radiusAxisModel);\n      result.firstCategoryDimIndex = 0;\n    }\n\n    if (isCategory(angleAxisModel)) {\n      categoryAxisMap.set('angle', angleAxisModel);\n      result.firstCategoryDimIndex = 1;\n    }\n  },\n  geo: function (seriesModel, result, axisMap, categoryAxisMap) {\n    result.coordSysDims = ['lng', 'lat'];\n  },\n  parallel: function (seriesModel, result, axisMap, categoryAxisMap) {\n    var ecModel = seriesModel.ecModel;\n    var parallelModel = ecModel.getComponent('parallel', seriesModel.get('parallelIndex'));\n    var coordSysDims = result.coordSysDims = parallelModel.dimensions.slice();\n    each$1(parallelModel.parallelAxisIndex, function (axisIndex, index) {\n      var axisModel = ecModel.getComponent('parallelAxis', axisIndex);\n      var axisDim = coordSysDims[index];\n      axisMap.set(axisDim, axisModel);\n\n      if (isCategory(axisModel) && result.firstCategoryDimIndex == null) {\n        categoryAxisMap.set(axisDim, axisModel);\n        result.firstCategoryDimIndex = index;\n      }\n    });\n  }\n};\n\nfunction isCategory(axisModel) {\n  return axisModel.get('type') === 'category';\n}\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n// Avoid typo.\nvar SOURCE_FORMAT_ORIGINAL = 'original';\nvar SOURCE_FORMAT_ARRAY_ROWS = 'arrayRows';\nvar SOURCE_FORMAT_OBJECT_ROWS = 'objectRows';\nvar SOURCE_FORMAT_KEYED_COLUMNS = 'keyedColumns';\nvar SOURCE_FORMAT_UNKNOWN = 'unknown'; // ??? CHANGE A NAME\n\nvar SOURCE_FORMAT_TYPED_ARRAY = 'typedArray';\nvar SERIES_LAYOUT_BY_COLUMN = 'column';\nvar SERIES_LAYOUT_BY_ROW = 'row';\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n/**\n * [sourceFormat]\n *\n * + \"original\":\n * This format is only used in series.data, where\n * itemStyle can be specified in data item.\n *\n * + \"arrayRows\":\n * [\n *     ['product', 'score', 'amount'],\n *     ['Matcha Latte', 89.3, 95.8],\n *     ['Milk Tea', 92.1, 89.4],\n *     ['Cheese Cocoa', 94.4, 91.2],\n *     ['Walnut Brownie', 85.4, 76.9]\n * ]\n *\n * + \"objectRows\":\n * [\n *     {product: 'Matcha Latte', score: 89.3, amount: 95.8},\n *     {product: 'Milk Tea', score: 92.1, amount: 89.4},\n *     {product: 'Cheese Cocoa', score: 94.4, amount: 91.2},\n *     {product: 'Walnut Brownie', score: 85.4, amount: 76.9}\n * ]\n *\n * + \"keyedColumns\":\n * {\n *     'product': ['Matcha Latte', 'Milk Tea', 'Cheese Cocoa', 'Walnut Brownie'],\n *     'count': [823, 235, 1042, 988],\n *     'score': [95.8, 81.4, 91.2, 76.9]\n * }\n *\n * + \"typedArray\"\n *\n * + \"unknown\"\n */\n\n/**\n * @constructor\n * @param {Object} fields\n * @param {string} fields.sourceFormat\n * @param {Array|Object} fields.fromDataset\n * @param {Array|Object} [fields.data]\n * @param {string} [seriesLayoutBy='column']\n * @param {Array.<Object|string>} [dimensionsDefine]\n * @param {Objet|HashMap} [encodeDefine]\n * @param {number} [startIndex=0]\n * @param {number} [dimensionsDetectCount]\n */\n\nfunction Source(fields) {\n  /**\n   * @type {boolean}\n   */\n  this.fromDataset = fields.fromDataset;\n  /**\n   * Not null/undefined.\n   * @type {Array|Object}\n   */\n\n  this.data = fields.data || (fields.sourceFormat === SOURCE_FORMAT_KEYED_COLUMNS ? {} : []);\n  /**\n   * See also \"detectSourceFormat\".\n   * Not null/undefined.\n   * @type {string}\n   */\n\n  this.sourceFormat = fields.sourceFormat || SOURCE_FORMAT_UNKNOWN;\n  /**\n   * 'row' or 'column'\n   * Not null/undefined.\n   * @type {string} seriesLayoutBy\n   */\n\n  this.seriesLayoutBy = fields.seriesLayoutBy || SERIES_LAYOUT_BY_COLUMN;\n  /**\n   * dimensions definition in option.\n   * can be null/undefined.\n   * @type {Array.<Object|string>}\n   */\n\n  this.dimensionsDefine = fields.dimensionsDefine;\n  /**\n   * encode definition in option.\n   * can be null/undefined.\n   * @type {Objet|HashMap}\n   */\n\n  this.encodeDefine = fields.encodeDefine && createHashMap(fields.encodeDefine);\n  /**\n   * Not null/undefined, uint.\n   * @type {number}\n   */\n\n  this.startIndex = fields.startIndex || 0;\n  /**\n   * Can be null/undefined (when unknown), uint.\n   * @type {number}\n   */\n\n  this.dimensionsDetectCount = fields.dimensionsDetectCount;\n}\n/**\n * Wrap original series data for some compatibility cases.\n */\n\n\nSource.seriesDataToSource = function (data) {\n  return new Source({\n    data: data,\n    sourceFormat: isTypedArray(data) ? SOURCE_FORMAT_TYPED_ARRAY : SOURCE_FORMAT_ORIGINAL,\n    fromDataset: false\n  });\n};\n\nenableClassCheck(Source);\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar inner$3 = makeInner();\n/**\n * @see {module:echarts/data/Source}\n * @param {module:echarts/component/dataset/DatasetModel} datasetModel\n * @return {string} sourceFormat\n */\n\nfunction detectSourceFormat(datasetModel) {\n  var data = datasetModel.option.source;\n  var sourceFormat = SOURCE_FORMAT_UNKNOWN;\n\n  if (isTypedArray(data)) {\n    sourceFormat = SOURCE_FORMAT_TYPED_ARRAY;\n  } else if (isArray(data)) {\n    // FIXME Whether tolerate null in top level array?\n    for (var i = 0, len = data.length; i < len; i++) {\n      var item = data[i];\n\n      if (item == null) {\n        continue;\n      } else if (isArray(item)) {\n        sourceFormat = SOURCE_FORMAT_ARRAY_ROWS;\n        break;\n      } else if (isObject$1(item)) {\n        sourceFormat = SOURCE_FORMAT_OBJECT_ROWS;\n        break;\n      }\n    }\n  } else if (isObject$1(data)) {\n    for (var key in data) {\n      if (data.hasOwnProperty(key) && isArrayLike(data[key])) {\n        sourceFormat = SOURCE_FORMAT_KEYED_COLUMNS;\n        break;\n      }\n    }\n  } else if (data != null) {\n    throw new Error('Invalid data');\n  }\n\n  inner$3(datasetModel).sourceFormat = sourceFormat;\n}\n/**\n * [Scenarios]:\n * (1) Provide source data directly:\n *     series: {\n *         encode: {...},\n *         dimensions: [...]\n *         seriesLayoutBy: 'row',\n *         data: [[...]]\n *     }\n * (2) Refer to datasetModel.\n *     series: [{\n *         encode: {...}\n *         // Ignore datasetIndex means `datasetIndex: 0`\n *         // and the dimensions defination in dataset is used\n *     }, {\n *         encode: {...},\n *         seriesLayoutBy: 'column',\n *         datasetIndex: 1\n *     }]\n *\n * Get data from series itself or datset.\n * @return {module:echarts/data/Source} source\n */\n\nfunction getSource(seriesModel) {\n  return inner$3(seriesModel).source;\n}\n/**\n * MUST be called before mergeOption of all series.\n * @param {module:echarts/model/Global} ecModel\n */\n\nfunction resetSourceDefaulter(ecModel) {\n  // `datasetMap` is used to make default encode.\n  inner$3(ecModel).datasetMap = createHashMap();\n}\n/**\n * [Caution]:\n * MUST be called after series option merged and\n * before \"series.getInitailData()\" called.\n *\n * [The rule of making default encode]:\n * Category axis (if exists) alway map to the first dimension.\n * Each other axis occupies a subsequent dimension.\n *\n * [Why make default encode]:\n * Simplify the typing of encode in option, avoiding the case like that:\n * series: [{encode: {x: 0, y: 1}}, {encode: {x: 0, y: 2}}, {encode: {x: 0, y: 3}}],\n * where the \"y\" have to be manually typed as \"1, 2, 3, ...\".\n *\n * @param {module:echarts/model/Series} seriesModel\n */\n\nfunction prepareSource(seriesModel) {\n  var seriesOption = seriesModel.option;\n  var data = seriesOption.data;\n  var sourceFormat = isTypedArray(data) ? SOURCE_FORMAT_TYPED_ARRAY : SOURCE_FORMAT_ORIGINAL;\n  var fromDataset = false;\n  var seriesLayoutBy = seriesOption.seriesLayoutBy;\n  var sourceHeader = seriesOption.sourceHeader;\n  var dimensionsDefine = seriesOption.dimensions;\n  var datasetModel = getDatasetModel(seriesModel);\n\n  if (datasetModel) {\n    var datasetOption = datasetModel.option;\n    data = datasetOption.source;\n    sourceFormat = inner$3(datasetModel).sourceFormat;\n    fromDataset = true; // These settings from series has higher priority.\n\n    seriesLayoutBy = seriesLayoutBy || datasetOption.seriesLayoutBy;\n    sourceHeader == null && (sourceHeader = datasetOption.sourceHeader);\n    dimensionsDefine = dimensionsDefine || datasetOption.dimensions;\n  }\n\n  var completeResult = completeBySourceData(data, sourceFormat, seriesLayoutBy, sourceHeader, dimensionsDefine); // Note: dataset option does not have `encode`.\n\n  var encodeDefine = seriesOption.encode;\n\n  if (!encodeDefine && datasetModel) {\n    encodeDefine = makeDefaultEncode(seriesModel, datasetModel, data, sourceFormat, seriesLayoutBy, completeResult);\n  }\n\n  inner$3(seriesModel).source = new Source({\n    data: data,\n    fromDataset: fromDataset,\n    seriesLayoutBy: seriesLayoutBy,\n    sourceFormat: sourceFormat,\n    dimensionsDefine: completeResult.dimensionsDefine,\n    startIndex: completeResult.startIndex,\n    dimensionsDetectCount: completeResult.dimensionsDetectCount,\n    encodeDefine: encodeDefine\n  });\n} // return {startIndex, dimensionsDefine, dimensionsCount}\n\nfunction completeBySourceData(data, sourceFormat, seriesLayoutBy, sourceHeader, dimensionsDefine) {\n  if (!data) {\n    return {\n      dimensionsDefine: normalizeDimensionsDefine(dimensionsDefine)\n    };\n  }\n\n  var dimensionsDetectCount;\n  var startIndex;\n  var findPotentialName;\n\n  if (sourceFormat === SOURCE_FORMAT_ARRAY_ROWS) {\n    // Rule: Most of the first line are string: it is header.\n    // Caution: consider a line with 5 string and 1 number,\n    // it still can not be sure it is a head, because the\n    // 5 string may be 5 values of category columns.\n    if (sourceHeader === 'auto' || sourceHeader == null) {\n      arrayRowsTravelFirst(function (val) {\n        // '-' is regarded as null/undefined.\n        if (val != null && val !== '-') {\n          if (isString(val)) {\n            startIndex == null && (startIndex = 1);\n          } else {\n            startIndex = 0;\n          }\n        } // 10 is an experience number, avoid long loop.\n\n      }, seriesLayoutBy, data, 10);\n    } else {\n      startIndex = sourceHeader ? 1 : 0;\n    }\n\n    if (!dimensionsDefine && startIndex === 1) {\n      dimensionsDefine = [];\n      arrayRowsTravelFirst(function (val, index) {\n        dimensionsDefine[index] = val != null ? val : '';\n      }, seriesLayoutBy, data);\n    }\n\n    dimensionsDetectCount = dimensionsDefine ? dimensionsDefine.length : seriesLayoutBy === SERIES_LAYOUT_BY_ROW ? data.length : data[0] ? data[0].length : null;\n  } else if (sourceFormat === SOURCE_FORMAT_OBJECT_ROWS) {\n    if (!dimensionsDefine) {\n      dimensionsDefine = objectRowsCollectDimensions(data);\n      findPotentialName = true;\n    }\n  } else if (sourceFormat === SOURCE_FORMAT_KEYED_COLUMNS) {\n    if (!dimensionsDefine) {\n      dimensionsDefine = [];\n      findPotentialName = true;\n      each$1(data, function (colArr, key) {\n        dimensionsDefine.push(key);\n      });\n    }\n  } else if (sourceFormat === SOURCE_FORMAT_ORIGINAL) {\n    var value0 = getDataItemValue(data[0]);\n    dimensionsDetectCount = isArray(value0) && value0.length || 1;\n  } else if (sourceFormat === SOURCE_FORMAT_TYPED_ARRAY) {}\n\n  var potentialNameDimIndex;\n\n  if (findPotentialName) {\n    each$1(dimensionsDefine, function (dim, idx) {\n      if ((isObject$1(dim) ? dim.name : dim) === 'name') {\n        potentialNameDimIndex = idx;\n      }\n    });\n  }\n\n  return {\n    startIndex: startIndex,\n    dimensionsDefine: normalizeDimensionsDefine(dimensionsDefine),\n    dimensionsDetectCount: dimensionsDetectCount,\n    potentialNameDimIndex: potentialNameDimIndex // TODO: potentialIdDimIdx\n\n  };\n} // Consider dimensions defined like ['A', 'price', 'B', 'price', 'C', 'price'],\n// which is reasonable. But dimension name is duplicated.\n// Returns undefined or an array contains only object without null/undefiend or string.\n\n\nfunction normalizeDimensionsDefine(dimensionsDefine) {\n  if (!dimensionsDefine) {\n    // The meaning of null/undefined is different from empty array.\n    return;\n  }\n\n  var nameMap = createHashMap();\n  return map(dimensionsDefine, function (item, index) {\n    item = extend({}, isObject$1(item) ? item : {\n      name: item\n    }); // User can set null in dimensions.\n    // We dont auto specify name, othewise a given name may\n    // cause it be refered unexpectedly.\n\n    if (item.name == null) {\n      return item;\n    } // Also consider number form like 2012.\n\n\n    item.name += ''; // User may also specify displayName.\n    // displayName will always exists except user not\n    // specified or dim name is not specified or detected.\n    // (A auto generated dim name will not be used as\n    // displayName).\n\n    if (item.displayName == null) {\n      item.displayName = item.name;\n    }\n\n    var exist = nameMap.get(item.name);\n\n    if (!exist) {\n      nameMap.set(item.name, {\n        count: 1\n      });\n    } else {\n      item.name += '-' + exist.count++;\n    }\n\n    return item;\n  });\n}\n\nfunction arrayRowsTravelFirst(cb, seriesLayoutBy, data, maxLoop) {\n  maxLoop == null && (maxLoop = Infinity);\n\n  if (seriesLayoutBy === SERIES_LAYOUT_BY_ROW) {\n    for (var i = 0; i < data.length && i < maxLoop; i++) {\n      cb(data[i] ? data[i][0] : null, i);\n    }\n  } else {\n    var value0 = data[0] || [];\n\n    for (var i = 0; i < value0.length && i < maxLoop; i++) {\n      cb(value0[i], i);\n    }\n  }\n}\n\nfunction objectRowsCollectDimensions(data) {\n  var firstIndex = 0;\n  var obj;\n\n  while (firstIndex < data.length && !(obj = data[firstIndex++])) {} // jshint ignore: line\n\n\n  if (obj) {\n    var dimensions = [];\n    each$1(obj, function (value, key) {\n      dimensions.push(key);\n    });\n    return dimensions;\n  }\n} // ??? TODO merge to completedimensions, where also has\n// default encode making logic. And the default rule\n// should depends on series? consider 'map'.\n\n\nfunction makeDefaultEncode(seriesModel, datasetModel, data, sourceFormat, seriesLayoutBy, completeResult) {\n  var coordSysDefine = getCoordSysDefineBySeries(seriesModel);\n  var encode = {}; // var encodeTooltip = [];\n  // var encodeLabel = [];\n\n  var encodeItemName = [];\n  var encodeSeriesName = [];\n  var seriesType = seriesModel.subType; // ??? TODO refactor: provide by series itself.\n  // Consider the case: 'map' series is based on geo coordSys,\n  // 'graph', 'heatmap' can be based on cartesian. But can not\n  // give default rule simply here.\n\n  var nSeriesMap = createHashMap(['pie', 'map', 'funnel']);\n  var cSeriesMap = createHashMap(['line', 'bar', 'pictorialBar', 'scatter', 'effectScatter', 'candlestick', 'boxplot']); // Usually in this case series will use the first data\n  // dimension as the \"value\" dimension, or other default\n  // processes respectively.\n\n  if (coordSysDefine && cSeriesMap.get(seriesType) != null) {\n    var ecModel = seriesModel.ecModel;\n    var datasetMap = inner$3(ecModel).datasetMap;\n    var key = datasetModel.uid + '_' + seriesLayoutBy;\n    var datasetRecord = datasetMap.get(key) || datasetMap.set(key, {\n      categoryWayDim: 1,\n      valueWayDim: 0\n    }); // TODO\n    // Auto detect first time axis and do arrangement.\n\n    each$1(coordSysDefine.coordSysDims, function (coordDim) {\n      // In value way.\n      if (coordSysDefine.firstCategoryDimIndex == null) {\n        var dataDim = datasetRecord.valueWayDim++;\n        encode[coordDim] = dataDim; // ??? TODO give a better default series name rule?\n        // especially when encode x y specified.\n        // consider: when mutiple series share one dimension\n        // category axis, series name should better use\n        // the other dimsion name. On the other hand, use\n        // both dimensions name.\n\n        encodeSeriesName.push(dataDim); // encodeTooltip.push(dataDim);\n        // encodeLabel.push(dataDim);\n      } // In category way, category axis.\n      else if (coordSysDefine.categoryAxisMap.get(coordDim)) {\n          encode[coordDim] = 0;\n          encodeItemName.push(0);\n        } // In category way, non-category axis.\n        else {\n            var dataDim = datasetRecord.categoryWayDim++;\n            encode[coordDim] = dataDim; // encodeTooltip.push(dataDim);\n            // encodeLabel.push(dataDim);\n\n            encodeSeriesName.push(dataDim);\n          }\n    });\n  } // Do not make a complex rule! Hard to code maintain and not necessary.\n  // ??? TODO refactor: provide by series itself.\n  // [{name: ..., value: ...}, ...] like:\n  else if (nSeriesMap.get(seriesType) != null) {\n      // Find the first not ordinal. (5 is an experience value)\n      var firstNotOrdinal;\n\n      for (var i = 0; i < 5 && firstNotOrdinal == null; i++) {\n        if (!doGuessOrdinal(data, sourceFormat, seriesLayoutBy, completeResult.dimensionsDefine, completeResult.startIndex, i)) {\n          firstNotOrdinal = i;\n        }\n      }\n\n      if (firstNotOrdinal != null) {\n        encode.value = firstNotOrdinal;\n        var nameDimIndex = completeResult.potentialNameDimIndex || Math.max(firstNotOrdinal - 1, 0); // By default, label use itemName in charts.\n        // So we dont set encodeLabel here.\n\n        encodeSeriesName.push(nameDimIndex);\n        encodeItemName.push(nameDimIndex); // encodeTooltip.push(firstNotOrdinal);\n      }\n    } // encodeTooltip.length && (encode.tooltip = encodeTooltip);\n  // encodeLabel.length && (encode.label = encodeLabel);\n\n\n  encodeItemName.length && (encode.itemName = encodeItemName);\n  encodeSeriesName.length && (encode.seriesName = encodeSeriesName);\n  return encode;\n}\n/**\n * If return null/undefined, indicate that should not use datasetModel.\n */\n\n\nfunction getDatasetModel(seriesModel) {\n  var option = seriesModel.option; // Caution: consider the scenario:\n  // A dataset is declared and a series is not expected to use the dataset,\n  // and at the beginning `setOption({series: { noData })` (just prepare other\n  // option but no data), then `setOption({series: {data: [...]}); In this case,\n  // the user should set an empty array to avoid that dataset is used by default.\n\n  var thisData = option.data;\n\n  if (!thisData) {\n    return seriesModel.ecModel.getComponent('dataset', option.datasetIndex || 0);\n  }\n}\n/**\n * The rule should not be complex, otherwise user might not\n * be able to known where the data is wrong.\n * The code is ugly, but how to make it neat?\n *\n * @param {module:echars/data/Source} source\n * @param {number} dimIndex\n * @return {boolean} Whether ordinal.\n */\n\n\nfunction guessOrdinal(source, dimIndex) {\n  return doGuessOrdinal(source.data, source.sourceFormat, source.seriesLayoutBy, source.dimensionsDefine, source.startIndex, dimIndex);\n} // dimIndex may be overflow source data.\n\nfunction doGuessOrdinal(data, sourceFormat, seriesLayoutBy, dimensionsDefine, startIndex, dimIndex) {\n  var result; // Experience value.\n\n  var maxLoop = 5;\n\n  if (isTypedArray(data)) {\n    return false;\n  } // When sourceType is 'objectRows' or 'keyedColumns', dimensionsDefine\n  // always exists in source.\n\n\n  var dimName;\n\n  if (dimensionsDefine) {\n    dimName = dimensionsDefine[dimIndex];\n    dimName = isObject$1(dimName) ? dimName.name : dimName;\n  }\n\n  if (sourceFormat === SOURCE_FORMAT_ARRAY_ROWS) {\n    if (seriesLayoutBy === SERIES_LAYOUT_BY_ROW) {\n      var sample = data[dimIndex];\n\n      for (var i = 0; i < (sample || []).length && i < maxLoop; i++) {\n        if ((result = detectValue(sample[startIndex + i])) != null) {\n          return result;\n        }\n      }\n    } else {\n      for (var i = 0; i < data.length && i < maxLoop; i++) {\n        var row = data[startIndex + i];\n\n        if (row && (result = detectValue(row[dimIndex])) != null) {\n          return result;\n        }\n      }\n    }\n  } else if (sourceFormat === SOURCE_FORMAT_OBJECT_ROWS) {\n    if (!dimName) {\n      return;\n    }\n\n    for (var i = 0; i < data.length && i < maxLoop; i++) {\n      var item = data[i];\n\n      if (item && (result = detectValue(item[dimName])) != null) {\n        return result;\n      }\n    }\n  } else if (sourceFormat === SOURCE_FORMAT_KEYED_COLUMNS) {\n    if (!dimName) {\n      return;\n    }\n\n    var sample = data[dimName];\n\n    if (!sample || isTypedArray(sample)) {\n      return false;\n    }\n\n    for (var i = 0; i < sample.length && i < maxLoop; i++) {\n      if ((result = detectValue(sample[i])) != null) {\n        return result;\n      }\n    }\n  } else if (sourceFormat === SOURCE_FORMAT_ORIGINAL) {\n    for (var i = 0; i < data.length && i < maxLoop; i++) {\n      var item = data[i];\n      var val = getDataItemValue(item);\n\n      if (!isArray(val)) {\n        return false;\n      }\n\n      if ((result = detectValue(val[dimIndex])) != null) {\n        return result;\n      }\n    }\n  }\n\n  function detectValue(val) {\n    // Consider usage convenience, '1', '2' will be treated as \"number\".\n    // `isFinit('')` get `true`.\n    if (val != null && isFinite(val) && val !== '') {\n      return false;\n    } else if (isString(val) && val !== '-') {\n      return true;\n    }\n  }\n\n  return false;\n}\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * ECharts global model\n *\n * @module {echarts/model/Global}\n */\n\n/**\n * Caution: If the mechanism should be changed some day, these cases\n * should be considered:\n *\n * (1) In `merge option` mode, if using the same option to call `setOption`\n * many times, the result should be the same (try our best to ensure that).\n * (2) In `merge option` mode, if a component has no id/name specified, it\n * will be merged by index, and the result sequence of the components is\n * consistent to the original sequence.\n * (3) `reset` feature (in toolbox). Find detailed info in comments about\n * `mergeOption` in module:echarts/model/OptionManager.\n */\nvar OPTION_INNER_KEY = '\\0_ec_inner';\n/**\n * @alias module:echarts/model/Global\n *\n * @param {Object} option\n * @param {module:echarts/model/Model} parentModel\n * @param {Object} theme\n */\n\nvar GlobalModel = Model.extend({\n  init: function (option, parentModel, theme, optionManager) {\n    theme = theme || {};\n    this.option = null; // Mark as not initialized.\n\n    /**\n     * @type {module:echarts/model/Model}\n     * @private\n     */\n\n    this._theme = new Model(theme);\n    /**\n     * @type {module:echarts/model/OptionManager}\n     */\n\n    this._optionManager = optionManager;\n  },\n  setOption: function (option, optionPreprocessorFuncs) {\n    assert$1(!(OPTION_INNER_KEY in option), 'please use chart.getOption()');\n\n    this._optionManager.setOption(option, optionPreprocessorFuncs);\n\n    this.resetOption(null);\n  },\n\n  /**\n   * @param {string} type null/undefined: reset all.\n   *                      'recreate': force recreate all.\n   *                      'timeline': only reset timeline option\n   *                      'media': only reset media query option\n   * @return {boolean} Whether option changed.\n   */\n  resetOption: function (type) {\n    var optionChanged = false;\n    var optionManager = this._optionManager;\n\n    if (!type || type === 'recreate') {\n      var baseOption = optionManager.mountOption(type === 'recreate');\n\n      if (!this.option || type === 'recreate') {\n        initBase.call(this, baseOption);\n      } else {\n        this.restoreData();\n        this.mergeOption(baseOption);\n      }\n\n      optionChanged = true;\n    }\n\n    if (type === 'timeline' || type === 'media') {\n      this.restoreData();\n    }\n\n    if (!type || type === 'recreate' || type === 'timeline') {\n      var timelineOption = optionManager.getTimelineOption(this);\n      timelineOption && (this.mergeOption(timelineOption), optionChanged = true);\n    }\n\n    if (!type || type === 'recreate' || type === 'media') {\n      var mediaOptions = optionManager.getMediaOption(this, this._api);\n\n      if (mediaOptions.length) {\n        each$1(mediaOptions, function (mediaOption) {\n          this.mergeOption(mediaOption, optionChanged = true);\n        }, this);\n      }\n    }\n\n    return optionChanged;\n  },\n\n  /**\n   * @protected\n   */\n  mergeOption: function (newOption) {\n    var option = this.option;\n    var componentsMap = this._componentsMap;\n    var newCptTypes = [];\n    resetSourceDefaulter(this); // If no component class, merge directly.\n    // For example: color, animaiton options, etc.\n\n    each$1(newOption, function (componentOption, mainType) {\n      if (componentOption == null) {\n        return;\n      }\n\n      if (!ComponentModel.hasClass(mainType)) {\n        // globalSettingTask.dirty();\n        option[mainType] = option[mainType] == null ? clone(componentOption) : merge(option[mainType], componentOption, true);\n      } else if (mainType) {\n        newCptTypes.push(mainType);\n      }\n    });\n    ComponentModel.topologicalTravel(newCptTypes, ComponentModel.getAllClassMainTypes(), visitComponent, this);\n\n    function visitComponent(mainType, dependencies) {\n      var newCptOptionList = normalizeToArray(newOption[mainType]);\n      var mapResult = mappingToExists(componentsMap.get(mainType), newCptOptionList);\n      makeIdAndName(mapResult); // Set mainType and complete subType.\n\n      each$1(mapResult, function (item, index) {\n        var opt = item.option;\n\n        if (isObject$1(opt)) {\n          item.keyInfo.mainType = mainType;\n          item.keyInfo.subType = determineSubType(mainType, opt, item.exist);\n        }\n      });\n      var dependentModels = getComponentsByTypes(componentsMap, dependencies);\n      option[mainType] = [];\n      componentsMap.set(mainType, []);\n      each$1(mapResult, function (resultItem, index) {\n        var componentModel = resultItem.exist;\n        var newCptOption = resultItem.option;\n        assert$1(isObject$1(newCptOption) || componentModel, 'Empty component definition'); // Consider where is no new option and should be merged using {},\n        // see removeEdgeAndAdd in topologicalTravel and\n        // ComponentModel.getAllClassMainTypes.\n\n        if (!newCptOption) {\n          componentModel.mergeOption({}, this);\n          componentModel.optionUpdated({}, false);\n        } else {\n          var ComponentModelClass = ComponentModel.getClass(mainType, resultItem.keyInfo.subType, true);\n\n          if (componentModel && componentModel instanceof ComponentModelClass) {\n            componentModel.name = resultItem.keyInfo.name; // componentModel.settingTask && componentModel.settingTask.dirty();\n\n            componentModel.mergeOption(newCptOption, this);\n            componentModel.optionUpdated(newCptOption, false);\n          } else {\n            // PENDING Global as parent ?\n            var extraOpt = extend({\n              dependentModels: dependentModels,\n              componentIndex: index\n            }, resultItem.keyInfo);\n            componentModel = new ComponentModelClass(newCptOption, this, this, extraOpt);\n            extend(componentModel, extraOpt);\n            componentModel.init(newCptOption, this, this, extraOpt); // Call optionUpdated after init.\n            // newCptOption has been used as componentModel.option\n            // and may be merged with theme and default, so pass null\n            // to avoid confusion.\n\n            componentModel.optionUpdated(null, true);\n          }\n        }\n\n        componentsMap.get(mainType)[index] = componentModel;\n        option[mainType][index] = componentModel.option;\n      }, this); // Backup series for filtering.\n\n      if (mainType === 'series') {\n        createSeriesIndices(this, componentsMap.get('series'));\n      }\n    }\n\n    this._seriesIndicesMap = createHashMap(this._seriesIndices = this._seriesIndices || []);\n  },\n\n  /**\n   * Get option for output (cloned option and inner info removed)\n   * @public\n   * @return {Object}\n   */\n  getOption: function () {\n    var option = clone(this.option);\n    each$1(option, function (opts, mainType) {\n      if (ComponentModel.hasClass(mainType)) {\n        var opts = normalizeToArray(opts);\n\n        for (var i = opts.length - 1; i >= 0; i--) {\n          // Remove options with inner id.\n          if (isIdInner(opts[i])) {\n            opts.splice(i, 1);\n          }\n        }\n\n        option[mainType] = opts;\n      }\n    });\n    delete option[OPTION_INNER_KEY];\n    return option;\n  },\n\n  /**\n   * @return {module:echarts/model/Model}\n   */\n  getTheme: function () {\n    return this._theme;\n  },\n\n  /**\n   * @param {string} mainType\n   * @param {number} [idx=0]\n   * @return {module:echarts/model/Component}\n   */\n  getComponent: function (mainType, idx) {\n    var list = this._componentsMap.get(mainType);\n\n    if (list) {\n      return list[idx || 0];\n    }\n  },\n\n  /**\n   * If none of index and id and name used, return all components with mainType.\n   * @param {Object} condition\n   * @param {string} condition.mainType\n   * @param {string} [condition.subType] If ignore, only query by mainType\n   * @param {number|Array.<number>} [condition.index] Either input index or id or name.\n   * @param {string|Array.<string>} [condition.id] Either input index or id or name.\n   * @param {string|Array.<string>} [condition.name] Either input index or id or name.\n   * @return {Array.<module:echarts/model/Component>}\n   */\n  queryComponents: function (condition) {\n    var mainType = condition.mainType;\n\n    if (!mainType) {\n      return [];\n    }\n\n    var index = condition.index;\n    var id = condition.id;\n    var name = condition.name;\n\n    var cpts = this._componentsMap.get(mainType);\n\n    if (!cpts || !cpts.length) {\n      return [];\n    }\n\n    var result;\n\n    if (index != null) {\n      if (!isArray(index)) {\n        index = [index];\n      }\n\n      result = filter(map(index, function (idx) {\n        return cpts[idx];\n      }), function (val) {\n        return !!val;\n      });\n    } else if (id != null) {\n      var isIdArray = isArray(id);\n      result = filter(cpts, function (cpt) {\n        return isIdArray && indexOf(id, cpt.id) >= 0 || !isIdArray && cpt.id === id;\n      });\n    } else if (name != null) {\n      var isNameArray = isArray(name);\n      result = filter(cpts, function (cpt) {\n        return isNameArray && indexOf(name, cpt.name) >= 0 || !isNameArray && cpt.name === name;\n      });\n    } else {\n      // Return all components with mainType\n      result = cpts.slice();\n    }\n\n    return filterBySubType(result, condition);\n  },\n\n  /**\n   * The interface is different from queryComponents,\n   * which is convenient for inner usage.\n   *\n   * @usage\n   * var result = findComponents(\n   *     {mainType: 'dataZoom', query: {dataZoomId: 'abc'}}\n   * );\n   * var result = findComponents(\n   *     {mainType: 'series', subType: 'pie', query: {seriesName: 'uio'}}\n   * );\n   * var result = findComponents(\n   *     {mainType: 'series'},\n   *     function (model, index) {...}\n   * );\n   * // result like [component0, componnet1, ...]\n   *\n   * @param {Object} condition\n   * @param {string} condition.mainType Mandatory.\n   * @param {string} [condition.subType] Optional.\n   * @param {Object} [condition.query] like {xxxIndex, xxxId, xxxName},\n   *        where xxx is mainType.\n   *        If query attribute is null/undefined or has no index/id/name,\n   *        do not filtering by query conditions, which is convenient for\n   *        no-payload situations or when target of action is global.\n   * @param {Function} [condition.filter] parameter: component, return boolean.\n   * @return {Array.<module:echarts/model/Component>}\n   */\n  findComponents: function (condition) {\n    var query = condition.query;\n    var mainType = condition.mainType;\n    var queryCond = getQueryCond(query);\n    var result = queryCond ? this.queryComponents(queryCond) : this._componentsMap.get(mainType);\n    return doFilter(filterBySubType(result, condition));\n\n    function getQueryCond(q) {\n      var indexAttr = mainType + 'Index';\n      var idAttr = mainType + 'Id';\n      var nameAttr = mainType + 'Name';\n      return q && (q[indexAttr] != null || q[idAttr] != null || q[nameAttr] != null) ? {\n        mainType: mainType,\n        // subType will be filtered finally.\n        index: q[indexAttr],\n        id: q[idAttr],\n        name: q[nameAttr]\n      } : null;\n    }\n\n    function doFilter(res) {\n      return condition.filter ? filter(res, condition.filter) : res;\n    }\n  },\n\n  /**\n   * @usage\n   * eachComponent('legend', function (legendModel, index) {\n   *     ...\n   * });\n   * eachComponent(function (componentType, model, index) {\n   *     // componentType does not include subType\n   *     // (componentType is 'xxx' but not 'xxx.aa')\n   * });\n   * eachComponent(\n   *     {mainType: 'dataZoom', query: {dataZoomId: 'abc'}},\n   *     function (model, index) {...}\n   * );\n   * eachComponent(\n   *     {mainType: 'series', subType: 'pie', query: {seriesName: 'uio'}},\n   *     function (model, index) {...}\n   * );\n   *\n   * @param {string|Object=} mainType When mainType is object, the definition\n   *                                  is the same as the method 'findComponents'.\n   * @param {Function} cb\n   * @param {*} context\n   */\n  eachComponent: function (mainType, cb, context) {\n    var componentsMap = this._componentsMap;\n\n    if (typeof mainType === 'function') {\n      context = cb;\n      cb = mainType;\n      componentsMap.each(function (components, componentType) {\n        each$1(components, function (component, index) {\n          cb.call(context, componentType, component, index);\n        });\n      });\n    } else if (isString(mainType)) {\n      each$1(componentsMap.get(mainType), cb, context);\n    } else if (isObject$1(mainType)) {\n      var queryResult = this.findComponents(mainType);\n      each$1(queryResult, cb, context);\n    }\n  },\n\n  /**\n   * @param {string} name\n   * @return {Array.<module:echarts/model/Series>}\n   */\n  getSeriesByName: function (name) {\n    var series = this._componentsMap.get('series');\n\n    return filter(series, function (oneSeries) {\n      return oneSeries.name === name;\n    });\n  },\n\n  /**\n   * @param {number} seriesIndex\n   * @return {module:echarts/model/Series}\n   */\n  getSeriesByIndex: function (seriesIndex) {\n    return this._componentsMap.get('series')[seriesIndex];\n  },\n\n  /**\n   * Get series list before filtered by type.\n   * FIXME: rename to getRawSeriesByType?\n   *\n   * @param {string} subType\n   * @return {Array.<module:echarts/model/Series>}\n   */\n  getSeriesByType: function (subType) {\n    var series = this._componentsMap.get('series');\n\n    return filter(series, function (oneSeries) {\n      return oneSeries.subType === subType;\n    });\n  },\n\n  /**\n   * @return {Array.<module:echarts/model/Series>}\n   */\n  getSeries: function () {\n    return this._componentsMap.get('series').slice();\n  },\n\n  /**\n   * @return {number}\n   */\n  getSeriesCount: function () {\n    return this._componentsMap.get('series').length;\n  },\n\n  /**\n   * After filtering, series may be different\n   * frome raw series.\n   *\n   * @param {Function} cb\n   * @param {*} context\n   */\n  eachSeries: function (cb, context) {\n    each$1(this._seriesIndices, function (rawSeriesIndex) {\n      var series = this._componentsMap.get('series')[rawSeriesIndex];\n\n      cb.call(context, series, rawSeriesIndex);\n    }, this);\n  },\n\n  /**\n   * Iterate raw series before filtered.\n   *\n   * @param {Function} cb\n   * @param {*} context\n   */\n  eachRawSeries: function (cb, context) {\n    each$1(this._componentsMap.get('series'), cb, context);\n  },\n\n  /**\n   * After filtering, series may be different.\n   * frome raw series.\n   *\n   * @parma {string} subType\n   * @param {Function} cb\n   * @param {*} context\n   */\n  eachSeriesByType: function (subType, cb, context) {\n    each$1(this._seriesIndices, function (rawSeriesIndex) {\n      var series = this._componentsMap.get('series')[rawSeriesIndex];\n\n      if (series.subType === subType) {\n        cb.call(context, series, rawSeriesIndex);\n      }\n    }, this);\n  },\n\n  /**\n   * Iterate raw series before filtered of given type.\n   *\n   * @parma {string} subType\n   * @param {Function} cb\n   * @param {*} context\n   */\n  eachRawSeriesByType: function (subType, cb, context) {\n    return each$1(this.getSeriesByType(subType), cb, context);\n  },\n\n  /**\n   * @param {module:echarts/model/Series} seriesModel\n   */\n  isSeriesFiltered: function (seriesModel) {\n    return this._seriesIndicesMap.get(seriesModel.componentIndex) == null;\n  },\n\n  /**\n   * @return {Array.<number>}\n   */\n  getCurrentSeriesIndices: function () {\n    return (this._seriesIndices || []).slice();\n  },\n\n  /**\n   * @param {Function} cb\n   * @param {*} context\n   */\n  filterSeries: function (cb, context) {\n    var filteredSeries = filter(this._componentsMap.get('series'), cb, context);\n    createSeriesIndices(this, filteredSeries);\n  },\n  restoreData: function (payload) {\n    var componentsMap = this._componentsMap;\n    createSeriesIndices(this, componentsMap.get('series'));\n    var componentTypes = [];\n    componentsMap.each(function (components, componentType) {\n      componentTypes.push(componentType);\n    });\n    ComponentModel.topologicalTravel(componentTypes, ComponentModel.getAllClassMainTypes(), function (componentType, dependencies) {\n      each$1(componentsMap.get(componentType), function (component) {\n        (componentType !== 'series' || !isNotTargetSeries(component, payload)) && component.restoreData();\n      });\n    });\n  }\n});\n\nfunction isNotTargetSeries(seriesModel, payload) {\n  if (payload) {\n    var index = payload.seiresIndex;\n    var id = payload.seriesId;\n    var name = payload.seriesName;\n    return index != null && seriesModel.componentIndex !== index || id != null && seriesModel.id !== id || name != null && seriesModel.name !== name;\n  }\n}\n/**\n * @inner\n */\n\n\nfunction mergeTheme(option, theme) {\n  // PENDING\n  // NOT use `colorLayer` in theme if option has `color`\n  var notMergeColorLayer = option.color && !option.colorLayer;\n  each$1(theme, function (themeItem, name) {\n    if (name === 'colorLayer' && notMergeColorLayer) {\n      return;\n    } //  component model  merge  model \n\n\n    if (!ComponentModel.hasClass(name)) {\n      if (typeof themeItem === 'object') {\n        option[name] = !option[name] ? clone(themeItem) : merge(option[name], themeItem, false);\n      } else {\n        if (option[name] == null) {\n          option[name] = themeItem;\n        }\n      }\n    }\n  });\n}\n\nfunction initBase(baseOption) {\n  baseOption = baseOption; // Using OPTION_INNER_KEY to mark that this option can not be used outside,\n  // i.e. `chart.setOption(chart.getModel().option);` is forbiden.\n\n  this.option = {};\n  this.option[OPTION_INNER_KEY] = 1;\n  /**\n   * Init with series: [], in case of calling findSeries method\n   * before series initialized.\n   * @type {Object.<string, Array.<module:echarts/model/Model>>}\n   * @private\n   */\n\n  this._componentsMap = createHashMap({\n    series: []\n  });\n  /**\n   * Mapping between filtered series list and raw series list.\n   * key: filtered series indices, value: raw series indices.\n   * @type {Array.<nubmer>}\n   * @private\n   */\n\n  this._seriesIndices;\n  this._seriesIndicesMap;\n  mergeTheme(baseOption, this._theme.option); // TODO Needs clone when merging to the unexisted property\n\n  merge(baseOption, globalDefault, false);\n  this.mergeOption(baseOption);\n}\n/**\n * @inner\n * @param {Array.<string>|string} types model types\n * @return {Object} key: {string} type, value: {Array.<Object>} models\n */\n\n\nfunction getComponentsByTypes(componentsMap, types) {\n  if (!isArray(types)) {\n    types = types ? [types] : [];\n  }\n\n  var ret = {};\n  each$1(types, function (type) {\n    ret[type] = (componentsMap.get(type) || []).slice();\n  });\n  return ret;\n}\n/**\n * @inner\n */\n\n\nfunction determineSubType(mainType, newCptOption, existComponent) {\n  var subType = newCptOption.type ? newCptOption.type : existComponent ? existComponent.subType // Use determineSubType only when there is no existComponent.\n  : ComponentModel.determineSubType(mainType, newCptOption); // tooltip, markline, markpoint may always has no subType\n\n  return subType;\n}\n/**\n * @inner\n */\n\n\nfunction createSeriesIndices(ecModel, seriesModels) {\n  ecModel._seriesIndicesMap = createHashMap(ecModel._seriesIndices = map(seriesModels, function (series) {\n    return series.componentIndex;\n  }) || []);\n}\n/**\n * @inner\n */\n\n\nfunction filterBySubType(components, condition) {\n  // Using hasOwnProperty for restrict. Consider\n  // subType is undefined in user payload.\n  return condition.hasOwnProperty('subType') ? filter(components, function (cpt) {\n    return cpt.subType === condition.subType;\n  }) : components;\n}\nmixin(GlobalModel, colorPaletteMixin);\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar echartsAPIList = ['getDom', 'getZr', 'getWidth', 'getHeight', 'getDevicePixelRatio', 'dispatchAction', 'isDisposed', 'on', 'off', 'getDataURL', 'getConnectedDataURL', 'getModel', 'getOption', 'getViewOfComponentModel', 'getViewOfSeriesModel']; // And `getCoordinateSystems` and `getComponentByElement` will be injected in echarts.js\n\nfunction ExtensionAPI(chartInstance) {\n  each$1(echartsAPIList, function (name) {\n    this[name] = bind(chartInstance[name], chartInstance);\n  }, this);\n}\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar coordinateSystemCreators = {};\n\nfunction CoordinateSystemManager() {\n  this._coordinateSystems = [];\n}\n\nCoordinateSystemManager.prototype = {\n  constructor: CoordinateSystemManager,\n  create: function (ecModel, api) {\n    var coordinateSystems = [];\n    each$1(coordinateSystemCreators, function (creater, type) {\n      var list = creater.create(ecModel, api);\n      coordinateSystems = coordinateSystems.concat(list || []);\n    });\n    this._coordinateSystems = coordinateSystems;\n  },\n  update: function (ecModel, api) {\n    each$1(this._coordinateSystems, function (coordSys) {\n      coordSys.update && coordSys.update(ecModel, api);\n    });\n  },\n  getCoordinateSystems: function () {\n    return this._coordinateSystems.slice();\n  }\n};\n\nCoordinateSystemManager.register = function (type, coordinateSystemCreator) {\n  coordinateSystemCreators[type] = coordinateSystemCreator;\n};\n\nCoordinateSystemManager.get = function (type) {\n  return coordinateSystemCreators[type];\n};\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * ECharts option manager\n *\n * @module {echarts/model/OptionManager}\n */\nvar each$4 = each$1;\nvar clone$3 = clone;\nvar map$1 = map;\nvar merge$1 = merge;\nvar QUERY_REG = /^(min|max)?(.+)$/;\n/**\n * TERM EXPLANATIONS:\n *\n * [option]:\n *\n *     An object that contains definitions of components. For example:\n *     var option = {\n *         title: {...},\n *         legend: {...},\n *         visualMap: {...},\n *         series: [\n *             {data: [...]},\n *             {data: [...]},\n *             ...\n *         ]\n *     };\n *\n * [rawOption]:\n *\n *     An object input to echarts.setOption. 'rawOption' may be an\n *     'option', or may be an object contains multi-options. For example:\n *     var option = {\n *         baseOption: {\n *             title: {...},\n *             legend: {...},\n *             series: [\n *                 {data: [...]},\n *                 {data: [...]},\n *                 ...\n *             ]\n *         },\n *         timeline: {...},\n *         options: [\n *             {title: {...}, series: {data: [...]}},\n *             {title: {...}, series: {data: [...]}},\n *             ...\n *         ],\n *         media: [\n *             {\n *                 query: {maxWidth: 320},\n *                 option: {series: {x: 20}, visualMap: {show: false}}\n *             },\n *             {\n *                 query: {minWidth: 320, maxWidth: 720},\n *                 option: {series: {x: 500}, visualMap: {show: true}}\n *             },\n *             {\n *                 option: {series: {x: 1200}, visualMap: {show: true}}\n *             }\n *         ]\n *     };\n *\n * @alias module:echarts/model/OptionManager\n * @param {module:echarts/ExtensionAPI} api\n */\n\nfunction OptionManager(api) {\n  /**\n   * @private\n   * @type {module:echarts/ExtensionAPI}\n   */\n  this._api = api;\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n\n  this._timelineOptions = [];\n  /**\n   * @private\n   * @type {Array.<Object>}\n   */\n\n  this._mediaList = [];\n  /**\n   * @private\n   * @type {Object}\n   */\n\n  this._mediaDefault;\n  /**\n   * -1, means default.\n   * empty means no media.\n   * @private\n   * @type {Array.<number>}\n   */\n\n  this._currentMediaIndices = [];\n  /**\n   * @private\n   * @type {Object}\n   */\n\n  this._optionBackup;\n  /**\n   * @private\n   * @type {Object}\n   */\n\n  this._newBaseOption;\n} // timeline.notMerge is not supported in ec3. Firstly there is rearly\n// case that notMerge is needed. Secondly supporting 'notMerge' requires\n// rawOption cloned and backuped when timeline changed, which does no\n// good to performance. What's more, that both timeline and setOption\n// method supply 'notMerge' brings complex and some problems.\n// Consider this case:\n// (step1) chart.setOption({timeline: {notMerge: false}, ...}, false);\n// (step2) chart.setOption({timeline: {notMerge: true}, ...}, false);\n\n\nOptionManager.prototype = {\n  constructor: OptionManager,\n\n  /**\n   * @public\n   * @param {Object} rawOption Raw option.\n   * @param {module:echarts/model/Global} ecModel\n   * @param {Array.<Function>} optionPreprocessorFuncs\n   * @return {Object} Init option\n   */\n  setOption: function (rawOption, optionPreprocessorFuncs) {\n    if (rawOption) {\n      // That set dat primitive is dangerous if user reuse the data when setOption again.\n      each$1(normalizeToArray(rawOption.series), function (series) {\n        series && series.data && isTypedArray(series.data) && setAsPrimitive(series.data);\n      });\n    } // Caution: some series modify option data, if do not clone,\n    // it should ensure that the repeat modify correctly\n    // (create a new object when modify itself).\n\n\n    rawOption = clone$3(rawOption, true); // FIXME\n    //  timeline options  media baseOption\n\n    var oldOptionBackup = this._optionBackup;\n    var newParsedOption = parseRawOption.call(this, rawOption, optionPreprocessorFuncs, !oldOptionBackup);\n    this._newBaseOption = newParsedOption.baseOption; // For setOption at second time (using merge mode);\n\n    if (oldOptionBackup) {\n      // Only baseOption can be merged.\n      mergeOption(oldOptionBackup.baseOption, newParsedOption.baseOption); // For simplicity, timeline options and media options do not support merge,\n      // that is, if you `setOption` twice and both has timeline options, the latter\n      // timeline opitons will not be merged to the formers, but just substitude them.\n\n      if (newParsedOption.timelineOptions.length) {\n        oldOptionBackup.timelineOptions = newParsedOption.timelineOptions;\n      }\n\n      if (newParsedOption.mediaList.length) {\n        oldOptionBackup.mediaList = newParsedOption.mediaList;\n      }\n\n      if (newParsedOption.mediaDefault) {\n        oldOptionBackup.mediaDefault = newParsedOption.mediaDefault;\n      }\n    } else {\n      this._optionBackup = newParsedOption;\n    }\n  },\n\n  /**\n   * @param {boolean} isRecreate\n   * @return {Object}\n   */\n  mountOption: function (isRecreate) {\n    var optionBackup = this._optionBackup; // TODO\n    // resetclone\n\n    this._timelineOptions = map$1(optionBackup.timelineOptions, clone$3);\n    this._mediaList = map$1(optionBackup.mediaList, clone$3);\n    this._mediaDefault = clone$3(optionBackup.mediaDefault);\n    this._currentMediaIndices = [];\n    return clone$3(isRecreate // this._optionBackup.baseOption, which is created at the first `setOption`\n    // called, and is merged into every new option by inner method `mergeOption`\n    // each time `setOption` called, can be only used in `isRecreate`, because\n    // its reliability is under suspicion. In other cases option merge is\n    // performed by `model.mergeOption`.\n    ? optionBackup.baseOption : this._newBaseOption);\n  },\n\n  /**\n   * @param {module:echarts/model/Global} ecModel\n   * @return {Object}\n   */\n  getTimelineOption: function (ecModel) {\n    var option;\n    var timelineOptions = this._timelineOptions;\n\n    if (timelineOptions.length) {\n      // getTimelineOption can only be called after ecModel inited,\n      // so we can get currentIndex from timelineModel.\n      var timelineModel = ecModel.getComponent('timeline');\n\n      if (timelineModel) {\n        option = clone$3(timelineOptions[timelineModel.getCurrentIndex()], true);\n      }\n    }\n\n    return option;\n  },\n\n  /**\n   * @param {module:echarts/model/Global} ecModel\n   * @return {Array.<Object>}\n   */\n  getMediaOption: function (ecModel) {\n    var ecWidth = this._api.getWidth();\n\n    var ecHeight = this._api.getHeight();\n\n    var mediaList = this._mediaList;\n    var mediaDefault = this._mediaDefault;\n    var indices = [];\n    var result = []; // No media defined.\n\n    if (!mediaList.length && !mediaDefault) {\n      return result;\n    } // Multi media may be applied, the latter defined media has higher priority.\n\n\n    for (var i = 0, len = mediaList.length; i < len; i++) {\n      if (applyMediaQuery(mediaList[i].query, ecWidth, ecHeight)) {\n        indices.push(i);\n      }\n    } // FIXME\n    // mediaDefault\n\n\n    if (!indices.length && mediaDefault) {\n      indices = [-1];\n    }\n\n    if (indices.length && !indicesEquals(indices, this._currentMediaIndices)) {\n      result = map$1(indices, function (index) {\n        return clone$3(index === -1 ? mediaDefault.option : mediaList[index].option);\n      });\n    } // Otherwise return nothing.\n\n\n    this._currentMediaIndices = indices;\n    return result;\n  }\n};\n\nfunction parseRawOption(rawOption, optionPreprocessorFuncs, isNew) {\n  var timelineOptions = [];\n  var mediaList = [];\n  var mediaDefault;\n  var baseOption; // Compatible with ec2.\n\n  var timelineOpt = rawOption.timeline;\n\n  if (rawOption.baseOption) {\n    baseOption = rawOption.baseOption;\n  } // For timeline\n\n\n  if (timelineOpt || rawOption.options) {\n    baseOption = baseOption || {};\n    timelineOptions = (rawOption.options || []).slice();\n  } // For media query\n\n\n  if (rawOption.media) {\n    baseOption = baseOption || {};\n    var media = rawOption.media;\n    each$4(media, function (singleMedia) {\n      if (singleMedia && singleMedia.option) {\n        if (singleMedia.query) {\n          mediaList.push(singleMedia);\n        } else if (!mediaDefault) {\n          // Use the first media default.\n          mediaDefault = singleMedia;\n        }\n      }\n    });\n  } // For normal option\n\n\n  if (!baseOption) {\n    baseOption = rawOption;\n  } // Set timelineOpt to baseOption in ec3,\n  // which is convenient for merge option.\n\n\n  if (!baseOption.timeline) {\n    baseOption.timeline = timelineOpt;\n  } // Preprocess.\n\n\n  each$4([baseOption].concat(timelineOptions).concat(map(mediaList, function (media) {\n    return media.option;\n  })), function (option) {\n    each$4(optionPreprocessorFuncs, function (preProcess) {\n      preProcess(option, isNew);\n    });\n  });\n  return {\n    baseOption: baseOption,\n    timelineOptions: timelineOptions,\n    mediaDefault: mediaDefault,\n    mediaList: mediaList\n  };\n}\n/**\n * @see <http://www.w3.org/TR/css3-mediaqueries/#media1>\n * Support: width, height, aspectRatio\n * Can use max or min as prefix.\n */\n\n\nfunction applyMediaQuery(query, ecWidth, ecHeight) {\n  var realMap = {\n    width: ecWidth,\n    height: ecHeight,\n    aspectratio: ecWidth / ecHeight // lowser case for convenientce.\n\n  };\n  var applicatable = true;\n  each$1(query, function (value, attr) {\n    var matched = attr.match(QUERY_REG);\n\n    if (!matched || !matched[1] || !matched[2]) {\n      return;\n    }\n\n    var operator = matched[1];\n    var realAttr = matched[2].toLowerCase();\n\n    if (!compare(realMap[realAttr], value, operator)) {\n      applicatable = false;\n    }\n  });\n  return applicatable;\n}\n\nfunction compare(real, expect, operator) {\n  if (operator === 'min') {\n    return real >= expect;\n  } else if (operator === 'max') {\n    return real <= expect;\n  } else {\n    // Equals\n    return real === expect;\n  }\n}\n\nfunction indicesEquals(indices1, indices2) {\n  // indices is always order by asc and has only finite number.\n  return indices1.join(',') === indices2.join(',');\n}\n/**\n * Consider case:\n * `chart.setOption(opt1);`\n * Then user do some interaction like dataZoom, dataView changing.\n * `chart.setOption(opt2);`\n * Then user press 'reset button' in toolbox.\n *\n * After doing that all of the interaction effects should be reset, the\n * chart should be the same as the result of invoke\n * `chart.setOption(opt1); chart.setOption(opt2);`.\n *\n * Although it is not able ensure that\n * `chart.setOption(opt1); chart.setOption(opt2);` is equivalents to\n * `chart.setOption(merge(opt1, opt2));` exactly,\n * this might be the only simple way to implement that feature.\n *\n * MEMO: We've considered some other approaches:\n * 1. Each model handle its self restoration but not uniform treatment.\n *     (Too complex in logic and error-prone)\n * 2. Use a shadow ecModel. (Performace expensive)\n */\n\n\nfunction mergeOption(oldOption, newOption) {\n  newOption = newOption || {};\n  each$4(newOption, function (newCptOpt, mainType) {\n    if (newCptOpt == null) {\n      return;\n    }\n\n    var oldCptOpt = oldOption[mainType];\n\n    if (!ComponentModel.hasClass(mainType)) {\n      oldOption[mainType] = merge$1(oldCptOpt, newCptOpt, true);\n    } else {\n      newCptOpt = normalizeToArray(newCptOpt);\n      oldCptOpt = normalizeToArray(oldCptOpt);\n      var mapResult = mappingToExists(oldCptOpt, newCptOpt);\n      oldOption[mainType] = map$1(mapResult, function (item) {\n        return item.option && item.exist ? merge$1(item.exist, item.option, true) : item.exist || item.option;\n      });\n    }\n  });\n}\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar each$5 = each$1;\nvar isObject$3 = isObject$1;\nvar POSSIBLE_STYLES = ['areaStyle', 'lineStyle', 'nodeStyle', 'linkStyle', 'chordStyle', 'label', 'labelLine'];\n\nfunction compatEC2ItemStyle(opt) {\n  var itemStyleOpt = opt && opt.itemStyle;\n\n  if (!itemStyleOpt) {\n    return;\n  }\n\n  for (var i = 0, len = POSSIBLE_STYLES.length; i < len; i++) {\n    var styleName = POSSIBLE_STYLES[i];\n    var normalItemStyleOpt = itemStyleOpt.normal;\n    var emphasisItemStyleOpt = itemStyleOpt.emphasis;\n\n    if (normalItemStyleOpt && normalItemStyleOpt[styleName]) {\n      opt[styleName] = opt[styleName] || {};\n\n      if (!opt[styleName].normal) {\n        opt[styleName].normal = normalItemStyleOpt[styleName];\n      } else {\n        merge(opt[styleName].normal, normalItemStyleOpt[styleName]);\n      }\n\n      normalItemStyleOpt[styleName] = null;\n    }\n\n    if (emphasisItemStyleOpt && emphasisItemStyleOpt[styleName]) {\n      opt[styleName] = opt[styleName] || {};\n\n      if (!opt[styleName].emphasis) {\n        opt[styleName].emphasis = emphasisItemStyleOpt[styleName];\n      } else {\n        merge(opt[styleName].emphasis, emphasisItemStyleOpt[styleName]);\n      }\n\n      emphasisItemStyleOpt[styleName] = null;\n    }\n  }\n}\n\nfunction convertNormalEmphasis(opt, optType, useExtend) {\n  if (opt && opt[optType] && (opt[optType].normal || opt[optType].emphasis)) {\n    var normalOpt = opt[optType].normal;\n    var emphasisOpt = opt[optType].emphasis;\n\n    if (normalOpt) {\n      // Timeline controlStyle has other properties besides normal and emphasis\n      if (useExtend) {\n        opt[optType].normal = opt[optType].emphasis = null;\n        defaults(opt[optType], normalOpt);\n      } else {\n        opt[optType] = normalOpt;\n      }\n    }\n\n    if (emphasisOpt) {\n      opt.emphasis = opt.emphasis || {};\n      opt.emphasis[optType] = emphasisOpt;\n    }\n  }\n}\n\nfunction removeEC3NormalStatus(opt) {\n  convertNormalEmphasis(opt, 'itemStyle');\n  convertNormalEmphasis(opt, 'lineStyle');\n  convertNormalEmphasis(opt, 'areaStyle');\n  convertNormalEmphasis(opt, 'label');\n  convertNormalEmphasis(opt, 'labelLine'); // treemap\n\n  convertNormalEmphasis(opt, 'upperLabel'); // graph\n\n  convertNormalEmphasis(opt, 'edgeLabel');\n}\n\nfunction compatTextStyle(opt, propName) {\n  // Check whether is not object (string\\null\\undefined ...)\n  var labelOptSingle = isObject$3(opt) && opt[propName];\n  var textStyle = isObject$3(labelOptSingle) && labelOptSingle.textStyle;\n\n  if (textStyle) {\n    for (var i = 0, len = TEXT_STYLE_OPTIONS.length; i < len; i++) {\n      var propName = TEXT_STYLE_OPTIONS[i];\n\n      if (textStyle.hasOwnProperty(propName)) {\n        labelOptSingle[propName] = textStyle[propName];\n      }\n    }\n  }\n}\n\nfunction compatEC3CommonStyles(opt) {\n  if (opt) {\n    removeEC3NormalStatus(opt);\n    compatTextStyle(opt, 'label');\n    opt.emphasis && compatTextStyle(opt.emphasis, 'label');\n  }\n}\n\nfunction processSeries(seriesOpt) {\n  if (!isObject$3(seriesOpt)) {\n    return;\n  }\n\n  compatEC2ItemStyle(seriesOpt);\n  removeEC3NormalStatus(seriesOpt);\n  compatTextStyle(seriesOpt, 'label'); // treemap\n\n  compatTextStyle(seriesOpt, 'upperLabel'); // graph\n\n  compatTextStyle(seriesOpt, 'edgeLabel');\n\n  if (seriesOpt.emphasis) {\n    compatTextStyle(seriesOpt.emphasis, 'label'); // treemap\n\n    compatTextStyle(seriesOpt.emphasis, 'upperLabel'); // graph\n\n    compatTextStyle(seriesOpt.emphasis, 'edgeLabel');\n  }\n\n  var markPoint = seriesOpt.markPoint;\n\n  if (markPoint) {\n    compatEC2ItemStyle(markPoint);\n    compatEC3CommonStyles(markPoint);\n  }\n\n  var markLine = seriesOpt.markLine;\n\n  if (markLine) {\n    compatEC2ItemStyle(markLine);\n    compatEC3CommonStyles(markLine);\n  }\n\n  var markArea = seriesOpt.markArea;\n\n  if (markArea) {\n    compatEC3CommonStyles(markArea);\n  }\n\n  var data = seriesOpt.data; // Break with ec3: if `setOption` again, there may be no `type` in option,\n  // then the backward compat based on option type will not be performed.\n\n  if (seriesOpt.type === 'graph') {\n    data = data || seriesOpt.nodes;\n    var edgeData = seriesOpt.links || seriesOpt.edges;\n\n    if (edgeData && !isTypedArray(edgeData)) {\n      for (var i = 0; i < edgeData.length; i++) {\n        compatEC3CommonStyles(edgeData[i]);\n      }\n    }\n\n    each$1(seriesOpt.categories, function (opt) {\n      removeEC3NormalStatus(opt);\n    });\n  }\n\n  if (data && !isTypedArray(data)) {\n    for (var i = 0; i < data.length; i++) {\n      compatEC3CommonStyles(data[i]);\n    }\n  } // mark point data\n\n\n  var markPoint = seriesOpt.markPoint;\n\n  if (markPoint && markPoint.data) {\n    var mpData = markPoint.data;\n\n    for (var i = 0; i < mpData.length; i++) {\n      compatEC3CommonStyles(mpData[i]);\n    }\n  } // mark line data\n\n\n  var markLine = seriesOpt.markLine;\n\n  if (markLine && markLine.data) {\n    var mlData = markLine.data;\n\n    for (var i = 0; i < mlData.length; i++) {\n      if (isArray(mlData[i])) {\n        compatEC3CommonStyles(mlData[i][0]);\n        compatEC3CommonStyles(mlData[i][1]);\n      } else {\n        compatEC3CommonStyles(mlData[i]);\n      }\n    }\n  } // Series\n\n\n  if (seriesOpt.type === 'gauge') {\n    compatTextStyle(seriesOpt, 'axisLabel');\n    compatTextStyle(seriesOpt, 'title');\n    compatTextStyle(seriesOpt, 'detail');\n  } else if (seriesOpt.type === 'treemap') {\n    convertNormalEmphasis(seriesOpt.breadcrumb, 'itemStyle');\n    each$1(seriesOpt.levels, function (opt) {\n      removeEC3NormalStatus(opt);\n    });\n  } else if (seriesOpt.type === 'tree') {\n    removeEC3NormalStatus(seriesOpt.leaves);\n  } // sunburst starts from ec4, so it does not need to compat levels.\n\n}\n\nfunction toArr(o) {\n  return isArray(o) ? o : o ? [o] : [];\n}\n\nfunction toObj(o) {\n  return (isArray(o) ? o[0] : o) || {};\n}\n\nvar compatStyle = function (option, isTheme) {\n  each$5(toArr(option.series), function (seriesOpt) {\n    isObject$3(seriesOpt) && processSeries(seriesOpt);\n  });\n  var axes = ['xAxis', 'yAxis', 'radiusAxis', 'angleAxis', 'singleAxis', 'parallelAxis', 'radar'];\n  isTheme && axes.push('valueAxis', 'categoryAxis', 'logAxis', 'timeAxis');\n  each$5(axes, function (axisName) {\n    each$5(toArr(option[axisName]), function (axisOpt) {\n      if (axisOpt) {\n        compatTextStyle(axisOpt, 'axisLabel');\n        compatTextStyle(axisOpt.axisPointer, 'label');\n      }\n    });\n  });\n  each$5(toArr(option.parallel), function (parallelOpt) {\n    var parallelAxisDefault = parallelOpt && parallelOpt.parallelAxisDefault;\n    compatTextStyle(parallelAxisDefault, 'axisLabel');\n    compatTextStyle(parallelAxisDefault && parallelAxisDefault.axisPointer, 'label');\n  });\n  each$5(toArr(option.calendar), function (calendarOpt) {\n    convertNormalEmphasis(calendarOpt, 'itemStyle');\n    compatTextStyle(calendarOpt, 'dayLabel');\n    compatTextStyle(calendarOpt, 'monthLabel');\n    compatTextStyle(calendarOpt, 'yearLabel');\n  }); // radar.name.textStyle\n\n  each$5(toArr(option.radar), function (radarOpt) {\n    compatTextStyle(radarOpt, 'name');\n  });\n  each$5(toArr(option.geo), function (geoOpt) {\n    if (isObject$3(geoOpt)) {\n      compatEC3CommonStyles(geoOpt);\n      each$5(toArr(geoOpt.regions), function (regionObj) {\n        compatEC3CommonStyles(regionObj);\n      });\n    }\n  });\n  each$5(toArr(option.timeline), function (timelineOpt) {\n    compatEC3CommonStyles(timelineOpt);\n    convertNormalEmphasis(timelineOpt, 'label');\n    convertNormalEmphasis(timelineOpt, 'itemStyle');\n    convertNormalEmphasis(timelineOpt, 'controlStyle', true);\n    var data = timelineOpt.data;\n    isArray(data) && each$1(data, function (item) {\n      if (isObject$1(item)) {\n        convertNormalEmphasis(item, 'label');\n        convertNormalEmphasis(item, 'itemStyle');\n      }\n    });\n  });\n  each$5(toArr(option.toolbox), function (toolboxOpt) {\n    convertNormalEmphasis(toolboxOpt, 'iconStyle');\n    each$5(toolboxOpt.feature, function (featureOpt) {\n      convertNormalEmphasis(featureOpt, 'iconStyle');\n    });\n  });\n  compatTextStyle(toObj(option.axisPointer), 'label');\n  compatTextStyle(toObj(option.tooltip).axisPointer, 'label');\n};\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n// Compatitable with 2.0\nfunction get(opt, path) {\n  path = path.split(',');\n  var obj = opt;\n\n  for (var i = 0; i < path.length; i++) {\n    obj = obj && obj[path[i]];\n\n    if (obj == null) {\n      break;\n    }\n  }\n\n  return obj;\n}\n\nfunction set$1(opt, path, val, overwrite) {\n  path = path.split(',');\n  var obj = opt;\n  var key;\n\n  for (var i = 0; i < path.length - 1; i++) {\n    key = path[i];\n\n    if (obj[key] == null) {\n      obj[key] = {};\n    }\n\n    obj = obj[key];\n  }\n\n  if (overwrite || obj[path[i]] == null) {\n    obj[path[i]] = val;\n  }\n}\n\nfunction compatLayoutProperties(option) {\n  each$1(LAYOUT_PROPERTIES, function (prop) {\n    if (prop[0] in option && !(prop[1] in option)) {\n      option[prop[1]] = option[prop[0]];\n    }\n  });\n}\n\nvar LAYOUT_PROPERTIES = [['x', 'left'], ['y', 'top'], ['x2', 'right'], ['y2', 'bottom']];\nvar COMPATITABLE_COMPONENTS = ['grid', 'geo', 'parallel', 'legend', 'toolbox', 'title', 'visualMap', 'dataZoom', 'timeline'];\nvar backwardCompat = function (option, isTheme) {\n  compatStyle(option, isTheme); // Make sure series array for model initialization.\n\n  option.series = normalizeToArray(option.series);\n  each$1(option.series, function (seriesOpt) {\n    if (!isObject$1(seriesOpt)) {\n      return;\n    }\n\n    var seriesType = seriesOpt.type;\n\n    if (seriesType === 'pie' || seriesType === 'gauge') {\n      if (seriesOpt.clockWise != null) {\n        seriesOpt.clockwise = seriesOpt.clockWise;\n      }\n    }\n\n    if (seriesType === 'gauge') {\n      var pointerColor = get(seriesOpt, 'pointer.color');\n      pointerColor != null && set$1(seriesOpt, 'itemStyle.normal.color', pointerColor);\n    }\n\n    compatLayoutProperties(seriesOpt);\n  }); // dataRange has changed to visualMap\n\n  if (option.dataRange) {\n    option.visualMap = option.dataRange;\n  }\n\n  each$1(COMPATITABLE_COMPONENTS, function (componentName) {\n    var options = option[componentName];\n\n    if (options) {\n      if (!isArray(options)) {\n        options = [options];\n      }\n\n      each$1(options, function (option) {\n        compatLayoutProperties(option);\n      });\n    }\n  });\n};\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n//     data processing stage is blocked in stream.\n//     See <module:echarts/stream/Scheduler#performDataProcessorTasks>\n// (2) Only register once when import repeatly.\n//     Should be executed before after series filtered and before stack calculation.\n\nvar dataStack = function (ecModel) {\n  var stackInfoMap = createHashMap();\n  ecModel.eachSeries(function (seriesModel) {\n    var stack = seriesModel.get('stack'); // Compatibal: when `stack` is set as '', do not stack.\n\n    if (stack) {\n      var stackInfoList = stackInfoMap.get(stack) || stackInfoMap.set(stack, []);\n      var data = seriesModel.getData();\n      var stackInfo = {\n        // Used for calculate axis extent automatically.\n        stackResultDimension: data.getCalculationInfo('stackResultDimension'),\n        stackedOverDimension: data.getCalculationInfo('stackedOverDimension'),\n        stackedDimension: data.getCalculationInfo('stackedDimension'),\n        stackedByDimension: data.getCalculationInfo('stackedByDimension'),\n        isStackedByIndex: data.getCalculationInfo('isStackedByIndex'),\n        data: data,\n        seriesModel: seriesModel\n      }; // If stacked on axis that do not support data stack.\n\n      if (!stackInfo.stackedDimension || !(stackInfo.isStackedByIndex || stackInfo.stackedByDimension)) {\n        return;\n      }\n\n      stackInfoList.length && data.setCalculationInfo('stackedOnSeries', stackInfoList[stackInfoList.length - 1].seriesModel);\n      stackInfoList.push(stackInfo);\n    }\n  });\n  stackInfoMap.each(calculateStack);\n};\n\nfunction calculateStack(stackInfoList) {\n  each$1(stackInfoList, function (targetStackInfo, idxInStack) {\n    var resultVal = [];\n    var resultNaN = [NaN, NaN];\n    var dims = [targetStackInfo.stackResultDimension, targetStackInfo.stackedOverDimension];\n    var targetData = targetStackInfo.data;\n    var isStackedByIndex = targetStackInfo.isStackedByIndex; // Should not write on raw data, because stack series model list changes\n    // depending on legend selection.\n\n    var newData = targetData.map(dims, function (v0, v1, dataIndex) {\n      var sum = targetData.get(targetStackInfo.stackedDimension, dataIndex); // Consider `connectNulls` of line area, if value is NaN, stackedOver\n      // should also be NaN, to draw a appropriate belt area.\n\n      if (isNaN(sum)) {\n        return resultNaN;\n      }\n\n      var byValue;\n      var stackedDataRawIndex;\n\n      if (isStackedByIndex) {\n        stackedDataRawIndex = targetData.getRawIndex(dataIndex);\n      } else {\n        byValue = targetData.get(targetStackInfo.stackedByDimension, dataIndex);\n      } // If stackOver is NaN, chart view will render point on value start.\n\n\n      var stackedOver = NaN;\n\n      for (var j = idxInStack - 1; j >= 0; j--) {\n        var stackInfo = stackInfoList[j]; // Has been optimized by inverted indices on `stackedByDimension`.\n\n        if (!isStackedByIndex) {\n          stackedDataRawIndex = stackInfo.data.rawIndexOf(stackInfo.stackedByDimension, byValue);\n        }\n\n        if (stackedDataRawIndex >= 0) {\n          var val = stackInfo.data.getByRawIndex(stackInfo.stackResultDimension, stackedDataRawIndex); // Considering positive stack, negative stack and empty data\n\n          if (sum >= 0 && val > 0 || // Positive stack\n          sum <= 0 && val < 0 // Negative stack\n          ) {\n              sum += val;\n              stackedOver = val;\n              break;\n            }\n        }\n      }\n\n      resultVal[0] = sum;\n      resultVal[1] = stackedOver;\n      return resultVal;\n    });\n    targetData.hostModel.setData(newData); // Update for consequent calculation\n\n    targetStackInfo.data = newData;\n  });\n}\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n// TODO\n// ??? refactor? check the outer usage of data provider.\n// merge with defaultDimValueGetter?\n/**\n * If normal array used, mutable chunk size is supported.\n * If typed array used, chunk size must be fixed.\n */\n\nfunction DefaultDataProvider(source, dimSize) {\n  if (!Source.isInstance(source)) {\n    source = Source.seriesDataToSource(source);\n  }\n\n  this._source = source;\n  var data = this._data = source.data;\n  var sourceFormat = source.sourceFormat; // Typed array. TODO IE10+?\n\n  if (sourceFormat === SOURCE_FORMAT_TYPED_ARRAY) {\n    this._offset = 0;\n    this._dimSize = dimSize;\n    this._data = data;\n  }\n\n  var methods = providerMethods[sourceFormat === SOURCE_FORMAT_ARRAY_ROWS ? sourceFormat + '_' + source.seriesLayoutBy : sourceFormat];\n  extend(this, methods);\n}\nvar providerProto = DefaultDataProvider.prototype; // If data is pure without style configuration\n\nproviderProto.pure = false; // If data is persistent and will not be released after use.\n\nproviderProto.persistent = true; // ???! FIXME legacy data provider do not has method getSource\n\nproviderProto.getSource = function () {\n  return this._source;\n};\n\nvar providerMethods = {\n  'arrayRows_column': {\n    pure: true,\n    count: function () {\n      return Math.max(0, this._data.length - this._source.startIndex);\n    },\n    getItem: function (idx) {\n      return this._data[idx + this._source.startIndex];\n    },\n    appendData: appendDataSimply\n  },\n  'arrayRows_row': {\n    pure: true,\n    count: function () {\n      var row = this._data[0];\n      return row ? Math.max(0, row.length - this._source.startIndex) : 0;\n    },\n    getItem: function (idx) {\n      idx += this._source.startIndex;\n      var item = [];\n      var data = this._data;\n\n      for (var i = 0; i < data.length; i++) {\n        var row = data[i];\n        item.push(row ? row[idx] : null);\n      }\n\n      return item;\n    },\n    appendData: function () {\n      throw new Error('Do not support appendData when set seriesLayoutBy: \"row\".');\n    }\n  },\n  'objectRows': {\n    pure: true,\n    count: countSimply,\n    getItem: getItemSimply,\n    appendData: appendDataSimply\n  },\n  'keyedColumns': {\n    pure: true,\n    count: function () {\n      var dimName = this._source.dimensionsDefine[0].name;\n      var col = this._data[dimName];\n      return col ? col.length : 0;\n    },\n    getItem: function (idx) {\n      var item = [];\n      var dims = this._source.dimensionsDefine;\n\n      for (var i = 0; i < dims.length; i++) {\n        var col = this._data[dims[i].name];\n        item.push(col ? col[idx] : null);\n      }\n\n      return item;\n    },\n    appendData: function (newData) {\n      var data = this._data;\n      each$1(newData, function (newCol, key) {\n        var oldCol = data[key] || (data[key] = []);\n\n        for (var i = 0; i < (newCol || []).length; i++) {\n          oldCol.push(newCol[i]);\n        }\n      });\n    }\n  },\n  'original': {\n    count: countSimply,\n    getItem: getItemSimply,\n    appendData: appendDataSimply\n  },\n  'typedArray': {\n    persistent: false,\n    pure: true,\n    count: function () {\n      return this._data ? this._data.length / this._dimSize : 0;\n    },\n    getItem: function (idx, out) {\n      idx = idx - this._offset;\n      out = out || [];\n      var offset = this._dimSize * idx;\n\n      for (var i = 0; i < this._dimSize; i++) {\n        out[i] = this._data[offset + i];\n      }\n\n      return out;\n    },\n    appendData: function (newData) {\n      this._data = newData;\n    },\n    // Clean self if data is already used.\n    clean: function () {\n      // PENDING\n      this._offset += this.count();\n      this._data = null;\n    }\n  }\n};\n\nfunction countSimply() {\n  return this._data.length;\n}\n\nfunction getItemSimply(idx) {\n  return this._data[idx];\n}\n\nfunction appendDataSimply(newData) {\n  for (var i = 0; i < newData.length; i++) {\n    this._data.push(newData[i]);\n  }\n}\n\nvar rawValueGetters = {\n  arrayRows: getRawValueSimply,\n  objectRows: function (dataItem, dataIndex, dimIndex, dimName) {\n    return dimIndex != null ? dataItem[dimName] : dataItem;\n  },\n  keyedColumns: getRawValueSimply,\n  original: function (dataItem, dataIndex, dimIndex, dimName) {\n    // FIXME\n    // In some case (markpoint in geo (geo-map.html)), dataItem\n    // is {coord: [...]}\n    var value = getDataItemValue(dataItem);\n    return dimIndex == null || !(value instanceof Array) ? value : value[dimIndex];\n  },\n  typedArray: getRawValueSimply\n};\n\nfunction getRawValueSimply(dataItem, dataIndex, dimIndex, dimName) {\n  return dimIndex != null ? dataItem[dimIndex] : dataItem;\n}\n\nvar defaultDimValueGetters = {\n  arrayRows: getDimValueSimply,\n  objectRows: function (dataItem, dimName, dataIndex, dimIndex) {\n    return converDataValue(dataItem[dimName], this._dimensionInfos[dimName]);\n  },\n  keyedColumns: getDimValueSimply,\n  original: function (dataItem, dimName, dataIndex, dimIndex) {\n    // Performance sensitive, do not use modelUtil.getDataItemValue.\n    // If dataItem is an plain object with no value field, the var `value`\n    // will be assigned with the object, but it will be tread correctly\n    // in the `convertDataValue`.\n    var value = dataItem && (dataItem.value == null ? dataItem : dataItem.value); // If any dataItem is like { value: 10 }\n\n    if (!this._rawData.pure && isDataItemOption(dataItem)) {\n      this.hasItemOption = true;\n    }\n\n    return converDataValue(value instanceof Array ? value[dimIndex] // If value is a single number or something else not array.\n    : value, this._dimensionInfos[dimName]);\n  },\n  typedArray: function (dataItem, dimName, dataIndex, dimIndex) {\n    return dataItem[dimIndex];\n  }\n};\n\nfunction getDimValueSimply(dataItem, dimName, dataIndex, dimIndex) {\n  return converDataValue(dataItem[dimIndex], this._dimensionInfos[dimName]);\n}\n/**\n * This helper method convert value in data.\n * @param {string|number|Date} value\n * @param {Object|string} [dimInfo] If string (like 'x'), dimType defaults 'number'.\n *        If \"dimInfo.ordinalParseAndSave\", ordinal value can be parsed.\n */\n\n\nfunction converDataValue(value, dimInfo) {\n  // Performance sensitive.\n  var dimType = dimInfo && dimInfo.type;\n\n  if (dimType === 'ordinal') {\n    // If given value is a category string\n    var ordinalMeta = dimInfo && dimInfo.ordinalMeta;\n    return ordinalMeta ? ordinalMeta.parseAndCollect(value) : value;\n  }\n\n  if (dimType === 'time' // spead up when using timestamp\n  && typeof value !== 'number' && value != null && value !== '-') {\n    value = +parseDate(value);\n  } // dimType defaults 'number'.\n  // If dimType is not ordinal and value is null or undefined or NaN or '-',\n  // parse to NaN.\n\n\n  return value == null || value === '' ? NaN // If string (like '-'), using '+' parse to NaN\n  // If object, also parse to NaN\n  : +value;\n} // ??? FIXME can these logic be more neat: getRawValue, getRawDataItem,\n// Consider persistent.\n// Caution: why use raw value to display on label or tooltip?\n// A reason is to avoid format. For example time value we do not know\n// how to format is expected. More over, if stack is used, calculated\n// value may be 0.91000000001, which have brings trouble to display.\n// TODO: consider how to treat null/undefined/NaN when display?\n\n/**\n * @param {module:echarts/data/List} data\n * @param {number} dataIndex\n * @param {string|number} [dim] dimName or dimIndex\n * @return {Array.<number>|string|number} can be null/undefined.\n */\n\n\nfunction retrieveRawValue(data, dataIndex, dim) {\n  if (!data) {\n    return;\n  } // Consider data may be not persistent.\n\n\n  var dataItem = data.getRawDataItem(dataIndex);\n\n  if (dataItem == null) {\n    return;\n  }\n\n  var sourceFormat = data.getProvider().getSource().sourceFormat;\n  var dimName;\n  var dimIndex;\n  var dimInfo = data.getDimensionInfo(dim);\n\n  if (dimInfo) {\n    dimName = dimInfo.name;\n    dimIndex = dimInfo.index;\n  }\n\n  return rawValueGetters[sourceFormat](dataItem, dataIndex, dimIndex, dimName);\n}\n/**\n * Compatible with some cases (in pie, map) like:\n * data: [{name: 'xx', value: 5, selected: true}, ...]\n * where only sourceFormat is 'original' and 'objectRows' supported.\n *\n * ??? TODO\n * Supported detail options in data item when using 'arrayRows'.\n *\n * @param {module:echarts/data/List} data\n * @param {number} dataIndex\n * @param {string} attr like 'selected'\n */\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar DIMENSION_LABEL_REG = /\\{@(.+?)\\}/g; // PENDING A little ugly\n\nvar dataFormatMixin = {\n  /**\n   * Get params for formatter\n   * @param {number} dataIndex\n   * @param {string} [dataType]\n   * @return {Object}\n   */\n  getDataParams: function (dataIndex, dataType) {\n    var data = this.getData(dataType);\n    var rawValue = this.getRawValue(dataIndex, dataType);\n    var rawDataIndex = data.getRawIndex(dataIndex);\n    var name = data.getName(dataIndex);\n    var itemOpt = data.getRawDataItem(dataIndex);\n    var color = data.getItemVisual(dataIndex, 'color');\n    return {\n      componentType: this.mainType,\n      componentSubType: this.subType,\n      seriesType: this.mainType === 'series' ? this.subType : null,\n      seriesIndex: this.seriesIndex,\n      seriesId: this.id,\n      seriesName: this.name,\n      name: name,\n      dataIndex: rawDataIndex,\n      data: itemOpt,\n      dataType: dataType,\n      value: rawValue,\n      color: color,\n      marker: getTooltipMarker(color),\n      // Param name list for mapping `a`, `b`, `c`, `d`, `e`\n      $vars: ['seriesName', 'name', 'value']\n    };\n  },\n\n  /**\n   * Format label\n   * @param {number} dataIndex\n   * @param {string} [status='normal'] 'normal' or 'emphasis'\n   * @param {string} [dataType]\n   * @param {number} [dimIndex]\n   * @param {string} [labelProp='label']\n   * @return {string} If not formatter, return null/undefined\n   */\n  getFormattedLabel: function (dataIndex, status, dataType, dimIndex, labelProp) {\n    status = status || 'normal';\n    var data = this.getData(dataType);\n    var itemModel = data.getItemModel(dataIndex);\n    var params = this.getDataParams(dataIndex, dataType);\n\n    if (dimIndex != null && params.value instanceof Array) {\n      params.value = params.value[dimIndex];\n    }\n\n    var formatter = itemModel.get(status === 'normal' ? [labelProp || 'label', 'formatter'] : [status, labelProp || 'label', 'formatter']);\n\n    if (typeof formatter === 'function') {\n      params.status = status;\n      return formatter(params);\n    } else if (typeof formatter === 'string') {\n      var str = formatTpl(formatter, params); // Support 'aaa{@[3]}bbb{@product}ccc'.\n      // Do not support '}' in dim name util have to.\n\n      return str.replace(DIMENSION_LABEL_REG, function (origin, dim) {\n        var len = dim.length;\n\n        if (dim.charAt(0) === '[' && dim.charAt(len - 1) === ']') {\n          dim = +dim.slice(1, len - 1); // Also: '[]' => 0\n        }\n\n        return retrieveRawValue(data, dataIndex, dim);\n      });\n    }\n  },\n\n  /**\n   * Get raw value in option\n   * @param {number} idx\n   * @param {string} [dataType]\n   * @return {Array|number|string}\n   */\n  getRawValue: function (idx, dataType) {\n    return retrieveRawValue(this.getData(dataType), idx);\n  },\n\n  /**\n   * Should be implemented.\n   * @param {number} dataIndex\n   * @param {boolean} [multipleSeries=false]\n   * @param {number} [dataType]\n   * @return {string} tooltip string\n   */\n  formatTooltip: function () {// Empty function\n  }\n};\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n/**\n * @param {Object} define\n * @return See the return of `createTask`.\n */\n\nfunction createTask(define) {\n  return new Task(define);\n}\n/**\n * @constructor\n * @param {Object} define\n * @param {Function} define.reset Custom reset\n * @param {Function} [define.plan] Returns 'reset' indicate reset immediately.\n * @param {Function} [define.count] count is used to determin data task.\n * @param {Function} [define.onDirty] count is used to determin data task.\n */\n\nfunction Task(define) {\n  define = define || {};\n  this._reset = define.reset;\n  this._plan = define.plan;\n  this._count = define.count;\n  this._onDirty = define.onDirty;\n  this._dirty = true; // Context must be specified implicitly, to\n  // avoid miss update context when model changed.\n\n  this.context;\n}\n\nvar taskProto = Task.prototype;\n/**\n * @param {Object} performArgs\n * @param {number} [performArgs.step] Specified step.\n * @param {number} [performArgs.skip] Skip customer perform call.\n * @param {number} [performArgs.modBy] Sampling window size.\n * @param {number} [performArgs.modDataCount] Sampling count.\n */\n\ntaskProto.perform = function (performArgs) {\n  var upTask = this._upstream;\n  var skip = performArgs && performArgs.skip; // TODO some refactor.\n  // Pull data. Must pull data each time, because context.data\n  // may be updated by Series.setData.\n\n  if (this._dirty && upTask) {\n    var context = this.context;\n    context.data = context.outputData = upTask.context.outputData;\n  }\n\n  if (this.__pipeline) {\n    this.__pipeline.currentTask = this;\n  }\n\n  var planResult;\n\n  if (this._plan && !skip) {\n    planResult = this._plan(this.context);\n  } // Support sharding by mod, which changes the render sequence and makes the rendered graphic\n  // elements uniformed distributed when progress, especially when moving or zooming.\n\n\n  var lastModBy = normalizeModBy(this._modBy);\n  var lastModDataCount = this._modDataCount || 0;\n  var modBy = normalizeModBy(performArgs && performArgs.modBy);\n  var modDataCount = performArgs && performArgs.modDataCount || 0;\n\n  if (lastModBy !== modBy || lastModDataCount !== modDataCount) {\n    planResult = 'reset';\n  }\n\n  function normalizeModBy(val) {\n    !(val >= 1) && (val = 1); // jshint ignore:line\n\n    return val;\n  }\n\n  var forceFirstProgress;\n\n  if (this._dirty || planResult === 'reset') {\n    this._dirty = false;\n    forceFirstProgress = reset(this, skip);\n  }\n\n  this._modBy = modBy;\n  this._modDataCount = modDataCount;\n  var step = performArgs && performArgs.step;\n\n  if (upTask) {\n    this._dueEnd = upTask._outputDueEnd;\n  } // DataTask or overallTask\n  else {\n      this._dueEnd = this._count ? this._count(this.context) : Infinity;\n    } // Note: Stubs, that its host overall task let it has progress, has progress.\n  // If no progress, pass index from upstream to downstream each time plan called.\n\n\n  if (this._progress) {\n    var start = this._dueIndex;\n    var end = Math.min(step != null ? this._dueIndex + step : Infinity, this._dueEnd);\n\n    if (!skip && (forceFirstProgress || start < end)) {\n      var progress = this._progress;\n\n      if (isArray(progress)) {\n        for (var i = 0; i < progress.length; i++) {\n          doProgress(this, progress[i], start, end, modBy, modDataCount);\n        }\n      } else {\n        doProgress(this, progress, start, end, modBy, modDataCount);\n      }\n    }\n\n    this._dueIndex = end; // If no `outputDueEnd`, assume that output data and\n    // input data is the same, so use `dueIndex` as `outputDueEnd`.\n\n    var outputDueEnd = this._settedOutputEnd != null ? this._settedOutputEnd : end;\n    this._outputDueEnd = outputDueEnd;\n  } else {\n    // (1) Some overall task has no progress.\n    // (2) Stubs, that its host overall task do not let it has progress, has no progress.\n    // This should always be performed so it can be passed to downstream.\n    this._dueIndex = this._outputDueEnd = this._settedOutputEnd != null ? this._settedOutputEnd : this._dueEnd;\n  }\n\n  return this.unfinished();\n};\n\nvar iterator = function () {\n  var end;\n  var current;\n  var modBy;\n  var modDataCount;\n  var winCount;\n  var it = {\n    reset: function (s, e, sStep, sCount) {\n      current = s;\n      end = e;\n      modBy = sStep;\n      modDataCount = sCount;\n      winCount = Math.ceil(modDataCount / modBy);\n      it.next = modBy > 1 && modDataCount > 0 ? modNext : sequentialNext;\n    }\n  };\n  return it;\n\n  function sequentialNext() {\n    return current < end ? current++ : null;\n  }\n\n  function modNext() {\n    var dataIndex = current % winCount * modBy + Math.ceil(current / winCount);\n    var result = current >= end ? null : dataIndex < modDataCount ? dataIndex // If modDataCount is smaller than data.count() (consider `appendData` case),\n    // Use normal linear rendering mode.\n    : current;\n    current++;\n    return result;\n  }\n}();\n\ntaskProto.dirty = function () {\n  this._dirty = true;\n  this._onDirty && this._onDirty(this.context);\n};\n\nfunction doProgress(taskIns, progress, start, end, modBy, modDataCount) {\n  iterator.reset(start, end, modBy, modDataCount);\n  taskIns._callingProgress = progress;\n\n  taskIns._callingProgress({\n    start: start,\n    end: end,\n    count: end - start,\n    next: iterator.next\n  }, taskIns.context);\n}\n\nfunction reset(taskIns, skip) {\n  taskIns._dueIndex = taskIns._outputDueEnd = taskIns._dueEnd = 0;\n  taskIns._settedOutputEnd = null;\n  var progress;\n  var forceFirstProgress;\n\n  if (!skip && taskIns._reset) {\n    progress = taskIns._reset(taskIns.context);\n\n    if (progress && progress.progress) {\n      forceFirstProgress = progress.forceFirstProgress;\n      progress = progress.progress;\n    } // To simplify no progress checking, array must has item.\n\n\n    if (isArray(progress) && !progress.length) {\n      progress = null;\n    }\n  }\n\n  taskIns._progress = progress;\n  taskIns._modBy = taskIns._modDataCount = null;\n  var downstream = taskIns._downstream;\n  downstream && downstream.dirty();\n  return forceFirstProgress;\n}\n/**\n * @return {boolean}\n */\n\n\ntaskProto.unfinished = function () {\n  return this._progress && this._dueIndex < this._dueEnd;\n};\n/**\n * @param {Object} downTask The downstream task.\n * @return {Object} The downstream task.\n */\n\n\ntaskProto.pipe = function (downTask) {\n  // If already downstream, do not dirty downTask.\n  if (this._downstream !== downTask || this._dirty) {\n    this._downstream = downTask;\n    downTask._upstream = this;\n    downTask.dirty();\n  }\n};\n\ntaskProto.dispose = function () {\n  if (this._disposed) {\n    return;\n  }\n\n  this._upstream && (this._upstream._downstream = null);\n  this._downstream && (this._downstream._upstream = null);\n  this._dirty = false;\n  this._disposed = true;\n};\n\ntaskProto.getUpstream = function () {\n  return this._upstream;\n};\n\ntaskProto.getDownstream = function () {\n  return this._downstream;\n};\n\ntaskProto.setOutputEnd = function (end) {\n  // This only happend in dataTask, dataZoom, map, currently.\n  // where dataZoom do not set end each time, but only set\n  // when reset. So we should record the setted end, in case\n  // that the stub of dataZoom perform again and earse the\n  // setted end by upstream.\n  this._outputDueEnd = this._settedOutputEnd = end;\n}; ///////////////////////////////////////////////////////////\n// For stream debug (Should be commented out after used!)\n// Usage: printTask(this, 'begin');\n// Usage: printTask(this, null, {someExtraProp});\n// function printTask(task, prefix, extra) {\n//     window.ecTaskUID == null && (window.ecTaskUID = 0);\n//     task.uidDebug == null && (task.uidDebug = `task_${window.ecTaskUID++}`);\n//     task.agent && task.agent.uidDebug == null && (task.agent.uidDebug = `task_${window.ecTaskUID++}`);\n//     var props = [];\n//     if (task.__pipeline) {\n//         var val = `${task.__idxInPipeline}/${task.__pipeline.tail.__idxInPipeline} ${task.agent ? '(stub)' : ''}`;\n//         props.push({text: 'idx', value: val});\n//     } else {\n//         var stubCount = 0;\n//         task.agentStubMap.each(() => stubCount++);\n//         props.push({text: 'idx', value: `overall (stubs: ${stubCount})`});\n//     }\n//     props.push({text: 'uid', value: task.uidDebug});\n//     if (task.__pipeline) {\n//         props.push({text: 'pid', value: task.__pipeline.id});\n//         task.agent && props.push(\n//             {text: 'stubFor', value: task.agent.uidDebug}\n//         );\n//     }\n//     props.push(\n//         {text: 'dirty', value: task._dirty},\n//         {text: 'dueIndex', value: task._dueIndex},\n//         {text: 'dueEnd', value: task._dueEnd},\n//         {text: 'outputDueEnd', value: task._outputDueEnd}\n//     );\n//     if (extra) {\n//         Object.keys(extra).forEach(key => {\n//             props.push({text: key, value: extra[key]});\n//         });\n//     }\n//     var args = ['color: blue'];\n//     var msg = `%c[${prefix || 'T'}] %c` + props.map(item => (\n//         args.push('color: black', 'color: red'),\n//         `${item.text}: %c${item.value}`\n//     )).join('%c, ');\n//     console.log.apply(console, [msg].concat(args));\n//     // console.log(this);\n// }\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar inner$4 = makeInner();\nvar SeriesModel = ComponentModel.extend({\n  type: 'series.__base__',\n\n  /**\n   * @readOnly\n   */\n  seriesIndex: 0,\n  // coodinateSystem will be injected in the echarts/CoordinateSystem\n  coordinateSystem: null,\n\n  /**\n   * @type {Object}\n   * @protected\n   */\n  defaultOption: null,\n\n  /**\n   * Data provided for legend\n   * @type {Function}\n   */\n  // PENDING\n  legendDataProvider: null,\n\n  /**\n   * Access path of color for visual\n   */\n  visualColorAccessPath: 'itemStyle.color',\n\n  /**\n   * Support merge layout params.\n   * Only support 'box' now (left/right/top/bottom/width/height).\n   * @type {string|Object} Object can be {ignoreSize: true}\n   * @readOnly\n   */\n  layoutMode: null,\n  init: function (option, parentModel, ecModel, extraOpt) {\n    /**\n     * @type {number}\n     * @readOnly\n     */\n    this.seriesIndex = this.componentIndex;\n    this.dataTask = createTask({\n      count: dataTaskCount,\n      reset: dataTaskReset\n    });\n    this.dataTask.context = {\n      model: this\n    };\n    this.mergeDefaultAndTheme(option, ecModel);\n    prepareSource(this);\n    var data = this.getInitialData(option, ecModel);\n    wrapData(data, this);\n    this.dataTask.context.data = data;\n\n    /**\n     * @type {module:echarts/data/List|module:echarts/data/Tree|module:echarts/data/Graph}\n     * @private\n     */\n    inner$4(this).dataBeforeProcessed = data; // If we reverse the order (make data firstly, and then make\n    // dataBeforeProcessed by cloneShallow), cloneShallow will\n    // cause data.graph.data !== data when using\n    // module:echarts/data/Graph or module:echarts/data/Tree.\n    // See module:echarts/data/helper/linkList\n    // Theoretically, it is unreasonable to call `seriesModel.getData()` in the model\n    // init or merge stage, because the data can be restored. So we do not `restoreData`\n    // and `setData` here, which forbids calling `seriesModel.getData()` in this stage.\n    // Call `seriesModel.getRawData()` instead.\n    // this.restoreData();\n\n    autoSeriesName(this);\n  },\n\n  /**\n   * Util for merge default and theme to option\n   * @param  {Object} option\n   * @param  {module:echarts/model/Global} ecModel\n   */\n  mergeDefaultAndTheme: function (option, ecModel) {\n    var layoutMode = this.layoutMode;\n    var inputPositionParams = layoutMode ? getLayoutParams(option) : {}; // Backward compat: using subType on theme.\n    // But if name duplicate between series subType\n    // (for example: parallel) add component mainType,\n    // add suffix 'Series'.\n\n    var themeSubType = this.subType;\n\n    if (ComponentModel.hasClass(themeSubType)) {\n      themeSubType += 'Series';\n    }\n\n    merge(option, ecModel.getTheme().get(this.subType));\n    merge(option, this.getDefaultOption()); // Default label emphasis `show`\n\n    defaultEmphasis(option, 'label', ['show']);\n    this.fillDataTextStyle(option.data);\n\n    if (layoutMode) {\n      mergeLayoutParam(option, inputPositionParams, layoutMode);\n    }\n  },\n  mergeOption: function (newSeriesOption, ecModel) {\n    // this.settingTask.dirty();\n    newSeriesOption = merge(this.option, newSeriesOption, true);\n    this.fillDataTextStyle(newSeriesOption.data);\n    var layoutMode = this.layoutMode;\n\n    if (layoutMode) {\n      mergeLayoutParam(this.option, newSeriesOption, layoutMode);\n    }\n\n    prepareSource(this);\n    var data = this.getInitialData(newSeriesOption, ecModel);\n    wrapData(data, this);\n    this.dataTask.dirty();\n    this.dataTask.context.data = data;\n    inner$4(this).dataBeforeProcessed = data;\n    autoSeriesName(this);\n  },\n  fillDataTextStyle: function (data) {\n    // Default data label emphasis `show`\n    // FIXME Tree structure data ?\n    // FIXME Performance ?\n    if (data && !isTypedArray(data)) {\n      var props = ['show'];\n\n      for (var i = 0; i < data.length; i++) {\n        if (data[i] && data[i].label) {\n          defaultEmphasis(data[i], 'label', props);\n        }\n      }\n    }\n  },\n\n  /**\n   * Init a data structure from data related option in series\n   * Must be overwritten\n   */\n  getInitialData: function () {},\n\n  /**\n   * Append data to list\n   * @param {Object} params\n   * @param {Array|TypedArray} params.data\n   */\n  appendData: function (params) {\n    // FIXME ???\n    // (1) If data from dataset, forbidden append.\n    // (2) support append data of dataset.\n    var data = this.getRawData();\n    data.appendData(params.data);\n  },\n\n  /**\n   * Consider some method like `filter`, `map` need make new data,\n   * We should make sure that `seriesModel.getData()` get correct\n   * data in the stream procedure. So we fetch data from upstream\n   * each time `task.perform` called.\n   * @param {string} [dataType]\n   * @return {module:echarts/data/List}\n   */\n  getData: function (dataType) {\n    var task = getCurrentTask(this);\n\n    if (task) {\n      var data = task.context.data;\n      return dataType == null ? data : data.getLinkedData(dataType);\n    } else {\n      // When series is not alive (that may happen when click toolbox\n      // restore or setOption with not merge mode), series data may\n      // be still need to judge animation or something when graphic\n      // elements want to know whether fade out.\n      return inner$4(this).data;\n    }\n  },\n\n  /**\n   * @param {module:echarts/data/List} data\n   */\n  setData: function (data) {\n    var task = getCurrentTask(this);\n\n    if (task) {\n      var context = task.context; // Consider case: filter, data sample.\n\n      if (context.data !== data && task.modifyOutputEnd) {\n        task.setOutputEnd(data.count());\n      }\n\n      context.outputData = data; // Caution: setData should update context.data,\n      // Because getData may be called multiply in a\n      // single stage and expect to get the data just\n      // set. (For example, AxisProxy, x y both call\n      // getData and setDate sequentially).\n      // So the context.data should be fetched from\n      // upstream each time when a stage starts to be\n      // performed.\n\n      if (task !== this.dataTask) {\n        context.data = data;\n      }\n    }\n\n    inner$4(this).data = data;\n  },\n\n  /**\n   * @see {module:echarts/data/helper/sourceHelper#getSource}\n   * @return {module:echarts/data/Source} source\n   */\n  getSource: function () {\n    return getSource(this);\n  },\n\n  /**\n   * Get data before processed\n   * @return {module:echarts/data/List}\n   */\n  getRawData: function () {\n    return inner$4(this).dataBeforeProcessed;\n  },\n\n  /**\n   * Get base axis if has coordinate system and has axis.\n   * By default use coordSys.getBaseAxis();\n   * Can be overrided for some chart.\n   * @return {type} description\n   */\n  getBaseAxis: function () {\n    var coordSys = this.coordinateSystem;\n    return coordSys && coordSys.getBaseAxis && coordSys.getBaseAxis();\n  },\n  // FIXME\n\n  /**\n   * Default tooltip formatter\n   *\n   * @param {number} dataIndex\n   * @param {boolean} [multipleSeries=false]\n   * @param {number} [dataType]\n   */\n  formatTooltip: function (dataIndex, multipleSeries, dataType) {\n    function formatArrayValue(value) {\n      // ??? TODO refactor these logic.\n      // check: category-no-encode-has-axis-data in dataset.html\n      var vertially = reduce(value, function (vertially, val, idx) {\n        var dimItem = data.getDimensionInfo(idx);\n        return vertially |= dimItem && dimItem.tooltip !== false && dimItem.displayName != null;\n      }, 0);\n      var result = [];\n      tooltipDims.length ? each$1(tooltipDims, function (dim) {\n        setEachItem(retrieveRawValue(data, dataIndex, dim), dim);\n      }) // By default, all dims is used on tooltip.\n      : each$1(value, setEachItem);\n\n      function setEachItem(val, dim) {\n        var dimInfo = data.getDimensionInfo(dim); // If `dimInfo.tooltip` is not set, show tooltip.\n\n        if (!dimInfo || dimInfo.otherDims.tooltip === false) {\n          return;\n        }\n\n        var dimType = dimInfo.type;\n        var dimHead = getTooltipMarker({\n          color: color,\n          type: 'subItem'\n        });\n        var valStr = (vertially ? dimHead + encodeHTML(dimInfo.displayName || '-') + ': ' : '') + // FIXME should not format time for raw data?\n        encodeHTML(dimType === 'ordinal' ? val + '' : dimType === 'time' ? multipleSeries ? '' : formatTime('yyyy/MM/dd hh:mm:ss', val) : addCommas(val));\n        valStr && result.push(valStr);\n      }\n\n      return (vertially ? '<br/>' : '') + result.join(vertially ? '<br/>' : ', ');\n    }\n\n    function formatSingleValue(val) {\n      return encodeHTML(addCommas(val));\n    }\n\n    var data = this.getData();\n    var tooltipDims = data.mapDimension('defaultedTooltip', true);\n    var tooltipDimLen = tooltipDims.length;\n    var value = this.getRawValue(dataIndex);\n    var isValueArr = isArray(value);\n    var color = data.getItemVisual(dataIndex, 'color');\n\n    if (isObject$1(color) && color.colorStops) {\n      color = (color.colorStops[0] || {}).color;\n    }\n\n    color = color || 'transparent'; // Complicated rule for pretty tooltip.\n\n    var formattedValue = tooltipDimLen > 1 || isValueArr && !tooltipDimLen ? formatArrayValue(value) : tooltipDimLen ? formatSingleValue(retrieveRawValue(data, dataIndex, tooltipDims[0])) : formatSingleValue(isValueArr ? value[0] : value);\n    var colorEl = getTooltipMarker(color);\n    var name = data.getName(dataIndex);\n    var seriesName = this.name;\n\n    if (!isNameSpecified(this)) {\n      seriesName = '';\n    }\n\n    seriesName = seriesName ? encodeHTML(seriesName) + (!multipleSeries ? '<br/>' : ': ') : '';\n    return !multipleSeries ? seriesName + colorEl + (name ? encodeHTML(name) + ': ' + formattedValue : formattedValue) : colorEl + seriesName + formattedValue;\n  },\n\n  /**\n   * @return {boolean}\n   */\n  isAnimationEnabled: function () {\n    if (env$1.node) {\n      return false;\n    }\n\n    var animationEnabled = this.getShallow('animation');\n\n    if (animationEnabled) {\n      if (this.getData().count() > this.getShallow('animationThreshold')) {\n        animationEnabled = false;\n      }\n    }\n\n    return animationEnabled;\n  },\n  restoreData: function () {\n    this.dataTask.dirty();\n  },\n  getColorFromPalette: function (name, scope, requestColorNum) {\n    var ecModel = this.ecModel; // PENDING\n\n    var color = colorPaletteMixin.getColorFromPalette.call(this, name, scope, requestColorNum);\n\n    if (!color) {\n      color = ecModel.getColorFromPalette(name, scope, requestColorNum);\n    }\n\n    return color;\n  },\n\n  /**\n   * Use `data.mapDimension(coordDim, true)` instead.\n   * @deprecated\n   */\n  coordDimToDataDim: function (coordDim) {\n    return this.getRawData().mapDimension(coordDim, true);\n  },\n\n  /**\n   * Get progressive rendering count each step\n   * @return {number}\n   */\n  getProgressive: function () {\n    return this.get('progressive');\n  },\n\n  /**\n   * Get progressive rendering count each step\n   * @return {number}\n   */\n  getProgressiveThreshold: function () {\n    return this.get('progressiveThreshold');\n  },\n\n  /**\n   * Get data indices for show tooltip content. See tooltip.\n   * @abstract\n   * @param {Array.<string>|string} dim\n   * @param {Array.<number>} value\n   * @param {module:echarts/coord/single/SingleAxis} baseAxis\n   * @return {Object} {dataIndices, nestestValue}.\n   */\n  getAxisTooltipData: null,\n\n  /**\n   * See tooltip.\n   * @abstract\n   * @param {number} dataIndex\n   * @return {Array.<number>} Point of tooltip. null/undefined can be returned.\n   */\n  getTooltipPosition: null,\n\n  /**\n   * @see {module:echarts/stream/Scheduler}\n   */\n  pipeTask: null,\n\n  /**\n   * Convinient for override in extended class.\n   * @protected\n   * @type {Function}\n   */\n  preventIncremental: null,\n\n  /**\n   * @public\n   * @readOnly\n   * @type {Object}\n   */\n  pipelineContext: null\n});\nmixin(SeriesModel, dataFormatMixin);\nmixin(SeriesModel, colorPaletteMixin);\n/**\n * MUST be called after `prepareSource` called\n * Here we need to make auto series, especially for auto legend. But we\n * do not modify series.name in option to avoid side effects.\n */\n\nfunction autoSeriesName(seriesModel) {\n  // User specified name has higher priority, otherwise it may cause\n  // series can not be queried unexpectedly.\n  var name = seriesModel.name;\n\n  if (!isNameSpecified(seriesModel)) {\n    seriesModel.name = getSeriesAutoName(seriesModel) || name;\n  }\n}\n\nfunction getSeriesAutoName(seriesModel) {\n  var data = seriesModel.getRawData();\n  var dataDims = data.mapDimension('seriesName', true);\n  var nameArr = [];\n  each$1(dataDims, function (dataDim) {\n    var dimInfo = data.getDimensionInfo(dataDim);\n    dimInfo.displayName && nameArr.push(dimInfo.displayName);\n  });\n  return nameArr.join(' ');\n}\n\nfunction dataTaskCount(context) {\n  return context.model.getRawData().count();\n}\n\nfunction dataTaskReset(context) {\n  var seriesModel = context.model;\n  seriesModel.setData(seriesModel.getRawData().cloneShallow());\n  return dataTaskProgress;\n}\n\nfunction dataTaskProgress(param, context) {\n  // Avoid repead cloneShallow when data just created in reset.\n  if (param.end > context.outputData.count()) {\n    context.model.getRawData().cloneShallow(context.outputData);\n  }\n} // TODO refactor\n\n\nfunction wrapData(data, seriesModel) {\n  each$1(data.CHANGABLE_METHODS, function (methodName) {\n    data.wrapMethod(methodName, curry(onDataSelfChange, seriesModel));\n  });\n}\n\nfunction onDataSelfChange(seriesModel) {\n  var task = getCurrentTask(seriesModel);\n\n  if (task) {\n    // Consider case: filter, selectRange\n    task.setOutputEnd(this.count());\n  }\n}\n\nfunction getCurrentTask(seriesModel) {\n  var scheduler = (seriesModel.ecModel || {}).scheduler;\n  var pipeline = scheduler && scheduler.getPipeline(seriesModel.uid);\n\n  if (pipeline) {\n    // When pipline finished, the currrentTask keep the last\n    // task (renderTask).\n    var task = pipeline.currentTask;\n\n    if (task) {\n      var agentStubMap = task.agentStubMap;\n\n      if (agentStubMap) {\n        task = agentStubMap.get(seriesModel.uid);\n      }\n    }\n\n    return task;\n  }\n}\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar Component$1 = function () {\n  /**\n   * @type {module:zrender/container/Group}\n   * @readOnly\n   */\n  this.group = new Group();\n  /**\n   * @type {string}\n   * @readOnly\n   */\n\n  this.uid = getUID('viewComponent');\n};\n\nComponent$1.prototype = {\n  constructor: Component$1,\n  init: function (ecModel, api) {},\n  render: function (componentModel, ecModel, api, payload) {},\n  dispose: function () {}\n};\nvar componentProto = Component$1.prototype;\n\ncomponentProto.updateView = componentProto.updateLayout = componentProto.updateVisual = function (seriesModel, ecModel, api, payload) {// Do nothing;\n}; // Enable Component.extend.\n\n\nenableClassExtend(Component$1); // Enable capability of registerClass, getClass, hasClass, registerSubTypeDefaulter and so on.\n\nenableClassManagement(Component$1, {\n  registerWhenExtend: true\n});\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n/**\n * @return {string} If large mode changed, return string 'reset';\n */\n\nvar createRenderPlanner = function () {\n  var inner = makeInner();\n  return function (seriesModel) {\n    var fields = inner(seriesModel);\n    var pipelineContext = seriesModel.pipelineContext;\n    var originalLarge = fields.large;\n    var originalProgressive = fields.progressiveRender;\n    var large = fields.large = pipelineContext.large;\n    var progressive = fields.progressiveRender = pipelineContext.progressiveRender;\n    return !!(originalLarge ^ large || originalProgressive ^ progressive) && 'reset';\n  };\n};\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar inner$5 = makeInner();\nvar renderPlanner = createRenderPlanner();\n\nfunction Chart() {\n  /**\n   * @type {module:zrender/container/Group}\n   * @readOnly\n   */\n  this.group = new Group();\n  /**\n   * @type {string}\n   * @readOnly\n   */\n\n  this.uid = getUID('viewChart');\n  this.renderTask = createTask({\n    plan: renderTaskPlan,\n    reset: renderTaskReset\n  });\n  this.renderTask.context = {\n    view: this\n  };\n}\n\nChart.prototype = {\n  type: 'chart',\n\n  /**\n   * Init the chart.\n   * @param  {module:echarts/model/Global} ecModel\n   * @param  {module:echarts/ExtensionAPI} api\n   */\n  init: function (ecModel, api) {},\n\n  /**\n   * Render the chart.\n   * @param  {module:echarts/model/Series} seriesModel\n   * @param  {module:echarts/model/Global} ecModel\n   * @param  {module:echarts/ExtensionAPI} api\n   * @param  {Object} payload\n   */\n  render: function (seriesModel, ecModel, api, payload) {},\n\n  /**\n   * Highlight series or specified data item.\n   * @param  {module:echarts/model/Series} seriesModel\n   * @param  {module:echarts/model/Global} ecModel\n   * @param  {module:echarts/ExtensionAPI} api\n   * @param  {Object} payload\n   */\n  highlight: function (seriesModel, ecModel, api, payload) {\n    toggleHighlight(seriesModel.getData(), payload, 'emphasis');\n  },\n\n  /**\n   * Downplay series or specified data item.\n   * @param  {module:echarts/model/Series} seriesModel\n   * @param  {module:echarts/model/Global} ecModel\n   * @param  {module:echarts/ExtensionAPI} api\n   * @param  {Object} payload\n   */\n  downplay: function (seriesModel, ecModel, api, payload) {\n    toggleHighlight(seriesModel.getData(), payload, 'normal');\n  },\n\n  /**\n   * Remove self.\n   * @param  {module:echarts/model/Global} ecModel\n   * @param  {module:echarts/ExtensionAPI} api\n   */\n  remove: function (ecModel, api) {\n    this.group.removeAll();\n  },\n\n  /**\n   * Dispose self.\n   * @param  {module:echarts/model/Global} ecModel\n   * @param  {module:echarts/ExtensionAPI} api\n   */\n  dispose: function () {},\n\n  /**\n   * Rendering preparation in progressive mode.\n   * @param  {module:echarts/model/Series} seriesModel\n   * @param  {module:echarts/model/Global} ecModel\n   * @param  {module:echarts/ExtensionAPI} api\n   * @param  {Object} payload\n   */\n  incrementalPrepareRender: null,\n\n  /**\n   * Render in progressive mode.\n   * @param  {module:echarts/model/Series} seriesModel\n   * @param  {module:echarts/model/Global} ecModel\n   * @param  {module:echarts/ExtensionAPI} api\n   * @param  {Object} payload\n   */\n  incrementalRender: null,\n\n  /**\n   * Update transform directly.\n   * @param  {module:echarts/model/Series} seriesModel\n   * @param  {module:echarts/model/Global} ecModel\n   * @param  {module:echarts/ExtensionAPI} api\n   * @param  {Object} payload\n   * @return {Object} {update: true}\n   */\n  updateTransform: null\n  /**\n   * The view contains the given point.\n   * @interface\n   * @param {Array.<number>} point\n   * @return {boolean}\n   */\n  // containPoint: function () {}\n\n};\nvar chartProto = Chart.prototype;\n\nchartProto.updateView = chartProto.updateLayout = chartProto.updateVisual = function (seriesModel, ecModel, api, payload) {\n  this.render(seriesModel, ecModel, api, payload);\n};\n/**\n * Set state of single element\n * @param  {module:zrender/Element} el\n * @param  {string} state\n */\n\n\nfunction elSetState(el, state) {\n  if (el) {\n    el.trigger(state);\n\n    if (el.type === 'group') {\n      for (var i = 0; i < el.childCount(); i++) {\n        elSetState(el.childAt(i), state);\n      }\n    }\n  }\n}\n/**\n * @param  {module:echarts/data/List} data\n * @param  {Object} payload\n * @param  {string} state 'normal'|'emphasis'\n */\n\n\nfunction toggleHighlight(data, payload, state) {\n  var dataIndex = queryDataIndex(data, payload);\n\n  if (dataIndex != null) {\n    each$1(normalizeToArray(dataIndex), function (dataIdx) {\n      elSetState(data.getItemGraphicEl(dataIdx), state);\n    });\n  } else {\n    data.eachItemGraphicEl(function (el) {\n      elSetState(el, state);\n    });\n  }\n} // Enable Chart.extend.\n\n\nenableClassExtend(Chart, ['dispose']); // Add capability of registerClass, getClass, hasClass, registerSubTypeDefaulter and so on.\n\nenableClassManagement(Chart, {\n  registerWhenExtend: true\n});\n\nChart.markUpdateMethod = function (payload, methodName) {\n  inner$5(payload).updateMethod = methodName;\n};\n\nfunction renderTaskPlan(context) {\n  return renderPlanner(context.model);\n}\n\nfunction renderTaskReset(context) {\n  var seriesModel = context.model;\n  var ecModel = context.ecModel;\n  var api = context.api;\n  var payload = context.payload; // ???! remove updateView updateVisual\n\n  var progressiveRender = seriesModel.pipelineContext.progressiveRender;\n  var view = context.view;\n  var updateMethod = payload && inner$5(payload).updateMethod;\n  var methodName = progressiveRender ? 'incrementalPrepareRender' : updateMethod && view[updateMethod] ? updateMethod // `appendData` is also supported when data amount\n  // is less than progressive threshold.\n  : 'render';\n\n  if (methodName !== 'render') {\n    view[methodName](seriesModel, ecModel, api, payload);\n  }\n\n  return progressMethodMap[methodName];\n}\n\nvar progressMethodMap = {\n  incrementalPrepareRender: {\n    progress: function (params, context) {\n      context.view.incrementalRender(params, context.model, context.ecModel, context.api, context.payload);\n    }\n  },\n  render: {\n    // Put view.render in `progress` to support appendData. But in this case\n    // view.render should not be called in reset, otherwise it will be called\n    // twise. Use `forceFirstProgress` to make sure that view.render is called\n    // in any cases.\n    forceFirstProgress: true,\n    progress: function (params, context) {\n      context.view.render(context.model, context.ecModel, context.api, context.payload);\n    }\n  }\n};\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar ORIGIN_METHOD = '\\0__throttleOriginMethod';\nvar RATE = '\\0__throttleRate';\nvar THROTTLE_TYPE = '\\0__throttleType';\n/**\n * @public\n * @param {(Function)} fn\n * @param {number} [delay=0] Unit: ms.\n * @param {boolean} [debounce=false]\n *        true: If call interval less than `delay`, only the last call works.\n *        false: If call interval less than `delay, call works on fixed rate.\n * @return {(Function)} throttled fn.\n */\n\nfunction throttle(fn, delay, debounce) {\n  var currCall;\n  var lastCall = 0;\n  var lastExec = 0;\n  var timer = null;\n  var diff;\n  var scope;\n  var args;\n  var debounceNextCall;\n  delay = delay || 0;\n\n  function exec() {\n    lastExec = new Date().getTime();\n    timer = null;\n    fn.apply(scope, args || []);\n  }\n\n  var cb = function () {\n    currCall = new Date().getTime();\n    scope = this;\n    args = arguments;\n    var thisDelay = debounceNextCall || delay;\n    var thisDebounce = debounceNextCall || debounce;\n    debounceNextCall = null;\n    diff = currCall - (thisDebounce ? lastCall : lastExec) - thisDelay;\n    clearTimeout(timer); // Here we should make sure that: the `exec` SHOULD NOT be called later\n    // than a new call of `cb`, that is, preserving the command order. Consider\n    // calculating \"scale rate\" when roaming as an example. When a call of `cb`\n    // happens, either the `exec` is called dierectly, or the call is delayed.\n    // But the delayed call should never be later than next call of `cb`. Under\n    // this assurance, we can simply update view state each time `dispatchAction`\n    // triggered by user roaming, but not need to add extra code to avoid the\n    // state being \"rolled-back\".\n\n    if (thisDebounce) {\n      timer = setTimeout(exec, thisDelay);\n    } else {\n      if (diff >= 0) {\n        exec();\n      } else {\n        timer = setTimeout(exec, -diff);\n      }\n    }\n\n    lastCall = currCall;\n  };\n  /**\n   * Clear throttle.\n   * @public\n   */\n\n\n  cb.clear = function () {\n    if (timer) {\n      clearTimeout(timer);\n      timer = null;\n    }\n  };\n  /**\n   * Enable debounce once.\n   */\n\n\n  cb.debounceNextCall = function (debounceDelay) {\n    debounceNextCall = debounceDelay;\n  };\n\n  return cb;\n}\n/**\n * Create throttle method or update throttle rate.\n *\n * @example\n * ComponentView.prototype.render = function () {\n *     ...\n *     throttle.createOrUpdate(\n *         this,\n *         '_dispatchAction',\n *         this.model.get('throttle'),\n *         'fixRate'\n *     );\n * };\n * ComponentView.prototype.remove = function () {\n *     throttle.clear(this, '_dispatchAction');\n * };\n * ComponentView.prototype.dispose = function () {\n *     throttle.clear(this, '_dispatchAction');\n * };\n *\n * @public\n * @param {Object} obj\n * @param {string} fnAttr\n * @param {number} [rate]\n * @param {string} [throttleType='fixRate'] 'fixRate' or 'debounce'\n * @return {Function} throttled function.\n */\n\nfunction createOrUpdate(obj, fnAttr, rate, throttleType) {\n  var fn = obj[fnAttr];\n\n  if (!fn) {\n    return;\n  }\n\n  var originFn = fn[ORIGIN_METHOD] || fn;\n  var lastThrottleType = fn[THROTTLE_TYPE];\n  var lastRate = fn[RATE];\n\n  if (lastRate !== rate || lastThrottleType !== throttleType) {\n    if (rate == null || !throttleType) {\n      return obj[fnAttr] = originFn;\n    }\n\n    fn = obj[fnAttr] = throttle(originFn, rate, throttleType === 'debounce');\n    fn[ORIGIN_METHOD] = originFn;\n    fn[THROTTLE_TYPE] = throttleType;\n    fn[RATE] = rate;\n  }\n\n  return fn;\n}\n/**\n * Clear throttle. Example see throttle.createOrUpdate.\n *\n * @public\n * @param {Object} obj\n * @param {string} fnAttr\n */\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar seriesColor = {\n  createOnAllSeries: true,\n  performRawSeries: true,\n  reset: function (seriesModel, ecModel) {\n    var data = seriesModel.getData();\n    var colorAccessPath = (seriesModel.visualColorAccessPath || 'itemStyle.color').split('.');\n    var color = seriesModel.get(colorAccessPath) // Set in itemStyle\n    || seriesModel.getColorFromPalette( // TODO series count changed.\n    seriesModel.name, null, ecModel.getSeriesCount()); // Default color\n    // FIXME Set color function or use the platte color\n\n    data.setVisual('color', color); // Only visible series has each data be visual encoded\n\n    if (!ecModel.isSeriesFiltered(seriesModel)) {\n      if (typeof color === 'function' && !(color instanceof Gradient)) {\n        data.each(function (idx) {\n          data.setItemVisual(idx, 'color', color(seriesModel.getDataParams(idx)));\n        });\n      } // itemStyle in each data item\n\n\n      var dataEach = function (data, idx) {\n        var itemModel = data.getItemModel(idx);\n        var color = itemModel.get(colorAccessPath, true);\n\n        if (color != null) {\n          data.setItemVisual(idx, 'color', color);\n        }\n      };\n\n      return {\n        dataEach: data.hasItemOption ? dataEach : null\n      };\n    }\n  }\n};\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar lang = {\n  toolbox: {\n    brush: {\n      title: {\n        rect: '',\n        polygon: '',\n        lineX: '',\n        lineY: '',\n        keep: '',\n        clear: ''\n      }\n    },\n    dataView: {\n      title: '',\n      lang: ['', '', '']\n    },\n    dataZoom: {\n      title: {\n        zoom: '',\n        back: ''\n      }\n    },\n    magicType: {\n      title: {\n        line: '',\n        bar: '',\n        stack: '',\n        tiled: ''\n      }\n    },\n    restore: {\n      title: ''\n    },\n    saveAsImage: {\n      title: '',\n      lang: ['']\n    }\n  },\n  series: {\n    typeNames: {\n      pie: '',\n      bar: '',\n      line: '',\n      scatter: '',\n      effectScatter: '',\n      radar: '',\n      tree: '',\n      treemap: '',\n      boxplot: '',\n      candlestick: 'K',\n      k: 'K',\n      heatmap: '',\n      map: '',\n      parallel: '',\n      lines: '',\n      graph: '',\n      sankey: '',\n      funnel: '',\n      gauge: '',\n      pictorialBar: '',\n      themeRiver: '',\n      sunburst: ''\n    }\n  },\n  aria: {\n    general: {\n      withTitle: '{title}',\n      withoutTitle: ''\n    },\n    series: {\n      single: {\n        prefix: '',\n        withName: '{seriesType}{seriesName}',\n        withoutName: '{seriesType}'\n      },\n      multiple: {\n        prefix: '{seriesCount}',\n        withName: '{seriesId}{seriesName}{seriesType}',\n        withoutName: '{seriesId}{seriesType}',\n        separator: {\n          middle: '',\n          end: ''\n        }\n      }\n    },\n    data: {\n      allData: '',\n      partialData: '{displayCnt}',\n      withName: '{name}{value}',\n      withoutName: '{value}',\n      separator: {\n        middle: '',\n        end: ''\n      }\n    }\n  }\n};\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar aria = function (dom, ecModel) {\n  var ariaModel = ecModel.getModel('aria');\n\n  if (!ariaModel.get('show')) {\n    return;\n  } else if (ariaModel.get('description')) {\n    dom.setAttribute('aria-label', ariaModel.get('description'));\n    return;\n  }\n\n  var seriesCnt = 0;\n  ecModel.eachSeries(function (seriesModel, idx) {\n    ++seriesCnt;\n  }, this);\n  var maxDataCnt = ariaModel.get('data.maxCount') || 10;\n  var maxSeriesCnt = ariaModel.get('series.maxCount') || 10;\n  var displaySeriesCnt = Math.min(seriesCnt, maxSeriesCnt);\n  var ariaLabel;\n\n  if (seriesCnt < 1) {\n    // No series, no aria label\n    return;\n  } else {\n    var title = getTitle();\n\n    if (title) {\n      ariaLabel = replace(getConfig('general.withTitle'), {\n        title: title\n      });\n    } else {\n      ariaLabel = getConfig('general.withoutTitle');\n    }\n\n    var seriesLabels = [];\n    var prefix = seriesCnt > 1 ? 'series.multiple.prefix' : 'series.single.prefix';\n    ariaLabel += replace(getConfig(prefix), {\n      seriesCount: seriesCnt\n    });\n    ecModel.eachSeries(function (seriesModel, idx) {\n      if (idx < displaySeriesCnt) {\n        var seriesLabel;\n        var seriesName = seriesModel.get('name');\n        var seriesTpl = 'series.' + (seriesCnt > 1 ? 'multiple' : 'single') + '.';\n        seriesLabel = getConfig(seriesName ? seriesTpl + 'withName' : seriesTpl + 'withoutName');\n        seriesLabel = replace(seriesLabel, {\n          seriesId: seriesModel.seriesIndex,\n          seriesName: seriesModel.get('name'),\n          seriesType: getSeriesTypeName(seriesModel.subType)\n        });\n        var data = seriesModel.getData();\n        window.data = data;\n\n        if (data.count() > maxDataCnt) {\n          // Show part of data\n          seriesLabel += replace(getConfig('data.partialData'), {\n            displayCnt: maxDataCnt\n          });\n        } else {\n          seriesLabel += getConfig('data.allData');\n        }\n\n        var dataLabels = [];\n\n        for (var i = 0; i < data.count(); i++) {\n          if (i < maxDataCnt) {\n            var name = data.getName(i);\n            var value = retrieveRawValue(data, i);\n            dataLabels.push(replace(name ? getConfig('data.withName') : getConfig('data.withoutName'), {\n              name: name,\n              value: value\n            }));\n          }\n        }\n\n        seriesLabel += dataLabels.join(getConfig('data.separator.middle')) + getConfig('data.separator.end');\n        seriesLabels.push(seriesLabel);\n      }\n    });\n    ariaLabel += seriesLabels.join(getConfig('series.multiple.separator.middle')) + getConfig('series.multiple.separator.end');\n    dom.setAttribute('aria-label', ariaLabel);\n  }\n\n  function replace(str, keyValues) {\n    if (typeof str !== 'string') {\n      return str;\n    }\n\n    var result = str;\n    each$1(keyValues, function (value, key) {\n      result = result.replace(new RegExp('\\\\{\\\\s*' + key + '\\\\s*\\\\}', 'g'), value);\n    });\n    return result;\n  }\n\n  function getConfig(path) {\n    var userConfig = ariaModel.get(path);\n\n    if (userConfig == null) {\n      var pathArr = path.split('.');\n      var result = lang.aria;\n\n      for (var i = 0; i < pathArr.length; ++i) {\n        result = result[pathArr[i]];\n      }\n\n      return result;\n    } else {\n      return userConfig;\n    }\n  }\n\n  function getTitle() {\n    var title = ecModel.getModel('title').option;\n\n    if (title && title.length) {\n      title = title[0];\n    }\n\n    return title && title.text;\n  }\n\n  function getSeriesTypeName(type) {\n    return lang.series.typeNames[type] || '';\n  }\n};\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar PI$1 = Math.PI;\n/**\n * @param {module:echarts/ExtensionAPI} api\n * @param {Object} [opts]\n * @param {string} [opts.text]\n * @param {string} [opts.color]\n * @param {string} [opts.textColor]\n * @return {module:zrender/Element}\n */\n\nvar loadingDefault = function (api, opts) {\n  opts = opts || {};\n  defaults(opts, {\n    text: 'loading',\n    color: '#c23531',\n    textColor: '#000',\n    maskColor: 'rgba(255, 255, 255, 0.8)',\n    zlevel: 0\n  });\n  var mask = new Rect({\n    style: {\n      fill: opts.maskColor\n    },\n    zlevel: opts.zlevel,\n    z: 10000\n  });\n  var arc = new Arc({\n    shape: {\n      startAngle: -PI$1 / 2,\n      endAngle: -PI$1 / 2 + 0.1,\n      r: 10\n    },\n    style: {\n      stroke: opts.color,\n      lineCap: 'round',\n      lineWidth: 5\n    },\n    zlevel: opts.zlevel,\n    z: 10001\n  });\n  var labelRect = new Rect({\n    style: {\n      fill: 'none',\n      text: opts.text,\n      textPosition: 'right',\n      textDistance: 10,\n      textFill: opts.textColor\n    },\n    zlevel: opts.zlevel,\n    z: 10001\n  });\n  arc.animateShape(true).when(1000, {\n    endAngle: PI$1 * 3 / 2\n  }).start('circularInOut');\n  arc.animateShape(true).when(1000, {\n    startAngle: PI$1 * 3 / 2\n  }).delay(300).start('circularInOut');\n  var group = new Group();\n  group.add(arc);\n  group.add(labelRect);\n  group.add(mask); // Inject resize\n\n  group.resize = function () {\n    var cx = api.getWidth() / 2;\n    var cy = api.getHeight() / 2;\n    arc.setShape({\n      cx: cx,\n      cy: cy\n    });\n    var r = arc.shape.r;\n    labelRect.setShape({\n      x: cx - r,\n      y: cy - r,\n      width: r * 2,\n      height: r * 2\n    });\n    mask.setShape({\n      x: 0,\n      y: 0,\n      width: api.getWidth(),\n      height: api.getHeight()\n    });\n  };\n\n  group.resize();\n  return group;\n};\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * @module echarts/stream/Scheduler\n */\n/**\n * @constructor\n */\n\nfunction Scheduler(ecInstance, api, dataProcessorHandlers, visualHandlers) {\n  this.ecInstance = ecInstance;\n  this.api = api;\n  this.unfinished; // Fix current processors in case that in some rear cases that\n  // processors might be registered after echarts instance created.\n  // Register processors incrementally for a echarts instance is\n  // not supported by this stream architecture.\n\n  var dataProcessorHandlers = this._dataProcessorHandlers = dataProcessorHandlers.slice();\n  var visualHandlers = this._visualHandlers = visualHandlers.slice();\n  this._allHandlers = dataProcessorHandlers.concat(visualHandlers);\n  /**\n   * @private\n   * @type {\n   *     [handlerUID: string]: {\n   *         seriesTaskMap?: {\n   *             [seriesUID: string]: Task\n   *         },\n   *         overallTask?: Task\n   *     }\n   * }\n   */\n\n  this._stageTaskMap = createHashMap();\n}\n\nvar proto = Scheduler.prototype;\n/**\n * @param {module:echarts/model/Global} ecModel\n * @param {Object} payload\n */\n\nproto.restoreData = function (ecModel, payload) {\n  // TODO: Only restroe needed series and components, but not all components.\n  // Currently `restoreData` of all of the series and component will be called.\n  // But some independent components like `title`, `legend`, `graphic`, `toolbox`,\n  // `tooltip`, `axisPointer`, etc, do not need series refresh when `setOption`,\n  // and some components like coordinate system, axes, dataZoom, visualMap only\n  // need their target series refresh.\n  // (1) If we are implementing this feature some day, we should consider these cases:\n  // if a data processor depends on a component (e.g., dataZoomProcessor depends\n  // on the settings of `dataZoom`), it should be re-performed if the component\n  // is modified by `setOption`.\n  // (2) If a processor depends on sevral series, speicified by its `getTargetSeries`,\n  // it should be re-performed when the result array of `getTargetSeries` changed.\n  // We use `dependencies` to cover these issues.\n  // (3) How to update target series when coordinate system related components modified.\n  // TODO: simply the dirty mechanism? Check whether only the case here can set tasks dirty,\n  // and this case all of the tasks will be set as dirty.\n  ecModel.restoreData(payload); // Theoretically an overall task not only depends on each of its target series, but also\n  // depends on all of the series.\n  // The overall task is not in pipeline, and `ecModel.restoreData` only set pipeline tasks\n  // dirty. If `getTargetSeries` of an overall task returns nothing, we should also ensure\n  // that the overall task is set as dirty and to be performed, otherwise it probably cause\n  // state chaos. So we have to set dirty of all of the overall tasks manually, otherwise it\n  // probably cause state chaos (consider `dataZoomProcessor`).\n\n  this._stageTaskMap.each(function (taskRecord) {\n    var overallTask = taskRecord.overallTask;\n    overallTask && overallTask.dirty();\n  });\n}; // If seriesModel provided, incremental threshold is check by series data.\n\n\nproto.getPerformArgs = function (task, isBlock) {\n  // For overall task\n  if (!task.__pipeline) {\n    return;\n  }\n\n  var pipeline = this._pipelineMap.get(task.__pipeline.id);\n\n  var pCtx = pipeline.context;\n  var incremental = !isBlock && pipeline.progressiveEnabled && (!pCtx || pCtx.progressiveRender) && task.__idxInPipeline > pipeline.blockIndex;\n  var step = incremental ? pipeline.step : null;\n  var modDataCount = pCtx && pCtx.modDataCount;\n  var modBy = modDataCount != null ? Math.ceil(modDataCount / step) : null;\n  return {\n    step: step,\n    modBy: modBy,\n    modDataCount: modDataCount\n  };\n};\n\nproto.getPipeline = function (pipelineId) {\n  return this._pipelineMap.get(pipelineId);\n};\n/**\n * Current, progressive rendering starts from visual and layout.\n * Always detect render mode in the same stage, avoiding that incorrect\n * detection caused by data filtering.\n * Caution:\n * `updateStreamModes` use `seriesModel.getData()`.\n */\n\n\nproto.updateStreamModes = function (seriesModel, view) {\n  var pipeline = this._pipelineMap.get(seriesModel.uid);\n\n  var data = seriesModel.getData();\n  var dataLen = data.count(); // `progressiveRender` means that can render progressively in each\n  // animation frame. Note that some types of series do not provide\n  // `view.incrementalPrepareRender` but support `chart.appendData`. We\n  // use the term `incremental` but not `progressive` to describe the\n  // case that `chart.appendData`.\n\n  var progressiveRender = pipeline.progressiveEnabled && view.incrementalPrepareRender && dataLen >= pipeline.threshold;\n  var large = seriesModel.get('large') && dataLen >= seriesModel.get('largeThreshold'); // TODO: modDataCount should not updated if `appendData`, otherwise cause whole repaint.\n  // see `test/candlestick-large3.html`\n\n  var modDataCount = seriesModel.get('progressiveChunkMode') === 'mod' ? dataLen : null;\n  seriesModel.pipelineContext = pipeline.context = {\n    progressiveRender: progressiveRender,\n    modDataCount: modDataCount,\n    large: large\n  };\n};\n\nproto.restorePipelines = function (ecModel) {\n  var scheduler = this;\n  var pipelineMap = scheduler._pipelineMap = createHashMap();\n  ecModel.eachSeries(function (seriesModel) {\n    var progressive = seriesModel.getProgressive();\n    var pipelineId = seriesModel.uid;\n    pipelineMap.set(pipelineId, {\n      id: pipelineId,\n      head: null,\n      tail: null,\n      threshold: seriesModel.getProgressiveThreshold(),\n      progressiveEnabled: progressive && !(seriesModel.preventIncremental && seriesModel.preventIncremental()),\n      blockIndex: -1,\n      step: Math.round(progressive || 700),\n      count: 0\n    });\n    pipe(scheduler, seriesModel, seriesModel.dataTask);\n  });\n};\n\nproto.prepareStageTasks = function () {\n  var stageTaskMap = this._stageTaskMap;\n  var ecModel = this.ecInstance.getModel();\n  var api = this.api;\n  each$1(this._allHandlers, function (handler) {\n    var record = stageTaskMap.get(handler.uid) || stageTaskMap.set(handler.uid, []);\n    handler.reset && createSeriesStageTask(this, handler, record, ecModel, api);\n    handler.overallReset && createOverallStageTask(this, handler, record, ecModel, api);\n  }, this);\n};\n\nproto.prepareView = function (view, model, ecModel, api) {\n  var renderTask = view.renderTask;\n  var context = renderTask.context;\n  context.model = model;\n  context.ecModel = ecModel;\n  context.api = api;\n  renderTask.__block = !view.incrementalPrepareRender;\n  pipe(this, model, renderTask);\n};\n\nproto.performDataProcessorTasks = function (ecModel, payload) {\n  // If we do not use `block` here, it should be considered when to update modes.\n  performStageTasks(this, this._dataProcessorHandlers, ecModel, payload, {\n    block: true\n  });\n}; // opt\n// opt.visualType: 'visual' or 'layout'\n// opt.setDirty\n\n\nproto.performVisualTasks = function (ecModel, payload, opt) {\n  performStageTasks(this, this._visualHandlers, ecModel, payload, opt);\n};\n\nfunction performStageTasks(scheduler, stageHandlers, ecModel, payload, opt) {\n  opt = opt || {};\n  var unfinished;\n  each$1(stageHandlers, function (stageHandler, idx) {\n    if (opt.visualType && opt.visualType !== stageHandler.visualType) {\n      return;\n    }\n\n    var stageHandlerRecord = scheduler._stageTaskMap.get(stageHandler.uid);\n\n    var seriesTaskMap = stageHandlerRecord.seriesTaskMap;\n    var overallTask = stageHandlerRecord.overallTask;\n\n    if (overallTask) {\n      var overallNeedDirty;\n      var agentStubMap = overallTask.agentStubMap;\n      agentStubMap.each(function (stub) {\n        if (needSetDirty(opt, stub)) {\n          stub.dirty();\n          overallNeedDirty = true;\n        }\n      });\n      overallNeedDirty && overallTask.dirty();\n      updatePayload(overallTask, payload);\n      var performArgs = scheduler.getPerformArgs(overallTask, opt.block); // Execute stubs firstly, which may set the overall task dirty,\n      // then execute the overall task. And stub will call seriesModel.setData,\n      // which ensures that in the overallTask seriesModel.getData() will not\n      // return incorrect data.\n\n      agentStubMap.each(function (stub) {\n        stub.perform(performArgs);\n      });\n      unfinished |= overallTask.perform(performArgs);\n    } else if (seriesTaskMap) {\n      seriesTaskMap.each(function (task, pipelineId) {\n        if (needSetDirty(opt, task)) {\n          task.dirty();\n        }\n\n        var performArgs = scheduler.getPerformArgs(task, opt.block);\n        performArgs.skip = !stageHandler.performRawSeries && ecModel.isSeriesFiltered(task.context.model);\n        updatePayload(task, payload);\n        unfinished |= task.perform(performArgs);\n      });\n    }\n  });\n\n  function needSetDirty(opt, task) {\n    return opt.setDirty && (!opt.dirtyMap || opt.dirtyMap.get(task.__pipeline.id));\n  }\n\n  scheduler.unfinished |= unfinished;\n}\n\nproto.performSeriesTasks = function (ecModel) {\n  var unfinished;\n  ecModel.eachSeries(function (seriesModel) {\n    // Progress to the end for dataInit and dataRestore.\n    unfinished |= seriesModel.dataTask.perform();\n  });\n  this.unfinished |= unfinished;\n};\n\nproto.plan = function () {\n  // Travel pipelines, check block.\n  this._pipelineMap.each(function (pipeline) {\n    var task = pipeline.tail;\n\n    do {\n      if (task.__block) {\n        pipeline.blockIndex = task.__idxInPipeline;\n        break;\n      }\n\n      task = task.getUpstream();\n    } while (task);\n  });\n};\n\nvar updatePayload = proto.updatePayload = function (task, payload) {\n  payload !== 'remain' && (task.context.payload = payload);\n};\n\nfunction createSeriesStageTask(scheduler, stageHandler, stageHandlerRecord, ecModel, api) {\n  var seriesTaskMap = stageHandlerRecord.seriesTaskMap || (stageHandlerRecord.seriesTaskMap = createHashMap());\n  var seriesType = stageHandler.seriesType;\n  var getTargetSeries = stageHandler.getTargetSeries; // If a stageHandler should cover all series, `createOnAllSeries` should be declared mandatorily,\n  // to avoid some typo or abuse. Otherwise if an extension do not specify a `seriesType`,\n  // it works but it may cause other irrelevant charts blocked.\n\n  if (stageHandler.createOnAllSeries) {\n    ecModel.eachRawSeries(create);\n  } else if (seriesType) {\n    ecModel.eachRawSeriesByType(seriesType, create);\n  } else if (getTargetSeries) {\n    getTargetSeries(ecModel, api).each(create);\n  }\n\n  function create(seriesModel) {\n    var pipelineId = seriesModel.uid; // Init tasks for each seriesModel only once.\n    // Reuse original task instance.\n\n    var task = seriesTaskMap.get(pipelineId) || seriesTaskMap.set(pipelineId, createTask({\n      plan: seriesTaskPlan,\n      reset: seriesTaskReset,\n      count: seriesTaskCount\n    }));\n    task.context = {\n      model: seriesModel,\n      ecModel: ecModel,\n      api: api,\n      useClearVisual: stageHandler.isVisual && !stageHandler.isLayout,\n      plan: stageHandler.plan,\n      reset: stageHandler.reset,\n      scheduler: scheduler\n    };\n    pipe(scheduler, seriesModel, task);\n  } // Clear unused series tasks.\n\n\n  var pipelineMap = scheduler._pipelineMap;\n  seriesTaskMap.each(function (task, pipelineId) {\n    if (!pipelineMap.get(pipelineId)) {\n      task.dispose();\n      seriesTaskMap.removeKey(pipelineId);\n    }\n  });\n}\n\nfunction createOverallStageTask(scheduler, stageHandler, stageHandlerRecord, ecModel, api) {\n  var overallTask = stageHandlerRecord.overallTask = stageHandlerRecord.overallTask // For overall task, the function only be called on reset stage.\n  || createTask({\n    reset: overallTaskReset\n  });\n  overallTask.context = {\n    ecModel: ecModel,\n    api: api,\n    overallReset: stageHandler.overallReset,\n    scheduler: scheduler\n  }; // Reuse orignal stubs.\n\n  var agentStubMap = overallTask.agentStubMap = overallTask.agentStubMap || createHashMap();\n  var seriesType = stageHandler.seriesType;\n  var getTargetSeries = stageHandler.getTargetSeries;\n  var overallProgress = true;\n  var modifyOutputEnd = stageHandler.modifyOutputEnd; // An overall task with seriesType detected or has `getTargetSeries`, we add\n  // stub in each pipelines, it will set the overall task dirty when the pipeline\n  // progress. Moreover, to avoid call the overall task each frame (too frequent),\n  // we set the pipeline block.\n\n  if (seriesType) {\n    ecModel.eachRawSeriesByType(seriesType, createStub);\n  } else if (getTargetSeries) {\n    getTargetSeries(ecModel, api).each(createStub);\n  } // Otherwise, (usually it is legancy case), the overall task will only be\n  // executed when upstream dirty. Otherwise the progressive rendering of all\n  // pipelines will be disabled unexpectedly. But it still needs stubs to receive\n  // dirty info from upsteam.\n  else {\n      overallProgress = false;\n      each$1(ecModel.getSeries(), createStub);\n    }\n\n  function createStub(seriesModel) {\n    var pipelineId = seriesModel.uid;\n    var stub = agentStubMap.get(pipelineId);\n\n    if (!stub) {\n      stub = agentStubMap.set(pipelineId, createTask({\n        reset: stubReset,\n        onDirty: stubOnDirty\n      })); // When the result of `getTargetSeries` changed, the overallTask\n      // should be set as dirty and re-performed.\n\n      overallTask.dirty();\n    }\n\n    stub.context = {\n      model: seriesModel,\n      overallProgress: overallProgress,\n      modifyOutputEnd: modifyOutputEnd\n    };\n    stub.agent = overallTask;\n    stub.__block = overallProgress;\n    pipe(scheduler, seriesModel, stub);\n  } // Clear unused stubs.\n\n\n  var pipelineMap = scheduler._pipelineMap;\n  agentStubMap.each(function (stub, pipelineId) {\n    if (!pipelineMap.get(pipelineId)) {\n      stub.dispose(); // When the result of `getTargetSeries` changed, the overallTask\n      // should be set as dirty and re-performed.\n\n      overallTask.dirty();\n      agentStubMap.removeKey(pipelineId);\n    }\n  });\n}\n\nfunction overallTaskReset(context) {\n  context.overallReset(context.ecModel, context.api, context.payload);\n}\n\nfunction stubReset(context, upstreamContext) {\n  return context.overallProgress && stubProgress;\n}\n\nfunction stubProgress() {\n  this.agent.dirty();\n  this.getDownstream().dirty();\n}\n\nfunction stubOnDirty() {\n  this.agent && this.agent.dirty();\n}\n\nfunction seriesTaskPlan(context) {\n  return context.plan && context.plan(context.model, context.ecModel, context.api, context.payload);\n}\n\nfunction seriesTaskReset(context) {\n  if (context.useClearVisual) {\n    context.data.clearAllVisual();\n  }\n\n  var resetDefines = context.resetDefines = normalizeToArray(context.reset(context.model, context.ecModel, context.api, context.payload));\n  return resetDefines.length > 1 ? map(resetDefines, function (v, idx) {\n    return makeSeriesTaskProgress(idx);\n  }) : singleSeriesTaskProgress;\n}\n\nvar singleSeriesTaskProgress = makeSeriesTaskProgress(0);\n\nfunction makeSeriesTaskProgress(resetDefineIdx) {\n  return function (params, context) {\n    var data = context.data;\n    var resetDefine = context.resetDefines[resetDefineIdx];\n\n    if (resetDefine && resetDefine.dataEach) {\n      for (var i = params.start; i < params.end; i++) {\n        resetDefine.dataEach(data, i);\n      }\n    } else if (resetDefine && resetDefine.progress) {\n      resetDefine.progress(params, data);\n    }\n  };\n}\n\nfunction seriesTaskCount(context) {\n  return context.data.count();\n}\n\nfunction pipe(scheduler, seriesModel, task) {\n  var pipelineId = seriesModel.uid;\n\n  var pipeline = scheduler._pipelineMap.get(pipelineId);\n\n  !pipeline.head && (pipeline.head = task);\n  pipeline.tail && pipeline.tail.pipe(task);\n  pipeline.tail = task;\n  task.__idxInPipeline = pipeline.count++;\n  task.__pipeline = pipeline;\n}\n\nScheduler.wrapStageHandler = function (stageHandler, visualType) {\n  if (isFunction$1(stageHandler)) {\n    stageHandler = {\n      overallReset: stageHandler,\n      seriesType: detectSeriseType(stageHandler)\n    };\n  }\n\n  stageHandler.uid = getUID('stageHandler');\n  visualType && (stageHandler.visualType = visualType);\n  return stageHandler;\n};\n/**\n * Only some legacy stage handlers (usually in echarts extensions) are pure function.\n * To ensure that they can work normally, they should work in block mode, that is,\n * they should not be started util the previous tasks finished. So they cause the\n * progressive rendering disabled. We try to detect the series type, to narrow down\n * the block range to only the series type they concern, but not all series.\n */\n\n\nfunction detectSeriseType(legacyFunc) {\n  seriesType = null;\n\n  try {\n    // Assume there is no async when calling `eachSeriesByType`.\n    legacyFunc(ecModelMock, apiMock);\n  } catch (e) {}\n\n  return seriesType;\n}\n\nvar ecModelMock = {};\nvar apiMock = {};\nvar seriesType;\nmockMethods(ecModelMock, GlobalModel);\nmockMethods(apiMock, ExtensionAPI);\n\necModelMock.eachSeriesByType = ecModelMock.eachRawSeriesByType = function (type) {\n  seriesType = type;\n};\n\necModelMock.eachComponent = function (cond) {\n  if (cond.mainType === 'series' && cond.subType) {\n    seriesType = cond.subType;\n  }\n};\n\nfunction mockMethods(target, Clz) {\n  for (var name in Clz.prototype) {\n    // Do not use hasOwnProperty\n    target[name] = noop;\n  }\n}\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar colorAll = ['#37A2DA', '#32C5E9', '#67E0E3', '#9FE6B8', '#FFDB5C', '#ff9f7f', '#fb7293', '#E062AE', '#E690D1', '#e7bcf3', '#9d96f5', '#8378EA', '#96BFFF'];\nvar lightTheme = {\n  color: colorAll,\n  colorLayer: [['#37A2DA', '#ffd85c', '#fd7b5f'], ['#37A2DA', '#67E0E3', '#FFDB5C', '#ff9f7f', '#E062AE', '#9d96f5'], ['#37A2DA', '#32C5E9', '#9FE6B8', '#FFDB5C', '#ff9f7f', '#fb7293', '#e7bcf3', '#8378EA', '#96BFFF'], colorAll]\n};\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar contrastColor = '#eee';\n\nvar axisCommon = function () {\n  return {\n    axisLine: {\n      lineStyle: {\n        color: contrastColor\n      }\n    },\n    axisTick: {\n      lineStyle: {\n        color: contrastColor\n      }\n    },\n    axisLabel: {\n      textStyle: {\n        color: contrastColor\n      }\n    },\n    splitLine: {\n      lineStyle: {\n        type: 'dashed',\n        color: '#aaa'\n      }\n    },\n    splitArea: {\n      areaStyle: {\n        color: contrastColor\n      }\n    }\n  };\n};\n\nvar colorPalette = ['#dd6b66', '#759aa0', '#e69d87', '#8dc1a9', '#ea7e53', '#eedd78', '#73a373', '#73b9bc', '#7289ab', '#91ca8c', '#f49f42'];\nvar theme = {\n  color: colorPalette,\n  backgroundColor: '#333',\n  tooltip: {\n    axisPointer: {\n      lineStyle: {\n        color: contrastColor\n      },\n      crossStyle: {\n        color: contrastColor\n      }\n    }\n  },\n  legend: {\n    textStyle: {\n      color: contrastColor\n    }\n  },\n  textStyle: {\n    color: contrastColor\n  },\n  title: {\n    textStyle: {\n      color: contrastColor\n    }\n  },\n  toolbox: {\n    iconStyle: {\n      normal: {\n        borderColor: contrastColor\n      }\n    }\n  },\n  dataZoom: {\n    textStyle: {\n      color: contrastColor\n    }\n  },\n  visualMap: {\n    textStyle: {\n      color: contrastColor\n    }\n  },\n  timeline: {\n    lineStyle: {\n      color: contrastColor\n    },\n    itemStyle: {\n      normal: {\n        color: colorPalette[1]\n      }\n    },\n    label: {\n      normal: {\n        textStyle: {\n          color: contrastColor\n        }\n      }\n    },\n    controlStyle: {\n      normal: {\n        color: contrastColor,\n        borderColor: contrastColor\n      }\n    }\n  },\n  timeAxis: axisCommon(),\n  logAxis: axisCommon(),\n  valueAxis: axisCommon(),\n  categoryAxis: axisCommon(),\n  line: {\n    symbol: 'circle'\n  },\n  graph: {\n    color: colorPalette\n  },\n  gauge: {\n    title: {\n      textStyle: {\n        color: contrastColor\n      }\n    }\n  },\n  candlestick: {\n    itemStyle: {\n      normal: {\n        color: '#FD1050',\n        color0: '#0CF49B',\n        borderColor: '#FD1050',\n        borderColor0: '#0CF49B'\n      }\n    }\n  }\n};\ntheme.categoryAxis.splitLine.show = false;\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * This module is imported by echarts directly.\n *\n * Notice:\n * Always keep this file exists for backward compatibility.\n * Because before 4.1.0, dataset is an optional component,\n * some users may import this module manually.\n */\nComponentModel.extend({\n  type: 'dataset',\n\n  /**\n   * @protected\n   */\n  defaultOption: {\n    // 'row', 'column'\n    seriesLayoutBy: SERIES_LAYOUT_BY_COLUMN,\n    // null/'auto': auto detect header, see \"module:echarts/data/helper/sourceHelper\"\n    sourceHeader: null,\n    dimensions: null,\n    source: null\n  },\n  optionUpdated: function () {\n    detectSourceFormat(this);\n  }\n});\nComponent$1.extend({\n  type: 'dataset'\n});\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar assert = assert$1;\nvar each = each$1;\nvar isFunction = isFunction$1;\nvar isObject = isObject$1;\nvar parseClassType = ComponentModel.parseClassType;\nvar version = '4.1.0';\nvar dependencies = {\n  zrender: '4.0.4'\n};\nvar TEST_FRAME_REMAIN_TIME = 1;\nvar PRIORITY_PROCESSOR_FILTER = 1000;\nvar PRIORITY_PROCESSOR_STATISTIC = 5000;\nvar PRIORITY_VISUAL_LAYOUT = 1000;\nvar PRIORITY_VISUAL_GLOBAL = 2000;\nvar PRIORITY_VISUAL_CHART = 3000;\nvar PRIORITY_VISUAL_COMPONENT = 4000; // FIXME\n// necessary?\n\nvar PRIORITY_VISUAL_BRUSH = 5000;\nvar PRIORITY = {\n  PROCESSOR: {\n    FILTER: PRIORITY_PROCESSOR_FILTER,\n    STATISTIC: PRIORITY_PROCESSOR_STATISTIC\n  },\n  VISUAL: {\n    LAYOUT: PRIORITY_VISUAL_LAYOUT,\n    GLOBAL: PRIORITY_VISUAL_GLOBAL,\n    CHART: PRIORITY_VISUAL_CHART,\n    COMPONENT: PRIORITY_VISUAL_COMPONENT,\n    BRUSH: PRIORITY_VISUAL_BRUSH\n  }\n}; // Main process have three entries: `setOption`, `dispatchAction` and `resize`,\n// where they must not be invoked nestedly, except the only case: invoke\n// dispatchAction with updateMethod \"none\" in main process.\n// This flag is used to carry out this rule.\n// All events will be triggered out side main process (i.e. when !this[IN_MAIN_PROCESS]).\n\nvar IN_MAIN_PROCESS = '__flagInMainProcess';\nvar OPTION_UPDATED = '__optionUpdated';\nvar ACTION_REG = /^[a-zA-Z0-9_]+$/;\n\nfunction createRegisterEventWithLowercaseName(method) {\n  return function (eventName, handler, context) {\n    // Event name is all lowercase\n    eventName = eventName && eventName.toLowerCase();\n    Eventful.prototype[method].call(this, eventName, handler, context);\n  };\n}\n/**\n * @module echarts~MessageCenter\n */\n\n\nfunction MessageCenter() {\n  Eventful.call(this);\n}\n\nMessageCenter.prototype.on = createRegisterEventWithLowercaseName('on');\nMessageCenter.prototype.off = createRegisterEventWithLowercaseName('off');\nMessageCenter.prototype.one = createRegisterEventWithLowercaseName('one');\nmixin(MessageCenter, Eventful);\n/**\n * @module echarts~ECharts\n */\n\nfunction ECharts(dom, theme$$1, opts) {\n  opts = opts || {}; // Get theme by name\n\n  if (typeof theme$$1 === 'string') {\n    theme$$1 = themeStorage[theme$$1];\n  }\n  /**\n   * @type {string}\n   */\n\n\n  this.id;\n  /**\n   * Group id\n   * @type {string}\n   */\n\n  this.group;\n  /**\n   * @type {HTMLElement}\n   * @private\n   */\n\n  this._dom = dom;\n  var defaultRenderer = 'canvas';\n\n  /**\n   * @type {module:zrender/ZRender}\n   * @private\n   */\n  var zr = this._zr = init$1(dom, {\n    renderer: opts.renderer || defaultRenderer,\n    devicePixelRatio: opts.devicePixelRatio,\n    width: opts.width,\n    height: opts.height\n  });\n  /**\n   * Expect 60 pfs.\n   * @type {Function}\n   * @private\n   */\n\n  this._throttledZrFlush = throttle(bind(zr.flush, zr), 17);\n  var theme$$1 = clone(theme$$1);\n  theme$$1 && backwardCompat(theme$$1, true);\n  /**\n   * @type {Object}\n   * @private\n   */\n\n  this._theme = theme$$1;\n  /**\n   * @type {Array.<module:echarts/view/Chart>}\n   * @private\n   */\n\n  this._chartsViews = [];\n  /**\n   * @type {Object.<string, module:echarts/view/Chart>}\n   * @private\n   */\n\n  this._chartsMap = {};\n  /**\n   * @type {Array.<module:echarts/view/Component>}\n   * @private\n   */\n\n  this._componentsViews = [];\n  /**\n   * @type {Object.<string, module:echarts/view/Component>}\n   * @private\n   */\n\n  this._componentsMap = {};\n  /**\n   * @type {module:echarts/CoordinateSystem}\n   * @private\n   */\n\n  this._coordSysMgr = new CoordinateSystemManager();\n  /**\n   * @type {module:echarts/ExtensionAPI}\n   * @private\n   */\n\n  var api = this._api = createExtensionAPI(this); // Sort on demand\n\n  function prioritySortFunc(a, b) {\n    return a.__prio - b.__prio;\n  }\n\n  sort(visualFuncs, prioritySortFunc);\n  sort(dataProcessorFuncs, prioritySortFunc);\n  /**\n   * @type {module:echarts/stream/Scheduler}\n   */\n\n  this._scheduler = new Scheduler(this, api, dataProcessorFuncs, visualFuncs);\n  Eventful.call(this);\n  /**\n   * @type {module:echarts~MessageCenter}\n   * @private\n   */\n\n  this._messageCenter = new MessageCenter(); // Init mouse events\n\n  this._initEvents(); // In case some people write `window.onresize = chart.resize`\n\n\n  this.resize = bind(this.resize, this); // Can't dispatch action during rendering procedure\n\n  this._pendingActions = [];\n  zr.animation.on('frame', this._onframe, this);\n  bindRenderedEvent(zr, this); // ECharts instance can be used as value.\n\n  setAsPrimitive(this);\n}\n\nvar echartsProto = ECharts.prototype;\n\nechartsProto._onframe = function () {\n  if (this._disposed) {\n    return;\n  }\n\n  var scheduler = this._scheduler; // Lazy update\n\n  if (this[OPTION_UPDATED]) {\n    var silent = this[OPTION_UPDATED].silent;\n    this[IN_MAIN_PROCESS] = true;\n    prepare(this);\n    updateMethods.update.call(this);\n    this[IN_MAIN_PROCESS] = false;\n    this[OPTION_UPDATED] = false;\n    flushPendingActions.call(this, silent);\n    triggerUpdatedEvent.call(this, silent);\n  } // Avoid do both lazy update and progress in one frame.\n  else if (scheduler.unfinished) {\n      // Stream progress.\n      var remainTime = TEST_FRAME_REMAIN_TIME;\n      var ecModel = this._model;\n      var api = this._api;\n      scheduler.unfinished = false;\n\n      do {\n        var startTime = +new Date();\n        scheduler.performSeriesTasks(ecModel); // Currently dataProcessorFuncs do not check threshold.\n\n        scheduler.performDataProcessorTasks(ecModel);\n        updateStreamModes(this, ecModel); // Do not update coordinate system here. Because that coord system update in\n        // each frame is not a good user experience. So we follow the rule that\n        // the extent of the coordinate system is determin in the first frame (the\n        // frame is executed immedietely after task reset.\n        // this._coordSysMgr.update(ecModel, api);\n        // console.log('--- ec frame visual ---', remainTime);\n\n        scheduler.performVisualTasks(ecModel);\n        renderSeries(this, this._model, api, 'remain');\n        remainTime -= +new Date() - startTime;\n      } while (remainTime > 0 && scheduler.unfinished); // Call flush explicitly for trigger finished event.\n\n\n      if (!scheduler.unfinished) {\n        this._zr.flush();\n      } // Else, zr flushing be ensue within the same frame,\n      // because zr flushing is after onframe event.\n\n    }\n};\n/**\n * @return {HTMLElement}\n */\n\n\nechartsProto.getDom = function () {\n  return this._dom;\n};\n/**\n * @return {module:zrender~ZRender}\n */\n\n\nechartsProto.getZr = function () {\n  return this._zr;\n};\n/**\n * Usage:\n * chart.setOption(option, notMerge, lazyUpdate);\n * chart.setOption(option, {\n *     notMerge: ...,\n *     lazyUpdate: ...,\n *     silent: ...\n * });\n *\n * @param {Object} option\n * @param {Object|boolean} [opts] opts or notMerge.\n * @param {boolean} [opts.notMerge=false]\n * @param {boolean} [opts.lazyUpdate=false] Useful when setOption frequently.\n */\n\n\nechartsProto.setOption = function (option, notMerge, lazyUpdate) {\n  var silent;\n\n  if (isObject(notMerge)) {\n    lazyUpdate = notMerge.lazyUpdate;\n    silent = notMerge.silent;\n    notMerge = notMerge.notMerge;\n  }\n\n  this[IN_MAIN_PROCESS] = true;\n\n  if (!this._model || notMerge) {\n    var optionManager = new OptionManager(this._api);\n    var theme$$1 = this._theme;\n    var ecModel = this._model = new GlobalModel(null, null, theme$$1, optionManager);\n    ecModel.scheduler = this._scheduler;\n    ecModel.init(null, null, theme$$1, optionManager);\n  }\n\n  this._model.setOption(option, optionPreprocessorFuncs);\n\n  if (lazyUpdate) {\n    this[OPTION_UPDATED] = {\n      silent: silent\n    };\n    this[IN_MAIN_PROCESS] = false;\n  } else {\n    prepare(this);\n    updateMethods.update.call(this); // Ensure zr refresh sychronously, and then pixel in canvas can be\n    // fetched after `setOption`.\n\n    this._zr.flush();\n\n    this[OPTION_UPDATED] = false;\n    this[IN_MAIN_PROCESS] = false;\n    flushPendingActions.call(this, silent);\n    triggerUpdatedEvent.call(this, silent);\n  }\n};\n/**\n * @DEPRECATED\n */\n\n\nechartsProto.setTheme = function () {\n  console.log('ECharts#setTheme() is DEPRECATED in ECharts 3.0');\n};\n/**\n * @return {module:echarts/model/Global}\n */\n\n\nechartsProto.getModel = function () {\n  return this._model;\n};\n/**\n * @return {Object}\n */\n\n\nechartsProto.getOption = function () {\n  return this._model && this._model.getOption();\n};\n/**\n * @return {number}\n */\n\n\nechartsProto.getWidth = function () {\n  return this._zr.getWidth();\n};\n/**\n * @return {number}\n */\n\n\nechartsProto.getHeight = function () {\n  return this._zr.getHeight();\n};\n/**\n * @return {number}\n */\n\n\nechartsProto.getDevicePixelRatio = function () {\n  return this._zr.painter.dpr || window.devicePixelRatio || 1;\n};\n/**\n * Get canvas which has all thing rendered\n * @param {Object} opts\n * @param {string} [opts.backgroundColor]\n * @return {string}\n */\n\n\nechartsProto.getRenderedCanvas = function (opts) {\n  if (!env$1.canvasSupported) {\n    return;\n  }\n\n  opts = opts || {};\n  opts.pixelRatio = opts.pixelRatio || 1;\n  opts.backgroundColor = opts.backgroundColor || this._model.get('backgroundColor');\n  var zr = this._zr; // var list = zr.storage.getDisplayList();\n  // Stop animations\n  // Never works before in init animation, so remove it.\n  // zrUtil.each(list, function (el) {\n  //     el.stopAnimation(true);\n  // });\n\n  return zr.painter.getRenderedCanvas(opts);\n};\n/**\n * Get svg data url\n * @return {string}\n */\n\n\nechartsProto.getSvgDataUrl = function () {\n  if (!env$1.svgSupported) {\n    return;\n  }\n\n  var zr = this._zr;\n  var list = zr.storage.getDisplayList(); // Stop animations\n\n  each$1(list, function (el) {\n    el.stopAnimation(true);\n  });\n  return zr.painter.pathToDataUrl();\n};\n/**\n * @return {string}\n * @param {Object} opts\n * @param {string} [opts.type='png']\n * @param {string} [opts.pixelRatio=1]\n * @param {string} [opts.backgroundColor]\n * @param {string} [opts.excludeComponents]\n */\n\n\nechartsProto.getDataURL = function (opts) {\n  opts = opts || {};\n  var excludeComponents = opts.excludeComponents;\n  var ecModel = this._model;\n  var excludesComponentViews = [];\n  var self = this;\n  each(excludeComponents, function (componentType) {\n    ecModel.eachComponent({\n      mainType: componentType\n    }, function (component) {\n      var view = self._componentsMap[component.__viewId];\n\n      if (!view.group.ignore) {\n        excludesComponentViews.push(view);\n        view.group.ignore = true;\n      }\n    });\n  });\n  var url = this._zr.painter.getType() === 'svg' ? this.getSvgDataUrl() : this.getRenderedCanvas(opts).toDataURL('image/' + (opts && opts.type || 'png'));\n  each(excludesComponentViews, function (view) {\n    view.group.ignore = false;\n  });\n  return url;\n};\n/**\n * @return {string}\n * @param {Object} opts\n * @param {string} [opts.type='png']\n * @param {string} [opts.pixelRatio=1]\n * @param {string} [opts.backgroundColor]\n */\n\n\nechartsProto.getConnectedDataURL = function (opts) {\n  if (!env$1.canvasSupported) {\n    return;\n  }\n\n  var groupId = this.group;\n  var mathMin = Math.min;\n  var mathMax = Math.max;\n  var MAX_NUMBER = Infinity;\n\n  if (connectedGroups[groupId]) {\n    var left = MAX_NUMBER;\n    var top = MAX_NUMBER;\n    var right = -MAX_NUMBER;\n    var bottom = -MAX_NUMBER;\n    var canvasList = [];\n    var dpr = opts && opts.pixelRatio || 1;\n    each$1(instances, function (chart, id) {\n      if (chart.group === groupId) {\n        var canvas = chart.getRenderedCanvas(clone(opts));\n        var boundingRect = chart.getDom().getBoundingClientRect();\n        left = mathMin(boundingRect.left, left);\n        top = mathMin(boundingRect.top, top);\n        right = mathMax(boundingRect.right, right);\n        bottom = mathMax(boundingRect.bottom, bottom);\n        canvasList.push({\n          dom: canvas,\n          left: boundingRect.left,\n          top: boundingRect.top\n        });\n      }\n    });\n    left *= dpr;\n    top *= dpr;\n    right *= dpr;\n    bottom *= dpr;\n    var width = right - left;\n    var height = bottom - top;\n    var targetCanvas = createCanvas();\n    targetCanvas.width = width;\n    targetCanvas.height = height;\n    var zr = init$1(targetCanvas);\n    each(canvasList, function (item) {\n      var img = new ZImage({\n        style: {\n          x: item.left * dpr - left,\n          y: item.top * dpr - top,\n          image: item.dom\n        }\n      });\n      zr.add(img);\n    });\n    zr.refreshImmediately();\n    return targetCanvas.toDataURL('image/' + (opts && opts.type || 'png'));\n  } else {\n    return this.getDataURL(opts);\n  }\n};\n/**\n * Convert from logical coordinate system to pixel coordinate system.\n * See CoordinateSystem#convertToPixel.\n * @param {string|Object} finder\n *        If string, e.g., 'geo', means {geoIndex: 0}.\n *        If Object, could contain some of these properties below:\n *        {\n *            seriesIndex / seriesId / seriesName,\n *            geoIndex / geoId, geoName,\n *            bmapIndex / bmapId / bmapName,\n *            xAxisIndex / xAxisId / xAxisName,\n *            yAxisIndex / yAxisId / yAxisName,\n *            gridIndex / gridId / gridName,\n *            ... (can be extended)\n *        }\n * @param {Array|number} value\n * @return {Array|number} result\n */\n\n\nechartsProto.convertToPixel = curry(doConvertPixel, 'convertToPixel');\n/**\n * Convert from pixel coordinate system to logical coordinate system.\n * See CoordinateSystem#convertFromPixel.\n * @param {string|Object} finder\n *        If string, e.g., 'geo', means {geoIndex: 0}.\n *        If Object, could contain some of these properties below:\n *        {\n *            seriesIndex / seriesId / seriesName,\n *            geoIndex / geoId / geoName,\n *            bmapIndex / bmapId / bmapName,\n *            xAxisIndex / xAxisId / xAxisName,\n *            yAxisIndex / yAxisId / yAxisName\n *            gridIndex / gridId / gridName,\n *            ... (can be extended)\n *        }\n * @param {Array|number} value\n * @return {Array|number} result\n */\n\nechartsProto.convertFromPixel = curry(doConvertPixel, 'convertFromPixel');\n\nfunction doConvertPixel(methodName, finder, value) {\n  var ecModel = this._model;\n\n  var coordSysList = this._coordSysMgr.getCoordinateSystems();\n\n  var result;\n  finder = parseFinder(ecModel, finder);\n\n  for (var i = 0; i < coordSysList.length; i++) {\n    var coordSys = coordSysList[i];\n\n    if (coordSys[methodName] && (result = coordSys[methodName](ecModel, finder, value)) != null) {\n      return result;\n    }\n  }\n}\n/**\n * Is the specified coordinate systems or components contain the given pixel point.\n * @param {string|Object} finder\n *        If string, e.g., 'geo', means {geoIndex: 0}.\n *        If Object, could contain some of these properties below:\n *        {\n *            seriesIndex / seriesId / seriesName,\n *            geoIndex / geoId / geoName,\n *            bmapIndex / bmapId / bmapName,\n *            xAxisIndex / xAxisId / xAxisName,\n *            yAxisIndex / yAxisId / yAxisName,\n *            gridIndex / gridId / gridName,\n *            ... (can be extended)\n *        }\n * @param {Array|number} value\n * @return {boolean} result\n */\n\n\nechartsProto.containPixel = function (finder, value) {\n  var ecModel = this._model;\n  var result;\n  finder = parseFinder(ecModel, finder);\n  each$1(finder, function (models, key) {\n    key.indexOf('Models') >= 0 && each$1(models, function (model) {\n      var coordSys = model.coordinateSystem;\n\n      if (coordSys && coordSys.containPoint) {\n        result |= !!coordSys.containPoint(value);\n      } else if (key === 'seriesModels') {\n        var view = this._chartsMap[model.__viewId];\n\n        if (view && view.containPoint) {\n          result |= view.containPoint(value, model);\n        } else {}\n      } else {}\n    }, this);\n  }, this);\n  return !!result;\n};\n/**\n * Get visual from series or data.\n * @param {string|Object} finder\n *        If string, e.g., 'series', means {seriesIndex: 0}.\n *        If Object, could contain some of these properties below:\n *        {\n *            seriesIndex / seriesId / seriesName,\n *            dataIndex / dataIndexInside\n *        }\n *        If dataIndex is not specified, series visual will be fetched,\n *        but not data item visual.\n *        If all of seriesIndex, seriesId, seriesName are not specified,\n *        visual will be fetched from first series.\n * @param {string} visualType 'color', 'symbol', 'symbolSize'\n */\n\n\nechartsProto.getVisual = function (finder, visualType) {\n  var ecModel = this._model;\n  finder = parseFinder(ecModel, finder, {\n    defaultMainType: 'series'\n  });\n  var seriesModel = finder.seriesModel;\n  var data = seriesModel.getData();\n  var dataIndexInside = finder.hasOwnProperty('dataIndexInside') ? finder.dataIndexInside : finder.hasOwnProperty('dataIndex') ? data.indexOfRawIndex(finder.dataIndex) : null;\n  return dataIndexInside != null ? data.getItemVisual(dataIndexInside, visualType) : data.getVisual(visualType);\n};\n/**\n * Get view of corresponding component model\n * @param  {module:echarts/model/Component} componentModel\n * @return {module:echarts/view/Component}\n */\n\n\nechartsProto.getViewOfComponentModel = function (componentModel) {\n  return this._componentsMap[componentModel.__viewId];\n};\n/**\n * Get view of corresponding series model\n * @param  {module:echarts/model/Series} seriesModel\n * @return {module:echarts/view/Chart}\n */\n\n\nechartsProto.getViewOfSeriesModel = function (seriesModel) {\n  return this._chartsMap[seriesModel.__viewId];\n};\n\nvar updateMethods = {\n  prepareAndUpdate: function (payload) {\n    prepare(this);\n    updateMethods.update.call(this, payload);\n  },\n\n  /**\n   * @param {Object} payload\n   * @private\n   */\n  update: function (payload) {\n    // console.profile && console.profile('update');\n    var ecModel = this._model;\n    var api = this._api;\n    var zr = this._zr;\n    var coordSysMgr = this._coordSysMgr;\n    var scheduler = this._scheduler; // update before setOption\n\n    if (!ecModel) {\n      return;\n    }\n\n    scheduler.restoreData(ecModel, payload);\n    scheduler.performSeriesTasks(ecModel); // TODO\n    // Save total ecModel here for undo/redo (after restoring data and before processing data).\n    // Undo (restoration of total ecModel) can be carried out in 'action' or outside API call.\n    // Create new coordinate system each update\n    // In LineView may save the old coordinate system and use it to get the orignal point\n\n    coordSysMgr.create(ecModel, api);\n    scheduler.performDataProcessorTasks(ecModel, payload); // Current stream render is not supported in data process. So we can update\n    // stream modes after data processing, where the filtered data is used to\n    // deteming whether use progressive rendering.\n\n    updateStreamModes(this, ecModel); // We update stream modes before coordinate system updated, then the modes info\n    // can be fetched when coord sys updating (consider the barGrid extent fix). But\n    // the drawback is the full coord info can not be fetched. Fortunately this full\n    // coord is not requied in stream mode updater currently.\n\n    coordSysMgr.update(ecModel, api);\n    clearColorPalette(ecModel);\n    scheduler.performVisualTasks(ecModel, payload);\n    render(this, ecModel, api, payload); // Set background\n\n    var backgroundColor = ecModel.get('backgroundColor') || 'transparent'; // In IE8\n\n    if (!env$1.canvasSupported) {\n      var colorArr = parse(backgroundColor);\n      backgroundColor = stringify(colorArr, 'rgb');\n\n      if (colorArr[3] === 0) {\n        backgroundColor = 'transparent';\n      }\n    } else {\n      zr.setBackgroundColor(backgroundColor);\n    }\n\n    performPostUpdateFuncs(ecModel, api); // console.profile && console.profileEnd('update');\n  },\n\n  /**\n   * @param {Object} payload\n   * @private\n   */\n  updateTransform: function (payload) {\n    var ecModel = this._model;\n    var ecIns = this;\n    var api = this._api; // update before setOption\n\n    if (!ecModel) {\n      return;\n    } // ChartView.markUpdateMethod(payload, 'updateTransform');\n\n\n    var componentDirtyList = [];\n    ecModel.eachComponent(function (componentType, componentModel) {\n      var componentView = ecIns.getViewOfComponentModel(componentModel);\n\n      if (componentView && componentView.__alive) {\n        if (componentView.updateTransform) {\n          var result = componentView.updateTransform(componentModel, ecModel, api, payload);\n          result && result.update && componentDirtyList.push(componentView);\n        } else {\n          componentDirtyList.push(componentView);\n        }\n      }\n    });\n    var seriesDirtyMap = createHashMap();\n    ecModel.eachSeries(function (seriesModel) {\n      var chartView = ecIns._chartsMap[seriesModel.__viewId];\n\n      if (chartView.updateTransform) {\n        var result = chartView.updateTransform(seriesModel, ecModel, api, payload);\n        result && result.update && seriesDirtyMap.set(seriesModel.uid, 1);\n      } else {\n        seriesDirtyMap.set(seriesModel.uid, 1);\n      }\n    });\n    clearColorPalette(ecModel); // Keep pipe to the exist pipeline because it depends on the render task of the full pipeline.\n    // this._scheduler.performVisualTasks(ecModel, payload, 'layout', true);\n\n    this._scheduler.performVisualTasks(ecModel, payload, {\n      setDirty: true,\n      dirtyMap: seriesDirtyMap\n    }); // Currently, not call render of components. Geo render cost a lot.\n    // renderComponents(ecIns, ecModel, api, payload, componentDirtyList);\n\n\n    renderSeries(ecIns, ecModel, api, payload, seriesDirtyMap);\n    performPostUpdateFuncs(ecModel, this._api);\n  },\n\n  /**\n   * @param {Object} payload\n   * @private\n   */\n  updateView: function (payload) {\n    var ecModel = this._model; // update before setOption\n\n    if (!ecModel) {\n      return;\n    }\n\n    Chart.markUpdateMethod(payload, 'updateView');\n    clearColorPalette(ecModel); // Keep pipe to the exist pipeline because it depends on the render task of the full pipeline.\n\n    this._scheduler.performVisualTasks(ecModel, payload, {\n      setDirty: true\n    });\n\n    render(this, this._model, this._api, payload);\n    performPostUpdateFuncs(ecModel, this._api);\n  },\n\n  /**\n   * @param {Object} payload\n   * @private\n   */\n  updateVisual: function (payload) {\n    updateMethods.update.call(this, payload); // var ecModel = this._model;\n    // // update before setOption\n    // if (!ecModel) {\n    //     return;\n    // }\n    // ChartView.markUpdateMethod(payload, 'updateVisual');\n    // clearColorPalette(ecModel);\n    // // Keep pipe to the exist pipeline because it depends on the render task of the full pipeline.\n    // this._scheduler.performVisualTasks(ecModel, payload, {visualType: 'visual', setDirty: true});\n    // render(this, this._model, this._api, payload);\n    // performPostUpdateFuncs(ecModel, this._api);\n  },\n\n  /**\n   * @param {Object} payload\n   * @private\n   */\n  updateLayout: function (payload) {\n    updateMethods.update.call(this, payload); // var ecModel = this._model;\n    // // update before setOption\n    // if (!ecModel) {\n    //     return;\n    // }\n    // ChartView.markUpdateMethod(payload, 'updateLayout');\n    // // Keep pipe to the exist pipeline because it depends on the render task of the full pipeline.\n    // // this._scheduler.performVisualTasks(ecModel, payload, 'layout', true);\n    // this._scheduler.performVisualTasks(ecModel, payload, {setDirty: true});\n    // render(this, this._model, this._api, payload);\n    // performPostUpdateFuncs(ecModel, this._api);\n  }\n};\n\nfunction prepare(ecIns) {\n  var ecModel = ecIns._model;\n  var scheduler = ecIns._scheduler;\n  scheduler.restorePipelines(ecModel);\n  scheduler.prepareStageTasks();\n  prepareView(ecIns, 'component', ecModel, scheduler);\n  prepareView(ecIns, 'chart', ecModel, scheduler);\n  scheduler.plan();\n}\n/**\n * @private\n */\n\n\nfunction updateDirectly(ecIns, method, payload, mainType, subType) {\n  var ecModel = ecIns._model; // broadcast\n\n  if (!mainType) {\n    // FIXME\n    // Chart will not be update directly here, except set dirty.\n    // But there is no such scenario now.\n    each(ecIns._componentsViews.concat(ecIns._chartsViews), callView);\n    return;\n  }\n\n  var query = {};\n  query[mainType + 'Id'] = payload[mainType + 'Id'];\n  query[mainType + 'Index'] = payload[mainType + 'Index'];\n  query[mainType + 'Name'] = payload[mainType + 'Name'];\n  var condition = {\n    mainType: mainType,\n    query: query\n  };\n  subType && (condition.subType = subType); // subType may be '' by parseClassType;\n\n  var excludeSeriesId = payload.excludeSeriesId;\n\n  if (excludeSeriesId != null) {\n    excludeSeriesId = createHashMap(normalizeToArray(excludeSeriesId));\n  } // If dispatchAction before setOption, do nothing.\n\n\n  ecModel && ecModel.eachComponent(condition, function (model) {\n    if (!excludeSeriesId || excludeSeriesId.get(model.id) == null) {\n      callView(ecIns[mainType === 'series' ? '_chartsMap' : '_componentsMap'][model.__viewId]);\n    }\n  }, ecIns);\n\n  function callView(view) {\n    view && view.__alive && view[method] && view[method](view.__model, ecModel, ecIns._api, payload);\n  }\n}\n/**\n * Resize the chart\n * @param {Object} opts\n * @param {number} [opts.width] Can be 'auto' (the same as null/undefined)\n * @param {number} [opts.height] Can be 'auto' (the same as null/undefined)\n * @param {boolean} [opts.silent=false]\n */\n\n\nechartsProto.resize = function (opts) {\n  this._zr.resize(opts);\n\n  var ecModel = this._model; // Resize loading effect\n\n  this._loadingFX && this._loadingFX.resize();\n\n  if (!ecModel) {\n    return;\n  }\n\n  var optionChanged = ecModel.resetOption('media');\n  var silent = opts && opts.silent;\n  this[IN_MAIN_PROCESS] = true;\n  optionChanged && prepare(this);\n  updateMethods.update.call(this);\n  this[IN_MAIN_PROCESS] = false;\n  flushPendingActions.call(this, silent);\n  triggerUpdatedEvent.call(this, silent);\n};\n\nfunction updateStreamModes(ecIns, ecModel) {\n  var chartsMap = ecIns._chartsMap;\n  var scheduler = ecIns._scheduler;\n  ecModel.eachSeries(function (seriesModel) {\n    scheduler.updateStreamModes(seriesModel, chartsMap[seriesModel.__viewId]);\n  });\n}\n/**\n * Show loading effect\n * @param  {string} [name='default']\n * @param  {Object} [cfg]\n */\n\n\nechartsProto.showLoading = function (name, cfg) {\n  if (isObject(name)) {\n    cfg = name;\n    name = '';\n  }\n\n  name = name || 'default';\n  this.hideLoading();\n\n  if (!loadingEffects[name]) {\n    return;\n  }\n\n  var el = loadingEffects[name](this._api, cfg);\n  var zr = this._zr;\n  this._loadingFX = el;\n  zr.add(el);\n};\n/**\n * Hide loading effect\n */\n\n\nechartsProto.hideLoading = function () {\n  this._loadingFX && this._zr.remove(this._loadingFX);\n  this._loadingFX = null;\n};\n/**\n * @param {Object} eventObj\n * @return {Object}\n */\n\n\nechartsProto.makeActionFromEvent = function (eventObj) {\n  var payload = extend({}, eventObj);\n  payload.type = eventActionMap[eventObj.type];\n  return payload;\n};\n/**\n * @pubilc\n * @param {Object} payload\n * @param {string} [payload.type] Action type\n * @param {Object|boolean} [opt] If pass boolean, means opt.silent\n * @param {boolean} [opt.silent=false] Whether trigger events.\n * @param {boolean} [opt.flush=undefined]\n *                  true: Flush immediately, and then pixel in canvas can be fetched\n *                      immediately. Caution: it might affect performance.\n *                  false: Not not flush.\n *                  undefined: Auto decide whether perform flush.\n */\n\n\nechartsProto.dispatchAction = function (payload, opt) {\n  if (!isObject(opt)) {\n    opt = {\n      silent: !!opt\n    };\n  }\n\n  if (!actions[payload.type]) {\n    return;\n  } // Avoid dispatch action before setOption. Especially in `connect`.\n\n\n  if (!this._model) {\n    return;\n  } // May dispatchAction in rendering procedure\n\n\n  if (this[IN_MAIN_PROCESS]) {\n    this._pendingActions.push(payload);\n\n    return;\n  }\n\n  doDispatchAction.call(this, payload, opt.silent);\n\n  if (opt.flush) {\n    this._zr.flush(true);\n  } else if (opt.flush !== false && env$1.browser.weChat) {\n    // In WeChat embeded browser, `requestAnimationFrame` and `setInterval`\n    // hang when sliding page (on touch event), which cause that zr does not\n    // refresh util user interaction finished, which is not expected.\n    // But `dispatchAction` may be called too frequently when pan on touch\n    // screen, which impacts performance if do not throttle them.\n    this._throttledZrFlush();\n  }\n\n  flushPendingActions.call(this, opt.silent);\n  triggerUpdatedEvent.call(this, opt.silent);\n};\n\nfunction doDispatchAction(payload, silent) {\n  var payloadType = payload.type;\n  var escapeConnect = payload.escapeConnect;\n  var actionWrap = actions[payloadType];\n  var actionInfo = actionWrap.actionInfo;\n  var cptType = (actionInfo.update || 'update').split(':');\n  var updateMethod = cptType.pop();\n  cptType = cptType[0] != null && parseClassType(cptType[0]);\n  this[IN_MAIN_PROCESS] = true;\n  var payloads = [payload];\n  var batched = false; // Batch action\n\n  if (payload.batch) {\n    batched = true;\n    payloads = map(payload.batch, function (item) {\n      item = defaults(extend({}, item), payload);\n      item.batch = null;\n      return item;\n    });\n  }\n\n  var eventObjBatch = [];\n  var eventObj;\n  var isHighDown = payloadType === 'highlight' || payloadType === 'downplay';\n  each(payloads, function (batchItem) {\n    // Action can specify the event by return it.\n    eventObj = actionWrap.action(batchItem, this._model, this._api); // Emit event outside\n\n    eventObj = eventObj || extend({}, batchItem); // Convert type to eventType\n\n    eventObj.type = actionInfo.event || eventObj.type;\n    eventObjBatch.push(eventObj); // light update does not perform data process, layout and visual.\n\n    if (isHighDown) {\n      // method, payload, mainType, subType\n      updateDirectly(this, updateMethod, batchItem, 'series');\n    } else if (cptType) {\n      updateDirectly(this, updateMethod, batchItem, cptType.main, cptType.sub);\n    }\n  }, this);\n\n  if (updateMethod !== 'none' && !isHighDown && !cptType) {\n    // Still dirty\n    if (this[OPTION_UPDATED]) {\n      // FIXME Pass payload ?\n      prepare(this);\n      updateMethods.update.call(this, payload);\n      this[OPTION_UPDATED] = false;\n    } else {\n      updateMethods[updateMethod].call(this, payload);\n    }\n  } // Follow the rule of action batch\n\n\n  if (batched) {\n    eventObj = {\n      type: actionInfo.event || payloadType,\n      escapeConnect: escapeConnect,\n      batch: eventObjBatch\n    };\n  } else {\n    eventObj = eventObjBatch[0];\n  }\n\n  this[IN_MAIN_PROCESS] = false;\n  !silent && this._messageCenter.trigger(eventObj.type, eventObj);\n}\n\nfunction flushPendingActions(silent) {\n  var pendingActions = this._pendingActions;\n\n  while (pendingActions.length) {\n    var payload = pendingActions.shift();\n    doDispatchAction.call(this, payload, silent);\n  }\n}\n\nfunction triggerUpdatedEvent(silent) {\n  !silent && this.trigger('updated');\n}\n/**\n * Event `rendered` is triggered when zr\n * rendered. It is useful for realtime\n * snapshot (reflect animation).\n *\n * Event `finished` is triggered when:\n * (1) zrender rendering finished.\n * (2) initial animation finished.\n * (3) progressive rendering finished.\n * (4) no pending action.\n * (5) no delayed setOption needs to be processed.\n */\n\n\nfunction bindRenderedEvent(zr, ecIns) {\n  zr.on('rendered', function () {\n    ecIns.trigger('rendered'); // The `finished` event should not be triggered repeatly,\n    // so it should only be triggered when rendering indeed happend\n    // in zrender. (Consider the case that dipatchAction is keep\n    // triggering when mouse move).\n\n    if ( // Although zr is dirty if initial animation is not finished\n    // and this checking is called on frame, we also check\n    // animation finished for robustness.\n    zr.animation.isFinished() && !ecIns[OPTION_UPDATED] && !ecIns._scheduler.unfinished && !ecIns._pendingActions.length) {\n      ecIns.trigger('finished');\n    }\n  });\n}\n/**\n * @param {Object} params\n * @param {number} params.seriesIndex\n * @param {Array|TypedArray} params.data\n */\n\n\nechartsProto.appendData = function (params) {\n  var seriesIndex = params.seriesIndex;\n  var ecModel = this.getModel();\n  var seriesModel = ecModel.getSeriesByIndex(seriesIndex);\n  seriesModel.appendData(params); // Note: `appendData` does not support that update extent of coordinate\n  // system, util some scenario require that. In the expected usage of\n  // `appendData`, the initial extent of coordinate system should better\n  // be fixed by axis `min`/`max` setting or initial data, otherwise if\n  // the extent changed while `appendData`, the location of the painted\n  // graphic elements have to be changed, which make the usage of\n  // `appendData` meaningless.\n\n  this._scheduler.unfinished = true;\n};\n/**\n * Register event\n * @method\n */\n\n\nechartsProto.on = createRegisterEventWithLowercaseName('on');\nechartsProto.off = createRegisterEventWithLowercaseName('off');\nechartsProto.one = createRegisterEventWithLowercaseName('one');\n/**\n * Prepare view instances of charts and components\n * @param  {module:echarts/model/Global} ecModel\n * @private\n */\n\nfunction prepareView(ecIns, type, ecModel, scheduler) {\n  var isComponent = type === 'component';\n  var viewList = isComponent ? ecIns._componentsViews : ecIns._chartsViews;\n  var viewMap = isComponent ? ecIns._componentsMap : ecIns._chartsMap;\n  var zr = ecIns._zr;\n  var api = ecIns._api;\n\n  for (var i = 0; i < viewList.length; i++) {\n    viewList[i].__alive = false;\n  }\n\n  isComponent ? ecModel.eachComponent(function (componentType, model) {\n    componentType !== 'series' && doPrepare(model);\n  }) : ecModel.eachSeries(doPrepare);\n\n  function doPrepare(model) {\n    // Consider: id same and type changed.\n    var viewId = '_ec_' + model.id + '_' + model.type;\n    var view = viewMap[viewId];\n\n    if (!view) {\n      var classType = parseClassType(model.type);\n      var Clazz = isComponent ? Component$1.getClass(classType.main, classType.sub) : Chart.getClass(classType.sub);\n      view = new Clazz();\n      view.init(ecModel, api);\n      viewMap[viewId] = view;\n      viewList.push(view);\n      zr.add(view.group);\n    }\n\n    model.__viewId = view.__id = viewId;\n    view.__alive = true;\n    view.__model = model;\n    view.group.__ecComponentInfo = {\n      mainType: model.mainType,\n      index: model.componentIndex\n    };\n    !isComponent && scheduler.prepareView(view, model, ecModel, api);\n  }\n\n  for (var i = 0; i < viewList.length;) {\n    var view = viewList[i];\n\n    if (!view.__alive) {\n      !isComponent && view.renderTask.dispose();\n      zr.remove(view.group);\n      view.dispose(ecModel, api);\n      viewList.splice(i, 1);\n      delete viewMap[view.__id];\n      view.__id = view.group.__ecComponentInfo = null;\n    } else {\n      i++;\n    }\n  }\n} // /**\n//  * Encode visual infomation from data after data processing\n//  *\n//  * @param {module:echarts/model/Global} ecModel\n//  * @param {object} layout\n//  * @param {boolean} [layoutFilter] `true`: only layout,\n//  *                                 `false`: only not layout,\n//  *                                 `null`/`undefined`: all.\n//  * @param {string} taskBaseTag\n//  * @private\n//  */\n// function startVisualEncoding(ecIns, ecModel, api, payload, layoutFilter) {\n//     each(visualFuncs, function (visual, index) {\n//         var isLayout = visual.isLayout;\n//         if (layoutFilter == null\n//             || (layoutFilter === false && !isLayout)\n//             || (layoutFilter === true && isLayout)\n//         ) {\n//             visual.func(ecModel, api, payload);\n//         }\n//     });\n// }\n\n\nfunction clearColorPalette(ecModel) {\n  ecModel.clearColorPalette();\n  ecModel.eachSeries(function (seriesModel) {\n    seriesModel.clearColorPalette();\n  });\n}\n\nfunction render(ecIns, ecModel, api, payload) {\n  renderComponents(ecIns, ecModel, api, payload);\n  each(ecIns._chartsViews, function (chart) {\n    chart.__alive = false;\n  });\n  renderSeries(ecIns, ecModel, api, payload); // Remove groups of unrendered charts\n\n  each(ecIns._chartsViews, function (chart) {\n    if (!chart.__alive) {\n      chart.remove(ecModel, api);\n    }\n  });\n}\n\nfunction renderComponents(ecIns, ecModel, api, payload, dirtyList) {\n  each(dirtyList || ecIns._componentsViews, function (componentView) {\n    var componentModel = componentView.__model;\n    componentView.render(componentModel, ecModel, api, payload);\n    updateZ(componentModel, componentView);\n  });\n}\n/**\n * Render each chart and component\n * @private\n */\n\n\nfunction renderSeries(ecIns, ecModel, api, payload, dirtyMap) {\n  // Render all charts\n  var scheduler = ecIns._scheduler;\n  var unfinished;\n  ecModel.eachSeries(function (seriesModel) {\n    var chartView = ecIns._chartsMap[seriesModel.__viewId];\n    chartView.__alive = true;\n    var renderTask = chartView.renderTask;\n    scheduler.updatePayload(renderTask, payload);\n\n    if (dirtyMap && dirtyMap.get(seriesModel.uid)) {\n      renderTask.dirty();\n    }\n\n    unfinished |= renderTask.perform(scheduler.getPerformArgs(renderTask));\n    chartView.group.silent = !!seriesModel.get('silent');\n    updateZ(seriesModel, chartView);\n    updateBlend(seriesModel, chartView);\n  });\n  scheduler.unfinished |= unfinished; // If use hover layer\n\n  updateHoverLayerStatus(ecIns._zr, ecModel); // Add aria\n\n  aria(ecIns._zr.dom, ecModel);\n}\n\nfunction performPostUpdateFuncs(ecModel, api) {\n  each(postUpdateFuncs, function (func) {\n    func(ecModel, api);\n  });\n}\n\nvar MOUSE_EVENT_NAMES = ['click', 'dblclick', 'mouseover', 'mouseout', 'mousemove', 'mousedown', 'mouseup', 'globalout', 'contextmenu'];\n/**\n * @private\n */\n\nechartsProto._initEvents = function () {\n  each(MOUSE_EVENT_NAMES, function (eveName) {\n    this._zr.on(eveName, function (e) {\n      var ecModel = this.getModel();\n      var el = e.target;\n      var params; // no e.target when 'globalout'.\n\n      if (eveName === 'globalout') {\n        params = {};\n      } else if (el && el.dataIndex != null) {\n        var dataModel = el.dataModel || ecModel.getSeriesByIndex(el.seriesIndex);\n        params = dataModel && dataModel.getDataParams(el.dataIndex, el.dataType) || {};\n      } // If element has custom eventData of components\n      else if (el && el.eventData) {\n          params = extend({}, el.eventData);\n        }\n\n      if (params) {\n        params.event = e;\n        params.type = eveName;\n        this.trigger(eveName, params);\n      }\n    }, this);\n  }, this);\n  each(eventActionMap, function (actionType, eventType) {\n    this._messageCenter.on(eventType, function (event) {\n      this.trigger(eventType, event);\n    }, this);\n  }, this);\n};\n/**\n * @return {boolean}\n */\n\n\nechartsProto.isDisposed = function () {\n  return this._disposed;\n};\n/**\n * Clear\n */\n\n\nechartsProto.clear = function () {\n  this.setOption({\n    series: []\n  }, true);\n};\n/**\n * Dispose instance\n */\n\n\nechartsProto.dispose = function () {\n  if (this._disposed) {\n    return;\n  }\n\n  this._disposed = true;\n  setAttribute(this.getDom(), DOM_ATTRIBUTE_KEY, '');\n  var api = this._api;\n  var ecModel = this._model;\n  each(this._componentsViews, function (component) {\n    component.dispose(ecModel, api);\n  });\n  each(this._chartsViews, function (chart) {\n    chart.dispose(ecModel, api);\n  }); // Dispose after all views disposed\n\n  this._zr.dispose();\n\n  delete instances[this.id];\n};\n\nmixin(ECharts, Eventful);\n\nfunction updateHoverLayerStatus(zr, ecModel) {\n  var storage = zr.storage;\n  var elCount = 0;\n  storage.traverse(function (el) {\n    if (!el.isGroup) {\n      elCount++;\n    }\n  });\n\n  if (elCount > ecModel.get('hoverLayerThreshold') && !env$1.node) {\n    storage.traverse(function (el) {\n      if (!el.isGroup) {\n        // Don't switch back.\n        el.useHoverLayer = true;\n      }\n    });\n  }\n}\n/**\n * Update chart progressive and blend.\n * @param {module:echarts/model/Series|module:echarts/model/Component} model\n * @param {module:echarts/view/Component|module:echarts/view/Chart} view\n */\n\n\nfunction updateBlend(seriesModel, chartView) {\n  var blendMode = seriesModel.get('blendMode') || null;\n  chartView.group.traverse(function (el) {\n    // FIXME marker and other components\n    if (!el.isGroup) {\n      // Only set if blendMode is changed. In case element is incremental and don't wan't to rerender.\n      if (el.style.blend !== blendMode) {\n        el.setStyle('blend', blendMode);\n      }\n    }\n\n    if (el.eachPendingDisplayable) {\n      el.eachPendingDisplayable(function (displayable) {\n        displayable.setStyle('blend', blendMode);\n      });\n    }\n  });\n}\n/**\n * @param {module:echarts/model/Series|module:echarts/model/Component} model\n * @param {module:echarts/view/Component|module:echarts/view/Chart} view\n */\n\n\nfunction updateZ(model, view) {\n  var z = model.get('z');\n  var zlevel = model.get('zlevel'); // Set z and zlevel\n\n  view.group.traverse(function (el) {\n    if (el.type !== 'group') {\n      z != null && (el.z = z);\n      zlevel != null && (el.zlevel = zlevel);\n    }\n  });\n}\n\nfunction createExtensionAPI(ecInstance) {\n  var coordSysMgr = ecInstance._coordSysMgr;\n  return extend(new ExtensionAPI(ecInstance), {\n    // Inject methods\n    getCoordinateSystems: bind(coordSysMgr.getCoordinateSystems, coordSysMgr),\n    getComponentByElement: function (el) {\n      while (el) {\n        var modelInfo = el.__ecComponentInfo;\n\n        if (modelInfo != null) {\n          return ecInstance._model.getComponent(modelInfo.mainType, modelInfo.index);\n        }\n\n        el = el.parent;\n      }\n    }\n  });\n}\n/**\n * @type {Object} key: actionType.\n * @inner\n */\n\n\nvar actions = {};\n/**\n * Map eventType to actionType\n * @type {Object}\n */\n\nvar eventActionMap = {};\n/**\n * Data processor functions of each stage\n * @type {Array.<Object.<string, Function>>}\n * @inner\n */\n\nvar dataProcessorFuncs = [];\n/**\n * @type {Array.<Function>}\n * @inner\n */\n\nvar optionPreprocessorFuncs = [];\n/**\n * @type {Array.<Function>}\n * @inner\n */\n\nvar postUpdateFuncs = [];\n/**\n * Visual encoding functions of each stage\n * @type {Array.<Object.<string, Function>>}\n */\n\nvar visualFuncs = [];\n/**\n * Theme storage\n * @type {Object.<key, Object>}\n */\n\nvar themeStorage = {};\n/**\n * Loading effects\n */\n\nvar loadingEffects = {};\nvar instances = {};\nvar connectedGroups = {};\nvar idBase = new Date() - 0;\nvar groupIdBase = new Date() - 0;\nvar DOM_ATTRIBUTE_KEY = '_echarts_instance_';\nvar mapDataStores = {};\n\nfunction enableConnect(chart) {\n  var STATUS_PENDING = 0;\n  var STATUS_UPDATING = 1;\n  var STATUS_UPDATED = 2;\n  var STATUS_KEY = '__connectUpdateStatus';\n\n  function updateConnectedChartsStatus(charts, status) {\n    for (var i = 0; i < charts.length; i++) {\n      var otherChart = charts[i];\n      otherChart[STATUS_KEY] = status;\n    }\n  }\n\n  each(eventActionMap, function (actionType, eventType) {\n    chart._messageCenter.on(eventType, function (event) {\n      if (connectedGroups[chart.group] && chart[STATUS_KEY] !== STATUS_PENDING) {\n        if (event && event.escapeConnect) {\n          return;\n        }\n\n        var action = chart.makeActionFromEvent(event);\n        var otherCharts = [];\n        each(instances, function (otherChart) {\n          if (otherChart !== chart && otherChart.group === chart.group) {\n            otherCharts.push(otherChart);\n          }\n        });\n        updateConnectedChartsStatus(otherCharts, STATUS_PENDING);\n        each(otherCharts, function (otherChart) {\n          if (otherChart[STATUS_KEY] !== STATUS_UPDATING) {\n            otherChart.dispatchAction(action);\n          }\n        });\n        updateConnectedChartsStatus(otherCharts, STATUS_UPDATED);\n      }\n    });\n  });\n}\n/**\n * @param {HTMLElement} dom\n * @param {Object} [theme]\n * @param {Object} opts\n * @param {number} [opts.devicePixelRatio] Use window.devicePixelRatio by default\n * @param {string} [opts.renderer] Currently only 'canvas' is supported.\n * @param {number} [opts.width] Use clientWidth of the input `dom` by default.\n *                              Can be 'auto' (the same as null/undefined)\n * @param {number} [opts.height] Use clientHeight of the input `dom` by default.\n *                               Can be 'auto' (the same as null/undefined)\n */\n\n\nfunction init(dom, theme$$1, opts) {\n  var existInstance = getInstanceByDom(dom);\n\n  if (existInstance) {\n    return existInstance;\n  }\n\n  var chart = new ECharts(dom, theme$$1, opts);\n  chart.id = 'ec_' + idBase++;\n  instances[chart.id] = chart;\n  setAttribute(dom, DOM_ATTRIBUTE_KEY, chart.id);\n  enableConnect(chart);\n  return chart;\n}\n/**\n * @return {string|Array.<module:echarts~ECharts>} groupId\n */\n\nfunction connect(groupId) {\n  // Is array of charts\n  if (isArray(groupId)) {\n    var charts = groupId;\n    groupId = null; // If any chart has group\n\n    each(charts, function (chart) {\n      if (chart.group != null) {\n        groupId = chart.group;\n      }\n    });\n    groupId = groupId || 'g_' + groupIdBase++;\n    each(charts, function (chart) {\n      chart.group = groupId;\n    });\n  }\n\n  connectedGroups[groupId] = true;\n  return groupId;\n}\n/**\n * @DEPRECATED\n * @return {string} groupId\n */\n\nfunction disConnect(groupId) {\n  connectedGroups[groupId] = false;\n}\n/**\n * @return {string} groupId\n */\n\nvar disconnect = disConnect;\n/**\n * Dispose a chart instance\n * @param  {module:echarts~ECharts|HTMLDomElement|string} chart\n */\n\nfunction dispose(chart) {\n  if (typeof chart === 'string') {\n    chart = instances[chart];\n  } else if (!(chart instanceof ECharts)) {\n    // Try to treat as dom\n    chart = getInstanceByDom(chart);\n  }\n\n  if (chart instanceof ECharts && !chart.isDisposed()) {\n    chart.dispose();\n  }\n}\n/**\n * @param  {HTMLElement} dom\n * @return {echarts~ECharts}\n */\n\nfunction getInstanceByDom(dom) {\n  return instances[getAttribute(dom, DOM_ATTRIBUTE_KEY)];\n}\n/**\n * @param {string} key\n * @return {echarts~ECharts}\n */\n\nfunction getInstanceById(key) {\n  return instances[key];\n}\n/**\n * Register theme\n */\n\nfunction registerTheme(name, theme$$1) {\n  themeStorage[name] = theme$$1;\n}\n/**\n * Register option preprocessor\n * @param {Function} preprocessorFunc\n */\n\nfunction registerPreprocessor(preprocessorFunc) {\n  optionPreprocessorFuncs.push(preprocessorFunc);\n}\n/**\n * @param {number} [priority=1000]\n * @param {Object|Function} processor\n */\n\nfunction registerProcessor(priority, processor) {\n  normalizeRegister(dataProcessorFuncs, priority, processor, PRIORITY_PROCESSOR_FILTER);\n}\n/**\n * Register postUpdater\n * @param {Function} postUpdateFunc\n */\n\nfunction registerPostUpdate(postUpdateFunc) {\n  postUpdateFuncs.push(postUpdateFunc);\n}\n/**\n * Usage:\n * registerAction('someAction', 'someEvent', function () { ... });\n * registerAction('someAction', function () { ... });\n * registerAction(\n *     {type: 'someAction', event: 'someEvent', update: 'updateView'},\n *     function () { ... }\n * );\n *\n * @param {(string|Object)} actionInfo\n * @param {string} actionInfo.type\n * @param {string} [actionInfo.event]\n * @param {string} [actionInfo.update]\n * @param {string} [eventName]\n * @param {Function} action\n */\n\nfunction registerAction(actionInfo, eventName, action) {\n  if (typeof eventName === 'function') {\n    action = eventName;\n    eventName = '';\n  }\n\n  var actionType = isObject(actionInfo) ? actionInfo.type : [actionInfo, actionInfo = {\n    event: eventName\n  }][0]; // Event name is all lowercase\n\n  actionInfo.event = (actionInfo.event || actionType).toLowerCase();\n  eventName = actionInfo.event; // Validate action type and event name.\n\n  assert(ACTION_REG.test(actionType) && ACTION_REG.test(eventName));\n\n  if (!actions[actionType]) {\n    actions[actionType] = {\n      action: action,\n      actionInfo: actionInfo\n    };\n  }\n\n  eventActionMap[eventName] = actionType;\n}\n/**\n * @param {string} type\n * @param {*} CoordinateSystem\n */\n\nfunction registerCoordinateSystem(type, CoordinateSystem$$1) {\n  CoordinateSystemManager.register(type, CoordinateSystem$$1);\n}\n/**\n * Get dimensions of specified coordinate system.\n * @param {string} type\n * @return {Array.<string|Object>}\n */\n\nfunction getCoordinateSystemDimensions(type) {\n  var coordSysCreator = CoordinateSystemManager.get(type);\n\n  if (coordSysCreator) {\n    return coordSysCreator.getDimensionsInfo ? coordSysCreator.getDimensionsInfo() : coordSysCreator.dimensions.slice();\n  }\n}\n/**\n * Layout is a special stage of visual encoding\n * Most visual encoding like color are common for different chart\n * But each chart has it's own layout algorithm\n *\n * @param {number} [priority=1000]\n * @param {Function} layoutTask\n */\n\nfunction registerLayout(priority, layoutTask) {\n  normalizeRegister(visualFuncs, priority, layoutTask, PRIORITY_VISUAL_LAYOUT, 'layout');\n}\n/**\n * @param {number} [priority=3000]\n * @param {module:echarts/stream/Task} visualTask\n */\n\nfunction registerVisual(priority, visualTask) {\n  normalizeRegister(visualFuncs, priority, visualTask, PRIORITY_VISUAL_CHART, 'visual');\n}\n/**\n * @param {Object|Function} fn: {seriesType, createOnAllSeries, performRawSeries, reset}\n */\n\nfunction normalizeRegister(targetList, priority, fn, defaultPriority, visualType) {\n  if (isFunction(priority) || isObject(priority)) {\n    fn = priority;\n    priority = defaultPriority;\n  }\n\n  var stageHandler = Scheduler.wrapStageHandler(fn, visualType);\n  stageHandler.__prio = priority;\n  stageHandler.__raw = fn;\n  targetList.push(stageHandler);\n  return stageHandler;\n}\n/**\n * @param {string} name\n */\n\n\nfunction registerLoading(name, loadingFx) {\n  loadingEffects[name] = loadingFx;\n}\n/**\n * @param {Object} opts\n * @param {string} [superClass]\n */\n\nfunction extendComponentModel(opts\n/*, superClass*/\n) {\n  // var Clazz = ComponentModel;\n  // if (superClass) {\n  //     var classType = parseClassType(superClass);\n  //     Clazz = ComponentModel.getClass(classType.main, classType.sub, true);\n  // }\n  return ComponentModel.extend(opts);\n}\n/**\n * @param {Object} opts\n * @param {string} [superClass]\n */\n\nfunction extendComponentView(opts\n/*, superClass*/\n) {\n  // var Clazz = ComponentView;\n  // if (superClass) {\n  //     var classType = parseClassType(superClass);\n  //     Clazz = ComponentView.getClass(classType.main, classType.sub, true);\n  // }\n  return Component$1.extend(opts);\n}\n/**\n * @param {Object} opts\n * @param {string} [superClass]\n */\n\nfunction extendSeriesModel(opts\n/*, superClass*/\n) {\n  // var Clazz = SeriesModel;\n  // if (superClass) {\n  //     superClass = 'series.' + superClass.replace('series.', '');\n  //     var classType = parseClassType(superClass);\n  //     Clazz = ComponentModel.getClass(classType.main, classType.sub, true);\n  // }\n  return SeriesModel.extend(opts);\n}\n/**\n * @param {Object} opts\n * @param {string} [superClass]\n */\n\nfunction extendChartView(opts\n/*, superClass*/\n) {\n  // var Clazz = ChartView;\n  // if (superClass) {\n  //     superClass = superClass.replace('series.', '');\n  //     var classType = parseClassType(superClass);\n  //     Clazz = ChartView.getClass(classType.main, true);\n  // }\n  return Chart.extend(opts);\n}\n/**\n * ZRender need a canvas context to do measureText.\n * But in node environment canvas may be created by node-canvas.\n * So we need to specify how to create a canvas instead of using document.createElement('canvas')\n *\n * Be careful of using it in the browser.\n *\n * @param {Function} creator\n * @example\n *     var Canvas = require('canvas');\n *     var echarts = require('echarts');\n *     echarts.setCanvasCreator(function () {\n *         // Small size is enough.\n *         return new Canvas(32, 32);\n *     });\n */\n\nfunction setCanvasCreator(creator) {\n  $override('createCanvas', creator);\n}\n/**\n * @param {string} mapName\n * @param {Object|string} geoJson\n * @param {Object} [specialAreas]\n *\n * @example\n *     $.get('USA.json', function (geoJson) {\n *         echarts.registerMap('USA', geoJson);\n *         // Or\n *         echarts.registerMap('USA', {\n *             geoJson: geoJson,\n *             specialAreas: {}\n *         })\n *     });\n */\n\nfunction registerMap(mapName, geoJson, specialAreas) {\n  if (geoJson.geoJson && !geoJson.features) {\n    specialAreas = geoJson.specialAreas;\n    geoJson = geoJson.geoJson;\n  }\n\n  if (typeof geoJson === 'string') {\n    geoJson = typeof JSON !== 'undefined' && JSON.parse ? JSON.parse(geoJson) : new Function('return (' + geoJson + ');')();\n  }\n\n  mapDataStores[mapName] = {\n    geoJson: geoJson,\n    specialAreas: specialAreas\n  };\n}\n/**\n * @param {string} mapName\n * @return {Object}\n */\n\nfunction getMap(mapName) {\n  return mapDataStores[mapName];\n}\nregisterVisual(PRIORITY_VISUAL_GLOBAL, seriesColor);\nregisterPreprocessor(backwardCompat);\nregisterProcessor(PRIORITY_PROCESSOR_STATISTIC, dataStack);\nregisterLoading('default', loadingDefault); // Default actions\n\nregisterAction({\n  type: 'highlight',\n  event: 'highlight',\n  update: 'highlight'\n}, noop);\nregisterAction({\n  type: 'downplay',\n  event: 'downplay',\n  update: 'downplay'\n}, noop); // Default theme\n\nregisterTheme('light', lightTheme);\nregisterTheme('dark', theme); // For backward compatibility, where the namespace `dataTool` will\n// be mounted on `echarts` is the extension `dataTool` is imported.\n\nvar dataTool = {};\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nfunction defaultKeyGetter(item) {\n  return item;\n}\n/**\n * @param {Array} oldArr\n * @param {Array} newArr\n * @param {Function} oldKeyGetter\n * @param {Function} newKeyGetter\n * @param {Object} [context] Can be visited by this.context in callback.\n */\n\n\nfunction DataDiffer(oldArr, newArr, oldKeyGetter, newKeyGetter, context) {\n  this._old = oldArr;\n  this._new = newArr;\n  this._oldKeyGetter = oldKeyGetter || defaultKeyGetter;\n  this._newKeyGetter = newKeyGetter || defaultKeyGetter;\n  this.context = context;\n}\n\nDataDiffer.prototype = {\n  constructor: DataDiffer,\n\n  /**\n   * Callback function when add a data\n   */\n  add: function (func) {\n    this._add = func;\n    return this;\n  },\n\n  /**\n   * Callback function when update a data\n   */\n  update: function (func) {\n    this._update = func;\n    return this;\n  },\n\n  /**\n   * Callback function when remove a data\n   */\n  remove: function (func) {\n    this._remove = func;\n    return this;\n  },\n  execute: function () {\n    var oldArr = this._old;\n    var newArr = this._new;\n    var oldDataIndexMap = {};\n    var newDataIndexMap = {};\n    var oldDataKeyArr = [];\n    var newDataKeyArr = [];\n    var i;\n    initIndexMap(oldArr, oldDataIndexMap, oldDataKeyArr, '_oldKeyGetter', this);\n    initIndexMap(newArr, newDataIndexMap, newDataKeyArr, '_newKeyGetter', this); // Travel by inverted order to make sure order consistency\n    // when duplicate keys exists (consider newDataIndex.pop() below).\n    // For performance consideration, these code below do not look neat.\n\n    for (i = 0; i < oldArr.length; i++) {\n      var key = oldDataKeyArr[i];\n      var idx = newDataIndexMap[key]; // idx can never be empty array here. see 'set null' logic below.\n\n      if (idx != null) {\n        // Consider there is duplicate key (for example, use dataItem.name as key).\n        // We should make sure every item in newArr and oldArr can be visited.\n        var len = idx.length;\n\n        if (len) {\n          len === 1 && (newDataIndexMap[key] = null);\n          idx = idx.unshift();\n        } else {\n          newDataIndexMap[key] = null;\n        }\n\n        this._update && this._update(idx, i);\n      } else {\n        this._remove && this._remove(i);\n      }\n    }\n\n    for (var i = 0; i < newDataKeyArr.length; i++) {\n      var key = newDataKeyArr[i];\n\n      if (newDataIndexMap.hasOwnProperty(key)) {\n        var idx = newDataIndexMap[key];\n\n        if (idx == null) {\n          continue;\n        } // idx can never be empty array here. see 'set null' logic above.\n\n\n        if (!idx.length) {\n          this._add && this._add(idx);\n        } else {\n          for (var j = 0, len = idx.length; j < len; j++) {\n            this._add && this._add(idx[j]);\n          }\n        }\n      }\n    }\n  }\n};\n\nfunction initIndexMap(arr, map, keyArr, keyGetterName, dataDiffer) {\n  for (var i = 0; i < arr.length; i++) {\n    // Add prefix to avoid conflict with Object.prototype.\n    var key = '_ec_' + dataDiffer[keyGetterName](arr[i], i);\n    var existence = map[key];\n\n    if (existence == null) {\n      keyArr.push(key);\n      map[key] = i;\n    } else {\n      if (!existence.length) {\n        map[key] = existence = [existence];\n      }\n\n      existence.push(i);\n    }\n  }\n}\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar OTHER_DIMENSIONS = createHashMap(['tooltip', 'label', 'itemName', 'itemId', 'seriesName']);\nfunction summarizeDimensions(data) {\n  var summary = {};\n  var encode = summary.encode = {};\n  var notExtraCoordDimMap = createHashMap();\n  var defaultedLabel = [];\n  var defaultedTooltip = [];\n  each$1(data.dimensions, function (dimName) {\n    var dimItem = data.getDimensionInfo(dimName);\n    var coordDim = dimItem.coordDim;\n\n    if (coordDim) {\n      var coordDimArr = encode[coordDim];\n\n      if (!encode.hasOwnProperty(coordDim)) {\n        coordDimArr = encode[coordDim] = [];\n      }\n\n      coordDimArr[dimItem.coordDimIndex] = dimName;\n\n      if (!dimItem.isExtraCoord) {\n        notExtraCoordDimMap.set(coordDim, 1); // Use the last coord dim (and label friendly) as default label,\n        // because when dataset is used, it is hard to guess which dimension\n        // can be value dimension. If both show x, y on label is not look good,\n        // and conventionally y axis is focused more.\n\n        if (mayLabelDimType(dimItem.type)) {\n          defaultedLabel[0] = dimName;\n        }\n      }\n\n      if (dimItem.defaultTooltip) {\n        defaultedTooltip.push(dimName);\n      }\n    }\n\n    OTHER_DIMENSIONS.each(function (v, otherDim) {\n      var otherDimArr = encode[otherDim];\n\n      if (!encode.hasOwnProperty(otherDim)) {\n        otherDimArr = encode[otherDim] = [];\n      }\n\n      var dimIndex = dimItem.otherDims[otherDim];\n\n      if (dimIndex != null && dimIndex !== false) {\n        otherDimArr[dimIndex] = dimItem.name;\n      }\n    });\n  });\n  var dataDimsOnCoord = [];\n  var encodeFirstDimNotExtra = {};\n  notExtraCoordDimMap.each(function (v, coordDim) {\n    var dimArr = encode[coordDim]; // ??? FIXME extra coord should not be set in dataDimsOnCoord.\n    // But should fix the case that radar axes: simplify the logic\n    // of `completeDimension`, remove `extraPrefix`.\n\n    encodeFirstDimNotExtra[coordDim] = dimArr[0]; // Not necessary to remove duplicate, because a data\n    // dim canot on more than one coordDim.\n\n    dataDimsOnCoord = dataDimsOnCoord.concat(dimArr);\n  });\n  summary.dataDimsOnCoord = dataDimsOnCoord;\n  summary.encodeFirstDimNotExtra = encodeFirstDimNotExtra;\n  var encodeLabel = encode.label; // FIXME `encode.label` is not recommanded, because formatter can not be set\n  // in this way. Use label.formatter instead. May be remove this approach someday.\n\n  if (encodeLabel && encodeLabel.length) {\n    defaultedLabel = encodeLabel.slice();\n  }\n\n  var encodeTooltip = encode.tooltip;\n\n  if (encodeTooltip && encodeTooltip.length) {\n    defaultedTooltip = encodeTooltip.slice();\n  } else if (!defaultedTooltip.length) {\n    defaultedTooltip = defaultedLabel.slice();\n  }\n\n  encode.defaultedLabel = defaultedLabel;\n  encode.defaultedTooltip = defaultedTooltip;\n  return summary;\n}\nfunction getDimensionTypeByAxis(axisType) {\n  return axisType === 'category' ? 'ordinal' : axisType === 'time' ? 'time' : 'float';\n}\n\nfunction mayLabelDimType(dimType) {\n  // In most cases, ordinal and time do not suitable for label.\n  // Ordinal info can be displayed on axis. Time is too long.\n  return !(dimType === 'ordinal' || dimType === 'time');\n} // function findTheLastDimMayLabel(data) {\n//     // Get last value dim\n//     var dimensions = data.dimensions.slice();\n//     var valueType;\n//     var valueDim;\n//     while (dimensions.length && (\n//         valueDim = dimensions.pop(),\n//         valueType = data.getDimensionInfo(valueDim).type,\n//         valueType === 'ordinal' || valueType === 'time'\n//     )) {} // jshint ignore:line\n//     return valueDim;\n// }\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * List for data storage\n * @module echarts/data/List\n */\nvar isObject$4 = isObject$1;\nvar UNDEFINED = 'undefined'; // Use prefix to avoid index to be the same as otherIdList[idx],\n// which will cause weird udpate animation.\n\nvar ID_PREFIX = 'e\\0\\0';\nvar dataCtors = {\n  'float': typeof Float64Array === UNDEFINED ? Array : Float64Array,\n  'int': typeof Int32Array === UNDEFINED ? Array : Int32Array,\n  // Ordinal data type can be string or int\n  'ordinal': Array,\n  'number': Array,\n  'time': Array\n}; // Caution: MUST not use `new CtorUint32Array(arr, 0, len)`, because the Ctor of array is\n// different from the Ctor of typed array.\n\nvar CtorUint32Array = typeof Uint32Array === UNDEFINED ? Array : Uint32Array;\nvar CtorUint16Array = typeof Uint16Array === UNDEFINED ? Array : Uint16Array;\n\nfunction getIndicesCtor(list) {\n  // The possible max value in this._indicies is always this._rawCount despite of filtering.\n  return list._rawCount > 65535 ? CtorUint32Array : CtorUint16Array;\n}\n\nfunction cloneChunk(originalChunk) {\n  var Ctor = originalChunk.constructor; // Only shallow clone is enough when Array.\n\n  return Ctor === Array ? originalChunk.slice() : new Ctor(originalChunk);\n}\n\nvar TRANSFERABLE_PROPERTIES = ['hasItemOption', '_nameList', '_idList', '_invertedIndicesMap', '_rawData', '_chunkSize', '_chunkCount', '_dimValueGetter', '_count', '_rawCount', '_nameDimIdx', '_idDimIdx'];\nvar CLONE_PROPERTIES = ['_extent', '_approximateExtent', '_rawExtent'];\n\nfunction transferProperties(target, source) {\n  each$1(TRANSFERABLE_PROPERTIES.concat(source.__wrappedMethods || []), function (propName) {\n    if (source.hasOwnProperty(propName)) {\n      target[propName] = source[propName];\n    }\n  });\n  target.__wrappedMethods = source.__wrappedMethods;\n  each$1(CLONE_PROPERTIES, function (propName) {\n    target[propName] = clone(source[propName]);\n  });\n  target._calculationInfo = extend(source._calculationInfo);\n}\n/**\n * @constructor\n * @alias module:echarts/data/List\n *\n * @param {Array.<string|Object>} dimensions\n *      For example, ['someDimName', {name: 'someDimName', type: 'someDimType'}, ...].\n *      Dimensions should be concrete names like x, y, z, lng, lat, angle, radius\n *      Spetial fields: {\n *          ordinalMeta: <module:echarts/data/OrdinalMeta>\n *          createInvertedIndices: <boolean>\n *      }\n * @param {module:echarts/model/Model} hostModel\n */\n\n\nvar List = function (dimensions, hostModel) {\n  dimensions = dimensions || ['x', 'y'];\n  var dimensionInfos = {};\n  var dimensionNames = [];\n  var invertedIndicesMap = {};\n\n  for (var i = 0; i < dimensions.length; i++) {\n    // Use the original dimensions[i], where other flag props may exists.\n    var dimensionInfo = dimensions[i];\n\n    if (isString(dimensionInfo)) {\n      dimensionInfo = {\n        name: dimensionInfo\n      };\n    }\n\n    var dimensionName = dimensionInfo.name;\n    dimensionInfo.type = dimensionInfo.type || 'float';\n\n    if (!dimensionInfo.coordDim) {\n      dimensionInfo.coordDim = dimensionName;\n      dimensionInfo.coordDimIndex = 0;\n    }\n\n    dimensionInfo.otherDims = dimensionInfo.otherDims || {};\n    dimensionNames.push(dimensionName);\n    dimensionInfos[dimensionName] = dimensionInfo;\n    dimensionInfo.index = i;\n\n    if (dimensionInfo.createInvertedIndices) {\n      invertedIndicesMap[dimensionName] = [];\n    }\n  }\n  /**\n   * @readOnly\n   * @type {Array.<string>}\n   */\n\n\n  this.dimensions = dimensionNames;\n  /**\n   * Infomation of each data dimension, like data type.\n   * @type {Object}\n   */\n\n  this._dimensionInfos = dimensionInfos;\n  /**\n   * @type {module:echarts/model/Model}\n   */\n\n  this.hostModel = hostModel;\n  /**\n   * @type {module:echarts/model/Model}\n   */\n\n  this.dataType;\n  /**\n   * Indices stores the indices of data subset after filtered.\n   * This data subset will be used in chart.\n   * @type {Array.<number>}\n   * @readOnly\n   */\n\n  this._indices = null;\n  this._count = 0;\n  this._rawCount = 0;\n  /**\n   * Data storage\n   * @type {Object.<key, Array.<TypedArray|Array>>}\n   * @private\n   */\n\n  this._storage = {};\n  /**\n   * @type {Array.<string>}\n   */\n\n  this._nameList = [];\n  /**\n   * @type {Array.<string>}\n   */\n\n  this._idList = [];\n  /**\n   * Models of data option is stored sparse for optimizing memory cost\n   * @type {Array.<module:echarts/model/Model>}\n   * @private\n   */\n\n  this._optionModels = [];\n  /**\n   * Global visual properties after visual coding\n   * @type {Object}\n   * @private\n   */\n\n  this._visual = {};\n  /**\n   * Globel layout properties.\n   * @type {Object}\n   * @private\n   */\n\n  this._layout = {};\n  /**\n   * Item visual properties after visual coding\n   * @type {Array.<Object>}\n   * @private\n   */\n\n  this._itemVisuals = [];\n  /**\n   * Key: visual type, Value: boolean\n   * @type {Object}\n   * @readOnly\n   */\n\n  this.hasItemVisual = {};\n  /**\n   * Item layout properties after layout\n   * @type {Array.<Object>}\n   * @private\n   */\n\n  this._itemLayouts = [];\n  /**\n   * Graphic elemnents\n   * @type {Array.<module:zrender/Element>}\n   * @private\n   */\n\n  this._graphicEls = [];\n  /**\n   * Max size of each chunk.\n   * @type {number}\n   * @private\n   */\n\n  this._chunkSize = 1e5;\n  /**\n   * @type {number}\n   * @private\n   */\n\n  this._chunkCount = 0;\n  /**\n   * @type {Array.<Array|Object>}\n   * @private\n   */\n\n  this._rawData;\n  /**\n   * Raw extent will not be cloned, but only transfered.\n   * It will not be calculated util needed.\n   * key: dim,\n   * value: {end: number, extent: Array.<number>}\n   * @type {Object}\n   * @private\n   */\n\n  this._rawExtent = {};\n  /**\n   * @type {Object}\n   * @private\n   */\n\n  this._extent = {};\n  /**\n   * key: dim\n   * value: extent\n   * @type {Object}\n   * @private\n   */\n\n  this._approximateExtent = {};\n  /**\n   * Cache summary info for fast visit. See \"dimensionHelper\".\n   * @type {Object}\n   * @private\n   */\n\n  this._dimensionsSummary = summarizeDimensions(this);\n  /**\n   * @type {Object.<Array|TypedArray>}\n   * @private\n   */\n\n  this._invertedIndicesMap = invertedIndicesMap;\n  /**\n   * @type {Object}\n   * @private\n   */\n\n  this._calculationInfo = {};\n};\n\nvar listProto = List.prototype;\nlistProto.type = 'list';\n/**\n * If each data item has it's own option\n * @type {boolean}\n */\n\nlistProto.hasItemOption = true;\n/**\n * Get dimension name\n * @param {string|number} dim\n *        Dimension can be concrete names like x, y, z, lng, lat, angle, radius\n *        Or a ordinal number. For example getDimensionInfo(0) will return 'x' or 'lng' or 'radius'\n * @return {string} Concrete dim name.\n */\n\nlistProto.getDimension = function (dim) {\n  if (!isNaN(dim)) {\n    dim = this.dimensions[dim] || dim;\n  }\n\n  return dim;\n};\n/**\n * Get type and calculation info of particular dimension\n * @param {string|number} dim\n *        Dimension can be concrete names like x, y, z, lng, lat, angle, radius\n *        Or a ordinal number. For example getDimensionInfo(0) will return 'x' or 'lng' or 'radius'\n */\n\n\nlistProto.getDimensionInfo = function (dim) {\n  // Do not clone, because there may be categories in dimInfo.\n  return this._dimensionInfos[this.getDimension(dim)];\n};\n/**\n * @return {Array.<string>} concrete dimension name list on coord.\n */\n\n\nlistProto.getDimensionsOnCoord = function () {\n  return this._dimensionsSummary.dataDimsOnCoord.slice();\n};\n/**\n * @param {string} coordDim\n * @param {number} [idx] A coordDim may map to more than one data dim.\n *        If idx is `true`, return a array of all mapped dims.\n *        If idx is not specified, return the first dim not extra.\n * @return {string|Array.<string>} concrete data dim.\n *        If idx is number, and not found, return null/undefined.\n *        If idx is `true`, and not found, return empty array (always return array).\n */\n\n\nlistProto.mapDimension = function (coordDim, idx) {\n  var dimensionsSummary = this._dimensionsSummary;\n\n  if (idx == null) {\n    return dimensionsSummary.encodeFirstDimNotExtra[coordDim];\n  }\n\n  var dims = dimensionsSummary.encode[coordDim];\n  return idx === true // always return array if idx is `true`\n  ? (dims || []).slice() : dims && dims[idx];\n};\n/**\n * Initialize from data\n * @param {Array.<Object|number|Array>} data source or data or data provider.\n * @param {Array.<string>} [nameLIst] The name of a datum is used on data diff and\n *        defualt label/tooltip.\n *        A name can be specified in encode.itemName,\n *        or dataItem.name (only for series option data),\n *        or provided in nameList from outside.\n * @param {Function} [dimValueGetter] (dataItem, dimName, dataIndex, dimIndex) => number\n */\n\n\nlistProto.initData = function (data, nameList, dimValueGetter) {\n  var notProvider = Source.isInstance(data) || isArrayLike(data);\n\n  if (notProvider) {\n    data = new DefaultDataProvider(data, this.dimensions.length);\n  }\n\n  this._rawData = data; // Clear\n\n  this._storage = {};\n  this._indices = null;\n  this._nameList = nameList || [];\n  this._idList = [];\n  this._nameRepeatCount = {};\n\n  if (!dimValueGetter) {\n    this.hasItemOption = false;\n  }\n  /**\n   * @readOnly\n   */\n\n\n  this.defaultDimValueGetter = defaultDimValueGetters[this._rawData.getSource().sourceFormat]; // Default dim value getter\n\n  this._dimValueGetter = dimValueGetter = dimValueGetter || this.defaultDimValueGetter; // Reset raw extent.\n\n  this._rawExtent = {};\n\n  this._initDataFromProvider(0, data.count()); // If data has no item option.\n\n\n  if (data.pure) {\n    this.hasItemOption = false;\n  }\n};\n\nlistProto.getProvider = function () {\n  return this._rawData;\n};\n\nlistProto.appendData = function (data) {\n  var rawData = this._rawData;\n  var start = this.count();\n  rawData.appendData(data);\n  var end = rawData.count();\n\n  if (!rawData.persistent) {\n    end += start;\n  }\n\n  this._initDataFromProvider(start, end);\n};\n\nlistProto._initDataFromProvider = function (start, end) {\n  // Optimize.\n  if (start >= end) {\n    return;\n  }\n\n  var chunkSize = this._chunkSize;\n  var rawData = this._rawData;\n  var storage = this._storage;\n  var dimensions = this.dimensions;\n  var dimLen = dimensions.length;\n  var dimensionInfoMap = this._dimensionInfos;\n  var nameList = this._nameList;\n  var idList = this._idList;\n  var rawExtent = this._rawExtent;\n  var nameRepeatCount = this._nameRepeatCount = {};\n  var nameDimIdx;\n  var chunkCount = this._chunkCount;\n  var lastChunkIndex = chunkCount - 1;\n\n  for (var i = 0; i < dimLen; i++) {\n    var dim = dimensions[i];\n\n    if (!rawExtent[dim]) {\n      rawExtent[dim] = getInitialExtent();\n    }\n\n    var dimInfo = dimensionInfoMap[dim];\n\n    if (dimInfo.otherDims.itemName === 0) {\n      nameDimIdx = this._nameDimIdx = i;\n    }\n\n    if (dimInfo.otherDims.itemId === 0) {\n      this._idDimIdx = i;\n    }\n\n    var DataCtor = dataCtors[dimInfo.type];\n\n    if (!storage[dim]) {\n      storage[dim] = [];\n    }\n\n    var resizeChunkArray = storage[dim][lastChunkIndex];\n\n    if (resizeChunkArray && resizeChunkArray.length < chunkSize) {\n      var newStore = new DataCtor(Math.min(end - lastChunkIndex * chunkSize, chunkSize)); // The cost of the copy is probably inconsiderable\n      // within the initial chunkSize.\n\n      for (var j = 0; j < resizeChunkArray.length; j++) {\n        newStore[j] = resizeChunkArray[j];\n      }\n\n      storage[dim][lastChunkIndex] = newStore;\n    } // Create new chunks.\n\n\n    for (var k = chunkCount * chunkSize; k < end; k += chunkSize) {\n      storage[dim].push(new DataCtor(Math.min(end - k, chunkSize)));\n    }\n\n    this._chunkCount = storage[dim].length;\n  }\n\n  var dataItem = new Array(dimLen);\n\n  for (var idx = start; idx < end; idx++) {\n    // NOTICE: Try not to write things into dataItem\n    dataItem = rawData.getItem(idx, dataItem); // Each data item is value\n    // [1, 2]\n    // 2\n    // Bar chart, line chart which uses category axis\n    // only gives the 'y' value. 'x' value is the indices of category\n    // Use a tempValue to normalize the value to be a (x, y) value\n\n    var chunkIndex = Math.floor(idx / chunkSize);\n    var chunkOffset = idx % chunkSize; // Store the data by dimensions\n\n    for (var k = 0; k < dimLen; k++) {\n      var dim = dimensions[k];\n      var dimStorage = storage[dim][chunkIndex]; // PENDING NULL is empty or zero\n\n      var val = this._dimValueGetter(dataItem, dim, idx, k);\n\n      dimStorage[chunkOffset] = val;\n      var dimRawExtent = rawExtent[dim];\n\n      if (val < dimRawExtent[0]) {\n        dimRawExtent[0] = val;\n      }\n\n      if (val > dimRawExtent[1]) {\n        dimRawExtent[1] = val;\n      }\n    } // ??? FIXME not check by pure but sourceFormat?\n    // TODO refactor these logic.\n\n\n    if (!rawData.pure) {\n      var name = nameList[idx];\n\n      if (dataItem && name == null) {\n        // If dataItem is {name: ...}, it has highest priority.\n        // That is appropriate for many common cases.\n        if (dataItem.name != null) {\n          // There is no other place to persistent dataItem.name,\n          // so save it to nameList.\n          nameList[idx] = name = dataItem.name;\n        } else if (nameDimIdx != null) {\n          var nameDim = dimensions[nameDimIdx];\n          var nameDimChunk = storage[nameDim][chunkIndex];\n\n          if (nameDimChunk) {\n            name = nameDimChunk[chunkOffset];\n            var ordinalMeta = dimensionInfoMap[nameDim].ordinalMeta;\n\n            if (ordinalMeta && ordinalMeta.categories.length) {\n              name = ordinalMeta.categories[name];\n            }\n          }\n        }\n      } // Try using the id in option\n      // id or name is used on dynamical data, mapping old and new items.\n\n\n      var id = dataItem == null ? null : dataItem.id;\n\n      if (id == null && name != null) {\n        // Use name as id and add counter to avoid same name\n        nameRepeatCount[name] = nameRepeatCount[name] || 0;\n        id = name;\n\n        if (nameRepeatCount[name] > 0) {\n          id += '__ec__' + nameRepeatCount[name];\n        }\n\n        nameRepeatCount[name]++;\n      }\n\n      id != null && (idList[idx] = id);\n    }\n  }\n\n  if (!rawData.persistent && rawData.clean) {\n    // Clean unused data if data source is typed array.\n    rawData.clean();\n  }\n\n  this._rawCount = this._count = end; // Reset data extent\n\n  this._extent = {};\n  prepareInvertedIndex(this);\n};\n\nfunction prepareInvertedIndex(list) {\n  var invertedIndicesMap = list._invertedIndicesMap;\n  each$1(invertedIndicesMap, function (invertedIndices, dim) {\n    var dimInfo = list._dimensionInfos[dim]; // Currently, only dimensions that has ordinalMeta can create inverted indices.\n\n    var ordinalMeta = dimInfo.ordinalMeta;\n\n    if (ordinalMeta) {\n      invertedIndices = invertedIndicesMap[dim] = new CtorUint32Array(ordinalMeta.categories.length); // The default value of TypedArray is 0. To avoid miss\n      // mapping to 0, we should set it as NaN.\n\n      for (var i = 0; i < invertedIndices.length; i++) {\n        invertedIndices[i] = NaN;\n      }\n\n      for (var i = 0; i < list._count; i++) {\n        // Only support the case that all values are distinct.\n        invertedIndices[list.get(dim, i)] = i;\n      }\n    }\n  });\n}\n\nfunction getRawValueFromStore(list, dimIndex, rawIndex) {\n  var val;\n\n  if (dimIndex != null) {\n    var chunkSize = list._chunkSize;\n    var chunkIndex = Math.floor(rawIndex / chunkSize);\n    var chunkOffset = rawIndex % chunkSize;\n    var dim = list.dimensions[dimIndex];\n    var chunk = list._storage[dim][chunkIndex];\n\n    if (chunk) {\n      val = chunk[chunkOffset];\n      var ordinalMeta = list._dimensionInfos[dim].ordinalMeta;\n\n      if (ordinalMeta && ordinalMeta.categories.length) {\n        val = ordinalMeta.categories[val];\n      }\n    }\n  }\n\n  return val;\n}\n/**\n * @return {number}\n */\n\n\nlistProto.count = function () {\n  return this._count;\n};\n\nlistProto.getIndices = function () {\n  var newIndices;\n  var indices = this._indices;\n\n  if (indices) {\n    var Ctor = indices.constructor;\n    var thisCount = this._count; // `new Array(a, b, c)` is different from `new Uint32Array(a, b, c)`.\n\n    if (Ctor === Array) {\n      newIndices = new Ctor(thisCount);\n\n      for (var i = 0; i < thisCount; i++) {\n        newIndices[i] = indices[i];\n      }\n    } else {\n      newIndices = new Ctor(indices.buffer, 0, thisCount);\n    }\n  } else {\n    var Ctor = getIndicesCtor(this);\n    var newIndices = new Ctor(this.count());\n\n    for (var i = 0; i < newIndices.length; i++) {\n      newIndices[i] = i;\n    }\n  }\n\n  return newIndices;\n};\n/**\n * Get value. Return NaN if idx is out of range.\n * @param {string} dim Dim must be concrete name.\n * @param {number} idx\n * @param {boolean} stack\n * @return {number}\n */\n\n\nlistProto.get = function (dim, idx\n/*, stack */\n) {\n  if (!(idx >= 0 && idx < this._count)) {\n    return NaN;\n  }\n\n  var storage = this._storage;\n\n  if (!storage[dim]) {\n    // TODO Warn ?\n    return NaN;\n  }\n\n  idx = this.getRawIndex(idx);\n  var chunkIndex = Math.floor(idx / this._chunkSize);\n  var chunkOffset = idx % this._chunkSize;\n  var chunkStore = storage[dim][chunkIndex];\n  var value = chunkStore[chunkOffset]; // FIXME ordinal data type is not stackable\n  // if (stack) {\n  //     var dimensionInfo = this._dimensionInfos[dim];\n  //     if (dimensionInfo && dimensionInfo.stackable) {\n  //         var stackedOn = this.stackedOn;\n  //         while (stackedOn) {\n  //             // Get no stacked data of stacked on\n  //             var stackedValue = stackedOn.get(dim, idx);\n  //             // Considering positive stack, negative stack and empty data\n  //             if ((value >= 0 && stackedValue > 0)  // Positive stack\n  //                 || (value <= 0 && stackedValue < 0) // Negative stack\n  //             ) {\n  //                 value += stackedValue;\n  //             }\n  //             stackedOn = stackedOn.stackedOn;\n  //         }\n  //     }\n  // }\n\n  return value;\n};\n/**\n * @param {string} dim concrete dim\n * @param {number} rawIndex\n * @return {number|string}\n */\n\n\nlistProto.getByRawIndex = function (dim, rawIdx) {\n  if (!(rawIdx >= 0 && rawIdx < this._rawCount)) {\n    return NaN;\n  }\n\n  var dimStore = this._storage[dim];\n\n  if (!dimStore) {\n    // TODO Warn ?\n    return NaN;\n  }\n\n  var chunkIndex = Math.floor(rawIdx / this._chunkSize);\n  var chunkOffset = rawIdx % this._chunkSize;\n  var chunkStore = dimStore[chunkIndex];\n  return chunkStore[chunkOffset];\n};\n/**\n * FIXME Use `get` on chrome maybe slow(in filterSelf and selectRange).\n * Hack a much simpler _getFast\n * @private\n */\n\n\nlistProto._getFast = function (dim, rawIdx) {\n  var chunkIndex = Math.floor(rawIdx / this._chunkSize);\n  var chunkOffset = rawIdx % this._chunkSize;\n  var chunkStore = this._storage[dim][chunkIndex];\n  return chunkStore[chunkOffset];\n};\n/**\n * Get value for multi dimensions.\n * @param {Array.<string>} [dimensions] If ignored, using all dimensions.\n * @param {number} idx\n * @return {number}\n */\n\n\nlistProto.getValues = function (dimensions, idx\n/*, stack */\n) {\n  var values = [];\n\n  if (!isArray(dimensions)) {\n    // stack = idx;\n    idx = dimensions;\n    dimensions = this.dimensions;\n  }\n\n  for (var i = 0, len = dimensions.length; i < len; i++) {\n    values.push(this.get(dimensions[i], idx\n    /*, stack */\n    ));\n  }\n\n  return values;\n};\n/**\n * If value is NaN. Inlcuding '-'\n * Only check the coord dimensions.\n * @param {string} dim\n * @param {number} idx\n * @return {number}\n */\n\n\nlistProto.hasValue = function (idx) {\n  var dataDimsOnCoord = this._dimensionsSummary.dataDimsOnCoord;\n  var dimensionInfos = this._dimensionInfos;\n\n  for (var i = 0, len = dataDimsOnCoord.length; i < len; i++) {\n    if ( // Ordinal type can be string or number\n    dimensionInfos[dataDimsOnCoord[i]].type !== 'ordinal' // FIXME check ordinal when using index?\n    && isNaN(this.get(dataDimsOnCoord[i], idx))) {\n      return false;\n    }\n  }\n\n  return true;\n};\n/**\n * Get extent of data in one dimension\n * @param {string} dim\n * @param {boolean} stack\n */\n\n\nlistProto.getDataExtent = function (dim\n/*, stack */\n) {\n  // Make sure use concrete dim as cache name.\n  dim = this.getDimension(dim);\n  var dimData = this._storage[dim];\n  var initialExtent = getInitialExtent(); // stack = !!((stack || false) && this.getCalculationInfo(dim));\n\n  if (!dimData) {\n    return initialExtent;\n  } // Make more strict checkings to ensure hitting cache.\n\n\n  var currEnd = this.count(); // var cacheName = [dim, !!stack].join('_');\n  // var cacheName = dim;\n  // Consider the most cases when using data zoom, `getDataExtent`\n  // happened before filtering. We cache raw extent, which is not\n  // necessary to be cleared and recalculated when restore data.\n\n  var useRaw = !this._indices; // && !stack;\n\n  var dimExtent;\n\n  if (useRaw) {\n    return this._rawExtent[dim].slice();\n  }\n\n  dimExtent = this._extent[dim];\n\n  if (dimExtent) {\n    return dimExtent.slice();\n  }\n\n  dimExtent = initialExtent;\n  var min = dimExtent[0];\n  var max = dimExtent[1];\n\n  for (var i = 0; i < currEnd; i++) {\n    // var value = stack ? this.get(dim, i, true) : this._getFast(dim, this.getRawIndex(i));\n    var value = this._getFast(dim, this.getRawIndex(i));\n\n    value < min && (min = value);\n    value > max && (max = value);\n  }\n\n  dimExtent = [min, max];\n  this._extent[dim] = dimExtent;\n  return dimExtent;\n};\n/**\n * Optimize for the scenario that data is filtered by a given extent.\n * Consider that if data amount is more than hundreds of thousand,\n * extent calculation will cost more than 10ms and the cache will\n * be erased because of the filtering.\n */\n\n\nlistProto.getApproximateExtent = function (dim\n/*, stack */\n) {\n  dim = this.getDimension(dim);\n  return this._approximateExtent[dim] || this.getDataExtent(dim\n  /*, stack */\n  );\n};\n\nlistProto.setApproximateExtent = function (extent, dim\n/*, stack */\n) {\n  dim = this.getDimension(dim);\n  this._approximateExtent[dim] = extent.slice();\n};\n/**\n * @param {string} key\n * @return {*}\n */\n\n\nlistProto.getCalculationInfo = function (key) {\n  return this._calculationInfo[key];\n};\n/**\n * @param {string|Object} key or k-v object\n * @param {*} [value]\n */\n\n\nlistProto.setCalculationInfo = function (key, value) {\n  isObject$4(key) ? extend(this._calculationInfo, key) : this._calculationInfo[key] = value;\n};\n/**\n * Get sum of data in one dimension\n * @param {string} dim\n */\n\n\nlistProto.getSum = function (dim\n/*, stack */\n) {\n  var dimData = this._storage[dim];\n  var sum = 0;\n\n  if (dimData) {\n    for (var i = 0, len = this.count(); i < len; i++) {\n      var value = this.get(dim, i\n      /*, stack */\n      );\n\n      if (!isNaN(value)) {\n        sum += value;\n      }\n    }\n  }\n\n  return sum;\n};\n/**\n * Get median of data in one dimension\n * @param {string} dim\n */\n\n\nlistProto.getMedian = function (dim\n/*, stack */\n) {\n  var dimDataArray = []; // map all data of one dimension\n\n  this.each(dim, function (val, idx) {\n    if (!isNaN(val)) {\n      dimDataArray.push(val);\n    }\n  }); // TODO\n  // Use quick select?\n  // immutability & sort\n\n  var sortedDimDataArray = [].concat(dimDataArray).sort(function (a, b) {\n    return a - b;\n  });\n  var len = this.count(); // calculate median\n\n  return len === 0 ? 0 : len % 2 === 1 ? sortedDimDataArray[(len - 1) / 2] : (sortedDimDataArray[len / 2] + sortedDimDataArray[len / 2 - 1]) / 2;\n}; // /**\n//  * Retreive the index with given value\n//  * @param {string} dim Concrete dimension.\n//  * @param {number} value\n//  * @return {number}\n//  */\n// Currently incorrect: should return dataIndex but not rawIndex.\n// Do not fix it until this method is to be used somewhere.\n// FIXME Precision of float value\n// listProto.indexOf = function (dim, value) {\n//     var storage = this._storage;\n//     var dimData = storage[dim];\n//     var chunkSize = this._chunkSize;\n//     if (dimData) {\n//         for (var i = 0, len = this.count(); i < len; i++) {\n//             var chunkIndex = Math.floor(i / chunkSize);\n//             var chunkOffset = i % chunkSize;\n//             if (dimData[chunkIndex][chunkOffset] === value) {\n//                 return i;\n//             }\n//         }\n//     }\n//     return -1;\n// };\n\n/**\n * Only support the dimension which inverted index created.\n * Do not support other cases until required.\n * @param {string} concrete dim\n * @param {number|string} value\n * @return {number} rawIndex\n */\n\n\nlistProto.rawIndexOf = function (dim, value) {\n  var invertedIndices = dim && this._invertedIndicesMap[dim];\n  var rawIndex = invertedIndices[value];\n\n  if (rawIndex == null || isNaN(rawIndex)) {\n    return -1;\n  }\n\n  return rawIndex;\n};\n/**\n * Retreive the index with given name\n * @param {number} idx\n * @param {number} name\n * @return {number}\n */\n\n\nlistProto.indexOfName = function (name) {\n  for (var i = 0, len = this.count(); i < len; i++) {\n    if (this.getName(i) === name) {\n      return i;\n    }\n  }\n\n  return -1;\n};\n/**\n * Retreive the index with given raw data index\n * @param {number} idx\n * @param {number} name\n * @return {number}\n */\n\n\nlistProto.indexOfRawIndex = function (rawIndex) {\n  if (!this._indices) {\n    return rawIndex;\n  }\n\n  if (rawIndex >= this._rawCount || rawIndex < 0) {\n    return -1;\n  } // Indices are ascending\n\n\n  var indices = this._indices; // If rawIndex === dataIndex\n\n  var rawDataIndex = indices[rawIndex];\n\n  if (rawDataIndex != null && rawDataIndex < this._count && rawDataIndex === rawIndex) {\n    return rawIndex;\n  }\n\n  var left = 0;\n  var right = this._count - 1;\n\n  while (left <= right) {\n    var mid = (left + right) / 2 | 0;\n\n    if (indices[mid] < rawIndex) {\n      left = mid + 1;\n    } else if (indices[mid] > rawIndex) {\n      right = mid - 1;\n    } else {\n      return mid;\n    }\n  }\n\n  return -1;\n};\n/**\n * Retreive the index of nearest value\n * @param {string} dim\n * @param {number} value\n * @param {number} [maxDistance=Infinity]\n * @return {Array.<number>} Considere multiple points has the same value.\n */\n\n\nlistProto.indicesOfNearest = function (dim, value, maxDistance) {\n  var storage = this._storage;\n  var dimData = storage[dim];\n  var nearestIndices = [];\n\n  if (!dimData) {\n    return nearestIndices;\n  }\n\n  if (maxDistance == null) {\n    maxDistance = Infinity;\n  }\n\n  var minDist = Number.MAX_VALUE;\n  var minDiff = -1;\n\n  for (var i = 0, len = this.count(); i < len; i++) {\n    var diff = value - this.get(dim, i\n    /*, stack */\n    );\n    var dist = Math.abs(diff);\n\n    if (diff <= maxDistance && dist <= minDist) {\n      // For the case of two data are same on xAxis, which has sequence data.\n      // Show the nearest index\n      // https://github.com/ecomfe/echarts/issues/2869\n      if (dist < minDist || diff >= 0 && minDiff < 0) {\n        minDist = dist;\n        minDiff = diff;\n        nearestIndices.length = 0;\n      }\n\n      nearestIndices.push(i);\n    }\n  }\n\n  return nearestIndices;\n};\n/**\n * Get raw data index\n * @param {number} idx\n * @return {number}\n */\n\n\nlistProto.getRawIndex = getRawIndexWithoutIndices;\n\nfunction getRawIndexWithoutIndices(idx) {\n  return idx;\n}\n\nfunction getRawIndexWithIndices(idx) {\n  if (idx < this._count && idx >= 0) {\n    return this._indices[idx];\n  }\n\n  return -1;\n}\n/**\n * Get raw data item\n * @param {number} idx\n * @return {number}\n */\n\n\nlistProto.getRawDataItem = function (idx) {\n  if (!this._rawData.persistent) {\n    var val = [];\n\n    for (var i = 0; i < this.dimensions.length; i++) {\n      var dim = this.dimensions[i];\n      val.push(this.get(dim, idx));\n    }\n\n    return val;\n  } else {\n    return this._rawData.getItem(this.getRawIndex(idx));\n  }\n};\n/**\n * @param {number} idx\n * @param {boolean} [notDefaultIdx=false]\n * @return {string}\n */\n\n\nlistProto.getName = function (idx) {\n  var rawIndex = this.getRawIndex(idx);\n  return this._nameList[rawIndex] || getRawValueFromStore(this, this._nameDimIdx, rawIndex) || '';\n};\n/**\n * @param {number} idx\n * @param {boolean} [notDefaultIdx=false]\n * @return {string}\n */\n\n\nlistProto.getId = function (idx) {\n  return getId(this, this.getRawIndex(idx));\n};\n\nfunction getId(list, rawIndex) {\n  var id = list._idList[rawIndex];\n\n  if (id == null) {\n    id = getRawValueFromStore(list, list._idDimIdx, rawIndex);\n  }\n\n  if (id == null) {\n    // FIXME Check the usage in graph, should not use prefix.\n    id = ID_PREFIX + rawIndex;\n  }\n\n  return id;\n}\n\nfunction normalizeDimensions(dimensions) {\n  if (!isArray(dimensions)) {\n    dimensions = [dimensions];\n  }\n\n  return dimensions;\n}\n\n/**\n * Data iteration\n * @param {string|Array.<string>}\n * @param {Function} cb\n * @param {*} [context=this]\n *\n * @example\n *  list.each('x', function (x, idx) {});\n *  list.each(['x', 'y'], function (x, y, idx) {});\n *  list.each(function (idx) {})\n */\n\n\nlistProto.each = function (dims, cb, context, contextCompat) {\n  'use strict';\n\n  if (!this._count) {\n    return;\n  }\n\n  if (typeof dims === 'function') {\n    contextCompat = context;\n    context = cb;\n    cb = dims;\n    dims = [];\n  } // contextCompat just for compat echarts3\n\n\n  context = context || contextCompat || this;\n  dims = map(normalizeDimensions(dims), this.getDimension, this);\n  var dimSize = dims.length;\n\n  for (var i = 0; i < this.count(); i++) {\n    // Simple optimization\n    switch (dimSize) {\n      case 0:\n        cb.call(context, i);\n        break;\n\n      case 1:\n        cb.call(context, this.get(dims[0], i), i);\n        break;\n\n      case 2:\n        cb.call(context, this.get(dims[0], i), this.get(dims[1], i), i);\n        break;\n\n      default:\n        var k = 0;\n        var value = [];\n\n        for (; k < dimSize; k++) {\n          value[k] = this.get(dims[k], i);\n        } // Index\n\n\n        value[k] = i;\n        cb.apply(context, value);\n    }\n  }\n};\n/**\n * Data filter\n * @param {string|Array.<string>}\n * @param {Function} cb\n * @param {*} [context=this]\n */\n\n\nlistProto.filterSelf = function (dimensions, cb, context, contextCompat) {\n  'use strict';\n\n  if (!this._count) {\n    return;\n  }\n\n  if (typeof dimensions === 'function') {\n    contextCompat = context;\n    context = cb;\n    cb = dimensions;\n    dimensions = [];\n  } // contextCompat just for compat echarts3\n\n\n  context = context || contextCompat || this;\n  dimensions = map(normalizeDimensions(dimensions), this.getDimension, this);\n  var count = this.count();\n  var Ctor = getIndicesCtor(this);\n  var newIndices = new Ctor(count);\n  var value = [];\n  var dimSize = dimensions.length;\n  var offset = 0;\n  var dim0 = dimensions[0];\n\n  for (var i = 0; i < count; i++) {\n    var keep;\n    var rawIdx = this.getRawIndex(i); // Simple optimization\n\n    if (dimSize === 0) {\n      keep = cb.call(context, i);\n    } else if (dimSize === 1) {\n      var val = this._getFast(dim0, rawIdx);\n\n      keep = cb.call(context, val, i);\n    } else {\n      for (var k = 0; k < dimSize; k++) {\n        value[k] = this._getFast(dim0, rawIdx);\n      }\n\n      value[k] = i;\n      keep = cb.apply(context, value);\n    }\n\n    if (keep) {\n      newIndices[offset++] = rawIdx;\n    }\n  } // Set indices after filtered.\n\n\n  if (offset < count) {\n    this._indices = newIndices;\n  }\n\n  this._count = offset; // Reset data extent\n\n  this._extent = {};\n  this.getRawIndex = this._indices ? getRawIndexWithIndices : getRawIndexWithoutIndices;\n  return this;\n};\n/**\n * Select data in range. (For optimization of filter)\n * (Manually inline code, support 5 million data filtering in data zoom.)\n */\n\n\nlistProto.selectRange = function (range) {\n  'use strict';\n\n  if (!this._count) {\n    return;\n  }\n\n  var dimensions = [];\n\n  for (var dim in range) {\n    if (range.hasOwnProperty(dim)) {\n      dimensions.push(dim);\n    }\n  }\n\n  var dimSize = dimensions.length;\n\n  if (!dimSize) {\n    return;\n  }\n\n  var originalCount = this.count();\n  var Ctor = getIndicesCtor(this);\n  var newIndices = new Ctor(originalCount);\n  var offset = 0;\n  var dim0 = dimensions[0];\n  var min = range[dim0][0];\n  var max = range[dim0][1];\n  var quickFinished = false;\n\n  if (!this._indices) {\n    // Extreme optimization for common case. About 2x faster in chrome.\n    var idx = 0;\n\n    if (dimSize === 1) {\n      var dimStorage = this._storage[dimensions[0]];\n\n      for (var k = 0; k < this._chunkCount; k++) {\n        var chunkStorage = dimStorage[k];\n        var len = Math.min(this._count - k * this._chunkSize, this._chunkSize);\n\n        for (var i = 0; i < len; i++) {\n          var val = chunkStorage[i]; // NaN will not be filtered. Consider the case, in line chart, empty\n          // value indicates the line should be broken. But for the case like\n          // scatter plot, a data item with empty value will not be rendered,\n          // but the axis extent may be effected if some other dim of the data\n          // item has value. Fortunately it is not a significant negative effect.\n\n          if (val >= min && val <= max || isNaN(val)) {\n            newIndices[offset++] = idx;\n          }\n\n          idx++;\n        }\n      }\n\n      quickFinished = true;\n    } else if (dimSize === 2) {\n      var dimStorage = this._storage[dim0];\n      var dimStorage2 = this._storage[dimensions[1]];\n      var min2 = range[dimensions[1]][0];\n      var max2 = range[dimensions[1]][1];\n\n      for (var k = 0; k < this._chunkCount; k++) {\n        var chunkStorage = dimStorage[k];\n        var chunkStorage2 = dimStorage2[k];\n        var len = Math.min(this._count - k * this._chunkSize, this._chunkSize);\n\n        for (var i = 0; i < len; i++) {\n          var val = chunkStorage[i];\n          var val2 = chunkStorage2[i]; // Do not filter NaN, see comment above.\n\n          if ((val >= min && val <= max || isNaN(val)) && (val2 >= min2 && val2 <= max2 || isNaN(val2))) {\n            newIndices[offset++] = idx;\n          }\n\n          idx++;\n        }\n      }\n\n      quickFinished = true;\n    }\n  }\n\n  if (!quickFinished) {\n    if (dimSize === 1) {\n      for (var i = 0; i < originalCount; i++) {\n        var rawIndex = this.getRawIndex(i);\n\n        var val = this._getFast(dim0, rawIndex); // Do not filter NaN, see comment above.\n\n\n        if (val >= min && val <= max || isNaN(val)) {\n          newIndices[offset++] = rawIndex;\n        }\n      }\n    } else {\n      for (var i = 0; i < originalCount; i++) {\n        var keep = true;\n        var rawIndex = this.getRawIndex(i);\n\n        for (var k = 0; k < dimSize; k++) {\n          var dimk = dimensions[k];\n\n          var val = this._getFast(dim, rawIndex); // Do not filter NaN, see comment above.\n\n\n          if (val < range[dimk][0] || val > range[dimk][1]) {\n            keep = false;\n          }\n        }\n\n        if (keep) {\n          newIndices[offset++] = this.getRawIndex(i);\n        }\n      }\n    }\n  } // Set indices after filtered.\n\n\n  if (offset < originalCount) {\n    this._indices = newIndices;\n  }\n\n  this._count = offset; // Reset data extent\n\n  this._extent = {};\n  this.getRawIndex = this._indices ? getRawIndexWithIndices : getRawIndexWithoutIndices;\n  return this;\n};\n/**\n * Data mapping to a plain array\n * @param {string|Array.<string>} [dimensions]\n * @param {Function} cb\n * @param {*} [context=this]\n * @return {Array}\n */\n\n\nlistProto.mapArray = function (dimensions, cb, context, contextCompat) {\n  'use strict';\n\n  if (typeof dimensions === 'function') {\n    contextCompat = context;\n    context = cb;\n    cb = dimensions;\n    dimensions = [];\n  } // contextCompat just for compat echarts3\n\n\n  context = context || contextCompat || this;\n  var result = [];\n  this.each(dimensions, function () {\n    result.push(cb && cb.apply(this, arguments));\n  }, context);\n  return result;\n}; // Data in excludeDimensions is copied, otherwise transfered.\n\n\nfunction cloneListForMapAndSample(original, excludeDimensions) {\n  var allDimensions = original.dimensions;\n  var list = new List(map(allDimensions, original.getDimensionInfo, original), original.hostModel); // FIXME If needs stackedOn, value may already been stacked\n\n  transferProperties(list, original);\n  var storage = list._storage = {};\n  var originalStorage = original._storage; // Init storage\n\n  for (var i = 0; i < allDimensions.length; i++) {\n    var dim = allDimensions[i];\n\n    if (originalStorage[dim]) {\n      // Notice that we do not reset invertedIndicesMap here, becuase\n      // there is no scenario of mapping or sampling ordinal dimension.\n      if (indexOf(excludeDimensions, dim) >= 0) {\n        storage[dim] = cloneDimStore(originalStorage[dim]);\n        list._rawExtent[dim] = getInitialExtent();\n        list._extent[dim] = null;\n      } else {\n        // Direct reference for other dimensions\n        storage[dim] = originalStorage[dim];\n      }\n    }\n  }\n\n  return list;\n}\n\nfunction cloneDimStore(originalDimStore) {\n  var newDimStore = new Array(originalDimStore.length);\n\n  for (var j = 0; j < originalDimStore.length; j++) {\n    newDimStore[j] = cloneChunk(originalDimStore[j]);\n  }\n\n  return newDimStore;\n}\n\nfunction getInitialExtent() {\n  return [Infinity, -Infinity];\n}\n/**\n * Data mapping to a new List with given dimensions\n * @param {string|Array.<string>} dimensions\n * @param {Function} cb\n * @param {*} [context=this]\n * @return {Array}\n */\n\n\nlistProto.map = function (dimensions, cb, context, contextCompat) {\n  'use strict'; // contextCompat just for compat echarts3\n\n  context = context || contextCompat || this;\n  dimensions = map(normalizeDimensions(dimensions), this.getDimension, this);\n  var list = cloneListForMapAndSample(this, dimensions); // Following properties are all immutable.\n  // So we can reference to the same value\n\n  list._indices = this._indices;\n  list.getRawIndex = list._indices ? getRawIndexWithIndices : getRawIndexWithoutIndices;\n  var storage = list._storage;\n  var tmpRetValue = [];\n  var chunkSize = this._chunkSize;\n  var dimSize = dimensions.length;\n  var dataCount = this.count();\n  var values = [];\n  var rawExtent = list._rawExtent;\n\n  for (var dataIndex = 0; dataIndex < dataCount; dataIndex++) {\n    for (var dimIndex = 0; dimIndex < dimSize; dimIndex++) {\n      values[dimIndex] = this.get(dimensions[dimIndex], dataIndex\n      /*, stack */\n      );\n    }\n\n    values[dimSize] = dataIndex;\n    var retValue = cb && cb.apply(context, values);\n\n    if (retValue != null) {\n      // a number or string (in oridinal dimension)?\n      if (typeof retValue !== 'object') {\n        tmpRetValue[0] = retValue;\n        retValue = tmpRetValue;\n      }\n\n      var rawIndex = this.getRawIndex(dataIndex);\n      var chunkIndex = Math.floor(rawIndex / chunkSize);\n      var chunkOffset = rawIndex % chunkSize;\n\n      for (var i = 0; i < retValue.length; i++) {\n        var dim = dimensions[i];\n        var val = retValue[i];\n        var rawExtentOnDim = rawExtent[dim];\n        var dimStore = storage[dim];\n\n        if (dimStore) {\n          dimStore[chunkIndex][chunkOffset] = val;\n        }\n\n        if (val < rawExtentOnDim[0]) {\n          rawExtentOnDim[0] = val;\n        }\n\n        if (val > rawExtentOnDim[1]) {\n          rawExtentOnDim[1] = val;\n        }\n      }\n    }\n  }\n\n  return list;\n};\n/**\n * Large data down sampling on given dimension\n * @param {string} dimension\n * @param {number} rate\n * @param {Function} sampleValue\n * @param {Function} sampleIndex Sample index for name and id\n */\n\n\nlistProto.downSample = function (dimension, rate, sampleValue, sampleIndex) {\n  var list = cloneListForMapAndSample(this, [dimension]);\n  var targetStorage = list._storage;\n  var frameValues = [];\n  var frameSize = Math.floor(1 / rate);\n  var dimStore = targetStorage[dimension];\n  var len = this.count();\n  var chunkSize = this._chunkSize;\n  var rawExtentOnDim = list._rawExtent[dimension];\n  var newIndices = new (getIndicesCtor(this))(len);\n  var offset = 0;\n\n  for (var i = 0; i < len; i += frameSize) {\n    // Last frame\n    if (frameSize > len - i) {\n      frameSize = len - i;\n      frameValues.length = frameSize;\n    }\n\n    for (var k = 0; k < frameSize; k++) {\n      var dataIdx = this.getRawIndex(i + k);\n      var originalChunkIndex = Math.floor(dataIdx / chunkSize);\n      var originalChunkOffset = dataIdx % chunkSize;\n      frameValues[k] = dimStore[originalChunkIndex][originalChunkOffset];\n    }\n\n    var value = sampleValue(frameValues);\n    var sampleFrameIdx = this.getRawIndex(Math.min(i + sampleIndex(frameValues, value) || 0, len - 1));\n    var sampleChunkIndex = Math.floor(sampleFrameIdx / chunkSize);\n    var sampleChunkOffset = sampleFrameIdx % chunkSize; // Only write value on the filtered data\n\n    dimStore[sampleChunkIndex][sampleChunkOffset] = value;\n\n    if (value < rawExtentOnDim[0]) {\n      rawExtentOnDim[0] = value;\n    }\n\n    if (value > rawExtentOnDim[1]) {\n      rawExtentOnDim[1] = value;\n    }\n\n    newIndices[offset++] = sampleFrameIdx;\n  }\n\n  list._count = offset;\n  list._indices = newIndices;\n  list.getRawIndex = getRawIndexWithIndices;\n  return list;\n};\n/**\n * Get model of one data item.\n *\n * @param {number} idx\n */\n// FIXME Model proxy ?\n\n\nlistProto.getItemModel = function (idx) {\n  var hostModel = this.hostModel;\n  return new Model(this.getRawDataItem(idx), hostModel, hostModel && hostModel.ecModel);\n};\n/**\n * Create a data differ\n * @param {module:echarts/data/List} otherList\n * @return {module:echarts/data/DataDiffer}\n */\n\n\nlistProto.diff = function (otherList) {\n  var thisList = this;\n  return new DataDiffer(otherList ? otherList.getIndices() : [], this.getIndices(), function (idx) {\n    return getId(otherList, idx);\n  }, function (idx) {\n    return getId(thisList, idx);\n  });\n};\n/**\n * Get visual property.\n * @param {string} key\n */\n\n\nlistProto.getVisual = function (key) {\n  var visual = this._visual;\n  return visual && visual[key];\n};\n/**\n * Set visual property\n * @param {string|Object} key\n * @param {*} [value]\n *\n * @example\n *  setVisual('color', color);\n *  setVisual({\n *      'color': color\n *  });\n */\n\n\nlistProto.setVisual = function (key, val) {\n  if (isObject$4(key)) {\n    for (var name in key) {\n      if (key.hasOwnProperty(name)) {\n        this.setVisual(name, key[name]);\n      }\n    }\n\n    return;\n  }\n\n  this._visual = this._visual || {};\n  this._visual[key] = val;\n};\n/**\n * Set layout property.\n * @param {string|Object} key\n * @param {*} [val]\n */\n\n\nlistProto.setLayout = function (key, val) {\n  if (isObject$4(key)) {\n    for (var name in key) {\n      if (key.hasOwnProperty(name)) {\n        this.setLayout(name, key[name]);\n      }\n    }\n\n    return;\n  }\n\n  this._layout[key] = val;\n};\n/**\n * Get layout property.\n * @param  {string} key.\n * @return {*}\n */\n\n\nlistProto.getLayout = function (key) {\n  return this._layout[key];\n};\n/**\n * Get layout of single data item\n * @param {number} idx\n */\n\n\nlistProto.getItemLayout = function (idx) {\n  return this._itemLayouts[idx];\n};\n/**\n * Set layout of single data item\n * @param {number} idx\n * @param {Object} layout\n * @param {boolean=} [merge=false]\n */\n\n\nlistProto.setItemLayout = function (idx, layout, merge$$1) {\n  this._itemLayouts[idx] = merge$$1 ? extend(this._itemLayouts[idx] || {}, layout) : layout;\n};\n/**\n * Clear all layout of single data item\n */\n\n\nlistProto.clearItemLayouts = function () {\n  this._itemLayouts.length = 0;\n};\n/**\n * Get visual property of single data item\n * @param {number} idx\n * @param {string} key\n * @param {boolean} [ignoreParent=false]\n */\n\n\nlistProto.getItemVisual = function (idx, key, ignoreParent) {\n  var itemVisual = this._itemVisuals[idx];\n  var val = itemVisual && itemVisual[key];\n\n  if (val == null && !ignoreParent) {\n    // Use global visual property\n    return this.getVisual(key);\n  }\n\n  return val;\n};\n/**\n * Set visual property of single data item\n *\n * @param {number} idx\n * @param {string|Object} key\n * @param {*} [value]\n *\n * @example\n *  setItemVisual(0, 'color', color);\n *  setItemVisual(0, {\n *      'color': color\n *  });\n */\n\n\nlistProto.setItemVisual = function (idx, key, value) {\n  var itemVisual = this._itemVisuals[idx] || {};\n  var hasItemVisual = this.hasItemVisual;\n  this._itemVisuals[idx] = itemVisual;\n\n  if (isObject$4(key)) {\n    for (var name in key) {\n      if (key.hasOwnProperty(name)) {\n        itemVisual[name] = key[name];\n        hasItemVisual[name] = true;\n      }\n    }\n\n    return;\n  }\n\n  itemVisual[key] = value;\n  hasItemVisual[key] = true;\n};\n/**\n * Clear itemVisuals and list visual.\n */\n\n\nlistProto.clearAllVisual = function () {\n  this._visual = {};\n  this._itemVisuals = [];\n  this.hasItemVisual = {};\n};\n\nvar setItemDataAndSeriesIndex = function (child) {\n  child.seriesIndex = this.seriesIndex;\n  child.dataIndex = this.dataIndex;\n  child.dataType = this.dataType;\n};\n/**\n * Set graphic element relative to data. It can be set as null\n * @param {number} idx\n * @param {module:zrender/Element} [el]\n */\n\n\nlistProto.setItemGraphicEl = function (idx, el) {\n  var hostModel = this.hostModel;\n\n  if (el) {\n    // Add data index and series index for indexing the data by element\n    // Useful in tooltip\n    el.dataIndex = idx;\n    el.dataType = this.dataType;\n    el.seriesIndex = hostModel && hostModel.seriesIndex;\n\n    if (el.type === 'group') {\n      el.traverse(setItemDataAndSeriesIndex, el);\n    }\n  }\n\n  this._graphicEls[idx] = el;\n};\n/**\n * @param {number} idx\n * @return {module:zrender/Element}\n */\n\n\nlistProto.getItemGraphicEl = function (idx) {\n  return this._graphicEls[idx];\n};\n/**\n * @param {Function} cb\n * @param {*} context\n */\n\n\nlistProto.eachItemGraphicEl = function (cb, context) {\n  each$1(this._graphicEls, function (el, idx) {\n    if (el) {\n      cb && cb.call(context, el, idx);\n    }\n  });\n};\n/**\n * Shallow clone a new list except visual and layout properties, and graph elements.\n * New list only change the indices.\n */\n\n\nlistProto.cloneShallow = function (list) {\n  if (!list) {\n    var dimensionInfoList = map(this.dimensions, this.getDimensionInfo, this);\n    list = new List(dimensionInfoList, this.hostModel);\n  } // FIXME\n\n\n  list._storage = this._storage;\n  transferProperties(list, this); // Clone will not change the data extent and indices\n\n  if (this._indices) {\n    var Ctor = this._indices.constructor;\n    list._indices = new Ctor(this._indices);\n  } else {\n    list._indices = null;\n  }\n\n  list.getRawIndex = list._indices ? getRawIndexWithIndices : getRawIndexWithoutIndices;\n  return list;\n};\n/**\n * Wrap some method to add more feature\n * @param {string} methodName\n * @param {Function} injectFunction\n */\n\n\nlistProto.wrapMethod = function (methodName, injectFunction) {\n  var originalMethod = this[methodName];\n\n  if (typeof originalMethod !== 'function') {\n    return;\n  }\n\n  this.__wrappedMethods = this.__wrappedMethods || [];\n\n  this.__wrappedMethods.push(methodName);\n\n  this[methodName] = function () {\n    var res = originalMethod.apply(this, arguments);\n    return injectFunction.apply(this, [res].concat(slice(arguments)));\n  };\n}; // Methods that create a new list based on this list should be listed here.\n// Notice that those method should `RETURN` the new list.\n\n\nlistProto.TRANSFERABLE_METHODS = ['cloneShallow', 'downSample', 'map']; // Methods that change indices of this list should be listed here.\n\nlistProto.CHANGABLE_METHODS = ['filterSelf', 'selectRange'];\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * @deprecated\n * Use `echarts/data/helper/createDimensions` instead.\n */\n/**\n * @see {module:echarts/test/ut/spec/data/completeDimensions}\n *\n * Complete the dimensions array, by user defined `dimension` and `encode`,\n * and guessing from the data structure.\n * If no 'value' dimension specified, the first no-named dimension will be\n * named as 'value'.\n *\n * @param {Array.<string>} sysDims Necessary dimensions, like ['x', 'y'], which\n *      provides not only dim template, but also default order.\n *      properties: 'name', 'type', 'displayName'.\n *      `name` of each item provides default coord name.\n *      [{dimsDef: [string|Object, ...]}, ...] dimsDef of sysDim item provides default dim name, and\n *                                    provide dims count that the sysDim required.\n *      [{ordinalMeta}] can be specified.\n * @param {module:echarts/data/Source|Array|Object} source or data (for compatibal with pervious)\n * @param {Object} [opt]\n * @param {Array.<Object|string>} [opt.dimsDef] option.series.dimensions User defined dimensions\n *      For example: ['asdf', {name, type}, ...].\n * @param {Object|HashMap} [opt.encodeDef] option.series.encode {x: 2, y: [3, 1], tooltip: [1, 2], label: 3}\n * @param {string} [opt.generateCoord] Generate coord dim with the given name.\n *                 If not specified, extra dim names will be:\n *                 'value', 'value0', 'value1', ...\n * @param {number} [opt.generateCoordCount] By default, the generated dim name is `generateCoord`.\n *                 If `generateCoordCount` specified, the generated dim names will be:\n *                 `generateCoord` + 0, `generateCoord` + 1, ...\n *                 can be Infinity, indicate that use all of the remain columns.\n * @param {number} [opt.dimCount] If not specified, guess by the first data item.\n * @param {number} [opt.encodeDefaulter] If not specified, auto find the next available data dim.\n * @return {Array.<Object>} [{\n *      name: string mandatory,\n *      displayName: string, the origin name in dimsDef, see source helper.\n *                 If displayName given, the tooltip will displayed vertically.\n *      coordDim: string mandatory,\n *      coordDimIndex: number mandatory,\n *      type: string optional,\n *      otherDims: { never null/undefined\n *          tooltip: number optional,\n *          label: number optional,\n *          itemName: number optional,\n *          seriesName: number optional,\n *      },\n *      isExtraCoord: boolean true if coord is generated\n *          (not specified in encode and not series specified)\n *      other props ...\n * }]\n */\n\nfunction completeDimensions(sysDims, source, opt) {\n  if (!Source.isInstance(source)) {\n    source = Source.seriesDataToSource(source);\n  }\n\n  opt = opt || {};\n  sysDims = (sysDims || []).slice();\n  var dimsDef = (opt.dimsDef || []).slice();\n  var encodeDef = createHashMap(opt.encodeDef);\n  var dataDimNameMap = createHashMap();\n  var coordDimNameMap = createHashMap(); // var valueCandidate;\n\n  var result = [];\n  var dimCount = getDimCount(source, sysDims, dimsDef, opt.dimCount); // Apply user defined dims (`name` and `type`) and init result.\n\n  for (var i = 0; i < dimCount; i++) {\n    var dimDefItem = dimsDef[i] = extend({}, isObject$1(dimsDef[i]) ? dimsDef[i] : {\n      name: dimsDef[i]\n    });\n    var userDimName = dimDefItem.name;\n    var resultItem = result[i] = {\n      otherDims: {}\n    }; // Name will be applied later for avoiding duplication.\n\n    if (userDimName != null && dataDimNameMap.get(userDimName) == null) {\n      // Only if `series.dimensions` is defined in option\n      // displayName, will be set, and dimension will be diplayed vertically in\n      // tooltip by default.\n      resultItem.name = resultItem.displayName = userDimName;\n      dataDimNameMap.set(userDimName, i);\n    }\n\n    dimDefItem.type != null && (resultItem.type = dimDefItem.type);\n    dimDefItem.displayName != null && (resultItem.displayName = dimDefItem.displayName);\n  } // Set `coordDim` and `coordDimIndex` by `encodeDef` and normalize `encodeDef`.\n\n\n  encodeDef.each(function (dataDims, coordDim) {\n    dataDims = normalizeToArray(dataDims).slice();\n    var validDataDims = encodeDef.set(coordDim, []);\n    each$1(dataDims, function (resultDimIdx, idx) {\n      // The input resultDimIdx can be dim name or index.\n      isString(resultDimIdx) && (resultDimIdx = dataDimNameMap.get(resultDimIdx));\n\n      if (resultDimIdx != null && resultDimIdx < dimCount) {\n        validDataDims[idx] = resultDimIdx;\n        applyDim(result[resultDimIdx], coordDim, idx);\n      }\n    });\n  }); // Apply templetes and default order from `sysDims`.\n\n  var availDimIdx = 0;\n  each$1(sysDims, function (sysDimItem, sysDimIndex) {\n    var coordDim;\n    var sysDimItem;\n    var sysDimItemDimsDef;\n    var sysDimItemOtherDims;\n\n    if (isString(sysDimItem)) {\n      coordDim = sysDimItem;\n      sysDimItem = {};\n    } else {\n      coordDim = sysDimItem.name;\n      var ordinalMeta = sysDimItem.ordinalMeta;\n      sysDimItem.ordinalMeta = null;\n      sysDimItem = clone(sysDimItem);\n      sysDimItem.ordinalMeta = ordinalMeta; // `coordDimIndex` should not be set directly.\n\n      sysDimItemDimsDef = sysDimItem.dimsDef;\n      sysDimItemOtherDims = sysDimItem.otherDims;\n      sysDimItem.name = sysDimItem.coordDim = sysDimItem.coordDimIndex = sysDimItem.dimsDef = sysDimItem.otherDims = null;\n    }\n\n    var dataDims = normalizeToArray(encodeDef.get(coordDim)); // dimensions provides default dim sequences.\n\n    if (!dataDims.length) {\n      for (var i = 0; i < (sysDimItemDimsDef && sysDimItemDimsDef.length || 1); i++) {\n        while (availDimIdx < result.length && result[availDimIdx].coordDim != null) {\n          availDimIdx++;\n        }\n\n        availDimIdx < result.length && dataDims.push(availDimIdx++);\n      }\n    } // Apply templates.\n\n\n    each$1(dataDims, function (resultDimIdx, coordDimIndex) {\n      var resultItem = result[resultDimIdx];\n      applyDim(defaults(resultItem, sysDimItem), coordDim, coordDimIndex);\n\n      if (resultItem.name == null && sysDimItemDimsDef) {\n        var sysDimItemDimsDefItem = sysDimItemDimsDef[coordDimIndex];\n        !isObject$1(sysDimItemDimsDefItem) && (sysDimItemDimsDefItem = {\n          name: sysDimItemDimsDefItem\n        });\n        resultItem.name = resultItem.displayName = sysDimItemDimsDefItem.name;\n        resultItem.defaultTooltip = sysDimItemDimsDefItem.defaultTooltip;\n      } // FIXME refactor, currently only used in case: {otherDims: {tooltip: false}}\n\n\n      sysDimItemOtherDims && defaults(resultItem.otherDims, sysDimItemOtherDims);\n    });\n  });\n\n  function applyDim(resultItem, coordDim, coordDimIndex) {\n    if (OTHER_DIMENSIONS.get(coordDim) != null) {\n      resultItem.otherDims[coordDim] = coordDimIndex;\n    } else {\n      resultItem.coordDim = coordDim;\n      resultItem.coordDimIndex = coordDimIndex;\n      coordDimNameMap.set(coordDim, true);\n    }\n  } // Make sure the first extra dim is 'value'.\n\n\n  var generateCoord = opt.generateCoord;\n  var generateCoordCount = opt.generateCoordCount;\n  var fromZero = generateCoordCount != null;\n  generateCoordCount = generateCoord ? generateCoordCount || 1 : 0;\n  var extra = generateCoord || 'value'; // Set dim `name` and other `coordDim` and other props.\n\n  for (var resultDimIdx = 0; resultDimIdx < dimCount; resultDimIdx++) {\n    var resultItem = result[resultDimIdx] = result[resultDimIdx] || {};\n    var coordDim = resultItem.coordDim;\n\n    if (coordDim == null) {\n      resultItem.coordDim = genName(extra, coordDimNameMap, fromZero);\n      resultItem.coordDimIndex = 0;\n\n      if (!generateCoord || generateCoordCount <= 0) {\n        resultItem.isExtraCoord = true;\n      }\n\n      generateCoordCount--;\n    }\n\n    resultItem.name == null && (resultItem.name = genName(resultItem.coordDim, dataDimNameMap));\n\n    if (resultItem.type == null && guessOrdinal(source, resultDimIdx, resultItem.name)) {\n      resultItem.type = 'ordinal';\n    }\n  }\n\n  return result;\n} // ??? TODO\n// Originally detect dimCount by data[0]. Should we\n// optimize it to only by sysDims and dimensions and encode.\n// So only necessary dims will be initialized.\n// But\n// (1) custom series should be considered. where other dims\n// may be visited.\n// (2) sometimes user need to calcualte bubble size or use visualMap\n// on other dimensions besides coordSys needed.\n// So, dims that is not used by system, should be shared in storage?\n\n\nfunction getDimCount(source, sysDims, dimsDef, optDimCount) {\n  // Note that the result dimCount should not small than columns count\n  // of data, otherwise `dataDimNameMap` checking will be incorrect.\n  var dimCount = Math.max(source.dimensionsDetectCount || 1, sysDims.length, dimsDef.length, optDimCount || 0);\n  each$1(sysDims, function (sysDimItem) {\n    var sysDimItemDimsDef = sysDimItem.dimsDef;\n    sysDimItemDimsDef && (dimCount = Math.max(dimCount, sysDimItemDimsDef.length));\n  });\n  return dimCount;\n}\n\nfunction genName(name, map$$1, fromZero) {\n  if (fromZero || map$$1.get(name) != null) {\n    var i = 0;\n\n    while (map$$1.get(name + i) != null) {\n      i++;\n    }\n\n    name += i;\n  }\n\n  map$$1.set(name, true);\n  return name;\n}\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * Substitute `completeDimensions`.\n * `completeDimensions` is to be deprecated.\n */\n/**\n * @param {module:echarts/data/Source|module:echarts/data/List} source or data.\n * @param {Object|Array} [opt]\n * @param {Array.<string|Object>} [opt.coordDimensions=[]]\n * @param {number} [opt.dimensionsCount]\n * @param {string} [opt.generateCoord]\n * @param {string} [opt.generateCoordCount]\n * @param {Array.<string|Object>} [opt.dimensionsDefine=source.dimensionsDefine] Overwrite source define.\n * @param {Object|HashMap} [opt.encodeDefine=source.encodeDefine] Overwrite source define.\n * @return {Array.<Object>} dimensionsInfo\n */\n\nvar createDimensions = function (source, opt) {\n  opt = opt || {};\n  return completeDimensions(opt.coordDimensions || [], source, {\n    dimsDef: opt.dimensionsDefine || source.dimensionsDefine,\n    encodeDef: opt.encodeDefine || source.encodeDefine,\n    dimCount: opt.dimensionsCount,\n    generateCoord: opt.generateCoord,\n    generateCoordCount: opt.generateCoordCount\n  });\n};\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n/**\n * Note that it is too complicated to support 3d stack by value\n * (have to create two-dimension inverted index), so in 3d case\n * we just support that stacked by index.\n *\n * @param {module:echarts/model/Series} seriesModel\n * @param {Array.<string|Object>} dimensionInfoList The same as the input of <module:echarts/data/List>.\n *        The input dimensionInfoList will be modified.\n * @param {Object} [opt]\n * @param {boolean} [opt.stackedCoordDimension=''] Specify a coord dimension if needed.\n * @param {boolean} [opt.byIndex=false]\n * @return {Object} calculationInfo\n * {\n *     stackedDimension: string\n *     stackedByDimension: string\n *     isStackedByIndex: boolean\n *     stackedOverDimension: string\n *     stackResultDimension: string\n * }\n */\n\nfunction enableDataStack(seriesModel, dimensionInfoList, opt) {\n  opt = opt || {};\n  var byIndex = opt.byIndex;\n  var stackedCoordDimension = opt.stackedCoordDimension; // Compatibal: when `stack` is set as '', do not stack.\n\n  var mayStack = !!(seriesModel && seriesModel.get('stack'));\n  var stackedByDimInfo;\n  var stackedDimInfo;\n  var stackResultDimension;\n  var stackedOverDimension;\n  each$1(dimensionInfoList, function (dimensionInfo, index) {\n    if (isString(dimensionInfo)) {\n      dimensionInfoList[index] = dimensionInfo = {\n        name: dimensionInfo\n      };\n    }\n\n    if (mayStack && !dimensionInfo.isExtraCoord) {\n      // Find the first ordinal dimension as the stackedByDimInfo.\n      if (!byIndex && !stackedByDimInfo && dimensionInfo.ordinalMeta) {\n        stackedByDimInfo = dimensionInfo;\n      } // Find the first stackable dimension as the stackedDimInfo.\n\n\n      if (!stackedDimInfo && dimensionInfo.type !== 'ordinal' && dimensionInfo.type !== 'time' && (!stackedCoordDimension || stackedCoordDimension === dimensionInfo.coordDim)) {\n        stackedDimInfo = dimensionInfo;\n      }\n    }\n  });\n\n  if (stackedDimInfo && !byIndex && !stackedByDimInfo) {\n    // Compatible with previous design, value axis (time axis) only stack by index.\n    // It may make sense if the user provides elaborately constructed data.\n    byIndex = true;\n  } // Add stack dimension, they can be both calculated by coordinate system in `unionExtent`.\n  // That put stack logic in List is for using conveniently in echarts extensions, but it\n  // might not be a good way.\n\n\n  if (stackedDimInfo) {\n    // Use a weird name that not duplicated with other names.\n    stackResultDimension = '__\\0ecstackresult';\n    stackedOverDimension = '__\\0ecstackedover'; // Create inverted index to fast query index by value.\n\n    if (stackedByDimInfo) {\n      stackedByDimInfo.createInvertedIndices = true;\n    }\n\n    var stackedDimCoordDim = stackedDimInfo.coordDim;\n    var stackedDimType = stackedDimInfo.type;\n    var stackedDimCoordIndex = 0;\n    each$1(dimensionInfoList, function (dimensionInfo) {\n      if (dimensionInfo.coordDim === stackedDimCoordDim) {\n        stackedDimCoordIndex++;\n      }\n    });\n    dimensionInfoList.push({\n      name: stackResultDimension,\n      coordDim: stackedDimCoordDim,\n      coordDimIndex: stackedDimCoordIndex,\n      type: stackedDimType,\n      isExtraCoord: true,\n      isCalculationCoord: true\n    });\n    stackedDimCoordIndex++;\n    dimensionInfoList.push({\n      name: stackedOverDimension,\n      // This dimension contains stack base (generally, 0), so do not set it as\n      // `stackedDimCoordDim` to avoid extent calculation, consider log scale.\n      coordDim: stackedOverDimension,\n      coordDimIndex: stackedDimCoordIndex,\n      type: stackedDimType,\n      isExtraCoord: true,\n      isCalculationCoord: true\n    });\n  }\n\n  return {\n    stackedDimension: stackedDimInfo && stackedDimInfo.name,\n    stackedByDimension: stackedByDimInfo && stackedByDimInfo.name,\n    isStackedByIndex: byIndex,\n    stackedOverDimension: stackedOverDimension,\n    stackResultDimension: stackResultDimension\n  };\n}\n/**\n * @param {module:echarts/data/List} data\n * @param {string} stackedDim\n */\n\nfunction isDimensionStacked(data, stackedDim\n/*, stackedByDim*/\n) {\n  // Each single series only maps to one pair of axis. So we do not need to\n  // check stackByDim, whatever stacked by a dimension or stacked by index.\n  return !!stackedDim && stackedDim === data.getCalculationInfo('stackedDimension'); // && (\n  //     stackedByDim != null\n  //         ? stackedByDim === data.getCalculationInfo('stackedByDimension')\n  //         : data.getCalculationInfo('isStackedByIndex')\n  // );\n}\n/**\n * @param {module:echarts/data/List} data\n * @param {string} targetDim\n * @param {string} [stackedByDim] If not input this parameter, check whether\n *                                stacked by index.\n * @return {string} dimension\n */\n\nfunction getStackedDimension(data, targetDim) {\n  return isDimensionStacked(data, targetDim) ? data.getCalculationInfo('stackResultDimension') : targetDim;\n}\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n/**\n * @param {module:echarts/data/Source|Array} source Or raw data.\n * @param {module:echarts/model/Series} seriesModel\n * @param {Object} [opt]\n * @param {string} [opt.generateCoord]\n */\n\nfunction createListFromArray(source, seriesModel, opt) {\n  opt = opt || {};\n\n  if (!Source.isInstance(source)) {\n    source = Source.seriesDataToSource(source);\n  }\n\n  var coordSysName = seriesModel.get('coordinateSystem');\n  var registeredCoordSys = CoordinateSystemManager.get(coordSysName);\n  var coordSysDefine = getCoordSysDefineBySeries(seriesModel);\n  var coordSysDimDefs;\n\n  if (coordSysDefine) {\n    coordSysDimDefs = map(coordSysDefine.coordSysDims, function (dim) {\n      var dimInfo = {\n        name: dim\n      };\n      var axisModel = coordSysDefine.axisMap.get(dim);\n\n      if (axisModel) {\n        var axisType = axisModel.get('type');\n        dimInfo.type = getDimensionTypeByAxis(axisType); // dimInfo.stackable = isStackable(axisType);\n      }\n\n      return dimInfo;\n    });\n  }\n\n  if (!coordSysDimDefs) {\n    // Get dimensions from registered coordinate system\n    coordSysDimDefs = registeredCoordSys && (registeredCoordSys.getDimensionsInfo ? registeredCoordSys.getDimensionsInfo() : registeredCoordSys.dimensions.slice()) || ['x', 'y'];\n  }\n\n  var dimInfoList = createDimensions(source, {\n    coordDimensions: coordSysDimDefs,\n    generateCoord: opt.generateCoord\n  });\n  var firstCategoryDimIndex;\n  var hasNameEncode;\n  coordSysDefine && each$1(dimInfoList, function (dimInfo, dimIndex) {\n    var coordDim = dimInfo.coordDim;\n    var categoryAxisModel = coordSysDefine.categoryAxisMap.get(coordDim);\n\n    if (categoryAxisModel) {\n      if (firstCategoryDimIndex == null) {\n        firstCategoryDimIndex = dimIndex;\n      }\n\n      dimInfo.ordinalMeta = categoryAxisModel.getOrdinalMeta();\n    }\n\n    if (dimInfo.otherDims.itemName != null) {\n      hasNameEncode = true;\n    }\n  });\n\n  if (!hasNameEncode && firstCategoryDimIndex != null) {\n    dimInfoList[firstCategoryDimIndex].otherDims.itemName = 0;\n  }\n\n  var stackCalculationInfo = enableDataStack(seriesModel, dimInfoList);\n  var list = new List(dimInfoList, seriesModel);\n  list.setCalculationInfo(stackCalculationInfo);\n  var dimValueGetter = firstCategoryDimIndex != null && isNeedCompleteOrdinalData(source) ? function (itemOpt, dimName, dataIndex, dimIndex) {\n    // Use dataIndex as ordinal value in categoryAxis\n    return dimIndex === firstCategoryDimIndex ? dataIndex : this.defaultDimValueGetter(itemOpt, dimName, dataIndex, dimIndex);\n  } : null;\n  list.hasItemOption = false;\n  list.initData(source, null, dimValueGetter);\n  return list;\n}\n\nfunction isNeedCompleteOrdinalData(source) {\n  if (source.sourceFormat === SOURCE_FORMAT_ORIGINAL) {\n    var sampleItem = firstDataNotNull(source.data || []);\n    return sampleItem != null && !isArray(getDataItemValue(sampleItem));\n  }\n}\n\nfunction firstDataNotNull(data) {\n  var i = 0;\n\n  while (i < data.length && data[i] == null) {\n    i++;\n  }\n\n  return data[i];\n}\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * // Scale class management\n * @module echarts/scale/Scale\n */\n/**\n * @param {Object} [setting]\n */\n\nfunction Scale(setting) {\n  this._setting = setting || {};\n  /**\n   * Extent\n   * @type {Array.<number>}\n   * @protected\n   */\n\n  this._extent = [Infinity, -Infinity];\n  /**\n   * Step is calculated in adjustExtent\n   * @type {Array.<number>}\n   * @protected\n   */\n\n  this._interval = 0;\n  this.init && this.init.apply(this, arguments);\n}\n/**\n * Parse input val to valid inner number.\n * @param {*} val\n * @return {number}\n */\n\n\nScale.prototype.parse = function (val) {\n  // Notice: This would be a trap here, If the implementation\n  // of this method depends on extent, and this method is used\n  // before extent set (like in dataZoom), it would be wrong.\n  // Nevertheless, parse does not depend on extent generally.\n  return val;\n};\n\nScale.prototype.getSetting = function (name) {\n  return this._setting[name];\n};\n\nScale.prototype.contain = function (val) {\n  var extent = this._extent;\n  return val >= extent[0] && val <= extent[1];\n};\n/**\n * Normalize value to linear [0, 1], return 0.5 if extent span is 0\n * @param {number} val\n * @return {number}\n */\n\n\nScale.prototype.normalize = function (val) {\n  var extent = this._extent;\n\n  if (extent[1] === extent[0]) {\n    return 0.5;\n  }\n\n  return (val - extent[0]) / (extent[1] - extent[0]);\n};\n/**\n * Scale normalized value\n * @param {number} val\n * @return {number}\n */\n\n\nScale.prototype.scale = function (val) {\n  var extent = this._extent;\n  return val * (extent[1] - extent[0]) + extent[0];\n};\n/**\n * Set extent from data\n * @param {Array.<number>} other\n */\n\n\nScale.prototype.unionExtent = function (other) {\n  var extent = this._extent;\n  other[0] < extent[0] && (extent[0] = other[0]);\n  other[1] > extent[1] && (extent[1] = other[1]); // not setExtent because in log axis it may transformed to power\n  // this.setExtent(extent[0], extent[1]);\n};\n/**\n * Set extent from data\n * @param {module:echarts/data/List} data\n * @param {string} dim\n */\n\n\nScale.prototype.unionExtentFromData = function (data, dim) {\n  this.unionExtent(data.getApproximateExtent(dim));\n};\n/**\n * Get extent\n * @return {Array.<number>}\n */\n\n\nScale.prototype.getExtent = function () {\n  return this._extent.slice();\n};\n/**\n * Set extent\n * @param {number} start\n * @param {number} end\n */\n\n\nScale.prototype.setExtent = function (start, end) {\n  var thisExtent = this._extent;\n\n  if (!isNaN(start)) {\n    thisExtent[0] = start;\n  }\n\n  if (!isNaN(end)) {\n    thisExtent[1] = end;\n  }\n};\n/**\n * When axis extent depends on data and no data exists,\n * axis ticks should not be drawn, which is named 'blank'.\n */\n\n\nScale.prototype.isBlank = function () {\n  return this._isBlank;\n},\n/**\n * When axis extent depends on data and no data exists,\n * axis ticks should not be drawn, which is named 'blank'.\n */\nScale.prototype.setBlank = function (isBlank) {\n  this._isBlank = isBlank;\n};\n/**\n * @abstract\n * @param {*} tick\n * @return {string} label of the tick.\n */\n\nScale.prototype.getLabel = null;\nenableClassExtend(Scale);\nenableClassManagement(Scale, {\n  registerWhenExtend: true\n});\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n/**\n * @constructor\n * @param {Object} [opt]\n * @param {Object} [opt.categories=[]]\n * @param {Object} [opt.needCollect=false]\n * @param {Object} [opt.deduplication=false]\n */\n\nfunction OrdinalMeta(opt) {\n  /**\n   * @readOnly\n   * @type {Array.<string>}\n   */\n  this.categories = opt.categories || [];\n  /**\n   * @private\n   * @type {boolean}\n   */\n\n  this._needCollect = opt.needCollect;\n  /**\n   * @private\n   * @type {boolean}\n   */\n\n  this._deduplication = opt.deduplication;\n  /**\n   * @private\n   * @type {boolean}\n   */\n\n  this._map;\n}\n/**\n * @param {module:echarts/model/Model} axisModel\n * @return {module:echarts/data/OrdinalMeta}\n */\n\n\nOrdinalMeta.createByAxisModel = function (axisModel) {\n  var option = axisModel.option;\n  var data = option.data;\n  var categories = data && map(data, getName);\n  return new OrdinalMeta({\n    categories: categories,\n    needCollect: !categories,\n    // deduplication is default in axis.\n    deduplication: option.dedplication !== false\n  });\n};\n\nvar proto$1 = OrdinalMeta.prototype;\n/**\n * @param {string} category\n * @return {number} ordinal\n */\n\nproto$1.getOrdinal = function (category) {\n  return getOrCreateMap(this).get(category);\n};\n/**\n * @param {*} category\n * @return {number} The ordinal. If not found, return NaN.\n */\n\n\nproto$1.parseAndCollect = function (category) {\n  var index;\n  var needCollect = this._needCollect; // The value of category dim can be the index of the given category set.\n  // This feature is only supported when !needCollect, because we should\n  // consider a common case: a value is 2017, which is a number but is\n  // expected to be tread as a category. This case usually happen in dataset,\n  // where it happent to be no need of the index feature.\n\n  if (typeof category !== 'string' && !needCollect) {\n    return category;\n  } // Optimize for the scenario:\n  // category is ['2012-01-01', '2012-01-02', ...], where the input\n  // data has been ensured not duplicate and is large data.\n  // Notice, if a dataset dimension provide categroies, usually echarts\n  // should remove duplication except user tell echarts dont do that\n  // (set axis.deduplication = false), because echarts do not know whether\n  // the values in the category dimension has duplication (consider the\n  // parallel-aqi example)\n\n\n  if (needCollect && !this._deduplication) {\n    index = this.categories.length;\n    this.categories[index] = category;\n    return index;\n  }\n\n  var map$$1 = getOrCreateMap(this);\n  index = map$$1.get(category);\n\n  if (index == null) {\n    if (needCollect) {\n      index = this.categories.length;\n      this.categories[index] = category;\n      map$$1.set(category, index);\n    } else {\n      index = NaN;\n    }\n  }\n\n  return index;\n}; // Consider big data, do not create map until needed.\n\n\nfunction getOrCreateMap(ordinalMeta) {\n  return ordinalMeta._map || (ordinalMeta._map = createHashMap(ordinalMeta.categories));\n}\n\nfunction getName(obj) {\n  if (isObject$1(obj) && obj.value != null) {\n    return obj.value;\n  } else {\n    return obj + '';\n  }\n}\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * Linear continuous scale\n * @module echarts/coord/scale/Ordinal\n *\n * http://en.wikipedia.org/wiki/Level_of_measurement\n */\n// FIXME only one data\nvar scaleProto = Scale.prototype;\nvar OrdinalScale = Scale.extend({\n  type: 'ordinal',\n\n  /**\n   * @param {module:echarts/data/OrdianlMeta|Array.<string>} ordinalMeta\n   */\n  init: function (ordinalMeta, extent) {\n    // Caution: Should not use instanceof, consider ec-extensions using\n    // import approach to get OrdinalMeta class.\n    if (!ordinalMeta || isArray(ordinalMeta)) {\n      ordinalMeta = new OrdinalMeta({\n        categories: ordinalMeta\n      });\n    }\n\n    this._ordinalMeta = ordinalMeta;\n    this._extent = extent || [0, ordinalMeta.categories.length - 1];\n  },\n  parse: function (val) {\n    return typeof val === 'string' ? this._ordinalMeta.getOrdinal(val) // val might be float.\n    : Math.round(val);\n  },\n  contain: function (rank) {\n    rank = this.parse(rank);\n    return scaleProto.contain.call(this, rank) && this._ordinalMeta.categories[rank] != null;\n  },\n\n  /**\n   * Normalize given rank or name to linear [0, 1]\n   * @param {number|string} [val]\n   * @return {number}\n   */\n  normalize: function (val) {\n    return scaleProto.normalize.call(this, this.parse(val));\n  },\n  scale: function (val) {\n    return Math.round(scaleProto.scale.call(this, val));\n  },\n\n  /**\n   * @return {Array}\n   */\n  getTicks: function () {\n    var ticks = [];\n    var extent = this._extent;\n    var rank = extent[0];\n\n    while (rank <= extent[1]) {\n      ticks.push(rank);\n      rank++;\n    }\n\n    return ticks;\n  },\n\n  /**\n   * Get item on rank n\n   * @param {number} n\n   * @return {string}\n   */\n  getLabel: function (n) {\n    if (!this.isBlank()) {\n      // Note that if no data, ordinalMeta.categories is an empty array.\n      return this._ordinalMeta.categories[n];\n    }\n  },\n\n  /**\n   * @return {number}\n   */\n  count: function () {\n    return this._extent[1] - this._extent[0] + 1;\n  },\n\n  /**\n   * @override\n   */\n  unionExtentFromData: function (data, dim) {\n    this.unionExtent(data.getApproximateExtent(dim));\n  },\n  getOrdinalMeta: function () {\n    return this._ordinalMeta;\n  },\n  niceTicks: noop,\n  niceExtent: noop\n});\n/**\n * @return {module:echarts/scale/Time}\n */\n\nOrdinalScale.create = function () {\n  return new OrdinalScale();\n};\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * For testable.\n */\nvar roundNumber$1 = round$1;\n/**\n * @param {Array.<number>} extent Both extent[0] and extent[1] should be valid number.\n *                                Should be extent[0] < extent[1].\n * @param {number} splitNumber splitNumber should be >= 1.\n * @param {number} [minInterval]\n * @param {number} [maxInterval]\n * @return {Object} {interval, intervalPrecision, niceTickExtent}\n */\n\nfunction intervalScaleNiceTicks(extent, splitNumber, minInterval, maxInterval) {\n  var result = {};\n  var span = extent[1] - extent[0];\n  var interval = result.interval = nice(span / splitNumber, true);\n\n  if (minInterval != null && interval < minInterval) {\n    interval = result.interval = minInterval;\n  }\n\n  if (maxInterval != null && interval > maxInterval) {\n    interval = result.interval = maxInterval;\n  } // Tow more digital for tick.\n\n\n  var precision = result.intervalPrecision = getIntervalPrecision(interval); // Niced extent inside original extent\n\n  var niceTickExtent = result.niceTickExtent = [roundNumber$1(Math.ceil(extent[0] / interval) * interval, precision), roundNumber$1(Math.floor(extent[1] / interval) * interval, precision)];\n  fixExtent(niceTickExtent, extent);\n  return result;\n}\n/**\n * @param {number} interval\n * @return {number} interval precision\n */\n\nfunction getIntervalPrecision(interval) {\n  // Tow more digital for tick.\n  return getPrecisionSafe(interval) + 2;\n}\n\nfunction clamp(niceTickExtent, idx, extent) {\n  niceTickExtent[idx] = Math.max(Math.min(niceTickExtent[idx], extent[1]), extent[0]);\n} // In some cases (e.g., splitNumber is 1), niceTickExtent may be out of extent.\n\n\nfunction fixExtent(niceTickExtent, extent) {\n  !isFinite(niceTickExtent[0]) && (niceTickExtent[0] = extent[0]);\n  !isFinite(niceTickExtent[1]) && (niceTickExtent[1] = extent[1]);\n  clamp(niceTickExtent, 0, extent);\n  clamp(niceTickExtent, 1, extent);\n\n  if (niceTickExtent[0] > niceTickExtent[1]) {\n    niceTickExtent[0] = niceTickExtent[1];\n  }\n}\nfunction intervalScaleGetTicks(interval, extent, niceTickExtent, intervalPrecision) {\n  var ticks = []; // If interval is 0, return [];\n\n  if (!interval) {\n    return ticks;\n  } // Consider this case: using dataZoom toolbox, zoom and zoom.\n\n\n  var safeLimit = 10000;\n\n  if (extent[0] < niceTickExtent[0]) {\n    ticks.push(extent[0]);\n  }\n\n  var tick = niceTickExtent[0];\n\n  while (tick <= niceTickExtent[1]) {\n    ticks.push(tick); // Avoid rounding error\n\n    tick = roundNumber$1(tick + interval, intervalPrecision);\n\n    if (tick === ticks[ticks.length - 1]) {\n      // Consider out of safe float point, e.g.,\n      // -3711126.9907707 + 2e-10 === -3711126.9907707\n      break;\n    }\n\n    if (ticks.length > safeLimit) {\n      return [];\n    }\n  } // Consider this case: the last item of ticks is smaller\n  // than niceTickExtent[1] and niceTickExtent[1] === extent[1].\n\n\n  if (extent[1] > (ticks.length ? ticks[ticks.length - 1] : niceTickExtent[1])) {\n    ticks.push(extent[1]);\n  }\n\n  return ticks;\n}\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * Interval scale\n * @module echarts/scale/Interval\n */\nvar roundNumber = round$1;\n/**\n * @alias module:echarts/coord/scale/Interval\n * @constructor\n */\n\nvar IntervalScale = Scale.extend({\n  type: 'interval',\n  _interval: 0,\n  _intervalPrecision: 2,\n  setExtent: function (start, end) {\n    var thisExtent = this._extent; //start,end may be a Number like '25',so...\n\n    if (!isNaN(start)) {\n      thisExtent[0] = parseFloat(start);\n    }\n\n    if (!isNaN(end)) {\n      thisExtent[1] = parseFloat(end);\n    }\n  },\n  unionExtent: function (other) {\n    var extent = this._extent;\n    other[0] < extent[0] && (extent[0] = other[0]);\n    other[1] > extent[1] && (extent[1] = other[1]); // unionExtent may called by it's sub classes\n\n    IntervalScale.prototype.setExtent.call(this, extent[0], extent[1]);\n  },\n\n  /**\n   * Get interval\n   */\n  getInterval: function () {\n    return this._interval;\n  },\n\n  /**\n   * Set interval\n   */\n  setInterval: function (interval) {\n    this._interval = interval; // Dropped auto calculated niceExtent and use user setted extent\n    // We assume user wan't to set both interval, min, max to get a better result\n\n    this._niceExtent = this._extent.slice();\n    this._intervalPrecision = getIntervalPrecision(interval);\n  },\n\n  /**\n   * @return {Array.<number>}\n   */\n  getTicks: function () {\n    return intervalScaleGetTicks(this._interval, this._extent, this._niceExtent, this._intervalPrecision);\n  },\n\n  /**\n   * @param {number} data\n   * @param {Object} [opt]\n   * @param {number|string} [opt.precision] If 'auto', use nice presision.\n   * @param {boolean} [opt.pad] returns 1.50 but not 1.5 if precision is 2.\n   * @return {string}\n   */\n  getLabel: function (data, opt) {\n    if (data == null) {\n      return '';\n    }\n\n    var precision = opt && opt.precision;\n\n    if (precision == null) {\n      precision = getPrecisionSafe(data) || 0;\n    } else if (precision === 'auto') {\n      // Should be more precise then tick.\n      precision = this._intervalPrecision;\n    } // (1) If `precision` is set, 12.005 should be display as '12.00500'.\n    // (2) Use roundNumber (toFixed) to avoid scientific notation like '3.5e-7'.\n\n\n    data = roundNumber(data, precision, true);\n    return addCommas(data);\n  },\n\n  /**\n   * Update interval and extent of intervals for nice ticks\n   *\n   * @param {number} [splitNumber = 5] Desired number of ticks\n   * @param {number} [minInterval]\n   * @param {number} [maxInterval]\n   */\n  niceTicks: function (splitNumber, minInterval, maxInterval) {\n    splitNumber = splitNumber || 5;\n    var extent = this._extent;\n    var span = extent[1] - extent[0];\n\n    if (!isFinite(span)) {\n      return;\n    } // User may set axis min 0 and data are all negative\n    // FIXME If it needs to reverse ?\n\n\n    if (span < 0) {\n      span = -span;\n      extent.reverse();\n    }\n\n    var result = intervalScaleNiceTicks(extent, splitNumber, minInterval, maxInterval);\n    this._intervalPrecision = result.intervalPrecision;\n    this._interval = result.interval;\n    this._niceExtent = result.niceTickExtent;\n  },\n\n  /**\n   * Nice extent.\n   * @param {Object} opt\n   * @param {number} [opt.splitNumber = 5] Given approx tick number\n   * @param {boolean} [opt.fixMin=false]\n   * @param {boolean} [opt.fixMax=false]\n   * @param {boolean} [opt.minInterval]\n   * @param {boolean} [opt.maxInterval]\n   */\n  niceExtent: function (opt) {\n    var extent = this._extent; // If extent start and end are same, expand them\n\n    if (extent[0] === extent[1]) {\n      if (extent[0] !== 0) {\n        // Expand extent\n        var expandSize = extent[0]; // In the fowllowing case\n        //      Axis has been fixed max 100\n        //      Plus data are all 100 and axis extent are [100, 100].\n        // Extend to the both side will cause expanded max is larger than fixed max.\n        // So only expand to the smaller side.\n\n        if (!opt.fixMax) {\n          extent[1] += expandSize / 2;\n          extent[0] -= expandSize / 2;\n        } else {\n          extent[0] -= expandSize / 2;\n        }\n      } else {\n        extent[1] = 1;\n      }\n    }\n\n    var span = extent[1] - extent[0]; // If there are no data and extent are [Infinity, -Infinity]\n\n    if (!isFinite(span)) {\n      extent[0] = 0;\n      extent[1] = 1;\n    }\n\n    this.niceTicks(opt.splitNumber, opt.minInterval, opt.maxInterval); // var extent = this._extent;\n\n    var interval = this._interval;\n\n    if (!opt.fixMin) {\n      extent[0] = roundNumber(Math.floor(extent[0] / interval) * interval);\n    }\n\n    if (!opt.fixMax) {\n      extent[1] = roundNumber(Math.ceil(extent[1] / interval) * interval);\n    }\n  }\n});\n/**\n * @return {module:echarts/scale/Time}\n */\n\nIntervalScale.create = function () {\n  return new IntervalScale();\n};\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar STACK_PREFIX = '__ec_stack_';\nvar LARGE_BAR_MIN_WIDTH = 0.5;\nvar LargeArr = typeof Float32Array !== 'undefined' ? Float32Array : Array;\n\nfunction getSeriesStackId(seriesModel) {\n  return seriesModel.get('stack') || STACK_PREFIX + seriesModel.seriesIndex;\n}\n\nfunction getAxisKey(axis) {\n  return axis.dim + axis.index;\n}\n/**\n * @param {Object} opt\n * @param {module:echarts/coord/Axis} opt.axis Only support category axis currently.\n * @param {number} opt.count Positive interger.\n * @param {number} [opt.barWidth]\n * @param {number} [opt.barMaxWidth]\n * @param {number} [opt.barGap]\n * @param {number} [opt.barCategoryGap]\n * @return {Object} {width, offset, offsetCenter} If axis.type is not 'category', return undefined.\n */\n\n\n\nfunction prepareLayoutBarSeries(seriesType, ecModel) {\n  var seriesModels = [];\n  ecModel.eachSeriesByType(seriesType, function (seriesModel) {\n    // Check series coordinate, do layout for cartesian2d only\n    if (isOnCartesian(seriesModel) && !isInLargeMode(seriesModel)) {\n      seriesModels.push(seriesModel);\n    }\n  });\n  return seriesModels;\n}\nfunction makeColumnLayout(barSeries) {\n  var seriesInfoList = [];\n  each$1(barSeries, function (seriesModel) {\n    var data = seriesModel.getData();\n    var cartesian = seriesModel.coordinateSystem;\n    var baseAxis = cartesian.getBaseAxis();\n    var axisExtent = baseAxis.getExtent();\n    var bandWidth = baseAxis.type === 'category' ? baseAxis.getBandWidth() : Math.abs(axisExtent[1] - axisExtent[0]) / data.count();\n    var barWidth = parsePercent$1(seriesModel.get('barWidth'), bandWidth);\n    var barMaxWidth = parsePercent$1(seriesModel.get('barMaxWidth'), bandWidth);\n    var barGap = seriesModel.get('barGap');\n    var barCategoryGap = seriesModel.get('barCategoryGap');\n    seriesInfoList.push({\n      bandWidth: bandWidth,\n      barWidth: barWidth,\n      barMaxWidth: barMaxWidth,\n      barGap: barGap,\n      barCategoryGap: barCategoryGap,\n      axisKey: getAxisKey(baseAxis),\n      stackId: getSeriesStackId(seriesModel)\n    });\n  });\n  return doCalBarWidthAndOffset(seriesInfoList);\n}\n\nfunction doCalBarWidthAndOffset(seriesInfoList) {\n  // Columns info on each category axis. Key is cartesian name\n  var columnsMap = {};\n  each$1(seriesInfoList, function (seriesInfo, idx) {\n    var axisKey = seriesInfo.axisKey;\n    var bandWidth = seriesInfo.bandWidth;\n    var columnsOnAxis = columnsMap[axisKey] || {\n      bandWidth: bandWidth,\n      remainedWidth: bandWidth,\n      autoWidthCount: 0,\n      categoryGap: '20%',\n      gap: '30%',\n      stacks: {}\n    };\n    var stacks = columnsOnAxis.stacks;\n    columnsMap[axisKey] = columnsOnAxis;\n    var stackId = seriesInfo.stackId;\n\n    if (!stacks[stackId]) {\n      columnsOnAxis.autoWidthCount++;\n    }\n\n    stacks[stackId] = stacks[stackId] || {\n      width: 0,\n      maxWidth: 0\n    }; // Caution: In a single coordinate system, these barGrid attributes\n    // will be shared by series. Consider that they have default values,\n    // only the attributes set on the last series will work.\n    // Do not change this fact unless there will be a break change.\n    // TODO\n\n    var barWidth = seriesInfo.barWidth;\n\n    if (barWidth && !stacks[stackId].width) {\n      // See #6312, do not restrict width.\n      stacks[stackId].width = barWidth;\n      barWidth = Math.min(columnsOnAxis.remainedWidth, barWidth);\n      columnsOnAxis.remainedWidth -= barWidth;\n    }\n\n    var barMaxWidth = seriesInfo.barMaxWidth;\n    barMaxWidth && (stacks[stackId].maxWidth = barMaxWidth);\n    var barGap = seriesInfo.barGap;\n    barGap != null && (columnsOnAxis.gap = barGap);\n    var barCategoryGap = seriesInfo.barCategoryGap;\n    barCategoryGap != null && (columnsOnAxis.categoryGap = barCategoryGap);\n  });\n  var result = {};\n  each$1(columnsMap, function (columnsOnAxis, coordSysName) {\n    result[coordSysName] = {};\n    var stacks = columnsOnAxis.stacks;\n    var bandWidth = columnsOnAxis.bandWidth;\n    var categoryGap = parsePercent$1(columnsOnAxis.categoryGap, bandWidth);\n    var barGapPercent = parsePercent$1(columnsOnAxis.gap, 1);\n    var remainedWidth = columnsOnAxis.remainedWidth;\n    var autoWidthCount = columnsOnAxis.autoWidthCount;\n    var autoWidth = (remainedWidth - categoryGap) / (autoWidthCount + (autoWidthCount - 1) * barGapPercent);\n    autoWidth = Math.max(autoWidth, 0); // Find if any auto calculated bar exceeded maxBarWidth\n\n    each$1(stacks, function (column, stack) {\n      var maxWidth = column.maxWidth;\n\n      if (maxWidth && maxWidth < autoWidth) {\n        maxWidth = Math.min(maxWidth, remainedWidth);\n\n        if (column.width) {\n          maxWidth = Math.min(maxWidth, column.width);\n        }\n\n        remainedWidth -= maxWidth;\n        column.width = maxWidth;\n        autoWidthCount--;\n      }\n    }); // Recalculate width again\n\n    autoWidth = (remainedWidth - categoryGap) / (autoWidthCount + (autoWidthCount - 1) * barGapPercent);\n    autoWidth = Math.max(autoWidth, 0);\n    var widthSum = 0;\n    var lastColumn;\n    each$1(stacks, function (column, idx) {\n      if (!column.width) {\n        column.width = autoWidth;\n      }\n\n      lastColumn = column;\n      widthSum += column.width * (1 + barGapPercent);\n    });\n\n    if (lastColumn) {\n      widthSum -= lastColumn.width * barGapPercent;\n    }\n\n    var offset = -widthSum / 2;\n    each$1(stacks, function (column, stackId) {\n      result[coordSysName][stackId] = result[coordSysName][stackId] || {\n        offset: offset,\n        width: column.width\n      };\n      offset += column.width * (1 + barGapPercent);\n    });\n  });\n  return result;\n}\n/**\n * @param {Object} barWidthAndOffset The result of makeColumnLayout\n * @param {module:echarts/coord/Axis} axis\n * @param {module:echarts/model/Series} [seriesModel] If not provided, return all.\n * @return {Object} {stackId: {offset, width}} or {offset, width} if seriesModel provided.\n */\n\n\nfunction retrieveColumnLayout(barWidthAndOffset, axis, seriesModel) {\n  if (barWidthAndOffset && axis) {\n    var result = barWidthAndOffset[getAxisKey(axis)];\n\n    if (result != null && seriesModel != null) {\n      result = result[getSeriesStackId(seriesModel)];\n    }\n\n    return result;\n  }\n}\n/**\n * @param {string} seriesType\n * @param {module:echarts/model/Global} ecModel\n */\n\nfunction layout(seriesType, ecModel) {\n  var seriesModels = prepareLayoutBarSeries(seriesType, ecModel);\n  var barWidthAndOffset = makeColumnLayout(seriesModels);\n  var lastStackCoords = {};\n  each$1(seriesModels, function (seriesModel) {\n    var data = seriesModel.getData();\n    var cartesian = seriesModel.coordinateSystem;\n    var baseAxis = cartesian.getBaseAxis();\n    var stackId = getSeriesStackId(seriesModel);\n    var columnLayoutInfo = barWidthAndOffset[getAxisKey(baseAxis)][stackId];\n    var columnOffset = columnLayoutInfo.offset;\n    var columnWidth = columnLayoutInfo.width;\n    var valueAxis = cartesian.getOtherAxis(baseAxis);\n    var barMinHeight = seriesModel.get('barMinHeight') || 0;\n    lastStackCoords[stackId] = lastStackCoords[stackId] || [];\n    data.setLayout({\n      offset: columnOffset,\n      size: columnWidth\n    });\n    var valueDim = data.mapDimension(valueAxis.dim);\n    var baseDim = data.mapDimension(baseAxis.dim);\n    var stacked = isDimensionStacked(data, valueDim\n    /*, baseDim*/\n    );\n    var isValueAxisH = valueAxis.isHorizontal();\n    var valueAxisStart = getValueAxisStart(baseAxis, valueAxis, stacked);\n\n    for (var idx = 0, len = data.count(); idx < len; idx++) {\n      var value = data.get(valueDim, idx);\n      var baseValue = data.get(baseDim, idx);\n\n      if (isNaN(value)) {\n        continue;\n      }\n\n      var sign = value >= 0 ? 'p' : 'n';\n      var baseCoord = valueAxisStart; // Because of the barMinHeight, we can not use the value in\n      // stackResultDimension directly.\n\n      if (stacked) {\n        // Only ordinal axis can be stacked.\n        if (!lastStackCoords[stackId][baseValue]) {\n          lastStackCoords[stackId][baseValue] = {\n            p: valueAxisStart,\n            // Positive stack\n            n: valueAxisStart // Negative stack\n\n          };\n        } // Should also consider #4243\n\n\n        baseCoord = lastStackCoords[stackId][baseValue][sign];\n      }\n\n      var x;\n      var y;\n      var width;\n      var height;\n\n      if (isValueAxisH) {\n        var coord = cartesian.dataToPoint([value, baseValue]);\n        x = baseCoord;\n        y = coord[1] + columnOffset;\n        width = coord[0] - valueAxisStart;\n        height = columnWidth;\n\n        if (Math.abs(width) < barMinHeight) {\n          width = (width < 0 ? -1 : 1) * barMinHeight;\n        }\n\n        stacked && (lastStackCoords[stackId][baseValue][sign] += width);\n      } else {\n        var coord = cartesian.dataToPoint([baseValue, value]);\n        x = coord[0] + columnOffset;\n        y = baseCoord;\n        width = columnWidth;\n        height = coord[1] - valueAxisStart;\n\n        if (Math.abs(height) < barMinHeight) {\n          // Include zero to has a positive bar\n          height = (height <= 0 ? -1 : 1) * barMinHeight;\n        }\n\n        stacked && (lastStackCoords[stackId][baseValue][sign] += height);\n      }\n\n      data.setItemLayout(idx, {\n        x: x,\n        y: y,\n        width: width,\n        height: height\n      });\n    }\n  }, this);\n} // TODO: Do not support stack in large mode yet.\n\nvar largeLayout = {\n  seriesType: 'bar',\n  plan: createRenderPlanner(),\n  reset: function (seriesModel) {\n    if (!isOnCartesian(seriesModel) || !isInLargeMode(seriesModel)) {\n      return;\n    }\n\n    var data = seriesModel.getData();\n    var cartesian = seriesModel.coordinateSystem;\n    var baseAxis = cartesian.getBaseAxis();\n    var valueAxis = cartesian.getOtherAxis(baseAxis);\n    var valueDim = data.mapDimension(valueAxis.dim);\n    var baseDim = data.mapDimension(baseAxis.dim);\n    var valueAxisHorizontal = valueAxis.isHorizontal();\n    var valueDimIdx = valueAxisHorizontal ? 0 : 1;\n    var barWidth = retrieveColumnLayout(makeColumnLayout([seriesModel]), baseAxis, seriesModel).width;\n\n    if (!(barWidth > LARGE_BAR_MIN_WIDTH)) {\n      // jshint ignore:line\n      barWidth = LARGE_BAR_MIN_WIDTH;\n    }\n\n    return {\n      progress: progress\n    };\n\n    function progress(params, data) {\n      var largePoints = new LargeArr(params.count * 2);\n      var dataIndex;\n      var coord = [];\n      var valuePair = [];\n      var offset = 0;\n\n      while ((dataIndex = params.next()) != null) {\n        valuePair[valueDimIdx] = data.get(valueDim, dataIndex);\n        valuePair[1 - valueDimIdx] = data.get(baseDim, dataIndex);\n        coord = cartesian.dataToPoint(valuePair, null, coord);\n        largePoints[offset++] = coord[0];\n        largePoints[offset++] = coord[1];\n      }\n\n      data.setLayout({\n        largePoints: largePoints,\n        barWidth: barWidth,\n        valueAxisStart: getValueAxisStart(baseAxis, valueAxis, false),\n        valueAxisHorizontal: valueAxisHorizontal\n      });\n    }\n  }\n};\n\nfunction isOnCartesian(seriesModel) {\n  return seriesModel.coordinateSystem && seriesModel.coordinateSystem.type === 'cartesian2d';\n}\n\nfunction isInLargeMode(seriesModel) {\n  return seriesModel.pipelineContext && seriesModel.pipelineContext.large;\n}\n\nfunction getValueAxisStart(baseAxis, valueAxis, stacked) {\n  return indexOf(baseAxis.getAxesOnZeroOf(), valueAxis) >= 0 || stacked ? valueAxis.toGlobalCoord(valueAxis.dataToCoord(0)) : valueAxis.getGlobalExtent()[0];\n}\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/*\n* The `scaleLevels` references to d3.js. The use of the source\n* code of this file is also subject to the terms and consitions\n* of its license (BSD-3Clause, see <echarts/src/licenses/LICENSE-d3>).\n*/\n// [About UTC and local time zone]:\n// In most cases, `number.parseDate` will treat input data string as local time\n// (except time zone is specified in time string). And `format.formateTime` returns\n// local time by default. option.useUTC is false by default. This design have\n// concidered these common case:\n// (1) Time that is persistent in server is in UTC, but it is needed to be diplayed\n// in local time by default.\n// (2) By default, the input data string (e.g., '2011-01-02') should be displayed\n// as its original time, without any time difference.\nvar intervalScaleProto = IntervalScale.prototype;\nvar mathCeil = Math.ceil;\nvar mathFloor = Math.floor;\nvar ONE_SECOND = 1000;\nvar ONE_MINUTE = ONE_SECOND * 60;\nvar ONE_HOUR = ONE_MINUTE * 60;\nvar ONE_DAY = ONE_HOUR * 24; // FIXME \n\nvar bisect = function (a, x, lo, hi) {\n  while (lo < hi) {\n    var mid = lo + hi >>> 1;\n\n    if (a[mid][1] < x) {\n      lo = mid + 1;\n    } else {\n      hi = mid;\n    }\n  }\n\n  return lo;\n};\n/**\n * @alias module:echarts/coord/scale/Time\n * @constructor\n */\n\n\nvar TimeScale = IntervalScale.extend({\n  type: 'time',\n\n  /**\n   * @override\n   */\n  getLabel: function (val) {\n    var stepLvl = this._stepLvl;\n    var date = new Date(val);\n    return formatTime(stepLvl[0], date, this.getSetting('useUTC'));\n  },\n\n  /**\n   * @override\n   */\n  niceExtent: function (opt) {\n    var extent = this._extent; // If extent start and end are same, expand them\n\n    if (extent[0] === extent[1]) {\n      // Expand extent\n      extent[0] -= ONE_DAY;\n      extent[1] += ONE_DAY;\n    } // If there are no data and extent are [Infinity, -Infinity]\n\n\n    if (extent[1] === -Infinity && extent[0] === Infinity) {\n      var d = new Date();\n      extent[1] = +new Date(d.getFullYear(), d.getMonth(), d.getDate());\n      extent[0] = extent[1] - ONE_DAY;\n    }\n\n    this.niceTicks(opt.splitNumber, opt.minInterval, opt.maxInterval); // var extent = this._extent;\n\n    var interval = this._interval;\n\n    if (!opt.fixMin) {\n      extent[0] = round$1(mathFloor(extent[0] / interval) * interval);\n    }\n\n    if (!opt.fixMax) {\n      extent[1] = round$1(mathCeil(extent[1] / interval) * interval);\n    }\n  },\n\n  /**\n   * @override\n   */\n  niceTicks: function (approxTickNum, minInterval, maxInterval) {\n    approxTickNum = approxTickNum || 10;\n    var extent = this._extent;\n    var span = extent[1] - extent[0];\n    var approxInterval = span / approxTickNum;\n\n    if (minInterval != null && approxInterval < minInterval) {\n      approxInterval = minInterval;\n    }\n\n    if (maxInterval != null && approxInterval > maxInterval) {\n      approxInterval = maxInterval;\n    }\n\n    var scaleLevelsLen = scaleLevels.length;\n    var idx = bisect(scaleLevels, approxInterval, 0, scaleLevelsLen);\n    var level = scaleLevels[Math.min(idx, scaleLevelsLen - 1)];\n    var interval = level[1]; // Same with interval scale if span is much larger than 1 year\n\n    if (level[0] === 'year') {\n      var yearSpan = span / interval; // From \"Nice Numbers for Graph Labels\" of Graphic Gems\n      // var niceYearSpan = numberUtil.nice(yearSpan, false);\n\n      var yearStep = nice(yearSpan / approxTickNum, true);\n      interval *= yearStep;\n    }\n\n    var timezoneOffset = this.getSetting('useUTC') ? 0 : new Date(+extent[0] || +extent[1]).getTimezoneOffset() * 60 * 1000;\n    var niceExtent = [Math.round(mathCeil((extent[0] - timezoneOffset) / interval) * interval + timezoneOffset), Math.round(mathFloor((extent[1] - timezoneOffset) / interval) * interval + timezoneOffset)];\n    fixExtent(niceExtent, extent);\n    this._stepLvl = level; // Interval will be used in getTicks\n\n    this._interval = interval;\n    this._niceExtent = niceExtent;\n  },\n  parse: function (val) {\n    // val might be float.\n    return +parseDate(val);\n  }\n});\neach$1(['contain', 'normalize'], function (methodName) {\n  TimeScale.prototype[methodName] = function (val) {\n    return intervalScaleProto[methodName].call(this, this.parse(val));\n  };\n}); // Steps from d3, see the license statement at the top of this file.\n\nvar scaleLevels = [// Format              interval\n['hh:mm:ss', ONE_SECOND], // 1s\n['hh:mm:ss', ONE_SECOND * 5], // 5s\n['hh:mm:ss', ONE_SECOND * 10], // 10s\n['hh:mm:ss', ONE_SECOND * 15], // 15s\n['hh:mm:ss', ONE_SECOND * 30], // 30s\n['hh:mm\\nMM-dd', ONE_MINUTE], // 1m\n['hh:mm\\nMM-dd', ONE_MINUTE * 5], // 5m\n['hh:mm\\nMM-dd', ONE_MINUTE * 10], // 10m\n['hh:mm\\nMM-dd', ONE_MINUTE * 15], // 15m\n['hh:mm\\nMM-dd', ONE_MINUTE * 30], // 30m\n['hh:mm\\nMM-dd', ONE_HOUR], // 1h\n['hh:mm\\nMM-dd', ONE_HOUR * 2], // 2h\n['hh:mm\\nMM-dd', ONE_HOUR * 6], // 6h\n['hh:mm\\nMM-dd', ONE_HOUR * 12], // 12h\n['MM-dd\\nyyyy', ONE_DAY], // 1d\n['MM-dd\\nyyyy', ONE_DAY * 2], // 2d\n['MM-dd\\nyyyy', ONE_DAY * 3], // 3d\n['MM-dd\\nyyyy', ONE_DAY * 4], // 4d\n['MM-dd\\nyyyy', ONE_DAY * 5], // 5d\n['MM-dd\\nyyyy', ONE_DAY * 6], // 6d\n['week', ONE_DAY * 7], // 7d\n['MM-dd\\nyyyy', ONE_DAY * 10], // 10d\n['week', ONE_DAY * 14], // 2w\n['week', ONE_DAY * 21], // 3w\n['month', ONE_DAY * 31], // 1M\n['week', ONE_DAY * 42], // 6w\n['month', ONE_DAY * 62], // 2M\n['week', ONE_DAY * 42], // 10w\n['quarter', ONE_DAY * 380 / 4], // 3M\n['month', ONE_DAY * 31 * 4], // 4M\n['month', ONE_DAY * 31 * 5], // 5M\n['half-year', ONE_DAY * 380 / 2], // 6M\n['month', ONE_DAY * 31 * 8], // 8M\n['month', ONE_DAY * 31 * 10], // 10M\n['year', ONE_DAY * 380] // 1Y\n];\n/**\n * @param {module:echarts/model/Model}\n * @return {module:echarts/scale/Time}\n */\n\nTimeScale.create = function (model) {\n  return new TimeScale({\n    useUTC: model.ecModel.get('useUTC')\n  });\n};\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * Log scale\n * @module echarts/scale/Log\n */\nvar scaleProto$1 = Scale.prototype;\nvar intervalScaleProto$1 = IntervalScale.prototype;\nvar getPrecisionSafe$1 = getPrecisionSafe;\nvar roundingErrorFix = round$1;\nvar mathFloor$1 = Math.floor;\nvar mathCeil$1 = Math.ceil;\nvar mathPow$1 = Math.pow;\nvar mathLog = Math.log;\nvar LogScale = Scale.extend({\n  type: 'log',\n  base: 10,\n  $constructor: function () {\n    Scale.apply(this, arguments);\n    this._originalScale = new IntervalScale();\n  },\n\n  /**\n   * @return {Array.<number>}\n   */\n  getTicks: function () {\n    var originalScale = this._originalScale;\n    var extent = this._extent;\n    var originalExtent = originalScale.getExtent();\n    return map(intervalScaleProto$1.getTicks.call(this), function (val) {\n      var powVal = round$1(mathPow$1(this.base, val)); // Fix #4158\n\n      powVal = val === extent[0] && originalScale.__fixMin ? fixRoundingError(powVal, originalExtent[0]) : powVal;\n      powVal = val === extent[1] && originalScale.__fixMax ? fixRoundingError(powVal, originalExtent[1]) : powVal;\n      return powVal;\n    }, this);\n  },\n\n  /**\n   * @param {number} val\n   * @return {string}\n   */\n  getLabel: intervalScaleProto$1.getLabel,\n\n  /**\n   * @param  {number} val\n   * @return {number}\n   */\n  scale: function (val) {\n    val = scaleProto$1.scale.call(this, val);\n    return mathPow$1(this.base, val);\n  },\n\n  /**\n   * @param {number} start\n   * @param {number} end\n   */\n  setExtent: function (start, end) {\n    var base = this.base;\n    start = mathLog(start) / mathLog(base);\n    end = mathLog(end) / mathLog(base);\n    intervalScaleProto$1.setExtent.call(this, start, end);\n  },\n\n  /**\n   * @return {number} end\n   */\n  getExtent: function () {\n    var base = this.base;\n    var extent = scaleProto$1.getExtent.call(this);\n    extent[0] = mathPow$1(base, extent[0]);\n    extent[1] = mathPow$1(base, extent[1]); // Fix #4158\n\n    var originalScale = this._originalScale;\n    var originalExtent = originalScale.getExtent();\n    originalScale.__fixMin && (extent[0] = fixRoundingError(extent[0], originalExtent[0]));\n    originalScale.__fixMax && (extent[1] = fixRoundingError(extent[1], originalExtent[1]));\n    return extent;\n  },\n\n  /**\n   * @param  {Array.<number>} extent\n   */\n  unionExtent: function (extent) {\n    this._originalScale.unionExtent(extent);\n\n    var base = this.base;\n    extent[0] = mathLog(extent[0]) / mathLog(base);\n    extent[1] = mathLog(extent[1]) / mathLog(base);\n    scaleProto$1.unionExtent.call(this, extent);\n  },\n\n  /**\n   * @override\n   */\n  unionExtentFromData: function (data, dim) {\n    // TODO\n    // filter value that <= 0\n    this.unionExtent(data.getApproximateExtent(dim));\n  },\n\n  /**\n   * Update interval and extent of intervals for nice ticks\n   * @param  {number} [approxTickNum = 10] Given approx tick number\n   */\n  niceTicks: function (approxTickNum) {\n    approxTickNum = approxTickNum || 10;\n    var extent = this._extent;\n    var span = extent[1] - extent[0];\n\n    if (span === Infinity || span <= 0) {\n      return;\n    }\n\n    var interval = quantity(span);\n    var err = approxTickNum / span * interval; // Filter ticks to get closer to the desired count.\n\n    if (err <= 0.5) {\n      interval *= 10;\n    } // Interval should be integer\n\n\n    while (!isNaN(interval) && Math.abs(interval) < 1 && Math.abs(interval) > 0) {\n      interval *= 10;\n    }\n\n    var niceExtent = [round$1(mathCeil$1(extent[0] / interval) * interval), round$1(mathFloor$1(extent[1] / interval) * interval)];\n    this._interval = interval;\n    this._niceExtent = niceExtent;\n  },\n\n  /**\n   * Nice extent.\n   * @override\n   */\n  niceExtent: function (opt) {\n    intervalScaleProto$1.niceExtent.call(this, opt);\n    var originalScale = this._originalScale;\n    originalScale.__fixMin = opt.fixMin;\n    originalScale.__fixMax = opt.fixMax;\n  }\n});\neach$1(['contain', 'normalize'], function (methodName) {\n  LogScale.prototype[methodName] = function (val) {\n    val = mathLog(val) / mathLog(this.base);\n    return scaleProto$1[methodName].call(this, val);\n  };\n});\n\nLogScale.create = function () {\n  return new LogScale();\n};\n\nfunction fixRoundingError(val, originalVal) {\n  return roundingErrorFix(val, getPrecisionSafe$1(originalVal));\n}\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n/**\n * Get axis scale extent before niced.\n * Item of returned array can only be number (including Infinity and NaN).\n */\n\nfunction getScaleExtent(scale, model) {\n  var scaleType = scale.type;\n  var min = model.getMin();\n  var max = model.getMax();\n  var fixMin = min != null;\n  var fixMax = max != null;\n  var originalExtent = scale.getExtent();\n  var axisDataLen;\n  var boundaryGap;\n  var span;\n\n  if (scaleType === 'ordinal') {\n    axisDataLen = model.getCategories().length;\n  } else {\n    boundaryGap = model.get('boundaryGap');\n\n    if (!isArray(boundaryGap)) {\n      boundaryGap = [boundaryGap || 0, boundaryGap || 0];\n    }\n\n    if (typeof boundaryGap[0] === 'boolean') {\n      boundaryGap = [0, 0];\n    }\n\n    boundaryGap[0] = parsePercent$1(boundaryGap[0], 1);\n    boundaryGap[1] = parsePercent$1(boundaryGap[1], 1);\n    span = originalExtent[1] - originalExtent[0] || Math.abs(originalExtent[0]);\n  } // Notice: When min/max is not set (that is, when there are null/undefined,\n  // which is the most common case), these cases should be ensured:\n  // (1) For 'ordinal', show all axis.data.\n  // (2) For others:\n  //      + `boundaryGap` is applied (if min/max set, boundaryGap is\n  //      disabled).\n  //      + If `needCrossZero`, min/max should be zero, otherwise, min/max should\n  //      be the result that originalExtent enlarged by boundaryGap.\n  // (3) If no data, it should be ensured that `scale.setBlank` is set.\n  // FIXME\n  // (1) When min/max is 'dataMin' or 'dataMax', should boundaryGap be able to used?\n  // (2) When `needCrossZero` and all data is positive/negative, should it be ensured\n  // that the results processed by boundaryGap are positive/negative?\n\n\n  if (min == null) {\n    min = scaleType === 'ordinal' ? axisDataLen ? 0 : NaN : originalExtent[0] - boundaryGap[0] * span;\n  }\n\n  if (max == null) {\n    max = scaleType === 'ordinal' ? axisDataLen ? axisDataLen - 1 : NaN : originalExtent[1] + boundaryGap[1] * span;\n  }\n\n  if (min === 'dataMin') {\n    min = originalExtent[0];\n  } else if (typeof min === 'function') {\n    min = min({\n      min: originalExtent[0],\n      max: originalExtent[1]\n    });\n  }\n\n  if (max === 'dataMax') {\n    max = originalExtent[1];\n  } else if (typeof max === 'function') {\n    max = max({\n      min: originalExtent[0],\n      max: originalExtent[1]\n    });\n  }\n\n  (min == null || !isFinite(min)) && (min = NaN);\n  (max == null || !isFinite(max)) && (max = NaN);\n  scale.setBlank(eqNaN(min) || eqNaN(max) || scaleType === 'ordinal' && !scale.getOrdinalMeta().categories.length); // Evaluate if axis needs cross zero\n\n  if (model.getNeedCrossZero()) {\n    // Axis is over zero and min is not set\n    if (min > 0 && max > 0 && !fixMin) {\n      min = 0;\n    } // Axis is under zero and max is not set\n\n\n    if (min < 0 && max < 0 && !fixMax) {\n      max = 0;\n    }\n  } // If bars are placed on a base axis of type time or interval account for axis boundary overflow and current axis\n  // is base axis\n  // FIXME\n  // (1) Consider support value axis, where below zero and axis `onZero` should be handled properly.\n  // (2) Refactor the logic with `barGrid`. Is it not need to `makeBarWidthAndOffsetInfo` twice with different extent?\n  //     Should not depend on series type `bar`?\n  // (3) Fix that might overlap when using dataZoom.\n  // (4) Consider other chart types using `barGrid`?\n  // See #6728, #4862, `test/bar-overflow-time-plot.html`\n\n\n  var ecModel = model.ecModel;\n\n  if (ecModel && scaleType === 'time'\n  /*|| scaleType === 'interval' */\n  ) {\n    var barSeriesModels = prepareLayoutBarSeries('bar', ecModel);\n    var isBaseAxisAndHasBarSeries;\n    each$1(barSeriesModels, function (seriesModel) {\n      isBaseAxisAndHasBarSeries |= seriesModel.getBaseAxis() === model.axis;\n    });\n\n    if (isBaseAxisAndHasBarSeries) {\n      // Calculate placement of bars on axis\n      var barWidthAndOffset = makeColumnLayout(barSeriesModels); // Adjust axis min and max to account for overflow\n\n      var adjustedScale = adjustScaleForOverflow(min, max, model, barWidthAndOffset);\n      min = adjustedScale.min;\n      max = adjustedScale.max;\n    }\n  }\n\n  return [min, max];\n}\n\nfunction adjustScaleForOverflow(min, max, model, barWidthAndOffset) {\n  // Get Axis Length\n  var axisExtent = model.axis.getExtent();\n  var axisLength = axisExtent[1] - axisExtent[0]; // Get bars on current base axis and calculate min and max overflow\n\n  var barsOnCurrentAxis = retrieveColumnLayout(barWidthAndOffset, model.axis);\n\n  if (barsOnCurrentAxis === undefined) {\n    return {\n      min: min,\n      max: max\n    };\n  }\n\n  var minOverflow = Infinity;\n  each$1(barsOnCurrentAxis, function (item) {\n    minOverflow = Math.min(item.offset, minOverflow);\n  });\n  var maxOverflow = -Infinity;\n  each$1(barsOnCurrentAxis, function (item) {\n    maxOverflow = Math.max(item.offset + item.width, maxOverflow);\n  });\n  minOverflow = Math.abs(minOverflow);\n  maxOverflow = Math.abs(maxOverflow);\n  var totalOverFlow = minOverflow + maxOverflow; // Calulate required buffer based on old range and overflow\n\n  var oldRange = max - min;\n  var oldRangePercentOfNew = 1 - (minOverflow + maxOverflow) / axisLength;\n  var overflowBuffer = oldRange / oldRangePercentOfNew - oldRange;\n  max += overflowBuffer * (maxOverflow / totalOverFlow);\n  min -= overflowBuffer * (minOverflow / totalOverFlow);\n  return {\n    min: min,\n    max: max\n  };\n}\n\nfunction niceScaleExtent(scale, model) {\n  var extent = getScaleExtent(scale, model);\n  var fixMin = model.getMin() != null;\n  var fixMax = model.getMax() != null;\n  var splitNumber = model.get('splitNumber');\n\n  if (scale.type === 'log') {\n    scale.base = model.get('logBase');\n  }\n\n  var scaleType = scale.type;\n  scale.setExtent(extent[0], extent[1]);\n  scale.niceExtent({\n    splitNumber: splitNumber,\n    fixMin: fixMin,\n    fixMax: fixMax,\n    minInterval: scaleType === 'interval' || scaleType === 'time' ? model.get('minInterval') : null,\n    maxInterval: scaleType === 'interval' || scaleType === 'time' ? model.get('maxInterval') : null\n  }); // If some one specified the min, max. And the default calculated interval\n  // is not good enough. He can specify the interval. It is often appeared\n  // in angle axis with angle 0 - 360. Interval calculated in interval scale is hard\n  // to be 60.\n  // FIXME\n\n  var interval = model.get('interval');\n\n  if (interval != null) {\n    scale.setInterval && scale.setInterval(interval);\n  }\n}\n/**\n * @param {module:echarts/model/Model} model\n * @param {string} [axisType] Default retrieve from model.type\n * @return {module:echarts/scale/*}\n */\n\nfunction createScaleByModel(model, axisType) {\n  axisType = axisType || model.get('type');\n\n  if (axisType) {\n    switch (axisType) {\n      // Buildin scale\n      case 'category':\n        return new OrdinalScale(model.getOrdinalMeta ? model.getOrdinalMeta() : model.getCategories(), [Infinity, -Infinity]);\n\n      case 'value':\n        return new IntervalScale();\n      // Extended scale, like time and log\n\n      default:\n        return (Scale.getClass(axisType) || IntervalScale).create(model);\n    }\n  }\n}\n/**\n * Check if the axis corss 0\n */\n\nfunction ifAxisCrossZero(axis) {\n  var dataExtent = axis.scale.getExtent();\n  var min = dataExtent[0];\n  var max = dataExtent[1];\n  return !(min > 0 && max > 0 || min < 0 && max < 0);\n}\n/**\n * @param {module:echarts/coord/Axis} axis\n * @return {Function} Label formatter function.\n *         param: {number} tickValue,\n *         param: {number} idx, the index in all ticks.\n *                         If category axis, this param is not requied.\n *         return: {string} label string.\n */\n\nfunction makeLabelFormatter(axis) {\n  var labelFormatter = axis.getLabelModel().get('formatter');\n  var categoryTickStart = axis.type === 'category' ? axis.scale.getExtent()[0] : null;\n\n  if (typeof labelFormatter === 'string') {\n    labelFormatter = function (tpl) {\n      return function (val) {\n        return tpl.replace('{value}', val != null ? val : '');\n      };\n    }(labelFormatter); // Consider empty array\n\n\n    return labelFormatter;\n  } else if (typeof labelFormatter === 'function') {\n    return function (tickValue, idx) {\n      // The original intention of `idx` is \"the index of the tick in all ticks\".\n      // But the previous implementation of category axis do not consider the\n      // `axisLabel.interval`, which cause that, for example, the `interval` is\n      // `1`, then the ticks \"name5\", \"name7\", \"name9\" are displayed, where the\n      // corresponding `idx` are `0`, `2`, `4`, but not `0`, `1`, `2`. So we keep\n      // the definition here for back compatibility.\n      if (categoryTickStart != null) {\n        idx = tickValue - categoryTickStart;\n      }\n\n      return labelFormatter(getAxisRawValue(axis, tickValue), idx);\n    };\n  } else {\n    return function (tick) {\n      return axis.scale.getLabel(tick);\n    };\n  }\n}\nfunction getAxisRawValue(axis, value) {\n  // In category axis with data zoom, tick is not the original\n  // index of axis.data. So tick should not be exposed to user\n  // in category axis.\n  return axis.type === 'category' ? axis.scale.getLabel(value) : value;\n}\n/**\n * @param {module:echarts/coord/Axis} axis\n * @return {module:zrender/core/BoundingRect} Be null/undefined if no labels.\n */\n\nfunction estimateLabelUnionRect(axis) {\n  var axisModel = axis.model;\n  var scale = axis.scale;\n\n  if (!axisModel.get('axisLabel.show') || scale.isBlank()) {\n    return;\n  }\n\n  var isCategory = axis.type === 'category';\n  var realNumberScaleTicks;\n  var tickCount;\n  var categoryScaleExtent = scale.getExtent(); // Optimize for large category data, avoid call `getTicks()`.\n\n  if (isCategory) {\n    tickCount = scale.count();\n  } else {\n    realNumberScaleTicks = scale.getTicks();\n    tickCount = realNumberScaleTicks.length;\n  }\n\n  var axisLabelModel = axis.getLabelModel();\n  var labelFormatter = makeLabelFormatter(axis);\n  var rect;\n  var step = 1; // Simple optimization for large amount of labels\n\n  if (tickCount > 40) {\n    step = Math.ceil(tickCount / 40);\n  }\n\n  for (var i = 0; i < tickCount; i += step) {\n    var tickValue = realNumberScaleTicks ? realNumberScaleTicks[i] : categoryScaleExtent[0] + i;\n    var label = labelFormatter(tickValue);\n    var unrotatedSingleRect = axisLabelModel.getTextRect(label);\n    var singleRect = rotateTextRect(unrotatedSingleRect, axisLabelModel.get('rotate') || 0);\n    rect ? rect.union(singleRect) : rect = singleRect;\n  }\n\n  return rect;\n}\n\nfunction rotateTextRect(textRect, rotate) {\n  var rotateRadians = rotate * Math.PI / 180;\n  var boundingBox = textRect.plain();\n  var beforeWidth = boundingBox.width;\n  var beforeHeight = boundingBox.height;\n  var afterWidth = beforeWidth * Math.cos(rotateRadians) + beforeHeight * Math.sin(rotateRadians);\n  var afterHeight = beforeWidth * Math.sin(rotateRadians) + beforeHeight * Math.cos(rotateRadians);\n  var rotatedRect = new BoundingRect(boundingBox.x, boundingBox.y, afterWidth, afterHeight);\n  return rotatedRect;\n}\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar axisModelCommonMixin = {\n  /**\n   * @param {boolean} origin\n   * @return {number|string} min value or 'dataMin' or null/undefined (means auto) or NaN\n   */\n  getMin: function (origin) {\n    var option = this.option;\n    var min = !origin && option.rangeStart != null ? option.rangeStart : option.min;\n\n    if (this.axis && min != null && min !== 'dataMin' && typeof min !== 'function' && !eqNaN(min)) {\n      min = this.axis.scale.parse(min);\n    }\n\n    return min;\n  },\n\n  /**\n   * @param {boolean} origin\n   * @return {number|string} max value or 'dataMax' or null/undefined (means auto) or NaN\n   */\n  getMax: function (origin) {\n    var option = this.option;\n    var max = !origin && option.rangeEnd != null ? option.rangeEnd : option.max;\n\n    if (this.axis && max != null && max !== 'dataMax' && typeof max !== 'function' && !eqNaN(max)) {\n      max = this.axis.scale.parse(max);\n    }\n\n    return max;\n  },\n\n  /**\n   * @return {boolean}\n   */\n  getNeedCrossZero: function () {\n    var option = this.option;\n    return option.rangeStart != null || option.rangeEnd != null ? false : !option.scale;\n  },\n\n  /**\n   * Should be implemented by each axis model if necessary.\n   * @return {module:echarts/model/Component} coordinate system model\n   */\n  getCoordSysModel: noop,\n\n  /**\n   * @param {number} rangeStart Can only be finite number or null/undefined or NaN.\n   * @param {number} rangeEnd Can only be finite number or null/undefined or NaN.\n   */\n  setRange: function (rangeStart, rangeEnd) {\n    this.option.rangeStart = rangeStart;\n    this.option.rangeEnd = rangeEnd;\n  },\n\n  /**\n   * Reset range\n   */\n  resetRange: function () {\n    // rangeStart and rangeEnd is readonly.\n    this.option.rangeStart = this.option.rangeEnd = null;\n  }\n};\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n// Symbol factory\n/**\n * Triangle shape\n * @inner\n */\n\nvar Triangle = extendShape({\n  type: 'triangle',\n  shape: {\n    cx: 0,\n    cy: 0,\n    width: 0,\n    height: 0\n  },\n  buildPath: function (path, shape) {\n    var cx = shape.cx;\n    var cy = shape.cy;\n    var width = shape.width / 2;\n    var height = shape.height / 2;\n    path.moveTo(cx, cy - height);\n    path.lineTo(cx + width, cy + height);\n    path.lineTo(cx - width, cy + height);\n    path.closePath();\n  }\n});\n/**\n * Diamond shape\n * @inner\n */\n\nvar Diamond = extendShape({\n  type: 'diamond',\n  shape: {\n    cx: 0,\n    cy: 0,\n    width: 0,\n    height: 0\n  },\n  buildPath: function (path, shape) {\n    var cx = shape.cx;\n    var cy = shape.cy;\n    var width = shape.width / 2;\n    var height = shape.height / 2;\n    path.moveTo(cx, cy - height);\n    path.lineTo(cx + width, cy);\n    path.lineTo(cx, cy + height);\n    path.lineTo(cx - width, cy);\n    path.closePath();\n  }\n});\n/**\n * Pin shape\n * @inner\n */\n\nvar Pin = extendShape({\n  type: 'pin',\n  shape: {\n    // x, y on the cusp\n    x: 0,\n    y: 0,\n    width: 0,\n    height: 0\n  },\n  buildPath: function (path, shape) {\n    var x = shape.x;\n    var y = shape.y;\n    var w = shape.width / 5 * 3; // Height must be larger than width\n\n    var h = Math.max(w, shape.height);\n    var r = w / 2; // Dist on y with tangent point and circle center\n\n    var dy = r * r / (h - r);\n    var cy = y - h + r + dy;\n    var angle = Math.asin(dy / r); // Dist on x with tangent point and circle center\n\n    var dx = Math.cos(angle) * r;\n    var tanX = Math.sin(angle);\n    var tanY = Math.cos(angle);\n    var cpLen = r * 0.6;\n    var cpLen2 = r * 0.7;\n    path.moveTo(x - dx, cy + dy);\n    path.arc(x, cy, r, Math.PI - angle, Math.PI * 2 + angle);\n    path.bezierCurveTo(x + dx - tanX * cpLen, cy + dy + tanY * cpLen, x, y - cpLen2, x, y);\n    path.bezierCurveTo(x, y - cpLen2, x - dx + tanX * cpLen, cy + dy + tanY * cpLen, x - dx, cy + dy);\n    path.closePath();\n  }\n});\n/**\n * Arrow shape\n * @inner\n */\n\nvar Arrow = extendShape({\n  type: 'arrow',\n  shape: {\n    x: 0,\n    y: 0,\n    width: 0,\n    height: 0\n  },\n  buildPath: function (ctx, shape) {\n    var height = shape.height;\n    var width = shape.width;\n    var x = shape.x;\n    var y = shape.y;\n    var dx = width / 3 * 2;\n    ctx.moveTo(x, y);\n    ctx.lineTo(x + dx, y + height);\n    ctx.lineTo(x, y + height / 4 * 3);\n    ctx.lineTo(x - dx, y + height);\n    ctx.lineTo(x, y);\n    ctx.closePath();\n  }\n});\n/**\n * Map of path contructors\n * @type {Object.<string, module:zrender/graphic/Path>}\n */\n\nvar symbolCtors = {\n  line: Line,\n  rect: Rect,\n  roundRect: Rect,\n  square: Rect,\n  circle: Circle,\n  diamond: Diamond,\n  pin: Pin,\n  arrow: Arrow,\n  triangle: Triangle\n};\nvar symbolShapeMakers = {\n  line: function (x, y, w, h, shape) {\n    // FIXME\n    shape.x1 = x;\n    shape.y1 = y + h / 2;\n    shape.x2 = x + w;\n    shape.y2 = y + h / 2;\n  },\n  rect: function (x, y, w, h, shape) {\n    shape.x = x;\n    shape.y = y;\n    shape.width = w;\n    shape.height = h;\n  },\n  roundRect: function (x, y, w, h, shape) {\n    shape.x = x;\n    shape.y = y;\n    shape.width = w;\n    shape.height = h;\n    shape.r = Math.min(w, h) / 4;\n  },\n  square: function (x, y, w, h, shape) {\n    var size = Math.min(w, h);\n    shape.x = x;\n    shape.y = y;\n    shape.width = size;\n    shape.height = size;\n  },\n  circle: function (x, y, w, h, shape) {\n    // Put circle in the center of square\n    shape.cx = x + w / 2;\n    shape.cy = y + h / 2;\n    shape.r = Math.min(w, h) / 2;\n  },\n  diamond: function (x, y, w, h, shape) {\n    shape.cx = x + w / 2;\n    shape.cy = y + h / 2;\n    shape.width = w;\n    shape.height = h;\n  },\n  pin: function (x, y, w, h, shape) {\n    shape.x = x + w / 2;\n    shape.y = y + h / 2;\n    shape.width = w;\n    shape.height = h;\n  },\n  arrow: function (x, y, w, h, shape) {\n    shape.x = x + w / 2;\n    shape.y = y + h / 2;\n    shape.width = w;\n    shape.height = h;\n  },\n  triangle: function (x, y, w, h, shape) {\n    shape.cx = x + w / 2;\n    shape.cy = y + h / 2;\n    shape.width = w;\n    shape.height = h;\n  }\n};\nvar symbolBuildProxies = {};\neach$1(symbolCtors, function (Ctor, name) {\n  symbolBuildProxies[name] = new Ctor();\n});\nvar SymbolClz = extendShape({\n  type: 'symbol',\n  shape: {\n    symbolType: '',\n    x: 0,\n    y: 0,\n    width: 0,\n    height: 0\n  },\n  beforeBrush: function () {\n    var style = this.style;\n    var shape = this.shape; // FIXME\n\n    if (shape.symbolType === 'pin' && style.textPosition === 'inside') {\n      style.textPosition = ['50%', '40%'];\n      style.textAlign = 'center';\n      style.textVerticalAlign = 'middle';\n    }\n  },\n  buildPath: function (ctx, shape, inBundle) {\n    var symbolType = shape.symbolType;\n    var proxySymbol = symbolBuildProxies[symbolType];\n\n    if (shape.symbolType !== 'none') {\n      if (!proxySymbol) {\n        // Default rect\n        symbolType = 'rect';\n        proxySymbol = symbolBuildProxies[symbolType];\n      }\n\n      symbolShapeMakers[symbolType](shape.x, shape.y, shape.width, shape.height, proxySymbol.shape);\n      proxySymbol.buildPath(ctx, proxySymbol.shape, inBundle);\n    }\n  }\n}); // Provide setColor helper method to avoid determine if set the fill or stroke outside\n\nfunction symbolPathSetColor(color, innerColor) {\n  if (this.type !== 'image') {\n    var symbolStyle = this.style;\n    var symbolShape = this.shape;\n\n    if (symbolShape && symbolShape.symbolType === 'line') {\n      symbolStyle.stroke = color;\n    } else if (this.__isEmptyBrush) {\n      symbolStyle.stroke = color;\n      symbolStyle.fill = innerColor || '#fff';\n    } else {\n      // FIXME  onlyStroke ?\n      symbolStyle.fill && (symbolStyle.fill = color);\n      symbolStyle.stroke && (symbolStyle.stroke = color);\n    }\n\n    this.dirty(false);\n  }\n}\n/**\n * Create a symbol element with given symbol configuration: shape, x, y, width, height, color\n * @param {string} symbolType\n * @param {number} x\n * @param {number} y\n * @param {number} w\n * @param {number} h\n * @param {string} color\n * @param {boolean} [keepAspect=false] whether to keep the ratio of w/h,\n *                            for path and image only.\n */\n\n\nfunction createSymbol(symbolType, x, y, w, h, color, keepAspect) {\n  // TODO Support image object, DynamicImage.\n  var isEmpty = symbolType.indexOf('empty') === 0;\n\n  if (isEmpty) {\n    symbolType = symbolType.substr(5, 1).toLowerCase() + symbolType.substr(6);\n  }\n\n  var symbolPath;\n\n  if (symbolType.indexOf('image://') === 0) {\n    symbolPath = makeImage(symbolType.slice(8), new BoundingRect(x, y, w, h), keepAspect ? 'center' : 'cover');\n  } else if (symbolType.indexOf('path://') === 0) {\n    symbolPath = makePath(symbolType.slice(7), {}, new BoundingRect(x, y, w, h), keepAspect ? 'center' : 'cover');\n  } else {\n    symbolPath = new SymbolClz({\n      shape: {\n        symbolType: symbolType,\n        x: x,\n        y: y,\n        width: w,\n        height: h\n      }\n    });\n  }\n\n  symbolPath.__isEmptyBrush = isEmpty;\n  symbolPath.setColor = symbolPathSetColor;\n  symbolPath.setColor(color);\n  return symbolPath;\n}\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n/**\n * Create a muti dimension List structure from seriesModel.\n * @param  {module:echarts/model/Model} seriesModel\n * @return {module:echarts/data/List} list\n */\n\nfunction createList(seriesModel) {\n  return createListFromArray(seriesModel.getSource(), seriesModel);\n} // export function createGraph(seriesModel) {\nvar dataStack$1 = {\n  isDimensionStacked: isDimensionStacked,\n  enableDataStack: enableDataStack,\n  getStackedDimension: getStackedDimension\n};\n/**\n * Create scale\n * @param {Array.<number>} dataExtent\n * @param {Object|module:echarts/Model} option\n */\n\nfunction createScale(dataExtent, option) {\n  var axisModel = option;\n\n  if (!Model.isInstance(option)) {\n    axisModel = new Model(option);\n    mixin(axisModel, axisModelCommonMixin);\n  }\n\n  var scale = createScaleByModel(axisModel);\n  scale.setExtent(dataExtent[0], dataExtent[1]);\n  niceScaleExtent(scale, axisModel);\n  return scale;\n}\n/**\n * Mixin common methods to axis model,\n *\n * Inlcude methods\n * `getFormattedLabels() => Array.<string>`\n * `getCategories() => Array.<string>`\n * `getMin(origin: boolean) => number`\n * `getMax(origin: boolean) => number`\n * `getNeedCrossZero() => boolean`\n * `setRange(start: number, end: number)`\n * `resetRange()`\n */\n\nfunction mixinAxisModelCommonMethods(Model$$1) {\n  mixin(Model$$1, axisModelCommonMixin);\n}\n\nvar helper = (Object.freeze || Object)({\n\tcreateList: createList,\n\tgetLayoutRect: getLayoutRect,\n\tdataStack: dataStack$1,\n\tcreateScale: createScale,\n\tmixinAxisModelCommonMethods: mixinAxisModelCommonMethods,\n\tcompleteDimensions: completeDimensions,\n\tcreateDimensions: createDimensions,\n\tcreateSymbol: createSymbol\n});\n\nvar EPSILON$3 = 1e-8;\n\nfunction isAroundEqual$1(a, b) {\n  return Math.abs(a - b) < EPSILON$3;\n}\n\nfunction contain$1(points, x, y) {\n  var w = 0;\n  var p = points[0];\n\n  if (!p) {\n    return false;\n  }\n\n  for (var i = 1; i < points.length; i++) {\n    var p2 = points[i];\n    w += windingLine(p[0], p[1], p2[0], p2[1], x, y);\n    p = p2;\n  } // Close polygon\n\n\n  var p0 = points[0];\n\n  if (!isAroundEqual$1(p[0], p0[0]) || !isAroundEqual$1(p[1], p0[1])) {\n    w += windingLine(p[0], p[1], p0[0], p0[1], x, y);\n  }\n\n  return w !== 0;\n}\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * @module echarts/coord/geo/Region\n */\n/**\n * @param {string} name\n * @param {Array} geometries\n * @param {Array.<number>} cp\n */\n\nfunction Region(name, geometries, cp) {\n  /**\n   * @type {string}\n   * @readOnly\n   */\n  this.name = name;\n  /**\n   * @type {Array.<Array>}\n   * @readOnly\n   */\n\n  this.geometries = geometries;\n\n  if (!cp) {\n    var rect = this.getBoundingRect();\n    cp = [rect.x + rect.width / 2, rect.y + rect.height / 2];\n  } else {\n    cp = [cp[0], cp[1]];\n  }\n  /**\n   * @type {Array.<number>}\n   */\n\n\n  this.center = cp;\n}\n\nRegion.prototype = {\n  constructor: Region,\n  properties: null,\n\n  /**\n   * @return {module:zrender/core/BoundingRect}\n   */\n  getBoundingRect: function () {\n    var rect = this._rect;\n\n    if (rect) {\n      return rect;\n    }\n\n    var MAX_NUMBER = Number.MAX_VALUE;\n    var min$$1 = [MAX_NUMBER, MAX_NUMBER];\n    var max$$1 = [-MAX_NUMBER, -MAX_NUMBER];\n    var min2 = [];\n    var max2 = [];\n    var geometries = this.geometries;\n\n    for (var i = 0; i < geometries.length; i++) {\n      // Only support polygon\n      if (geometries[i].type !== 'polygon') {\n        continue;\n      } // Doesn't consider hole\n\n\n      var exterior = geometries[i].exterior;\n      fromPoints(exterior, min2, max2);\n      min(min$$1, min$$1, min2);\n      max(max$$1, max$$1, max2);\n    } // No data\n\n\n    if (i === 0) {\n      min$$1[0] = min$$1[1] = max$$1[0] = max$$1[1] = 0;\n    }\n\n    return this._rect = new BoundingRect(min$$1[0], min$$1[1], max$$1[0] - min$$1[0], max$$1[1] - min$$1[1]);\n  },\n\n  /**\n   * @param {<Array.<number>} coord\n   * @return {boolean}\n   */\n  contain: function (coord) {\n    var rect = this.getBoundingRect();\n    var geometries = this.geometries;\n\n    if (!rect.contain(coord[0], coord[1])) {\n      return false;\n    }\n\n    loopGeo: for (var i = 0, len$$1 = geometries.length; i < len$$1; i++) {\n      // Only support polygon.\n      if (geometries[i].type !== 'polygon') {\n        continue;\n      }\n\n      var exterior = geometries[i].exterior;\n      var interiors = geometries[i].interiors;\n\n      if (contain$1(exterior, coord[0], coord[1])) {\n        // Not in the region if point is in the hole.\n        for (var k = 0; k < (interiors ? interiors.length : 0); k++) {\n          if (contain$1(interiors[k])) {\n            continue loopGeo;\n          }\n        }\n\n        return true;\n      }\n    }\n\n    return false;\n  },\n  transformTo: function (x, y, width, height) {\n    var rect = this.getBoundingRect();\n    var aspect = rect.width / rect.height;\n\n    if (!width) {\n      width = aspect * height;\n    } else if (!height) {\n      height = width / aspect;\n    }\n\n    var target = new BoundingRect(x, y, width, height);\n    var transform = rect.calculateTransform(target);\n    var geometries = this.geometries;\n\n    for (var i = 0; i < geometries.length; i++) {\n      // Only support polygon.\n      if (geometries[i].type !== 'polygon') {\n        continue;\n      }\n\n      var exterior = geometries[i].exterior;\n      var interiors = geometries[i].interiors;\n\n      for (var p = 0; p < exterior.length; p++) {\n        applyTransform(exterior[p], exterior[p], transform);\n      }\n\n      for (var h = 0; h < (interiors ? interiors.length : 0); h++) {\n        for (var p = 0; p < interiors[h].length; p++) {\n          applyTransform(interiors[h][p], interiors[h][p], transform);\n        }\n      }\n    }\n\n    rect = this._rect;\n    rect.copy(target); // Update center\n\n    this.center = [rect.x + rect.width / 2, rect.y + rect.height / 2];\n  }\n};\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * Parse and decode geo json\n * @module echarts/coord/geo/parseGeoJson\n */\nfunction decode(json) {\n  if (!json.UTF8Encoding) {\n    return json;\n  }\n\n  var encodeScale = json.UTF8Scale;\n\n  if (encodeScale == null) {\n    encodeScale = 1024;\n  }\n\n  var features = json.features;\n\n  for (var f = 0; f < features.length; f++) {\n    var feature = features[f];\n    var geometry = feature.geometry;\n    var coordinates = geometry.coordinates;\n    var encodeOffsets = geometry.encodeOffsets;\n\n    for (var c = 0; c < coordinates.length; c++) {\n      var coordinate = coordinates[c];\n\n      if (geometry.type === 'Polygon') {\n        coordinates[c] = decodePolygon(coordinate, encodeOffsets[c], encodeScale);\n      } else if (geometry.type === 'MultiPolygon') {\n        for (var c2 = 0; c2 < coordinate.length; c2++) {\n          var polygon = coordinate[c2];\n          coordinate[c2] = decodePolygon(polygon, encodeOffsets[c][c2], encodeScale);\n        }\n      }\n    }\n  } // Has been decoded\n\n\n  json.UTF8Encoding = false;\n  return json;\n}\n\nfunction decodePolygon(coordinate, encodeOffsets, encodeScale) {\n  var result = [];\n  var prevX = encodeOffsets[0];\n  var prevY = encodeOffsets[1];\n\n  for (var i = 0; i < coordinate.length; i += 2) {\n    var x = coordinate.charCodeAt(i) - 64;\n    var y = coordinate.charCodeAt(i + 1) - 64; // ZigZag decoding\n\n    x = x >> 1 ^ -(x & 1);\n    y = y >> 1 ^ -(y & 1); // Delta deocding\n\n    x += prevX;\n    y += prevY;\n    prevX = x;\n    prevY = y; // Dequantize\n\n    result.push([x / encodeScale, y / encodeScale]);\n  }\n\n  return result;\n}\n/**\n * @alias module:echarts/coord/geo/parseGeoJson\n * @param {Object} geoJson\n * @return {module:zrender/container/Group}\n */\n\n\nvar parseGeoJSON = function (geoJson) {\n  decode(geoJson);\n  return map(filter(geoJson.features, function (featureObj) {\n    // Output of mapshaper may have geometry null\n    return featureObj.geometry && featureObj.properties && featureObj.geometry.coordinates.length > 0;\n  }), function (featureObj) {\n    var properties = featureObj.properties;\n    var geo = featureObj.geometry;\n    var coordinates = geo.coordinates;\n    var geometries = [];\n\n    if (geo.type === 'Polygon') {\n      geometries.push({\n        type: 'polygon',\n        // According to the GeoJSON specification.\n        // First must be exterior, and the rest are all interior(holes).\n        exterior: coordinates[0],\n        interiors: coordinates.slice(1)\n      });\n    }\n\n    if (geo.type === 'MultiPolygon') {\n      each$1(coordinates, function (item) {\n        if (item[0]) {\n          geometries.push({\n            type: 'polygon',\n            exterior: item[0],\n            interiors: item.slice(1)\n          });\n        }\n      });\n    }\n\n    var region = new Region(properties.name, geometries, properties.cp);\n    region.properties = properties;\n    return region;\n  });\n};\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar inner$6 = makeInner();\n/**\n * @param {module:echats/coord/Axis} axis\n * @return {Object} {\n *     labels: [{\n *         formattedLabel: string,\n *         rawLabel: string,\n *         tickValue: number\n *     }, ...],\n *     labelCategoryInterval: number\n * }\n */\n\nfunction createAxisLabels(axis) {\n  // Only ordinal scale support tick interval\n  return axis.type === 'category' ? makeCategoryLabels(axis) : makeRealNumberLabels(axis);\n}\n/**\n * @param {module:echats/coord/Axis} axis\n * @param {module:echarts/model/Model} tickModel For example, can be axisTick, splitLine, splitArea.\n * @return {Object} {\n *     ticks: Array.<number>\n *     tickCategoryInterval: number\n * }\n */\n\nfunction createAxisTicks(axis, tickModel) {\n  // Only ordinal scale support tick interval\n  return axis.type === 'category' ? makeCategoryTicks(axis, tickModel) : {\n    ticks: axis.scale.getTicks()\n  };\n}\n\nfunction makeCategoryLabels(axis) {\n  var labelModel = axis.getLabelModel();\n  var result = makeCategoryLabelsActually(axis, labelModel);\n  return !labelModel.get('show') || axis.scale.isBlank() ? {\n    labels: [],\n    labelCategoryInterval: result.labelCategoryInterval\n  } : result;\n}\n\nfunction makeCategoryLabelsActually(axis, labelModel) {\n  var labelsCache = getListCache(axis, 'labels');\n  var optionLabelInterval = getOptionCategoryInterval(labelModel);\n  var result = listCacheGet(labelsCache, optionLabelInterval);\n\n  if (result) {\n    return result;\n  }\n\n  var labels;\n  var numericLabelInterval;\n\n  if (isFunction$1(optionLabelInterval)) {\n    labels = makeLabelsByCustomizedCategoryInterval(axis, optionLabelInterval);\n  } else {\n    numericLabelInterval = optionLabelInterval === 'auto' ? makeAutoCategoryInterval(axis) : optionLabelInterval;\n    labels = makeLabelsByNumericCategoryInterval(axis, numericLabelInterval);\n  } // Cache to avoid calling interval function repeatly.\n\n\n  return listCacheSet(labelsCache, optionLabelInterval, {\n    labels: labels,\n    labelCategoryInterval: numericLabelInterval\n  });\n}\n\nfunction makeCategoryTicks(axis, tickModel) {\n  var ticksCache = getListCache(axis, 'ticks');\n  var optionTickInterval = getOptionCategoryInterval(tickModel);\n  var result = listCacheGet(ticksCache, optionTickInterval);\n\n  if (result) {\n    return result;\n  }\n\n  var ticks;\n  var tickCategoryInterval; // Optimize for the case that large category data and no label displayed,\n  // we should not return all ticks.\n\n  if (!tickModel.get('show') || axis.scale.isBlank()) {\n    ticks = [];\n  }\n\n  if (isFunction$1(optionTickInterval)) {\n    ticks = makeLabelsByCustomizedCategoryInterval(axis, optionTickInterval, true);\n  } // Always use label interval by default despite label show. Consider this\n  // scenario, Use multiple grid with the xAxis sync, and only one xAxis shows\n  // labels. `splitLine` and `axisTick` should be consistent in this case.\n  else if (optionTickInterval === 'auto') {\n      var labelsResult = makeCategoryLabelsActually(axis, axis.getLabelModel());\n      tickCategoryInterval = labelsResult.labelCategoryInterval;\n      ticks = map(labelsResult.labels, function (labelItem) {\n        return labelItem.tickValue;\n      });\n    } else {\n      tickCategoryInterval = optionTickInterval;\n      ticks = makeLabelsByNumericCategoryInterval(axis, tickCategoryInterval, true);\n    } // Cache to avoid calling interval function repeatly.\n\n\n  return listCacheSet(ticksCache, optionTickInterval, {\n    ticks: ticks,\n    tickCategoryInterval: tickCategoryInterval\n  });\n}\n\nfunction makeRealNumberLabels(axis) {\n  var ticks = axis.scale.getTicks();\n  var labelFormatter = makeLabelFormatter(axis);\n  return {\n    labels: map(ticks, function (tickValue, idx) {\n      return {\n        formattedLabel: labelFormatter(tickValue, idx),\n        rawLabel: axis.scale.getLabel(tickValue),\n        tickValue: tickValue\n      };\n    })\n  };\n} // Large category data calculation is performence sensitive, and ticks and label\n// probably be fetched by multiple times. So we cache the result.\n// axis is created each time during a ec process, so we do not need to clear cache.\n\n\nfunction getListCache(axis, prop) {\n  // Because key can be funciton, and cache size always be small, we use array cache.\n  return inner$6(axis)[prop] || (inner$6(axis)[prop] = []);\n}\n\nfunction listCacheGet(cache, key) {\n  for (var i = 0; i < cache.length; i++) {\n    if (cache[i].key === key) {\n      return cache[i].value;\n    }\n  }\n}\n\nfunction listCacheSet(cache, key, value) {\n  cache.push({\n    key: key,\n    value: value\n  });\n  return value;\n}\n\nfunction makeAutoCategoryInterval(axis) {\n  var result = inner$6(axis).autoInterval;\n  return result != null ? result : inner$6(axis).autoInterval = axis.calculateCategoryInterval();\n}\n/**\n * Calculate interval for category axis ticks and labels.\n * To get precise result, at least one of `getRotate` and `isHorizontal`\n * should be implemented in axis.\n */\n\n\nfunction calculateCategoryInterval(axis) {\n  var params = fetchAutoCategoryIntervalCalculationParams(axis);\n  var labelFormatter = makeLabelFormatter(axis);\n  var rotation = (params.axisRotate - params.labelRotate) / 180 * Math.PI;\n  var ordinalScale = axis.scale;\n  var ordinalExtent = ordinalScale.getExtent(); // Providing this method is for optimization:\n  // avoid generating a long array by `getTicks`\n  // in large category data case.\n\n  var tickCount = ordinalScale.count();\n\n  if (ordinalExtent[1] - ordinalExtent[0] < 1) {\n    return 0;\n  }\n\n  var step = 1; // Simple optimization. Empirical value: tick count should less than 40.\n\n  if (tickCount > 40) {\n    step = Math.max(1, Math.floor(tickCount / 40));\n  }\n\n  var tickValue = ordinalExtent[0];\n  var unitSpan = axis.dataToCoord(tickValue + 1) - axis.dataToCoord(tickValue);\n  var unitW = Math.abs(unitSpan * Math.cos(rotation));\n  var unitH = Math.abs(unitSpan * Math.sin(rotation));\n  var maxW = 0;\n  var maxH = 0; // Caution: Performance sensitive for large category data.\n  // Consider dataZoom, we should make appropriate step to avoid O(n) loop.\n\n  for (; tickValue <= ordinalExtent[1]; tickValue += step) {\n    var width = 0;\n    var height = 0; // Polar is also calculated in assumptive linear layout here.\n    // Not precise, do not consider align and vertical align\n    // and each distance from axis line yet.\n\n    var rect = getBoundingRect(labelFormatter(tickValue), params.font, 'center', 'top'); // Magic number\n\n    width = rect.width * 1.3;\n    height = rect.height * 1.3; // Min size, void long loop.\n\n    maxW = Math.max(maxW, width, 7);\n    maxH = Math.max(maxH, height, 7);\n  }\n\n  var dw = maxW / unitW;\n  var dh = maxH / unitH; // 0/0 is NaN, 1/0 is Infinity.\n\n  isNaN(dw) && (dw = Infinity);\n  isNaN(dh) && (dh = Infinity);\n  var interval = Math.max(0, Math.floor(Math.min(dw, dh)));\n  var cache = inner$6(axis.model);\n  var lastAutoInterval = cache.lastAutoInterval;\n  var lastTickCount = cache.lastTickCount; // Use cache to keep interval stable while moving zoom window,\n  // otherwise the calculated interval might jitter when the zoom\n  // window size is close to the interval-changing size.\n\n  if (lastAutoInterval != null && lastTickCount != null && Math.abs(lastAutoInterval - interval) <= 1 && Math.abs(lastTickCount - tickCount) <= 1 // Always choose the bigger one, otherwise the critical\n  // point is not the same when zooming in or zooming out.\n  && lastAutoInterval > interval) {\n    interval = lastAutoInterval;\n  } // Only update cache if cache not used, otherwise the\n  // changing of interval is too insensitive.\n  else {\n      cache.lastTickCount = tickCount;\n      cache.lastAutoInterval = interval;\n    }\n\n  return interval;\n}\n\nfunction fetchAutoCategoryIntervalCalculationParams(axis) {\n  var labelModel = axis.getLabelModel();\n  return {\n    axisRotate: axis.getRotate ? axis.getRotate() : axis.isHorizontal && !axis.isHorizontal() ? 90 : 0,\n    labelRotate: labelModel.get('rotate') || 0,\n    font: labelModel.getFont()\n  };\n}\n\nfunction makeLabelsByNumericCategoryInterval(axis, categoryInterval, onlyTick) {\n  var labelFormatter = makeLabelFormatter(axis);\n  var ordinalScale = axis.scale;\n  var ordinalExtent = ordinalScale.getExtent();\n  var labelModel = axis.getLabelModel();\n  var result = []; // TODO: axisType: ordinalTime, pick the tick from each month/day/year/...\n\n  var step = Math.max((categoryInterval || 0) + 1, 1);\n  var startTick = ordinalExtent[0];\n  var tickCount = ordinalScale.count(); // Calculate start tick based on zero if possible to keep label consistent\n  // while zooming and moving while interval > 0. Otherwise the selection\n  // of displayable ticks and symbols probably keep changing.\n  // 3 is empirical value.\n\n  if (startTick !== 0 && step > 1 && tickCount / step > 2) {\n    startTick = Math.round(Math.ceil(startTick / step) * step);\n  } // (1) Only add min max label here but leave overlap checking\n  // to render stage, which also ensure the returned list\n  // suitable for splitLine and splitArea rendering.\n  // (2) Scales except category always contain min max label so\n  // do not need to perform this process.\n\n\n  var showMinMax = {\n    min: labelModel.get('showMinLabel'),\n    max: labelModel.get('showMaxLabel')\n  };\n\n  if (showMinMax.min && startTick !== ordinalExtent[0]) {\n    addItem(ordinalExtent[0]);\n  } // Optimize: avoid generating large array by `ordinalScale.getTicks()`.\n\n\n  var tickValue = startTick;\n\n  for (; tickValue <= ordinalExtent[1]; tickValue += step) {\n    addItem(tickValue);\n  }\n\n  if (showMinMax.max && tickValue !== ordinalExtent[1]) {\n    addItem(ordinalExtent[1]);\n  }\n\n  function addItem(tVal) {\n    result.push(onlyTick ? tVal : {\n      formattedLabel: labelFormatter(tVal),\n      rawLabel: ordinalScale.getLabel(tVal),\n      tickValue: tVal\n    });\n  }\n\n  return result;\n} // When interval is function, the result `false` means ignore the tick.\n// It is time consuming for large category data.\n\n\nfunction makeLabelsByCustomizedCategoryInterval(axis, categoryInterval, onlyTick) {\n  var ordinalScale = axis.scale;\n  var labelFormatter = makeLabelFormatter(axis);\n  var result = [];\n  each$1(ordinalScale.getTicks(), function (tickValue) {\n    var rawLabel = ordinalScale.getLabel(tickValue);\n\n    if (categoryInterval(tickValue, rawLabel)) {\n      result.push(onlyTick ? tickValue : {\n        formattedLabel: labelFormatter(tickValue),\n        rawLabel: rawLabel,\n        tickValue: tickValue\n      });\n    }\n  });\n  return result;\n} // Can be null|'auto'|number|function\n\n\nfunction getOptionCategoryInterval(model) {\n  var interval = model.get('interval');\n  return interval == null ? 'auto' : interval;\n}\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar NORMALIZED_EXTENT = [0, 1];\n/**\n * Base class of Axis.\n * @constructor\n */\n\nvar Axis = function (dim, scale, extent) {\n  /**\n   * Axis dimension. Such as 'x', 'y', 'z', 'angle', 'radius'.\n   * @type {string}\n   */\n  this.dim = dim;\n  /**\n   * Axis scale\n   * @type {module:echarts/coord/scale/*}\n   */\n\n  this.scale = scale;\n  /**\n   * @type {Array.<number>}\n   * @private\n   */\n\n  this._extent = extent || [0, 0];\n  /**\n   * @type {boolean}\n   */\n\n  this.inverse = false;\n  /**\n   * Usually true when axis has a ordinal scale\n   * @type {boolean}\n   */\n\n  this.onBand = false;\n};\n\nAxis.prototype = {\n  constructor: Axis,\n\n  /**\n   * If axis extent contain given coord\n   * @param {number} coord\n   * @return {boolean}\n   */\n  contain: function (coord) {\n    var extent = this._extent;\n    var min = Math.min(extent[0], extent[1]);\n    var max = Math.max(extent[0], extent[1]);\n    return coord >= min && coord <= max;\n  },\n\n  /**\n   * If axis extent contain given data\n   * @param {number} data\n   * @return {boolean}\n   */\n  containData: function (data) {\n    return this.contain(this.dataToCoord(data));\n  },\n\n  /**\n   * Get coord extent.\n   * @return {Array.<number>}\n   */\n  getExtent: function () {\n    return this._extent.slice();\n  },\n\n  /**\n   * Get precision used for formatting\n   * @param {Array.<number>} [dataExtent]\n   * @return {number}\n   */\n  getPixelPrecision: function (dataExtent) {\n    return getPixelPrecision(dataExtent || this.scale.getExtent(), this._extent);\n  },\n\n  /**\n   * Set coord extent\n   * @param {number} start\n   * @param {number} end\n   */\n  setExtent: function (start, end) {\n    var extent = this._extent;\n    extent[0] = start;\n    extent[1] = end;\n  },\n\n  /**\n   * Convert data to coord. Data is the rank if it has an ordinal scale\n   * @param {number} data\n   * @param  {boolean} clamp\n   * @return {number}\n   */\n  dataToCoord: function (data, clamp) {\n    var extent = this._extent;\n    var scale = this.scale;\n    data = scale.normalize(data);\n\n    if (this.onBand && scale.type === 'ordinal') {\n      extent = extent.slice();\n      fixExtentWithBands(extent, scale.count());\n    }\n\n    return linearMap(data, NORMALIZED_EXTENT, extent, clamp);\n  },\n\n  /**\n   * Convert coord to data. Data is the rank if it has an ordinal scale\n   * @param {number} coord\n   * @param  {boolean} clamp\n   * @return {number}\n   */\n  coordToData: function (coord, clamp) {\n    var extent = this._extent;\n    var scale = this.scale;\n\n    if (this.onBand && scale.type === 'ordinal') {\n      extent = extent.slice();\n      fixExtentWithBands(extent, scale.count());\n    }\n\n    var t = linearMap(coord, extent, NORMALIZED_EXTENT, clamp);\n    return this.scale.scale(t);\n  },\n\n  /**\n   * Convert pixel point to data in axis\n   * @param {Array.<number>} point\n   * @param  {boolean} clamp\n   * @return {number} data\n   */\n  pointToData: function (point, clamp) {// Should be implemented in derived class if necessary.\n  },\n\n  /**\n   * Different from `zrUtil.map(axis.getTicks(), axis.dataToCoord, axis)`,\n   * `axis.getTicksCoords` considers `onBand`, which is used by\n   * `boundaryGap:true` of category axis and splitLine and splitArea.\n   * @param {Object} [opt]\n   * @param {number} [opt.tickModel=axis.model.getModel('axisTick')]\n   * @param {boolean} [opt.clamp] If `true`, the first and the last\n   *        tick must be at the axis end points. Otherwise, clip ticks\n   *        that outside the axis extent.\n   * @return {Array.<Object>} [{\n   *     coord: ...,\n   *     tickValue: ...\n   * }, ...]\n   */\n  getTicksCoords: function (opt) {\n    opt = opt || {};\n    var tickModel = opt.tickModel || this.getTickModel();\n    var result = createAxisTicks(this, tickModel);\n    var ticks = result.ticks;\n    var ticksCoords = map(ticks, function (tickValue) {\n      return {\n        coord: this.dataToCoord(tickValue),\n        tickValue: tickValue\n      };\n    }, this);\n    var alignWithLabel = tickModel.get('alignWithLabel');\n    fixOnBandTicksCoords(this, ticksCoords, result.tickCategoryInterval, alignWithLabel, opt.clamp);\n    return ticksCoords;\n  },\n\n  /**\n   * @return {Array.<Object>} [{\n   *     formattedLabel: string,\n   *     rawLabel: axis.scale.getLabel(tickValue)\n   *     tickValue: number\n   * }, ...]\n   */\n  getViewLabels: function () {\n    return createAxisLabels(this).labels;\n  },\n\n  /**\n   * @return {module:echarts/coord/model/Model}\n   */\n  getLabelModel: function () {\n    return this.model.getModel('axisLabel');\n  },\n\n  /**\n   * Notice here we only get the default tick model. For splitLine\n   * or splitArea, we should pass the splitLineModel or splitAreaModel\n   * manually when calling `getTicksCoords`.\n   * In GL, this method may be overrided to:\n   * `axisModel.getModel('axisTick', grid3DModel.getModel('axisTick'));`\n   * @return {module:echarts/coord/model/Model}\n   */\n  getTickModel: function () {\n    return this.model.getModel('axisTick');\n  },\n\n  /**\n   * Get width of band\n   * @return {number}\n   */\n  getBandWidth: function () {\n    var axisExtent = this._extent;\n    var dataExtent = this.scale.getExtent();\n    var len = dataExtent[1] - dataExtent[0] + (this.onBand ? 1 : 0); // Fix #2728, avoid NaN when only one data.\n\n    len === 0 && (len = 1);\n    var size = Math.abs(axisExtent[1] - axisExtent[0]);\n    return Math.abs(size) / len;\n  },\n\n  /**\n   * @abstract\n   * @return {boolean} Is horizontal\n   */\n  isHorizontal: null,\n\n  /**\n   * @abstract\n   * @return {number} Get axis rotate, by degree.\n   */\n  getRotate: null,\n\n  /**\n   * Only be called in category axis.\n   * Can be overrided, consider other axes like in 3D.\n   * @return {number} Auto interval for cateogry axis tick and label\n   */\n  calculateCategoryInterval: function () {\n    return calculateCategoryInterval(this);\n  }\n};\n\nfunction fixExtentWithBands(extent, nTick) {\n  var size = extent[1] - extent[0];\n  var len = nTick;\n  var margin = size / len / 2;\n  extent[0] += margin;\n  extent[1] -= margin;\n} // If axis has labels [1, 2, 3, 4]. Bands on the axis are\n// |---1---|---2---|---3---|---4---|.\n// So the displayed ticks and splitLine/splitArea should between\n// each data item, otherwise cause misleading (e.g., split tow bars\n// of a single data item when there are two bar series).\n// Also consider if tickCategoryInterval > 0 and onBand, ticks and\n// splitLine/spliteArea should layout appropriately corresponding\n// to displayed labels. (So we should not use `getBandWidth` in this\n// case).\n\n\nfunction fixOnBandTicksCoords(axis, ticksCoords, tickCategoryInterval, alignWithLabel, clamp) {\n  var ticksLen = ticksCoords.length;\n\n  if (!axis.onBand || alignWithLabel || !ticksLen) {\n    return;\n  }\n\n  var axisExtent = axis.getExtent();\n  var last;\n\n  if (ticksLen === 1) {\n    ticksCoords[0].coord = axisExtent[0];\n    last = ticksCoords[1] = {\n      coord: axisExtent[0]\n    };\n  } else {\n    var shift = ticksCoords[1].coord - ticksCoords[0].coord;\n    each$1(ticksCoords, function (ticksItem) {\n      ticksItem.coord -= shift / 2;\n      var tickCategoryInterval = tickCategoryInterval || 0; // Avoid split a single data item when odd interval.\n\n      if (tickCategoryInterval % 2 > 0) {\n        ticksItem.coord -= shift / ((tickCategoryInterval + 1) * 2);\n      }\n    });\n    last = {\n      coord: ticksCoords[ticksLen - 1].coord + shift\n    };\n    ticksCoords.push(last);\n  }\n\n  var inverse = axisExtent[0] > axisExtent[1];\n\n  if (littleThan(ticksCoords[0].coord, axisExtent[0])) {\n    clamp ? ticksCoords[0].coord = axisExtent[0] : ticksCoords.shift();\n  }\n\n  if (clamp && littleThan(axisExtent[0], ticksCoords[0].coord)) {\n    ticksCoords.unshift({\n      coord: axisExtent[0]\n    });\n  }\n\n  if (littleThan(axisExtent[1], last.coord)) {\n    clamp ? last.coord = axisExtent[1] : ticksCoords.pop();\n  }\n\n  if (clamp && littleThan(last.coord, axisExtent[1])) {\n    ticksCoords.push({\n      coord: axisExtent[1]\n    });\n  }\n\n  function littleThan(a, b) {\n    return inverse ? a > b : a < b;\n  }\n}\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * Do not mount those modules on 'src/echarts' for better tree shaking.\n */\nvar parseGeoJson = parseGeoJSON;\nvar ecUtil = {};\neach$1(['map', 'each', 'filter', 'indexOf', 'inherits', 'reduce', 'filter', 'bind', 'curry', 'isArray', 'isString', 'isObject', 'isFunction', 'extend', 'defaults', 'clone', 'merge'], function (name) {\n  ecUtil[name] = zrUtil[name];\n});\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * Cartesian coordinate system\n * @module  echarts/coord/Cartesian\n *\n */\nfunction dimAxisMapper(dim) {\n  return this._axes[dim];\n}\n/**\n * @alias module:echarts/coord/Cartesian\n * @constructor\n */\n\n\nvar Cartesian = function (name) {\n  this._axes = {};\n  this._dimList = [];\n  /**\n   * @type {string}\n   */\n\n  this.name = name || '';\n};\n\nCartesian.prototype = {\n  constructor: Cartesian,\n  type: 'cartesian',\n\n  /**\n   * Get axis\n   * @param  {number|string} dim\n   * @return {module:echarts/coord/Cartesian~Axis}\n   */\n  getAxis: function (dim) {\n    return this._axes[dim];\n  },\n\n  /**\n   * Get axes list\n   * @return {Array.<module:echarts/coord/Cartesian~Axis>}\n   */\n  getAxes: function () {\n    return map(this._dimList, dimAxisMapper, this);\n  },\n\n  /**\n   * Get axes list by given scale type\n   */\n  getAxesByScale: function (scaleType) {\n    scaleType = scaleType.toLowerCase();\n    return filter(this.getAxes(), function (axis) {\n      return axis.scale.type === scaleType;\n    });\n  },\n\n  /**\n   * Add axis\n   * @param {module:echarts/coord/Cartesian.Axis}\n   */\n  addAxis: function (axis) {\n    var dim = axis.dim;\n    this._axes[dim] = axis;\n\n    this._dimList.push(dim);\n  },\n\n  /**\n   * Convert data to coord in nd space\n   * @param {Array.<number>|Object.<string, number>} val\n   * @return {Array.<number>|Object.<string, number>}\n   */\n  dataToCoord: function (val) {\n    return this._dataCoordConvert(val, 'dataToCoord');\n  },\n\n  /**\n   * Convert coord in nd space to data\n   * @param  {Array.<number>|Object.<string, number>} val\n   * @return {Array.<number>|Object.<string, number>}\n   */\n  coordToData: function (val) {\n    return this._dataCoordConvert(val, 'coordToData');\n  },\n  _dataCoordConvert: function (input, method) {\n    var dimList = this._dimList;\n    var output = input instanceof Array ? [] : {};\n\n    for (var i = 0; i < dimList.length; i++) {\n      var dim = dimList[i];\n      var axis = this._axes[dim];\n      output[dim] = axis[method](input[dim]);\n    }\n\n    return output;\n  }\n};\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nfunction Cartesian2D(name) {\n  Cartesian.call(this, name);\n}\n\nCartesian2D.prototype = {\n  constructor: Cartesian2D,\n  type: 'cartesian2d',\n\n  /**\n   * @type {Array.<string>}\n   * @readOnly\n   */\n  dimensions: ['x', 'y'],\n\n  /**\n   * Base axis will be used on stacking.\n   *\n   * @return {module:echarts/coord/cartesian/Axis2D}\n   */\n  getBaseAxis: function () {\n    return this.getAxesByScale('ordinal')[0] || this.getAxesByScale('time')[0] || this.getAxis('x');\n  },\n\n  /**\n   * If contain point\n   * @param {Array.<number>} point\n   * @return {boolean}\n   */\n  containPoint: function (point) {\n    var axisX = this.getAxis('x');\n    var axisY = this.getAxis('y');\n    return axisX.contain(axisX.toLocalCoord(point[0])) && axisY.contain(axisY.toLocalCoord(point[1]));\n  },\n\n  /**\n   * If contain data\n   * @param {Array.<number>} data\n   * @return {boolean}\n   */\n  containData: function (data) {\n    return this.getAxis('x').containData(data[0]) && this.getAxis('y').containData(data[1]);\n  },\n\n  /**\n   * @param {Array.<number>} data\n   * @param {Array.<number>} out\n   * @return {Array.<number>}\n   */\n  dataToPoint: function (data, reserved, out) {\n    var xAxis = this.getAxis('x');\n    var yAxis = this.getAxis('y');\n    out = out || [];\n    out[0] = xAxis.toGlobalCoord(xAxis.dataToCoord(data[0]));\n    out[1] = yAxis.toGlobalCoord(yAxis.dataToCoord(data[1]));\n    return out;\n  },\n\n  /**\n   * @param {Array.<number>} data\n   * @param {Array.<number>} out\n   * @return {Array.<number>}\n   */\n  clampData: function (data, out) {\n    var xScale = this.getAxis('x').scale;\n    var yScale = this.getAxis('y').scale;\n    var xAxisExtent = xScale.getExtent();\n    var yAxisExtent = yScale.getExtent();\n    var x = xScale.parse(data[0]);\n    var y = yScale.parse(data[1]);\n    out = out || [];\n    out[0] = Math.min(Math.max(Math.min(xAxisExtent[0], xAxisExtent[1]), x), Math.max(xAxisExtent[0], xAxisExtent[1]));\n    out[1] = Math.min(Math.max(Math.min(yAxisExtent[0], yAxisExtent[1]), y), Math.max(yAxisExtent[0], yAxisExtent[1]));\n    return out;\n  },\n\n  /**\n   * @param {Array.<number>} point\n   * @param {Array.<number>} out\n   * @return {Array.<number>}\n   */\n  pointToData: function (point, out) {\n    var xAxis = this.getAxis('x');\n    var yAxis = this.getAxis('y');\n    out = out || [];\n    out[0] = xAxis.coordToData(xAxis.toLocalCoord(point[0]));\n    out[1] = yAxis.coordToData(yAxis.toLocalCoord(point[1]));\n    return out;\n  },\n\n  /**\n   * Get other axis\n   * @param {module:echarts/coord/cartesian/Axis2D} axis\n   */\n  getOtherAxis: function (axis) {\n    return this.getAxis(axis.dim === 'x' ? 'y' : 'x');\n  }\n};\ninherits(Cartesian2D, Cartesian);\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n/**\n * Extend axis 2d\n * @constructor module:echarts/coord/cartesian/Axis2D\n * @extends {module:echarts/coord/cartesian/Axis}\n * @param {string} dim\n * @param {*} scale\n * @param {Array.<number>} coordExtent\n * @param {string} axisType\n * @param {string} position\n */\n\nvar Axis2D = function (dim, scale, coordExtent, axisType, position) {\n  Axis.call(this, dim, scale, coordExtent);\n  /**\n   * Axis type\n   *  - 'category'\n   *  - 'value'\n   *  - 'time'\n   *  - 'log'\n   * @type {string}\n   */\n\n  this.type = axisType || 'value';\n  /**\n   * Axis position\n   *  - 'top'\n   *  - 'bottom'\n   *  - 'left'\n   *  - 'right'\n   */\n\n  this.position = position || 'bottom';\n};\n\nAxis2D.prototype = {\n  constructor: Axis2D,\n\n  /**\n   * Index of axis, can be used as key\n   */\n  index: 0,\n\n  /**\n   * Implemented in <module:echarts/coord/cartesian/Grid>.\n   * @return {Array.<module:echarts/coord/cartesian/Axis2D>}\n   *         If not on zero of other axis, return null/undefined.\n   *         If no axes, return an empty array.\n   */\n  getAxesOnZeroOf: null,\n\n  /**\n   * Axis model\n   * @param {module:echarts/coord/cartesian/AxisModel}\n   */\n  model: null,\n  isHorizontal: function () {\n    var position = this.position;\n    return position === 'top' || position === 'bottom';\n  },\n\n  /**\n   * Each item cooresponds to this.getExtent(), which\n   * means globalExtent[0] may greater than globalExtent[1],\n   * unless `asc` is input.\n   *\n   * @param {boolean} [asc]\n   * @return {Array.<number>}\n   */\n  getGlobalExtent: function (asc) {\n    var ret = this.getExtent();\n    ret[0] = this.toGlobalCoord(ret[0]);\n    ret[1] = this.toGlobalCoord(ret[1]);\n    asc && ret[0] > ret[1] && ret.reverse();\n    return ret;\n  },\n  getOtherAxis: function () {\n    this.grid.getOtherAxis();\n  },\n\n  /**\n   * @override\n   */\n  pointToData: function (point, clamp) {\n    return this.coordToData(this.toLocalCoord(point[this.dim === 'x' ? 0 : 1]), clamp);\n  },\n\n  /**\n   * Transform global coord to local coord,\n   * i.e. var localCoord = axis.toLocalCoord(80);\n   * designate by module:echarts/coord/cartesian/Grid.\n   * @type {Function}\n   */\n  toLocalCoord: null,\n\n  /**\n   * Transform global coord to local coord,\n   * i.e. var globalCoord = axis.toLocalCoord(40);\n   * designate by module:echarts/coord/cartesian/Grid.\n   * @type {Function}\n   */\n  toGlobalCoord: null\n};\ninherits(Axis2D, Axis);\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar defaultOption = {\n  show: true,\n  zlevel: 0,\n  z: 0,\n  // Inverse the axis.\n  inverse: false,\n  // Axis name displayed.\n  name: '',\n  // 'start' | 'middle' | 'end'\n  nameLocation: 'end',\n  // By degree. By defualt auto rotate by nameLocation.\n  nameRotate: null,\n  nameTruncate: {\n    maxWidth: null,\n    ellipsis: '...',\n    placeholder: '.'\n  },\n  // Use global text style by default.\n  nameTextStyle: {},\n  // The gap between axisName and axisLine.\n  nameGap: 15,\n  // Default `false` to support tooltip.\n  silent: false,\n  // Default `false` to avoid legacy user event listener fail.\n  triggerEvent: false,\n  tooltip: {\n    show: false\n  },\n  axisPointer: {},\n  axisLine: {\n    show: true,\n    onZero: true,\n    onZeroAxisIndex: null,\n    lineStyle: {\n      color: '#333',\n      width: 1,\n      type: 'solid'\n    },\n    // The arrow at both ends the the axis.\n    symbol: ['none', 'none'],\n    symbolSize: [10, 15]\n  },\n  axisTick: {\n    show: true,\n    // Whether axisTick is inside the grid or outside the grid.\n    inside: false,\n    // The length of axisTick.\n    length: 5,\n    lineStyle: {\n      width: 1\n    }\n  },\n  axisLabel: {\n    show: true,\n    // Whether axisLabel is inside the grid or outside the grid.\n    inside: false,\n    rotate: 0,\n    // true | false | null/undefined (auto)\n    showMinLabel: null,\n    // true | false | null/undefined (auto)\n    showMaxLabel: null,\n    margin: 8,\n    // formatter: null,\n    fontSize: 12\n  },\n  splitLine: {\n    show: true,\n    lineStyle: {\n      color: ['#ccc'],\n      width: 1,\n      type: 'solid'\n    }\n  },\n  splitArea: {\n    show: false,\n    areaStyle: {\n      color: ['rgba(250,250,250,0.3)', 'rgba(200,200,200,0.3)']\n    }\n  }\n};\nvar axisDefault = {};\naxisDefault.categoryAxis = merge({\n  // The gap at both ends of the axis. For categoryAxis, boolean.\n  boundaryGap: true,\n  // Set false to faster category collection.\n  // Only usefull in the case like: category is\n  // ['2012-01-01', '2012-01-02', ...], where the input\n  // data has been ensured not duplicate and is large data.\n  // null means \"auto\":\n  // if axis.data provided, do not deduplication,\n  // else do deduplication.\n  deduplication: null,\n  // splitArea: {\n  // show: false\n  // },\n  splitLine: {\n    show: false\n  },\n  axisTick: {\n    // If tick is align with label when boundaryGap is true\n    alignWithLabel: false,\n    interval: 'auto'\n  },\n  axisLabel: {\n    interval: 'auto'\n  }\n}, defaultOption);\naxisDefault.valueAxis = merge({\n  // The gap at both ends of the axis. For value axis, [GAP, GAP], where\n  // `GAP` can be an absolute pixel number (like `35`), or percent (like `'30%'`)\n  boundaryGap: [0, 0],\n  // TODO\n  // min/max: [30, datamin, 60] or [20, datamin] or [datamin, 60]\n  // Min value of the axis. can be:\n  // + a number\n  // + 'dataMin': use the min value in data.\n  // + null/undefined: auto decide min value (consider pretty look and boundaryGap).\n  // min: null,\n  // Max value of the axis. can be:\n  // + a number\n  // + 'dataMax': use the max value in data.\n  // + null/undefined: auto decide max value (consider pretty look and boundaryGap).\n  // max: null,\n  // Readonly prop, specifies start value of the range when using data zoom.\n  // rangeStart: null\n  // Readonly prop, specifies end value of the range when using data zoom.\n  // rangeEnd: null\n  // Optional value can be:\n  // + `false`: always include value 0.\n  // + `true`: the extent do not consider value 0.\n  // scale: false,\n  // AxisTick and axisLabel and splitLine are caculated based on splitNumber.\n  splitNumber: 5 // Interval specifies the span of the ticks is mandatorily.\n  // interval: null\n  // Specify min interval when auto calculate tick interval.\n  // minInterval: null\n  // Specify max interval when auto calculate tick interval.\n  // maxInterval: null\n\n}, defaultOption);\naxisDefault.timeAxis = defaults({\n  scale: true,\n  min: 'dataMin',\n  max: 'dataMax'\n}, axisDefault.valueAxis);\naxisDefault.logAxis = defaults({\n  scale: true,\n  logBase: 10\n}, axisDefault.valueAxis);\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar AXIS_TYPES = ['value', 'category', 'time', 'log'];\n/**\n * Generate sub axis model class\n * @param {string} axisName 'x' 'y' 'radius' 'angle' 'parallel'\n * @param {module:echarts/model/Component} BaseAxisModelClass\n * @param {Function} axisTypeDefaulter\n * @param {Object} [extraDefaultOption]\n */\n\nvar axisModelCreator = function (axisName, BaseAxisModelClass, axisTypeDefaulter, extraDefaultOption) {\n  each$1(AXIS_TYPES, function (axisType) {\n    BaseAxisModelClass.extend({\n      /**\n       * @readOnly\n       */\n      type: axisName + 'Axis.' + axisType,\n      mergeDefaultAndTheme: function (option, ecModel) {\n        var layoutMode = this.layoutMode;\n        var inputPositionParams = layoutMode ? getLayoutParams(option) : {};\n        var themeModel = ecModel.getTheme();\n        merge(option, themeModel.get(axisType + 'Axis'));\n        merge(option, this.getDefaultOption());\n        option.type = axisTypeDefaulter(axisName, option);\n\n        if (layoutMode) {\n          mergeLayoutParam(option, inputPositionParams, layoutMode);\n        }\n      },\n\n      /**\n       * @override\n       */\n      optionUpdated: function () {\n        var thisOption = this.option;\n\n        if (thisOption.type === 'category') {\n          this.__ordinalMeta = OrdinalMeta.createByAxisModel(this);\n        }\n      },\n\n      /**\n       * Should not be called before all of 'getInitailData' finished.\n       * Because categories are collected during initializing data.\n       */\n      getCategories: function (rawData) {\n        var option = this.option; // FIXME\n        // warning if called before all of 'getInitailData' finished.\n\n        if (option.type === 'category') {\n          if (rawData) {\n            return option.data;\n          }\n\n          return this.__ordinalMeta.categories;\n        }\n      },\n      getOrdinalMeta: function () {\n        return this.__ordinalMeta;\n      },\n      defaultOption: mergeAll([{}, axisDefault[axisType + 'Axis'], extraDefaultOption], true)\n    });\n  });\n  ComponentModel.registerSubTypeDefaulter(axisName + 'Axis', curry(axisTypeDefaulter, axisName));\n};\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar AxisModel = ComponentModel.extend({\n  type: 'cartesian2dAxis',\n\n  /**\n   * @type {module:echarts/coord/cartesian/Axis2D}\n   */\n  axis: null,\n\n  /**\n   * @override\n   */\n  init: function () {\n    AxisModel.superApply(this, 'init', arguments);\n    this.resetRange();\n  },\n\n  /**\n   * @override\n   */\n  mergeOption: function () {\n    AxisModel.superApply(this, 'mergeOption', arguments);\n    this.resetRange();\n  },\n\n  /**\n   * @override\n   */\n  restoreData: function () {\n    AxisModel.superApply(this, 'restoreData', arguments);\n    this.resetRange();\n  },\n\n  /**\n   * @override\n   * @return {module:echarts/model/Component}\n   */\n  getCoordSysModel: function () {\n    return this.ecModel.queryComponents({\n      mainType: 'grid',\n      index: this.option.gridIndex,\n      id: this.option.gridId\n    })[0];\n  }\n});\n\nfunction getAxisType(axisDim, option) {\n  // Default axis with data is category axis\n  return option.type || (option.data ? 'category' : 'value');\n}\n\nmerge(AxisModel.prototype, axisModelCommonMixin);\nvar extraOption = {\n  // gridIndex: 0,\n  // gridId: '',\n  // Offset is for multiple axis on the same position\n  offset: 0\n};\naxisModelCreator('x', AxisModel, getAxisType, extraOption);\naxisModelCreator('y', AxisModel, getAxisType, extraOption);\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n// Grid \n//  Cartesian2D \nComponentModel.extend({\n  type: 'grid',\n  dependencies: ['xAxis', 'yAxis'],\n  layoutMode: 'box',\n\n  /**\n   * @type {module:echarts/coord/cartesian/Grid}\n   */\n  coordinateSystem: null,\n  defaultOption: {\n    show: false,\n    zlevel: 0,\n    z: 0,\n    left: '10%',\n    top: 60,\n    right: '10%',\n    bottom: 60,\n    // If grid size contain label\n    containLabel: false,\n    // width: {totalWidth} - left - right,\n    // height: {totalHeight} - top - bottom,\n    backgroundColor: 'rgba(0,0,0,0)',\n    borderWidth: 1,\n    borderColor: '#ccc'\n  }\n});\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * Grid is a region which contains at most 4 cartesian systems\n *\n * TODO Default cartesian\n */\n/**\n * Check if the axis is used in the specified grid\n * @inner\n */\n\nfunction isAxisUsedInTheGrid(axisModel, gridModel, ecModel) {\n  return axisModel.getCoordSysModel() === gridModel;\n}\n\nfunction Grid(gridModel, ecModel, api) {\n  /**\n   * @type {Object.<string, module:echarts/coord/cartesian/Cartesian2D>}\n   * @private\n   */\n  this._coordsMap = {};\n  /**\n   * @type {Array.<module:echarts/coord/cartesian/Cartesian>}\n   * @private\n   */\n\n  this._coordsList = [];\n  /**\n   * @type {Object.<string, module:echarts/coord/cartesian/Axis2D>}\n   * @private\n   */\n\n  this._axesMap = {};\n  /**\n   * @type {Array.<module:echarts/coord/cartesian/Axis2D>}\n   * @private\n   */\n\n  this._axesList = [];\n\n  this._initCartesian(gridModel, ecModel, api);\n\n  this.model = gridModel;\n}\n\nvar gridProto = Grid.prototype;\ngridProto.type = 'grid';\ngridProto.axisPointerEnabled = true;\n\ngridProto.getRect = function () {\n  return this._rect;\n};\n\ngridProto.update = function (ecModel, api) {\n  var axesMap = this._axesMap;\n\n  this._updateScale(ecModel, this.model);\n\n  each$1(axesMap.x, function (xAxis) {\n    niceScaleExtent(xAxis.scale, xAxis.model);\n  });\n  each$1(axesMap.y, function (yAxis) {\n    niceScaleExtent(yAxis.scale, yAxis.model);\n  });\n  each$1(axesMap.x, function (xAxis) {\n    fixAxisOnZero(axesMap, 'y', xAxis);\n  });\n  each$1(axesMap.y, function (yAxis) {\n    fixAxisOnZero(axesMap, 'x', yAxis);\n  }); // Resize again if containLabel is enabled\n  // FIXME It may cause getting wrong grid size in data processing stage\n\n  this.resize(this.model, api);\n};\n\nfunction fixAxisOnZero(axesMap, otherAxisDim, axis) {\n  axis.getAxesOnZeroOf = function () {\n    // TODO: onZero of multiple axes.\n    return otherAxis ? [otherAxis] : [];\n  }; // onZero can not be enabled in these two situations:\n  // 1. When any other axis is a category axis.\n  // 2. When no axis is cross 0 point.\n\n\n  var otherAxes = axesMap[otherAxisDim];\n  var otherAxis;\n  var axisModel = axis.model;\n  var onZero = axisModel.get('axisLine.onZero');\n  var onZeroAxisIndex = axisModel.get('axisLine.onZeroAxisIndex');\n\n  if (!onZero) {\n    return;\n  } // If target axis is specified.\n\n\n  if (onZeroAxisIndex != null) {\n    if (canOnZeroToAxis(otherAxes[onZeroAxisIndex])) {\n      otherAxis = otherAxes[onZeroAxisIndex];\n    }\n\n    return;\n  } // Find the first available other axis.\n\n\n  for (var idx in otherAxes) {\n    if (otherAxes.hasOwnProperty(idx) && canOnZeroToAxis(otherAxes[idx])) {\n      otherAxis = otherAxes[idx];\n      break;\n    }\n  }\n}\n\nfunction canOnZeroToAxis(axis) {\n  return axis && axis.type !== 'category' && axis.type !== 'time' && ifAxisCrossZero(axis);\n}\n/**\n * Resize the grid\n * @param {module:echarts/coord/cartesian/GridModel} gridModel\n * @param {module:echarts/ExtensionAPI} api\n */\n\n\ngridProto.resize = function (gridModel, api, ignoreContainLabel) {\n  var gridRect = getLayoutRect(gridModel.getBoxLayoutParams(), {\n    width: api.getWidth(),\n    height: api.getHeight()\n  });\n  this._rect = gridRect;\n  var axesList = this._axesList;\n  adjustAxes(); // Minus label size\n\n  if (!ignoreContainLabel && gridModel.get('containLabel')) {\n    each$1(axesList, function (axis) {\n      if (!axis.model.get('axisLabel.inside')) {\n        var labelUnionRect = estimateLabelUnionRect(axis);\n\n        if (labelUnionRect) {\n          var dim = axis.isHorizontal() ? 'height' : 'width';\n          var margin = axis.model.get('axisLabel.margin');\n          gridRect[dim] -= labelUnionRect[dim] + margin;\n\n          if (axis.position === 'top') {\n            gridRect.y += labelUnionRect.height + margin;\n          } else if (axis.position === 'left') {\n            gridRect.x += labelUnionRect.width + margin;\n          }\n        }\n      }\n    });\n    adjustAxes();\n  }\n\n  function adjustAxes() {\n    each$1(axesList, function (axis) {\n      var isHorizontal = axis.isHorizontal();\n      var extent = isHorizontal ? [0, gridRect.width] : [0, gridRect.height];\n      var idx = axis.inverse ? 1 : 0;\n      axis.setExtent(extent[idx], extent[1 - idx]);\n      updateAxisTransform(axis, isHorizontal ? gridRect.x : gridRect.y);\n    });\n  }\n};\n/**\n * @param {string} axisType\n * @param {number} [axisIndex]\n */\n\n\ngridProto.getAxis = function (axisType, axisIndex) {\n  var axesMapOnDim = this._axesMap[axisType];\n\n  if (axesMapOnDim != null) {\n    if (axisIndex == null) {\n      // Find first axis\n      for (var name in axesMapOnDim) {\n        if (axesMapOnDim.hasOwnProperty(name)) {\n          return axesMapOnDim[name];\n        }\n      }\n    }\n\n    return axesMapOnDim[axisIndex];\n  }\n};\n/**\n * @return {Array.<module:echarts/coord/Axis>}\n */\n\n\ngridProto.getAxes = function () {\n  return this._axesList.slice();\n};\n/**\n * Usage:\n *      grid.getCartesian(xAxisIndex, yAxisIndex);\n *      grid.getCartesian(xAxisIndex);\n *      grid.getCartesian(null, yAxisIndex);\n *      grid.getCartesian({xAxisIndex: ..., yAxisIndex: ...});\n *\n * @param {number|Object} [xAxisIndex]\n * @param {number} [yAxisIndex]\n */\n\n\ngridProto.getCartesian = function (xAxisIndex, yAxisIndex) {\n  if (xAxisIndex != null && yAxisIndex != null) {\n    var key = 'x' + xAxisIndex + 'y' + yAxisIndex;\n    return this._coordsMap[key];\n  }\n\n  if (isObject$1(xAxisIndex)) {\n    yAxisIndex = xAxisIndex.yAxisIndex;\n    xAxisIndex = xAxisIndex.xAxisIndex;\n  } // When only xAxisIndex or yAxisIndex given, find its first cartesian.\n\n\n  for (var i = 0, coordList = this._coordsList; i < coordList.length; i++) {\n    if (coordList[i].getAxis('x').index === xAxisIndex || coordList[i].getAxis('y').index === yAxisIndex) {\n      return coordList[i];\n    }\n  }\n};\n\ngridProto.getCartesians = function () {\n  return this._coordsList.slice();\n};\n/**\n * @implements\n * see {module:echarts/CoodinateSystem}\n */\n\n\ngridProto.convertToPixel = function (ecModel, finder, value) {\n  var target = this._findConvertTarget(ecModel, finder);\n\n  return target.cartesian ? target.cartesian.dataToPoint(value) : target.axis ? target.axis.toGlobalCoord(target.axis.dataToCoord(value)) : null;\n};\n/**\n * @implements\n * see {module:echarts/CoodinateSystem}\n */\n\n\ngridProto.convertFromPixel = function (ecModel, finder, value) {\n  var target = this._findConvertTarget(ecModel, finder);\n\n  return target.cartesian ? target.cartesian.pointToData(value) : target.axis ? target.axis.coordToData(target.axis.toLocalCoord(value)) : null;\n};\n/**\n * @inner\n */\n\n\ngridProto._findConvertTarget = function (ecModel, finder) {\n  var seriesModel = finder.seriesModel;\n  var xAxisModel = finder.xAxisModel || seriesModel && seriesModel.getReferringComponents('xAxis')[0];\n  var yAxisModel = finder.yAxisModel || seriesModel && seriesModel.getReferringComponents('yAxis')[0];\n  var gridModel = finder.gridModel;\n  var coordsList = this._coordsList;\n  var cartesian;\n  var axis;\n\n  if (seriesModel) {\n    cartesian = seriesModel.coordinateSystem;\n    indexOf(coordsList, cartesian) < 0 && (cartesian = null);\n  } else if (xAxisModel && yAxisModel) {\n    cartesian = this.getCartesian(xAxisModel.componentIndex, yAxisModel.componentIndex);\n  } else if (xAxisModel) {\n    axis = this.getAxis('x', xAxisModel.componentIndex);\n  } else if (yAxisModel) {\n    axis = this.getAxis('y', yAxisModel.componentIndex);\n  } // Lowest priority.\n  else if (gridModel) {\n      var grid = gridModel.coordinateSystem;\n\n      if (grid === this) {\n        cartesian = this._coordsList[0];\n      }\n    }\n\n  return {\n    cartesian: cartesian,\n    axis: axis\n  };\n};\n/**\n * @implements\n * see {module:echarts/CoodinateSystem}\n */\n\n\ngridProto.containPoint = function (point) {\n  var coord = this._coordsList[0];\n\n  if (coord) {\n    return coord.containPoint(point);\n  }\n};\n/**\n * Initialize cartesian coordinate systems\n * @private\n */\n\n\ngridProto._initCartesian = function (gridModel, ecModel, api) {\n  var axisPositionUsed = {\n    left: false,\n    right: false,\n    top: false,\n    bottom: false\n  };\n  var axesMap = {\n    x: {},\n    y: {}\n  };\n  var axesCount = {\n    x: 0,\n    y: 0\n  }; /// Create axis\n\n  ecModel.eachComponent('xAxis', createAxisCreator('x'), this);\n  ecModel.eachComponent('yAxis', createAxisCreator('y'), this);\n\n  if (!axesCount.x || !axesCount.y) {\n    // Roll back when there no either x or y axis\n    this._axesMap = {};\n    this._axesList = [];\n    return;\n  }\n\n  this._axesMap = axesMap; /// Create cartesian2d\n\n  each$1(axesMap.x, function (xAxis, xAxisIndex) {\n    each$1(axesMap.y, function (yAxis, yAxisIndex) {\n      var key = 'x' + xAxisIndex + 'y' + yAxisIndex;\n      var cartesian = new Cartesian2D(key);\n      cartesian.grid = this;\n      cartesian.model = gridModel;\n      this._coordsMap[key] = cartesian;\n\n      this._coordsList.push(cartesian);\n\n      cartesian.addAxis(xAxis);\n      cartesian.addAxis(yAxis);\n    }, this);\n  }, this);\n\n  function createAxisCreator(axisType) {\n    return function (axisModel, idx) {\n      if (!isAxisUsedInTheGrid(axisModel, gridModel, ecModel)) {\n        return;\n      }\n\n      var axisPosition = axisModel.get('position');\n\n      if (axisType === 'x') {\n        // Fix position\n        if (axisPosition !== 'top' && axisPosition !== 'bottom') {\n          // Default bottom of X\n          axisPosition = 'bottom';\n\n          if (axisPositionUsed[axisPosition]) {\n            axisPosition = axisPosition === 'top' ? 'bottom' : 'top';\n          }\n        }\n      } else {\n        // Fix position\n        if (axisPosition !== 'left' && axisPosition !== 'right') {\n          // Default left of Y\n          axisPosition = 'left';\n\n          if (axisPositionUsed[axisPosition]) {\n            axisPosition = axisPosition === 'left' ? 'right' : 'left';\n          }\n        }\n      }\n\n      axisPositionUsed[axisPosition] = true;\n      var axis = new Axis2D(axisType, createScaleByModel(axisModel), [0, 0], axisModel.get('type'), axisPosition);\n      var isCategory = axis.type === 'category';\n      axis.onBand = isCategory && axisModel.get('boundaryGap');\n      axis.inverse = axisModel.get('inverse'); // Inject axis into axisModel\n\n      axisModel.axis = axis; // Inject axisModel into axis\n\n      axis.model = axisModel; // Inject grid info axis\n\n      axis.grid = this; // Index of axis, can be used as key\n\n      axis.index = idx;\n\n      this._axesList.push(axis);\n\n      axesMap[axisType][idx] = axis;\n      axesCount[axisType]++;\n    };\n  }\n};\n/**\n * Update cartesian properties from series\n * @param  {module:echarts/model/Option} option\n * @private\n */\n\n\ngridProto._updateScale = function (ecModel, gridModel) {\n  // Reset scale\n  each$1(this._axesList, function (axis) {\n    axis.scale.setExtent(Infinity, -Infinity);\n  });\n  ecModel.eachSeries(function (seriesModel) {\n    if (isCartesian2D(seriesModel)) {\n      var axesModels = findAxesModels(seriesModel, ecModel);\n      var xAxisModel = axesModels[0];\n      var yAxisModel = axesModels[1];\n\n      if (!isAxisUsedInTheGrid(xAxisModel, gridModel, ecModel) || !isAxisUsedInTheGrid(yAxisModel, gridModel, ecModel)) {\n        return;\n      }\n\n      var cartesian = this.getCartesian(xAxisModel.componentIndex, yAxisModel.componentIndex);\n      var data = seriesModel.getData();\n      var xAxis = cartesian.getAxis('x');\n      var yAxis = cartesian.getAxis('y');\n\n      if (data.type === 'list') {\n        unionExtent(data, xAxis, seriesModel);\n        unionExtent(data, yAxis, seriesModel);\n      }\n    }\n  }, this);\n\n  function unionExtent(data, axis, seriesModel) {\n    each$1(data.mapDimension(axis.dim, true), function (dim) {\n      axis.scale.unionExtentFromData( // For example, the extent of the orginal dimension\n      // is [0.1, 0.5], the extent of the `stackResultDimension`\n      // is [7, 9], the final extent should not include [0.1, 0.5].\n      data, getStackedDimension(data, dim));\n    });\n  }\n};\n/**\n * @param {string} [dim] 'x' or 'y' or 'auto' or null/undefined\n * @return {Object} {baseAxes: [], otherAxes: []}\n */\n\n\ngridProto.getTooltipAxes = function (dim) {\n  var baseAxes = [];\n  var otherAxes = [];\n  each$1(this.getCartesians(), function (cartesian) {\n    var baseAxis = dim != null && dim !== 'auto' ? cartesian.getAxis(dim) : cartesian.getBaseAxis();\n    var otherAxis = cartesian.getOtherAxis(baseAxis);\n    indexOf(baseAxes, baseAxis) < 0 && baseAxes.push(baseAxis);\n    indexOf(otherAxes, otherAxis) < 0 && otherAxes.push(otherAxis);\n  });\n  return {\n    baseAxes: baseAxes,\n    otherAxes: otherAxes\n  };\n};\n/**\n * @inner\n */\n\n\nfunction updateAxisTransform(axis, coordBase) {\n  var axisExtent = axis.getExtent();\n  var axisExtentSum = axisExtent[0] + axisExtent[1]; // Fast transform\n\n  axis.toGlobalCoord = axis.dim === 'x' ? function (coord) {\n    return coord + coordBase;\n  } : function (coord) {\n    return axisExtentSum - coord + coordBase;\n  };\n  axis.toLocalCoord = axis.dim === 'x' ? function (coord) {\n    return coord - coordBase;\n  } : function (coord) {\n    return axisExtentSum - coord + coordBase;\n  };\n}\n\nvar axesTypes = ['xAxis', 'yAxis'];\n/**\n * @inner\n */\n\nfunction findAxesModels(seriesModel, ecModel) {\n  return map(axesTypes, function (axisType) {\n    var axisModel = seriesModel.getReferringComponents(axisType)[0];\n    return axisModel;\n  });\n}\n/**\n * @inner\n */\n\n\nfunction isCartesian2D(seriesModel) {\n  return seriesModel.get('coordinateSystem') === 'cartesian2d';\n}\n\nGrid.create = function (ecModel, api) {\n  var grids = [];\n  ecModel.eachComponent('grid', function (gridModel, idx) {\n    var grid = new Grid(gridModel, ecModel, api);\n    grid.name = 'grid_' + idx; // dataSampling requires axis extent, so resize\n    // should be performed in create stage.\n\n    grid.resize(gridModel, api, true);\n    gridModel.coordinateSystem = grid;\n    grids.push(grid);\n  }); // Inject the coordinateSystems into seriesModel\n\n  ecModel.eachSeries(function (seriesModel) {\n    if (!isCartesian2D(seriesModel)) {\n      return;\n    }\n\n    var axesModels = findAxesModels(seriesModel, ecModel);\n    var xAxisModel = axesModels[0];\n    var yAxisModel = axesModels[1];\n    var gridModel = xAxisModel.getCoordSysModel();\n    var grid = gridModel.coordinateSystem;\n    seriesModel.coordinateSystem = grid.getCartesian(xAxisModel.componentIndex, yAxisModel.componentIndex);\n  });\n  return grids;\n}; // For deciding which dimensions to use when creating list data\n\n\nGrid.dimensions = Grid.prototype.dimensions = Cartesian2D.prototype.dimensions;\nCoordinateSystemManager.register('cartesian2d', Grid);\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar BaseBarSeries = SeriesModel.extend({\n  type: 'series.__base_bar__',\n  getInitialData: function (option, ecModel) {\n    return createListFromArray(this.getSource(), this);\n  },\n  getMarkerPosition: function (value) {\n    var coordSys = this.coordinateSystem;\n\n    if (coordSys) {\n      // PENDING if clamp ?\n      var pt = coordSys.dataToPoint(coordSys.clampData(value));\n      var data = this.getData();\n      var offset = data.getLayout('offset');\n      var size = data.getLayout('size');\n      var offsetIndex = coordSys.getBaseAxis().isHorizontal() ? 0 : 1;\n      pt[offsetIndex] += offset + size / 2;\n      return pt;\n    }\n\n    return [NaN, NaN];\n  },\n  defaultOption: {\n    zlevel: 0,\n    // \n    z: 2,\n    // \n    coordinateSystem: 'cartesian2d',\n    legendHoverLink: true,\n    // stack: null\n    // Cartesian coordinate system\n    // xAxisIndex: 0,\n    // yAxisIndex: 0,\n    // 0\n    barMinHeight: 0,\n    // 0\n    barMinAngle: 0,\n    // cursor: null,\n    large: false,\n    largeThreshold: 400,\n    progressive: 3e3,\n    progressiveChunkMode: 'mod',\n    // barMaxWidth: null,\n    // \n    // barWidth: null,\n    // 30%\n    // barGap: '30%',\n    // 20%\n    // barCategoryGap: '20%',\n    // label: {\n    //      show: false\n    // },\n    itemStyle: {},\n    emphasis: {}\n  }\n});\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nBaseBarSeries.extend({\n  type: 'series.bar',\n  dependencies: ['grid', 'polar'],\n  brushSelector: 'rect',\n\n  /**\n   * @override\n   */\n  getProgressive: function () {\n    // Do not support progressive in normal mode.\n    return this.get('large') ? this.get('progressive') : false;\n  },\n\n  /**\n   * @override\n   */\n  getProgressiveThreshold: function () {\n    // Do not support progressive in normal mode.\n    var progressiveThreshold = this.get('progressiveThreshold');\n    var largeThreshold = this.get('largeThreshold');\n\n    if (largeThreshold > progressiveThreshold) {\n      progressiveThreshold = largeThreshold;\n    }\n\n    return progressiveThreshold;\n  }\n});\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n/**\n * @param {module:echarts/data/List} data\n * @param {number} dataIndex\n * @return {string} label string. Not null/undefined\n */\n\nfunction getDefaultLabel(data, dataIndex) {\n  var labelDims = data.mapDimension('defaultedLabel', true);\n  var len = labelDims.length; // Simple optimization (in lots of cases, label dims length is 1)\n\n  if (len === 1) {\n    return retrieveRawValue(data, dataIndex, labelDims[0]);\n  } else if (len) {\n    var vals = [];\n\n    for (var i = 0; i < labelDims.length; i++) {\n      var val = retrieveRawValue(data, dataIndex, labelDims[i]);\n      vals.push(val);\n    }\n\n    return vals.join(' ');\n  }\n}\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nfunction setLabel(normalStyle, hoverStyle, itemModel, color, seriesModel, dataIndex, labelPositionOutside) {\n  var labelModel = itemModel.getModel('label');\n  var hoverLabelModel = itemModel.getModel('emphasis.label');\n  setLabelStyle(normalStyle, hoverStyle, labelModel, hoverLabelModel, {\n    labelFetcher: seriesModel,\n    labelDataIndex: dataIndex,\n    defaultText: getDefaultLabel(seriesModel.getData(), dataIndex),\n    isRectText: true,\n    autoColor: color\n  });\n  fixPosition(normalStyle);\n  fixPosition(hoverStyle);\n}\n\nfunction fixPosition(style, labelPositionOutside) {\n  if (style.textPosition === 'outside') {\n    style.textPosition = labelPositionOutside;\n  }\n}\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar getBarItemStyle = makeStyleMapper([['fill', 'color'], ['stroke', 'borderColor'], ['lineWidth', 'borderWidth'], // Compatitable with 2\n['stroke', 'barBorderColor'], ['lineWidth', 'barBorderWidth'], ['opacity'], ['shadowBlur'], ['shadowOffsetX'], ['shadowOffsetY'], ['shadowColor']]);\nvar barItemStyle = {\n  getBarItemStyle: function (excludes) {\n    var style = getBarItemStyle(this, excludes);\n\n    if (this.getBorderLineDash) {\n      var lineDash = this.getBorderLineDash();\n      lineDash && (style.lineDash = lineDash);\n    }\n\n    return style;\n  }\n};\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar BAR_BORDER_WIDTH_QUERY = ['itemStyle', 'barBorderWidth']; // FIXME\n// Just for compatible with ec2.\n\nextend(Model.prototype, barItemStyle);\nextendChartView({\n  type: 'bar',\n  render: function (seriesModel, ecModel, api) {\n    this._updateDrawMode(seriesModel);\n\n    var coordinateSystemType = seriesModel.get('coordinateSystem');\n\n    if (coordinateSystemType === 'cartesian2d' || coordinateSystemType === 'polar') {\n      this._isLargeDraw ? this._renderLarge(seriesModel, ecModel, api) : this._renderNormal(seriesModel, ecModel, api);\n    } else {}\n\n    return this.group;\n  },\n  incrementalPrepareRender: function (seriesModel, ecModel, api) {\n    this._clear();\n\n    this._updateDrawMode(seriesModel);\n  },\n  incrementalRender: function (params, seriesModel, ecModel, api) {\n    // Do not support progressive in normal mode.\n    this._incrementalRenderLarge(params, seriesModel);\n  },\n  _updateDrawMode: function (seriesModel) {\n    var isLargeDraw = seriesModel.pipelineContext.large;\n\n    if (this._isLargeDraw == null || isLargeDraw ^ this._isLargeDraw) {\n      this._isLargeDraw = isLargeDraw;\n\n      this._clear();\n    }\n  },\n  _renderNormal: function (seriesModel, ecModel, api) {\n    var group = this.group;\n    var data = seriesModel.getData();\n    var oldData = this._data;\n    var coord = seriesModel.coordinateSystem;\n    var baseAxis = coord.getBaseAxis();\n    var isHorizontalOrRadial;\n\n    if (coord.type === 'cartesian2d') {\n      isHorizontalOrRadial = baseAxis.isHorizontal();\n    } else if (coord.type === 'polar') {\n      isHorizontalOrRadial = baseAxis.dim === 'angle';\n    }\n\n    var animationModel = seriesModel.isAnimationEnabled() ? seriesModel : null;\n    data.diff(oldData).add(function (dataIndex) {\n      if (!data.hasValue(dataIndex)) {\n        return;\n      }\n\n      var itemModel = data.getItemModel(dataIndex);\n      var layout = getLayout[coord.type](data, dataIndex, itemModel);\n      var el = elementCreator[coord.type](data, dataIndex, itemModel, layout, isHorizontalOrRadial, animationModel);\n      data.setItemGraphicEl(dataIndex, el);\n      group.add(el);\n      updateStyle(el, data, dataIndex, itemModel, layout, seriesModel, isHorizontalOrRadial, coord.type === 'polar');\n    }).update(function (newIndex, oldIndex) {\n      var el = oldData.getItemGraphicEl(oldIndex);\n\n      if (!data.hasValue(newIndex)) {\n        group.remove(el);\n        return;\n      }\n\n      var itemModel = data.getItemModel(newIndex);\n      var layout = getLayout[coord.type](data, newIndex, itemModel);\n\n      if (el) {\n        updateProps(el, {\n          shape: layout\n        }, animationModel, newIndex);\n      } else {\n        el = elementCreator[coord.type](data, newIndex, itemModel, layout, isHorizontalOrRadial, animationModel, true);\n      }\n\n      data.setItemGraphicEl(newIndex, el); // Add back\n\n      group.add(el);\n      updateStyle(el, data, newIndex, itemModel, layout, seriesModel, isHorizontalOrRadial, coord.type === 'polar');\n    }).remove(function (dataIndex) {\n      var el = oldData.getItemGraphicEl(dataIndex);\n\n      if (coord.type === 'cartesian2d') {\n        el && removeRect(dataIndex, animationModel, el);\n      } else {\n        el && removeSector(dataIndex, animationModel, el);\n      }\n    }).execute();\n    this._data = data;\n  },\n  _renderLarge: function (seriesModel, ecModel, api) {\n    this._clear();\n\n    createLarge(seriesModel, this.group);\n  },\n  _incrementalRenderLarge: function (params, seriesModel) {\n    createLarge(seriesModel, this.group, true);\n  },\n  dispose: noop,\n  remove: function (ecModel) {\n    this._clear(ecModel);\n  },\n  _clear: function (ecModel) {\n    var group = this.group;\n    var data = this._data;\n\n    if (ecModel && ecModel.get('animation') && data && !this._isLargeDraw) {\n      data.eachItemGraphicEl(function (el) {\n        if (el.type === 'sector') {\n          removeSector(el.dataIndex, ecModel, el);\n        } else {\n          removeRect(el.dataIndex, ecModel, el);\n        }\n      });\n    } else {\n      group.removeAll();\n    }\n\n    this._data = null;\n  }\n});\nvar elementCreator = {\n  cartesian2d: function (data, dataIndex, itemModel, layout, isHorizontal, animationModel, isUpdate) {\n    var rect = new Rect({\n      shape: extend({}, layout)\n    }); // Animation\n\n    if (animationModel) {\n      var rectShape = rect.shape;\n      var animateProperty = isHorizontal ? 'height' : 'width';\n      var animateTarget = {};\n      rectShape[animateProperty] = 0;\n      animateTarget[animateProperty] = layout[animateProperty];\n      graphic[isUpdate ? 'updateProps' : 'initProps'](rect, {\n        shape: animateTarget\n      }, animationModel, dataIndex);\n    }\n\n    return rect;\n  },\n  polar: function (data, dataIndex, itemModel, layout, isRadial, animationModel, isUpdate) {\n    // Keep the same logic with bar in catesion: use end value to control\n    // direction. Notice that if clockwise is true (by default), the sector\n    // will always draw clockwisely, no matter whether endAngle is greater\n    // or less than startAngle.\n    var clockwise = layout.startAngle < layout.endAngle;\n    var sector = new Sector({\n      shape: defaults({\n        clockwise: clockwise\n      }, layout)\n    }); // Animation\n\n    if (animationModel) {\n      var sectorShape = sector.shape;\n      var animateProperty = isRadial ? 'r' : 'endAngle';\n      var animateTarget = {};\n      sectorShape[animateProperty] = isRadial ? 0 : layout.startAngle;\n      animateTarget[animateProperty] = layout[animateProperty];\n      graphic[isUpdate ? 'updateProps' : 'initProps'](sector, {\n        shape: animateTarget\n      }, animationModel, dataIndex);\n    }\n\n    return sector;\n  }\n};\n\nfunction removeRect(dataIndex, animationModel, el) {\n  // Not show text when animating\n  el.style.text = null;\n  updateProps(el, {\n    shape: {\n      width: 0\n    }\n  }, animationModel, dataIndex, function () {\n    el.parent && el.parent.remove(el);\n  });\n}\n\nfunction removeSector(dataIndex, animationModel, el) {\n  // Not show text when animating\n  el.style.text = null;\n  updateProps(el, {\n    shape: {\n      r: el.shape.r0\n    }\n  }, animationModel, dataIndex, function () {\n    el.parent && el.parent.remove(el);\n  });\n}\n\nvar getLayout = {\n  cartesian2d: function (data, dataIndex, itemModel) {\n    var layout = data.getItemLayout(dataIndex);\n    var fixedLineWidth = getLineWidth(itemModel, layout); // fix layout with lineWidth\n\n    var signX = layout.width > 0 ? 1 : -1;\n    var signY = layout.height > 0 ? 1 : -1;\n    return {\n      x: layout.x + signX * fixedLineWidth / 2,\n      y: layout.y + signY * fixedLineWidth / 2,\n      width: layout.width - signX * fixedLineWidth,\n      height: layout.height - signY * fixedLineWidth\n    };\n  },\n  polar: function (data, dataIndex, itemModel) {\n    var layout = data.getItemLayout(dataIndex);\n    return {\n      cx: layout.cx,\n      cy: layout.cy,\n      r0: layout.r0,\n      r: layout.r,\n      startAngle: layout.startAngle,\n      endAngle: layout.endAngle\n    };\n  }\n};\n\nfunction updateStyle(el, data, dataIndex, itemModel, layout, seriesModel, isHorizontal, isPolar) {\n  var color = data.getItemVisual(dataIndex, 'color');\n  var opacity = data.getItemVisual(dataIndex, 'opacity');\n  var itemStyleModel = itemModel.getModel('itemStyle');\n  var hoverStyle = itemModel.getModel('emphasis.itemStyle').getBarItemStyle();\n\n  if (!isPolar) {\n    el.setShape('r', itemStyleModel.get('barBorderRadius') || 0);\n  }\n\n  el.useStyle(defaults({\n    fill: color,\n    opacity: opacity\n  }, itemStyleModel.getBarItemStyle()));\n  var cursorStyle = itemModel.getShallow('cursor');\n  cursorStyle && el.attr('cursor', cursorStyle);\n  var labelPositionOutside = isHorizontal ? layout.height > 0 ? 'bottom' : 'top' : layout.width > 0 ? 'left' : 'right';\n\n  if (!isPolar) {\n    setLabel(el.style, hoverStyle, itemModel, color, seriesModel, dataIndex, labelPositionOutside);\n  }\n\n  setHoverStyle(el, hoverStyle);\n} // In case width or height are too small.\n\n\nfunction getLineWidth(itemModel, rawLayout) {\n  var lineWidth = itemModel.get(BAR_BORDER_WIDTH_QUERY) || 0;\n  return Math.min(lineWidth, Math.abs(rawLayout.width), Math.abs(rawLayout.height));\n}\n\nvar LargePath = Path.extend({\n  type: 'largeBar',\n  shape: {\n    points: []\n  },\n  buildPath: function (ctx, shape) {\n    // Drawing lines is more efficient than drawing\n    // a whole line or drawing rects.\n    var points = shape.points;\n    var startPoint = this.__startPoint;\n    var valueIdx = this.__valueIdx;\n\n    for (var i = 0; i < points.length; i += 2) {\n      startPoint[this.__valueIdx] = points[i + valueIdx];\n      ctx.moveTo(startPoint[0], startPoint[1]);\n      ctx.lineTo(points[i], points[i + 1]);\n    }\n  }\n});\n\nfunction createLarge(seriesModel, group, incremental) {\n  // TODO support polar\n  var data = seriesModel.getData();\n  var startPoint = [];\n  var valueIdx = data.getLayout('valueAxisHorizontal') ? 1 : 0;\n  startPoint[1 - valueIdx] = data.getLayout('valueAxisStart');\n  var el = new LargePath({\n    shape: {\n      points: data.getLayout('largePoints')\n    },\n    incremental: !!incremental,\n    __startPoint: startPoint,\n    __valueIdx: valueIdx\n  });\n  group.add(el);\n  setLargeStyle(el, seriesModel, data);\n}\n\nfunction setLargeStyle(el, seriesModel, data) {\n  var borderColor = data.getVisual('borderColor') || data.getVisual('color');\n  var itemStyle = seriesModel.getModel('itemStyle').getItemStyle(['color', 'borderColor']);\n  el.useStyle(itemStyle);\n  el.style.fill = null;\n  el.style.stroke = borderColor;\n  el.style.lineWidth = data.getLayout('barWidth');\n}\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar PI$2 = Math.PI;\n\nfunction makeAxisEventDataBase(axisModel) {\n  var eventData = {\n    componentType: axisModel.mainType\n  };\n  eventData[axisModel.mainType + 'Index'] = axisModel.componentIndex;\n  return eventData;\n}\n/**\n * A final axis is translated and rotated from a \"standard axis\".\n * So opt.position and opt.rotation is required.\n *\n * A standard axis is and axis from [0, 0] to [0, axisExtent[1]],\n * for example: (0, 0) ------------> (0, 50)\n *\n * nameDirection or tickDirection or labelDirection is 1 means tick\n * or label is below the standard axis, whereas is -1 means above\n * the standard axis. labelOffset means offset between label and axis,\n * which is useful when 'onZero', where axisLabel is in the grid and\n * label in outside grid.\n *\n * Tips: like always,\n * positive rotation represents anticlockwise, and negative rotation\n * represents clockwise.\n * The direction of position coordinate is the same as the direction\n * of screen coordinate.\n *\n * Do not need to consider axis 'inverse', which is auto processed by\n * axis extent.\n *\n * @param {module:zrender/container/Group} group\n * @param {Object} axisModel\n * @param {Object} opt Standard axis parameters.\n * @param {Array.<number>} opt.position [x, y]\n * @param {number} opt.rotation by radian\n * @param {number} [opt.nameDirection=1] 1 or -1 Used when nameLocation is 'middle' or 'center'.\n * @param {number} [opt.tickDirection=1] 1 or -1\n * @param {number} [opt.labelDirection=1] 1 or -1\n * @param {number} [opt.labelOffset=0] Usefull when onZero.\n * @param {string} [opt.axisLabelShow] default get from axisModel.\n * @param {string} [opt.axisName] default get from axisModel.\n * @param {number} [opt.axisNameAvailableWidth]\n * @param {number} [opt.labelRotate] by degree, default get from axisModel.\n * @param {number} [opt.strokeContainThreshold] Default label interval when label\n * @param {number} [opt.nameTruncateMaxWidth]\n */\n\n\nvar AxisBuilder = function (axisModel, opt) {\n  /**\n   * @readOnly\n   */\n  this.opt = opt;\n  /**\n   * @readOnly\n   */\n\n  this.axisModel = axisModel; // Default value\n\n  defaults(opt, {\n    labelOffset: 0,\n    nameDirection: 1,\n    tickDirection: 1,\n    labelDirection: 1,\n    silent: true\n  });\n  /**\n   * @readOnly\n   */\n\n  this.group = new Group(); // FIXME Not use a seperate text group?\n\n  var dumbGroup = new Group({\n    position: opt.position.slice(),\n    rotation: opt.rotation\n  }); // this.group.add(dumbGroup);\n  // this._dumbGroup = dumbGroup;\n\n  dumbGroup.updateTransform();\n  this._transform = dumbGroup.transform;\n  this._dumbGroup = dumbGroup;\n};\n\nAxisBuilder.prototype = {\n  constructor: AxisBuilder,\n  hasBuilder: function (name) {\n    return !!builders[name];\n  },\n  add: function (name) {\n    builders[name].call(this);\n  },\n  getGroup: function () {\n    return this.group;\n  }\n};\nvar builders = {\n  /**\n   * @private\n   */\n  axisLine: function () {\n    var opt = this.opt;\n    var axisModel = this.axisModel;\n\n    if (!axisModel.get('axisLine.show')) {\n      return;\n    }\n\n    var extent = this.axisModel.axis.getExtent();\n    var matrix = this._transform;\n    var pt1 = [extent[0], 0];\n    var pt2 = [extent[1], 0];\n\n    if (matrix) {\n      applyTransform(pt1, pt1, matrix);\n      applyTransform(pt2, pt2, matrix);\n    }\n\n    var lineStyle = extend({\n      lineCap: 'round'\n    }, axisModel.getModel('axisLine.lineStyle').getLineStyle());\n    this.group.add(new Line(subPixelOptimizeLine({\n      // Id for animation\n      anid: 'line',\n      shape: {\n        x1: pt1[0],\n        y1: pt1[1],\n        x2: pt2[0],\n        y2: pt2[1]\n      },\n      style: lineStyle,\n      strokeContainThreshold: opt.strokeContainThreshold || 5,\n      silent: true,\n      z2: 1\n    })));\n    var arrows = axisModel.get('axisLine.symbol');\n    var arrowSize = axisModel.get('axisLine.symbolSize');\n    var arrowOffset = axisModel.get('axisLine.symbolOffset') || 0;\n\n    if (typeof arrowOffset === 'number') {\n      arrowOffset = [arrowOffset, arrowOffset];\n    }\n\n    if (arrows != null) {\n      if (typeof arrows === 'string') {\n        // Use the same arrow for start and end point\n        arrows = [arrows, arrows];\n      }\n\n      if (typeof arrowSize === 'string' || typeof arrowSize === 'number') {\n        // Use the same size for width and height\n        arrowSize = [arrowSize, arrowSize];\n      }\n\n      var symbolWidth = arrowSize[0];\n      var symbolHeight = arrowSize[1];\n      each$1([{\n        rotate: opt.rotation + Math.PI / 2,\n        offset: arrowOffset[0],\n        r: 0\n      }, {\n        rotate: opt.rotation - Math.PI / 2,\n        offset: arrowOffset[1],\n        r: Math.sqrt((pt1[0] - pt2[0]) * (pt1[0] - pt2[0]) + (pt1[1] - pt2[1]) * (pt1[1] - pt2[1]))\n      }], function (point, index) {\n        if (arrows[index] !== 'none' && arrows[index] != null) {\n          var symbol = createSymbol(arrows[index], -symbolWidth / 2, -symbolHeight / 2, symbolWidth, symbolHeight, lineStyle.stroke, true); // Calculate arrow position with offset\n\n          var r = point.r + point.offset;\n          var pos = [pt1[0] + r * Math.cos(opt.rotation), pt1[1] - r * Math.sin(opt.rotation)];\n          symbol.attr({\n            rotation: point.rotate,\n            position: pos,\n            silent: true\n          });\n          this.group.add(symbol);\n        }\n      }, this);\n    }\n  },\n\n  /**\n   * @private\n   */\n  axisTickLabel: function () {\n    var axisModel = this.axisModel;\n    var opt = this.opt;\n    var tickEls = buildAxisTick(this, axisModel, opt);\n    var labelEls = buildAxisLabel(this, axisModel, opt);\n    fixMinMaxLabelShow(axisModel, labelEls, tickEls);\n  },\n\n  /**\n   * @private\n   */\n  axisName: function () {\n    var opt = this.opt;\n    var axisModel = this.axisModel;\n    var name = retrieve(opt.axisName, axisModel.get('name'));\n\n    if (!name) {\n      return;\n    }\n\n    var nameLocation = axisModel.get('nameLocation');\n    var nameDirection = opt.nameDirection;\n    var textStyleModel = axisModel.getModel('nameTextStyle');\n    var gap = axisModel.get('nameGap') || 0;\n    var extent = this.axisModel.axis.getExtent();\n    var gapSignal = extent[0] > extent[1] ? -1 : 1;\n    var pos = [nameLocation === 'start' ? extent[0] - gapSignal * gap : nameLocation === 'end' ? extent[1] + gapSignal * gap : (extent[0] + extent[1]) / 2, // 'middle'\n    // Reuse labelOffset.\n    isNameLocationCenter(nameLocation) ? opt.labelOffset + nameDirection * gap : 0];\n    var labelLayout;\n    var nameRotation = axisModel.get('nameRotate');\n\n    if (nameRotation != null) {\n      nameRotation = nameRotation * PI$2 / 180; // To radian.\n    }\n\n    var axisNameAvailableWidth;\n\n    if (isNameLocationCenter(nameLocation)) {\n      labelLayout = innerTextLayout(opt.rotation, nameRotation != null ? nameRotation : opt.rotation, // Adapt to axis.\n      nameDirection);\n    } else {\n      labelLayout = endTextLayout(opt, nameLocation, nameRotation || 0, extent);\n      axisNameAvailableWidth = opt.axisNameAvailableWidth;\n\n      if (axisNameAvailableWidth != null) {\n        axisNameAvailableWidth = Math.abs(axisNameAvailableWidth / Math.sin(labelLayout.rotation));\n        !isFinite(axisNameAvailableWidth) && (axisNameAvailableWidth = null);\n      }\n    }\n\n    var textFont = textStyleModel.getFont();\n    var truncateOpt = axisModel.get('nameTruncate', true) || {};\n    var ellipsis = truncateOpt.ellipsis;\n    var maxWidth = retrieve(opt.nameTruncateMaxWidth, truncateOpt.maxWidth, axisNameAvailableWidth); // FIXME\n    // truncate rich text? (consider performance)\n\n    var truncatedText = ellipsis != null && maxWidth != null ? truncateText$1(name, maxWidth, textFont, ellipsis, {\n      minChar: 2,\n      placeholder: truncateOpt.placeholder\n    }) : name;\n    var tooltipOpt = axisModel.get('tooltip', true);\n    var mainType = axisModel.mainType;\n    var formatterParams = {\n      componentType: mainType,\n      name: name,\n      $vars: ['name']\n    };\n    formatterParams[mainType + 'Index'] = axisModel.componentIndex;\n    var textEl = new Text({\n      // Id for animation\n      anid: 'name',\n      __fullText: name,\n      __truncatedText: truncatedText,\n      position: pos,\n      rotation: labelLayout.rotation,\n      silent: isSilent(axisModel),\n      z2: 1,\n      tooltip: tooltipOpt && tooltipOpt.show ? extend({\n        content: name,\n        formatter: function () {\n          return name;\n        },\n        formatterParams: formatterParams\n      }, tooltipOpt) : null\n    });\n    setTextStyle(textEl.style, textStyleModel, {\n      text: truncatedText,\n      textFont: textFont,\n      textFill: textStyleModel.getTextColor() || axisModel.get('axisLine.lineStyle.color'),\n      textAlign: labelLayout.textAlign,\n      textVerticalAlign: labelLayout.textVerticalAlign\n    });\n\n    if (axisModel.get('triggerEvent')) {\n      textEl.eventData = makeAxisEventDataBase(axisModel);\n      textEl.eventData.targetType = 'axisName';\n      textEl.eventData.name = name;\n    } // FIXME\n\n\n    this._dumbGroup.add(textEl);\n\n    textEl.updateTransform();\n    this.group.add(textEl);\n    textEl.decomposeTransform();\n  }\n};\n/**\n * @public\n * @static\n * @param {Object} opt\n * @param {number} axisRotation in radian\n * @param {number} textRotation in radian\n * @param {number} direction\n * @return {Object} {\n *  rotation, // according to axis\n *  textAlign,\n *  textVerticalAlign\n * }\n */\n\nvar innerTextLayout = AxisBuilder.innerTextLayout = function (axisRotation, textRotation, direction) {\n  var rotationDiff = remRadian(textRotation - axisRotation);\n  var textAlign;\n  var textVerticalAlign;\n\n  if (isRadianAroundZero(rotationDiff)) {\n    // Label is parallel with axis line.\n    textVerticalAlign = direction > 0 ? 'top' : 'bottom';\n    textAlign = 'center';\n  } else if (isRadianAroundZero(rotationDiff - PI$2)) {\n    // Label is inverse parallel with axis line.\n    textVerticalAlign = direction > 0 ? 'bottom' : 'top';\n    textAlign = 'center';\n  } else {\n    textVerticalAlign = 'middle';\n\n    if (rotationDiff > 0 && rotationDiff < PI$2) {\n      textAlign = direction > 0 ? 'right' : 'left';\n    } else {\n      textAlign = direction > 0 ? 'left' : 'right';\n    }\n  }\n\n  return {\n    rotation: rotationDiff,\n    textAlign: textAlign,\n    textVerticalAlign: textVerticalAlign\n  };\n};\n\nfunction endTextLayout(opt, textPosition, textRotate, extent) {\n  var rotationDiff = remRadian(textRotate - opt.rotation);\n  var textAlign;\n  var textVerticalAlign;\n  var inverse = extent[0] > extent[1];\n  var onLeft = textPosition === 'start' && !inverse || textPosition !== 'start' && inverse;\n\n  if (isRadianAroundZero(rotationDiff - PI$2 / 2)) {\n    textVerticalAlign = onLeft ? 'bottom' : 'top';\n    textAlign = 'center';\n  } else if (isRadianAroundZero(rotationDiff - PI$2 * 1.5)) {\n    textVerticalAlign = onLeft ? 'top' : 'bottom';\n    textAlign = 'center';\n  } else {\n    textVerticalAlign = 'middle';\n\n    if (rotationDiff < PI$2 * 1.5 && rotationDiff > PI$2 / 2) {\n      textAlign = onLeft ? 'left' : 'right';\n    } else {\n      textAlign = onLeft ? 'right' : 'left';\n    }\n  }\n\n  return {\n    rotation: rotationDiff,\n    textAlign: textAlign,\n    textVerticalAlign: textVerticalAlign\n  };\n}\n\nfunction isSilent(axisModel) {\n  var tooltipOpt = axisModel.get('tooltip');\n  return axisModel.get('silent') // Consider mouse cursor, add these restrictions.\n  || !(axisModel.get('triggerEvent') || tooltipOpt && tooltipOpt.show);\n}\n\nfunction fixMinMaxLabelShow(axisModel, labelEls, tickEls) {\n  // If min or max are user set, we need to check\n  // If the tick on min(max) are overlap on their neighbour tick\n  // If they are overlapped, we need to hide the min(max) tick label\n  var showMinLabel = axisModel.get('axisLabel.showMinLabel');\n  var showMaxLabel = axisModel.get('axisLabel.showMaxLabel'); // FIXME\n  // Have not consider onBand yet, where tick els is more than label els.\n\n  labelEls = labelEls || [];\n  tickEls = tickEls || [];\n  var firstLabel = labelEls[0];\n  var nextLabel = labelEls[1];\n  var lastLabel = labelEls[labelEls.length - 1];\n  var prevLabel = labelEls[labelEls.length - 2];\n  var firstTick = tickEls[0];\n  var nextTick = tickEls[1];\n  var lastTick = tickEls[tickEls.length - 1];\n  var prevTick = tickEls[tickEls.length - 2];\n\n  if (showMinLabel === false) {\n    ignoreEl(firstLabel);\n    ignoreEl(firstTick);\n  } else if (isTwoLabelOverlapped(firstLabel, nextLabel)) {\n    if (showMinLabel) {\n      ignoreEl(nextLabel);\n      ignoreEl(nextTick);\n    } else {\n      ignoreEl(firstLabel);\n      ignoreEl(firstTick);\n    }\n  }\n\n  if (showMaxLabel === false) {\n    ignoreEl(lastLabel);\n    ignoreEl(lastTick);\n  } else if (isTwoLabelOverlapped(prevLabel, lastLabel)) {\n    if (showMaxLabel) {\n      ignoreEl(prevLabel);\n      ignoreEl(prevTick);\n    } else {\n      ignoreEl(lastLabel);\n      ignoreEl(lastTick);\n    }\n  }\n}\n\nfunction ignoreEl(el) {\n  el && (el.ignore = true);\n}\n\nfunction isTwoLabelOverlapped(current, next, labelLayout) {\n  // current and next has the same rotation.\n  var firstRect = current && current.getBoundingRect().clone();\n  var nextRect = next && next.getBoundingRect().clone();\n\n  if (!firstRect || !nextRect) {\n    return;\n  } // When checking intersect of two rotated labels, we use mRotationBack\n  // to avoid that boundingRect is enlarge when using `boundingRect.applyTransform`.\n\n\n  var mRotationBack = identity([]);\n  rotate(mRotationBack, mRotationBack, -current.rotation);\n  firstRect.applyTransform(mul$1([], mRotationBack, current.getLocalTransform()));\n  nextRect.applyTransform(mul$1([], mRotationBack, next.getLocalTransform()));\n  return firstRect.intersect(nextRect);\n}\n\nfunction isNameLocationCenter(nameLocation) {\n  return nameLocation === 'middle' || nameLocation === 'center';\n}\n\nfunction buildAxisTick(axisBuilder, axisModel, opt) {\n  var axis = axisModel.axis;\n\n  if (!axisModel.get('axisTick.show') || axis.scale.isBlank()) {\n    return;\n  }\n\n  var tickModel = axisModel.getModel('axisTick');\n  var lineStyleModel = tickModel.getModel('lineStyle');\n  var tickLen = tickModel.get('length');\n  var ticksCoords = axis.getTicksCoords();\n  var pt1 = [];\n  var pt2 = [];\n  var matrix = axisBuilder._transform;\n  var tickEls = [];\n\n  for (var i = 0; i < ticksCoords.length; i++) {\n    var tickCoord = ticksCoords[i].coord;\n    pt1[0] = tickCoord;\n    pt1[1] = 0;\n    pt2[0] = tickCoord;\n    pt2[1] = opt.tickDirection * tickLen;\n\n    if (matrix) {\n      applyTransform(pt1, pt1, matrix);\n      applyTransform(pt2, pt2, matrix);\n    } // Tick line, Not use group transform to have better line draw\n\n\n    var tickEl = new Line(subPixelOptimizeLine({\n      // Id for animation\n      anid: 'tick_' + ticksCoords[i].tickValue,\n      shape: {\n        x1: pt1[0],\n        y1: pt1[1],\n        x2: pt2[0],\n        y2: pt2[1]\n      },\n      style: defaults(lineStyleModel.getLineStyle(), {\n        stroke: axisModel.get('axisLine.lineStyle.color')\n      }),\n      z2: 2,\n      silent: true\n    }));\n    axisBuilder.group.add(tickEl);\n    tickEls.push(tickEl);\n  }\n\n  return tickEls;\n}\n\nfunction buildAxisLabel(axisBuilder, axisModel, opt) {\n  var axis = axisModel.axis;\n  var show = retrieve(opt.axisLabelShow, axisModel.get('axisLabel.show'));\n\n  if (!show || axis.scale.isBlank()) {\n    return;\n  }\n\n  var labelModel = axisModel.getModel('axisLabel');\n  var labelMargin = labelModel.get('margin');\n  var labels = axis.getViewLabels(); // Special label rotate.\n\n  var labelRotation = (retrieve(opt.labelRotate, labelModel.get('rotate')) || 0) * PI$2 / 180;\n  var labelLayout = innerTextLayout(opt.rotation, labelRotation, opt.labelDirection);\n  var rawCategoryData = axisModel.getCategories(true);\n  var labelEls = [];\n  var silent = isSilent(axisModel);\n  var triggerEvent = axisModel.get('triggerEvent');\n  each$1(labels, function (labelItem, index) {\n    var tickValue = labelItem.tickValue;\n    var formattedLabel = labelItem.formattedLabel;\n    var rawLabel = labelItem.rawLabel;\n    var itemLabelModel = labelModel;\n\n    if (rawCategoryData && rawCategoryData[tickValue] && rawCategoryData[tickValue].textStyle) {\n      itemLabelModel = new Model(rawCategoryData[tickValue].textStyle, labelModel, axisModel.ecModel);\n    }\n\n    var textColor = itemLabelModel.getTextColor() || axisModel.get('axisLine.lineStyle.color');\n    var tickCoord = axis.dataToCoord(tickValue);\n    var pos = [tickCoord, opt.labelOffset + opt.labelDirection * labelMargin];\n    var textEl = new Text({\n      // Id for animation\n      anid: 'label_' + tickValue,\n      position: pos,\n      rotation: labelLayout.rotation,\n      silent: silent,\n      z2: 10\n    });\n    setTextStyle(textEl.style, itemLabelModel, {\n      text: formattedLabel,\n      textAlign: itemLabelModel.getShallow('align', true) || labelLayout.textAlign,\n      textVerticalAlign: itemLabelModel.getShallow('verticalAlign', true) || itemLabelModel.getShallow('baseline', true) || labelLayout.textVerticalAlign,\n      textFill: typeof textColor === 'function' ? textColor( // (1) In category axis with data zoom, tick is not the original\n      // index of axis.data. So tick should not be exposed to user\n      // in category axis.\n      // (2) Compatible with previous version, which always use formatted label as\n      // input. But in interval scale the formatted label is like '223,445', which\n      // maked user repalce ','. So we modify it to return original val but remain\n      // it as 'string' to avoid error in replacing.\n      axis.type === 'category' ? rawLabel : axis.type === 'value' ? tickValue + '' : tickValue, index) : textColor\n    }); // Pack data for mouse event\n\n    if (triggerEvent) {\n      textEl.eventData = makeAxisEventDataBase(axisModel);\n      textEl.eventData.targetType = 'axisLabel';\n      textEl.eventData.value = rawLabel;\n    } // FIXME\n\n\n    axisBuilder._dumbGroup.add(textEl);\n\n    textEl.updateTransform();\n    labelEls.push(textEl);\n    axisBuilder.group.add(textEl);\n    textEl.decomposeTransform();\n  });\n  return labelEls;\n}\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar each$6 = each$1;\nvar curry$1 = curry; // Build axisPointerModel, mergin tooltip.axisPointer model for each axis.\n// allAxesInfo should be updated when setOption performed.\n\nfunction collect(ecModel, api) {\n  var result = {\n    /**\n     * key: makeKey(axis.model)\n     * value: {\n     *      axis,\n     *      coordSys,\n     *      axisPointerModel,\n     *      triggerTooltip,\n     *      involveSeries,\n     *      snap,\n     *      seriesModels,\n     *      seriesDataCount\n     * }\n     */\n    axesInfo: {},\n    seriesInvolved: false,\n\n    /**\n     * key: makeKey(coordSys.model)\n     * value: Object: key makeKey(axis.model), value: axisInfo\n     */\n    coordSysAxesInfo: {},\n    coordSysMap: {}\n  };\n  collectAxesInfo(result, ecModel, api); // Check seriesInvolved for performance, in case too many series in some chart.\n\n  result.seriesInvolved && collectSeriesInfo(result, ecModel);\n  return result;\n}\n\nfunction collectAxesInfo(result, ecModel, api) {\n  var globalTooltipModel = ecModel.getComponent('tooltip');\n  var globalAxisPointerModel = ecModel.getComponent('axisPointer'); // links can only be set on global.\n\n  var linksOption = globalAxisPointerModel.get('link', true) || [];\n  var linkGroups = []; // Collect axes info.\n\n  each$6(api.getCoordinateSystems(), function (coordSys) {\n    // Some coordinate system do not support axes, like geo.\n    if (!coordSys.axisPointerEnabled) {\n      return;\n    }\n\n    var coordSysKey = makeKey(coordSys.model);\n    var axesInfoInCoordSys = result.coordSysAxesInfo[coordSysKey] = {};\n    result.coordSysMap[coordSysKey] = coordSys; // Set tooltip (like 'cross') is a convienent way to show axisPointer\n    // for user. So we enable seting tooltip on coordSys model.\n\n    var coordSysModel = coordSys.model;\n    var baseTooltipModel = coordSysModel.getModel('tooltip', globalTooltipModel);\n    each$6(coordSys.getAxes(), curry$1(saveTooltipAxisInfo, false, null)); // If axis tooltip used, choose tooltip axis for each coordSys.\n    // Notice this case: coordSys is `grid` but not `cartesian2D` here.\n\n    if (coordSys.getTooltipAxes && globalTooltipModel // If tooltip.showContent is set as false, tooltip will not\n    // show but axisPointer will show as normal.\n    && baseTooltipModel.get('show')) {\n      // Compatible with previous logic. But series.tooltip.trigger: 'axis'\n      // or series.data[n].tooltip.trigger: 'axis' are not support any more.\n      var triggerAxis = baseTooltipModel.get('trigger') === 'axis';\n      var cross = baseTooltipModel.get('axisPointer.type') === 'cross';\n      var tooltipAxes = coordSys.getTooltipAxes(baseTooltipModel.get('axisPointer.axis'));\n\n      if (triggerAxis || cross) {\n        each$6(tooltipAxes.baseAxes, curry$1(saveTooltipAxisInfo, cross ? 'cross' : true, triggerAxis));\n      }\n\n      if (cross) {\n        each$6(tooltipAxes.otherAxes, curry$1(saveTooltipAxisInfo, 'cross', false));\n      }\n    } // fromTooltip: true | false | 'cross'\n    // triggerTooltip: true | false | null\n\n\n    function saveTooltipAxisInfo(fromTooltip, triggerTooltip, axis) {\n      var axisPointerModel = axis.model.getModel('axisPointer', globalAxisPointerModel);\n      var axisPointerShow = axisPointerModel.get('show');\n\n      if (!axisPointerShow || axisPointerShow === 'auto' && !fromTooltip && !isHandleTrigger(axisPointerModel)) {\n        return;\n      }\n\n      if (triggerTooltip == null) {\n        triggerTooltip = axisPointerModel.get('triggerTooltip');\n      }\n\n      axisPointerModel = fromTooltip ? makeAxisPointerModel(axis, baseTooltipModel, globalAxisPointerModel, ecModel, fromTooltip, triggerTooltip) : axisPointerModel;\n      var snap = axisPointerModel.get('snap');\n      var key = makeKey(axis.model);\n      var involveSeries = triggerTooltip || snap || axis.type === 'category'; // If result.axesInfo[key] exist, override it (tooltip has higher priority).\n\n      var axisInfo = result.axesInfo[key] = {\n        key: key,\n        axis: axis,\n        coordSys: coordSys,\n        axisPointerModel: axisPointerModel,\n        triggerTooltip: triggerTooltip,\n        involveSeries: involveSeries,\n        snap: snap,\n        useHandle: isHandleTrigger(axisPointerModel),\n        seriesModels: []\n      };\n      axesInfoInCoordSys[key] = axisInfo;\n      result.seriesInvolved |= involveSeries;\n      var groupIndex = getLinkGroupIndex(linksOption, axis);\n\n      if (groupIndex != null) {\n        var linkGroup = linkGroups[groupIndex] || (linkGroups[groupIndex] = {\n          axesInfo: {}\n        });\n        linkGroup.axesInfo[key] = axisInfo;\n        linkGroup.mapper = linksOption[groupIndex].mapper;\n        axisInfo.linkGroup = linkGroup;\n      }\n    }\n  });\n}\n\nfunction makeAxisPointerModel(axis, baseTooltipModel, globalAxisPointerModel, ecModel, fromTooltip, triggerTooltip) {\n  var tooltipAxisPointerModel = baseTooltipModel.getModel('axisPointer');\n  var volatileOption = {};\n  each$6(['type', 'snap', 'lineStyle', 'shadowStyle', 'label', 'animation', 'animationDurationUpdate', 'animationEasingUpdate', 'z'], function (field) {\n    volatileOption[field] = clone(tooltipAxisPointerModel.get(field));\n  }); // category axis do not auto snap, otherwise some tick that do not\n  // has value can not be hovered. value/time/log axis default snap if\n  // triggered from tooltip and trigger tooltip.\n\n  volatileOption.snap = axis.type !== 'category' && !!triggerTooltip; // Compatibel with previous behavior, tooltip axis do not show label by default.\n  // Only these properties can be overrided from tooltip to axisPointer.\n\n  if (tooltipAxisPointerModel.get('type') === 'cross') {\n    volatileOption.type = 'line';\n  }\n\n  var labelOption = volatileOption.label || (volatileOption.label = {}); // Follow the convention, do not show label when triggered by tooltip by default.\n\n  labelOption.show == null && (labelOption.show = false);\n\n  if (fromTooltip === 'cross') {\n    // When 'cross', both axes show labels.\n    var tooltipAxisPointerLabelShow = tooltipAxisPointerModel.get('label.show');\n    labelOption.show = tooltipAxisPointerLabelShow != null ? tooltipAxisPointerLabelShow : true; // If triggerTooltip, this is a base axis, which should better not use cross style\n    // (cross style is dashed by default)\n\n    if (!triggerTooltip) {\n      var crossStyle = volatileOption.lineStyle = tooltipAxisPointerModel.get('crossStyle');\n      crossStyle && defaults(labelOption, crossStyle.textStyle);\n    }\n  }\n\n  return axis.model.getModel('axisPointer', new Model(volatileOption, globalAxisPointerModel, ecModel));\n}\n\nfunction collectSeriesInfo(result, ecModel) {\n  // Prepare data for axis trigger\n  ecModel.eachSeries(function (seriesModel) {\n    // Notice this case: this coordSys is `cartesian2D` but not `grid`.\n    var coordSys = seriesModel.coordinateSystem;\n    var seriesTooltipTrigger = seriesModel.get('tooltip.trigger', true);\n    var seriesTooltipShow = seriesModel.get('tooltip.show', true);\n\n    if (!coordSys || seriesTooltipTrigger === 'none' || seriesTooltipTrigger === false || seriesTooltipTrigger === 'item' || seriesTooltipShow === false || seriesModel.get('axisPointer.show', true) === false) {\n      return;\n    }\n\n    each$6(result.coordSysAxesInfo[makeKey(coordSys.model)], function (axisInfo) {\n      var axis = axisInfo.axis;\n\n      if (coordSys.getAxis(axis.dim) === axis) {\n        axisInfo.seriesModels.push(seriesModel);\n        axisInfo.seriesDataCount == null && (axisInfo.seriesDataCount = 0);\n        axisInfo.seriesDataCount += seriesModel.getData().count();\n      }\n    });\n  }, this);\n}\n/**\n * For example:\n * {\n *     axisPointer: {\n *         links: [{\n *             xAxisIndex: [2, 4],\n *             yAxisIndex: 'all'\n *         }, {\n *             xAxisId: ['a5', 'a7'],\n *             xAxisName: 'xxx'\n *         }]\n *     }\n * }\n */\n\n\nfunction getLinkGroupIndex(linksOption, axis) {\n  var axisModel = axis.model;\n  var dim = axis.dim;\n\n  for (var i = 0; i < linksOption.length; i++) {\n    var linkOption = linksOption[i] || {};\n\n    if (checkPropInLink(linkOption[dim + 'AxisId'], axisModel.id) || checkPropInLink(linkOption[dim + 'AxisIndex'], axisModel.componentIndex) || checkPropInLink(linkOption[dim + 'AxisName'], axisModel.name)) {\n      return i;\n    }\n  }\n}\n\nfunction checkPropInLink(linkPropValue, axisPropValue) {\n  return linkPropValue === 'all' || isArray(linkPropValue) && indexOf(linkPropValue, axisPropValue) >= 0 || linkPropValue === axisPropValue;\n}\n\nfunction fixValue(axisModel) {\n  var axisInfo = getAxisInfo(axisModel);\n\n  if (!axisInfo) {\n    return;\n  }\n\n  var axisPointerModel = axisInfo.axisPointerModel;\n  var scale = axisInfo.axis.scale;\n  var option = axisPointerModel.option;\n  var status = axisPointerModel.get('status');\n  var value = axisPointerModel.get('value'); // Parse init value for category and time axis.\n\n  if (value != null) {\n    value = scale.parse(value);\n  }\n\n  var useHandle = isHandleTrigger(axisPointerModel); // If `handle` used, `axisPointer` will always be displayed, so value\n  // and status should be initialized.\n\n  if (status == null) {\n    option.status = useHandle ? 'show' : 'hide';\n  }\n\n  var extent = scale.getExtent().slice();\n  extent[0] > extent[1] && extent.reverse();\n\n  if ( // Pick a value on axis when initializing.\n  value == null // If both `handle` and `dataZoom` are used, value may be out of axis extent,\n  // where we should re-pick a value to keep `handle` displaying normally.\n  || value > extent[1]) {\n    // Make handle displayed on the end of the axis when init, which looks better.\n    value = extent[1];\n  }\n\n  if (value < extent[0]) {\n    value = extent[0];\n  }\n\n  option.value = value;\n\n  if (useHandle) {\n    option.status = axisInfo.axis.scale.isBlank() ? 'hide' : 'show';\n  }\n}\nfunction getAxisInfo(axisModel) {\n  var coordSysAxesInfo = (axisModel.ecModel.getComponent('axisPointer') || {}).coordSysAxesInfo;\n  return coordSysAxesInfo && coordSysAxesInfo.axesInfo[makeKey(axisModel)];\n}\nfunction getAxisPointerModel(axisModel) {\n  var axisInfo = getAxisInfo(axisModel);\n  return axisInfo && axisInfo.axisPointerModel;\n}\n\nfunction isHandleTrigger(axisPointerModel) {\n  return !!axisPointerModel.get('handle.show');\n}\n/**\n * @param {module:echarts/model/Model} model\n * @return {string} unique key\n */\n\n\nfunction makeKey(model) {\n  return model.type + '||' + model.id;\n}\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n/**\n * Base class of AxisView.\n */\n\nvar AxisView = extendComponentView({\n  type: 'axis',\n\n  /**\n   * @private\n   */\n  _axisPointer: null,\n\n  /**\n   * @protected\n   * @type {string}\n   */\n  axisPointerClass: null,\n\n  /**\n   * @override\n   */\n  render: function (axisModel, ecModel, api, payload) {\n    // FIXME\n    // This process should proformed after coordinate systems updated\n    // (axis scale updated), and should be performed each time update.\n    // So put it here temporarily, although it is not appropriate to\n    // put a model-writing procedure in `view`.\n    this.axisPointerClass && fixValue(axisModel);\n    AxisView.superApply(this, 'render', arguments);\n    updateAxisPointer(this, axisModel, ecModel, api, payload, true);\n  },\n\n  /**\n   * Action handler.\n   * @public\n   * @param {module:echarts/coord/cartesian/AxisModel} axisModel\n   * @param {module:echarts/model/Global} ecModel\n   * @param {module:echarts/ExtensionAPI} api\n   * @param {Object} payload\n   */\n  updateAxisPointer: function (axisModel, ecModel, api, payload, force) {\n    updateAxisPointer(this, axisModel, ecModel, api, payload, false);\n  },\n\n  /**\n   * @override\n   */\n  remove: function (ecModel, api) {\n    var axisPointer = this._axisPointer;\n    axisPointer && axisPointer.remove(api);\n    AxisView.superApply(this, 'remove', arguments);\n  },\n\n  /**\n   * @override\n   */\n  dispose: function (ecModel, api) {\n    disposeAxisPointer(this, api);\n    AxisView.superApply(this, 'dispose', arguments);\n  }\n});\n\nfunction updateAxisPointer(axisView, axisModel, ecModel, api, payload, forceRender) {\n  var Clazz = AxisView.getAxisPointerClass(axisView.axisPointerClass);\n\n  if (!Clazz) {\n    return;\n  }\n\n  var axisPointerModel = getAxisPointerModel(axisModel);\n  axisPointerModel ? (axisView._axisPointer || (axisView._axisPointer = new Clazz())).render(axisModel, axisPointerModel, api, forceRender) : disposeAxisPointer(axisView, api);\n}\n\nfunction disposeAxisPointer(axisView, ecModel, api) {\n  var axisPointer = axisView._axisPointer;\n  axisPointer && axisPointer.dispose(ecModel, api);\n  axisView._axisPointer = null;\n}\n\nvar axisPointerClazz = [];\n\nAxisView.registerAxisPointerClass = function (type, clazz) {\n  axisPointerClazz[type] = clazz;\n};\n\nAxisView.getAxisPointerClass = function (type) {\n  return type && axisPointerClazz[type];\n};\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n/**\n * Can only be called after coordinate system creation stage.\n * (Can be called before coordinate system update stage).\n *\n * @param {Object} opt {labelInside}\n * @return {Object} {\n *  position, rotation, labelDirection, labelOffset,\n *  tickDirection, labelRotate, z2\n * }\n */\n\nfunction layout$1(gridModel, axisModel, opt) {\n  opt = opt || {};\n  var grid = gridModel.coordinateSystem;\n  var axis = axisModel.axis;\n  var layout = {};\n  var otherAxisOnZeroOf = axis.getAxesOnZeroOf()[0];\n  var rawAxisPosition = axis.position;\n  var axisPosition = otherAxisOnZeroOf ? 'onZero' : rawAxisPosition;\n  var axisDim = axis.dim;\n  var rect = grid.getRect();\n  var rectBound = [rect.x, rect.x + rect.width, rect.y, rect.y + rect.height];\n  var idx = {\n    left: 0,\n    right: 1,\n    top: 0,\n    bottom: 1,\n    onZero: 2\n  };\n  var axisOffset = axisModel.get('offset') || 0;\n  var posBound = axisDim === 'x' ? [rectBound[2] - axisOffset, rectBound[3] + axisOffset] : [rectBound[0] - axisOffset, rectBound[1] + axisOffset];\n\n  if (otherAxisOnZeroOf) {\n    var onZeroCoord = otherAxisOnZeroOf.toGlobalCoord(otherAxisOnZeroOf.dataToCoord(0));\n    posBound[idx['onZero']] = Math.max(Math.min(onZeroCoord, posBound[1]), posBound[0]);\n  } // Axis position\n\n\n  layout.position = [axisDim === 'y' ? posBound[idx[axisPosition]] : rectBound[0], axisDim === 'x' ? posBound[idx[axisPosition]] : rectBound[3]]; // Axis rotation\n\n  layout.rotation = Math.PI / 2 * (axisDim === 'x' ? 0 : 1); // Tick and label direction, x y is axisDim\n\n  var dirMap = {\n    top: -1,\n    bottom: 1,\n    left: -1,\n    right: 1\n  };\n  layout.labelDirection = layout.tickDirection = layout.nameDirection = dirMap[rawAxisPosition];\n  layout.labelOffset = otherAxisOnZeroOf ? posBound[idx[rawAxisPosition]] - posBound[idx['onZero']] : 0;\n\n  if (axisModel.get('axisTick.inside')) {\n    layout.tickDirection = -layout.tickDirection;\n  }\n\n  if (retrieve(opt.labelInside, axisModel.get('axisLabel.inside'))) {\n    layout.labelDirection = -layout.labelDirection;\n  } // Special label rotation\n\n\n  var labelRotate = axisModel.get('axisLabel.rotate');\n  layout.labelRotate = axisPosition === 'top' ? -labelRotate : labelRotate; // Over splitLine and splitArea\n\n  layout.z2 = 1;\n  return layout;\n}\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar axisBuilderAttrs = ['axisLine', 'axisTickLabel', 'axisName'];\nvar selfBuilderAttrs = ['splitArea', 'splitLine']; // function getAlignWithLabel(model, axisModel) {\n//     var alignWithLabel = model.get('alignWithLabel');\n//     if (alignWithLabel === 'auto') {\n//         alignWithLabel = axisModel.get('axisTick.alignWithLabel');\n//     }\n//     return alignWithLabel;\n// }\n\nvar CartesianAxisView = AxisView.extend({\n  type: 'cartesianAxis',\n  axisPointerClass: 'CartesianAxisPointer',\n\n  /**\n   * @override\n   */\n  render: function (axisModel, ecModel, api, payload) {\n    this.group.removeAll();\n    var oldAxisGroup = this._axisGroup;\n    this._axisGroup = new Group();\n    this.group.add(this._axisGroup);\n\n    if (!axisModel.get('show')) {\n      return;\n    }\n\n    var gridModel = axisModel.getCoordSysModel();\n    var layout = layout$1(gridModel, axisModel);\n    var axisBuilder = new AxisBuilder(axisModel, layout);\n    each$1(axisBuilderAttrs, axisBuilder.add, axisBuilder);\n\n    this._axisGroup.add(axisBuilder.getGroup());\n\n    each$1(selfBuilderAttrs, function (name) {\n      if (axisModel.get(name + '.show')) {\n        this['_' + name](axisModel, gridModel);\n      }\n    }, this);\n    groupTransition(oldAxisGroup, this._axisGroup, axisModel);\n    CartesianAxisView.superCall(this, 'render', axisModel, ecModel, api, payload);\n  },\n  remove: function () {\n    this._splitAreaColors = null;\n  },\n\n  /**\n   * @param {module:echarts/coord/cartesian/AxisModel} axisModel\n   * @param {module:echarts/coord/cartesian/GridModel} gridModel\n   * @private\n   */\n  _splitLine: function (axisModel, gridModel) {\n    var axis = axisModel.axis;\n\n    if (axis.scale.isBlank()) {\n      return;\n    }\n\n    var splitLineModel = axisModel.getModel('splitLine');\n    var lineStyleModel = splitLineModel.getModel('lineStyle');\n    var lineColors = lineStyleModel.get('color');\n    lineColors = isArray(lineColors) ? lineColors : [lineColors];\n    var gridRect = gridModel.coordinateSystem.getRect();\n    var isHorizontal = axis.isHorizontal();\n    var lineCount = 0;\n    var ticksCoords = axis.getTicksCoords({\n      tickModel: splitLineModel\n    });\n    var p1 = [];\n    var p2 = []; // Simple optimization\n    // Batching the lines if color are the same\n\n    var lineStyle = lineStyleModel.getLineStyle();\n\n    for (var i = 0; i < ticksCoords.length; i++) {\n      var tickCoord = axis.toGlobalCoord(ticksCoords[i].coord);\n\n      if (isHorizontal) {\n        p1[0] = tickCoord;\n        p1[1] = gridRect.y;\n        p2[0] = tickCoord;\n        p2[1] = gridRect.y + gridRect.height;\n      } else {\n        p1[0] = gridRect.x;\n        p1[1] = tickCoord;\n        p2[0] = gridRect.x + gridRect.width;\n        p2[1] = tickCoord;\n      }\n\n      var colorIndex = lineCount++ % lineColors.length;\n      var tickValue = ticksCoords[i].tickValue;\n\n      this._axisGroup.add(new Line(subPixelOptimizeLine({\n        anid: tickValue != null ? 'line_' + ticksCoords[i].tickValue : null,\n        shape: {\n          x1: p1[0],\n          y1: p1[1],\n          x2: p2[0],\n          y2: p2[1]\n        },\n        style: defaults({\n          stroke: lineColors[colorIndex]\n        }, lineStyle),\n        silent: true\n      })));\n    }\n  },\n\n  /**\n   * @param {module:echarts/coord/cartesian/AxisModel} axisModel\n   * @param {module:echarts/coord/cartesian/GridModel} gridModel\n   * @private\n   */\n  _splitArea: function (axisModel, gridModel) {\n    var axis = axisModel.axis;\n\n    if (axis.scale.isBlank()) {\n      return;\n    }\n\n    var splitAreaModel = axisModel.getModel('splitArea');\n    var areaStyleModel = splitAreaModel.getModel('areaStyle');\n    var areaColors = areaStyleModel.get('color');\n    var gridRect = gridModel.coordinateSystem.getRect();\n    var ticksCoords = axis.getTicksCoords({\n      tickModel: splitAreaModel,\n      clamp: true\n    });\n\n    if (!ticksCoords.length) {\n      return;\n    } // For Making appropriate splitArea animation, the color and anid\n    // should be corresponding to previous one if possible.\n\n\n    var areaColorsLen = areaColors.length;\n    var lastSplitAreaColors = this._splitAreaColors;\n    var newSplitAreaColors = createHashMap();\n    var colorIndex = 0;\n\n    if (lastSplitAreaColors) {\n      for (var i = 0; i < ticksCoords.length; i++) {\n        var cIndex = lastSplitAreaColors.get(ticksCoords[i].tickValue);\n\n        if (cIndex != null) {\n          colorIndex = (cIndex + (areaColorsLen - 1) * i) % areaColorsLen;\n          break;\n        }\n      }\n    }\n\n    var prev = axis.toGlobalCoord(ticksCoords[0].coord);\n    var areaStyle = areaStyleModel.getAreaStyle();\n    areaColors = isArray(areaColors) ? areaColors : [areaColors];\n\n    for (var i = 1; i < ticksCoords.length; i++) {\n      var tickCoord = axis.toGlobalCoord(ticksCoords[i].coord);\n      var x;\n      var y;\n      var width;\n      var height;\n\n      if (axis.isHorizontal()) {\n        x = prev;\n        y = gridRect.y;\n        width = tickCoord - x;\n        height = gridRect.height;\n        prev = x + width;\n      } else {\n        x = gridRect.x;\n        y = prev;\n        width = gridRect.width;\n        height = tickCoord - y;\n        prev = y + height;\n      }\n\n      var tickValue = ticksCoords[i - 1].tickValue;\n      tickValue != null && newSplitAreaColors.set(tickValue, colorIndex);\n\n      this._axisGroup.add(new Rect({\n        anid: tickValue != null ? 'area_' + tickValue : null,\n        shape: {\n          x: x,\n          y: y,\n          width: width,\n          height: height\n        },\n        style: defaults({\n          fill: areaColors[colorIndex]\n        }, areaStyle),\n        silent: true\n      }));\n\n      colorIndex = (colorIndex + 1) % areaColorsLen;\n    }\n\n    this._splitAreaColors = newSplitAreaColors;\n  }\n});\nCartesianAxisView.extend({\n  type: 'xAxis'\n});\nCartesianAxisView.extend({\n  type: 'yAxis'\n});\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nextendComponentView({\n  type: 'grid',\n  render: function (gridModel, ecModel) {\n    this.group.removeAll();\n\n    if (gridModel.get('show')) {\n      this.group.add(new Rect({\n        shape: gridModel.coordinateSystem.getRect(),\n        style: defaults({\n          fill: gridModel.get('backgroundColor')\n        }, gridModel.getItemStyle()),\n        silent: true,\n        z2: -1\n      }));\n    }\n  }\n});\nregisterPreprocessor(function (option) {\n  // Only create grid when need\n  if (option.xAxis && option.yAxis && !option.grid) {\n    option.grid = {};\n  }\n});\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nregisterLayout(curry(layout, 'bar')); // Should after normal bar layout, otherwise it is blocked by normal bar layout.\n\nregisterLayout(largeLayout);\nregisterVisual({\n  seriesType: 'bar',\n  reset: function (seriesModel) {\n    // Visual coding for legend\n    seriesModel.getData().setVisual('legendSymbol', 'roundRect');\n  }\n});\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nextendComponentModel({\n  type: 'title',\n  layoutMode: {\n    type: 'box',\n    ignoreSize: true\n  },\n  defaultOption: {\n    // \n    zlevel: 0,\n    // \n    z: 6,\n    show: true,\n    text: '',\n    // \n    // link: null,\n    // self | blank\n    target: 'blank',\n    subtext: '',\n    // \n    // sublink: null,\n    // self | blank\n    subtarget: 'blank',\n    // 'center'  'left'  'right'\n    //  {number}xpx\n    left: 0,\n    // 'top'  'bottom'  'center'\n    //  {number}ypx\n    top: 0,\n    // \n    // 'auto' | 'left' | 'right' | 'center'\n    //  left \n    // textAlign: null\n    //\n    // \n    // 'auto' | 'top' | 'bottom' | 'middle'\n    //  top \n    // textBaseline: null\n    backgroundColor: 'rgba(0,0,0,0)',\n    // \n    borderColor: '#ccc',\n    // px0\n    borderWidth: 0,\n    // px5\n    // css\n    padding: 5,\n    // px10\n    itemGap: 10,\n    textStyle: {\n      fontSize: 18,\n      fontWeight: 'bolder',\n      color: '#333'\n    },\n    subtextStyle: {\n      color: '#aaa'\n    }\n  }\n}); // View\n\nextendComponentView({\n  type: 'title',\n  render: function (titleModel, ecModel, api) {\n    this.group.removeAll();\n\n    if (!titleModel.get('show')) {\n      return;\n    }\n\n    var group = this.group;\n    var textStyleModel = titleModel.getModel('textStyle');\n    var subtextStyleModel = titleModel.getModel('subtextStyle');\n    var textAlign = titleModel.get('textAlign');\n    var textBaseline = titleModel.get('textBaseline');\n    var textEl = new Text({\n      style: setTextStyle({}, textStyleModel, {\n        text: titleModel.get('text'),\n        textFill: textStyleModel.getTextColor()\n      }, {\n        disableBox: true\n      }),\n      z2: 10\n    });\n    var textRect = textEl.getBoundingRect();\n    var subText = titleModel.get('subtext');\n    var subTextEl = new Text({\n      style: setTextStyle({}, subtextStyleModel, {\n        text: subText,\n        textFill: subtextStyleModel.getTextColor(),\n        y: textRect.height + titleModel.get('itemGap'),\n        textVerticalAlign: 'top'\n      }, {\n        disableBox: true\n      }),\n      z2: 10\n    });\n    var link = titleModel.get('link');\n    var sublink = titleModel.get('sublink');\n    textEl.silent = !link;\n    subTextEl.silent = !sublink;\n\n    if (link) {\n      textEl.on('click', function () {\n        window.open(link, '_' + titleModel.get('target'));\n      });\n    }\n\n    if (sublink) {\n      subTextEl.on('click', function () {\n        window.open(sublink, '_' + titleModel.get('subtarget'));\n      });\n    }\n\n    group.add(textEl);\n    subText && group.add(subTextEl); // If no subText, but add subTextEl, there will be an empty line.\n\n    var groupRect = group.getBoundingRect();\n    var layoutOption = titleModel.getBoxLayoutParams();\n    layoutOption.width = groupRect.width;\n    layoutOption.height = groupRect.height;\n    var layoutRect = getLayoutRect(layoutOption, {\n      width: api.getWidth(),\n      height: api.getHeight()\n    }, titleModel.get('padding')); // Adjust text align based on position\n\n    if (!textAlign) {\n      // Align left if title is on the left. center and right is same\n      textAlign = titleModel.get('left') || titleModel.get('right');\n\n      if (textAlign === 'middle') {\n        textAlign = 'center';\n      } // Adjust layout by text align\n\n\n      if (textAlign === 'right') {\n        layoutRect.x += layoutRect.width;\n      } else if (textAlign === 'center') {\n        layoutRect.x += layoutRect.width / 2;\n      }\n    }\n\n    if (!textBaseline) {\n      textBaseline = titleModel.get('top') || titleModel.get('bottom');\n\n      if (textBaseline === 'center') {\n        textBaseline = 'middle';\n      }\n\n      if (textBaseline === 'bottom') {\n        layoutRect.y += layoutRect.height;\n      } else if (textBaseline === 'middle') {\n        layoutRect.y += layoutRect.height / 2;\n      }\n\n      textBaseline = textBaseline || 'top';\n    }\n\n    group.attr('position', [layoutRect.x, layoutRect.y]);\n    var alignStyle = {\n      textAlign: textAlign,\n      textVerticalAlign: textBaseline\n    };\n    textEl.setStyle(alignStyle);\n    subTextEl.setStyle(alignStyle); // Render background\n    // Get groupRect again because textAlign has been changed\n\n    groupRect = group.getBoundingRect();\n    var padding = layoutRect.margin;\n    var style = titleModel.getItemStyle(['color', 'opacity']);\n    style.fill = titleModel.get('backgroundColor');\n    var rect = new Rect({\n      shape: {\n        x: groupRect.x - padding[3],\n        y: groupRect.y - padding[0],\n        width: groupRect.width + padding[1] + padding[3],\n        height: groupRect.height + padding[0] + padding[2],\n        r: titleModel.get('borderRadius')\n      },\n      style: style,\n      silent: true\n    });\n    subPixelOptimizeRect(rect);\n    group.add(rect);\n  }\n});\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar LegendModel = extendComponentModel({\n  type: 'legend.plain',\n  dependencies: ['series'],\n  layoutMode: {\n    type: 'box',\n    // legend.width/height are maxWidth/maxHeight actually,\n    // whereas realy width/height is calculated by its content.\n    // (Setting {left: 10, right: 10} does not make sense).\n    // So consider the case:\n    // `setOption({legend: {left: 10});`\n    // then `setOption({legend: {right: 10});`\n    // The previous `left` should be cleared by setting `ignoreSize`.\n    ignoreSize: true\n  },\n  init: function (option, parentModel, ecModel) {\n    this.mergeDefaultAndTheme(option, ecModel);\n    option.selected = option.selected || {};\n  },\n  mergeOption: function (option) {\n    LegendModel.superCall(this, 'mergeOption', option);\n  },\n  optionUpdated: function () {\n    this._updateData(this.ecModel);\n\n    var legendData = this._data; // If selectedMode is single, try to select one\n\n    if (legendData[0] && this.get('selectedMode') === 'single') {\n      var hasSelected = false; // If has any selected in option.selected\n\n      for (var i = 0; i < legendData.length; i++) {\n        var name = legendData[i].get('name');\n\n        if (this.isSelected(name)) {\n          // Force to unselect others\n          this.select(name);\n          hasSelected = true;\n          break;\n        }\n      } // Try select the first if selectedMode is single\n\n\n      !hasSelected && this.select(legendData[0].get('name'));\n    }\n  },\n  _updateData: function (ecModel) {\n    var potentialData = [];\n    var availableNames = [];\n    ecModel.eachRawSeries(function (seriesModel) {\n      var seriesName = seriesModel.name;\n      availableNames.push(seriesName);\n      var isPotential;\n\n      if (seriesModel.legendDataProvider) {\n        var data = seriesModel.legendDataProvider();\n        var names = data.mapArray(data.getName);\n\n        if (!ecModel.isSeriesFiltered(seriesModel)) {\n          availableNames = availableNames.concat(names);\n        }\n\n        if (names.length) {\n          potentialData = potentialData.concat(names);\n        } else {\n          isPotential = true;\n        }\n      } else {\n        isPotential = true;\n      }\n\n      if (isPotential && isNameSpecified(seriesModel)) {\n        potentialData.push(seriesModel.name);\n      }\n    });\n    /**\n     * @type {Array.<string>}\n     * @private\n     */\n\n    this._availableNames = availableNames; // If legend.data not specified in option, use availableNames as data,\n    // which is convinient for user preparing option.\n\n    var rawData = this.get('data') || potentialData;\n    var legendData = map(rawData, function (dataItem) {\n      // Can be string or number\n      if (typeof dataItem === 'string' || typeof dataItem === 'number') {\n        dataItem = {\n          name: dataItem\n        };\n      }\n\n      return new Model(dataItem, this, this.ecModel);\n    }, this);\n    /**\n     * @type {Array.<module:echarts/model/Model>}\n     * @private\n     */\n\n    this._data = legendData;\n  },\n\n  /**\n   * @return {Array.<module:echarts/model/Model>}\n   */\n  getData: function () {\n    return this._data;\n  },\n\n  /**\n   * @param {string} name\n   */\n  select: function (name) {\n    var selected = this.option.selected;\n    var selectedMode = this.get('selectedMode');\n\n    if (selectedMode === 'single') {\n      var data = this._data;\n      each$1(data, function (dataItem) {\n        selected[dataItem.get('name')] = false;\n      });\n    }\n\n    selected[name] = true;\n  },\n\n  /**\n   * @param {string} name\n   */\n  unSelect: function (name) {\n    if (this.get('selectedMode') !== 'single') {\n      this.option.selected[name] = false;\n    }\n  },\n\n  /**\n   * @param {string} name\n   */\n  toggleSelected: function (name) {\n    var selected = this.option.selected; // Default is true\n\n    if (!selected.hasOwnProperty(name)) {\n      selected[name] = true;\n    }\n\n    this[selected[name] ? 'unSelect' : 'select'](name);\n  },\n\n  /**\n   * @param {string} name\n   */\n  isSelected: function (name) {\n    var selected = this.option.selected;\n    return !(selected.hasOwnProperty(name) && !selected[name]) && indexOf(this._availableNames, name) >= 0;\n  },\n  defaultOption: {\n    // \n    zlevel: 0,\n    // \n    z: 4,\n    show: true,\n    // \n    // 'horizontal' | 'vertical'\n    orient: 'horizontal',\n    left: 'center',\n    // right: 'center',\n    top: 0,\n    // bottom: null,\n    // \n    // 'auto' | 'left' | 'right'\n    //  'auto',  x \n    align: 'auto',\n    backgroundColor: 'rgba(0,0,0,0)',\n    // \n    borderColor: '#ccc',\n    borderRadius: 0,\n    // px0\n    borderWidth: 0,\n    // px5\n    // css\n    padding: 5,\n    // itempx10\n    // \n    itemGap: 10,\n    // \n    itemWidth: 25,\n    // \n    itemHeight: 14,\n    // \n    inactiveColor: '#ccc',\n    textStyle: {\n      // \n      color: '#333'\n    },\n    // formatter: '',\n    // \n    selectedMode: true,\n    // LEGEND.SELECTED\n    // selected: null,\n    // legend.dataitem\n    // data: [],\n    // Tooltip \n    tooltip: {\n      show: false\n    }\n  }\n});\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nfunction legendSelectActionHandler(methodName, payload, ecModel) {\n  var selectedMap = {};\n  var isToggleSelect = methodName === 'toggleSelected';\n  var isSelected; // Update all legend components\n\n  ecModel.eachComponent('legend', function (legendModel) {\n    if (isToggleSelect && isSelected != null) {\n      // Force other legend has same selected status\n      // Or the first is toggled to true and other are toggled to false\n      // In the case one legend has some item unSelected in option. And if other legend\n      // doesn't has the item, they will assume it is selected.\n      legendModel[isSelected ? 'select' : 'unSelect'](payload.name);\n    } else {\n      legendModel[methodName](payload.name);\n      isSelected = legendModel.isSelected(payload.name);\n    }\n\n    var legendData = legendModel.getData();\n    each$1(legendData, function (model) {\n      var name = model.get('name'); // Wrap element\n\n      if (name === '\\n' || name === '') {\n        return;\n      }\n\n      var isItemSelected = legendModel.isSelected(name);\n\n      if (selectedMap.hasOwnProperty(name)) {\n        // Unselected if any legend is unselected\n        selectedMap[name] = selectedMap[name] && isItemSelected;\n      } else {\n        selectedMap[name] = isItemSelected;\n      }\n    });\n  }); // Return the event explicitly\n\n  return {\n    name: payload.name,\n    selected: selectedMap\n  };\n}\n/**\n * @event legendToggleSelect\n * @type {Object}\n * @property {string} type 'legendToggleSelect'\n * @property {string} [from]\n * @property {string} name Series name or data item name\n */\n\n\nregisterAction('legendToggleSelect', 'legendselectchanged', curry(legendSelectActionHandler, 'toggleSelected'));\n/**\n * @event legendSelect\n * @type {Object}\n * @property {string} type 'legendSelect'\n * @property {string} name Series name or data item name\n */\n\nregisterAction('legendSelect', 'legendselected', curry(legendSelectActionHandler, 'select'));\n/**\n * @event legendUnSelect\n * @type {Object}\n * @property {string} type 'legendUnSelect'\n * @property {string} name Series name or data item name\n */\n\nregisterAction('legendUnSelect', 'legendunselected', curry(legendSelectActionHandler, 'unSelect'));\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n/**\n * Layout list like component.\n * It will box layout each items in group of component and then position the whole group in the viewport\n * @param {module:zrender/group/Group} group\n * @param {module:echarts/model/Component} componentModel\n * @param {module:echarts/ExtensionAPI}\n */\n\n\nfunction makeBackground(rect, componentModel) {\n  var padding = normalizeCssArray$1(componentModel.get('padding'));\n  var style = componentModel.getItemStyle(['color', 'opacity']);\n  style.fill = componentModel.get('backgroundColor');\n  var rect = new Rect({\n    shape: {\n      x: rect.x - padding[3],\n      y: rect.y - padding[0],\n      width: rect.width + padding[1] + padding[3],\n      height: rect.height + padding[0] + padding[2],\n      r: componentModel.get('borderRadius')\n    },\n    style: style,\n    silent: true,\n    z2: -1\n  }); // FIXME\n  // `subPixelOptimizeRect` may bring some gap between edge of viewpart\n  // and background rect when setting like `left: 0`, `top: 0`.\n  // graphic.subPixelOptimizeRect(rect);\n\n  return rect;\n}\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar curry$2 = curry;\nvar each$7 = each$1;\nvar Group$2 = Group;\nvar LegendView = extendComponentView({\n  type: 'legend.plain',\n  newlineDisabled: false,\n\n  /**\n   * @override\n   */\n  init: function () {\n    /**\n     * @private\n     * @type {module:zrender/container/Group}\n     */\n    this.group.add(this._contentGroup = new Group$2());\n    /**\n     * @private\n     * @type {module:zrender/Element}\n     */\n\n    this._backgroundEl;\n  },\n\n  /**\n   * @protected\n   */\n  getContentGroup: function () {\n    return this._contentGroup;\n  },\n\n  /**\n   * @override\n   */\n  render: function (legendModel, ecModel, api) {\n    this.resetInner();\n\n    if (!legendModel.get('show', true)) {\n      return;\n    }\n\n    var itemAlign = legendModel.get('align');\n\n    if (!itemAlign || itemAlign === 'auto') {\n      itemAlign = legendModel.get('left') === 'right' && legendModel.get('orient') === 'vertical' ? 'right' : 'left';\n    }\n\n    this.renderInner(itemAlign, legendModel, ecModel, api); // Perform layout.\n\n    var positionInfo = legendModel.getBoxLayoutParams();\n    var viewportSize = {\n      width: api.getWidth(),\n      height: api.getHeight()\n    };\n    var padding = legendModel.get('padding');\n    var maxSize = getLayoutRect(positionInfo, viewportSize, padding);\n    var mainRect = this.layoutInner(legendModel, itemAlign, maxSize); // Place mainGroup, based on the calculated `mainRect`.\n\n    var layoutRect = getLayoutRect(defaults({\n      width: mainRect.width,\n      height: mainRect.height\n    }, positionInfo), viewportSize, padding);\n    this.group.attr('position', [layoutRect.x - mainRect.x, layoutRect.y - mainRect.y]); // Render background after group is layout.\n\n    this.group.add(this._backgroundEl = makeBackground(mainRect, legendModel));\n  },\n\n  /**\n   * @protected\n   */\n  resetInner: function () {\n    this.getContentGroup().removeAll();\n    this._backgroundEl && this.group.remove(this._backgroundEl);\n  },\n\n  /**\n   * @protected\n   */\n  renderInner: function (itemAlign, legendModel, ecModel, api) {\n    var contentGroup = this.getContentGroup();\n    var legendDrawnMap = createHashMap();\n    var selectMode = legendModel.get('selectedMode');\n    var excludeSeriesId = [];\n    ecModel.eachRawSeries(function (seriesModel) {\n      !seriesModel.get('legendHoverLink') && excludeSeriesId.push(seriesModel.id);\n    });\n    each$7(legendModel.getData(), function (itemModel, dataIndex) {\n      var name = itemModel.get('name'); // Use empty string or \\n as a newline string\n\n      if (!this.newlineDisabled && (name === '' || name === '\\n')) {\n        contentGroup.add(new Group$2({\n          newline: true\n        }));\n        return;\n      } // Representitive series.\n\n\n      var seriesModel = ecModel.getSeriesByName(name)[0];\n\n      if (legendDrawnMap.get(name)) {\n        // Have been drawed\n        return;\n      } // Series legend\n\n\n      if (seriesModel) {\n        var data = seriesModel.getData();\n        var color = data.getVisual('color'); // If color is a callback function\n\n        if (typeof color === 'function') {\n          // Use the first data\n          color = color(seriesModel.getDataParams(0));\n        } // Using rect symbol defaultly\n\n\n        var legendSymbolType = data.getVisual('legendSymbol') || 'roundRect';\n        var symbolType = data.getVisual('symbol');\n\n        var itemGroup = this._createItem(name, dataIndex, itemModel, legendModel, legendSymbolType, symbolType, itemAlign, color, selectMode);\n\n        itemGroup.on('click', curry$2(dispatchSelectAction, name, api)).on('mouseover', curry$2(dispatchHighlightAction, seriesModel, null, api, excludeSeriesId)).on('mouseout', curry$2(dispatchDownplayAction, seriesModel, null, api, excludeSeriesId));\n        legendDrawnMap.set(name, true);\n      } else {\n        // Data legend of pie, funnel\n        ecModel.eachRawSeries(function (seriesModel) {\n          // In case multiple series has same data name\n          if (legendDrawnMap.get(name)) {\n            return;\n          }\n\n          if (seriesModel.legendDataProvider) {\n            var data = seriesModel.legendDataProvider();\n            var idx = data.indexOfName(name);\n\n            if (idx < 0) {\n              return;\n            }\n\n            var color = data.getItemVisual(idx, 'color');\n            var legendSymbolType = 'roundRect';\n\n            var itemGroup = this._createItem(name, dataIndex, itemModel, legendModel, legendSymbolType, null, itemAlign, color, selectMode); // FIXME: consider different series has items with the same name.\n\n\n            itemGroup.on('click', curry$2(dispatchSelectAction, name, api)) // FIXME Should not specify the series name\n            .on('mouseover', curry$2(dispatchHighlightAction, seriesModel, name, api, excludeSeriesId)).on('mouseout', curry$2(dispatchDownplayAction, seriesModel, name, api, excludeSeriesId));\n            legendDrawnMap.set(name, true);\n          }\n        }, this);\n      }\n    }, this);\n  },\n  _createItem: function (name, dataIndex, itemModel, legendModel, legendSymbolType, symbolType, itemAlign, color, selectMode) {\n    var itemWidth = legendModel.get('itemWidth');\n    var itemHeight = legendModel.get('itemHeight');\n    var inactiveColor = legendModel.get('inactiveColor');\n    var symbolKeepAspect = legendModel.get('symbolKeepAspect');\n    var isSelected = legendModel.isSelected(name);\n    var itemGroup = new Group$2();\n    var textStyleModel = itemModel.getModel('textStyle');\n    var itemIcon = itemModel.get('icon');\n    var tooltipModel = itemModel.getModel('tooltip');\n    var legendGlobalTooltipModel = tooltipModel.parentModel; // Use user given icon first\n\n    legendSymbolType = itemIcon || legendSymbolType;\n    itemGroup.add(createSymbol(legendSymbolType, 0, 0, itemWidth, itemHeight, isSelected ? color : inactiveColor, // symbolKeepAspect default true for legend\n    symbolKeepAspect == null ? true : symbolKeepAspect)); // Compose symbols\n    // PENDING\n\n    if (!itemIcon && symbolType // At least show one symbol, can't be all none\n    && (symbolType !== legendSymbolType || symbolType == 'none')) {\n      var size = itemHeight * 0.8;\n\n      if (symbolType === 'none') {\n        symbolType = 'circle';\n      } // Put symbol in the center\n\n\n      itemGroup.add(createSymbol(symbolType, (itemWidth - size) / 2, (itemHeight - size) / 2, size, size, isSelected ? color : inactiveColor, // symbolKeepAspect default true for legend\n      symbolKeepAspect == null ? true : symbolKeepAspect));\n    }\n\n    var textX = itemAlign === 'left' ? itemWidth + 5 : -5;\n    var textAlign = itemAlign;\n    var formatter = legendModel.get('formatter');\n    var content = name;\n\n    if (typeof formatter === 'string' && formatter) {\n      content = formatter.replace('{name}', name != null ? name : '');\n    } else if (typeof formatter === 'function') {\n      content = formatter(name);\n    }\n\n    itemGroup.add(new Text({\n      style: setTextStyle({}, textStyleModel, {\n        text: content,\n        x: textX,\n        y: itemHeight / 2,\n        textFill: isSelected ? textStyleModel.getTextColor() : inactiveColor,\n        textAlign: textAlign,\n        textVerticalAlign: 'middle'\n      })\n    })); // Add a invisible rect to increase the area of mouse hover\n\n    var hitRect = new Rect({\n      shape: itemGroup.getBoundingRect(),\n      invisible: true,\n      tooltip: tooltipModel.get('show') ? extend({\n        content: name,\n        // Defaul formatter\n        formatter: legendGlobalTooltipModel.get('formatter', true) || function () {\n          return name;\n        },\n        formatterParams: {\n          componentType: 'legend',\n          legendIndex: legendModel.componentIndex,\n          name: name,\n          $vars: ['name']\n        }\n      }, tooltipModel.option) : null\n    });\n    itemGroup.add(hitRect);\n    itemGroup.eachChild(function (child) {\n      child.silent = true;\n    });\n    hitRect.silent = !selectMode;\n    this.getContentGroup().add(itemGroup);\n    setHoverStyle(itemGroup);\n    itemGroup.__legendDataIndex = dataIndex;\n    return itemGroup;\n  },\n\n  /**\n   * @protected\n   */\n  layoutInner: function (legendModel, itemAlign, maxSize) {\n    var contentGroup = this.getContentGroup(); // Place items in contentGroup.\n\n    box(legendModel.get('orient'), contentGroup, legendModel.get('itemGap'), maxSize.width, maxSize.height);\n    var contentRect = contentGroup.getBoundingRect();\n    contentGroup.attr('position', [-contentRect.x, -contentRect.y]);\n    return this.group.getBoundingRect();\n  }\n});\n\nfunction dispatchSelectAction(name, api) {\n  api.dispatchAction({\n    type: 'legendToggleSelect',\n    name: name\n  });\n}\n\nfunction dispatchHighlightAction(seriesModel, dataName, api, excludeSeriesId) {\n  // If element hover will move to a hoverLayer.\n  var el = api.getZr().storage.getDisplayList()[0];\n\n  if (!(el && el.useHoverLayer)) {\n    api.dispatchAction({\n      type: 'highlight',\n      seriesName: seriesModel.name,\n      name: dataName,\n      excludeSeriesId: excludeSeriesId\n    });\n  }\n}\n\nfunction dispatchDownplayAction(seriesModel, dataName, api, excludeSeriesId) {\n  // If element hover will move to a hoverLayer.\n  var el = api.getZr().storage.getDisplayList()[0];\n\n  if (!(el && el.useHoverLayer)) {\n    api.dispatchAction({\n      type: 'downplay',\n      seriesName: seriesModel.name,\n      name: dataName,\n      excludeSeriesId: excludeSeriesId\n    });\n  }\n}\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar legendFilter = function (ecModel) {\n  var legendModels = ecModel.findComponents({\n    mainType: 'legend'\n  });\n\n  if (legendModels && legendModels.length) {\n    ecModel.filterSeries(function (series) {\n      // If in any legend component the status is not selected.\n      // Because in legend series is assumed selected when it is not in the legend data.\n      for (var i = 0; i < legendModels.length; i++) {\n        if (!legendModels[i].isSelected(series.name)) {\n          return false;\n        }\n      }\n\n      return true;\n    });\n  }\n};\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n// Do not contain scrollable legend, for sake of file size.\nregisterProcessor(legendFilter);\nComponentModel.registerSubTypeDefaulter('legend', function () {\n  // Default 'plain' when no type specified.\n  return 'plain';\n});\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar ScrollableLegendModel = LegendModel.extend({\n  type: 'legend.scroll',\n\n  /**\n   * @param {number} scrollDataIndex\n   */\n  setScrollDataIndex: function (scrollDataIndex) {\n    this.option.scrollDataIndex = scrollDataIndex;\n  },\n  defaultOption: {\n    scrollDataIndex: 0,\n    pageButtonItemGap: 5,\n    pageButtonGap: null,\n    pageButtonPosition: 'end',\n    // 'start' or 'end'\n    pageFormatter: '{current}/{total}',\n    // If null/undefined, do not show page.\n    pageIcons: {\n      horizontal: ['M0,0L12,-10L12,10z', 'M0,0L-12,-10L-12,10z'],\n      vertical: ['M0,0L20,0L10,-20z', 'M0,0L20,0L10,20z']\n    },\n    pageIconColor: '#2f4554',\n    pageIconInactiveColor: '#aaa',\n    pageIconSize: 15,\n    // Can be [10, 3], which represents [width, height]\n    pageTextStyle: {\n      color: '#333'\n    },\n    animationDurationUpdate: 800\n  },\n\n  /**\n   * @override\n   */\n  init: function (option, parentModel, ecModel, extraOpt) {\n    var inputPositionParams = getLayoutParams(option);\n    ScrollableLegendModel.superCall(this, 'init', option, parentModel, ecModel, extraOpt);\n    mergeAndNormalizeLayoutParams(this, option, inputPositionParams);\n  },\n\n  /**\n   * @override\n   */\n  mergeOption: function (option, extraOpt) {\n    ScrollableLegendModel.superCall(this, 'mergeOption', option, extraOpt);\n    mergeAndNormalizeLayoutParams(this, this.option, option);\n  },\n  getOrient: function () {\n    return this.get('orient') === 'vertical' ? {\n      index: 1,\n      name: 'vertical'\n    } : {\n      index: 0,\n      name: 'horizontal'\n    };\n  }\n}); // Do not `ignoreSize` to enable setting {left: 10, right: 10}.\n\nfunction mergeAndNormalizeLayoutParams(legendModel, target, raw) {\n  var orient = legendModel.getOrient();\n  var ignoreSize = [1, 1];\n  ignoreSize[orient.index] = 0;\n  mergeLayoutParam(target, raw, {\n    type: 'box',\n    ignoreSize: ignoreSize\n  });\n}\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * Separate legend and scrollable legend to reduce package size.\n */\nvar Group$3 = Group;\nvar WH = ['width', 'height'];\nvar XY = ['x', 'y'];\nvar ScrollableLegendView = LegendView.extend({\n  type: 'legend.scroll',\n  newlineDisabled: true,\n  init: function () {\n    ScrollableLegendView.superCall(this, 'init');\n    /**\n     * @private\n     * @type {number} For `scroll`.\n     */\n\n    this._currentIndex = 0;\n    /**\n     * @private\n     * @type {module:zrender/container/Group}\n     */\n\n    this.group.add(this._containerGroup = new Group$3());\n\n    this._containerGroup.add(this.getContentGroup());\n    /**\n     * @private\n     * @type {module:zrender/container/Group}\n     */\n\n\n    this.group.add(this._controllerGroup = new Group$3());\n    /**\n     *\n     * @private\n     */\n\n    this._showController;\n  },\n\n  /**\n   * @override\n   */\n  resetInner: function () {\n    ScrollableLegendView.superCall(this, 'resetInner');\n\n    this._controllerGroup.removeAll();\n\n    this._containerGroup.removeClipPath();\n\n    this._containerGroup.__rectSize = null;\n  },\n\n  /**\n   * @override\n   */\n  renderInner: function (itemAlign, legendModel, ecModel, api) {\n    var me = this; // Render content items.\n\n    ScrollableLegendView.superCall(this, 'renderInner', itemAlign, legendModel, ecModel, api);\n    var controllerGroup = this._controllerGroup;\n    var pageIconSize = legendModel.get('pageIconSize', true);\n\n    if (!isArray(pageIconSize)) {\n      pageIconSize = [pageIconSize, pageIconSize];\n    }\n\n    createPageButton('pagePrev', 0);\n    var pageTextStyleModel = legendModel.getModel('pageTextStyle');\n    controllerGroup.add(new Text({\n      name: 'pageText',\n      style: {\n        textFill: pageTextStyleModel.getTextColor(),\n        font: pageTextStyleModel.getFont(),\n        textVerticalAlign: 'middle',\n        textAlign: 'center'\n      },\n      silent: true\n    }));\n    createPageButton('pageNext', 1);\n\n    function createPageButton(name, iconIdx) {\n      var pageDataIndexName = name + 'DataIndex';\n      var icon = createIcon(legendModel.get('pageIcons', true)[legendModel.getOrient().name][iconIdx], {\n        // Buttons will be created in each render, so we do not need\n        // to worry about avoiding using legendModel kept in scope.\n        onclick: bind(me._pageGo, me, pageDataIndexName, legendModel, api)\n      }, {\n        x: -pageIconSize[0] / 2,\n        y: -pageIconSize[1] / 2,\n        width: pageIconSize[0],\n        height: pageIconSize[1]\n      });\n      icon.name = name;\n      controllerGroup.add(icon);\n    }\n  },\n\n  /**\n   * @override\n   */\n  layoutInner: function (legendModel, itemAlign, maxSize) {\n    var contentGroup = this.getContentGroup();\n    var containerGroup = this._containerGroup;\n    var controllerGroup = this._controllerGroup;\n    var orientIdx = legendModel.getOrient().index;\n    var wh = WH[orientIdx];\n    var hw = WH[1 - orientIdx];\n    var yx = XY[1 - orientIdx]; // Place items in contentGroup.\n\n    box(legendModel.get('orient'), contentGroup, legendModel.get('itemGap'), !orientIdx ? null : maxSize.width, orientIdx ? null : maxSize.height);\n    box( // Buttons in controller are layout always horizontally.\n    'horizontal', controllerGroup, legendModel.get('pageButtonItemGap', true));\n    var contentRect = contentGroup.getBoundingRect();\n    var controllerRect = controllerGroup.getBoundingRect();\n    var showController = this._showController = contentRect[wh] > maxSize[wh];\n    var contentPos = [-contentRect.x, -contentRect.y]; // Remain contentPos when scroll animation perfroming.\n\n    contentPos[orientIdx] = contentGroup.position[orientIdx]; // Layout container group based on 0.\n\n    var containerPos = [0, 0];\n    var controllerPos = [-controllerRect.x, -controllerRect.y];\n    var pageButtonGap = retrieve2(legendModel.get('pageButtonGap', true), legendModel.get('itemGap', true)); // Place containerGroup and controllerGroup and contentGroup.\n\n    if (showController) {\n      var pageButtonPosition = legendModel.get('pageButtonPosition', true); // controller is on the right / bottom.\n\n      if (pageButtonPosition === 'end') {\n        controllerPos[orientIdx] += maxSize[wh] - controllerRect[wh];\n      } // controller is on the left / top.\n      else {\n          containerPos[orientIdx] += controllerRect[wh] + pageButtonGap;\n        }\n    } // Always align controller to content as 'middle'.\n\n\n    controllerPos[1 - orientIdx] += contentRect[hw] / 2 - controllerRect[hw] / 2;\n    contentGroup.attr('position', contentPos);\n    containerGroup.attr('position', containerPos);\n    controllerGroup.attr('position', controllerPos); // Calculate `mainRect` and set `clipPath`.\n    // mainRect should not be calculated by `this.group.getBoundingRect()`\n    // for sake of the overflow.\n\n    var mainRect = this.group.getBoundingRect();\n    var mainRect = {\n      x: 0,\n      y: 0\n    }; // Consider content may be overflow (should be clipped).\n\n    mainRect[wh] = showController ? maxSize[wh] : contentRect[wh];\n    mainRect[hw] = Math.max(contentRect[hw], controllerRect[hw]); // `containerRect[yx] + containerPos[1 - orientIdx]` is 0.\n\n    mainRect[yx] = Math.min(0, controllerRect[yx] + controllerPos[1 - orientIdx]);\n    containerGroup.__rectSize = maxSize[wh];\n\n    if (showController) {\n      var clipShape = {\n        x: 0,\n        y: 0\n      };\n      clipShape[wh] = Math.max(maxSize[wh] - controllerRect[wh] - pageButtonGap, 0);\n      clipShape[hw] = mainRect[hw];\n      containerGroup.setClipPath(new Rect({\n        shape: clipShape\n      })); // Consider content may be larger than container, container rect\n      // can not be obtained from `containerGroup.getBoundingRect()`.\n\n      containerGroup.__rectSize = clipShape[wh];\n    } else {\n      // Do not remove or ignore controller. Keep them set as place holders.\n      controllerGroup.eachChild(function (child) {\n        child.attr({\n          invisible: true,\n          silent: true\n        });\n      });\n    } // Content translate animation.\n\n\n    var pageInfo = this._getPageInfo(legendModel);\n\n    pageInfo.pageIndex != null && updateProps(contentGroup, {\n      position: pageInfo.contentPosition\n    }, // When switch from \"show controller\" to \"not show controller\", view should be\n    // updated immediately without animation, otherwise causes weird efffect.\n    showController ? legendModel : false);\n\n    this._updatePageInfoView(legendModel, pageInfo);\n\n    return mainRect;\n  },\n  _pageGo: function (to, legendModel, api) {\n    var scrollDataIndex = this._getPageInfo(legendModel)[to];\n\n    scrollDataIndex != null && api.dispatchAction({\n      type: 'legendScroll',\n      scrollDataIndex: scrollDataIndex,\n      legendId: legendModel.id\n    });\n  },\n  _updatePageInfoView: function (legendModel, pageInfo) {\n    var controllerGroup = this._controllerGroup;\n    each$1(['pagePrev', 'pageNext'], function (name) {\n      var canJump = pageInfo[name + 'DataIndex'] != null;\n      var icon = controllerGroup.childOfName(name);\n\n      if (icon) {\n        icon.setStyle('fill', canJump ? legendModel.get('pageIconColor', true) : legendModel.get('pageIconInactiveColor', true));\n        icon.cursor = canJump ? 'pointer' : 'default';\n      }\n    });\n    var pageText = controllerGroup.childOfName('pageText');\n    var pageFormatter = legendModel.get('pageFormatter');\n    var pageIndex = pageInfo.pageIndex;\n    var current = pageIndex != null ? pageIndex + 1 : 0;\n    var total = pageInfo.pageCount;\n    pageText && pageFormatter && pageText.setStyle('text', isString(pageFormatter) ? pageFormatter.replace('{current}', current).replace('{total}', total) : pageFormatter({\n      current: current,\n      total: total\n    }));\n  },\n\n  /**\n   * @param {module:echarts/model/Model} legendModel\n   * @return {Object} {\n   *  contentPosition: Array.<number>, null when data item not found.\n   *  pageIndex: number, null when data item not found.\n   *  pageCount: number, always be a number, can be 0.\n   *  pagePrevDataIndex: number, null when no next page.\n   *  pageNextDataIndex: number, null when no previous page.\n   * }\n   */\n  _getPageInfo: function (legendModel) {\n    // Align left or top by the current dataIndex.\n    var currDataIndex = legendModel.get('scrollDataIndex', true);\n    var contentGroup = this.getContentGroup();\n    var contentRect = contentGroup.getBoundingRect();\n    var containerRectSize = this._containerGroup.__rectSize;\n    var orientIdx = legendModel.getOrient().index;\n    var wh = WH[orientIdx];\n    var hw = WH[1 - orientIdx];\n    var xy = XY[orientIdx];\n    var contentPos = contentGroup.position.slice();\n    var pageIndex;\n    var pagePrevDataIndex;\n    var pageNextDataIndex;\n    var targetItemGroup;\n\n    if (this._showController) {\n      contentGroup.eachChild(function (child) {\n        if (child.__legendDataIndex === currDataIndex) {\n          targetItemGroup = child;\n        }\n      });\n    } else {\n      targetItemGroup = contentGroup.childAt(0);\n    }\n\n    var pageCount = containerRectSize ? Math.ceil(contentRect[wh] / containerRectSize) : 0;\n\n    if (targetItemGroup) {\n      var itemRect = targetItemGroup.getBoundingRect();\n      var itemLoc = targetItemGroup.position[orientIdx] + itemRect[xy];\n      contentPos[orientIdx] = -itemLoc - contentRect[xy];\n      pageIndex = Math.floor(pageCount * (itemLoc + itemRect[xy] + containerRectSize / 2) / contentRect[wh]);\n      pageIndex = contentRect[wh] && pageCount ? Math.max(0, Math.min(pageCount - 1, pageIndex)) : -1;\n      var winRect = {\n        x: 0,\n        y: 0\n      };\n      winRect[wh] = containerRectSize;\n      winRect[hw] = contentRect[hw];\n      winRect[xy] = -contentPos[orientIdx] - contentRect[xy];\n      var startIdx;\n      var children = contentGroup.children();\n      contentGroup.eachChild(function (child, index) {\n        var itemRect = getItemRect(child);\n\n        if (itemRect.intersect(winRect)) {\n          startIdx == null && (startIdx = index); // It is user-friendly that the last item shown in the\n          // current window is shown at the begining of next window.\n\n          pageNextDataIndex = child.__legendDataIndex;\n        } // If the last item is shown entirely, no next page.\n\n\n        if (index === children.length - 1 && itemRect[xy] + itemRect[wh] <= winRect[xy] + winRect[wh]) {\n          pageNextDataIndex = null;\n        }\n      }); // Always align based on the left/top most item, so the left/top most\n      // item in the previous window is needed to be found here.\n\n      if (startIdx != null) {\n        var startItem = children[startIdx];\n        var startRect = getItemRect(startItem);\n        winRect[xy] = startRect[xy] + startRect[wh] - winRect[wh]; // If the first item is shown entirely, no previous page.\n\n        if (startIdx <= 0 && startRect[xy] >= winRect[xy]) {\n          pagePrevDataIndex = null;\n        } else {\n          while (startIdx > 0 && getItemRect(children[startIdx - 1]).intersect(winRect)) {\n            startIdx--;\n          }\n\n          pagePrevDataIndex = children[startIdx].__legendDataIndex;\n        }\n      }\n    }\n\n    return {\n      contentPosition: contentPos,\n      pageIndex: pageIndex,\n      pageCount: pageCount,\n      pagePrevDataIndex: pagePrevDataIndex,\n      pageNextDataIndex: pageNextDataIndex\n    };\n\n    function getItemRect(el) {\n      var itemRect = el.getBoundingRect().clone();\n      itemRect[xy] += el.position[orientIdx];\n      return itemRect;\n    }\n  }\n});\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n/**\n * @event legendScroll\n * @type {Object}\n * @property {string} type 'legendScroll'\n * @property {string} scrollDataIndex\n */\n\nregisterAction('legendScroll', 'legendscroll', function (payload, ecModel) {\n  var scrollDataIndex = payload.scrollDataIndex;\n  scrollDataIndex != null && ecModel.eachComponent({\n    mainType: 'legend',\n    subType: 'scroll',\n    query: payload\n  }, function (legendModel) {\n    legendModel.setScrollDataIndex(scrollDataIndex);\n  });\n});\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * Legend component entry file8\n */\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n/**\n * @param {Object} finder contains {seriesIndex, dataIndex, dataIndexInside}\n * @param {module:echarts/model/Global} ecModel\n * @return {Object} {point: [x, y], el: ...} point Will not be null.\n */\n\nvar findPointFromSeries = function (finder, ecModel) {\n  var point = [];\n  var seriesIndex = finder.seriesIndex;\n  var seriesModel;\n\n  if (seriesIndex == null || !(seriesModel = ecModel.getSeriesByIndex(seriesIndex))) {\n    return {\n      point: []\n    };\n  }\n\n  var data = seriesModel.getData();\n  var dataIndex = queryDataIndex(data, finder);\n\n  if (dataIndex == null || dataIndex < 0 || isArray(dataIndex)) {\n    return {\n      point: []\n    };\n  }\n\n  var el = data.getItemGraphicEl(dataIndex);\n  var coordSys = seriesModel.coordinateSystem;\n\n  if (seriesModel.getTooltipPosition) {\n    point = seriesModel.getTooltipPosition(dataIndex) || [];\n  } else if (coordSys && coordSys.dataToPoint) {\n    point = coordSys.dataToPoint(data.getValues(map(coordSys.dimensions, function (dim) {\n      return data.mapDimension(dim);\n    }), dataIndex, true)) || [];\n  } else if (el) {\n    // Use graphic bounding rect\n    var rect = el.getBoundingRect().clone();\n    rect.applyTransform(el.transform);\n    point = [rect.x + rect.width / 2, rect.y + rect.height / 2];\n  }\n\n  return {\n    point: point,\n    el: el\n  };\n};\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar each$8 = each$1;\nvar curry$3 = curry;\nvar inner$7 = makeInner();\n/**\n * Basic logic: check all axis, if they do not demand show/highlight,\n * then hide/downplay them.\n *\n * @param {Object} coordSysAxesInfo\n * @param {Object} payload\n * @param {string} [payload.currTrigger] 'click' | 'mousemove' | 'leave'\n * @param {Array.<number>} [payload.x] x and y, which are mandatory, specify a point to\n *              trigger axisPointer and tooltip.\n * @param {Array.<number>} [payload.y] x and y, which are mandatory, specify a point to\n *              trigger axisPointer and tooltip.\n * @param {Object} [payload.seriesIndex] finder, optional, restrict target axes.\n * @param {Object} [payload.dataIndex] finder, restrict target axes.\n * @param {Object} [payload.axesInfo] finder, restrict target axes.\n *        [{\n *          axisDim: 'x'|'y'|'angle'|...,\n *          axisIndex: ...,\n *          value: ...\n *        }, ...]\n * @param {Function} [payload.dispatchAction]\n * @param {Object} [payload.tooltipOption]\n * @param {Object|Array.<number>|Function} [payload.position] Tooltip position,\n *        which can be specified in dispatchAction\n * @param {module:echarts/model/Global} ecModel\n * @param {module:echarts/ExtensionAPI} api\n * @return {Object} content of event obj for echarts.connect.\n */\n\nvar axisTrigger = function (payload, ecModel, api) {\n  var currTrigger = payload.currTrigger;\n  var point = [payload.x, payload.y];\n  var finder = payload;\n  var dispatchAction = payload.dispatchAction || bind(api.dispatchAction, api);\n  var coordSysAxesInfo = ecModel.getComponent('axisPointer').coordSysAxesInfo; // Pending\n  // See #6121. But we are not able to reproduce it yet.\n\n  if (!coordSysAxesInfo) {\n    return;\n  }\n\n  if (illegalPoint(point)) {\n    // Used in the default behavior of `connection`: use the sample seriesIndex\n    // and dataIndex. And also used in the tooltipView trigger.\n    point = findPointFromSeries({\n      seriesIndex: finder.seriesIndex,\n      // Do not use dataIndexInside from other ec instance.\n      // FIXME: auto detect it?\n      dataIndex: finder.dataIndex\n    }, ecModel).point;\n  }\n\n  var isIllegalPoint = illegalPoint(point); // Axis and value can be specified when calling dispatchAction({type: 'updateAxisPointer'}).\n  // Notice: In this case, it is difficult to get the `point` (which is necessary to show\n  // tooltip, so if point is not given, we just use the point found by sample seriesIndex\n  // and dataIndex.\n\n  var inputAxesInfo = finder.axesInfo;\n  var axesInfo = coordSysAxesInfo.axesInfo;\n  var shouldHide = currTrigger === 'leave' || illegalPoint(point);\n  var outputFinder = {};\n  var showValueMap = {};\n  var dataByCoordSys = {\n    list: [],\n    map: {}\n  };\n  var updaters = {\n    showPointer: curry$3(showPointer, showValueMap),\n    showTooltip: curry$3(showTooltip, dataByCoordSys)\n  }; // Process for triggered axes.\n\n  each$8(coordSysAxesInfo.coordSysMap, function (coordSys, coordSysKey) {\n    // If a point given, it must be contained by the coordinate system.\n    var coordSysContainsPoint = isIllegalPoint || coordSys.containPoint(point);\n    each$8(coordSysAxesInfo.coordSysAxesInfo[coordSysKey], function (axisInfo, key) {\n      var axis = axisInfo.axis;\n      var inputAxisInfo = findInputAxisInfo(inputAxesInfo, axisInfo); // If no inputAxesInfo, no axis is restricted.\n\n      if (!shouldHide && coordSysContainsPoint && (!inputAxesInfo || inputAxisInfo)) {\n        var val = inputAxisInfo && inputAxisInfo.value;\n\n        if (val == null && !isIllegalPoint) {\n          val = axis.pointToData(point);\n        }\n\n        val != null && processOnAxis(axisInfo, val, updaters, false, outputFinder);\n      }\n    });\n  }); // Process for linked axes.\n\n  var linkTriggers = {};\n  each$8(axesInfo, function (tarAxisInfo, tarKey) {\n    var linkGroup = tarAxisInfo.linkGroup; // If axis has been triggered in the previous stage, it should not be triggered by link.\n\n    if (linkGroup && !showValueMap[tarKey]) {\n      each$8(linkGroup.axesInfo, function (srcAxisInfo, srcKey) {\n        var srcValItem = showValueMap[srcKey]; // If srcValItem exist, source axis is triggered, so link to target axis.\n\n        if (srcAxisInfo !== tarAxisInfo && srcValItem) {\n          var val = srcValItem.value;\n          linkGroup.mapper && (val = tarAxisInfo.axis.scale.parse(linkGroup.mapper(val, makeMapperParam(srcAxisInfo), makeMapperParam(tarAxisInfo))));\n          linkTriggers[tarAxisInfo.key] = val;\n        }\n      });\n    }\n  });\n  each$8(linkTriggers, function (val, tarKey) {\n    processOnAxis(axesInfo[tarKey], val, updaters, true, outputFinder);\n  });\n  updateModelActually(showValueMap, axesInfo, outputFinder);\n  dispatchTooltipActually(dataByCoordSys, point, payload, dispatchAction);\n  dispatchHighDownActually(axesInfo, dispatchAction, api);\n  return outputFinder;\n};\n\nfunction processOnAxis(axisInfo, newValue, updaters, dontSnap, outputFinder) {\n  var axis = axisInfo.axis;\n\n  if (axis.scale.isBlank() || !axis.containData(newValue)) {\n    return;\n  }\n\n  if (!axisInfo.involveSeries) {\n    updaters.showPointer(axisInfo, newValue);\n    return;\n  } // Heavy calculation. So put it after axis.containData checking.\n\n\n  var payloadInfo = buildPayloadsBySeries(newValue, axisInfo);\n  var payloadBatch = payloadInfo.payloadBatch;\n  var snapToValue = payloadInfo.snapToValue; // Fill content of event obj for echarts.connect.\n  // By defualt use the first involved series data as a sample to connect.\n\n  if (payloadBatch[0] && outputFinder.seriesIndex == null) {\n    extend(outputFinder, payloadBatch[0]);\n  } // If no linkSource input, this process is for collecting link\n  // target, where snap should not be accepted.\n\n\n  if (!dontSnap && axisInfo.snap) {\n    if (axis.containData(snapToValue) && snapToValue != null) {\n      newValue = snapToValue;\n    }\n  }\n\n  updaters.showPointer(axisInfo, newValue, payloadBatch, outputFinder); // Tooltip should always be snapToValue, otherwise there will be\n  // incorrect \"axis value ~ series value\" mapping displayed in tooltip.\n\n  updaters.showTooltip(axisInfo, payloadInfo, snapToValue);\n}\n\nfunction buildPayloadsBySeries(value, axisInfo) {\n  var axis = axisInfo.axis;\n  var dim = axis.dim;\n  var snapToValue = value;\n  var payloadBatch = [];\n  var minDist = Number.MAX_VALUE;\n  var minDiff = -1;\n  each$8(axisInfo.seriesModels, function (series, idx) {\n    var dataDim = series.getData().mapDimension(dim, true);\n    var seriesNestestValue;\n    var dataIndices;\n\n    if (series.getAxisTooltipData) {\n      var result = series.getAxisTooltipData(dataDim, value, axis);\n      dataIndices = result.dataIndices;\n      seriesNestestValue = result.nestestValue;\n    } else {\n      dataIndices = series.getData().indicesOfNearest(dataDim[0], value, // Add a threshold to avoid find the wrong dataIndex\n      // when data length is not same.\n      // false,\n      axis.type === 'category' ? 0.5 : null);\n\n      if (!dataIndices.length) {\n        return;\n      }\n\n      seriesNestestValue = series.getData().get(dataDim[0], dataIndices[0]);\n    }\n\n    if (seriesNestestValue == null || !isFinite(seriesNestestValue)) {\n      return;\n    }\n\n    var diff = value - seriesNestestValue;\n    var dist = Math.abs(diff); // Consider category case\n\n    if (dist <= minDist) {\n      if (dist < minDist || diff >= 0 && minDiff < 0) {\n        minDist = dist;\n        minDiff = diff;\n        snapToValue = seriesNestestValue;\n        payloadBatch.length = 0;\n      }\n\n      each$8(dataIndices, function (dataIndex) {\n        payloadBatch.push({\n          seriesIndex: series.seriesIndex,\n          dataIndexInside: dataIndex,\n          dataIndex: series.getData().getRawIndex(dataIndex)\n        });\n      });\n    }\n  });\n  return {\n    payloadBatch: payloadBatch,\n    snapToValue: snapToValue\n  };\n}\n\nfunction showPointer(showValueMap, axisInfo, value, payloadBatch) {\n  showValueMap[axisInfo.key] = {\n    value: value,\n    payloadBatch: payloadBatch\n  };\n}\n\nfunction showTooltip(dataByCoordSys, axisInfo, payloadInfo, value) {\n  var payloadBatch = payloadInfo.payloadBatch;\n  var axis = axisInfo.axis;\n  var axisModel = axis.model;\n  var axisPointerModel = axisInfo.axisPointerModel; // If no data, do not create anything in dataByCoordSys,\n  // whose length will be used to judge whether dispatch action.\n\n  if (!axisInfo.triggerTooltip || !payloadBatch.length) {\n    return;\n  }\n\n  var coordSysModel = axisInfo.coordSys.model;\n  var coordSysKey = makeKey(coordSysModel);\n  var coordSysItem = dataByCoordSys.map[coordSysKey];\n\n  if (!coordSysItem) {\n    coordSysItem = dataByCoordSys.map[coordSysKey] = {\n      coordSysId: coordSysModel.id,\n      coordSysIndex: coordSysModel.componentIndex,\n      coordSysType: coordSysModel.type,\n      coordSysMainType: coordSysModel.mainType,\n      dataByAxis: []\n    };\n    dataByCoordSys.list.push(coordSysItem);\n  }\n\n  coordSysItem.dataByAxis.push({\n    axisDim: axis.dim,\n    axisIndex: axisModel.componentIndex,\n    axisType: axisModel.type,\n    axisId: axisModel.id,\n    value: value,\n    // Caustion: viewHelper.getValueLabel is actually on \"view stage\", which\n    // depends that all models have been updated. So it should not be performed\n    // here. Considering axisPointerModel used here is volatile, which is hard\n    // to be retrieve in TooltipView, we prepare parameters here.\n    valueLabelOpt: {\n      precision: axisPointerModel.get('label.precision'),\n      formatter: axisPointerModel.get('label.formatter')\n    },\n    seriesDataIndices: payloadBatch.slice()\n  });\n}\n\nfunction updateModelActually(showValueMap, axesInfo, outputFinder) {\n  var outputAxesInfo = outputFinder.axesInfo = []; // Basic logic: If no 'show' required, 'hide' this axisPointer.\n\n  each$8(axesInfo, function (axisInfo, key) {\n    var option = axisInfo.axisPointerModel.option;\n    var valItem = showValueMap[key];\n\n    if (valItem) {\n      !axisInfo.useHandle && (option.status = 'show');\n      option.value = valItem.value; // For label formatter param and highlight.\n\n      option.seriesDataIndices = (valItem.payloadBatch || []).slice();\n    } // When always show (e.g., handle used), remain\n    // original value and status.\n    else {\n        // If hide, value still need to be set, consider\n        // click legend to toggle axis blank.\n        !axisInfo.useHandle && (option.status = 'hide');\n      } // If status is 'hide', should be no info in payload.\n\n\n    option.status === 'show' && outputAxesInfo.push({\n      axisDim: axisInfo.axis.dim,\n      axisIndex: axisInfo.axis.model.componentIndex,\n      value: option.value\n    });\n  });\n}\n\nfunction dispatchTooltipActually(dataByCoordSys, point, payload, dispatchAction) {\n  // Basic logic: If no showTip required, hideTip will be dispatched.\n  if (illegalPoint(point) || !dataByCoordSys.list.length) {\n    dispatchAction({\n      type: 'hideTip'\n    });\n    return;\n  } // In most case only one axis (or event one series is used). It is\n  // convinient to fetch payload.seriesIndex and payload.dataIndex\n  // dirtectly. So put the first seriesIndex and dataIndex of the first\n  // axis on the payload.\n\n\n  var sampleItem = ((dataByCoordSys.list[0].dataByAxis[0] || {}).seriesDataIndices || [])[0] || {};\n  dispatchAction({\n    type: 'showTip',\n    escapeConnect: true,\n    x: point[0],\n    y: point[1],\n    tooltipOption: payload.tooltipOption,\n    position: payload.position,\n    dataIndexInside: sampleItem.dataIndexInside,\n    dataIndex: sampleItem.dataIndex,\n    seriesIndex: sampleItem.seriesIndex,\n    dataByCoordSys: dataByCoordSys.list\n  });\n}\n\nfunction dispatchHighDownActually(axesInfo, dispatchAction, api) {\n  // FIXME\n  // highlight status modification shoule be a stage of main process?\n  // (Consider confilct (e.g., legend and axisPointer) and setOption)\n  var zr = api.getZr();\n  var highDownKey = 'axisPointerLastHighlights';\n  var lastHighlights = inner$7(zr)[highDownKey] || {};\n  var newHighlights = inner$7(zr)[highDownKey] = {}; // Update highlight/downplay status according to axisPointer model.\n  // Build hash map and remove duplicate incidentally.\n\n  each$8(axesInfo, function (axisInfo, key) {\n    var option = axisInfo.axisPointerModel.option;\n    option.status === 'show' && each$8(option.seriesDataIndices, function (batchItem) {\n      var key = batchItem.seriesIndex + ' | ' + batchItem.dataIndex;\n      newHighlights[key] = batchItem;\n    });\n  }); // Diff.\n\n  var toHighlight = [];\n  var toDownplay = [];\n  each$1(lastHighlights, function (batchItem, key) {\n    !newHighlights[key] && toDownplay.push(batchItem);\n  });\n  each$1(newHighlights, function (batchItem, key) {\n    !lastHighlights[key] && toHighlight.push(batchItem);\n  });\n  toDownplay.length && api.dispatchAction({\n    type: 'downplay',\n    escapeConnect: true,\n    batch: toDownplay\n  });\n  toHighlight.length && api.dispatchAction({\n    type: 'highlight',\n    escapeConnect: true,\n    batch: toHighlight\n  });\n}\n\nfunction findInputAxisInfo(inputAxesInfo, axisInfo) {\n  for (var i = 0; i < (inputAxesInfo || []).length; i++) {\n    var inputAxisInfo = inputAxesInfo[i];\n\n    if (axisInfo.axis.dim === inputAxisInfo.axisDim && axisInfo.axis.model.componentIndex === inputAxisInfo.axisIndex) {\n      return inputAxisInfo;\n    }\n  }\n}\n\nfunction makeMapperParam(axisInfo) {\n  var axisModel = axisInfo.axis.model;\n  var item = {};\n  var dim = item.axisDim = axisInfo.axis.dim;\n  item.axisIndex = item[dim + 'AxisIndex'] = axisModel.componentIndex;\n  item.axisName = item[dim + 'AxisName'] = axisModel.name;\n  item.axisId = item[dim + 'AxisId'] = axisModel.id;\n  return item;\n}\n\nfunction illegalPoint(point) {\n  return !point || point[0] == null || isNaN(point[0]) || point[1] == null || isNaN(point[1]);\n}\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar AxisPointerModel = extendComponentModel({\n  type: 'axisPointer',\n  coordSysAxesInfo: null,\n  defaultOption: {\n    // 'auto' means that show when triggered by tooltip or handle.\n    show: 'auto',\n    // 'click' | 'mousemove' | 'none'\n    triggerOn: null,\n    // set default in AxisPonterView.js\n    zlevel: 0,\n    z: 50,\n    type: 'line',\n    // axispointer triggered by tootip determine snap automatically,\n    // see `modelHelper`.\n    snap: false,\n    triggerTooltip: true,\n    value: null,\n    status: null,\n    // Init value depends on whether handle is used.\n    // [group0, group1, ...]\n    // Each group can be: {\n    //      mapper: function () {},\n    //      singleTooltip: 'multiple',  // 'multiple' or 'single'\n    //      xAxisId: ...,\n    //      yAxisName: ...,\n    //      angleAxisIndex: ...\n    // }\n    // mapper: can be ignored.\n    //      input: {axisInfo, value}\n    //      output: {axisInfo, value}\n    link: [],\n    // Do not set 'auto' here, otherwise global animation: false\n    // will not effect at this axispointer.\n    animation: null,\n    animationDurationUpdate: 200,\n    lineStyle: {\n      color: '#aaa',\n      width: 1,\n      type: 'solid'\n    },\n    shadowStyle: {\n      color: 'rgba(150,150,150,0.3)'\n    },\n    label: {\n      show: true,\n      formatter: null,\n      // string | Function\n      precision: 'auto',\n      // Or a number like 0, 1, 2 ...\n      margin: 3,\n      color: '#fff',\n      padding: [5, 7, 5, 7],\n      backgroundColor: 'auto',\n      // default: axis line color\n      borderColor: null,\n      borderWidth: 0,\n      shadowBlur: 3,\n      shadowColor: '#aaa' // Considering applicability, common style should\n      // better not have shadowOffset.\n      // shadowOffsetX: 0,\n      // shadowOffsetY: 2\n\n    },\n    handle: {\n      show: false,\n      icon: 'M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4h1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7v-1.2h6.6z M13.3,22H6.7v-1.2h6.6z M13.3,19.6H6.7v-1.2h6.6z',\n      // jshint ignore:line\n      size: 45,\n      // handle margin is from symbol center to axis, which is stable when circular move.\n      margin: 50,\n      // color: '#1b8bbd'\n      // color: '#2f4554'\n      color: '#333',\n      shadowBlur: 3,\n      shadowColor: '#aaa',\n      shadowOffsetX: 0,\n      shadowOffsetY: 2,\n      // For mobile performance\n      throttle: 40\n    }\n  }\n});\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar inner$8 = makeInner();\nvar each$9 = each$1;\n/**\n * @param {string} key\n * @param {module:echarts/ExtensionAPI} api\n * @param {Function} handler\n *      param: {string} currTrigger\n *      param: {Array.<number>} point\n */\n\nfunction register(key, api, handler) {\n  if (env$1.node) {\n    return;\n  }\n\n  var zr = api.getZr();\n  inner$8(zr).records || (inner$8(zr).records = {});\n  initGlobalListeners(zr, api);\n  var record = inner$8(zr).records[key] || (inner$8(zr).records[key] = {});\n  record.handler = handler;\n}\n\nfunction initGlobalListeners(zr, api) {\n  if (inner$8(zr).initialized) {\n    return;\n  }\n\n  inner$8(zr).initialized = true;\n  useHandler('click', curry(doEnter, 'click'));\n  useHandler('mousemove', curry(doEnter, 'mousemove')); // useHandler('mouseout', onLeave);\n\n  useHandler('globalout', onLeave);\n\n  function useHandler(eventType, cb) {\n    zr.on(eventType, function (e) {\n      var dis = makeDispatchAction(api);\n      each$9(inner$8(zr).records, function (record) {\n        record && cb(record, e, dis.dispatchAction);\n      });\n      dispatchTooltipFinally(dis.pendings, api);\n    });\n  }\n}\n\nfunction dispatchTooltipFinally(pendings, api) {\n  var showLen = pendings.showTip.length;\n  var hideLen = pendings.hideTip.length;\n  var actuallyPayload;\n\n  if (showLen) {\n    actuallyPayload = pendings.showTip[showLen - 1];\n  } else if (hideLen) {\n    actuallyPayload = pendings.hideTip[hideLen - 1];\n  }\n\n  if (actuallyPayload) {\n    actuallyPayload.dispatchAction = null;\n    api.dispatchAction(actuallyPayload);\n  }\n}\n\nfunction onLeave(record, e, dispatchAction) {\n  record.handler('leave', null, dispatchAction);\n}\n\nfunction doEnter(currTrigger, record, e, dispatchAction) {\n  record.handler(currTrigger, e, dispatchAction);\n}\n\nfunction makeDispatchAction(api) {\n  var pendings = {\n    showTip: [],\n    hideTip: []\n  }; // FIXME\n  // better approach?\n  // 'showTip' and 'hideTip' can be triggered by axisPointer and tooltip,\n  // which may be conflict, (axisPointer call showTip but tooltip call hideTip);\n  // So we have to add \"final stage\" to merge those dispatched actions.\n\n  var dispatchAction = function (payload) {\n    var pendingList = pendings[payload.type];\n\n    if (pendingList) {\n      pendingList.push(payload);\n    } else {\n      payload.dispatchAction = dispatchAction;\n      api.dispatchAction(payload);\n    }\n  };\n\n  return {\n    dispatchAction: dispatchAction,\n    pendings: pendings\n  };\n}\n/**\n * @param {string} key\n * @param {module:echarts/ExtensionAPI} api\n */\n\n\nfunction unregister(key, api) {\n  if (env$1.node) {\n    return;\n  }\n\n  var zr = api.getZr();\n  var record = (inner$8(zr).records || {})[key];\n\n  if (record) {\n    inner$8(zr).records[key] = null;\n  }\n}\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar AxisPointerView = extendComponentView({\n  type: 'axisPointer',\n  render: function (globalAxisPointerModel, ecModel, api) {\n    var globalTooltipModel = ecModel.getComponent('tooltip');\n    var triggerOn = globalAxisPointerModel.get('triggerOn') || globalTooltipModel && globalTooltipModel.get('triggerOn') || 'mousemove|click'; // Register global listener in AxisPointerView to enable\n    // AxisPointerView to be independent to Tooltip.\n\n    register('axisPointer', api, function (currTrigger, e, dispatchAction) {\n      // If 'none', it is not controlled by mouse totally.\n      if (triggerOn !== 'none' && (currTrigger === 'leave' || triggerOn.indexOf(currTrigger) >= 0)) {\n        dispatchAction({\n          type: 'updateAxisPointer',\n          currTrigger: currTrigger,\n          x: e && e.offsetX,\n          y: e && e.offsetY\n        });\n      }\n    });\n  },\n\n  /**\n   * @override\n   */\n  remove: function (ecModel, api) {\n    unregister(api.getZr(), 'axisPointer');\n    AxisPointerView.superApply(this._model, 'remove', arguments);\n  },\n\n  /**\n   * @override\n   */\n  dispose: function (ecModel, api) {\n    unregister('axisPointer', api);\n    AxisPointerView.superApply(this._model, 'dispose', arguments);\n  }\n});\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar inner$9 = makeInner();\nvar clone$4 = clone;\nvar bind$1 = bind;\n/**\n * Base axis pointer class in 2D.\n * Implemenents {module:echarts/component/axis/IAxisPointer}.\n */\n\nfunction BaseAxisPointer() {}\n\nBaseAxisPointer.prototype = {\n  /**\n   * @private\n   */\n  _group: null,\n\n  /**\n   * @private\n   */\n  _lastGraphicKey: null,\n\n  /**\n   * @private\n   */\n  _handle: null,\n\n  /**\n   * @private\n   */\n  _dragging: false,\n\n  /**\n   * @private\n   */\n  _lastValue: null,\n\n  /**\n   * @private\n   */\n  _lastStatus: null,\n\n  /**\n   * @private\n   */\n  _payloadInfo: null,\n\n  /**\n   * In px, arbitrary value. Do not set too small,\n   * no animation is ok for most cases.\n   * @protected\n   */\n  animationThreshold: 15,\n\n  /**\n   * @implement\n   */\n  render: function (axisModel, axisPointerModel, api, forceRender) {\n    var value = axisPointerModel.get('value');\n    var status = axisPointerModel.get('status'); // Bind them to `this`, not in closure, otherwise they will not\n    // be replaced when user calling setOption in not merge mode.\n\n    this._axisModel = axisModel;\n    this._axisPointerModel = axisPointerModel;\n    this._api = api; // Optimize: `render` will be called repeatly during mouse move.\n    // So it is power consuming if performing `render` each time,\n    // especially on mobile device.\n\n    if (!forceRender && this._lastValue === value && this._lastStatus === status) {\n      return;\n    }\n\n    this._lastValue = value;\n    this._lastStatus = status;\n    var group = this._group;\n    var handle = this._handle;\n\n    if (!status || status === 'hide') {\n      // Do not clear here, for animation better.\n      group && group.hide();\n      handle && handle.hide();\n      return;\n    }\n\n    group && group.show();\n    handle && handle.show(); // Otherwise status is 'show'\n\n    var elOption = {};\n    this.makeElOption(elOption, value, axisModel, axisPointerModel, api); // Enable change axis pointer type.\n\n    var graphicKey = elOption.graphicKey;\n\n    if (graphicKey !== this._lastGraphicKey) {\n      this.clear(api);\n    }\n\n    this._lastGraphicKey = graphicKey;\n    var moveAnimation = this._moveAnimation = this.determineAnimation(axisModel, axisPointerModel);\n\n    if (!group) {\n      group = this._group = new Group();\n      this.createPointerEl(group, elOption, axisModel, axisPointerModel);\n      this.createLabelEl(group, elOption, axisModel, axisPointerModel);\n      api.getZr().add(group);\n    } else {\n      var doUpdateProps = curry(updateProps$1, axisPointerModel, moveAnimation);\n      this.updatePointerEl(group, elOption, doUpdateProps, axisPointerModel);\n      this.updateLabelEl(group, elOption, doUpdateProps, axisPointerModel);\n    }\n\n    updateMandatoryProps(group, axisPointerModel, true);\n\n    this._renderHandle(value);\n  },\n\n  /**\n   * @implement\n   */\n  remove: function (api) {\n    this.clear(api);\n  },\n\n  /**\n   * @implement\n   */\n  dispose: function (api) {\n    this.clear(api);\n  },\n\n  /**\n   * @protected\n   */\n  determineAnimation: function (axisModel, axisPointerModel) {\n    var animation = axisPointerModel.get('animation');\n    var axis = axisModel.axis;\n    var isCategoryAxis = axis.type === 'category';\n    var useSnap = axisPointerModel.get('snap'); // Value axis without snap always do not snap.\n\n    if (!useSnap && !isCategoryAxis) {\n      return false;\n    }\n\n    if (animation === 'auto' || animation == null) {\n      var animationThreshold = this.animationThreshold;\n\n      if (isCategoryAxis && axis.getBandWidth() > animationThreshold) {\n        return true;\n      } // It is important to auto animation when snap used. Consider if there is\n      // a dataZoom, animation will be disabled when too many points exist, while\n      // it will be enabled for better visual effect when little points exist.\n\n\n      if (useSnap) {\n        var seriesDataCount = getAxisInfo(axisModel).seriesDataCount;\n        var axisExtent = axis.getExtent(); // Approximate band width\n\n        return Math.abs(axisExtent[0] - axisExtent[1]) / seriesDataCount > animationThreshold;\n      }\n\n      return false;\n    }\n\n    return animation === true;\n  },\n\n  /**\n   * add {pointer, label, graphicKey} to elOption\n   * @protected\n   */\n  makeElOption: function (elOption, value, axisModel, axisPointerModel, api) {// Shoule be implemenented by sub-class.\n  },\n\n  /**\n   * @protected\n   */\n  createPointerEl: function (group, elOption, axisModel, axisPointerModel) {\n    var pointerOption = elOption.pointer;\n\n    if (pointerOption) {\n      var pointerEl = inner$9(group).pointerEl = new graphic[pointerOption.type](clone$4(elOption.pointer));\n      group.add(pointerEl);\n    }\n  },\n\n  /**\n   * @protected\n   */\n  createLabelEl: function (group, elOption, axisModel, axisPointerModel) {\n    if (elOption.label) {\n      var labelEl = inner$9(group).labelEl = new Rect(clone$4(elOption.label));\n      group.add(labelEl);\n      updateLabelShowHide(labelEl, axisPointerModel);\n    }\n  },\n\n  /**\n   * @protected\n   */\n  updatePointerEl: function (group, elOption, updateProps$$1) {\n    var pointerEl = inner$9(group).pointerEl;\n\n    if (pointerEl) {\n      pointerEl.setStyle(elOption.pointer.style);\n      updateProps$$1(pointerEl, {\n        shape: elOption.pointer.shape\n      });\n    }\n  },\n\n  /**\n   * @protected\n   */\n  updateLabelEl: function (group, elOption, updateProps$$1, axisPointerModel) {\n    var labelEl = inner$9(group).labelEl;\n\n    if (labelEl) {\n      labelEl.setStyle(elOption.label.style);\n      updateProps$$1(labelEl, {\n        // Consider text length change in vertical axis, animation should\n        // be used on shape, otherwise the effect will be weird.\n        shape: elOption.label.shape,\n        position: elOption.label.position\n      });\n      updateLabelShowHide(labelEl, axisPointerModel);\n    }\n  },\n\n  /**\n   * @private\n   */\n  _renderHandle: function (value) {\n    if (this._dragging || !this.updateHandleTransform) {\n      return;\n    }\n\n    var axisPointerModel = this._axisPointerModel;\n\n    var zr = this._api.getZr();\n\n    var handle = this._handle;\n    var handleModel = axisPointerModel.getModel('handle');\n    var status = axisPointerModel.get('status');\n\n    if (!handleModel.get('show') || !status || status === 'hide') {\n      handle && zr.remove(handle);\n      this._handle = null;\n      return;\n    }\n\n    var isInit;\n\n    if (!this._handle) {\n      isInit = true;\n      handle = this._handle = createIcon(handleModel.get('icon'), {\n        cursor: 'move',\n        draggable: true,\n        onmousemove: function (e) {\n          // Fot mobile devicem, prevent screen slider on the button.\n          stop(e.event);\n        },\n        onmousedown: bind$1(this._onHandleDragMove, this, 0, 0),\n        drift: bind$1(this._onHandleDragMove, this),\n        ondragend: bind$1(this._onHandleDragEnd, this)\n      });\n      zr.add(handle);\n    }\n\n    updateMandatoryProps(handle, axisPointerModel, false); // update style\n\n    var includeStyles = ['color', 'borderColor', 'borderWidth', 'opacity', 'shadowColor', 'shadowBlur', 'shadowOffsetX', 'shadowOffsetY'];\n    handle.setStyle(handleModel.getItemStyle(null, includeStyles)); // update position\n\n    var handleSize = handleModel.get('size');\n\n    if (!isArray(handleSize)) {\n      handleSize = [handleSize, handleSize];\n    }\n\n    handle.attr('scale', [handleSize[0] / 2, handleSize[1] / 2]);\n    createOrUpdate(this, '_doDispatchAxisPointer', handleModel.get('throttle') || 0, 'fixRate');\n\n    this._moveHandleToValue(value, isInit);\n  },\n\n  /**\n   * @private\n   */\n  _moveHandleToValue: function (value, isInit) {\n    updateProps$1(this._axisPointerModel, !isInit && this._moveAnimation, this._handle, getHandleTransProps(this.getHandleTransform(value, this._axisModel, this._axisPointerModel)));\n  },\n\n  /**\n   * @private\n   */\n  _onHandleDragMove: function (dx, dy) {\n    var handle = this._handle;\n\n    if (!handle) {\n      return;\n    }\n\n    this._dragging = true; // Persistent for throttle.\n\n    var trans = this.updateHandleTransform(getHandleTransProps(handle), [dx, dy], this._axisModel, this._axisPointerModel);\n    this._payloadInfo = trans;\n    handle.stopAnimation();\n    handle.attr(getHandleTransProps(trans));\n    inner$9(handle).lastProp = null;\n\n    this._doDispatchAxisPointer();\n  },\n\n  /**\n   * Throttled method.\n   * @private\n   */\n  _doDispatchAxisPointer: function () {\n    var handle = this._handle;\n\n    if (!handle) {\n      return;\n    }\n\n    var payloadInfo = this._payloadInfo;\n    var axisModel = this._axisModel;\n\n    this._api.dispatchAction({\n      type: 'updateAxisPointer',\n      x: payloadInfo.cursorPoint[0],\n      y: payloadInfo.cursorPoint[1],\n      tooltipOption: payloadInfo.tooltipOption,\n      axesInfo: [{\n        axisDim: axisModel.axis.dim,\n        axisIndex: axisModel.componentIndex\n      }]\n    });\n  },\n\n  /**\n   * @private\n   */\n  _onHandleDragEnd: function (moveAnimation) {\n    this._dragging = false;\n    var handle = this._handle;\n\n    if (!handle) {\n      return;\n    }\n\n    var value = this._axisPointerModel.get('value'); // Consider snap or categroy axis, handle may be not consistent with\n    // axisPointer. So move handle to align the exact value position when\n    // drag ended.\n\n\n    this._moveHandleToValue(value); // For the effect: tooltip will be shown when finger holding on handle\n    // button, and will be hidden after finger left handle button.\n\n\n    this._api.dispatchAction({\n      type: 'hideTip'\n    });\n  },\n\n  /**\n   * Should be implemenented by sub-class if support `handle`.\n   * @protected\n   * @param {number} value\n   * @param {module:echarts/model/Model} axisModel\n   * @param {module:echarts/model/Model} axisPointerModel\n   * @return {Object} {position: [x, y], rotation: 0}\n   */\n  getHandleTransform: null,\n\n  /**\n   * * Should be implemenented by sub-class if support `handle`.\n   * @protected\n   * @param {Object} transform {position, rotation}\n   * @param {Array.<number>} delta [dx, dy]\n   * @param {module:echarts/model/Model} axisModel\n   * @param {module:echarts/model/Model} axisPointerModel\n   * @return {Object} {position: [x, y], rotation: 0, cursorPoint: [x, y]}\n   */\n  updateHandleTransform: null,\n\n  /**\n   * @private\n   */\n  clear: function (api) {\n    this._lastValue = null;\n    this._lastStatus = null;\n    var zr = api.getZr();\n    var group = this._group;\n    var handle = this._handle;\n\n    if (zr && group) {\n      this._lastGraphicKey = null;\n      group && zr.remove(group);\n      handle && zr.remove(handle);\n      this._group = null;\n      this._handle = null;\n      this._payloadInfo = null;\n    }\n  },\n\n  /**\n   * @protected\n   */\n  doClear: function () {// Implemented by sub-class if necessary.\n  },\n\n  /**\n   * @protected\n   * @param {Array.<number>} xy\n   * @param {Array.<number>} wh\n   * @param {number} [xDimIndex=0] or 1\n   */\n  buildLabel: function (xy, wh, xDimIndex) {\n    xDimIndex = xDimIndex || 0;\n    return {\n      x: xy[xDimIndex],\n      y: xy[1 - xDimIndex],\n      width: wh[xDimIndex],\n      height: wh[1 - xDimIndex]\n    };\n  }\n};\nBaseAxisPointer.prototype.constructor = BaseAxisPointer;\n\nfunction updateProps$1(animationModel, moveAnimation, el, props) {\n  // Animation optimize.\n  if (!propsEqual(inner$9(el).lastProp, props)) {\n    inner$9(el).lastProp = props;\n    moveAnimation ? updateProps(el, props, animationModel) : (el.stopAnimation(), el.attr(props));\n  }\n}\n\nfunction propsEqual(lastProps, newProps) {\n  if (isObject$1(lastProps) && isObject$1(newProps)) {\n    var equals = true;\n    each$1(newProps, function (item, key) {\n      equals = equals && propsEqual(lastProps[key], item);\n    });\n    return !!equals;\n  } else {\n    return lastProps === newProps;\n  }\n}\n\nfunction updateLabelShowHide(labelEl, axisPointerModel) {\n  labelEl[axisPointerModel.get('label.show') ? 'show' : 'hide']();\n}\n\nfunction getHandleTransProps(trans) {\n  return {\n    position: trans.position.slice(),\n    rotation: trans.rotation || 0\n  };\n}\n\nfunction updateMandatoryProps(group, axisPointerModel, silent) {\n  var z = axisPointerModel.get('z');\n  var zlevel = axisPointerModel.get('zlevel');\n  group && group.traverse(function (el) {\n    if (el.type !== 'group') {\n      z != null && (el.z = z);\n      zlevel != null && (el.zlevel = zlevel);\n      el.silent = silent;\n    }\n  });\n}\n\nenableClassExtend(BaseAxisPointer);\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n/**\n * @param {module:echarts/model/Model} axisPointerModel\n */\n\nfunction buildElStyle(axisPointerModel) {\n  var axisPointerType = axisPointerModel.get('type');\n  var styleModel = axisPointerModel.getModel(axisPointerType + 'Style');\n  var style;\n\n  if (axisPointerType === 'line') {\n    style = styleModel.getLineStyle();\n    style.fill = null;\n  } else if (axisPointerType === 'shadow') {\n    style = styleModel.getAreaStyle();\n    style.stroke = null;\n  }\n\n  return style;\n}\n/**\n * @param {Function} labelPos {align, verticalAlign, position}\n */\n\nfunction buildLabelElOption(elOption, axisModel, axisPointerModel, api, labelPos) {\n  var value = axisPointerModel.get('value');\n  var text = getValueLabel(value, axisModel.axis, axisModel.ecModel, axisPointerModel.get('seriesDataIndices'), {\n    precision: axisPointerModel.get('label.precision'),\n    formatter: axisPointerModel.get('label.formatter')\n  });\n  var labelModel = axisPointerModel.getModel('label');\n  var paddings = normalizeCssArray$1(labelModel.get('padding') || 0);\n  var font = labelModel.getFont();\n  var textRect = getBoundingRect(text, font);\n  var position = labelPos.position;\n  var width = textRect.width + paddings[1] + paddings[3];\n  var height = textRect.height + paddings[0] + paddings[2]; // Adjust by align.\n\n  var align = labelPos.align;\n  align === 'right' && (position[0] -= width);\n  align === 'center' && (position[0] -= width / 2);\n  var verticalAlign = labelPos.verticalAlign;\n  verticalAlign === 'bottom' && (position[1] -= height);\n  verticalAlign === 'middle' && (position[1] -= height / 2); // Not overflow ec container\n\n  confineInContainer(position, width, height, api);\n  var bgColor = labelModel.get('backgroundColor');\n\n  if (!bgColor || bgColor === 'auto') {\n    bgColor = axisModel.get('axisLine.lineStyle.color');\n  }\n\n  elOption.label = {\n    shape: {\n      x: 0,\n      y: 0,\n      width: width,\n      height: height,\n      r: labelModel.get('borderRadius')\n    },\n    position: position.slice(),\n    // TODO: rich\n    style: {\n      text: text,\n      textFont: font,\n      textFill: labelModel.getTextColor(),\n      textPosition: 'inside',\n      fill: bgColor,\n      stroke: labelModel.get('borderColor') || 'transparent',\n      lineWidth: labelModel.get('borderWidth') || 0,\n      shadowBlur: labelModel.get('shadowBlur'),\n      shadowColor: labelModel.get('shadowColor'),\n      shadowOffsetX: labelModel.get('shadowOffsetX'),\n      shadowOffsetY: labelModel.get('shadowOffsetY')\n    },\n    // Lable should be over axisPointer.\n    z2: 10\n  };\n} // Do not overflow ec container\n\nfunction confineInContainer(position, width, height, api) {\n  var viewWidth = api.getWidth();\n  var viewHeight = api.getHeight();\n  position[0] = Math.min(position[0] + width, viewWidth) - width;\n  position[1] = Math.min(position[1] + height, viewHeight) - height;\n  position[0] = Math.max(position[0], 0);\n  position[1] = Math.max(position[1], 0);\n}\n/**\n * @param {number} value\n * @param {module:echarts/coord/Axis} axis\n * @param {module:echarts/model/Global} ecModel\n * @param {Object} opt\n * @param {Array.<Object>} seriesDataIndices\n * @param {number|string} opt.precision 'auto' or a number\n * @param {string|Function} opt.formatter label formatter\n */\n\n\nfunction getValueLabel(value, axis, ecModel, seriesDataIndices, opt) {\n  value = axis.scale.parse(value);\n  var text = axis.scale.getLabel( // If `precision` is set, width can be fixed (like '12.00500'), which\n  // helps to debounce when when moving label.\n  value, {\n    precision: opt.precision\n  });\n  var formatter = opt.formatter;\n\n  if (formatter) {\n    var params = {\n      value: getAxisRawValue(axis, value),\n      seriesData: []\n    };\n    each$1(seriesDataIndices, function (idxItem) {\n      var series = ecModel.getSeriesByIndex(idxItem.seriesIndex);\n      var dataIndex = idxItem.dataIndexInside;\n      var dataParams = series && series.getDataParams(dataIndex);\n      dataParams && params.seriesData.push(dataParams);\n    });\n\n    if (isString(formatter)) {\n      text = formatter.replace('{value}', text);\n    } else if (isFunction$1(formatter)) {\n      text = formatter(params);\n    }\n  }\n\n  return text;\n}\n/**\n * @param {module:echarts/coord/Axis} axis\n * @param {number} value\n * @param {Object} layoutInfo {\n *  rotation, position, labelOffset, labelDirection, labelMargin\n * }\n */\n\nfunction getTransformedPosition(axis, value, layoutInfo) {\n  var transform = create$1();\n  rotate(transform, transform, layoutInfo.rotation);\n  translate(transform, transform, layoutInfo.position);\n  return applyTransform$1([axis.dataToCoord(value), (layoutInfo.labelOffset || 0) + (layoutInfo.labelDirection || 1) * (layoutInfo.labelMargin || 0)], transform);\n}\nfunction buildCartesianSingleLabelElOption(value, elOption, layoutInfo, axisModel, axisPointerModel, api) {\n  var textLayout = AxisBuilder.innerTextLayout(layoutInfo.rotation, 0, layoutInfo.labelDirection);\n  layoutInfo.labelMargin = axisPointerModel.get('label.margin');\n  buildLabelElOption(elOption, axisModel, axisPointerModel, api, {\n    position: getTransformedPosition(axisModel.axis, value, layoutInfo),\n    align: textLayout.textAlign,\n    verticalAlign: textLayout.textVerticalAlign\n  });\n}\n/**\n * @param {Array.<number>} p1\n * @param {Array.<number>} p2\n * @param {number} [xDimIndex=0] or 1\n */\n\nfunction makeLineShape(p1, p2, xDimIndex) {\n  xDimIndex = xDimIndex || 0;\n  return {\n    x1: p1[xDimIndex],\n    y1: p1[1 - xDimIndex],\n    x2: p2[xDimIndex],\n    y2: p2[1 - xDimIndex]\n  };\n}\n/**\n * @param {Array.<number>} xy\n * @param {Array.<number>} wh\n * @param {number} [xDimIndex=0] or 1\n */\n\nfunction makeRectShape(xy, wh, xDimIndex) {\n  xDimIndex = xDimIndex || 0;\n  return {\n    x: xy[xDimIndex],\n    y: xy[1 - xDimIndex],\n    width: wh[xDimIndex],\n    height: wh[1 - xDimIndex]\n  };\n}\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar CartesianAxisPointer = BaseAxisPointer.extend({\n  /**\n   * @override\n   */\n  makeElOption: function (elOption, value, axisModel, axisPointerModel, api) {\n    var axis = axisModel.axis;\n    var grid = axis.grid;\n    var axisPointerType = axisPointerModel.get('type');\n    var otherExtent = getCartesian(grid, axis).getOtherAxis(axis).getGlobalExtent();\n    var pixelValue = axis.toGlobalCoord(axis.dataToCoord(value, true));\n\n    if (axisPointerType && axisPointerType !== 'none') {\n      var elStyle = buildElStyle(axisPointerModel);\n      var pointerOption = pointerShapeBuilder[axisPointerType](axis, pixelValue, otherExtent, elStyle);\n      pointerOption.style = elStyle;\n      elOption.graphicKey = pointerOption.type;\n      elOption.pointer = pointerOption;\n    }\n\n    var layoutInfo = layout$1(grid.model, axisModel);\n    buildCartesianSingleLabelElOption(value, elOption, layoutInfo, axisModel, axisPointerModel, api);\n  },\n\n  /**\n   * @override\n   */\n  getHandleTransform: function (value, axisModel, axisPointerModel) {\n    var layoutInfo = layout$1(axisModel.axis.grid.model, axisModel, {\n      labelInside: false\n    });\n    layoutInfo.labelMargin = axisPointerModel.get('handle.margin');\n    return {\n      position: getTransformedPosition(axisModel.axis, value, layoutInfo),\n      rotation: layoutInfo.rotation + (layoutInfo.labelDirection < 0 ? Math.PI : 0)\n    };\n  },\n\n  /**\n   * @override\n   */\n  updateHandleTransform: function (transform, delta, axisModel, axisPointerModel) {\n    var axis = axisModel.axis;\n    var grid = axis.grid;\n    var axisExtent = axis.getGlobalExtent(true);\n    var otherExtent = getCartesian(grid, axis).getOtherAxis(axis).getGlobalExtent();\n    var dimIndex = axis.dim === 'x' ? 0 : 1;\n    var currPosition = transform.position;\n    currPosition[dimIndex] += delta[dimIndex];\n    currPosition[dimIndex] = Math.min(axisExtent[1], currPosition[dimIndex]);\n    currPosition[dimIndex] = Math.max(axisExtent[0], currPosition[dimIndex]);\n    var cursorOtherValue = (otherExtent[1] + otherExtent[0]) / 2;\n    var cursorPoint = [cursorOtherValue, cursorOtherValue];\n    cursorPoint[dimIndex] = currPosition[dimIndex]; // Make tooltip do not overlap axisPointer and in the middle of the grid.\n\n    var tooltipOptions = [{\n      verticalAlign: 'middle'\n    }, {\n      align: 'center'\n    }];\n    return {\n      position: currPosition,\n      rotation: transform.rotation,\n      cursorPoint: cursorPoint,\n      tooltipOption: tooltipOptions[dimIndex]\n    };\n  }\n});\n\nfunction getCartesian(grid, axis) {\n  var opt = {};\n  opt[axis.dim + 'AxisIndex'] = axis.index;\n  return grid.getCartesian(opt);\n}\n\nvar pointerShapeBuilder = {\n  line: function (axis, pixelValue, otherExtent, elStyle) {\n    var targetShape = makeLineShape([pixelValue, otherExtent[0]], [pixelValue, otherExtent[1]], getAxisDimIndex(axis));\n    subPixelOptimizeLine({\n      shape: targetShape,\n      style: elStyle\n    });\n    return {\n      type: 'Line',\n      shape: targetShape\n    };\n  },\n  shadow: function (axis, pixelValue, otherExtent, elStyle) {\n    var bandWidth = Math.max(1, axis.getBandWidth());\n    var span = otherExtent[1] - otherExtent[0];\n    return {\n      type: 'Rect',\n      shape: makeRectShape([pixelValue - bandWidth / 2, otherExtent[0]], [bandWidth, span], getAxisDimIndex(axis))\n    };\n  }\n};\n\nfunction getAxisDimIndex(axis) {\n  return axis.dim === 'x' ? 0 : 1;\n}\n\nAxisView.registerAxisPointerClass('CartesianAxisPointer', CartesianAxisPointer);\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n// echarts.simple.js and online build tooltip, which only require gridSimple,\n// CartesianAxisPointer should be able to required somewhere.\n\nregisterPreprocessor(function (option) {\n  // Always has a global axisPointerModel for default setting.\n  if (option) {\n    (!option.axisPointer || option.axisPointer.length === 0) && (option.axisPointer = {});\n    var link = option.axisPointer.link; // Normalize to array to avoid object mergin. But if link\n    // is not set, remain null/undefined, otherwise it will\n    // override existent link setting.\n\n    if (link && !isArray(link)) {\n      option.axisPointer.link = [link];\n    }\n  }\n}); // This process should proformed after coordinate systems created\n// and series data processed. So put it on statistic processing stage.\n\nregisterProcessor(PRIORITY.PROCESSOR.STATISTIC, function (ecModel, api) {\n  // Build axisPointerModel, mergin tooltip.axisPointer model for each axis.\n  // allAxesInfo should be updated when setOption performed.\n  ecModel.getComponent('axisPointer').coordSysAxesInfo = collect(ecModel, api);\n}); // Broadcast to all views.\n\nregisterAction({\n  type: 'updateAxisPointer',\n  event: 'updateAxisPointer',\n  update: ':updateAxisPointer'\n}, axisTrigger);\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nextendComponentModel({\n  type: 'tooltip',\n  dependencies: ['axisPointer'],\n  defaultOption: {\n    zlevel: 0,\n    z: 8,\n    show: true,\n    // tooltip\n    showContent: true,\n    // 'trigger' only works on coordinate system.\n    // 'item' | 'axis' | 'none'\n    trigger: 'item',\n    // 'click' | 'mousemove' | 'none'\n    triggerOn: 'mousemove|click',\n    alwaysShowContent: false,\n    displayMode: 'single',\n    // 'single' | 'multipleByCoordSys'\n    //  {Array} | {Function}\n    // position: null\n    // Consider triggered from axisPointer handle, verticalAlign should be 'middle'\n    // align: null,\n    // verticalAlign: null,\n    //  content  viewRect  false \n    confine: false,\n    // {string}Template  {Function}\n    // formatter: null\n    showDelay: 0,\n    // ms\n    hideDelay: 100,\n    // s\n    transitionDuration: 0.4,\n    enterable: false,\n    // 0.7\n    backgroundColor: 'rgba(50,50,50,0.7)',\n    // \n    borderColor: '#333',\n    // px4\n    borderRadius: 4,\n    // px0\n    borderWidth: 0,\n    // px5\n    // css\n    padding: 5,\n    // Extra css text\n    extraCssText: '',\n    // \n    axisPointer: {\n      // \n      // 'line' | 'shadow' | 'cross'\n      type: 'line',\n      // type  line  tooltip line \n      //  'x' | 'y' | 'angle' | 'radius' | 'auto'\n      //  'auto' category  x \n      //  angle \n      axis: 'auto',\n      animation: 'auto',\n      animationDurationUpdate: 200,\n      animationEasingUpdate: 'exponentialOut',\n      crossStyle: {\n        color: '#999',\n        width: 1,\n        type: 'dashed',\n        // TODO formatter\n        textStyle: {} // lineStyle and shadowStyle should not be specified here,\n        // otherwise it will always override those styles on option.axisPointer.\n\n      }\n    },\n    textStyle: {\n      color: '#fff',\n      fontSize: 14\n    }\n  }\n});\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar each$11 = each$1;\nvar toCamelCase$1 = toCamelCase;\nvar vendors = ['', '-webkit-', '-moz-', '-o-'];\nvar gCssText = 'position:absolute;display:block;border-style:solid;white-space:nowrap;z-index:9999999;';\n/**\n * @param {number} duration\n * @return {string}\n * @inner\n */\n\nfunction assembleTransition(duration) {\n  var transitionCurve = 'cubic-bezier(0.23, 1, 0.32, 1)';\n  var transitionText = 'left ' + duration + 's ' + transitionCurve + ',' + 'top ' + duration + 's ' + transitionCurve;\n  return map(vendors, function (vendorPrefix) {\n    return vendorPrefix + 'transition:' + transitionText;\n  }).join(';');\n}\n/**\n * @param {Object} textStyle\n * @return {string}\n * @inner\n */\n\n\nfunction assembleFont(textStyleModel) {\n  var cssText = [];\n  var fontSize = textStyleModel.get('fontSize');\n  var color = textStyleModel.getTextColor();\n  color && cssText.push('color:' + color);\n  cssText.push('font:' + textStyleModel.getFont());\n  fontSize && cssText.push('line-height:' + Math.round(fontSize * 3 / 2) + 'px');\n  each$11(['decoration', 'align'], function (name) {\n    var val = textStyleModel.get(name);\n    val && cssText.push('text-' + name + ':' + val);\n  });\n  return cssText.join(';');\n}\n/**\n * @param {Object} tooltipModel\n * @return {string}\n * @inner\n */\n\n\nfunction assembleCssText(tooltipModel) {\n  var cssText = [];\n  var transitionDuration = tooltipModel.get('transitionDuration');\n  var backgroundColor = tooltipModel.get('backgroundColor');\n  var textStyleModel = tooltipModel.getModel('textStyle');\n  var padding = tooltipModel.get('padding'); // Animation transition. Do not animate when transitionDuration is 0.\n\n  transitionDuration && cssText.push(assembleTransition(transitionDuration));\n\n  if (backgroundColor) {\n    if (env$1.canvasSupported) {\n      cssText.push('background-Color:' + backgroundColor);\n    } else {\n      // for ie\n      cssText.push('background-Color:#' + toHex(backgroundColor));\n      cssText.push('filter:alpha(opacity=70)');\n    }\n  } // Border style\n\n\n  each$11(['width', 'color', 'radius'], function (name) {\n    var borderName = 'border-' + name;\n    var camelCase = toCamelCase$1(borderName);\n    var val = tooltipModel.get(camelCase);\n    val != null && cssText.push(borderName + ':' + val + (name === 'color' ? '' : 'px'));\n  }); // Text style\n\n  cssText.push(assembleFont(textStyleModel)); // Padding\n\n  if (padding != null) {\n    cssText.push('padding:' + normalizeCssArray$1(padding).join('px ') + 'px');\n  }\n\n  return cssText.join(';') + ';';\n}\n/**\n * @alias module:echarts/component/tooltip/TooltipContent\n * @constructor\n */\n\n\nfunction TooltipContent(container, api) {\n  if (env$1.wxa) {\n    return null;\n  }\n\n  var el = document.createElement('div');\n  var zr = this._zr = api.getZr();\n  this.el = el;\n  this._x = api.getWidth() / 2;\n  this._y = api.getHeight() / 2;\n  container.appendChild(el);\n  this._container = container;\n  this._show = false;\n  /**\n   * @private\n   */\n\n  this._hideTimeout;\n  var self = this;\n\n  el.onmouseenter = function () {\n    // clear the timeout in hideLater and keep showing tooltip\n    if (self._enterable) {\n      clearTimeout(self._hideTimeout);\n      self._show = true;\n    }\n\n    self._inContent = true;\n  };\n\n  el.onmousemove = function (e) {\n    e = e || window.event;\n\n    if (!self._enterable) {\n      // Try trigger zrender event to avoid mouse\n      // in and out shape too frequently\n      var handler = zr.handler;\n      normalizeEvent(container, e, true);\n      handler.dispatch('mousemove', e);\n    }\n  };\n\n  el.onmouseleave = function () {\n    if (self._enterable) {\n      if (self._show) {\n        self.hideLater(self._hideDelay);\n      }\n    }\n\n    self._inContent = false;\n  };\n}\n\nTooltipContent.prototype = {\n  constructor: TooltipContent,\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  _enterable: true,\n\n  /**\n   * Update when tooltip is rendered\n   */\n  update: function () {\n    // FIXME\n    // Move this logic to ec main?\n    var container = this._container;\n    var stl = container.currentStyle || document.defaultView.getComputedStyle(container);\n    var domStyle = container.style;\n\n    if (domStyle.position !== 'absolute' && stl.position !== 'absolute') {\n      domStyle.position = 'relative';\n    } // Hide the tooltip\n    // PENDING\n    // this.hide();\n\n  },\n  show: function (tooltipModel) {\n    clearTimeout(this._hideTimeout);\n    var el = this.el;\n    el.style.cssText = gCssText + assembleCssText(tooltipModel) // http://stackoverflow.com/questions/21125587/css3-transition-not-working-in-chrome-anymore\n    + ';left:' + this._x + 'px;top:' + this._y + 'px;' + (tooltipModel.get('extraCssText') || '');\n    el.style.display = el.innerHTML ? 'block' : 'none';\n    this._show = true;\n  },\n  setContent: function (content) {\n    this.el.innerHTML = content == null ? '' : content;\n  },\n  setEnterable: function (enterable) {\n    this._enterable = enterable;\n  },\n  getSize: function () {\n    var el = this.el;\n    return [el.clientWidth, el.clientHeight];\n  },\n  moveTo: function (x, y) {\n    // xy should be based on canvas root. But tooltipContent is\n    // the sibling of canvas root. So padding of ec container\n    // should be considered here.\n    var zr = this._zr;\n    var viewportRootOffset;\n\n    if (zr && zr.painter && (viewportRootOffset = zr.painter.getViewportRootOffset())) {\n      x += viewportRootOffset.offsetLeft;\n      y += viewportRootOffset.offsetTop;\n    }\n\n    var style = this.el.style;\n    style.left = x + 'px';\n    style.top = y + 'px';\n    this._x = x;\n    this._y = y;\n  },\n  hide: function () {\n    this.el.style.display = 'none';\n    this._show = false;\n  },\n  hideLater: function (time) {\n    if (this._show && !(this._inContent && this._enterable)) {\n      if (time) {\n        this._hideDelay = time; // Set show false to avoid invoke hideLater mutiple times\n\n        this._show = false;\n        this._hideTimeout = setTimeout(bind(this.hide, this), time);\n      } else {\n        this.hide();\n      }\n    }\n  },\n  isShow: function () {\n    return this._show;\n  }\n};\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar bind$2 = bind;\nvar each$10 = each$1;\nvar parsePercent$2 = parsePercent$1;\nvar proxyRect = new Rect({\n  shape: {\n    x: -1,\n    y: -1,\n    width: 2,\n    height: 2\n  }\n});\nextendComponentView({\n  type: 'tooltip',\n  init: function (ecModel, api) {\n    if (env$1.node) {\n      return;\n    }\n\n    var tooltipContent = new TooltipContent(api.getDom(), api);\n    this._tooltipContent = tooltipContent;\n  },\n  render: function (tooltipModel, ecModel, api) {\n    if (env$1.node || env$1.wxa) {\n      return;\n    } // Reset\n\n\n    this.group.removeAll();\n    /**\n     * @private\n     * @type {module:echarts/component/tooltip/TooltipModel}\n     */\n\n    this._tooltipModel = tooltipModel;\n    /**\n     * @private\n     * @type {module:echarts/model/Global}\n     */\n\n    this._ecModel = ecModel;\n    /**\n     * @private\n     * @type {module:echarts/ExtensionAPI}\n     */\n\n    this._api = api;\n    /**\n     * Should be cleaned when render.\n     * @private\n     * @type {Array.<Array.<Object>>}\n     */\n\n    this._lastDataByCoordSys = null;\n    /**\n     * @private\n     * @type {boolean}\n     */\n\n    this._alwaysShowContent = tooltipModel.get('alwaysShowContent');\n    var tooltipContent = this._tooltipContent;\n    tooltipContent.update();\n    tooltipContent.setEnterable(tooltipModel.get('enterable'));\n\n    this._initGlobalListener();\n\n    this._keepShow();\n  },\n  _initGlobalListener: function () {\n    var tooltipModel = this._tooltipModel;\n    var triggerOn = tooltipModel.get('triggerOn');\n    register('itemTooltip', this._api, bind$2(function (currTrigger, e, dispatchAction) {\n      // If 'none', it is not controlled by mouse totally.\n      if (triggerOn !== 'none') {\n        if (triggerOn.indexOf(currTrigger) >= 0) {\n          this._tryShow(e, dispatchAction);\n        } else if (currTrigger === 'leave') {\n          this._hide(dispatchAction);\n        }\n      }\n    }, this));\n  },\n  _keepShow: function () {\n    var tooltipModel = this._tooltipModel;\n    var ecModel = this._ecModel;\n    var api = this._api; // Try to keep the tooltip show when refreshing\n\n    if (this._lastX != null && this._lastY != null // When user is willing to control tooltip totally using API,\n    // self.manuallyShowTip({x, y}) might cause tooltip hide,\n    // which is not expected.\n    && tooltipModel.get('triggerOn') !== 'none') {\n      var self = this;\n      clearTimeout(this._refreshUpdateTimeout);\n      this._refreshUpdateTimeout = setTimeout(function () {\n        // Show tip next tick after other charts are rendered\n        // In case highlight action has wrong result\n        // FIXME\n        self.manuallyShowTip(tooltipModel, ecModel, api, {\n          x: self._lastX,\n          y: self._lastY\n        });\n      });\n    }\n  },\n\n  /**\n   * Show tip manually by\n   * dispatchAction({\n   *     type: 'showTip',\n   *     x: 10,\n   *     y: 10\n   * });\n   * Or\n   * dispatchAction({\n   *      type: 'showTip',\n   *      seriesIndex: 0,\n   *      dataIndex or dataIndexInside or name\n   * });\n   *\n   *  TODO Batch\n   */\n  manuallyShowTip: function (tooltipModel, ecModel, api, payload) {\n    if (payload.from === this.uid || env$1.node) {\n      return;\n    }\n\n    var dispatchAction = makeDispatchAction$1(payload, api); // Reset ticket\n\n    this._ticket = ''; // When triggered from axisPointer.\n\n    var dataByCoordSys = payload.dataByCoordSys;\n\n    if (payload.tooltip && payload.x != null && payload.y != null) {\n      var el = proxyRect;\n      el.position = [payload.x, payload.y];\n      el.update();\n      el.tooltip = payload.tooltip; // Manually show tooltip while view is not using zrender elements.\n\n      this._tryShow({\n        offsetX: payload.x,\n        offsetY: payload.y,\n        target: el\n      }, dispatchAction);\n    } else if (dataByCoordSys) {\n      this._tryShow({\n        offsetX: payload.x,\n        offsetY: payload.y,\n        position: payload.position,\n        event: {},\n        dataByCoordSys: payload.dataByCoordSys,\n        tooltipOption: payload.tooltipOption\n      }, dispatchAction);\n    } else if (payload.seriesIndex != null) {\n      if (this._manuallyAxisShowTip(tooltipModel, ecModel, api, payload)) {\n        return;\n      }\n\n      var pointInfo = findPointFromSeries(payload, ecModel);\n      var cx = pointInfo.point[0];\n      var cy = pointInfo.point[1];\n\n      if (cx != null && cy != null) {\n        this._tryShow({\n          offsetX: cx,\n          offsetY: cy,\n          position: payload.position,\n          target: pointInfo.el,\n          event: {}\n        }, dispatchAction);\n      }\n    } else if (payload.x != null && payload.y != null) {\n      // FIXME\n      // should wrap dispatchAction like `axisPointer/globalListener` ?\n      api.dispatchAction({\n        type: 'updateAxisPointer',\n        x: payload.x,\n        y: payload.y\n      });\n\n      this._tryShow({\n        offsetX: payload.x,\n        offsetY: payload.y,\n        position: payload.position,\n        target: api.getZr().findHover(payload.x, payload.y).target,\n        event: {}\n      }, dispatchAction);\n    }\n  },\n  manuallyHideTip: function (tooltipModel, ecModel, api, payload) {\n    var tooltipContent = this._tooltipContent;\n\n    if (!this._alwaysShowContent && this._tooltipModel) {\n      tooltipContent.hideLater(this._tooltipModel.get('hideDelay'));\n    }\n\n    this._lastX = this._lastY = null;\n\n    if (payload.from !== this.uid) {\n      this._hide(makeDispatchAction$1(payload, api));\n    }\n  },\n  // Be compatible with previous design, that is, when tooltip.type is 'axis' and\n  // dispatchAction 'showTip' with seriesIndex and dataIndex will trigger axis pointer\n  // and tooltip.\n  _manuallyAxisShowTip: function (tooltipModel, ecModel, api, payload) {\n    var seriesIndex = payload.seriesIndex;\n    var dataIndex = payload.dataIndex;\n    var coordSysAxesInfo = ecModel.getComponent('axisPointer').coordSysAxesInfo;\n\n    if (seriesIndex == null || dataIndex == null || coordSysAxesInfo == null) {\n      return;\n    }\n\n    var seriesModel = ecModel.getSeriesByIndex(seriesIndex);\n\n    if (!seriesModel) {\n      return;\n    }\n\n    var data = seriesModel.getData();\n    var tooltipModel = buildTooltipModel([data.getItemModel(dataIndex), seriesModel, (seriesModel.coordinateSystem || {}).model, tooltipModel]);\n\n    if (tooltipModel.get('trigger') !== 'axis') {\n      return;\n    }\n\n    api.dispatchAction({\n      type: 'updateAxisPointer',\n      seriesIndex: seriesIndex,\n      dataIndex: dataIndex,\n      position: payload.position\n    });\n    return true;\n  },\n  _tryShow: function (e, dispatchAction) {\n    var el = e.target;\n    var tooltipModel = this._tooltipModel;\n\n    if (!tooltipModel) {\n      return;\n    } // Save mouse x, mouse y. So we can try to keep showing the tip if chart is refreshed\n\n\n    this._lastX = e.offsetX;\n    this._lastY = e.offsetY;\n    var dataByCoordSys = e.dataByCoordSys;\n\n    if (dataByCoordSys && dataByCoordSys.length) {\n      this._showAxisTooltip(dataByCoordSys, e);\n    } // Always show item tooltip if mouse is on the element with dataIndex\n    else if (el && el.dataIndex != null) {\n        this._lastDataByCoordSys = null;\n\n        this._showSeriesItemTooltip(e, el, dispatchAction);\n      } // Tooltip provided directly. Like legend.\n      else if (el && el.tooltip) {\n          this._lastDataByCoordSys = null;\n\n          this._showComponentItemTooltip(e, el, dispatchAction);\n        } else {\n          this._lastDataByCoordSys = null;\n\n          this._hide(dispatchAction);\n        }\n  },\n  _showOrMove: function (tooltipModel, cb) {\n    // showDelay is used in this case: tooltip.enterable is set\n    // as true. User intent to move mouse into tooltip and click\n    // something. `showDelay` makes it easyer to enter the content\n    // but tooltip do not move immediately.\n    var delay = tooltipModel.get('showDelay');\n    cb = bind(cb, this);\n    clearTimeout(this._showTimout);\n    delay > 0 ? this._showTimout = setTimeout(cb, delay) : cb();\n  },\n  _showAxisTooltip: function (dataByCoordSys, e) {\n    var ecModel = this._ecModel;\n    var globalTooltipModel = this._tooltipModel;\n    var point = [e.offsetX, e.offsetY];\n    var singleDefaultHTML = [];\n    var singleParamsList = [];\n    var singleTooltipModel = buildTooltipModel([e.tooltipOption, globalTooltipModel]);\n    each$10(dataByCoordSys, function (itemCoordSys) {\n      // var coordParamList = [];\n      // var coordDefaultHTML = [];\n      // var coordTooltipModel = buildTooltipModel([\n      //     e.tooltipOption,\n      //     itemCoordSys.tooltipOption,\n      //     ecModel.getComponent(itemCoordSys.coordSysMainType, itemCoordSys.coordSysIndex),\n      //     globalTooltipModel\n      // ]);\n      // var displayMode = coordTooltipModel.get('displayMode');\n      // var paramsList = displayMode === 'single' ? singleParamsList : [];\n      each$10(itemCoordSys.dataByAxis, function (item) {\n        var axisModel = ecModel.getComponent(item.axisDim + 'Axis', item.axisIndex);\n        var axisValue = item.value;\n        var seriesDefaultHTML = [];\n\n        if (!axisModel || axisValue == null) {\n          return;\n        }\n\n        var valueLabel = getValueLabel(axisValue, axisModel.axis, ecModel, item.seriesDataIndices, item.valueLabelOpt);\n        each$1(item.seriesDataIndices, function (idxItem) {\n          var series = ecModel.getSeriesByIndex(idxItem.seriesIndex);\n          var dataIndex = idxItem.dataIndexInside;\n          var dataParams = series && series.getDataParams(dataIndex);\n          dataParams.axisDim = item.axisDim;\n          dataParams.axisIndex = item.axisIndex;\n          dataParams.axisType = item.axisType;\n          dataParams.axisId = item.axisId;\n          dataParams.axisValue = getAxisRawValue(axisModel.axis, axisValue);\n          dataParams.axisValueLabel = valueLabel;\n\n          if (dataParams) {\n            singleParamsList.push(dataParams);\n            seriesDefaultHTML.push(series.formatTooltip(dataIndex, true));\n          }\n        }); // Default tooltip content\n        // FIXME\n        // (1) shold be the first data which has name?\n        // (2) themeRiver, firstDataIndex is array, and first line is unnecessary.\n\n        var firstLine = valueLabel;\n        singleDefaultHTML.push((firstLine ? encodeHTML(firstLine) + '<br />' : '') + seriesDefaultHTML.join('<br />'));\n      });\n    }, this); // In most case, the second axis is shown upper than the first one.\n\n    singleDefaultHTML.reverse();\n    singleDefaultHTML = singleDefaultHTML.join('<br /><br />');\n    var positionExpr = e.position;\n\n    this._showOrMove(singleTooltipModel, function () {\n      if (this._updateContentNotChangedOnAxis(dataByCoordSys)) {\n        this._updatePosition(singleTooltipModel, positionExpr, point[0], point[1], this._tooltipContent, singleParamsList);\n      } else {\n        this._showTooltipContent(singleTooltipModel, singleDefaultHTML, singleParamsList, Math.random(), point[0], point[1], positionExpr);\n      }\n    }); // Do not trigger events here, because this branch only be entered\n    // from dispatchAction.\n\n  },\n  _showSeriesItemTooltip: function (e, el, dispatchAction) {\n    var ecModel = this._ecModel; // Use dataModel in element if possible\n    // Used when mouseover on a element like markPoint or edge\n    // In which case, the data is not main data in series.\n\n    var seriesIndex = el.seriesIndex;\n    var seriesModel = ecModel.getSeriesByIndex(seriesIndex); // For example, graph link.\n\n    var dataModel = el.dataModel || seriesModel;\n    var dataIndex = el.dataIndex;\n    var dataType = el.dataType;\n    var data = dataModel.getData();\n    var tooltipModel = buildTooltipModel([data.getItemModel(dataIndex), dataModel, seriesModel && (seriesModel.coordinateSystem || {}).model, this._tooltipModel]);\n    var tooltipTrigger = tooltipModel.get('trigger');\n\n    if (tooltipTrigger != null && tooltipTrigger !== 'item') {\n      return;\n    }\n\n    var params = dataModel.getDataParams(dataIndex, dataType);\n    var defaultHtml = dataModel.formatTooltip(dataIndex, false, dataType);\n    var asyncTicket = 'item_' + dataModel.name + '_' + dataIndex;\n\n    this._showOrMove(tooltipModel, function () {\n      this._showTooltipContent(tooltipModel, defaultHtml, params, asyncTicket, e.offsetX, e.offsetY, e.position, e.target);\n    }); // FIXME\n    // duplicated showtip if manuallyShowTip is called from dispatchAction.\n\n\n    dispatchAction({\n      type: 'showTip',\n      dataIndexInside: dataIndex,\n      dataIndex: data.getRawIndex(dataIndex),\n      seriesIndex: seriesIndex,\n      from: this.uid\n    });\n  },\n  _showComponentItemTooltip: function (e, el, dispatchAction) {\n    var tooltipOpt = el.tooltip;\n\n    if (typeof tooltipOpt === 'string') {\n      var content = tooltipOpt;\n      tooltipOpt = {\n        content: content,\n        // Fixed formatter\n        formatter: content\n      };\n    }\n\n    var subTooltipModel = new Model(tooltipOpt, this._tooltipModel, this._ecModel);\n    var defaultHtml = subTooltipModel.get('content');\n    var asyncTicket = Math.random(); // Do not check whether `trigger` is 'none' here, because `trigger`\n    // only works on cooridinate system. In fact, we have not found case\n    // that requires setting `trigger` nothing on component yet.\n\n    this._showOrMove(subTooltipModel, function () {\n      this._showTooltipContent(subTooltipModel, defaultHtml, subTooltipModel.get('formatterParams') || {}, asyncTicket, e.offsetX, e.offsetY, e.position, el);\n    }); // If not dispatch showTip, tip may be hide triggered by axis.\n\n\n    dispatchAction({\n      type: 'showTip',\n      from: this.uid\n    });\n  },\n  _showTooltipContent: function (tooltipModel, defaultHtml, params, asyncTicket, x, y, positionExpr, el) {\n    // Reset ticket\n    this._ticket = '';\n\n    if (!tooltipModel.get('showContent') || !tooltipModel.get('show')) {\n      return;\n    }\n\n    var tooltipContent = this._tooltipContent;\n    var formatter = tooltipModel.get('formatter');\n    positionExpr = positionExpr || tooltipModel.get('position');\n    var html = defaultHtml;\n\n    if (formatter && typeof formatter === 'string') {\n      html = formatTpl(formatter, params, true);\n    } else if (typeof formatter === 'function') {\n      var callback = bind$2(function (cbTicket, html) {\n        if (cbTicket === this._ticket) {\n          tooltipContent.setContent(html);\n\n          this._updatePosition(tooltipModel, positionExpr, x, y, tooltipContent, params, el);\n        }\n      }, this);\n      this._ticket = asyncTicket;\n      html = formatter(params, asyncTicket, callback);\n    }\n\n    tooltipContent.setContent(html);\n    tooltipContent.show(tooltipModel);\n\n    this._updatePosition(tooltipModel, positionExpr, x, y, tooltipContent, params, el);\n  },\n\n  /**\n   * @param  {string|Function|Array.<number>|Object} positionExpr\n   * @param  {number} x Mouse x\n   * @param  {number} y Mouse y\n   * @param  {boolean} confine Whether confine tooltip content in view rect.\n   * @param  {Object|<Array.<Object>} params\n   * @param  {module:zrender/Element} el target element\n   * @param  {module:echarts/ExtensionAPI} api\n   * @return {Array.<number>}\n   */\n  _updatePosition: function (tooltipModel, positionExpr, x, y, content, params, el) {\n    var viewWidth = this._api.getWidth();\n\n    var viewHeight = this._api.getHeight();\n\n    positionExpr = positionExpr || tooltipModel.get('position');\n    var contentSize = content.getSize();\n    var align = tooltipModel.get('align');\n    var vAlign = tooltipModel.get('verticalAlign');\n    var rect = el && el.getBoundingRect().clone();\n    el && rect.applyTransform(el.transform);\n\n    if (typeof positionExpr === 'function') {\n      // Callback of position can be an array or a string specify the position\n      positionExpr = positionExpr([x, y], params, content.el, rect, {\n        viewSize: [viewWidth, viewHeight],\n        contentSize: contentSize.slice()\n      });\n    }\n\n    if (isArray(positionExpr)) {\n      x = parsePercent$2(positionExpr[0], viewWidth);\n      y = parsePercent$2(positionExpr[1], viewHeight);\n    } else if (isObject$1(positionExpr)) {\n      positionExpr.width = contentSize[0];\n      positionExpr.height = contentSize[1];\n      var layoutRect = getLayoutRect(positionExpr, {\n        width: viewWidth,\n        height: viewHeight\n      });\n      x = layoutRect.x;\n      y = layoutRect.y;\n      align = null; // When positionExpr is left/top/right/bottom,\n      // align and verticalAlign will not work.\n\n      vAlign = null;\n    } // Specify tooltip position by string 'top' 'bottom' 'left' 'right' around graphic element\n    else if (typeof positionExpr === 'string' && el) {\n        var pos = calcTooltipPosition(positionExpr, rect, contentSize);\n        x = pos[0];\n        y = pos[1];\n      } else {\n        var pos = refixTooltipPosition(x, y, content.el, viewWidth, viewHeight, align ? null : 20, vAlign ? null : 20);\n        x = pos[0];\n        y = pos[1];\n      }\n\n    align && (x -= isCenterAlign(align) ? contentSize[0] / 2 : align === 'right' ? contentSize[0] : 0);\n    vAlign && (y -= isCenterAlign(vAlign) ? contentSize[1] / 2 : vAlign === 'bottom' ? contentSize[1] : 0);\n\n    if (tooltipModel.get('confine')) {\n      var pos = confineTooltipPosition(x, y, content.el, viewWidth, viewHeight);\n      x = pos[0];\n      y = pos[1];\n    }\n\n    content.moveTo(x, y);\n  },\n  // FIXME\n  // Should we remove this but leave this to user?\n  _updateContentNotChangedOnAxis: function (dataByCoordSys) {\n    var lastCoordSys = this._lastDataByCoordSys;\n    var contentNotChanged = !!lastCoordSys && lastCoordSys.length === dataByCoordSys.length;\n    contentNotChanged && each$10(lastCoordSys, function (lastItemCoordSys, indexCoordSys) {\n      var lastDataByAxis = lastItemCoordSys.dataByAxis || {};\n      var thisItemCoordSys = dataByCoordSys[indexCoordSys] || {};\n      var thisDataByAxis = thisItemCoordSys.dataByAxis || [];\n      contentNotChanged &= lastDataByAxis.length === thisDataByAxis.length;\n      contentNotChanged && each$10(lastDataByAxis, function (lastItem, indexAxis) {\n        var thisItem = thisDataByAxis[indexAxis] || {};\n        var lastIndices = lastItem.seriesDataIndices || [];\n        var newIndices = thisItem.seriesDataIndices || [];\n        contentNotChanged &= lastItem.value === thisItem.value && lastItem.axisType === thisItem.axisType && lastItem.axisId === thisItem.axisId && lastIndices.length === newIndices.length;\n        contentNotChanged && each$10(lastIndices, function (lastIdxItem, j) {\n          var newIdxItem = newIndices[j];\n          contentNotChanged &= lastIdxItem.seriesIndex === newIdxItem.seriesIndex && lastIdxItem.dataIndex === newIdxItem.dataIndex;\n        });\n      });\n    });\n    this._lastDataByCoordSys = dataByCoordSys;\n    return !!contentNotChanged;\n  },\n  _hide: function (dispatchAction) {\n    // Do not directly hideLater here, because this behavior may be prevented\n    // in dispatchAction when showTip is dispatched.\n    // FIXME\n    // duplicated hideTip if manuallyHideTip is called from dispatchAction.\n    this._lastDataByCoordSys = null;\n    dispatchAction({\n      type: 'hideTip',\n      from: this.uid\n    });\n  },\n  dispose: function (ecModel, api) {\n    if (env$1.node || env$1.wxa) {\n      return;\n    }\n\n    this._tooltipContent.hide();\n\n    unregister('itemTooltip', api);\n  }\n});\n/**\n * @param {Array.<Object|module:echarts/model/Model>} modelCascade\n * From top to bottom. (the last one should be globalTooltipModel);\n */\n\nfunction buildTooltipModel(modelCascade) {\n  var resultModel = modelCascade.pop();\n\n  while (modelCascade.length) {\n    var tooltipOpt = modelCascade.pop();\n\n    if (tooltipOpt) {\n      if (Model.isInstance(tooltipOpt)) {\n        tooltipOpt = tooltipOpt.get('tooltip', true);\n      } // In each data item tooltip can be simply write:\n      // {\n      //  value: 10,\n      //  tooltip: 'Something you need to know'\n      // }\n\n\n      if (typeof tooltipOpt === 'string') {\n        tooltipOpt = {\n          formatter: tooltipOpt\n        };\n      }\n\n      resultModel = new Model(tooltipOpt, resultModel, resultModel.ecModel);\n    }\n  }\n\n  return resultModel;\n}\n\nfunction makeDispatchAction$1(payload, api) {\n  return payload.dispatchAction || bind(api.dispatchAction, api);\n}\n\nfunction refixTooltipPosition(x, y, el, viewWidth, viewHeight, gapH, gapV) {\n  var size = getOuterSize(el);\n  var width = size.width;\n  var height = size.height;\n\n  if (gapH != null) {\n    if (x + width + gapH > viewWidth) {\n      x -= width + gapH;\n    } else {\n      x += gapH;\n    }\n  }\n\n  if (gapV != null) {\n    if (y + height + gapV > viewHeight) {\n      y -= height + gapV;\n    } else {\n      y += gapV;\n    }\n  }\n\n  return [x, y];\n}\n\nfunction confineTooltipPosition(x, y, el, viewWidth, viewHeight) {\n  var size = getOuterSize(el);\n  var width = size.width;\n  var height = size.height;\n  x = Math.min(x + width, viewWidth) - width;\n  y = Math.min(y + height, viewHeight) - height;\n  x = Math.max(x, 0);\n  y = Math.max(y, 0);\n  return [x, y];\n}\n\nfunction getOuterSize(el) {\n  var width = el.clientWidth;\n  var height = el.clientHeight; // Consider browser compatibility.\n  // IE8 does not support getComputedStyle.\n\n  if (document.defaultView && document.defaultView.getComputedStyle) {\n    var stl = document.defaultView.getComputedStyle(el);\n\n    if (stl) {\n      width += parseInt(stl.paddingLeft, 10) + parseInt(stl.paddingRight, 10) + parseInt(stl.borderLeftWidth, 10) + parseInt(stl.borderRightWidth, 10);\n      height += parseInt(stl.paddingTop, 10) + parseInt(stl.paddingBottom, 10) + parseInt(stl.borderTopWidth, 10) + parseInt(stl.borderBottomWidth, 10);\n    }\n  }\n\n  return {\n    width: width,\n    height: height\n  };\n}\n\nfunction calcTooltipPosition(position, rect, contentSize) {\n  var domWidth = contentSize[0];\n  var domHeight = contentSize[1];\n  var gap = 5;\n  var x = 0;\n  var y = 0;\n  var rectWidth = rect.width;\n  var rectHeight = rect.height;\n\n  switch (position) {\n    case 'inside':\n      x = rect.x + rectWidth / 2 - domWidth / 2;\n      y = rect.y + rectHeight / 2 - domHeight / 2;\n      break;\n\n    case 'top':\n      x = rect.x + rectWidth / 2 - domWidth / 2;\n      y = rect.y - domHeight - gap;\n      break;\n\n    case 'bottom':\n      x = rect.x + rectWidth / 2 - domWidth / 2;\n      y = rect.y + rectHeight + gap;\n      break;\n\n    case 'left':\n      x = rect.x - domWidth - gap;\n      y = rect.y + rectHeight / 2 - domHeight / 2;\n      break;\n\n    case 'right':\n      x = rect.x + rectWidth + gap;\n      y = rect.y + rectHeight / 2 - domHeight / 2;\n  }\n\n  return [x, y];\n}\n\nfunction isCenterAlign(align) {\n  return align === 'center' || align === 'middle';\n}\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n// FIXME Better way to pack data in graphic element\n/**\n * @action\n * @property {string} type\n * @property {number} seriesIndex\n * @property {number} dataIndex\n * @property {number} [x]\n * @property {number} [y]\n */\n\nregisterAction({\n  type: 'showTip',\n  event: 'showTip',\n  update: 'tooltip:manuallyShowTip'\n}, // noop\nfunction () {});\nregisterAction({\n  type: 'hideTip',\n  event: 'hideTip',\n  update: 'tooltip:manuallyHideTip'\n}, // noop\nfunction () {});\n\nexports.version = version;\nexports.dependencies = dependencies;\nexports.PRIORITY = PRIORITY;\nexports.init = init;\nexports.connect = connect;\nexports.disConnect = disConnect;\nexports.disconnect = disconnect;\nexports.dispose = dispose;\nexports.getInstanceByDom = getInstanceByDom;\nexports.getInstanceById = getInstanceById;\nexports.registerTheme = registerTheme;\nexports.registerPreprocessor = registerPreprocessor;\nexports.registerProcessor = registerProcessor;\nexports.registerPostUpdate = registerPostUpdate;\nexports.registerAction = registerAction;\nexports.registerCoordinateSystem = registerCoordinateSystem;\nexports.getCoordinateSystemDimensions = getCoordinateSystemDimensions;\nexports.registerLayout = registerLayout;\nexports.registerVisual = registerVisual;\nexports.registerLoading = registerLoading;\nexports.extendComponentModel = extendComponentModel;\nexports.extendComponentView = extendComponentView;\nexports.extendSeriesModel = extendSeriesModel;\nexports.extendChartView = extendChartView;\nexports.setCanvasCreator = setCanvasCreator;\nexports.registerMap = registerMap;\nexports.getMap = getMap;\nexports.dataTool = dataTool;\nexports.zrender = zrender;\nexports.graphic = graphic;\nexports.number = number;\nexports.format = format;\nexports.throttle = throttle;\nexports.helper = helper;\nexports.matrix = matrix;\nexports.vector = vector;\nexports.color = color;\nexports.parseGeoJSON = parseGeoJSON;\nexports.parseGeoJson = parseGeoJson;\nexports.util = ecUtil;\nexports.List = List;\nexports.Model = Model;\nexports.Axis = Axis;\nexports.env = env$1;\n\n})));\n"]}